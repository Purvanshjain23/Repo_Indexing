     H/TITLE Bld Rest Time Wrkf    XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 11/09/20  Time  : 01:32:02
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKA1CPN6IF  E           K        DISK
      * RSQ : Tattoo Header             Kill/Shf/Ttto  Active
      *
     FPKA1CPN0IF  E           K        DISK
      * RSQ : Tattoo Header             Co/bol/Ttt/SelHeldOver
      *
     FPKA2CPLCIF  E           K        DISK
      * RSQ : Tattoo Detail             Co/Bo/Ld/TTT/KillDt/Pen
      *
     FPKA3REL1IF  E           K        DISK
      * RTV : Pen                       Retrieval index
      *
     FPKB3CPL5IF  E           K        DISK
      * RSQ : Tattoo Scale Ticket       Co/Pen/BO/LD/Ttt all
      *
     FPKB3CPL1IF  E           K        DISK
      * RTV : Tattoo Scale Ticket       Retrieval index
      *
     FPLAFCPL2IF  E           K        DISK
      * RSQ : Delivery Tracking         BOH CO/BO/BOL/KillDt
      *
     FPKEMCPL3IF  E           K        DISK
      * RSQ : W001 Rest Time Eval Workf Co/bol/tatt/kill/seq/sq(
      *
     FPKEMCPL0IF  E           K        DISK                      A
      * UPD : W001 Rest Time Eval Workf Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@A1CPXO
      * Tattoo Header             Kill/Shf/Ttto  Active
      * Renamed input format fields
     I              A1HMNB                          WAHMNB
     I              A1BNNB                          WABNNB
     I              A1BONB                          WABONB
     I              A1CVNB                          WACVNB
     I              A1B0DT                          WAB0DT
     I              A1AWDT                          WAAWDT
     I              A1BICD                          WABICD
     I              A1CPST                          WACPST
     I              A1ACPR                          WAACPR
     I              A1B9PR                          WAB9PR
     I              A1CAPR                          WACAPR
     I              A1C4ST                          WAC4ST
     I              A1AIPR                          WAAIPR
     I              A1A6DT                          WAA6DT
     I              A1C2ST                          WAC2ST
     I              A1CXNB                          WACXNB
     I              A1CWNB                          WACWNB
     I              A1FCNB                          WAFCNB
     I              A1H9NB                          WAH9NB
     I              A1FDNB                          WAFDNB
     I              A1FENB                          WAFENB
     I              A1HENB                          WAHENB
     I              A1HFNB                          WAHFNB
     I              A1CYNB                          WACYNB
     I              A1LRNB                          WALRNB
     I              A1E0NB                          WAE0NB
     I              A1A5PC                          WAA5PC
     I              A1FBNB                          WAFBNB
     I              A1A4PC                          WAA4PC
     I              A1F7NB                          WAF7NB
     I              A1HDNB                          WAHDNB
     I              A1F5NB                          WAF5NB
     I              A1F4NB                          WAF4NB
     I              A1F3NB                          WAF3NB
     I              A1F2NB                          WAF2NB
     I              A1AVPC                          WAAVPC
     I              A1AWPC                          WAAWPC
     I              A1CWPC                          WACWPC
     I              A1A8PC                          WAA8PC
     I              A1A7PC                          WAA7PC
     I              A1B8PR                          WAB8PR
     I              A1AMPR                          WAAMPR
     I              A1ANPR                          WAANPR
     I              A1AYVA                          WAAYVA
     I              A1AWVA                          WAAWVA
     I              A1AOPR                          WAAOPR
     I              A1AXVA                          WAAXVA
     I              A1APPR                          WAAPPR
     I              A1ASPR                          WAASPR
     I              A1A4VA                          WAA4VA
     I              A1ATPR                          WAATPR
     I              A1A5VA                          WAA5VA
     I              A1CBPR                          WACBPR
     I              A1CCPR                          WACCPR
     I              A1LPNB                          WALPNB
     I              A1CDPR                          WACDPR
     I              A1A7VA                          WAA7VA
     I              A1A2PR                          WAA2PR
     I              A1JWST                          WAJWST
     I              A1CWST                          WACWST
     I              A1D7ST                          WAD7ST
     I              A1D8ST                          WAD8ST
     I              A1DWST                          WADWST
     I              A1D6ST                          WAD6ST
     I              A1GHNB                          WAGHNB
     I              A1BYDT                          WABYDT
     I              A1E0ST                          WAE0ST
     I              A1E1ST                          WAE1ST
     I              A1E2ST                          WAE2ST
     I              A1BSDT                          WABSDT
     I              A1BTDT                          WABTDT
     I              A1BUDT                          WABUDT
     I              A1HGNB                          WAHGNB
     I              A1HHNB                          WAHHNB
     I              A1HINB                          WAHINB
     I              A1A3PR                          WAA3PR
     I              A1A4PR                          WAA4PR
     I              A1A6PR                          WAA6PR
     I              A1J9NB                          WAJ9NB
     I              A1D6PR                          WAD6PR
     I              A1D7PR                          WAD7PR
     I              A1D8PR                          WAD8PR
     I              A1D9PR                          WAD9PR
     I              A1EAPR                          WAEAPR
     I              A1EBPR                          WAEBPR
     I              A1ECPR                          WAECPR
     I              A1EDPR                          WAEDPR
     I              A1EEPR                          WAEEPR
     I              A1EFPR                          WAEFPR
     I              A1EGPR                          WAEGPR
     I              A1EHPR                          WAEHPR
     I              A1KAST                          WAKAST
     I              A1J7ST                          WAJ7ST
     I              A1J9ST                          WAJ9ST
     I              A1OXNB                          WAOXNB
     I              A1LKST                          WALKST
     I              A1LLST                          WALLST
     I              A1J8ST                          WAJ8ST
     I              A1LIST                          WALIST
     I              A1LJST                          WALJST
     I              A1NZTX                          WANZTX
     I              A1HJCD                          WAHJCD
     I              A1R4ST                          WAR4ST
     I              A1R5ST                          WAR5ST
     I              A1R6ST                          WAR6ST
     I              A1R7ST                          WAR7ST
     I              A1THWT                          WATHWT
     I              A1T2WT                          WAT2WT
     I              A1THHD                          WATHHD
     I              A1T2HD                          WAT2HD
     I              A1OBPR                          WAOBPR
     I              A1KOER                          WAKOER
     I              A1OPIR                          WAOPIR
     I              A1OPEM                          WAOPEM
     I              A1IORP                          WAIORP
     I              A1OWEO                          WAOWEO
     I              A1OQET                          WAOQET
     I              A1URST                          WAURST
     I              A1USST                          WAUSST
     I              A1HHPC                          WAHHPC
     I              A1S9PR                          WAS9PR
     I              A1TAPR                          WATAPR
     I              A1TBPR                          WATBPR
     I              A1JFUR                          WAJFUR
     I              A1KRIF                          WAKRIF
     I              A1KORF                          WAKORF
     I              A1KAPR                          WAKAPR
     I              A1KROT                          WAKROT
     I              A1OTJG                          WAOTJG
     I              A1IRJG                          WAIRJG
     I              A1IMJF                          WAIMJF
     I              A1IRGF                          WAIRGF
     I              A1KRJF                          WAKRJF
     I              A1OJRF                          WAOJRF
     I              A1KFOR                          WAKFOR
     I              A1ORJK                          WAORJK
     I              A1OMVJ                          WAOMVJ
     I              A1MVNF                          WAMVNF
     I              A1MCNF                          WAMCNF
     I              A1NCNF                          WANCNF
     I              A1NCHF                          WANCHF
     I              A1IGIR                          WAIGIR
     I              A1KFJR                          WAKFJR
     I              A1EADT                          WAEADT
     I              A1EBDT                          WAEBDT
     I              A1ECDT                          WAECDT
     I              A1EDDT                          WAEDDT
     I              A1EEDT                          WAEEDT
     I              A1U4ST                          WAU4ST
     I              A1U5ST                          WAU5ST
     I              A1U6ST                          WAU6ST
     I              A1U7ST                          WAU7ST
     I              A1U8ST                          WAU8ST
     I              A1U9ST                          WAU9ST
     I              A1VAST                          WAVAST
     I              A1VBST                          WAVBST
     I              A1BDCD                          WABDCD
     I              A1CSCD                          WACSCD
     I              A1ABCD                          WAABCD
     I              A1AECD                          WAAECD
     I              A1ACCD                          WAACCD
     I              A1AGCD                          WAAGCD
     I              A1BECD                          WABECD
     I              A1AAVN                          WAAAVN
     I              A1AADT                          WAAADT
     I              A1AMTM                          WAAMTM
     I              A1AJST                          WAAJST
     I              A1AHVN                          WAAHVN
     I              A1AGVN                          WAAGVN
     I              A1ABVN                          WAABVN
     I              A1ABDT                          WAABDT
     I              A1ABTM                          WAABTM
      *
     I@A1CPVF
      * Tattoo Header             Co/bol/Ttt/SelHeldOver
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     I@A2CPNP
      * Tattoo Detail             Co/Bo/Ld/TTT/KillDt/Pen
      * Renamed input format fields
     I              A2HMNB                          WCHMNB
     I              A2BNNB                          WCBNNB
     I              A2BONB                          WCBONB
     I              A2CVNB                          WCCVNB
     I              A2B0DT                          WCB0DT
     I              A2C2NB                          WCC2NB
     I              A2CZNB                          WCCZNB
     I              A2C0NB                          WCC0NB
     I              A2D8NB                          WCD8NB
     I              A2H7NB                          WCH7NB
     I              A2GGST                          WCGGST
     I              A2AJTM                          WCAJTM
     I              A2JEA1                          WCJEA1
     I              A2B7CD                          WCB7CD
     I              A2D7NB                          WCD7NB
     I              A2D9ST                          WCD9ST
     I              A2E3ST                          WCE3ST
     I              A2E4ST                          WCE4ST
     I              A2E5ST                          WCE5ST
     I              A2BVDT                          WCBVDT
     I              A2BWDT                          WCBWDT
     I              A2BXDT                          WCBXDT
     I              A2HVNB                          WCHVNB
     I              A2CMCD                          WCCMCD
     I              A2B9CD                          WCB9CD
     I              A2H8NB                          WCH8NB
     I              A2CYCD                          WCCYCD
     I              A2AAVN                          WCAAVN
     I              A2AADT                          WCAADT
     I              A2AMTM                          WCAMTM
     I              A2AJST                          WCAJST
     I              A2AHVN                          WCAHVN
     I              A2AGVN                          WCAGVN
     I              A2ABVN                          WCABVN
     I              A2ABDT                          WCABDT
     I              A2ABTM                          WCABTM
      *
     I@A3REDD
      * Pen                       Retrieval index
      * Renamed input format fields
     I              A3HVNB                          WDHVNB
     I              A3CMCD                          WDCMCD
     I              A3BBTX                          WDBBTX
     I              A3CTNB                          WDCTNB
     I              A3D6NB                          WDD6NB
     I              A3B6CD                          WDB6CD
     I              A3DGST                          WDDGST
     I              A3EBNB                          WDEBNB
     I              A3FWST                          WDFWST
     I              A3HBNB                          WDHBNB
     I              A3AGCD                          WDAGCD
     I              A3AAVN                          WDAAVN
     I              A3AADT                          WDAADT
     I              A3AMTM                          WDAMTM
     I              A3AJST                          WDAJST
     I              A3AHVN                          WDAHVN
     I              A3AGVN                          WDAGVN
     I              A3ABVN                          WDABVN
     I              A3ABDT                          WDABDT
     I              A3ABTM                          WDABTM
      *
     I@B3CPU6
      * Tattoo Scale Ticket       Co/Pen/BO/LD/Ttt all
      * Renamed input format fields
     I              B3HMNB                          WEHMNB
     I              B3BNNB                          WEBNNB
     I              B3BONB                          WEBONB
     I              B3CVNB                          WECVNB
     I              B3B0DT                          WEB0DT
     I              B3FKNB                          WEFKNB
     I              B3FMNB                          WEFMNB
     I              B3FLNB                          WEFLNB
     I              B3B6DT                          WEB6DT
     I              B3ANTM                          WEANTM
     I              B3JDA1                          WEJDA1
     I              B3CFDT                          WECFDT
     I              B3APTM                          WEAPTM
     I              B3I3ST                          WEI3ST
     I              B3HVNB                          WEHVNB
     I              B3CMCD                          WECMCD
     I              B3AAVN                          WEAAVN
     I              B3AADT                          WEAADT
     I              B3AMTM                          WEAMTM
     I              B3AJST                          WEAJST
     I              B3AHVN                          WEAHVN
     I              B3AGVN                          WEAGVN
     I              B3ABVN                          WEABVN
     I              B3ABDT                          WEABDT
     I              B3ABTM                          WEABTM
      *
     I@B3CPHL
      * Tattoo Scale Ticket       Retrieval index
      * Renamed input format fields
     I              B3HMNB                          WFHMNB
     I              B3BNNB                          WFBNNB
     I              B3BONB                          WFBONB
     I              B3CVNB                          WFCVNB
     I              B3B0DT                          WFB0DT
     I              B3FKNB                          WFFKNB
     I              B3FMNB                          WFFMNB
     I              B3FLNB                          WFFLNB
     I              B3B6DT                          WFB6DT
     I              B3ANTM                          WFANTM
     I              B3JDA1                          WFJDA1
     I              B3CFDT                          WFCFDT
     I              B3APTM                          WFAPTM
     I              B3I3ST                          WFI3ST
     I              B3HVNB                          WFHVNB
     I              B3CMCD                          WFCMCD
     I              B3AAVN                          WFAAVN
     I              B3AADT                          WFAADT
     I              B3AMTM                          WFAMTM
     I              B3AJST                          WFAJST
     I              B3AHVN                          WFAHVN
     I              B3AGVN                          WFAGVN
     I              B3ABVN                          WFABVN
     I              B3ABDT                          WFABDT
     I              B3ABTM                          WFABTM
      *
     I@AFCPI4
      * Delivery Tracking         BOH CO/BO/BOL/KillDt
      * Renamed input format fields
     I              AFHONB                          WGHONB
     I              AFE0DT                          WGE0DT
     I              AFE9DT                          WGE9DT
     I              AFAJTH                          WGAJTH
     I              AFH4A1                          WGH4A1
     I              AFFXDT                          WGFXDT
     I              AFJIA1                          WGJIA1
     I              AFIBA1                          WGIBA1
     I              AFW5ST                          WGW5ST
     I              AFICA1                          WGICA1
     I              AFK0CD                          WGK0CD
     I              AFK1CD                          WGK1CD
     I              AFLFCD                          WGLFCD
     I              AFLGCD                          WGLGCD
     I              AFIDA1                          WGIDA1
     I              AFIPA1                          WGIPA1
     I              AFLICD                          WGLICD
     I              AFJ8CD                          WGJ8CD
     I              AFJ9CD                          WGJ9CD
     I              AFMGCD                          WGMGCD
     I              AFXHST                          WGXHST
     I              AFXIST                          WGXIST
     I              AFIEA1                          WGIEA1
     I              AFKBCD                          WGKBCD
     I              AFKZCD                          WGKZCD
     I              AFLHCD                          WGLHCD
     I              AFFADT                          WGFADT
     I              AFAKTH                          WGAKTH
     I              AFBYTH                          WGBYTH
     I              AFW6ST                          WGW6ST
     I              AFXXST                          WGXXST
     I              AFFBDT                          WGFBDT
     I              AFALTH                          WGALTH
     I              AFBVTH                          WGBVTH
     I              AFAMTH                          WGAMTH
     I              AFFCDT                          WGFCDT
     I              AFANTH                          WGANTH
     I              AFBHTH                          WGBHTH
     I              AFFDDT                          WGFDDT
     I              AFAOTH                          WGAOTH
     I              AFBWTH                          WGBWTH
     I              AFAPTH                          WGAPTH
     I              AFFEDT                          WGFEDT
     I              AFAQTH                          WGAQTH
     I              AFARTH                          WGARTH
     I              AFFFDT                          WGFFDT
     I              AFASTH                          WGASTH
     I              AFATTH                          WGATTH
     I              AFFGDT                          WGFGDT
     I              AFAUTH                          WGAUTH
     I              AFFHDT                          WGFHDT
     I              AFAVTH                          WGAVTH
     I              AFAWTH                          WGAWTH
     I              AFBKTH                          WGBKTH
     I              AFBLTH                          WGBLTH
     I              AFXJST                          WGXJST
     I              AFK3CD                          WGK3CD
     I              AFFIDT                          WGFIDT
     I              AFAXTH                          WGAXTH
     I              AFAYTH                          WGAYTH
     I              AFFJDT                          WGFJDT
     I              AFAZTH                          WGAZTH
     I              AFA0TH                          WGA0TH
     I              AFFKDT                          WGFKDT
     I              AFA1TH                          WGA1TH
     I              AFA2TH                          WGA2TH
     I              AFFLDT                          WGFLDT
     I              AFA3TH                          WGA3TH
     I              AFA4TH                          WGA4TH
     I              AFBTTH                          WGBTTH
     I              AFFMDT                          WGFMDT
     I              AFA5TH                          WGA5TH
     I              AFA6TH                          WGA6TH
     I              AFBXTH                          WGBXTH
     I              AFXKST                          WGXKST
     I              AFYDST                          WGYDST
     I              AFFYDT                          WGFYDT
     I              AFB0TH                          WGB0TH
     I              AFBZTH                          WGBZTH
     I              AFH2A1                          WGH2A1
     I              AFJ2A1                          WGJ2A1
     I              AFJ3A1                          WGJ3A1
     I              AFKMA1                          WGKMA1
     I              AFJ4A1                          WGJ4A1
     I              AFJ5A1                          WGJ5A1
     I              AFJ6A1                          WGJ6A1
     I              AFJ7A1                          WGJ7A1
     I              AFJ8A1                          WGJ8A1
     I              AFJ9A1                          WGJ9A1
     I              AFKAA1                          WGKAA1
     I              AFKBA1                          WGKBA1
     I              AFKCA1                          WGKCA1
     I              AFKDA1                          WGKDA1
     I              AFKEA1                          WGKEA1
     I              AFKFA1                          WGKFA1
     I              AFKNA1                          WGKNA1
     I              AFKGA1                          WGKGA1
     I              AFKHA1                          WGKHA1
     I              AFKOA1                          WGKOA1
     I              AFKIA1                          WGKIA1
     I              AFKJA1                          WGKJA1
     I              AFKKA1                          WGKKA1
     I              AFKLA1                          WGKLA1
     I              AFYNST                          WGYNST
     I              AFYOST                          WGYOST
     I              AFABCD                          WGABCD
     I              AFAECD                          WGAECD
     I              AFAACD                          WGAACD
     I              AFHMNB                          WGHMNB
     I              AFBNNB                          WGBNNB
     I              AFBONB                          WGBONB
     I              AFAAVN                          WGAAVN
     I              AFAADT                          WGAADT
     I              AFAMTM                          WGAMTM
     I              AFAJST                          WGAJST
     I              AFAHVN                          WGAHVN
     I              AFAGVN                          WGAGVN
     I              AFABVN                          WGABVN
     I              AFABDT                          WGABDT
     I              AFABTM                          WGABTM
      *
     I@EMCPCZ
      * W001 Rest Time Eval Workf Co/bol/tatt/kill/seq/sq(
      * Renamed input format fields
     I              EMHMNB                          WHHMNB
     I              EMBNNB                          WHBNNB
     I              EMBONB                          WHBONB
     I              EMCVNB                          WHCVNB
     I              EMB0DT                          WHB0DT
     I              EMC2NB                          WHC2NB
     I              EMW0SQ                          WHW0SQ
     I              EMHVNB                          WHHVNB
     I              EMCMCD                          WHCMCD
     I              EMC0NB                          WHC0NB
     I              EMAJTM                          WHAJTM
     I              EMBXDT                          WHBXDT
     I              EMB6DT                          WHB6DT
     I              EMANTM                          WHANTM
     I              EMKAST                          WHKAST
     I              EMLIST                          WHLIST
     I              EMTRST                          WHTRST
     I              EMTSST                          WHTSST
     I              EMT2ST                          WHT2ST
     I              EMWSHD                          WHWSHD
     I              EMI1NB                          WHI1NB
     I              EMI5NB                          WHI5NB
     I              EMF7NB                          WHF7NB
     I              EMCXNB                          WHCXNB
     I              EMOXNB                          WHOXNB
     I              EMJUCD                          WHJUCD
     I              EMFWA1                          WHFWA1
     I              EMBBTM                          WHBBTM
     I              EMBCTM                          WHBCTM
     I              EMBDTM                          WHBDTM
     I              EMJVCD                          WHJVCD
      *
     I@EMCPCK
      * W001 Rest Time Eval Workf Update index
      * Renamed input format fields
     I              EMHMNB                          WIHMNB
     I              EMBNNB                          WIBNNB
     I              EMBONB                          WIBONB
     I              EMCVNB                          WICVNB
     I              EMB0DT                          WIB0DT
     I              EMC2NB                          WIC2NB
     I              EMW0SQ                          WIW0SQ
     I              EMHVNB                          WIHVNB
     I              EMCMCD                          WICMCD
     I              EMC0NB                          WIC0NB
     I              EMAJTM                          WIAJTM
     I              EMBXDT                          WIBXDT
     I              EMB6DT                          WIB6DT
     I              EMANTM                          WIANTM
     I              EMKAST                          WIKAST
     I              EMLIST                          WILIST
     I              EMTRST                          WITRST
     I              EMTSST                          WITSST
     I              EMT2ST                          WIT2ST
     I              EMWSHD                          WIWSHD
     I              EMI1NB                          WII1NB
     I              EMI5NB                          WII5NB
     I              EMF7NB                          WIF7NB
     I              EMCXNB                          WICXNB
     I              EMOXNB                          WIOXNB
     I              EMJUCD                          WIJUCD
     I              EMFWA1                          WIFWA1
     I              EMBBTM                          WIBBTM
     I              EMBCTM                          WIBCTM
     I              EMBDTM                          WIBDTM
     I              EMJVCD                          WIJVCD
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
     IXTCK2       DS
      * Time: hours, minutes, seconds (2)
     I                                        1   60XTTIM2
     I                                        1   20XTHH2
     I                                        3   40XTNN2
     I                                        5   60XTSS2
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
     IQPKEM1    E DSPKEMCPL0
      * UPD : W001 Rest Time Eval Workf Update index
      * Renamed input format fields
     I              EMHMNB                          WIHMNB
     I              EMBNNB                          WIBNNB
     I              EMBONB                          WIBONB
     I              EMCVNB                          WICVNB
     I              EMB0DT                          WIB0DT
     I              EMC2NB                          WIC2NB
     I              EMW0SQ                          WIW0SQ
     I              EMHVNB                          WIHVNB
     I              EMCMCD                          WICMCD
     I              EMC0NB                          WIC0NB
     I              EMAJTM                          WIAJTM
     I              EMBXDT                          WIBXDT
     I              EMB6DT                          WIB6DT
     I              EMANTM                          WIANTM
     I              EMKAST                          WIKAST
     I              EMLIST                          WILIST
     I              EMTRST                          WITRST
     I              EMTSST                          WITSST
     I              EMT2ST                          WIT2ST
     I              EMWSHD                          WIWSHD
     I              EMI1NB                          WII1NB
     I              EMI5NB                          WII5NB
     I              EMF7NB                          WIF7NB
     I              EMCXNB                          WICXNB
     I              EMOXNB                          WIOXNB
     I              EMJUCD                          WIJUCD
     I              EMFWA1                          WIFWA1
     I              EMBBTM                          WIBBTM
     I              EMBCTM                          WIBCTM
     I              EMBDTM                          WIBDTM
     I              EMJVCD                          WIJVCD
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: W001 Rest Time Eval Workf
      * I :  BOH Company Number
     I                                    P   1   20P1HMNB
      * I :  TH Tattoo Number
     I                                    P   3   50P1CVNB
      * I :  TH Kill Date
     I                                    P   6   90P1B0DT
      * I :  Pen Number
     I                                       10  12 P1CMCD
      * I :  TH Source Type
     I                                       13  13 P1KAST
      * I :  TH Schedule Kill Shift
     I                                       14  14 P1LIST
     IP2PARM      DS
      * I :  Date To   USR
     I                                    P   1   40P2B4DT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1CVNB    PARM           WP0002  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0003  70       TH Kill Date
     C           P1CMCD    PARM           WP0004  3        Pen Number
     C           P1KAST    PARM           WP0005  1        TH Source Type
     C           P1LIST    PARM           WP0006  1        TH Schedule Kil
     C           P2B4DT    PARM           WP0007  70       Date To   USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bld Rest Time Wrkf    XF
      * H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Num
      * PK0359 -- 1/21/2002  Added Sire Line fields to workfile
      * PK0359 -- 2/21/2002  Remove Sire Line fields from workfile
      * 02/26/02 PKD Added repeat for date range.
     C                     Z-ADDP1B0DT    YL0001           Date USR
      * DO WHILE: LCL.Date USR LE PAR.Date To   USR
     C           YL0001    DOWLEP2B4DT                     *DOW
      * Bld Rest Time Wrkf    RT - Tattoo Header  * 
     C                     EXSR SARVGN
      * LCL.Date USR = LCL.Date USR + CON.1 *DAYS
     C           YL0001    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     END                             *ITR
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Bld Rest Time Wrkf    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSA01           BOH Company Num
     C           *LIKE     DEFN WAB0DT    WQSA02           TH Kill Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WQSA02           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSA01           BOH Company Num
     C                     Z-ADDYL0001    WQSA02           TH Kill Date
      * Establish starting position
     C           KRSSA     SETLL@A1CPXO                    *
     C           KRSSA     READE@A1CPXO                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Schedule Kill Shift   USR EQ WRK.Blank USR
      *   |- c2    : PAR.Schedule Kill Shift   USR EQ DB1.TH Schedule Kil
      *   '-
     C           P1LIST    IFEQ WUCRTX                     *IF
     C           P1LIST    OREQ WALIST                     *OR
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.TH Source Type EQ WRK.Blank USR
      *   |- c2    : DB1.TH Source Type EQ PAR.TH Source Type
      *   '-
     C           P1KAST    IFEQ WUCRTX                     *IF
     C           WAKAST    OREQ P1KAST                     *OR
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH Tattoo Number EQ WRK.Zero USR
      *   |- c2    : DB1.TH Tattoo Number EQ PAR.TH Tattoo Number
      *   '-
     C           P1CVNB    IFEQ WUE9NB                     *IF
     C           WACVNB    OREQ P1CVNB                     *OR
      * Suppress rcd  if tattoo is completely held over
      * CASE:
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : DB1.TH Head Received is *Zeros
      *   |- c2    : DB1.TH Yard Deads is Zero
      *   |- c3    : DB1.TH Dead On Arrival is *Zeros
      *   |- c4    : DB1.TH Shift Held Over is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WACWNB    IFEQ 0                          *IF
     C           WAFCNB    IFEQ 0                          *IF
     C           WACXNB    IFEQ 0                          *IF
     C           WALJST    IFEQ *BLANK                     *IF
     C           WALJST    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * If TATTOO is Held over until tomorrow's kill
      * CASE: DB1.TH Held Over is *Zeros
     C           WAH9NB    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Bld Rest Time HoldOvr RT - Tattoo Header  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUCRTX    YL0014           W Held Over Sta
      * If Tattoo WAS held over from previous day, or until next shift
      * CASE: DB1.TH Held Over Record is Yes
     C           WAE1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'H+'      YL0014           W Held Over Sta
     C                     ELSE
      * CASE: DB1.TH Shift Held Over is Yes
     C           WALJST    IFEQ 'Y'                        *IF
     C                     MOVEL'S-'      YL0014           W Held Over Sta
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWAFCNB    WUFCNB           TH Yard Deads
     C                     Z-ADDWAT2HD    WUT2HD           TH Shift Held O
      * Rtv/Crt Rest Time EvalRT - Tattoo Detail  * 
     C                     EXSR SORVGN
      * Get H- records -- held over until the next day.
      * If TATTOO is Held over until tomorrow's kill
      * CASE: DB1.TH Held Over is *Zeros
     C           WAH9NB    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Bld Rest Time HoldOvr RT - Tattoo Header  * 
     C                     EXSR TARVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@A1CPXO                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Bld Rest Time HoldOvr RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSB01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSB02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSB03           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQSB04           TH Tattoo Numbe
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           BOH Buy Order N
     C                     KFLD           WQSB03           BOL Load Number
     C                     KFLD           WQSB04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQSB01           BOH Company Num
     C                     Z-ADDWABNNB    WQSB02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSB03           BOL Load Number
     C                     Z-ADDWACVNB    WQSB04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSB     SETLL@A1CPVF                    *
     C           KRSSB     READE@A1CPVF                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'H-'      YL0002           W Held Over Sta
     C                     Z-ADDWBFCNB    WUFCNB           TH Yard Deads
     C                     Z-ADDWBT2HD    WUT2HD           TH Shift Held O
      * Rtv/Crt Rest Time EvalRT - Tattoo Detail  * 
     C                     EXSR SCRVGN
     C           KRSSB     READE@A1CPVF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv/Crt Rest Time EvalRT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UASUBR                     Get the MTech L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSC01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSC02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSC03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSC04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQSC05           TH Kill Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           BOH Buy Order N
     C                     KFLD           WQSC03           BOL Load Number
     C                     KFLD           WQSC04           TH Tattoo Numbe
     C                     KFLD           WQSC05           TH Kill Date
      * Setup key
     C                     Z-ADDWBHMNB    WQSC01           BOH Company Num
     C                     Z-ADDWBBNNB    WQSC02           BOH Buy Order N
     C                     Z-ADDWBBONB    WQSC03           BOL Load Number
     C                     Z-ADDWBCVNB    WQSC04           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WQSC05           TH Kill Date
      * Establish starting position
     C           KRSSC     SETLL@A2CPNP                    *
     C           KRSSC     READE@A2CPNP                  90*
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Pen Type          RT - Pen  * 
     C                     EXSR SDRVGN
      * CASE: WRK.Pen Type is Resale
     C           WUFWST    IFEQ 'R'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Pen Number is Pen Number is Empty
      *   |- c2    : PAR.Pen Number EQ DB1.Pen Number
      *   '-
     C           P1CMCD    IFEQ *BLANK                     *IF
     C           P1CMCD    OREQ WCCMCD                     *OR
      * CASE: DB1.TD Drive Time is Not Zero
     C           WCAJTM    IFNE 0                          *IF
      * Rtv Scale dt,tm       RT - Tattoo Scale Ticket  * 
     C                     EXSR SERVGN
      * Get the wgt for the Tt without using the pen/or kill dt (ie.xfer,
      * CASE: WRK.TST Wgt Date EQ WRK.Zero USR
     C           WUB6DT    IFEQ WUE9NB                     *IF
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
     C                     EXSR SFRVGN
      * Drop the kill date ( may be a held over ttt)
      * CASE: WRK.TST Wgt Date EQ WRK.Zero USR
     C           WUB6DT    IFEQ WUE9NB                     *IF
      * Rtv Scale dt,tm,No KdtRT - Tattoo Scale Ticket  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWCC0NB    WUC0NB           TD Pen Head
      * If Shift Held Over AND Next day held over
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TD Held Over is greater than 0
      *   |- c2    : PAR.TH Shift Held Over is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCH7NB    IFGT 0                          *IF
     C           WBLJST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Combine the hd held over with hd rcvd here, we want the hd to be
      * accounted for in this shift, because the H- appears on Shift 2
     C           WCC0NB    ADD  WCH7NB    WUC0NB           TD Pen Head
     C                     END                             *FI
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0003    IFEQ 'N'                        *IF
      * Z1v HPS Grp from Mvmt UP - STR HPS Interface  * 
     C                     CALL 'HP258'                90  Z1v HPS Grp fro
     C           WULMST    PARM WULMST    WQ0004  7        Return Code USR
     C                     PARM WBOXNB    WQ0005  70       TH HPS Movement
     C           WUJUCD    PARM *BLANK    WQ0006  7        HPS Group Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP258'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Z1v HPS LdTm,TrvTm,Tp UP - STR HPS Interface  * 
     C                     CALL 'HP257'                90  Z1v HPS LdTm,Tr
     C           WULMST    PARM WULMST    WQ0007  7        Return Code USR
     C                     PARM WBOXNB    WQ0008  70       TH HPS Movement
     C           WUJVCD    PARM *BLANK    WQ0009  2        HPE Load Type
     C           WUBETM    PARM *ZERO     WQ0010  40       HPS Shipped In
     C           WUBFTM    PARM *ZERO     WQ0011  40       HPS Shipped Out
     C           WUEWDT    PARM *ZERO     WQ0012  70       HPS Shipped In
     C           WUEXDT    PARM *ZERO     WQ0013  70       HPS Shipped Out
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP257'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * review and found that not all of these fields going into HPE
      * were being populated due to changes to HPS and decission to
      * to send the data to HPE as blank or zero
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0003    IFEQ 'Y'                        *IF
      * Meeting with Purva and decission was to get information
      * from the delivery tracking when live with mtech
      * Rtv Tracking Info     RT - Delivery Tracking  * 
     C                     EXSR SHRVGN
     C                     MOVELWULGCD    WUJUCD           W Group Referen
     C                     MOVELWUXHST    WUJVCD           HPE Load Type
     C                     Z-ADD*ZERO     WUBETM           HPS Shipped In
     C                     Z-ADD*ZERO     WUBFTM           HPS Shipped Out
     C                     Z-ADD*ZERO     WUEWDT           HPS Shipped In
     C                     Z-ADD*ZERO     WUEXDT           HPS Shipped Out
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Stress Pens Only  XF - Pen Ext  * 
     C                     CALL 'PLPJXFR'              90  Rtv Stress Pens
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCHVNB    WQ0014  30       Pen Company Num
     C                     PARM WCCMCD    WQ0015  3        Pen Number
     C           YL0004    PARM YL0004    WQ0016  1        Stress/Market T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLPJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Crt W001 Rest Time Evl IF
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
     C                     EXSR SIRVGN
      * **** Calc Wait Time Diff
     C                     Z-ADDWCAJTM    YL0006           TD Drive Time
      * CASE: PAR.TD Drive Date NE PAR.TST Wgt Date
     C           WCBXDT    IFNE WUB6DT                     *IF
      * LCL.Number 1 USR = PAR.TD Drive Date - PAR.TST Wgt Date *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUB6DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WCBXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0006           TD Drive Time
     C                     END                             *FI
      * LCL.Time Diff Usr = LCL.TD Drive Time - PAR.TST Wgt Time *HHMMSS
     C                     Z-ADDWUANTM    XTTIM2
     C                     Z-ADDYL0006    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0009
     C                     ADD  XTNN      YL0009
     C                     MULT 100       YL0009
     C                     ADD  XTSS      YL0009
     C                     MULT XSGN      YL0009
      * ****
     C                     Z-ADD*ZERO     YL0010           W Load Time Dif
     C                     Z-ADD*ZERO     YL0011           W Travel Time D
      * **** Calc Load Time Diff     3/26/02
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.HPS Shipped In Time is Entered
      *   |- c2    : PAR.HPS Shipped Out Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUBETM    IFNE 0                          *IF
     C           WUBFTM    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           100       MULT WUBFTM    YL0012           Time End USR
     C           100       MULT WUBETM    YL0013           Time Beg USR
      * CASE: PAR.HPS Shipped Out Date NE PAR.HPS Shipped In Date
     C           WUEXDT    IFNE WUEWDT                     *IF
      * LCL.Number 1 USR = PAR.HPS Shipped Out Date - PAR.HPS Shipped In
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUEWDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WUEXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0012           Time End USR
     C                     END                             *FI
      * LCL.W Load Time Difference = LCL.Time End USR - LCL.Time Beg USR
     C                     Z-ADDYL0013    XTTIM2
     C                     Z-ADDYL0012    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0010
     C                     ADD  XTNN      YL0010
     C                     MULT 100       YL0010
     C                     ADD  XTSS      YL0010
     C                     MULT XSGN      YL0010
     C                     END                             *FI
      * **** Calc travel Time Diff     3/26/02
      * CASE: PAR.HPS Shipped Out Time is Entered
     C           WUBFTM    IFNE 0                          *IF
     C                     Z-ADDWUANTM    YL0012           Time End USR
     C           100       MULT WUBFTM    YL0013           Time Beg USR
      * CASE: PAR.HPS Shipped Out Date NE PAR.TST Wgt Date
     C           WUEXDT    IFNE WUB6DT                     *IF
      * LCL.Number 1 USR = PAR.TST Wgt Date - PAR.HPS Shipped Out Date *D
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUEXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WUB6DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0012           Time End USR
     C                     END                             *FI
      * LCL.W Travel Time Difference = LCL.Time End USR - LCL.Time Beg US
     C                     Z-ADDYL0013    XTTIM2
     C                     Z-ADDYL0012    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0011
     C                     ADD  XTNN      YL0011
     C                     MULT 100       YL0011
     C                     ADD  XTSS      YL0011
     C                     MULT XSGN      YL0011
     C                     END                             *FI
      * ****
      * Crt W001 Rest Time Eval - W001 Rest Time Eval Workf  * 
     C                     EXSR SJCRRC
     C                     Z-ADD*ZERO     WUFCNB           TH Yard Deads
      * Create S+ if Shift_1_only not selected
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Schedule Kill Shift   USR is Shift 2
      *   |- c2    : PAR.Schedule Kill Shift   USR EQ WRK.Blank USR
      *   '-
     C           P1LIST    IFEQ '2'                        *IF
     C           P1LIST    OREQ WUCRTX                     *OR
      * Create S+ record for shift 2
      * CASE: PAR.TH Shift Held Over Head is Not Zero
     C           WUT2HD    IFNE 0                          *IF
      * Crt W001 Rest Time Evl IF
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
     C                     EXSR SLRVGN
      * **** Calc Wait Time Diff
     C                     Z-ADDWCAJTM    YL0006           TD Drive Time
      * CASE: PAR.TD Drive Date NE PAR.TST Wgt Date
     C           WCBXDT    IFNE WUB6DT                     *IF
      * LCL.Number 1 USR = PAR.TD Drive Date - PAR.TST Wgt Date *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUB6DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WCBXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0006           TD Drive Time
     C                     END                             *FI
      * LCL.Time Diff Usr = LCL.TD Drive Time - PAR.TST Wgt Time *HHMMSS
     C                     Z-ADDWUANTM    XTTIM2
     C                     Z-ADDYL0006    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0009
     C                     ADD  XTNN      YL0009
     C                     MULT 100       YL0009
     C                     ADD  XTSS      YL0009
     C                     MULT XSGN      YL0009
      * ****
     C                     Z-ADD*ZERO     YL0010           W Load Time Dif
     C                     Z-ADD*ZERO     YL0011           W Travel Time D
      * **** Calc Load Time Diff     3/26/02
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.HPS Shipped In Time is Entered
      *   |- c2    : PAR.HPS Shipped Out Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUBETM    IFNE 0                          *IF
     C           WUBFTM    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           100       MULT WUBFTM    YL0012           Time End USR
     C           100       MULT WUBETM    YL0013           Time Beg USR
      * CASE: PAR.HPS Shipped Out Date NE PAR.HPS Shipped In Date
     C           WUEXDT    IFNE WUEWDT                     *IF
      * LCL.Number 1 USR = PAR.HPS Shipped Out Date - PAR.HPS Shipped In
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUEWDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WUEXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0012           Time End USR
     C                     END                             *FI
      * LCL.W Load Time Difference = LCL.Time End USR - LCL.Time Beg USR
     C                     Z-ADDYL0013    XTTIM2
     C                     Z-ADDYL0012    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0010
     C                     ADD  XTNN      YL0010
     C                     MULT 100       YL0010
     C                     ADD  XTSS      YL0010
     C                     MULT XSGN      YL0010
     C                     END                             *FI
      * **** Calc travel Time Diff     3/26/02
      * CASE: PAR.HPS Shipped Out Time is Entered
     C           WUBFTM    IFNE 0                          *IF
     C                     Z-ADDWUANTM    YL0012           Time End USR
     C           100       MULT WUBFTM    YL0013           Time Beg USR
      * CASE: PAR.HPS Shipped Out Date NE PAR.TST Wgt Date
     C           WUEXDT    IFNE WUB6DT                     *IF
      * LCL.Number 1 USR = PAR.TST Wgt Date - PAR.HPS Shipped Out Date *D
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUEXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WUB6DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0012           Time End USR
     C                     END                             *FI
      * LCL.W Travel Time Difference = LCL.Time End USR - LCL.Time Beg US
     C                     Z-ADDYL0013    XTTIM2
     C                     Z-ADDYL0012    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0011
     C                     ADD  XTNN      YL0011
     C                     MULT 100       YL0011
     C                     ADD  XTSS      YL0011
     C                     MULT XSGN      YL0011
     C                     END                             *FI
      * ****
      * Crt W001 Rest Time Eval - W001 Rest Time Eval Workf  * 
     C                     EXSR SMCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUT2HD           TH Shift Held O
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@A2CPNP                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Pen Type          RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDHVNB           Pen Company Num
     C                     KFLD           WDCMCD           Pen Number
      * Setup key
     C                     Z-ADDWCHVNB    WDHVNB           Pen Company Num
     C                     MOVELWCCMCD    WDCMCD           Pen Number
      * Establish starting position
     C           KRSSD     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDFWST    WUFWST           Pen Type
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm       RT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEHMNB    WQSE01           BOH Company Num
     C           *LIKE     DEFN WECMCD    WQSE02           Pen Number
     C           *LIKE     DEFN WEBNNB    WQSE03           BOH Buy Order N
     C           *LIKE     DEFN WEBONB    WQSE04           BOL Load Number
     C           *LIKE     DEFN WECVNB    WQSE05           TH Tattoo Numbe
     C           *LIKE     DEFN WEB0DT    WQSE06           TH Kill Date
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           BOH Company Num
     C                     KFLD           WQSE02           Pen Number
     C                     KFLD           WQSE03           BOH Buy Order N
     C                     KFLD           WQSE04           BOL Load Number
     C                     KFLD           WQSE05           TH Tattoo Numbe
     C                     KFLD           WQSE06           TH Kill Date
      * Setup key
     C                     Z-ADDWCHMNB    WQSE01           BOH Company Num
     C                     MOVELWCCMCD    WQSE02           Pen Number
     C                     Z-ADDWCBNNB    WQSE03           BOH Buy Order N
     C                     Z-ADDWCBONB    WQSE04           BOL Load Number
     C                     Z-ADDWCCVNB    WQSE05           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WQSE06           TH Kill Date
      * Establish starting position
     C           KRSSE     SETLL@B3CPU6                    *
     C           KRSSE     READE@B3CPU6                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     WUANTM           TST Wgt Time
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEB6DT    WUB6DT           TST Wgt Date
     C                     Z-ADDWEANTM    WUANTM           TST Wgt Time
     C           KRSSE     READE@B3CPU6                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQSF02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQSF03           BOL Load Number
     C           *LIKE     DEFN WFCVNB    WQSF04           TH Tattoo Numbe
     C           *LIKE     DEFN WFB0DT    WQSF05           TH Kill Date
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
     C                     KFLD           WQSF04           TH Tattoo Numbe
     C                     KFLD           WQSF05           TH Kill Date
      * Setup key
     C                     Z-ADDWCHMNB    WQSF01           BOH Company Num
     C                     Z-ADDWCBNNB    WQSF02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQSF03           BOL Load Number
     C                     Z-ADDWCCVNB    WQSF04           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WQSF05           TH Kill Date
      * Establish starting position
     C           KRSSF     SETLL@B3CPHL                    *
     C           KRSSF     READE@B3CPHL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     WUANTM           TST Wgt Time
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFB6DT    WUB6DT           TST Wgt Date
     C                     Z-ADDWFANTM    WUANTM           TST Wgt Time
     C           KRSSF     READE@B3CPHL                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm,No KdtRT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQSG01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQSG02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQSG03           BOL Load Number
     C           *LIKE     DEFN WFCVNB    WQSG04           TH Tattoo Numbe
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           BOH Company Num
     C                     KFLD           WQSG02           BOH Buy Order N
     C                     KFLD           WQSG03           BOL Load Number
     C                     KFLD           WQSG04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWCHMNB    WQSG01           BOH Company Num
     C                     Z-ADDWCBNNB    WQSG02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQSG03           BOL Load Number
     C                     Z-ADDWCCVNB    WQSG04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSG     SETLL@B3CPHL                    *
     C           KRSSG     READE@B3CPHL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     WUANTM           TST Wgt Time
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFB6DT    WUB6DT           TST Wgt Date
     C                     Z-ADDWFANTM    WUANTM           TST Wgt Time
     C           KRSSG     READE@B3CPHL                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Tracking Info     RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQSH01           BOH Company Num
     C           *LIKE     DEFN WGBNNB    WQSH02           BOH Buy Order N
     C           *LIKE     DEFN WGBONB    WQSH03           BOL Load Number
     C           *LIKE     DEFN WGE0DT    WQSH04           DSH Kill Date
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           BOH Company Num
     C                     KFLD           WQSH02           BOH Buy Order N
     C                     KFLD           WQSH03           BOL Load Number
     C                     KFLD           WQSH04           DSH Kill Date
      * Setup key
     C                     Z-ADDWCHMNB    WQSH01           BOH Company Num
     C                     Z-ADDWCBNNB    WQSH02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQSH03           BOL Load Number
     C                     Z-ADDWCB0DT    WQSH04           DSH Kill Date
      * Establish starting position
     C           KRSSH     SETLL@AFCPI4                    *
     C           KRSSH     READE@AFCPI4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1030' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WULGCD           DT Hog Group Re
     C                     MOVEL*BLANK    WUXHST           DT Load Type
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = CND By name
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSI01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSI02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSI03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQSI04           TH Tattoo Numbe
     C           *LIKE     DEFN WHB0DT    WQSI05           TH Kill Date
     C           *LIKE     DEFN WHC2NB    WQSI06           TD Sequence Num
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           BOH Company Num
     C                     KFLD           WQSI02           BOH Buy Order N
     C                     KFLD           WQSI03           BOL Load Number
     C                     KFLD           WQSI04           TH Tattoo Numbe
     C                     KFLD           WQSI05           TH Kill Date
     C                     KFLD           WQSI06           TD Sequence Num
      * Setup key
     C                     Z-ADDWCHMNB    WQSI01           BOH Company Num
     C                     Z-ADDWCBNNB    WQSI02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQSI03           BOL Load Number
     C                     Z-ADDWCCVNB    WQSI04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQSI05           TH Kill Date
     C                     Z-ADDWCC2NB    WQSI06           TD Sequence Num
      * Establish starting position
     C           KRSSI     SETLL@EMCPCZ                    *
     C           KRSSI     READE@EMCPCZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0884' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUW0SQ           W Sequence Numb
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WUW0SQ           W Sequence Numb
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@EMCPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt W001 Rest Time Eval - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EMCPCK
     C                     Z-ADDWCHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WIBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     Z-ADDWCC2NB    WIC2NB           TD Sequence Num
     C                     Z-ADDWUW0SQ    WIW0SQ           W Sequence Numb
     C                     Z-ADDWCHVNB    WIHVNB           Pen Company Num
     C                     MOVELWCCMCD    WICMCD           Pen Number
     C                     Z-ADDWUC0NB    WIC0NB           TD Pen Head
     C                     Z-ADDWCAJTM    WIAJTM           TD Drive Time
     C                     Z-ADDWCBXDT    WIBXDT           TD Drive Date
     C                     Z-ADDWUB6DT    WIB6DT           TST Wgt Date
     C                     Z-ADDWUANTM    WIANTM           TST Wgt Time
     C                     MOVELWBKAST    WIKAST           TH Source Type
     C                     MOVELWALIST    WILIST           TH Schedule Kil
     C                     MOVELWUCRTX    WITRST           Tattoo Status
     C                     MOVELYL0005    WITSST           W Stress/Market
     C                     MOVELYL0002    WIT2ST           W Held Over Sta
     C                     Z-ADDWUT2HD    WIWSHD           W Shift Held Ov
     C                     Z-ADDWCH7NB    WII1NB           W Held Over Hea
     C                     Z-ADDWUFCNB    WII5NB           W Yard Dead
     C                     Z-ADDWBF7NB    WIF7NB           TH Avg Live Wgt
     C                     Z-ADDWBCXNB    WICXNB           TH Dead On Arri
     C                     Z-ADDWBOXNB    WIOXNB           TH HPS Movement
     C                     MOVELWUJUCD    WIJUCD           W Group Referen
     C                     Z-ADDWBTHHD    WIFWA1           W Farm Site
     C                     Z-ADDYL0009    WIBBTM           W Wait Time Dif
     C                     Z-ADDYL0010    WIBCTM           W Load Time Dif
     C                     Z-ADDYL0011    WIBDTM           W Travel Time D
     C                     MOVELWUJVCD    WIJVCD           HPE Load Type
      *
      * USER: Processing before Data update
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
     C                     EXSR SKRVGN
     C           KLCRSJ    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIC2NB           TD Sequence Num
     C                     KFLD           WIW0SQ           W Sequence Numb
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@EMCPCK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0885' W0RTN   7
      * Send message 'W001 Rest Time Eval Wo EX'
     C                     MOVEL'PRK0885' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@EMCPCK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSK01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSK02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSK03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQSK04           TH Tattoo Numbe
     C           *LIKE     DEFN WHB0DT    WQSK05           TH Kill Date
     C           *LIKE     DEFN WHC2NB    WQSK06           TD Sequence Num
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           BOH Company Num
     C                     KFLD           WQSK02           BOH Buy Order N
     C                     KFLD           WQSK03           BOL Load Number
     C                     KFLD           WQSK04           TH Tattoo Numbe
     C                     KFLD           WQSK05           TH Kill Date
     C                     KFLD           WQSK06           TD Sequence Num
      * Setup key
     C                     Z-ADDWIHMNB    WQSK01           BOH Company Num
     C                     Z-ADDWIBNNB    WQSK02           BOH Buy Order N
     C                     Z-ADDWIBONB    WQSK03           BOL Load Number
     C                     Z-ADDWICVNB    WQSK04           TH Tattoo Numbe
     C                     Z-ADDWIB0DT    WQSK05           TH Kill Date
     C                     Z-ADDWIC2NB    WQSK06           TD Sequence Num
      * Establish starting position
     C           KRSSK     SETLL@EMCPCZ                    *
     C           KRSSK     READE@EMCPCZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0884' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WIW0SQ           W Sequence Numb
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WIW0SQ           W Sequence Numb
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@EMCPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSL01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSL02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSL03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQSL04           TH Tattoo Numbe
     C           *LIKE     DEFN WHB0DT    WQSL05           TH Kill Date
     C           *LIKE     DEFN WHC2NB    WQSL06           TD Sequence Num
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           BOH Company Num
     C                     KFLD           WQSL02           BOH Buy Order N
     C                     KFLD           WQSL03           BOL Load Number
     C                     KFLD           WQSL04           TH Tattoo Numbe
     C                     KFLD           WQSL05           TH Kill Date
     C                     KFLD           WQSL06           TD Sequence Num
      * Setup key
     C                     Z-ADDWCHMNB    WQSL01           BOH Company Num
     C                     Z-ADDWCBNNB    WQSL02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQSL03           BOL Load Number
     C                     Z-ADDWCCVNB    WQSL04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQSL05           TH Kill Date
     C                     Z-ADDWCC2NB    WQSL06           TD Sequence Num
      * Establish starting position
     C           KRSSL     SETLL@EMCPCZ                    *
     C           KRSSL     READE@EMCPCZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0884' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUW0SQ           W Sequence Numb
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WUW0SQ           W Sequence Numb
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@EMCPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Crt W001 Rest Time Eval - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EMCPCK
     C                     Z-ADDWCHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WIBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     Z-ADDWCC2NB    WIC2NB           TD Sequence Num
     C                     Z-ADDWUW0SQ    WIW0SQ           W Sequence Numb
     C                     Z-ADDWCHVNB    WIHVNB           Pen Company Num
     C                     MOVELWCCMCD    WICMCD           Pen Number
     C                     Z-ADD*ZERO     WIC0NB           TD Pen Head
     C                     Z-ADDWCAJTM    WIAJTM           TD Drive Time
     C                     Z-ADDWCBXDT    WIBXDT           TD Drive Date
     C                     Z-ADDWUB6DT    WIB6DT           TST Wgt Date
     C                     Z-ADDWUANTM    WIANTM           TST Wgt Time
     C                     MOVELWBKAST    WIKAST           TH Source Type
     C                     MOVEL'2'       WILIST           TH Schedule Kil
     C                     MOVELWUCRTX    WITRST           Tattoo Status
     C                     MOVELWUCRTX    WITSST           W Stress/Market
     C                     MOVEL'S+'      WIT2ST           W Held Over Sta
     C                     Z-ADDWUT2HD    WIWSHD           W Shift Held Ov
     C                     Z-ADDWCH7NB    WII1NB           W Held Over Hea
     C                     Z-ADDWUFCNB    WII5NB           W Yard Dead
     C                     Z-ADDWBF7NB    WIF7NB           TH Avg Live Wgt
     C                     Z-ADDWBCXNB    WICXNB           TH Dead On Arri
     C                     Z-ADDWBOXNB    WIOXNB           TH HPS Movement
     C                     MOVELWUJUCD    WIJUCD           W Group Referen
     C                     Z-ADDWBTHHD    WIFWA1           W Farm Site
     C                     Z-ADDYL0009    WIBBTM           W Wait Time Dif
     C                     Z-ADDYL0010    WIBCTM           W Load Time Dif
     C                     Z-ADDYL0011    WIBDTM           W Travel Time D
     C                     MOVELWUJVCD    WIJVCD           HPE Load Type
      *
      * USER: Processing before Data update
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
     C                     EXSR SNRVGN
     C           KLCRSM    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIC2NB           TD Sequence Num
     C                     KFLD           WIW0SQ           W Sequence Numb
      * Check for duplicate primary key
     C           KLCRSM    SETLL@EMCPCK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0885' W0RTN   7
      * Send message 'W001 Rest Time Eval Wo EX'
     C                     MOVEL'PRK0885' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@EMCPCK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSN01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSN02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSN03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQSN04           TH Tattoo Numbe
     C           *LIKE     DEFN WHB0DT    WQSN05           TH Kill Date
     C           *LIKE     DEFN WHC2NB    WQSN06           TD Sequence Num
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           BOH Company Num
     C                     KFLD           WQSN02           BOH Buy Order N
     C                     KFLD           WQSN03           BOL Load Number
     C                     KFLD           WQSN04           TH Tattoo Numbe
     C                     KFLD           WQSN05           TH Kill Date
     C                     KFLD           WQSN06           TD Sequence Num
      * Setup key
     C                     Z-ADDWIHMNB    WQSN01           BOH Company Num
     C                     Z-ADDWIBNNB    WQSN02           BOH Buy Order N
     C                     Z-ADDWIBONB    WQSN03           BOL Load Number
     C                     Z-ADDWICVNB    WQSN04           TH Tattoo Numbe
     C                     Z-ADDWIB0DT    WQSN05           TH Kill Date
     C                     Z-ADDWIC2NB    WQSN06           TD Sequence Num
      * Establish starting position
     C           KRSSN     SETLL@EMCPCZ                    *
     C           KRSSN     READE@EMCPCZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0884' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WIW0SQ           W Sequence Numb
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WIW0SQ           W Sequence Numb
     C                     GOTO SNEXIT                     *QUIT
     C           KRSSN     READE@EMCPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv/Crt Rest Time EvalRT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UBSUBR                     Get the MTech L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSO01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSO02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSO03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSO04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQSO05           TH Kill Date
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           BOH Company Num
     C                     KFLD           WQSO02           BOH Buy Order N
     C                     KFLD           WQSO03           BOL Load Number
     C                     KFLD           WQSO04           TH Tattoo Numbe
     C                     KFLD           WQSO05           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WQSO01           BOH Company Num
     C                     Z-ADDWABNNB    WQSO02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSO03           BOL Load Number
     C                     Z-ADDWACVNB    WQSO04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQSO05           TH Kill Date
      * Establish starting position
     C           KRSSO     SETLL@A2CPNP                    *
     C           KRSSO     READE@A2CPNP                  90*
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Pen Type          RT - Pen  * 
     C                     EXSR SPRVGN
      * CASE: WRK.Pen Type is Resale
     C           WUFWST    IFEQ 'R'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Pen Number is Pen Number is Empty
      *   |- c2    : PAR.Pen Number EQ DB1.Pen Number
      *   '-
     C           P1CMCD    IFEQ *BLANK                     *IF
     C           P1CMCD    OREQ WCCMCD                     *OR
      * CASE: DB1.TD Drive Time is Not Zero
     C           WCAJTM    IFNE 0                          *IF
      * Rtv Scale dt,tm       RT - Tattoo Scale Ticket  * 
     C                     EXSR SQRVGN
      * Get the wgt for the Tt without using the pen/or kill dt (ie.xfer,
      * CASE: WRK.TST Wgt Date EQ WRK.Zero USR
     C           WUB6DT    IFEQ WUE9NB                     *IF
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
     C                     EXSR SRRVGN
      * Drop the kill date ( may be a held over ttt)
      * CASE: WRK.TST Wgt Date EQ WRK.Zero USR
     C           WUB6DT    IFEQ WUE9NB                     *IF
      * Rtv Scale dt,tm,No KdtRT - Tattoo Scale Ticket  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWCC0NB    WUC0NB           TD Pen Head
      * If Shift Held Over AND Next day held over
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TD Held Over is greater than 0
      *   |- c2    : PAR.TH Shift Held Over is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCH7NB    IFGT 0                          *IF
     C           WALJST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Combine the hd held over with hd rcvd here, we want the hd to be
      * accounted for in this shift, because the H- appears on Shift 2
     C           WCC0NB    ADD  WCH7NB    WUC0NB           TD Pen Head
     C                     END                             *FI
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0003    IFEQ 'N'                        *IF
      * Z1v HPS Grp from Mvmt UP - STR HPS Interface  * 
     C                     CALL 'HP258'                90  Z1v HPS Grp fro
     C           WULMST    PARM WULMST    WQ0020  7        Return Code USR
     C                     PARM WAOXNB    WQ0021  70       TH HPS Movement
     C           WUJUCD    PARM *BLANK    WQ0022  7        HPS Group Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP258'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Z1v HPS LdTm,TrvTm,Tp UP - STR HPS Interface  * 
     C                     CALL 'HP257'                90  Z1v HPS LdTm,Tr
     C           WULMST    PARM WULMST    WQ0023  7        Return Code USR
     C                     PARM WAOXNB    WQ0024  70       TH HPS Movement
     C           WUJVCD    PARM *BLANK    WQ0025  2        HPE Load Type
     C           WUBETM    PARM *ZERO     WQ0026  40       HPS Shipped In
     C           WUBFTM    PARM *ZERO     WQ0027  40       HPS Shipped Out
     C           WUEWDT    PARM *ZERO     WQ0028  70       HPS Shipped In
     C           WUEXDT    PARM *ZERO     WQ0029  70       HPS Shipped Out
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP257'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * review and found that not all of these fields going into HPE
      * were being populated due to changes to HPS and decission to
      * to send the data to HPE as blank or zero
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0003    IFEQ 'Y'                        *IF
      * Meeting with Purva and decission was to get information
      * from the delivery tracking when live with mtech
      * Rtv Tracking Info     RT - Delivery Tracking  * 
     C                     EXSR STRVGN
     C                     MOVELWULGCD    WUJUCD           W Group Referen
     C                     MOVELWUXHST    WUJVCD           HPE Load Type
     C                     Z-ADD*ZERO     WUBETM           HPS Shipped In
     C                     Z-ADD*ZERO     WUBFTM           HPS Shipped Out
     C                     Z-ADD*ZERO     WUEWDT           HPS Shipped In
     C                     Z-ADD*ZERO     WUEXDT           HPS Shipped Out
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Stress Pens Only  XF - Pen Ext  * 
     C                     CALL 'PLPJXFR'              90  Rtv Stress Pens
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCHVNB    WQ0030  30       Pen Company Num
     C                     PARM WCCMCD    WQ0031  3        Pen Number
     C           YL0004    PARM YL0004    WQ0032  1        Stress/Market T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLPJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Crt W001 Rest Time Evl IF
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
     C                     EXSR SURVGN
      * **** Calc Wait Time Diff
     C                     Z-ADDWCAJTM    YL0006           TD Drive Time
      * CASE: PAR.TD Drive Date NE PAR.TST Wgt Date
     C           WCBXDT    IFNE WUB6DT                     *IF
      * LCL.Number 1 USR = PAR.TD Drive Date - PAR.TST Wgt Date *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUB6DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WCBXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0006           TD Drive Time
     C                     END                             *FI
      * LCL.Time Diff Usr = LCL.TD Drive Time - PAR.TST Wgt Time *HHMMSS
     C                     Z-ADDWUANTM    XTTIM2
     C                     Z-ADDYL0006    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0009
     C                     ADD  XTNN      YL0009
     C                     MULT 100       YL0009
     C                     ADD  XTSS      YL0009
     C                     MULT XSGN      YL0009
      * ****
     C                     Z-ADD*ZERO     YL0010           W Load Time Dif
     C                     Z-ADD*ZERO     YL0011           W Travel Time D
      * **** Calc Load Time Diff     3/26/02
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.HPS Shipped In Time is Entered
      *   |- c2    : PAR.HPS Shipped Out Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUBETM    IFNE 0                          *IF
     C           WUBFTM    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           100       MULT WUBFTM    YL0012           Time End USR
     C           100       MULT WUBETM    YL0013           Time Beg USR
      * CASE: PAR.HPS Shipped Out Date NE PAR.HPS Shipped In Date
     C           WUEXDT    IFNE WUEWDT                     *IF
      * LCL.Number 1 USR = PAR.HPS Shipped Out Date - PAR.HPS Shipped In
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUEWDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WUEXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0012           Time End USR
     C                     END                             *FI
      * LCL.W Load Time Difference = LCL.Time End USR - LCL.Time Beg USR
     C                     Z-ADDYL0013    XTTIM2
     C                     Z-ADDYL0012    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0010
     C                     ADD  XTNN      YL0010
     C                     MULT 100       YL0010
     C                     ADD  XTSS      YL0010
     C                     MULT XSGN      YL0010
     C                     END                             *FI
      * **** Calc travel Time Diff     3/26/02
      * CASE: PAR.HPS Shipped Out Time is Entered
     C           WUBFTM    IFNE 0                          *IF
     C                     Z-ADDWUANTM    YL0012           Time End USR
     C           100       MULT WUBFTM    YL0013           Time Beg USR
      * CASE: PAR.HPS Shipped Out Date NE PAR.TST Wgt Date
     C           WUEXDT    IFNE WUB6DT                     *IF
      * LCL.Number 1 USR = PAR.TST Wgt Date - PAR.HPS Shipped Out Date *D
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUEXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WUB6DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0012           Time End USR
     C                     END                             *FI
      * LCL.W Travel Time Difference = LCL.Time End USR - LCL.Time Beg US
     C                     Z-ADDYL0013    XTTIM2
     C                     Z-ADDYL0012    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0011
     C                     ADD  XTNN      YL0011
     C                     MULT 100       YL0011
     C                     ADD  XTSS      YL0011
     C                     MULT XSGN      YL0011
     C                     END                             *FI
      * ****
      * Crt W001 Rest Time Eval - W001 Rest Time Eval Workf  * 
     C                     EXSR SVCRRC
     C                     Z-ADD*ZERO     WUFCNB           TH Yard Deads
      * Create S+ if Shift_1_only not selected
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Schedule Kill Shift   USR is Shift 2
      *   |- c2    : PAR.Schedule Kill Shift   USR EQ WRK.Blank USR
      *   '-
     C           P1LIST    IFEQ '2'                        *IF
     C           P1LIST    OREQ WUCRTX                     *OR
      * Create S+ record for shift 2
      * CASE: PAR.TH Shift Held Over Head is Not Zero
     C           WUT2HD    IFNE 0                          *IF
      * Crt W001 Rest Time Evl IF
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
     C                     EXSR SXRVGN
      * **** Calc Wait Time Diff
     C                     Z-ADDWCAJTM    YL0006           TD Drive Time
      * CASE: PAR.TD Drive Date NE PAR.TST Wgt Date
     C           WCBXDT    IFNE WUB6DT                     *IF
      * LCL.Number 1 USR = PAR.TD Drive Date - PAR.TST Wgt Date *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUB6DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WCBXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0006           TD Drive Time
     C                     END                             *FI
      * LCL.Time Diff Usr = LCL.TD Drive Time - PAR.TST Wgt Time *HHMMSS
     C                     Z-ADDWUANTM    XTTIM2
     C                     Z-ADDYL0006    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0009
     C                     ADD  XTNN      YL0009
     C                     MULT 100       YL0009
     C                     ADD  XTSS      YL0009
     C                     MULT XSGN      YL0009
      * ****
     C                     Z-ADD*ZERO     YL0010           W Load Time Dif
     C                     Z-ADD*ZERO     YL0011           W Travel Time D
      * **** Calc Load Time Diff     3/26/02
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.HPS Shipped In Time is Entered
      *   |- c2    : PAR.HPS Shipped Out Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUBETM    IFNE 0                          *IF
     C           WUBFTM    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           100       MULT WUBFTM    YL0012           Time End USR
     C           100       MULT WUBETM    YL0013           Time Beg USR
      * CASE: PAR.HPS Shipped Out Date NE PAR.HPS Shipped In Date
     C           WUEXDT    IFNE WUEWDT                     *IF
      * LCL.Number 1 USR = PAR.HPS Shipped Out Date - PAR.HPS Shipped In
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUEWDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WUEXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0012           Time End USR
     C                     END                             *FI
      * LCL.W Load Time Difference = LCL.Time End USR - LCL.Time Beg USR
     C                     Z-ADDYL0013    XTTIM2
     C                     Z-ADDYL0012    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0010
     C                     ADD  XTNN      YL0010
     C                     MULT 100       YL0010
     C                     ADD  XTSS      YL0010
     C                     MULT XSGN      YL0010
     C                     END                             *FI
      * **** Calc travel Time Diff     3/26/02
      * CASE: PAR.HPS Shipped Out Time is Entered
     C           WUBFTM    IFNE 0                          *IF
     C                     Z-ADDWUANTM    YL0012           Time End USR
     C           100       MULT WUBFTM    YL0013           Time Beg USR
      * CASE: PAR.HPS Shipped Out Date NE PAR.TST Wgt Date
     C           WUEXDT    IFNE WUB6DT                     *IF
      * LCL.Number 1 USR = PAR.TST Wgt Date - PAR.HPS Shipped Out Date *D
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUEXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WUB6DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0012           Time End USR
     C                     END                             *FI
      * LCL.W Travel Time Difference = LCL.Time End USR - LCL.Time Beg US
     C                     Z-ADDYL0013    XTTIM2
     C                     Z-ADDYL0012    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0011
     C                     ADD  XTNN      YL0011
     C                     MULT 100       YL0011
     C                     ADD  XTSS      YL0011
     C                     MULT XSGN      YL0011
     C                     END                             *FI
      * ****
      * Crt W001 Rest Time Eval - W001 Rest Time Eval Workf  * 
     C                     EXSR SYCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUT2HD           TH Shift Held O
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@A2CPNP                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Pen Type          RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WDHVNB           Pen Company Num
     C                     KFLD           WDCMCD           Pen Number
      * Setup key
     C                     Z-ADDWCHVNB    WDHVNB           Pen Company Num
     C                     MOVELWCCMCD    WDCMCD           Pen Number
      * Establish starting position
     C           KRSSP     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDFWST    WUFWST           Pen Type
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm       RT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEHMNB    WQSQ01           BOH Company Num
     C           *LIKE     DEFN WECMCD    WQSQ02           Pen Number
     C           *LIKE     DEFN WEBNNB    WQSQ03           BOH Buy Order N
     C           *LIKE     DEFN WEBONB    WQSQ04           BOL Load Number
     C           *LIKE     DEFN WECVNB    WQSQ05           TH Tattoo Numbe
     C           *LIKE     DEFN WEB0DT    WQSQ06           TH Kill Date
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           BOH Company Num
     C                     KFLD           WQSQ02           Pen Number
     C                     KFLD           WQSQ03           BOH Buy Order N
     C                     KFLD           WQSQ04           BOL Load Number
     C                     KFLD           WQSQ05           TH Tattoo Numbe
     C                     KFLD           WQSQ06           TH Kill Date
      * Setup key
     C                     Z-ADDWCHMNB    WQSQ01           BOH Company Num
     C                     MOVELWCCMCD    WQSQ02           Pen Number
     C                     Z-ADDWCBNNB    WQSQ03           BOH Buy Order N
     C                     Z-ADDWCBONB    WQSQ04           BOL Load Number
     C                     Z-ADDWCCVNB    WQSQ05           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WQSQ06           TH Kill Date
      * Establish starting position
     C           KRSSQ     SETLL@B3CPU6                    *
     C           KRSSQ     READE@B3CPU6                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     WUANTM           TST Wgt Time
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEB6DT    WUB6DT           TST Wgt Date
     C                     Z-ADDWEANTM    WUANTM           TST Wgt Time
     C           KRSSQ     READE@B3CPU6                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQSR01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQSR02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQSR03           BOL Load Number
     C           *LIKE     DEFN WFCVNB    WQSR04           TH Tattoo Numbe
     C           *LIKE     DEFN WFB0DT    WQSR05           TH Kill Date
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           BOH Company Num
     C                     KFLD           WQSR02           BOH Buy Order N
     C                     KFLD           WQSR03           BOL Load Number
     C                     KFLD           WQSR04           TH Tattoo Numbe
     C                     KFLD           WQSR05           TH Kill Date
      * Setup key
     C                     Z-ADDWCHMNB    WQSR01           BOH Company Num
     C                     Z-ADDWCBNNB    WQSR02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQSR03           BOL Load Number
     C                     Z-ADDWCCVNB    WQSR04           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WQSR05           TH Kill Date
      * Establish starting position
     C           KRSSR     SETLL@B3CPHL                    *
     C           KRSSR     READE@B3CPHL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     WUANTM           TST Wgt Time
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFB6DT    WUB6DT           TST Wgt Date
     C                     Z-ADDWFANTM    WUANTM           TST Wgt Time
     C           KRSSR     READE@B3CPHL                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm,No KdtRT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQSS01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQSS02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQSS03           BOL Load Number
     C           *LIKE     DEFN WFCVNB    WQSS04           TH Tattoo Numbe
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           BOH Company Num
     C                     KFLD           WQSS02           BOH Buy Order N
     C                     KFLD           WQSS03           BOL Load Number
     C                     KFLD           WQSS04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWCHMNB    WQSS01           BOH Company Num
     C                     Z-ADDWCBNNB    WQSS02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQSS03           BOL Load Number
     C                     Z-ADDWCCVNB    WQSS04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSS     SETLL@B3CPHL                    *
     C           KRSSS     READE@B3CPHL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     WUANTM           TST Wgt Time
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFB6DT    WUB6DT           TST Wgt Date
     C                     Z-ADDWFANTM    WUANTM           TST Wgt Time
     C           KRSSS     READE@B3CPHL                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Tracking Info     RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQST01           BOH Company Num
     C           *LIKE     DEFN WGBNNB    WQST02           BOH Buy Order N
     C           *LIKE     DEFN WGBONB    WQST03           BOL Load Number
     C           *LIKE     DEFN WGE0DT    WQST04           DSH Kill Date
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           BOH Company Num
     C                     KFLD           WQST02           BOH Buy Order N
     C                     KFLD           WQST03           BOL Load Number
     C                     KFLD           WQST04           DSH Kill Date
      * Setup key
     C                     Z-ADDWCHMNB    WQST01           BOH Company Num
     C                     Z-ADDWCBNNB    WQST02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQST03           BOL Load Number
     C                     Z-ADDWCB0DT    WQST04           DSH Kill Date
      * Establish starting position
     C           KRSST     SETLL@AFCPI4                    *
     C           KRSST     READE@AFCPI4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1030' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WULGCD           DT Hog Group Re
     C                     MOVEL*BLANK    WUXHST           DT Load Type
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = CND By name
     C                     GOTO STEXIT                     *QUIT
     C           KRSST     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSU01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSU02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSU03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQSU04           TH Tattoo Numbe
     C           *LIKE     DEFN WHB0DT    WQSU05           TH Kill Date
     C           *LIKE     DEFN WHC2NB    WQSU06           TD Sequence Num
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           BOH Company Num
     C                     KFLD           WQSU02           BOH Buy Order N
     C                     KFLD           WQSU03           BOL Load Number
     C                     KFLD           WQSU04           TH Tattoo Numbe
     C                     KFLD           WQSU05           TH Kill Date
     C                     KFLD           WQSU06           TD Sequence Num
      * Setup key
     C                     Z-ADDWCHMNB    WQSU01           BOH Company Num
     C                     Z-ADDWCBNNB    WQSU02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQSU03           BOL Load Number
     C                     Z-ADDWCCVNB    WQSU04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQSU05           TH Kill Date
     C                     Z-ADDWCC2NB    WQSU06           TD Sequence Num
      * Establish starting position
     C           KRSSU     SETLL@EMCPCZ                    *
     C           KRSSU     READE@EMCPCZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0884' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUW0SQ           W Sequence Numb
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WUW0SQ           W Sequence Numb
     C                     GOTO SUEXIT                     *QUIT
     C           KRSSU     READE@EMCPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCRRC    BEGSR
      *================================================================
      * Crt W001 Rest Time Eval - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EMCPCK
     C                     Z-ADDWCHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WIBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     Z-ADDWCC2NB    WIC2NB           TD Sequence Num
     C                     Z-ADDWUW0SQ    WIW0SQ           W Sequence Numb
     C                     Z-ADDWCHVNB    WIHVNB           Pen Company Num
     C                     MOVELWCCMCD    WICMCD           Pen Number
     C                     Z-ADDWUC0NB    WIC0NB           TD Pen Head
     C                     Z-ADDWCAJTM    WIAJTM           TD Drive Time
     C                     Z-ADDWCBXDT    WIBXDT           TD Drive Date
     C                     Z-ADDWUB6DT    WIB6DT           TST Wgt Date
     C                     Z-ADDWUANTM    WIANTM           TST Wgt Time
     C                     MOVELWAKAST    WIKAST           TH Source Type
     C                     MOVELWALIST    WILIST           TH Schedule Kil
     C                     MOVELWUCRTX    WITRST           Tattoo Status
     C                     MOVELYL0005    WITSST           W Stress/Market
     C                     MOVELYL0014    WIT2ST           W Held Over Sta
     C                     Z-ADDWUT2HD    WIWSHD           W Shift Held Ov
     C                     Z-ADDWCH7NB    WII1NB           W Held Over Hea
     C                     Z-ADDWUFCNB    WII5NB           W Yard Dead
     C                     Z-ADDWAF7NB    WIF7NB           TH Avg Live Wgt
     C                     Z-ADDWACXNB    WICXNB           TH Dead On Arri
     C                     Z-ADDWAOXNB    WIOXNB           TH HPS Movement
     C                     MOVELWUJUCD    WIJUCD           W Group Referen
     C                     Z-ADDWATHHD    WIFWA1           W Farm Site
     C                     Z-ADDYL0009    WIBBTM           W Wait Time Dif
     C                     Z-ADDYL0010    WIBCTM           W Load Time Dif
     C                     Z-ADDYL0011    WIBDTM           W Travel Time D
     C                     MOVELWUJVCD    WIJVCD           HPE Load Type
      *
      * USER: Processing before Data update
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
     C                     EXSR SWRVGN
     C           KLCRSV    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIC2NB           TD Sequence Num
     C                     KFLD           WIW0SQ           W Sequence Numb
      * Check for duplicate primary key
     C           KLCRSV    SETLL@EMCPCK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0885' W0RTN   7
      * Send message 'W001 Rest Time Eval Wo EX'
     C                     MOVEL'PRK0885' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C                     WRITE@EMCPCK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSW01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSW02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSW03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQSW04           TH Tattoo Numbe
     C           *LIKE     DEFN WHB0DT    WQSW05           TH Kill Date
     C           *LIKE     DEFN WHC2NB    WQSW06           TD Sequence Num
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           BOH Company Num
     C                     KFLD           WQSW02           BOH Buy Order N
     C                     KFLD           WQSW03           BOL Load Number
     C                     KFLD           WQSW04           TH Tattoo Numbe
     C                     KFLD           WQSW05           TH Kill Date
     C                     KFLD           WQSW06           TD Sequence Num
      * Setup key
     C                     Z-ADDWIHMNB    WQSW01           BOH Company Num
     C                     Z-ADDWIBNNB    WQSW02           BOH Buy Order N
     C                     Z-ADDWIBONB    WQSW03           BOL Load Number
     C                     Z-ADDWICVNB    WQSW04           TH Tattoo Numbe
     C                     Z-ADDWIB0DT    WQSW05           TH Kill Date
     C                     Z-ADDWIC2NB    WQSW06           TD Sequence Num
      * Establish starting position
     C           KRSSW     SETLL@EMCPCZ                    *
     C           KRSSW     READE@EMCPCZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0884' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WIW0SQ           W Sequence Numb
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WIW0SQ           W Sequence Numb
     C                     GOTO SWEXIT                     *QUIT
     C           KRSSW     READE@EMCPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSX01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSX02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSX03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQSX04           TH Tattoo Numbe
     C           *LIKE     DEFN WHB0DT    WQSX05           TH Kill Date
     C           *LIKE     DEFN WHC2NB    WQSX06           TD Sequence Num
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           BOH Company Num
     C                     KFLD           WQSX02           BOH Buy Order N
     C                     KFLD           WQSX03           BOL Load Number
     C                     KFLD           WQSX04           TH Tattoo Numbe
     C                     KFLD           WQSX05           TH Kill Date
     C                     KFLD           WQSX06           TD Sequence Num
      * Setup key
     C                     Z-ADDWCHMNB    WQSX01           BOH Company Num
     C                     Z-ADDWCBNNB    WQSX02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQSX03           BOL Load Number
     C                     Z-ADDWCCVNB    WQSX04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQSX05           TH Kill Date
     C                     Z-ADDWCC2NB    WQSX06           TD Sequence Num
      * Establish starting position
     C           KRSSX     SETLL@EMCPCZ                    *
     C           KRSSX     READE@EMCPCZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0884' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUW0SQ           W Sequence Numb
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WUW0SQ           W Sequence Numb
     C                     GOTO SXEXIT                     *QUIT
     C           KRSSX     READE@EMCPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCRRC    BEGSR
      *================================================================
      * Crt W001 Rest Time Eval - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EMCPCK
     C                     Z-ADDWCHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WIBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     Z-ADDWCC2NB    WIC2NB           TD Sequence Num
     C                     Z-ADDWUW0SQ    WIW0SQ           W Sequence Numb
     C                     Z-ADDWCHVNB    WIHVNB           Pen Company Num
     C                     MOVELWCCMCD    WICMCD           Pen Number
     C                     Z-ADD*ZERO     WIC0NB           TD Pen Head
     C                     Z-ADDWCAJTM    WIAJTM           TD Drive Time
     C                     Z-ADDWCBXDT    WIBXDT           TD Drive Date
     C                     Z-ADDWUB6DT    WIB6DT           TST Wgt Date
     C                     Z-ADDWUANTM    WIANTM           TST Wgt Time
     C                     MOVELWAKAST    WIKAST           TH Source Type
     C                     MOVEL'2'       WILIST           TH Schedule Kil
     C                     MOVELWUCRTX    WITRST           Tattoo Status
     C                     MOVELWUCRTX    WITSST           W Stress/Market
     C                     MOVEL'S+'      WIT2ST           W Held Over Sta
     C                     Z-ADDWUT2HD    WIWSHD           W Shift Held Ov
     C                     Z-ADDWCH7NB    WII1NB           W Held Over Hea
     C                     Z-ADDWUFCNB    WII5NB           W Yard Dead
     C                     Z-ADDWAF7NB    WIF7NB           TH Avg Live Wgt
     C                     Z-ADDWACXNB    WICXNB           TH Dead On Arri
     C                     Z-ADDWAOXNB    WIOXNB           TH HPS Movement
     C                     MOVELWUJUCD    WIJUCD           W Group Referen
     C                     Z-ADDWATHHD    WIFWA1           W Farm Site
     C                     Z-ADDYL0009    WIBBTM           W Wait Time Dif
     C                     Z-ADDYL0010    WIBCTM           W Load Time Dif
     C                     Z-ADDYL0011    WIBDTM           W Travel Time D
     C                     MOVELWUJVCD    WIJVCD           HPE Load Type
      *
      * USER: Processing before Data update
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
     C                     EXSR SZRVGN
     C           KLCRSY    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIC2NB           TD Sequence Num
     C                     KFLD           WIW0SQ           W Sequence Numb
      * Check for duplicate primary key
     C           KLCRSY    SETLL@EMCPCK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0885' W0RTN   7
      * Send message 'W001 Rest Time Eval Wo EX'
     C                     MOVEL'PRK0885' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C                     WRITE@EMCPCK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSZ01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSZ02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSZ03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQSZ04           TH Tattoo Numbe
     C           *LIKE     DEFN WHB0DT    WQSZ05           TH Kill Date
     C           *LIKE     DEFN WHC2NB    WQSZ06           TD Sequence Num
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           BOH Company Num
     C                     KFLD           WQSZ02           BOH Buy Order N
     C                     KFLD           WQSZ03           BOL Load Number
     C                     KFLD           WQSZ04           TH Tattoo Numbe
     C                     KFLD           WQSZ05           TH Kill Date
     C                     KFLD           WQSZ06           TD Sequence Num
      * Setup key
     C                     Z-ADDWIHMNB    WQSZ01           BOH Company Num
     C                     Z-ADDWIBNNB    WQSZ02           BOH Buy Order N
     C                     Z-ADDWIBONB    WQSZ03           BOL Load Number
     C                     Z-ADDWICVNB    WQSZ04           TH Tattoo Numbe
     C                     Z-ADDWIB0DT    WQSZ05           TH Kill Date
     C                     Z-ADDWIC2NB    WQSZ06           TD Sequence Num
      * Establish starting position
     C           KRSSZ     SETLL@EMCPCZ                    *
     C           KRSSZ     READE@EMCPCZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0884' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WIW0SQ           W Sequence Numb
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WIW0SQ           W Sequence Numb
     C                     GOTO SZEXIT                     *QUIT
     C           KRSSZ     READE@EMCPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Bld Rest Time HoldOvr RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQTA01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQTA02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQTA03           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQTA04           TH Tattoo Numbe
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           BOH Company Num
     C                     KFLD           WQTA02           BOH Buy Order N
     C                     KFLD           WQTA03           BOL Load Number
     C                     KFLD           WQTA04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQTA01           BOH Company Num
     C                     Z-ADDWABNNB    WQTA02           BOH Buy Order N
     C                     Z-ADDWABONB    WQTA03           BOL Load Number
     C                     Z-ADDWACVNB    WQTA04           TH Tattoo Numbe
      * Establish starting position
     C           KRSTA     SETLL@A1CPVF                    *
     C           KRSTA     READE@A1CPVF                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'H-'      YL0002           W Held Over Sta
     C                     Z-ADDWBFCNB    WUFCNB           TH Yard Deads
     C                     Z-ADDWBT2HD    WUT2HD           TH Shift Held O
      * Rtv/Crt Rest Time EvalRT - Tattoo Detail  * 
     C                     EXSR TBRVGN
     C           KRSTA     READE@A1CPVF                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv/Crt Rest Time EvalRT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UCSUBR                     Get the MTech L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQTB01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQTB02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQTB03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQTB04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQTB05           TH Kill Date
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           BOH Company Num
     C                     KFLD           WQTB02           BOH Buy Order N
     C                     KFLD           WQTB03           BOL Load Number
     C                     KFLD           WQTB04           TH Tattoo Numbe
     C                     KFLD           WQTB05           TH Kill Date
      * Setup key
     C                     Z-ADDWBHMNB    WQTB01           BOH Company Num
     C                     Z-ADDWBBNNB    WQTB02           BOH Buy Order N
     C                     Z-ADDWBBONB    WQTB03           BOL Load Number
     C                     Z-ADDWBCVNB    WQTB04           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WQTB05           TH Kill Date
      * Establish starting position
     C           KRSTB     SETLL@A2CPNP                    *
     C           KRSTB     READE@A2CPNP                  90*
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Pen Type          RT - Pen  * 
     C                     EXSR TCRVGN
      * CASE: WRK.Pen Type is Resale
     C           WUFWST    IFEQ 'R'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Pen Number is Pen Number is Empty
      *   |- c2    : PAR.Pen Number EQ DB1.Pen Number
      *   '-
     C           P1CMCD    IFEQ *BLANK                     *IF
     C           P1CMCD    OREQ WCCMCD                     *OR
      * CASE: DB1.TD Drive Time is Not Zero
     C           WCAJTM    IFNE 0                          *IF
      * Rtv Scale dt,tm       RT - Tattoo Scale Ticket  * 
     C                     EXSR TDRVGN
      * Get the wgt for the Tt without using the pen/or kill dt (ie.xfer,
      * CASE: WRK.TST Wgt Date EQ WRK.Zero USR
     C           WUB6DT    IFEQ WUE9NB                     *IF
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
     C                     EXSR TERVGN
      * Drop the kill date ( may be a held over ttt)
      * CASE: WRK.TST Wgt Date EQ WRK.Zero USR
     C           WUB6DT    IFEQ WUE9NB                     *IF
      * Rtv Scale dt,tm,No KdtRT - Tattoo Scale Ticket  * 
     C                     EXSR TFRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWCC0NB    WUC0NB           TD Pen Head
      * If Shift Held Over AND Next day held over
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TD Held Over is greater than 0
      *   |- c2    : PAR.TH Shift Held Over is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCH7NB    IFGT 0                          *IF
     C           WBLJST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Combine the hd held over with hd rcvd here, we want the hd to be
      * accounted for in this shift, because the H- appears on Shift 2
     C           WCC0NB    ADD  WCH7NB    WUC0NB           TD Pen Head
     C                     END                             *FI
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0003    IFEQ 'N'                        *IF
      * Z1v HPS Grp from Mvmt UP - STR HPS Interface  * 
     C                     CALL 'HP258'                90  Z1v HPS Grp fro
     C           WULMST    PARM WULMST    WQ0036  7        Return Code USR
     C                     PARM WBOXNB    WQ0037  70       TH HPS Movement
     C           WUJUCD    PARM *BLANK    WQ0038  7        HPS Group Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP258'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Z1v HPS LdTm,TrvTm,Tp UP - STR HPS Interface  * 
     C                     CALL 'HP257'                90  Z1v HPS LdTm,Tr
     C           WULMST    PARM WULMST    WQ0039  7        Return Code USR
     C                     PARM WBOXNB    WQ0040  70       TH HPS Movement
     C           WUJVCD    PARM *BLANK    WQ0041  2        HPE Load Type
     C           WUBETM    PARM *ZERO     WQ0042  40       HPS Shipped In
     C           WUBFTM    PARM *ZERO     WQ0043  40       HPS Shipped Out
     C           WUEWDT    PARM *ZERO     WQ0044  70       HPS Shipped In
     C           WUEXDT    PARM *ZERO     WQ0045  70       HPS Shipped Out
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP257'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * review and found that not all of these fields going into HPE
      * were being populated due to changes to HPS and decission to
      * to send the data to HPE as blank or zero
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0003    IFEQ 'Y'                        *IF
      * Meeting with Purva and decission was to get information
      * from the delivery tracking when live with mtech
      * Rtv Tracking Info     RT - Delivery Tracking  * 
     C                     EXSR TGRVGN
     C                     MOVELWULGCD    WUJUCD           W Group Referen
     C                     MOVELWUXHST    WUJVCD           HPE Load Type
     C                     Z-ADD*ZERO     WUBETM           HPS Shipped In
     C                     Z-ADD*ZERO     WUBFTM           HPS Shipped Out
     C                     Z-ADD*ZERO     WUEWDT           HPS Shipped In
     C                     Z-ADD*ZERO     WUEXDT           HPS Shipped Out
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Stress Pens Only  XF - Pen Ext  * 
     C                     CALL 'PLPJXFR'              90  Rtv Stress Pens
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCHVNB    WQ0046  30       Pen Company Num
     C                     PARM WCCMCD    WQ0047  3        Pen Number
     C           YL0004    PARM YL0004    WQ0048  1        Stress/Market T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLPJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Crt W001 Rest Time Evl IF
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
     C                     EXSR THRVGN
      * **** Calc Wait Time Diff
     C                     Z-ADDWCAJTM    YL0006           TD Drive Time
      * CASE: PAR.TD Drive Date NE PAR.TST Wgt Date
     C           WCBXDT    IFNE WUB6DT                     *IF
      * LCL.Number 1 USR = PAR.TD Drive Date - PAR.TST Wgt Date *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUB6DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WCBXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0006           TD Drive Time
     C                     END                             *FI
      * LCL.Time Diff Usr = LCL.TD Drive Time - PAR.TST Wgt Time *HHMMSS
     C                     Z-ADDWUANTM    XTTIM2
     C                     Z-ADDYL0006    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0009
     C                     ADD  XTNN      YL0009
     C                     MULT 100       YL0009
     C                     ADD  XTSS      YL0009
     C                     MULT XSGN      YL0009
      * ****
     C                     Z-ADD*ZERO     YL0010           W Load Time Dif
     C                     Z-ADD*ZERO     YL0011           W Travel Time D
      * **** Calc Load Time Diff     3/26/02
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.HPS Shipped In Time is Entered
      *   |- c2    : PAR.HPS Shipped Out Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUBETM    IFNE 0                          *IF
     C           WUBFTM    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           100       MULT WUBFTM    YL0012           Time End USR
     C           100       MULT WUBETM    YL0013           Time Beg USR
      * CASE: PAR.HPS Shipped Out Date NE PAR.HPS Shipped In Date
     C           WUEXDT    IFNE WUEWDT                     *IF
      * LCL.Number 1 USR = PAR.HPS Shipped Out Date - PAR.HPS Shipped In
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUEWDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WUEXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0012           Time End USR
     C                     END                             *FI
      * LCL.W Load Time Difference = LCL.Time End USR - LCL.Time Beg USR
     C                     Z-ADDYL0013    XTTIM2
     C                     Z-ADDYL0012    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0010
     C                     ADD  XTNN      YL0010
     C                     MULT 100       YL0010
     C                     ADD  XTSS      YL0010
     C                     MULT XSGN      YL0010
     C                     END                             *FI
      * **** Calc travel Time Diff     3/26/02
      * CASE: PAR.HPS Shipped Out Time is Entered
     C           WUBFTM    IFNE 0                          *IF
     C                     Z-ADDWUANTM    YL0012           Time End USR
     C           100       MULT WUBFTM    YL0013           Time Beg USR
      * CASE: PAR.HPS Shipped Out Date NE PAR.TST Wgt Date
     C           WUEXDT    IFNE WUB6DT                     *IF
      * LCL.Number 1 USR = PAR.TST Wgt Date - PAR.HPS Shipped Out Date *D
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUEXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WUB6DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0012           Time End USR
     C                     END                             *FI
      * LCL.W Travel Time Difference = LCL.Time End USR - LCL.Time Beg US
     C                     Z-ADDYL0013    XTTIM2
     C                     Z-ADDYL0012    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0011
     C                     ADD  XTNN      YL0011
     C                     MULT 100       YL0011
     C                     ADD  XTSS      YL0011
     C                     MULT XSGN      YL0011
     C                     END                             *FI
      * ****
      * Crt W001 Rest Time Eval - W001 Rest Time Eval Workf  * 
     C                     EXSR TICRRC
     C                     Z-ADD*ZERO     WUFCNB           TH Yard Deads
      * Create S+ if Shift_1_only not selected
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Schedule Kill Shift   USR is Shift 2
      *   |- c2    : PAR.Schedule Kill Shift   USR EQ WRK.Blank USR
      *   '-
     C           P1LIST    IFEQ '2'                        *IF
     C           P1LIST    OREQ WUCRTX                     *OR
      * Create S+ record for shift 2
      * CASE: PAR.TH Shift Held Over Head is Not Zero
     C           WUT2HD    IFNE 0                          *IF
      * Crt W001 Rest Time Evl IF
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
     C                     EXSR TKRVGN
      * **** Calc Wait Time Diff
     C                     Z-ADDWCAJTM    YL0006           TD Drive Time
      * CASE: PAR.TD Drive Date NE PAR.TST Wgt Date
     C           WCBXDT    IFNE WUB6DT                     *IF
      * LCL.Number 1 USR = PAR.TD Drive Date - PAR.TST Wgt Date *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUB6DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WCBXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0006           TD Drive Time
     C                     END                             *FI
      * LCL.Time Diff Usr = LCL.TD Drive Time - PAR.TST Wgt Time *HHMMSS
     C                     Z-ADDWUANTM    XTTIM2
     C                     Z-ADDYL0006    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0009
     C                     ADD  XTNN      YL0009
     C                     MULT 100       YL0009
     C                     ADD  XTSS      YL0009
     C                     MULT XSGN      YL0009
      * ****
     C                     Z-ADD*ZERO     YL0010           W Load Time Dif
     C                     Z-ADD*ZERO     YL0011           W Travel Time D
      * **** Calc Load Time Diff     3/26/02
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.HPS Shipped In Time is Entered
      *   |- c2    : PAR.HPS Shipped Out Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUBETM    IFNE 0                          *IF
     C           WUBFTM    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           100       MULT WUBFTM    YL0012           Time End USR
     C           100       MULT WUBETM    YL0013           Time Beg USR
      * CASE: PAR.HPS Shipped Out Date NE PAR.HPS Shipped In Date
     C           WUEXDT    IFNE WUEWDT                     *IF
      * LCL.Number 1 USR = PAR.HPS Shipped Out Date - PAR.HPS Shipped In
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUEWDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WUEXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0012           Time End USR
     C                     END                             *FI
      * LCL.W Load Time Difference = LCL.Time End USR - LCL.Time Beg USR
     C                     Z-ADDYL0013    XTTIM2
     C                     Z-ADDYL0012    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0010
     C                     ADD  XTNN      YL0010
     C                     MULT 100       YL0010
     C                     ADD  XTSS      YL0010
     C                     MULT XSGN      YL0010
     C                     END                             *FI
      * **** Calc travel Time Diff     3/26/02
      * CASE: PAR.HPS Shipped Out Time is Entered
     C           WUBFTM    IFNE 0                          *IF
     C                     Z-ADDWUANTM    YL0012           Time End USR
     C           100       MULT WUBFTM    YL0013           Time Beg USR
      * CASE: PAR.HPS Shipped Out Date NE PAR.TST Wgt Date
     C           WUEXDT    IFNE WUB6DT                     *IF
      * LCL.Number 1 USR = PAR.TST Wgt Date - PAR.HPS Shipped Out Date *D
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WUEXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WUB6DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0007
     C                     ELSE
     C           XDURR     MULT -1        YL0007
     C                     END
     C           YL0007    MULT 240000    YL0008           Usr Elapsed hou
     C                     ADD  YL0008    YL0012           Time End USR
     C                     END                             *FI
      * LCL.W Travel Time Difference = LCL.Time End USR - LCL.Time Beg US
     C                     Z-ADDYL0013    XTTIM2
     C                     Z-ADDYL0012    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0011
     C                     ADD  XTNN      YL0011
     C                     MULT 100       YL0011
     C                     ADD  XTSS      YL0011
     C                     MULT XSGN      YL0011
     C                     END                             *FI
      * ****
      * Crt W001 Rest Time Eval - W001 Rest Time Eval Workf  * 
     C                     EXSR TLCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUT2HD           TH Shift Held O
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTB     READE@A2CPNP                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Pen Type          RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WDHVNB           Pen Company Num
     C                     KFLD           WDCMCD           Pen Number
      * Setup key
     C                     Z-ADDWCHVNB    WDHVNB           Pen Company Num
     C                     MOVELWCCMCD    WDCMCD           Pen Number
      * Establish starting position
     C           KRSTC     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDFWST    WUFWST           Pen Type
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm       RT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEHMNB    WQTD01           BOH Company Num
     C           *LIKE     DEFN WECMCD    WQTD02           Pen Number
     C           *LIKE     DEFN WEBNNB    WQTD03           BOH Buy Order N
     C           *LIKE     DEFN WEBONB    WQTD04           BOL Load Number
     C           *LIKE     DEFN WECVNB    WQTD05           TH Tattoo Numbe
     C           *LIKE     DEFN WEB0DT    WQTD06           TH Kill Date
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           BOH Company Num
     C                     KFLD           WQTD02           Pen Number
     C                     KFLD           WQTD03           BOH Buy Order N
     C                     KFLD           WQTD04           BOL Load Number
     C                     KFLD           WQTD05           TH Tattoo Numbe
     C                     KFLD           WQTD06           TH Kill Date
      * Setup key
     C                     Z-ADDWCHMNB    WQTD01           BOH Company Num
     C                     MOVELWCCMCD    WQTD02           Pen Number
     C                     Z-ADDWCBNNB    WQTD03           BOH Buy Order N
     C                     Z-ADDWCBONB    WQTD04           BOL Load Number
     C                     Z-ADDWCCVNB    WQTD05           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WQTD06           TH Kill Date
      * Establish starting position
     C           KRSTD     SETLL@B3CPU6                    *
     C           KRSTD     READE@B3CPU6                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     WUANTM           TST Wgt Time
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEB6DT    WUB6DT           TST Wgt Date
     C                     Z-ADDWEANTM    WUANTM           TST Wgt Time
     C           KRSTD     READE@B3CPU6                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQTE01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQTE02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQTE03           BOL Load Number
     C           *LIKE     DEFN WFCVNB    WQTE04           TH Tattoo Numbe
     C           *LIKE     DEFN WFB0DT    WQTE05           TH Kill Date
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           BOH Company Num
     C                     KFLD           WQTE02           BOH Buy Order N
     C                     KFLD           WQTE03           BOL Load Number
     C                     KFLD           WQTE04           TH Tattoo Numbe
     C                     KFLD           WQTE05           TH Kill Date
      * Setup key
     C                     Z-ADDWCHMNB    WQTE01           BOH Company Num
     C                     Z-ADDWCBNNB    WQTE02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQTE03           BOL Load Number
     C                     Z-ADDWCCVNB    WQTE04           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WQTE05           TH Kill Date
      * Establish starting position
     C           KRSTE     SETLL@B3CPHL                    *
     C           KRSTE     READE@B3CPHL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     WUANTM           TST Wgt Time
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFB6DT    WUB6DT           TST Wgt Date
     C                     Z-ADDWFANTM    WUANTM           TST Wgt Time
     C           KRSTE     READE@B3CPHL                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm,No KdtRT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQTF01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQTF02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQTF03           BOL Load Number
     C           *LIKE     DEFN WFCVNB    WQTF04           TH Tattoo Numbe
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           BOH Company Num
     C                     KFLD           WQTF02           BOH Buy Order N
     C                     KFLD           WQTF03           BOL Load Number
     C                     KFLD           WQTF04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWCHMNB    WQTF01           BOH Company Num
     C                     Z-ADDWCBNNB    WQTF02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQTF03           BOL Load Number
     C                     Z-ADDWCCVNB    WQTF04           TH Tattoo Numbe
      * Establish starting position
     C           KRSTF     SETLL@B3CPHL                    *
     C           KRSTF     READE@B3CPHL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     WUANTM           TST Wgt Time
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFB6DT    WUB6DT           TST Wgt Date
     C                     Z-ADDWFANTM    WUANTM           TST Wgt Time
     C           KRSTF     READE@B3CPHL                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv Tracking Info     RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQTG01           BOH Company Num
     C           *LIKE     DEFN WGBNNB    WQTG02           BOH Buy Order N
     C           *LIKE     DEFN WGBONB    WQTG03           BOL Load Number
     C           *LIKE     DEFN WGE0DT    WQTG04           DSH Kill Date
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           BOH Company Num
     C                     KFLD           WQTG02           BOH Buy Order N
     C                     KFLD           WQTG03           BOL Load Number
     C                     KFLD           WQTG04           DSH Kill Date
      * Setup key
     C                     Z-ADDWCHMNB    WQTG01           BOH Company Num
     C                     Z-ADDWCBNNB    WQTG02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQTG03           BOL Load Number
     C                     Z-ADDWCB0DT    WQTG04           DSH Kill Date
      * Establish starting position
     C           KRSTG     SETLL@AFCPI4                    *
     C           KRSTG     READE@AFCPI4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1030' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WULGCD           DT Hog Group Re
     C                     MOVEL*BLANK    WUXHST           DT Load Type
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = CND By name
     C                     GOTO TGEXIT                     *QUIT
     C           KRSTG     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQTH01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQTH02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQTH03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQTH04           TH Tattoo Numbe
     C           *LIKE     DEFN WHB0DT    WQTH05           TH Kill Date
     C           *LIKE     DEFN WHC2NB    WQTH06           TD Sequence Num
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           BOH Company Num
     C                     KFLD           WQTH02           BOH Buy Order N
     C                     KFLD           WQTH03           BOL Load Number
     C                     KFLD           WQTH04           TH Tattoo Numbe
     C                     KFLD           WQTH05           TH Kill Date
     C                     KFLD           WQTH06           TD Sequence Num
      * Setup key
     C                     Z-ADDWCHMNB    WQTH01           BOH Company Num
     C                     Z-ADDWCBNNB    WQTH02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQTH03           BOL Load Number
     C                     Z-ADDWCCVNB    WQTH04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQTH05           TH Kill Date
     C                     Z-ADDWCC2NB    WQTH06           TD Sequence Num
      * Establish starting position
     C           KRSTH     SETLL@EMCPCZ                    *
     C           KRSTH     READE@EMCPCZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0884' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUW0SQ           W Sequence Numb
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WUW0SQ           W Sequence Numb
     C                     GOTO THEXIT                     *QUIT
     C           KRSTH     READE@EMCPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICRRC    BEGSR
      *================================================================
      * Crt W001 Rest Time Eval - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EMCPCK
     C                     Z-ADDWCHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WIBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     Z-ADDWCC2NB    WIC2NB           TD Sequence Num
     C                     Z-ADDWUW0SQ    WIW0SQ           W Sequence Numb
     C                     Z-ADDWCHVNB    WIHVNB           Pen Company Num
     C                     MOVELWCCMCD    WICMCD           Pen Number
     C                     Z-ADDWUC0NB    WIC0NB           TD Pen Head
     C                     Z-ADDWCAJTM    WIAJTM           TD Drive Time
     C                     Z-ADDWCBXDT    WIBXDT           TD Drive Date
     C                     Z-ADDWUB6DT    WIB6DT           TST Wgt Date
     C                     Z-ADDWUANTM    WIANTM           TST Wgt Time
     C                     MOVELWBKAST    WIKAST           TH Source Type
     C                     MOVELWALIST    WILIST           TH Schedule Kil
     C                     MOVELWUCRTX    WITRST           Tattoo Status
     C                     MOVELYL0005    WITSST           W Stress/Market
     C                     MOVELYL0002    WIT2ST           W Held Over Sta
     C                     Z-ADDWUT2HD    WIWSHD           W Shift Held Ov
     C                     Z-ADDWCH7NB    WII1NB           W Held Over Hea
     C                     Z-ADDWUFCNB    WII5NB           W Yard Dead
     C                     Z-ADDWBF7NB    WIF7NB           TH Avg Live Wgt
     C                     Z-ADDWBCXNB    WICXNB           TH Dead On Arri
     C                     Z-ADDWBOXNB    WIOXNB           TH HPS Movement
     C                     MOVELWUJUCD    WIJUCD           W Group Referen
     C                     Z-ADDWBTHHD    WIFWA1           W Farm Site
     C                     Z-ADDYL0009    WIBBTM           W Wait Time Dif
     C                     Z-ADDYL0010    WIBCTM           W Load Time Dif
     C                     Z-ADDYL0011    WIBDTM           W Travel Time D
     C                     MOVELWUJVCD    WIJVCD           HPE Load Type
      *
      * USER: Processing before Data update
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
     C                     EXSR TJRVGN
     C           KLCRTI    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIC2NB           TD Sequence Num
     C                     KFLD           WIW0SQ           W Sequence Numb
      * Check for duplicate primary key
     C           KLCRTI    SETLL@EMCPCK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0885' W0RTN   7
      * Send message 'W001 Rest Time Eval Wo EX'
     C                     MOVEL'PRK0885' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C                     WRITE@EMCPCK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQTJ01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQTJ02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQTJ03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQTJ04           TH Tattoo Numbe
     C           *LIKE     DEFN WHB0DT    WQTJ05           TH Kill Date
     C           *LIKE     DEFN WHC2NB    WQTJ06           TD Sequence Num
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           BOH Company Num
     C                     KFLD           WQTJ02           BOH Buy Order N
     C                     KFLD           WQTJ03           BOL Load Number
     C                     KFLD           WQTJ04           TH Tattoo Numbe
     C                     KFLD           WQTJ05           TH Kill Date
     C                     KFLD           WQTJ06           TD Sequence Num
      * Setup key
     C                     Z-ADDWIHMNB    WQTJ01           BOH Company Num
     C                     Z-ADDWIBNNB    WQTJ02           BOH Buy Order N
     C                     Z-ADDWIBONB    WQTJ03           BOL Load Number
     C                     Z-ADDWICVNB    WQTJ04           TH Tattoo Numbe
     C                     Z-ADDWIB0DT    WQTJ05           TH Kill Date
     C                     Z-ADDWIC2NB    WQTJ06           TD Sequence Num
      * Establish starting position
     C           KRSTJ     SETLL@EMCPCZ                    *
     C           KRSTJ     READE@EMCPCZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0884' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WIW0SQ           W Sequence Numb
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WIW0SQ           W Sequence Numb
     C                     GOTO TJEXIT                     *QUIT
     C           KRSTJ     READE@EMCPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQTK01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQTK02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQTK03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQTK04           TH Tattoo Numbe
     C           *LIKE     DEFN WHB0DT    WQTK05           TH Kill Date
     C           *LIKE     DEFN WHC2NB    WQTK06           TD Sequence Num
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WQTK01           BOH Company Num
     C                     KFLD           WQTK02           BOH Buy Order N
     C                     KFLD           WQTK03           BOL Load Number
     C                     KFLD           WQTK04           TH Tattoo Numbe
     C                     KFLD           WQTK05           TH Kill Date
     C                     KFLD           WQTK06           TD Sequence Num
      * Setup key
     C                     Z-ADDWCHMNB    WQTK01           BOH Company Num
     C                     Z-ADDWCBNNB    WQTK02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQTK03           BOL Load Number
     C                     Z-ADDWCCVNB    WQTK04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQTK05           TH Kill Date
     C                     Z-ADDWCC2NB    WQTK06           TD Sequence Num
      * Establish starting position
     C           KRSTK     SETLL@EMCPCZ                    *
     C           KRSTK     READE@EMCPCZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0884' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUW0SQ           W Sequence Numb
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WUW0SQ           W Sequence Numb
     C                     GOTO TKEXIT                     *QUIT
     C           KRSTK     READE@EMCPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCRRC    BEGSR
      *================================================================
      * Crt W001 Rest Time Eval - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EMCPCK
     C                     Z-ADDWCHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WIBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     Z-ADDWCC2NB    WIC2NB           TD Sequence Num
     C                     Z-ADDWUW0SQ    WIW0SQ           W Sequence Numb
     C                     Z-ADDWCHVNB    WIHVNB           Pen Company Num
     C                     MOVELWCCMCD    WICMCD           Pen Number
     C                     Z-ADD*ZERO     WIC0NB           TD Pen Head
     C                     Z-ADDWCAJTM    WIAJTM           TD Drive Time
     C                     Z-ADDWCBXDT    WIBXDT           TD Drive Date
     C                     Z-ADDWUB6DT    WIB6DT           TST Wgt Date
     C                     Z-ADDWUANTM    WIANTM           TST Wgt Time
     C                     MOVELWBKAST    WIKAST           TH Source Type
     C                     MOVEL'2'       WILIST           TH Schedule Kil
     C                     MOVELWUCRTX    WITRST           Tattoo Status
     C                     MOVELWUCRTX    WITSST           W Stress/Market
     C                     MOVEL'S+'      WIT2ST           W Held Over Sta
     C                     Z-ADDWUT2HD    WIWSHD           W Shift Held Ov
     C                     Z-ADDWCH7NB    WII1NB           W Held Over Hea
     C                     Z-ADDWUFCNB    WII5NB           W Yard Dead
     C                     Z-ADDWBF7NB    WIF7NB           TH Avg Live Wgt
     C                     Z-ADDWBCXNB    WICXNB           TH Dead On Arri
     C                     Z-ADDWBOXNB    WIOXNB           TH HPS Movement
     C                     MOVELWUJUCD    WIJUCD           W Group Referen
     C                     Z-ADDWBTHHD    WIFWA1           W Farm Site
     C                     Z-ADDYL0009    WIBBTM           W Wait Time Dif
     C                     Z-ADDYL0010    WIBCTM           W Load Time Dif
     C                     Z-ADDYL0011    WIBDTM           W Travel Time D
     C                     MOVELWUJVCD    WIJVCD           HPE Load Type
      *
      * USER: Processing before Data update
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
     C                     EXSR TMRVGN
     C           KLCRTL    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIC2NB           TD Sequence Num
     C                     KFLD           WIW0SQ           W Sequence Numb
      * Check for duplicate primary key
     C           KLCRTL    SETLL@EMCPCK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0885' W0RTN   7
      * Send message 'W001 Rest Time Eval Wo EX'
     C                     MOVEL'PRK0885' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C                     WRITE@EMCPCK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Rtv Last Key Seq      RT - W001 Rest Time Eval Workf  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQTM01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQTM02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQTM03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQTM04           TH Tattoo Numbe
     C           *LIKE     DEFN WHB0DT    WQTM05           TH Kill Date
     C           *LIKE     DEFN WHC2NB    WQTM06           TD Sequence Num
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM01           BOH Company Num
     C                     KFLD           WQTM02           BOH Buy Order N
     C                     KFLD           WQTM03           BOL Load Number
     C                     KFLD           WQTM04           TH Tattoo Numbe
     C                     KFLD           WQTM05           TH Kill Date
     C                     KFLD           WQTM06           TD Sequence Num
      * Setup key
     C                     Z-ADDWIHMNB    WQTM01           BOH Company Num
     C                     Z-ADDWIBNNB    WQTM02           BOH Buy Order N
     C                     Z-ADDWIBONB    WQTM03           BOL Load Number
     C                     Z-ADDWICVNB    WQTM04           TH Tattoo Numbe
     C                     Z-ADDWIB0DT    WQTM05           TH Kill Date
     C                     Z-ADDWIC2NB    WQTM06           TD Sequence Num
      * Establish starting position
     C           KRSTM     SETLL@EMCPCZ                    *
     C           KRSTM     READE@EMCPCZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0884' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WIW0SQ           W Sequence Numb
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WIW0SQ           W Sequence Numb
     C                     GOTO TMEXIT                     *QUIT
     C           KRSTM     READE@EMCPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBHMNB    WQ0001  30       BOH Company Num
     C                     PARM @CN,001   WQ0002 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0003           MTech Live Yes
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0017  30       BOH Company Num
     C                     PARM @CN,001   WQ0018 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0019 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0003           MTech Live Yes
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBHMNB    WQ0033  30       BOH Company Num
     C                     PARM @CN,001   WQ0034 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0035 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0003           MTech Live Yes
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         XTCEL     BEGSR
      *================================================================
      * Calculate elapsed time from TME2 to TME1
      *================================================================
     C           XTTIM     IFGE XTTIM2
     C                     Z-ADD1         XSGN    10
     C                     Z-ADDXTNN      XTNNL   30
     C                     Z-ADDXTSS      XTSSL   30
     C           XTSSL     IFLT XTSS2
     C                     ADD  60        XTSSL
     C                     SUB  1         XTNNL
     C                     END
     C           XTSSL     SUB  XTSS2     XTSS
     C           XTNNL     IFLT XTNN2
     C                     ADD  60        XTNNL
     C                     SUB  1         XTHH
     C                     END
     C           XTNNL     SUB  XTNN2     XTNN
     C                     SUB  XTHH2     XTHH
     C                     ELSE
     C                     Z-ADD-1        XSGN
     C                     Z-ADDXTNN2     XTNNL
     C                     Z-ADDXTSS2     XTSSL
     C           XTSSL     IFLT XTSS
     C                     ADD  60        XTSSL
     C                     SUB  1         XTNNL
     C                     END
     C           XTSSL     SUB  XTSS      XTSS
     C           XTNNL     IFLT XTNN
     C                     ADD  60        XTNNL
     C                     SUB  1         XTHH2
     C                     END
     C           XTNNL     SUB  XTNN      XTNN
     C           XTHH2     SUB  XTHH      XTHH
     C                     END
      *================================================================
     CSR         XTCELE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WAACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WAB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WACAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WAAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WAA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WACXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WACWNB           TH Head Receive
     C                     Z-ADD*ZERO     WAFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WAH9NB           TH Held Over
     C                     Z-ADD*ZERO     WAFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WAFENB           TH Head Killed
     C                     Z-ADD*ZERO     WAHENB           TH Head Adds
     C                     Z-ADD*ZERO     WAHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WACYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WALRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WAE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WAA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WAFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WAA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WAF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WAHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WAF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WAF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WAAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WAAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WACWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WAA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WAA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WAB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WAAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WAAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WAAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WAAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WAAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WAASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WAA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WAATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WAA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WACBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WACCPR           Th Payment Net
     C                     Z-ADD*ZERO     WALPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WACDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WAA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WAA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WAGHNB           TH Commission A
     C                     Z-ADD*ZERO     WABYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WABSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WABTDT           TH Commission P
     C                     Z-ADD*ZERO     WABUDT           TH Actual Check
     C                     Z-ADD*ZERO     WAHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WAHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAHINB           TH FFLI
     C                     Z-ADD*ZERO     WAA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WAA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WAA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WAJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WAD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WAD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WAD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WAD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WAEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WAEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WAECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WAEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WAEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WAEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WAOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WATHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WAT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WATHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WAT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WAOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WAKOER           TH Head Identif
     C                     Z-ADD*ZERO     WAOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WAOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WAIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WAOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WAHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WAS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WATAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WATBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WAJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WAKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WAKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WAKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WAKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WAOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WAIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WAIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WAIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WAKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WAKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WAORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WAOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WAMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WANCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WANCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WAIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WAEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAECDT           TH Head LFT
     C                     Z-ADD*ZERO     WAEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WAEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field TH Yard Deads
     C                     Z-ADD*ZERO     WUFCNB  50
      * Define work field TH Shift Held Over Head
     C                     Z-ADD*ZERO     WUT2HD  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCC2NB           TD Sequence Num
     C                     Z-ADD*ZERO     WCCZNB           TD Live Wgt
     C                     Z-ADD*ZERO     WCC0NB           TD Pen Head
     C                     Z-ADD*ZERO     WCD8NB           TD Yard Dead
     C                     Z-ADD*ZERO     WCH7NB           TD Held Over
     C                     Z-ADD*ZERO     WCAJTM           TD Drive Time
     C                     Z-ADD*ZERO     WCJEA1           TD Drive Hour
     C                     Z-ADD*ZERO     WCB7CD           TD Drive Card N
     C                     Z-ADD*ZERO     WCD7NB           TD Avg Live Wgt
     C                     Z-ADD*ZERO     WCBVDT           TD User Date 1
     C                     Z-ADD*ZERO     WCBWDT           TD User Date 2
     C                     Z-ADD*ZERO     WCBXDT           TD Drive Date
     C                     Z-ADD*ZERO     WCHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WCH8NB           Held Over Pen C
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field System Value Alpha    USR
     C                     MOVEL*BLANK    WUKBTX 40
      * Define work field Pen Type
     C                     MOVEL*BLANK    WUFWST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WDCTNB           Pen Maximun Cap
     C                     Z-ADD*ZERO     WDD6NB           Pen Current Hea
     C                     Z-ADD*ZERO     WDB6CD           Pen Current Dri
     C                     Z-ADD*ZERO     WDEBNB           Pen Drive Seque
     C                     Z-ADD*ZERO     WDHBNB           Pen Adjustment
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field TST Wgt Date
     C                     Z-ADD*ZERO     WUB6DT  70
      * Define work field TST Wgt Time
     C                     Z-ADD*ZERO     WUANTM  60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WEBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WEBONB           BOL Load Number
     C                     Z-ADD*ZERO     WECVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WEB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WEFKNB           TST Sequence Nu
     C                     Z-ADD*ZERO     WEFMNB           TST Head
     C                     Z-ADD*ZERO     WEFLNB           TST Wgt
     C                     Z-ADD*ZERO     WEB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     WEANTM           TST Wgt Time
     C                     Z-ADD*ZERO     WEJDA1           TST Wgt Hour
     C                     Z-ADD*ZERO     WECFDT           TST Last Zero D
     C                     Z-ADD*ZERO     WEAPTM           TST Last Zero T
     C                     Z-ADD*ZERO     WEHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field TD Pen Head
     C                     Z-ADD*ZERO     WUC0NB  50
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Define work field W Group Reference
     C                     MOVEL*BLANK    WUJUCD 10
      * Define work field HPE Load Type
     C                     MOVEL*BLANK    WUJVCD  2
      * Define work field HPS Shipped In Time
     C                     Z-ADD*ZERO     WUBETM  40
      * Define work field HPS Shipped Out Time
     C                     Z-ADD*ZERO     WUBFTM  40
      * Define work field HPS Shipped In Date
     C                     Z-ADD*ZERO     WUEWDT  70
      * Define work field HPS Shipped Out Date
     C                     Z-ADD*ZERO     WUEXDT  70
      * Define work field DT Hog Group Reference
     C                     MOVEL*BLANK    WULGCD 10
      * Define work field DT Load Type
     C                     MOVEL*BLANK    WUXHST  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHONB           CC Company Numb
     C                     Z-ADD*ZERO     WGE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WGE9DT           DT Delivery Dat
     C                     Z-ADD*ZERO     WGAJTH           DT Delivery Tim
     C                     Z-ADD*ZERO     WGH4A1           DT Delivery Tim
     C                     Z-ADD*ZERO     WGFXDT           DT Actual Kill
     C                     Z-ADD*ZERO     WGJIA1           DT Actual Deliv
     C                     Z-ADD*ZERO     WGIBA1           DT Scheduled Ho
     C                     Z-ADD*ZERO     WGICA1           DT Farm Site Co
     C                     Z-ADD*ZERO     WGIDA1           DT Delivered He
     C                     Z-ADD*ZERO     WGIPA1           DT Delivered We
     C                     Z-ADD*ZERO     WGIEA1           DT Movement Num
     C                     Z-ADD*ZERO     WGFADT           DT Transprtn Of
     C                     Z-ADD*ZERO     WGAKTH           DT Transprtn Of
     C                     Z-ADD*ZERO     WGBYTH           DT Arrive@Frm v
     C                     Z-ADD*ZERO     WGFBDT           DT Route Start
     C                     Z-ADD*ZERO     WGALTH           DT Route Start
     C                     Z-ADD*ZERO     WGBVTH           DT Route Start
     C                     Z-ADD*ZERO     WGAMTH           DT Wait @ Trans
     C                     Z-ADD*ZERO     WGFCDT           DT Arrive @ Far
     C                     Z-ADD*ZERO     WGANTH           DT Arrive @ Far
     C                     Z-ADD*ZERO     WGBHTH           DT Drive Time T
     C                     Z-ADD*ZERO     WGFDDT           DT Start Loadin
     C                     Z-ADD*ZERO     WGAOTH           DT Start Loadin
     C                     Z-ADD*ZERO     WGBWTH           DT Start Loadin
     C                     Z-ADD*ZERO     WGAPTH           DT Wait @ Farm
     C                     Z-ADD*ZERO     WGFEDT           DT Frm End Load
     C                     Z-ADD*ZERO     WGAQTH           DT Frm End Load
     C                     Z-ADD*ZERO     WGARTH           DT Load Time
     C                     Z-ADD*ZERO     WGFFDT           DT Leave Farm D
     C                     Z-ADD*ZERO     WGASTH           DT Leave Farm T
     C                     Z-ADD*ZERO     WGATTH           DT Wait-Depart
     C                     Z-ADD*ZERO     WGFGDT           DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WGAUTH           DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WGFHDT           DT Arrive @ Pla
     C                     Z-ADD*ZERO     WGAVTH           DT Arrive @ Pla
     C                     Z-ADD*ZERO     WGAWTH           DT Wait @ TrkWs
     C                     Z-ADD*ZERO     WGBKTH           DT Drive Time T
     C                     Z-ADD*ZERO     WGBLTH           DT Delv Time Va
     C                     Z-ADD*ZERO     WGFIDT           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WGAXTH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WGAYTH           DT Wait @ TrkSc
     C                     Z-ADD*ZERO     WGFJDT           DT To Recv Dock
     C                     Z-ADD*ZERO     WGAZTH           DT To Recv Dock
     C                     Z-ADD*ZERO     WGA0TH           DT Wait-Rcv Doc
     C                     Z-ADD*ZERO     WGFKDT           DT Start Unload
     C                     Z-ADD*ZERO     WGA1TH           DT Start Unload
     C                     Z-ADD*ZERO     WGA2TH           DT Wait @ Rcv D
     C                     Z-ADD*ZERO     WGFLDT           DT End Unload D
     C                     Z-ADD*ZERO     WGA3TH           DT End Unload T
     C                     Z-ADD*ZERO     WGA4TH           DT Unload Time
     C                     Z-ADD*ZERO     WGBTTH           DT Unload Varia
     C                     Z-ADD*ZERO     WGFMDT           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WGA5TH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WGA6TH           DT Wait Time @
     C                     Z-ADD*ZERO     WGBXTH           DT Formula Wait
     C                     Z-ADD*ZERO     WGFYDT           DT Unused Date
     C                     Z-ADD*ZERO     WGB0TH           DT Unused Time
     C                     Z-ADD*ZERO     WGBZTH           DT Unused Wait
     C                     Z-ADD*ZERO     WGH2A1           DSD Scheduled D
     C                     Z-ADD*ZERO     WGJ2A1           DT Head Receive
     C                     Z-ADD*ZERO     WGJ3A1           DT Weight Recei
     C                     Z-ADD*ZERO     WGKMA1           DT Avg Weight R
     C                     Z-ADD*ZERO     WGJ4A1           DT Head DOA
     C                     Z-ADD*ZERO     WGJ5A1           DT Weight DOA
     C                     Z-ADD*ZERO     WGJ6A1           DT Head Yard De
     C                     Z-ADD*ZERO     WGJ7A1           DT Weight Yard
     C                     Z-ADD*ZERO     WGJ8A1           DT Head Condemn
     C                     Z-ADD*ZERO     WGJ9A1           DT Weight Conde
     C                     Z-ADD*ZERO     WGKAA1           DT Head Held Ov
     C                     Z-ADD*ZERO     WGKBA1           DT Weight Held
     C                     Z-ADD*ZERO     WGKCA1           DT Head Killed
     C                     Z-ADD*ZERO     WGKDA1           DT Weight Kille
     C                     Z-ADD*ZERO     WGKEA1           DT Head Market
     C                     Z-ADD*ZERO     WGKFA1           DT Weight Marke
     C                     Z-ADD*ZERO     WGKNA1           DT Avg Weight M
     C                     Z-ADD*ZERO     WGKGA1           DT Head Resale
     C                     Z-ADD*ZERO     WGKHA1           DT Weight Resal
     C                     Z-ADD*ZERO     WGKOA1           DT Avg Weight R
     C                     Z-ADD*ZERO     WGKIA1           DT Head Unused
     C                     Z-ADD*ZERO     WGKJA1           DT Weight Unuse
     C                     Z-ADD*ZERO     WGKKA1           DT Head Unused
     C                     Z-ADD*ZERO     WGKLA1           DT Weight Unuse
     C                     Z-ADD*ZERO     WGHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field W Sequence Number
     C                     Z-ADD*ZERO     WUW0SQ  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WHBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WHBONB           BOL Load Number
     C                     Z-ADD*ZERO     WHCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WHB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WHC2NB           TD Sequence Num
     C                     Z-ADD*ZERO     WHW0SQ           W Sequence Numb
     C                     Z-ADD*ZERO     WHHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WHC0NB           TD Pen Head
     C                     Z-ADD*ZERO     WHAJTM           TD Drive Time
     C                     Z-ADD*ZERO     WHBXDT           TD Drive Date
     C                     Z-ADD*ZERO     WHB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     WHANTM           TST Wgt Time
     C                     Z-ADD*ZERO     WHWSHD           W Shift Held Ov
     C                     Z-ADD*ZERO     WHI1NB           W Held Over Hea
     C                     Z-ADD*ZERO     WHI5NB           W Yard Dead
     C                     Z-ADD*ZERO     WHF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WHCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WHOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WHFWA1           W Farm Site
     C                     Z-ADD*ZERO     WHBBTM           W Wait Time Dif
     C                     Z-ADD*ZERO     WHBCTM           W Load Time Dif
     C                     Z-ADD*ZERO     WHBDTM           W Travel Time D
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Date USR
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field W Held Over Status
     C                     MOVEL*BLANK    YL0002  2
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Stress/Market Type
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field W Stress/Market Type
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field TD Drive Time
     C                     Z-ADD*ZERO     YL0006  60
      * Define local work field Number 1 USR
     C                     Z-ADD*ZERO     YL0007  20
      * Define local work field Usr Elapsed hours
     C                     Z-ADD*ZERO     YL0008  60
      * Define local work field Time Diff Usr
     C                     Z-ADD*ZERO     YL0009  60
      * Define local work field W Load Time Difference
     C                     Z-ADD*ZERO     YL0010  60
      * Define local work field W Travel Time Difference
     C                     Z-ADD*ZERO     YL0011  60
      * Define local work field Time End USR
     C                     Z-ADD*ZERO     YL0012  60
      * Define local work field Time Beg USR
     C                     Z-ADD*ZERO     YL0013  60
      * Define local work field W Held Over Status
     C                     MOVEL*BLANK    YL0014  2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 MTECHLIVE
