/********************************************************************/
/*                                                                  */
/*  SYNOPSIS -  THIS PROGRAM IS EXECUTED THROUGH A REMOTE CALL      */
/*              FROM SSIS AFTER A SPREADSHEET HAS BEEN              */
/*              PROCESSED. THIS WILL CALL THE PROGRAM TO CREATE     */
/*              ORDERS BY COMPANY AND BROKER CODE FROM THE          */
/*              WORK FILES, THEN IT WILL DELETE THE ASSOCIATED      */
/*              WORK FILE RECORDS.                                  */
/*                                                                  */
/*  NOTE      - CALLED FROM PNJOUPC                                 */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - CREATE ORDERS FROM AN UPLOADED SPREADSHEET          */
/*  DATE      - 08/24/2011                                          */
/*  PROGRAMMER- LARA BUSER                                          */
/*                                                                  */
/*  PARAMETERS:                                                     */
/*  I    &COMPYA     - COMPANY NUMBER - PASSED AS CHAR 3A           */
/*  I    &BROKER     - BROKER CODE                                  */
/********************************************************************/
/* 08/15/2014 LJB E003326 ADD BROKER CODE TO THE PARM LIST          */
/*   PASS BROKER TO THE PGM THAT CREATES THE ORDERS                 */
/* 10/10/2013 LJB E002823 ADD SQL STATEMENT TO SET THE TPM FREIGHT  */
/*   ORDER STS FLAG TO 'S '. THIS WILL ONLY BE REQUIRED WHILE       */
/*   PRODUCTION IS NOT LIVE W/TPM. COMMENT OUT THE REPORT, IT IS    */
/*   NO LONGER BEING USED.                                          */
/* 06/26/2013 LJB E002587 CHECK THE RETURN CODE. IF IT IS NOT BLANK */
/*   THEN DON'T DELETE THE RECORDS IN THE WORK FILE                 */
/* LJB 02/28/2012 E001973 CHANGE PRKPRT14 TO HOLD(*NO) SAVE(*NO)    */
/* RMC 07/18/16   E004201 GET READY FOR PROMOTE TO PROD          */
/* DN  10/27/20   R16637  COMMENTED OUT HARD CODE OF PROD LIBRARIES.*/
/********************************************************************/

 PGPGUPC:    PGM        PARM(&COMPYA &BROKER)

             DCL        VAR(&RETURN)    TYPE(*CHAR) LEN(7)
             DCL        VAR(&COMPYA)    TYPE(*CHAR) LEN(3)
             DCL        VAR(&COMPY)     TYPE(*DEC) LEN(3 0)
             DCL        VAR(&SEL)       TYPE(*CHAR) LEN(100)
             DCL        VAR(&BROKER)    TYPE(*CHAR) LEN(6)

             DCL        VAR(&GRPPRFL)  TYPE(*CHAR) LEN(10)

             MONMSG     MSGID(CPF0000)

             CHGJOB     LOG(4 99 *SECLVL) LOGCLPGM(*YES)

             CHGVAR     VAR(&COMPY) VALUE(&COMPYA)

    /* R16637 - COMMENTED OUT HARD CODE OF PROD LIBS. */
    /*       ADDLIBLE   LIB(PRKPLIB)                  */
    /*       ADDLIBLE   LIB(PRKFLIB)                  */


/* CALL PROGRAM TO CREATE ORDERS FROM UPLOADED WORK FILES    --------*/
/* WF EXPORT UPLOAD HEADER - EXC JPN ORDS FROM UPLD XF               */
/*   THIS PGM SUBMITS THE CORRECT PROGRAM BASED ON BROKER CODE       */
/*   ALSO SELECTS CORRECT PGM BASED ON LIVE W/TPM FLAG               */
             CALL       PGM(PNYXXFR) PARM('' &RETURN &COMPY &BROKER)
             IF         COND(&RETURN *NE '         ') THEN(GOTO +
                          CMDLBL(END))

/* DELETE FROM THE WORK FILE BY COMPANY CODE & REORG                 */
/* WF EXPORT UPLOAD HEADER   DLT BY COMPANY        XF        --------*/
/* COMPANY PARM IS PASSED AS CHARACTER SINCE THIS PROGRAM IS CALLED  */
/* FROM A NETWORK .BAT FILE AS WELL AS THIS CL PROGRAM.              */
/* BROKER CODE IS ALSO USED TO DETERMINE WHICH RECORDS TO DELETE     */

             CALL       PGM(PBAQUPC) PARM(&COMPYA &BROKER)

 END:        ENDPGM

