/************************************************************************/
/* SHOULD EITHER BE RUNNING FROM PRKTESTF, TPMTESTF OR OMSDEVGEN        */
/************************************************************************/
/* IF REFRESHING PRKTESTF COPY THE HPE FILES TO PRKTESTF.               */
/* IF REFRESHING OMSDEVGEN OR OTHER LIBRARY THEN COPY THE HPE           */
/* FILES TO HPEDEVGEN.                                                  */
/************************************************************************/
/* CAASREP    COMPANY CONTROL                                           */
/* CAAFREP    CALENDAR                                                  */
/* CABBREP    CUSTOMER                                                  */
/* POC6REP    CUSTOMER PRICE HEADER                                     */
/* POC7REP    CUSTOMER PRICE DETAIL                                     */
/* PDM3REP    CUSTOMER FAX                                              */
/* OMBYREP    ITEM DEFAULT                                              */
/* OMF0CPP    COMMODITY MARKET PRICE                                    */
/* PDIZREP    PS CUTOUT DIST LEAN %                                     */
/* PDI1REP    PS CUTOUT WEIGHT RANGE                                    */
/* PDI4REP    PS CUTOUT ITEM                                            */
/* PDI6CPP    PS STD PROD MIX DIST                                      */
/* PDI7CPP    PS PRODUCTION CAPABILITY                                  */
/* PDLFREP    MILEAGE BETWEEN CITIES                                    */
/* PDNEREP    CUSTOMER EXT                                              */
/* PKAOCPP    KILL/CUT PLAN                                             */
/* PKCPCPP    EVAL TRANS UPL                                            */
/* POB7REP    PS CUTOUT YIELD                                           */
/* PBB5REP    SALES SOLD TO                                             */
/*                                                                      */
/*CUSTOMER MASTER "IN BLOCK" FILES: (USED CONJUNCTION W/ RFCST440 FLAG) */
/* CAEOREP    COMPANY/CUSTOMER                                          */
/* PDNIREP    COMPANY CUSTOMER EXT                                      */
/* PDISREP    COMPANY CUSTOMER ITEM                                     */
/* PNGKREP    CUSTOMER FREIGHT RATE                                     */
/*                                                                      */
/*ITEM MASTER "IN BLOCK" FILES: (USED CONJUNCTION W/ RFITM440 FLAG)     */
/* CABZREP    COMPANY ITEM                                              */
/* PMFDREP    COMPANY ITEM EXT                                          */
/* PDKLREP    COMPANY ITEM/AVAIL GROUP                                  */
/* PDIOREP    ITEM BILL OF MATERIAL                                     */
/* CAB0REP    IC ITEM BALANCE                                           */
/* CAB1REP    IC ITEM BALANCE DETAIL                                    */
/* PDL5CPP    IC ITEM LOT LOCATION                                      */
/*                                                                      */
/*MISCELLANEOUS "IN BLOCK" FILES: (USED CONJUNCTION W/ RFMSC440 FLAG)   */
/* CAADREP    WAREHOUSE                                                 */
/* CAAPREP    SALESPERSON                                               */
/* PDJEREP    SALES ROUTE                                               */
/* PDNFREP    SALESPERSON ELECTRONIC CM                                 */
/* OMFFREP    OM CARRIER                                                */
/* PLAAREP    COMPANY CARRIER                                           */
/* POCKREP    CARRIER INSURANCE                                         */
/*                                                                      */
/*TRANSACTIONS "IN BLOCK" FILES: (USED CONJUNCTION W/ RFTRN440 FLAG)    */
/*  NOTE: THESE TRANSACTION FILES ARE PROCESSED IN PFSRFRTPMC PROGRAM   */
/*  OMFJCPP   LOAD HEADER                                               */
/*  OMFLCPP   LOAD DETAIL                                               */
/*  OPBFCPP   PD ORDER HEADER                                           */
/*  OPBGWKP   ORDER DETAIL                                              */
/*  OPEYCPP   OP ORDER EVENTS                                           */
/*  PDI8CPP   PS PROD ITEM SCHEDULE                                     */
/*  PDI9CPP   PS PRODUCTION ADJ ADDED 11.6.13                           */
/*  PDJCCPP   PS PROD SCHEDULE                                          */
/*  PDKNCPP   PD ORDER DETAIL SCHEDULE                                  */
/*  PDLMCPP   PS PROD DEPT SCHEDULE                                     */
/*  PMAMREP   ORDER HEADER EXTENSION                                    */
/*  POB5CPP   ORDER DETAIL SCHED-INV                                    */
/*  POB6CPP   ORDER DETAIL SCHED-CONSMD                                 */
/*  POCWCPP   PS PROD ITEM INVENTORY                                    */
/*  PDMRREP   EXP DOC HEADER          5/4/16                            */
/*  PDMSREP   EXP DOC DTL             5/4/16                            */
/*                                                                      */
/* PARAMETERS NOTES:                                                    */
/*   LIBRARY = LIBRARY NAME WHICH YOU WANT THE FILES TO UPDATE IN.      */
/*   RFCST440 = Y THEN REFRESH CUSTOMER MASTER ALL, N=JUST 360/960      */
/*   RFITM440 = Y THEN REFRESH ITEM MASTER, N=JUST 360/960              */
/*   RFMSC440 = Y THEN REFRESH MISC FILES ALL, N=DO NOTHING             */
/*   RFTRN440 = Y THEN REFRESH TRANSACTION FILES ALL, N=JUST 360/960    */
/*                                                                      */
/* MODIFICATIONS: E10168 JJH 04/17/17                                   */
/*                ADD &RFTRN440 PARM TO REFRESH TRANSACTION FILES       */
/*                  IN THE PFSRFRTPMC PROGRAM.                          */
/*                ADD &RFTRN440 PARM TO CALL PGM(PFSRFRTPMC)            */
/*                E10168 JJH 04/25/17                                   */
/*                ADD PBB5REP - SALES SOLD TO                           */
/************************************************************************/
             PGM        PARM(&LIBRARY &RFCST440 &RFITM440 &RFMSC440 +
                          &RFTRN440)

             DCL        VAR(&LIBRARY) TYPE(*CHAR) LEN(10)
             DCL        VAR(&RFCST440) TYPE(*CHAR) LEN(1) /*REFRESH CUST */
             DCL        VAR(&RFITM440) TYPE(*CHAR) LEN(1) /*REFRESH ITEM */
             DCL        VAR(&RFMSC440) TYPE(*CHAR) LEN(1) /*REFRESH MISC */
             DCL        VAR(&RFTRN440) TYPE(*CHAR) LEN(1) /*REFRESH TRAN */
             DCL        VAR(&JOBD) TYPE(*CHAR) LEN(7)
             DCL        VAR(&JOBDN) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&DATE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&FILE) TYPE(*CHAR) LEN(10)
             DCL        &LIB360     *CHAR    10
             DCL        &LIB440     *CHAR    10
             DCL        &LIB960     *CHAR    10
             DCL        VAR(&MSG) TYPE(*CHAR) LEN(512)

/***** DO NOT ALLOW PRODUCTION LIBRARY TO BE SELECTED             ***/
             IF         COND((&LIBRARY *EQ 'PRKFLIB') *OR (&LIBRARY +
                          *EQ 'PRKFGUP') *OR (&LIBRARY *EQ +
                          'PRKFTFP')) THEN(GOTO CMDLBL(STEPERR))

/***** ENSURE &LIBRARY IS SET ON TOP OF LIBRARY LIST              **/
             RMVLIBLE   LIB(&LIBRARY)
             MONMSG     MSGID(CPF0000)
             ADDLIBLE   LIB(&LIBRARY) POSITION(*FIRST)
 /* GOTO SKIPIT  */
/***** REFRESH ALL ITEMS NOT COMPANY SPECIFIC                 ***/

             CPYF       FROMFILE(PRKFLIB/OMBYREP) +
                          TOFILE(&LIBRARY/OMBYREP) MBROPT(*REPLACE)
             CPYF       FROMFILE(PRKFLIB/OMF0CPP) +
                          TOFILE(&LIBRARY/OMF0CPP) MBROPT(*REPLACE)

  IF COND(&RFITM440 *EQ 'Y') THEN(DO)    /* COPY ALL  */

             CPYF       FROMFILE(PRKFLIB/CABZREP) +
                          TOFILE(&LIBRARY/CABZREP) MBROPT(*REPLACE)
             CPYF       FROMFILE(PRKFLIB/PMFDREP) +
                          TOFILE(&LIBRARY/PMFDREP) MBROPT(*REPLACE)
             CPYF       FROMFILE(PRKFLIB/PDKLREP) +
                          TOFILE(&LIBRARY/PDKLREP) MBROPT(*REPLACE)
 BOM:        CPYF       FROMFILE(PRKFLIB/PDIOREP) +
                          TOFILE(&LIBRARY/PDIOREP) MBROPT(*REPLACE)

             CPYF       FROMFILE(PRKFLIB/CAB0REP) +
                          TOFILE(&LIBRARY/CAB0REP) MBROPT(*REPLACE)
             CPYF       FROMFILE(PRKFLIB/CAB1REP) +
                          TOFILE(&LIBRARY/CAB1REP) MBROPT(*REPLACE)
             CPYF       FROMFILE(PRKFLIB/PDL5CPP) +
                          TOFILE(&LIBRARY/PDL5CPP) MBROPT(*REPLACE)
             ENDDO
  ELSE       CMD(DO)
    /* REFRESH 360 960 ONLY; EXCLUDE 440.                                */
       /* DELETE 360 960 */
             CHGVAR     VAR(&FILE) VALUE('CABZREP')
             DELETE     SQL('FROM CABZREP WHERE BZAIC3 = ''360'' OR +
                          BZAIC3 = ''960''') OPTIMIZE(*MINWAIT)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(SQLDLTERR))

             CHGVAR     VAR(&FILE) VALUE('PMFDREP')
             DELETE     SQL('FROM PMFDREP WHERE FDAIC3 = ''360'' OR +
                          FDAIC3 = ''960''') OPTIMIZE(*MINWAIT)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(SQLDLTERR))

             CHGVAR     VAR(&FILE) VALUE('PDKLREP')
             DELETE     SQL('FROM PDKLREP WHERE KLAIC3 = ''360'' OR +
                          KLAIC3 = ''960''') OPTIMIZE(*MINWAIT)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(SQLDLTERR))

             CHGVAR     VAR(&FILE) VALUE('PDIOREP')
             DELETE     SQL('FROM PDIOREP WHERE IOAIC3 = ''360'' OR +
                          IOAIC3 = ''960''') OPTIMIZE(*MINWAIT)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(SQLDLTERR))

             CHGVAR     VAR(&FILE) VALUE('CAB0REP')
             DELETE     SQL('FROM CAB0REP WHERE B0AIC3 = ''360'' OR +
                          B0AIC3 = ''960''') OPTIMIZE(*MINWAIT)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(SQLDLTERR))

             CHGVAR     VAR(&FILE) VALUE('CAB1REP')
             DELETE     SQL('FROM CAB1REP WHERE B1AIC3 = ''360'' OR +
                          B1AIC3 = ''960''') OPTIMIZE(*MINWAIT)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(SQLDLTERR))

             CHGVAR     VAR(&FILE) VALUE('PDL5CPP')
             DELETE     SQL('FROM PDL5CPP WHERE L5AIC3 = ''360'' OR +
                          L5AIC3 = ''960''') OPTIMIZE(*MINWAIT)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(SQLDLTERR))

       /* THEN CPYF *ADD FOR 360 960 */
             CPYF       FROMFILE(PRKFLIB/CABZREP) +
                          TOFILE(&LIBRARY/CABZREP) MBROPT(*ADD) +
                          INCREL((*IF BZAIC3 *EQ 360) (*OR BZAIC3 +
                          *EQ 960))
             CPYF       FROMFILE(PRKFLIB/PMFDREP) +
                          TOFILE(&LIBRARY/PMFDREP) MBROPT(*ADD) +
                          INCREL((*IF FDAIC3 *EQ 360) (*OR FDAIC3 +
                          *EQ 960))
             CPYF       FROMFILE(PRKFLIB/PDKLREP) +
                          TOFILE(&LIBRARY/PDKLREP) MBROPT(*ADD) +
                          INCREL((*IF KLAIC3 *EQ 360) (*OR KLAIC3 +
                          *EQ 960))
             CPYF       FROMFILE(PRKFLIB/PDIOREP) +
                          TOFILE(&LIBRARY/PDIOREP) MBROPT(*ADD) +
                          INCREL((*IF IOAIC3 *EQ 360) (*OR IOAIC3 +
                          *EQ 960))
             CPYF       FROMFILE(PRKFLIB/CAB0REP) +
                          TOFILE(&LIBRARY/CAB0REP) MBROPT(*ADD) +
                          INCREL((*IF B0AIC3 *EQ 360) (*OR B0AIC3 +
                          *EQ 960))
             CPYF       FROMFILE(PRKFLIB/CAB1REP) +
                          TOFILE(&LIBRARY/CAB1REP) MBROPT(*ADD) +
                          INCREL((*IF B1AIC3 *EQ 360) (*OR B1AIC3 +
                          *EQ 960))
             CPYF       FROMFILE(PRKFLIB/PDL5CPP) +
                          TOFILE(&LIBRARY/PDL5CPP) MBROPT(*ADD) +
                          INCREL((*IF L5AIC3 *EQ 360) (*OR L5AIC3 +
                          *EQ 960))
  ENDDO

/* GET HPE DATA LIBRARY PER PLANT 360          */
 GETLIB3:   CALL       PGM(POMTXFR) PARM(' ' X'360F' 'HPELIB   ' &LIB360)
/* GET HPE DATA LIBRARY PER PLANT 360          */
 GETLIB4:   CALL       PGM(POMTXFR) PARM(' ' X'440F' 'HPELIB   ' &LIB440)
/* GET HPE DATA LIBRARY PER PLANT 960                                 */
 GETLIB9:   CALL       PGM(POMTXFR) PARM(' ' X'960F' 'HPELIB   ' &LIB960)
             RTVJOBA    CYMDDATE(&JOBD)
             CHGVAR     VAR(&JOBDN) VALUE(&JOBD)
             CHGVAR     VAR(&DATE) VALUE(0000000)
    CALL PRKPLIB/POE7XFR  (' ' X'360F' &JOBDN X'007F' &DATE)
             CHGVAR     VAR(&JOBD) VALUE(&DATE)
             IF         COND(&LIBRARY *NE PRKTESTF) THEN(DO)
             GOTO NOT                /* COMMENT 5.15  */
             CPYF       FROMFILE(PRKFGUP/PKCPCPP) +
                          TOFILE(&LIB360/PKCPCPP) MBROPT(*ADD) +
                          INCREL((*IF CPB7DT *GE &JOBD) (*AND +
                          CPHKST *EQ 360))
             CPYF       FROMFILE(PRKFTFP/PKCPCPP) +
                          TOFILE(&LIB440/PKCPCPP) MBROPT(*ADD) +
                          INCREL((*IF CPB7DT *GE &JOBD) (*AND +
                          CPHKST *EQ 960) (*AND CPHLST *EQ '1'))
  SET440:    UPDATE     SET((CPHKST 440)) SQL('from +
                          PRKFTSTSTP/PKCPCPP')
           MONMSG CPF0000
             CPYF       FROMFILE(PRKFTFP/PKCPCPP) +
                          TOFILE(&LIB960/PKCPCPP) MBROPT(*ADD) +
                          INCREL((*IF CPB7DT *GE &JOBD) (*AND +
                          CPHKST *EQ 960))
             MONMSG     MSGID(CPF2968 CPF2972)
   NOT:
             ENDDO
             ELSE       CMD(DO)
/* IF REFRESHING PRKTESTF THEN COPY PKCPCPP TO PRKTESTF SINCE THE    */
/* FILE ALREADY EXISTS THERE                                         */
             CPYF       FROMFILE(PRKFGUP/PKCPCPP) +
                          TOFILE(&LIBRARY/PKCPCPP) MBROPT(*REPLACE) +
                          INCREL((*IF CPB7DT *GE &JOBD) (*AND +
                          CPHKST *EQ 360))
             CPYF       FROMFILE(PRKFTFP/PKCPCPP) +
                          TOFILE(&LIBRARY/PKCPCPP) MBROPT(*ADD) +
                          INCREL((*IF CPB7DT *GE &JOBD) (*AND +
                          CPHKST *EQ 960))
             CPYF       FROMFILE(PRKFSTP/PKCPCPP) +
                          TOFILE(&LIBRARY/PKCPCPP) MBROPT(*ADD) +
                          INCREL((*IF CPB7DT *GE &JOBD) (*AND +
                          CPHKST *EQ 440))
             MONMSG     MSGID(CPF2817)      /* Empty file member */
             ENDDO
/* IF REFRESHING OMSDEVGEN OR OTHER LIBRARY THEN COPY PKAOCPP TO     */
/* HPEDEVGEN                                                         */
/* REFRESH KILL PLAN                                                 */
             IF         COND(&LIBRARY *NE PRKTESTF) THEN(DO)
             CPYF       FROMFILE(PRKFLIB/PKAOCPP) +
                          TOFILE(HPEDEVGEN/PKAOCPP) +
                          MBROPT(*REPLACE) CRTFILE(*YES)
             ENDDO
             ELSE       CMD(DO)
/* IF REFRESHING PRKTESTF THEN COPY PKAOCPP TO PRKTESTF SINCE THE    */
/* FILE ALREADY EXISTS THERE                                         */
             CPYF       FROMFILE(PRKFLIB/PKAOCPP) +
                          TOFILE(&LIBRARY/PKAOCPP) MBROPT(*REPLACE) +
                          CRTFILE(*YES)
             ENDDO
 /* REFRESH CUSTOMER BASE  --  NOT COMPANY SPECIFIC FILES  */

             CPYF       FROMFILE(PRKFLIB/CABBREP) +
                          TOFILE(&LIBRARY/CABBREP) MBROPT(*REPLACE)
             CPYF       FROMFILE(PRKFLIB/PDNEREP) +
                          TOFILE(&LIBRARY/PDNEREP) MBROPT(*REPLACE)
CUSTPRIC:    CPYF       FROMFILE(PRKFLIB/POC6REP) +
                          TOFILE(&LIBRARY/POC6REP) MBROPT(*REPLACE) +
                          FMTOPT(*MAP *DROP)
             CPYF       FROMFILE(PRKFLIB/POC7REP) +
                          TOFILE(&LIBRARY/POC7REP) MBROPT(*REPLACE) +
                          FMTOPT(*MAP *DROP)
CUSTFAX:     CPYF       FROMFILE(PRKFLIB/PDM3REP) +
                          TOFILE(&LIBRARY/PDM3REP) MBROPT(*REPLACE)
SALESOLDTO:  CPYF       FROMFILE(PRKFLIB/PBB5REP) +
                          TOFILE(&LIBRARY/PBB5REP) MBROPT(*REPLACE)

  IF COND(&RFCST440 *EQ 'Y') THEN(DO)   /* REFRESH ALL CUSTS COMPANY SPECIFIC */

             CPYF       FROMFILE(PRKFLIB/CAEOREP) +
                          TOFILE(&LIBRARY/CAEOREP) MBROPT(*REPLACE)
             CPYF       FROMFILE(PRKFLIB/PDNIREP) +
                          TOFILE(&LIBRARY/PDNIREP) MBROPT(*REPLACE)
             CPYF       FROMFILE(PRKFLIB/PDISREP) +
                          TOFILE(&LIBRARY/PDISREP) MBROPT(*REPLACE)
             CPYF       FROMFILE(PRKFLIB/PNGKREP) +
                          TOFILE(&LIBRARY/PNGKREP) MBROPT(*REPLACE)
             ENDDO
  ELSE       CMD(DO)
    /* REFRESH 360 960 ONLY; EXCLUDE 440.                                */
       /* DELETE 360 960 */
             CHGVAR     VAR(&FILE) VALUE('CAEOREP')
             DELETE     SQL('FROM CAEOREP WHERE EOAIC3 = ''360'' OR +
                          EOAIC3 = ''960''') OPTIMIZE(*MINWAIT)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(SQLDLTERR))

             CHGVAR     VAR(&FILE) VALUE('PDNIREP')
             DELETE     SQL('FROM PDNIREP WHERE NIAIC3 = ''360'' OR +
                          NIAIC3 = ''960''') OPTIMIZE(*MINWAIT)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(SQLDLTERR))

             CHGVAR     VAR(&FILE) VALUE('PDISREP')
             DELETE     SQL('FROM PDISREP WHERE ISAIC3 = ''360'' OR +
                          ISAIC3 = ''960''') OPTIMIZE(*MINWAIT)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(SQLDLTERR))

             CHGVAR     VAR(&FILE) VALUE('PNGKREP')
             DELETE     SQL('FROM PNGKREP WHERE GKAIC3 = ''360'' OR +
                          GKAIC3 = ''960''') OPTIMIZE(*MINWAIT)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(SQLDLTERR))

       /* THEN CPYF *ADD FOR 360 960 */
             CPYF       FROMFILE(PRKFLIB/CAEOREP) +
                          TOFILE(&LIBRARY/CAEOREP) MBROPT(*ADD) +
                          INCREL((*IF EOAIC3 *EQ 360) (*OR EOAIC3 +
                          *EQ 960))
             CPYF       FROMFILE(PRKFLIB/PDNIREP) +
                          TOFILE(&LIBRARY/PDNIREP) MBROPT(*ADD) +
                          INCREL((*IF NIAIC3 *EQ 360) (*OR NIAIC3 +
                          *EQ 960))
             CPYF       FROMFILE(PRKFLIB/PDISREP) +
                          TOFILE(&LIBRARY/PDISREP) MBROPT(*ADD) +
                          INCREL((*IF ISAIC3 *EQ 360) (*OR ISAIC3 +
                          *EQ 960))
             CPYF       FROMFILE(PRKFLIB/PNGKREP) +
                          TOFILE(&LIBRARY/PNGKREP) MBROPT(*ADD) +
                          INCREL((*IF GKAIC3 *EQ 360) (*OR GKAIC3 +
                          *EQ 960))
  ENDDO


 /* REFRESH MISCELLANEOUS FILES                            */
  IF COND(&RFMSC440 *EQ 'Y') THEN(DO)   /* REFRESH ALL MISC FILES */

 WAREHOUSE:  CPYF       FROMFILE(PRKFLIB/CAADREP) +
                          TOFILE(&LIBRARY/CAADREP) MBROPT(*REPLACE)
       /* AFTER UPDATING THE SALESPERSON CAAPREP FILE DO A SQL UPDATE & +
          UPDATE THE EMAIL ADDRESS TO 'PRKDEV', PER RC. */
 SLSPERSON:  CPYF       FROMFILE(PRKFLIB/CAAPREP) +
                          TOFILE(&LIBRARY/CAAPREP) MBROPT(*REPLACE)
 SLSROUTE:   CPYF       FROMFILE(PRKFLIB/PDJEREP) +
                          TOFILE(&LIBRARY/PDJEREP) MBROPT(*REPLACE)
 SLSPERELE:  CPYF       FROMFILE(PRKFLIB/PDNFREP) +
                          TOFILE(&LIBRARY/PDNFREP) MBROPT(*REPLACE)
 CARRIER:    CPYF       FROMFILE(PRKFLIB/OMFFREP) +
                          TOFILE(&LIBRARY/OMFFREP) MBROPT(*REPLACE)
 CMPCARRIER: CPYF       FROMFILE(PRKFLIB/PLAAREP) +
                          TOFILE(&LIBRARY/PLAAREP) MBROPT(*REPLACE)
 CARRIERINS: CPYF       FROMFILE(PRKFLIB/POCKREP) +
                          TOFILE(&LIBRARY/POCKREP) MBROPT(*REPLACE)
             ENDDO


 MILEAGE:
             CPYF       FROMFILE(PRKFLIB/PDLFREP) +
                          TOFILE(&LIBRARY/PDLFREP) MBROPT(*REPLACE) +
                          /* MILEAGE BETW CITIES */
 CUTOUT:
   /*        CPYF       FROMFILE(PRKFLIB/POB7REP) +
                          TOFILE(&LIBRARY/POB7REP) MBROPT(*REPLACE)    */
   /*        CPYF       FROMFILE(PRKFLIB/PDI1REP) +
                          TOFILE(&LIBRARY/PDI1REP) MBROPT(*REPLACE)        */
  /*         CPYF       FROMFILE(PRKFLIB/PDI7CPP) +
                          TOFILE(&LIBRARY/PDI7CPP) MBROPT(*REPLACE)      */
  /*         CPYF       FROMFILE(PRKFLIB/PDIZREP) +
                          TOFILE(&LIBRARY/PDIZREP) MBROPT(*REPLACE)    */
 /*          CPYF       FROMFILE(PRKFLIB/PDI4REP) +
                          TOFILE(&LIBRARY/PDI4REP) MBROPT(*REPLACE) +
                          INCREL((*IF I4RXCD *EQ 'PPSG5'))     */
     /*      CPYF       FROMFILE(PRKFLIB/PDI6CPP) +
                          TOFILE(&LIBRARY/PDI6CPP) MBROPT(*REPLACE) */
     /*      CPYF       FROMFILE(PRKFLIB/PDI0REP) +
                          TOFILE(&LIBRARY/PDI0REP) MBROPT(*REPLACE)       */
 CALENDAR:   CPYF       FROMFILE(PRKFLIB/CAAFREP) +
                          TOFILE(&LIBRARY/CAAFREP) MBROPT(*REPLACE)
CMPCTL:                   IF COND(&RFTRN440 *EQ 'Y') THEN(DO)
             DELETE     SQL('FROM CAASREP WHERE ASAIC3 = ''0''')
             MONMSG     MSGID(CPF0000)
             CPYF       FROMFILE(PRKFLIB/CAASREP) +
                          TOFILE(&LIBRARY/CAASREP) MBROPT(*ADD) +
                          INCREL((*IF ASAIC3 *EQ 0))
             MONMSG     MSGID(CPF0000)
            ENDDO


/* COPY ORDER MANAGEMENT DATA.                                       */
/* UPDATE TELEPHONE NUMBERS AND EMAILS TO DEVELOPER NUMBERS/EMAIL    */
/* SO CUSTOMERS DON'T RECEIVE TEST EMAILS.                           */
 SKIPIT:
             CALL       PGM(PFSRFRTPMC) PARM(&LIBRARY &RFTRN440)

/* Run the Nightly run on PA                 */
/* BUILD the load schedules files            */
 PPSRUN:
             CALL       PGM(INVBUILDPS)
             CALL       PGM(PMB8XCLP)
             GOTO       CMDLBL(ENDPGM)

    /* PRKDEV4 = WILL SEND EMAIL NOTICE TO RC, DN, JH & BB. */
 SQLDLTERR:
             SNDPGRMSG  TOPGR(PRKDEV4) MSG('SQL DELETE from file ' +
                          *CAT &FILE *CAT ' ended in error causing +
                          PFSRFRTPMT program to end abnormally.') +
                          CONFMSG(*NO)
             CHGJOB     LOG(4 00 *SECLVL)
             GOTO       CMDLBL(ENDPGM)

 STEPERR:
             CHGVAR     VAR(&MSG) VALUE('Library ' *CAT &LIBRARY)
             CHGVAR     VAR(&MSG) VALUE(&MSG *CAT ' CAN NOT BE USED.')
             SNDUSRMSG  MSG(&MSG)

 ENDPGM:
             ENDPGM
