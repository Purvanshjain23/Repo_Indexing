/*********************************************************************/
/*     Program: PDUWUPR                                              */
/*       Title: Convert to EXCEL and FTP                             */
/*        Date: 02/28/00                                             */
/* Description: - Convert download file to EXCEL using SEQUEL.       */
/*              - FTP to Novell Network.                             */
/*                                                                   */
/*  Parameters:                                                      */
/*  Usage   Field       Field Description                            */
/*  -----   ---------   ------------------------------------------   */
/*                                                                   */
/*********************************************************************/
/* Modifications:                                                    */
/*                                                                   */
/*   Date     Pgmr     Description                                   */
/* -------- ---------- --------------------------------------------  */
/*                                                                   */
/*********************************************************************/
             PGM

   /*-------------------*/
   /* Declare Variables */
   /*-------------------*/

             /* Internal Fields */
             DCL  VAR(&ALREADY)  TYPE(*CHAR) LEN(1)
             DCL  VAR(&DOCUMENT) TYPE(*CHAR) LEN(10)
             DCL  VAR(&PCFILE)   TYPE(*CHAR) LEN(32)

   /*----------------------------*/
   /* Add SEQUEL Library to List */
   /*----------------------------*/
             CHGVAR VAR(&ALREADY) VALUE('N')
             ADDLIBLE LIB(SEQUEL) POSITION(*LAST)
             MONMSG MSGID(CPF2103) EXEC(DO)       /* already in libl */
                CHGVAR VAR(&ALREADY) VALUE('Y')
             ENDDO

   /*--------------------------------------------*/
   /* Convert "EXPORT SUMMARY FILE TO EXCEL" */
   /*--------------------------------------------*/
             EXECUTE    SQL('SELECT f4umcd COLHDG("Exprt" "Cntry"), +
                          f4conb COLHDG("Invoice" "Nbr"), F4BRTX +
                          COLHDG("Ship To" "Name"), f4awdt +
                          COLHDG("Invoice" "Date"),  NET01 +
                          COLHDG("Net" "Amount"), f4bywg01 +
                          COLHDG("Weight" "Billed"),  F4C4NB    +
                          COLHDG("Order" "Nbr")                 +
                          FROM RYEXSM2') TOFLR(GUY.IS) +
                          TODOC(TOSHISLS) PCFMT(*XLS) REPLACE(*YES)

   /*---------------------------------*/
   /* Remove SEQUEL Library from List */
   /*---------------------------------*/
             IF COND(&ALREADY *EQ 'N') THEN(DO)
                RMVLIBLE   LIB(SEQUEL)
             ENDDO

   /*------------------------------------*/
   /* FTP documents to /CREDIT           */
   /*------------------------------------*/
             CHGVAR VAR(&DOCUMENT) VALUE('TOSHISLS')
             CHGVAR VAR(&PCFILE)   VALUE('TOSHISLS.XLS')
             CALL PGM(FTPCLAIMS) PARM(&DOCUMENT &PCFILE)


END:
             ENDPGM
