     H/TITLE PRT 1 WF Invoice/Cmb   XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 11/09/21  Time  : 16:03:10
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPMAFCPL2IF  E           K        DISK
      * RSQ : WF Invoice/Combine Drv    Job/Co/CstPO/Shpto/Ord
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPDLYREL1IF  E           K        DISK
      * RTV : Trailer                   Retrieval index
      *
     FPDLYREL0UF  E           K        DISK
      * UPD : Trailer                   Update index
      *
     I@AFCPHX
      * WF Invoice/Combine Drv    Job/Co/CstPO/Shpto/Ord
      * Renamed input format fields
     I              AFB2VN                          WAB2VN
     I              AFDJVN                          WADJVN
     I              AFC4NB                          WAC4NB
     I              AFAETX                          WAAETX
     I              AFJZVA                          WAJZVA
     I              AFA1WG                          WAA1WG
     I              AFBRTX                          WABRTX
     I              AFRLST                          WARLST
     I              AFHUSX                          WAHUSX
     I              AFBCNA                          WABCNA
     I              AFA8TX                          WAA8TX
     I              AFBETX                          WABETX
     I              AFGNDT                          WAGNDT
     I              AFBKC7                          WABKC7
     I              AFEMC7                          WAEMC7
     I              AFAIC3                          WAAIC3
     I              AFCONB                          WACONB
     I              AFCEST                          WACEST
     I              AFVSST                          WAVSST
     I              AFMJDT                          WAMJDT
     I              AFBETM                          WABETM
     I              AFCCVN                          WACCVN
     I              AFCDVN                          WACDVN
     I              AFMKDT                          WAMKDT
     I              AFBFTM                          WABFTM
     I              AFCEVN                          WACEVN
     I              AFCFVN                          WACFVN
      *
     I@JYRECE
      * Company Defaults Internal Active Records
      * Renamed input format fields
     I              JYAIC3                          WBAIC3
     I              JYZ9ST                          WBZ9ST
     I              JYCSST                          WBCSST
     I              JYZ8ST                          WBZ8ST
     I              JYCXST                          WBCXST
     I              JYSWST                          WBSWST
     I              JYXXTM                          WBXXTM
     I              JYUECD                          WBUECD
     I              JYHSST                          WBHSST
     I              JYAMEO                          WBAMEO
     I              JYSSDF                          WBSSDF
     I              JYPDFT                          WBPDFT
     I              JYYISX                          WBYISX
     I              JYYJSX                          WBYJSX
     I              JYYKSX                          WBYKSX
     I              JYYLSX                          WBYLSX
     I              JYYMSX                          WBYMSX
     I              JYYNSX                          WBYNSX
     I              JYUVST                          WBUVST
     I              JYUWST                          WBUWST
     I              JYUXST                          WBUXST
     I              JYVSST                          WBVSST
     I              JYAATM                          WBAATM
     I              JYAYNA                          WBAYNA
     I              JYA0NA                          WBA0NA
     I              JYAXDT                          WBAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WDRMNB
     I              FJAIC3                          WDAIC3
     I              FJAODT                          WDAODT
     I              FJPJST                          WDPJST
     I              FJPKST                          WDPKST
     I              FJRNNB                          WDRNNB
     I              FJDMTX                          WDDMTX
     I              FJDNTX                          WDDNTX
     I              FJDOTX                          WDDOTX
     I              FJWTTX                          WDWTTX
     I              FJWUTX                          WDWUTX
     I              FJRPNB                          WDRPNB
     I              FJFLAM                          WDFLAM
     I              FJXQST                          WDXQST
     I              FJRRNB                          WDRRNB
     I              FJDXTX                          WDDXTX
     I              FJDYTX                          WDDYTX
     I              FJSBNB                          WDSBNB
     I              FJBZNA                          WDBZNA
     I              FJRONB                          WDRONB
     I              FJSQNB                          WDSQNB
     I              FJR1NB                          WDR1NB
     I              FJVCST                          WDVCST
     I              FJVDST                          WDVDST
     I              FJSDNB                          WDSDNB
     I              FJPAOU                          WDPAOU
     I              FJDGWG                          WDDGWG
     I              FJSXNB                          WDSXNB
     I              FJHADT                          WDHADT
     I              FJAART                          WDAART
     I              FJDHWG                          WDDHWG
     I              FJDIWG                          WDDIWG
     I              FJAQDT                          WDAQDT
     I              FJS6NB                          WDS6NB
     I              FJT4NB                          WDT4NB
     I              FJPRTM                          WDPRTM
     I              FJNPSV                          WDNPSV
     I              FJJ8TX                          WDJ8TX
     I              FJTLMI                          WDTLMI
     I              FJJ9TX                          WDJ9TX
     I              FJQ2CD                          WDQ2CD
     I              FJVPCD                          WDVPCD
     I              FJDBCD                          WDDBCD
     I              FJGRWE                          WDGRWE
     I              FJXCCD                          WDXCCD
     I              FJU2ST                          WDU2ST
     I              FJF9DT                          WDF9DT
     I              FJONTM                          WDONTM
     I              FJJ4DT                          WDJ4DT
     I              FJTRTM                          WDTRTM
     I              FJJ5DT                          WDJ5DT
     I              FJSPTM                          WDSPTM
     I              FJJ6DT                          WDJ6DT
     I              FJLFTM                          WDLFTM
     I              FJJ7DT                          WDJ7DT
     I              FJBOTM                          WDBOTM
     I              FJJ8DT                          WDJ8DT
     I              FJBLTM                          WDBLTM
     I              FJKIDT                          WDKIDT
     I              FJASTM                          WDASTM
     I              FJKADT                          WDKADT
     I              FJAJCM                          WDAJCM
     I              FJXACD                          WDXACD
     I              FJOANA                          WDOANA
     I              FJK4TX                          WDK4TX
     I              FJVOAG                          WDVOAG
     I              FJKBDT                          WDKBDT
     I              FJNBBO                          WDNBBO
     I              FJW4CD                          WDW4CD
     I              FJEFDT                          WDEFDT
     I              FJCNTN                          WDCNTN
     I              FJKCDT                          WDKCDT
     I              FJTMIN                          WDTMIN
     I              FJKDDT                          WDKDDT
     I              FJVMNB                          WDVMNB
     I              FJOCFR                          WDOCFR
     I              FJKJDT                          WDKJDT
     I              FJATTM                          WDATTM
     I              FJOTRS                          WDOTRS
     I              FJRNST                          WDRNST
     I              FJBRBK                          WDBRBK
     I              FJEIDT                          WDEIDT
     I              FJRMST                          WDRMST
     I              FJAJCD                          WDAJCD
     I              FJKKDT                          WDKKDT
     I              FJAVTM                          WDAVTM
     I              FJKZDT                          WDKZDT
     I              FJAXTM                          WDAXTM
     I              FJLHOS                          WDLHOS
     I              FJLHOR                          WDLHOR
     I              FJWNTX                          WDWNTX
     I              FJOITX                          WDOITX
     I              FJOJTX                          WDOJTX
     I              FJLLDT                          WDLLDT
     I              FJLSHG                          WDLSHG
     I              FJYPST                          WDYPST
     I              FJK0DT                          WDK0DT
     I              FJAYTM                          WDAYTM
     I              FJKNNX                          WDKNNX
     I              FJICWG                          WDICWG
     I              FJIDWG                          WDIDWG
     I              FJH9SX                          WDH9SX
     I              FJWOTX                          WDWOTX
     I              FJK1DT                          WDK1DT
     I              FJAZTM                          WDAZTM
     I              FJK2DT                          WDK2DT
     I              FJA0TM                          WDA0TM
     I              FJROST                          WDROST
     I              FJRPST                          WDRPST
     I              FJRQST                          WDRQST
     I              FJRRST                          WDRRST
     I              FJZBVA                          WDZBVA
     I              FJWPTX                          WDWPTX
     I              FJWQTX                          WDWQTX
     I              FJWRTX                          WDWRTX
     I              FJWSTX                          WDWSTX
     I              FJRVSX                          WDRVSX
     I              FJRUSX                          WDRUSX
     I              FJRWSX                          WDRWSX
     I              FJRXSX                          WDRXSX
     I              FJRYSX                          WDRYSX
     I              FJRZSX                          WDRZSX
     I              FJR0SX                          WDR0SX
     I              FJR1SX                          WDR1SX
     I              FJR2SX                          WDR2SX
     I              FJR3SX                          WDR3SX
     I              FJR4SX                          WDR4SX
     I              FJPYDT                          WDPYDT
     I              FJCKTM                          WDCKTM
     I              FJPZDT                          WDPZDT
     I              FJCLTM                          WDCLTM
     I              FJP0DT                          WDP0DT
     I              FJCMTM                          WDCMTM
     I              FJP1DT                          WDP1DT
     I              FJCNTM                          WDCNTM
     I              FJP2DT                          WDP2DT
     I              FJCOTM                          WDCOTM
     I              FJP3DT                          WDP3DT
     I              FJCQTM                          WDCQTM
     I              FJUVST                          WDUVST
     I              FJUWST                          WDUWST
     I              FJUXST                          WDUXST
     I              FJAATM                          WDAATM
     I              FJAYNA                          WDAYNA
     I              FJA0NA                          WDA0NA
     I              FJAXDT                          WDAXDT
      *
     I@LYRER3
      * Trailer                   Retrieval index
      * Renamed input format fields
     I              LYBZNA                          WEBZNA
     I              LYDXTX                          WEDXTX
     I              LYAIC3                          WEAIC3
     I              LYVDST                          WEVDST
     I              LYX3ST                          WEX3ST
     I              LYXGST                          WEXGST
     I              LYSTOY                          WESTOY
     I              LYKKDT                          WEKKDT
     I              LYAVTM                          WEAVTM
     I              LYSTAS                          WESTAS
     I              LYXRST                          WEXRST
     I              LYX7CD                          WEX7CD
     I              LYGXTX                          WEGXTX
     I              LYXTST                          WEXTST
     I              LYXVST                          WEXVST
     I              LYSTU3                          WESTU3
     I              LYSTU4                          WESTU4
     I              LYSTU5                          WESTU5
     I              LYLCDT                          WELCDT
     I              LYLDDT                          WELDDT
     I              LYLEDT                          WELEDT
     I              LYLFDT                          WELFDT
     I              LYLGDT                          WELGDT
     I              LYUVST                          WEUVST
     I              LYUWST                          WEUWST
     I              LYUXST                          WEUXST
     I              LYVSST                          WEVSST
     I              LYAATM                          WEAATM
     I              LYAYNA                          WEAYNA
     I              LYA0NA                          WEA0NA
     I              LYAXDT                          WEAXDT
      *
     I@LYRER2
      * Trailer                   Update index
      * Renamed input format fields
     I              LYBZNA                          WFBZNA
     I              LYDXTX                          WFDXTX
     I              LYAIC3                          WFAIC3
     I              LYVDST                          WFVDST
     I              LYX3ST                          WFX3ST
     I              LYXGST                          WFXGST
     I              LYSTOY                          WFSTOY
     I              LYKKDT                          WFKKDT
     I              LYAVTM                          WFAVTM
     I              LYSTAS                          WFSTAS
     I              LYXRST                          WFXRST
     I              LYX7CD                          WFX7CD
     I              LYGXTX                          WFGXTX
     I              LYXTST                          WFXTST
     I              LYXVST                          WFXVST
     I              LYSTU3                          WFSTU3
     I              LYSTU4                          WFSTU4
     I              LYSTU5                          WFSTU5
     I              LYLCDT                          WFLCDT
     I              LYLDDT                          WFLDDT
     I              LYLEDT                          WFLEDT
     I              LYLFDT                          WFLFDT
     I              LYLGDT                          WFLGDT
     I              LYUVST                          WFUVST
     I              LYUWST                          WFUWST
     I              LYUXST                          WFUXST
     I              LYVSST                          WFVSST
     I              LYAATM                          WFAATM
     I              LYAYNA                          WFAYNA
     I              LYA0NA                          WFA0NA
     I              LYAXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDLY1    E DSPDLYREL0
      * UPD : Trailer                   Update index
      * Renamed input format fields
     I              LYBZNA                          WFBZNA
     I              LYDXTX                          WFDXTX
     I              LYAIC3                          WFAIC3
     I              LYVDST                          WFVDST
     I              LYX3ST                          WFX3ST
     I              LYXGST                          WFXGST
     I              LYSTOY                          WFSTOY
     I              LYKKDT                          WFKKDT
     I              LYAVTM                          WFAVTM
     I              LYSTAS                          WFSTAS
     I              LYXRST                          WFXRST
     I              LYX7CD                          WFX7CD
     I              LYGXTX                          WFGXTX
     I              LYXTST                          WFXTST
     I              LYXVST                          WFXVST
     I              LYSTU3                          WFSTU3
     I              LYSTU4                          WFSTU4
     I              LYSTU5                          WFSTU5
     I              LYLCDT                          WFLCDT
     I              LYLDDT                          WFLDDT
     I              LYLEDT                          WFLEDT
     I              LYLFDT                          WFLFDT
     I              LYLGDT                          WFLGDT
     I              LYUVST                          WFUVST
     I              LYUWST                          WFUWST
     I              LYUXST                          WFUXST
     I              LYVSST                          WFVSST
     I              LYAATM                          WFAATM
     I              LYAYNA                          WFAYNA
     I              LYA0NA                          WFA0NA
     I              LYAXDT                          WFAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: WF Invoice/Combine Drv
      * I : MAP Job Name CDE
     I                                        1  10 P1B2VN
      * I : MAP Job Number Cde
     I                                       11  20 P1DJVN
      * I : MAP Order Number
     I                                    P  21  240P1C4NB
      * I : MAP Company Number
     I                                    P  25  260P1AIC3
     IP2PARM      DS
      * I : MAP Reprint Status USR
     I                                        1   1 P2NBSX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1B2VN    PARM           WP0001 10        Job Name CDE
     C           P1DJVN    PARM           WP0002 10        Job Number Cde
     C           P1C4NB    PARM           WP0003  70       Order Number
     C           P1AIC3    PARM           WP0004  30       Company Number
     C           P2NBSX    PARM           WP0005  1        Reprint Status
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT 1 WF Invoice/Cmb   XF
      * CASE: PAR.Reprint Status USR is Reprint
     C           P2NBSX    IFEQ 'R'                        *IF
      * ** Reprint Combo Invoice, does not fax        E002016
      * SEL Inv to Prnt& Post  RT - WF Invoice/Combine Drv  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1B2VN    WL0001    P      Job Name CDE
     C                     MOVELP1DJVN    WL0002    P      Job Number Cde
     C                     Z-ADDP1AIC3    WL0003           Company Number
     C                     Z-ADDYL0001    WL0004           Count USR
     C                     MOVELYL0002    WL0005    P      Process Cust Ty
     C                     MOVELYL0003    WL0006    P      Status - Y or N
     C                     MOVELP2NBSX    WL0007    P      Reprint Status
     C                     EXSR SARVGN
     C                     ELSE
      * CASE: PAR.Reprint Status USR is Reprint(Form)
     C           P2NBSX    IFEQ 'Y'                        *IF
      * SEL Inv to Prnt& Post  RT - WF Invoice/Combine Drv  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1B2VN    WL0001    P      Job Name CDE
     C                     MOVELP1DJVN    WL0002    P      Job Number Cde
     C                     Z-ADDP1AIC3    WL0003           Company Number
     C                     Z-ADDYL0001    WL0004           Count USR
     C                     MOVELYL0002    WL0005    P      Process Cust Ty
     C                     MOVELYL0003    WL0006    P      Status - Y or N
     C                     MOVELP2NBSX    WL0007    P      Reprint Status
     C                     EXSR SARVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * **  Invoice Print, this routine fax/emails invoice E002016
      * SEL InvRep Fax         RT - WF Invoice/Combine Drv  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * SEL Inv to Prnt& Post  RT - WF Invoice/Combine Drv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAB2VN    WQSA01           Job Name CDE
     C           *LIKE     DEFN WADJVN    WQSA02           Job Number Cde
     C           *LIKE     DEFN WAAIC3    WQSA03           Company Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Job Name CDE
     C                     KFLD           WQSA02           Job Number Cde
     C                     KFLD           WQSA03           Company Number
      * Setup key
     C                     MOVELWL0001    WQSA01           Job Name CDE
     C                     MOVELWL0002    WQSA02           Job Number Cde
     C                     Z-ADDWL0003    WQSA03           Company Number
      * Establish starting position
     C           KRSSA     SETLL@AFCPHX                    *
     C           KRSSA     READE@AFCPHX                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3671' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'N'       YL0004           Break
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.One Invoice Per PO is Yes
      *   |- c2    : DB1.WF Inv/Comb Billing Type is Invoice or Debit Mem
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAHUSX    IFEQ 'Y'                        *IF
     C           WABETX    IFEQ '3'                        *IF
     C           WABETX    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * This process is already restricting by Job and company
      * CHG:  Actual Shipped Date/Ship To Customer/Customer PO
      * CASE: LCL.Actual Shipped Date NE DB1.Actual Shipped Date
     C           YL0005    IFNE WAGNDT                     *IF
     C                     MOVEL'Y'       YL0004           Break
     C                     ELSE
      * CASE: LCL.Ship To Customer NE DB1.Ship To Customer
     C           YL0006    IFNE WABKC7                     *IF
     C                     MOVEL'Y'       YL0004           Break
     C                     ELSE
      * CASE: LCL.Customer Purchase Order # NE DB1.Customer Purchase Orde
     C           YL0007    IFNE WABCNA                     *IF
     C                     MOVEL'Y'       YL0004           Break
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Break logic print the combine invoice on the first one
      * CASE: LCL.Break is Yes
     C           YL0004    IFEQ 'Y'                        *IF
      * * establish first logic break, only select print of combine invoi
      * when the ship to and customer po number changes
      * ** Depending on option, format for Form or No Form    E002016
      * CASE: PAR.Reprint Status USR is Reprint
     C           WL0007    IFEQ 'R'                        *IF
      * PRT Inv/Fast FaxCMB 6LPPF - Order Header TRG  * 
     C                     CALL 'PMCKPFR'              90  PRT Inv/Fast Fa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0001  30       Company Number
     C                     PARM WAC4NB    WQ0002  70       Order Number
     C                     PARM WABKC7    WQ0003  70       Ship To Custome
     C                     PARM WABCNA    WQ0004 15        Customer Purcha
     C                     PARM WAGNDT    WQ0005  70       Actual Shipped
     C           YL0008    PARM YL0008    WQ0006  1        Printed Status
     C                     PARM WAB2VN    WQ0007 10        Job Name CDE
     C                     PARM WADJVN    WQ0008 10        Job Number Cde
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCKPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * PRT Inv/Memo 8LPI CB   PF - Order Header TRG  * 
     C                     CALL 'PMCJPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0009  30       Company Number
     C                     PARM WAC4NB    WQ0010  70       Order Number
     C                     PARM WABKC7    WQ0011  70       Ship To Custome
     C                     PARM WABCNA    WQ0012 15        Customer Purcha
     C                     PARM WAGNDT    WQ0013  70       Actual Shipped
     C                     PARM WL0006    WQ0014  1        Printed Status
     C                     PARM WAB2VN    WQ0015 10        Job Name CDE
     C                     PARM WADJVN    WQ0016 10        Job Number Cde
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCJPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Dlt trailer for Invoiced order, Seaboard only         E002966
      * CASE: DB1.WF Inv/Comb Billing Type is Invoice
     C           WABETX    IFEQ '1'                        *IF
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0008           Company Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YN0001    P      Plant Company S
     C                     MOVELWL0010    YL0009    P      Company Organiz
      * CASE: LCL.Company Organization is Seaboard
     C           YL0009    IFEQ 'S'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDWAC4NB    WL0012           Order Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    YN0002           Scheduled Ship
     C                     Z-ADDWL0014    YL0010           Load ID
     C                     MOVELWL0015    YL0011    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0011    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0010    WL0016           Load ID
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    YL0012    P      Trailer Id
     C                     MOVELWL0018    YL0013    P      Carrier Code
      * * Not an error if no trailer                          E002966
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0013    WL0019    P      Carrier Code
     C                     MOVELYL0012    WL0020    P      Trailer Id
     C                     EXSR SERVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWABKC7    YL0006           Ship To Custome
     C                     MOVELWABCNA    YL0007           Customer Purcha
     C                     Z-ADDWAGNDT    YL0005           Actual Shipped
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@AFCPHX                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0008    WBAIC3           Company Number
      * Establish starting position
     C           KRSSB     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0009           Plant Company S
     C                     MOVEL*BLANK    WL0010           Company Organiz
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBYISX    WL0009           Plant Company S
     C                     MOVELWBYJSX    WL0010           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0013           Scheduled Ship
     C                     Z-ADD*ZERO     WL0014           Load ID
     C                     MOVEL*BLANK    WL0015           Load Plan Order
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0011    WCAIC3           Company Number
     C                     Z-ADDWL0012    WCC4NB           Order Number
      * Establish starting position
     C           KRSSC     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCAODT    WL0013           Scheduled Ship
     C                     Z-ADDWCRMNB    WL0014           Load ID
     C                     MOVELWCU4ST    WL0015           Load Plan Order
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Carrier & Trailer  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0016    WDRMNB           Load ID
      * Establish starting position
     C           KRSSD     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDDXTX    WL0017           Trailer Id
     C                     MOVELWDBZNA    WL0018           Carrier Code
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEBZNA           Carrier Code
     C                     KFLD           WEDXTX           Trailer Id
      * Setup key
     C                     MOVELWL0019    WEBZNA           Carrier Code
     C                     MOVELWL0020    WEDXTX           Trailer Id
      * Establish starting position
     C           KRSSE     CHAIN@LYRER3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2598' W0RTN   7
      * USER: Processing if Data record not found
      * * Not an error, may have been deleted from another order on load
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * DLT Trailer            DO - Trailer  * 
     C                     EXSR SFDLRC
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * DLT Trailer            DO - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @LYRER2
     C                     MOVELWEBZNA    WFBZNA           Carrier Code
     C                     MOVELWEDXTX    WFDXTX           Trailer Id
      *
     C           KLDLSF    KLIST
     C                     KFLD           WFBZNA           Carrier Code
     C                     KFLD           WFDXTX           Trailer Id
     C           KLDLSF    CHAIN@LYRER2              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLYREL0'MDACP
     C                     MOVEL'@LYRER2' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@LYRER2                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * SEL InvRep Fax         RT - WF Invoice/Combine Drv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAB2VN    WQSG01           Job Name CDE
     C           *LIKE     DEFN WADJVN    WQSG02           Job Number Cde
     C           *LIKE     DEFN WAAIC3    WQSG03           Company Number
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Job Name CDE
     C                     KFLD           WQSG02           Job Number Cde
     C                     KFLD           WQSG03           Company Number
      * Setup key
     C                     MOVELP1B2VN    WQSG01           Job Name CDE
     C                     MOVELP1DJVN    WQSG02           Job Number Cde
     C                     Z-ADDP1AIC3    WQSG03           Company Number
      * Establish starting position
     C           KRSSG     SETLL@AFCPHX                    *
     C           KRSSG     READE@AFCPHX                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3671' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'N'       YL0014           Break
      * CASE: DB1.One Invoice Per PO is Yes
     C           WAHUSX    IFEQ 'Y'                        *IF
      * This process is already restricting by Job and company
      * BRK:  Actual Shipped Date/Ship To Customer/Customer PO
      * CASE: LCL.Actual Shipped Date NE DB1.Actual Shipped Date
     C           YL0015    IFNE WAGNDT                     *IF
     C                     MOVEL'Y'       YL0014           Break
     C                     ELSE
      * CASE: LCL.Ship To Customer NE DB1.Ship To Customer
     C           YL0016    IFNE WABKC7                     *IF
     C                     MOVEL'Y'       YL0014           Break
     C                     ELSE
      * CASE: LCL.Customer Purchase Order # NE DB1.Customer Purchase Orde
     C           YL0017    IFNE WABCNA                     *IF
     C                     MOVEL'Y'       YL0014           Break
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Break logic print the combine invoice on the first one
      * CASE: LCL.Break is Yes
     C           YL0014    IFEQ 'Y'                        *IF
      * * establish first logic break, only select print of combine invoi
      * when the ship to and customer po number changes
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.Order Value Total is not equal to zeros
      *   |- c2    : DB1.Order Weight Total is Not equal zero
      *   |- c3    : DB1.WF Inv/Comb Billing Type is Invoice or Debit Mem
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAJZVA    IFNE 0                          *IF
     C           WAA1WG    IFNE 0                          *IF
     C           WABETX    IFEQ '3'                        *IF
     C           WABETX    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Don't fax if the amount and weight are zeros.   04/19/06 LJB
      * PRT Inv/Fast FaxCMB 6LPPF - Order Header TRG  * 
     C                     CALL 'PMCKPFR'              90  PRT Inv/Fast Fa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0017  30       Company Number
     C                     PARM WAC4NB    WQ0018  70       Order Number
     C                     PARM WABKC7    WQ0019  70       Ship To Custome
     C                     PARM WABCNA    WQ0020 15        Customer Purcha
     C                     PARM WAGNDT    WQ0021  70       Actual Shipped
     C           YL0018    PARM YL0018    WQ0022  1        Printed Status
     C                     PARM WAB2VN    WQ0023 10        Job Name CDE
     C                     PARM WADJVN    WQ0024 10        Job Number Cde
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCKPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Dlt trailer for Invoiced order, Seaboard only         E002966
      * CASE: DB1.WF Inv/Comb Billing Type is Invoice
     C           WABETX    IFEQ '1'                        *IF
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0008           Company Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YN0003    P      Plant Company S
     C                     MOVELWL0010    YL0019    P      Company Organiz
      * CASE: LCL.Company Organization is Seaboard
     C           YL0019    IFEQ 'S'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDWAC4NB    WL0012           Order Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    YN0004           Scheduled Ship
     C                     Z-ADDWL0014    YL0020           Load ID
     C                     MOVELWL0015    YL0021    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0021    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0020    WL0016           Load ID
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    YL0022    P      Trailer Id
     C                     MOVELWL0018    YL0023    P      Carrier Code
      * * Delete trailer. Not an error if trailer doesn't exist E002966
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0023    WL0019    P      Carrier Code
     C                     MOVELYL0022    WL0020    P      Trailer Id
     C                     EXSR SERVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWABKC7    YL0016           Ship To Custome
     C                     MOVELWABCNA    YL0017           Customer Purcha
     C                     Z-ADDWAGNDT    YL0015           Actual Shipped
      * PRC Fax One Cust Combo XF - Company Customer  * 
     C                     CALL 'PMC6XFR'              90  PRC Fax One Cus
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0025  30       Company Number
     C                     PARM WAEMC7    WQ0026  70       Ship To Custome
     C           YL0024    PARM YL0024    WQ0027 25        Fax Recipient
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMC6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSG     READE@AFCPHX                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 02/21/2014 LJB E002966
      * ** Delete the trailer record if this is an Invoiced order for
      * **  Seaboard only
      * ** 04/01/2010 LJB P000198 (sub task: E000673)
      * ** Fax flag will no longer be maintained. Fax and Email are now
      * ** stored in Cust Distribution Entry.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAEMC7           Bill to Custome
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBXXTM           Departure Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WCA1WG           Order Weight To
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCVRVA           A/R order Value
     C                     Z-ADD*ZERO     WCB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WCNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WCNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WCNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WCNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WCNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WCBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WCBQTM           Time of Origina
     C                     Z-ADD*ZERO     WCBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WCBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WCBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WCH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WCH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WCH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WCH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WCH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WDFLAM           Flat Amount
     C                     Z-ADD*ZERO     WDRRNB           Total Stops
     C                     Z-ADD*ZERO     WDSBNB           BOL Time
     C                     Z-ADD*ZERO     WDSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDSDNB           Number Pallets
     C                     Z-ADD*ZERO     WDPAOU           Number Pallets
     C                     Z-ADD*ZERO     WDDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WDSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WDHADT           Actual Arrival
     C                     Z-ADD*ZERO     WDAART           Actual Arrival
     C                     Z-ADD*ZERO     WDDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WDDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WDAQDT           Actual Departur
     C                     Z-ADD*ZERO     WDS6NB           Departure Time
     C                     Z-ADD*ZERO     WDT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WDPRTM           Product Tempera
     C                     Z-ADD*ZERO     WDNPSV           Number Spacers
     C                     Z-ADD*ZERO     WDTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WDGRWE           Gross Weight
     C                     Z-ADD*ZERO     WDF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WDJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WDTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WDJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WDSPTM           Spotted Time
     C                     Z-ADD*ZERO     WDJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WDLFTM           Load Finished T
     C                     Z-ADD*ZERO     WDJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WDBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WDJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WDBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WDKIDT           Truck Departure
     C                     Z-ADD*ZERO     WDASTM           Truck Departure
     C                     Z-ADD*ZERO     WDKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WDAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WDVOAG           Voyage
     C                     Z-ADD*ZERO     WDKBDT           Sail Date
     C                     Z-ADD*ZERO     WDEFDT           Arrival Date
     C                     Z-ADD*ZERO     WDKCDT           Date In
     C                     Z-ADD*ZERO     WDTMIN           Time In
     C                     Z-ADD*ZERO     WDKDDT           Date Out
     C                     Z-ADD*ZERO     WDVMNB           Time Out
     C                     Z-ADD*ZERO     WDOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WDKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WDATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WDBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDKKDT           On Yard Date
     C                     Z-ADD*ZERO     WDAVTM           On Yard Time
     C                     Z-ADD*ZERO     WDKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WDAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WDLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WDK0DT           Product Complet
     C                     Z-ADD*ZERO     WDAYTM           Product Complet
     C                     Z-ADD*ZERO     WDKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WDICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WDIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WDK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WDAZTM           Load Door 1
     C                     Z-ADD*ZERO     WDK2DT           Override Total
     C                     Z-ADD*ZERO     WDA0TM           Load Door 2
     C                     Z-ADD*ZERO     WDZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WDPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WDCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WDPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WDCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WDP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WDCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WDP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WDCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WDP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WDCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WDP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WDCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEKKDT           On Yard Date
     C                     Z-ADD*ZERO     WEAVTM           On Yard Time
     C                     Z-ADD*ZERO     WELCDT           Date Unused 1
     C                     Z-ADD*ZERO     WELDDT           Date Unused 2
     C                     Z-ADD*ZERO     WELEDT           Date Unused 3
     C                     Z-ADD*ZERO     WELFDT           Date Unused 4
     C                     Z-ADD*ZERO     WELGDT           Date Unused 5
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     MOVEL*BLANK    WL0002 10
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  50
     C                     MOVEL*BLANK    WL0005  2
     C                     MOVEL*BLANK    WL0006  1
     C                     MOVEL*BLANK    WL0007  1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  1
     C                     MOVEL*BLANK    WL0010  1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  70
     C                     MOVEL*BLANK    WL0015  1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0016  70
     C                     MOVEL*BLANK    WL0017 20
     C                     MOVEL*BLANK    WL0018  3
      * Define local variables for subroutine SERVGN.
     C                     MOVEL*BLANK    WL0019  3
     C                     MOVEL*BLANK    WL0020 20
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0001  50
      * Define local work field Process Cust Types Usr
     C                     MOVEL*BLANK    YL0002  2
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Break
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0007 15
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0008  1
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0009  1
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0002  70
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field Load Plan Order
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Trailer Id
     C                     MOVEL*BLANK    YL0012 20
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0013  3
      * Define local work field Break
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0016  70
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0017 15
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0018  1
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0003  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0019  1
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0004  70
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0020  70
      * Define local work field Load Plan Order
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field Trailer Id
     C                     MOVEL*BLANK    YL0022 20
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0023  3
      * Define local work field Fax Recipient
     C                     MOVEL*BLANK    YL0024 25
      *================================================================
     CSR         ZZEXIT    ENDSR
