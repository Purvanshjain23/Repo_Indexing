// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PWIRXFR
// ?Date: 14.08.2025 Time: 02:56:35
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?E15630 JJH 03/11/19 - Delete Buy Order Load Comment
//?- This program is intended to be ran 1-time and it will delete
//?  all Buy Order Load Comment records that do not have a parent
//?  record in the Buy Order Load file.
//?H16853 ISE 11/04/2020 - Recompiled due to change in Buy Order Number
EXECUTE FUNCTION(Fix Buy Order Load Com RT) TYPE(RTVOBJ) FILE(PLB1CPP)          AB1350233;
{
 //?USER: Process Data record

 EXECUTE FUNCTION(Rtv Buy Order Load Com EX) TYPE(RTVOBJ) FILE(PKAXCPP)          AB1350234;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(LCL.Record_Found_USR);
 {
  //?USER: Processing if Data record not found

  // PAR.Record Found USR = CND.Record Not Found
  PAR.Record_Found_USR = 'N';

  //?USER: Process Data record

  // PAR.Record Found USR = CND.Record Found
  PAR.Record_Found_USR = 'Y';

 }

 CASE;

 // IF LCL.Record Found USR is Record Not Found
 IF LCL.Record_Found_USR = 'N';

 EXECUTE FUNCTION(Del Buy Order Load Com DL) TYPE(DLTOBJ) FILE(PLB1CPP)          AB1321668;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(DB1.BOL_Comment_Line_Number);
 ENDIF;

}


