     H/TITLE Upd Balances Tran-ToWh XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 01/26/24  Time  : 12:33:28
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB0REL1IF  E           K        DISK
      * RTV : Item Balance              Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPUC6REL1IF  E           K        DISK
      * RTV : OMS Transformation Ctl    Retrieval index
      *
     FCAB7CPLEIF  E           K        DISK
      * RSQ : Item Transaction Detail   Normal KEY Sequence (D)
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FCAB1REL4IF  E           K        DISK
      * RTV : Item Balance Detail       Active only
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FCAB0RELJIF  E           K        DISK
      * RTV : Item Balance              Acitve records only
      *
     FCAB7CPL1IF  E           K        DISK
      * RTV : Item Transaction Detail   Retrieval index       NV
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FCAB7CPL0IF  E           K        DISK                      A
      * UPD : Item Transaction Detail   Update index
      *
     FCAB1REL1UF  E           K        DISK                      A
      * UPD : Item Balance Detail       Update index
      *
     FCAB0REL0UF  E           K        DISK                      A
      * UPD : Item Balance              Update index
      *
      * Long constants
     E                    @CN#    1  11  6   @CN    25
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WAAIC3
     I              BZHGCD                          WAHGCD
     I              BZAVNA                          WAAVNA
     I              BZAWNA                          WAAWNA
     I              BZL7NA                          WAL7NA
     I              BZL8NA                          WAL8NA
     I              BZL6NA                          WAL6NA
     I              BZMFNA                          WAMFNA
     I              BZADCD                          WAADCD
     I              BZAWPC                          WAAWPC
     I              BZLXST                          WALXST
     I              BZAECD                          WAAECD
     I              BZAXPC                          WAAXPC
     I              BZLYST                          WALYST
     I              BZAFCD                          WAAFCD
     I              BZAICD                          WAAICD
     I              BZAIWG                          WAAIWG
     I              BZHICD                          WAHICD
     I              BZRBCD                          WARBCD
     I              BZFZST                          WAFZST
     I              BZAVST                          WAAVST
     I              BZCZWG                          WACZWG
     I              BZC0WG                          WAC0WG
     I              BZURTN                          WAURTN
     I              BZAJC8                          WAAJC8
     I              BZRINB                          WARINB
     I              BZRHNB                          WARHNB
     I              BZRGNB                          WARGNB
     I              BZLNCD                          WALNCD
     I              BZTFNB                          WATFNB
     I              BZN0CD                          WAN0CD
     I              BZX4ST                          WAX4ST
     I              BZTMVA                          WATMVA
     I              BZTNVA                          WATNVA
     I              BZBLPR                          WABLPR
     I              BZBMPR                          WABMPR
     I              BZLRCD                          WALRCD
     I              BZU9ST                          WAU9ST
     I              BZCMCO                          WACMCO
     I              BZQ1CD                          WAQ1CD
     I              BZQ8CD                          WAQ8CD
     I              BZCHTM                          WACHTM
     I              BZQZCD                          WAQZCD
     I              BZXWST                          WAXWST
     I              BZXXST                          WAXXST
     I              BZVMST                          WAVMST
     I              BZSWGH                          WASWGH
     I              BZPPHE                          WAPPHE
     I              BZR3CD                          WAR3CD
     I              BZSDCD                          WASDCD
     I              BZICN1                          WAICN1
     I              BZSVCD                          WASVCD
     I              BZICN2                          WAICN2
     I              BZSWCD                          WASWCD
     I              BZV2NB                          WAV2NB
     I              BZSXCD                          WASXCD
     I              BZITCN                          WAITCN
     I              BZSYCD                          WASYCD
     I              BZITC5                          WAITC5
     I              BZSZCD                          WASZCD
     I              BZICN6                          WAICN6
     I              BZS0CD                          WAS0CD
     I              BZICN7                          WAICN7
     I              BZS1CD                          WAS1CD
     I              BZICN8                          WAICN8
     I              BZS2CD                          WAS2CD
     I              BZICN9                          WAICN9
     I              BZS3CD                          WAS3CD
     I              BZICN0                          WAICN0
     I              BZS4CD                          WAS4CD
     I              BZSFNB                          WASFNB
     I              BZA3WG                          WAA3WG
     I              BZSJNB                          WASJNB
     I              BZLLCD                          WALLCD
     I              BZLMCD                          WALMCD
     I              BZP3ST                          WAP3ST
     I              BZSKNB                          WASKNB
     I              BZSLNB                          WASLNB
     I              BZSMNB                          WASMNB
     I              BZP4ST                          WAP4ST
     I              BZCFNB                          WACFNB
     I              BZCGNB                          WACGNB
     I              BZILNB                          WAILNB
     I              BZCHNB                          WACHNB
     I              BZCINB                          WACINB
     I              BZCJNB                          WACJNB
     I              BZCMNB                          WACMNB
     I              BZCNNB                          WACNNB
     I              BZCRNB                          WACRNB
     I              BZCSNB                          WACSNB
     I              BZCVNB                          WACVNB
     I              BZCWNB                          WACWNB
     I              BZCXNB                          WACXNB
     I              BZCZNB                          WACZNB
     I              BZC0NB                          WAC0NB
     I              BZN1CD                          WAN1CD
     I              BZB4NB                          WAB4NB
     I              BZB5NB                          WAB5NB
     I              BZX5ST                          WAX5ST
     I              BZX6ST                          WAX6ST
     I              BZX7ST                          WAX7ST
     I              BZPCCT                          WAPCCT
     I              BZBDNB                          WABDNB
     I              BZBJNB                          WABJNB
     I              BZSUST                          WASUST
     I              BZSVST                          WASVST
     I              BZSYST                          WASYST
     I              BZSZST                          WASZST
     I              BZS1ST                          WAS1ST
     I              BZXRCD                          WAXRCD
     I              BZXTCD                          WAXTCD
     I              BZXUCD                          WAXUCD
     I              BZF5WG                          WAF5WG
     I              BZF6WG                          WAF6WG
     I              BZF7WG                          WAF7WG
     I              BZBLNB                          WABLNB
     I              BZBNNB                          WABNNB
     I              BZS2ST                          WAS2ST
     I              BZS4ST                          WAS4ST
     I              BZS5ST                          WAS5ST
     I              BZS6ST                          WAS6ST
     I              BZS8ST                          WAS8ST
     I              BZS9ST                          WAS9ST
     I              BZTCST                          WATCST
     I              BZTDST                          WATDST
     I              BZUVST                          WAUVST
     I              BZUWST                          WAUWST
     I              BZUXST                          WAUXST
     I              BZVSST                          WAVSST
     I              BZAATM                          WAAATM
     I              BZAYNA                          WAAYNA
     I              BZA0NA                          WAA0NA
     I              BZAXDT                          WAAXDT
      *
     I@B0REJX
      * Item Balance              Retrieval index       NV
      * Renamed input format fields
     I              B0AIC3                          WBAIC3
     I              B0HGCD                          WBHGCD
     I              B0AJCD                          WBAJCD
     I              B0AGCS                          WBAGCS
     I              B0AECS                          WBAECS
     I              B0BACS                          WBBACS
     I              B0BBCS                          WBBBCS
     I              B0CBPR                          WBCBPR
     I              B0GUDT                          WBGUDT
     I              B0XYST                          WBXYST
     I              B0CTPR                          WBCTPR
     I              B0G4DT                          WBG4DT
     I              B0BOWG                          WBBOWG
     I              B0DDQT                          WBDDQT
     I              B0DEQT                          WBDEQT
     I              B0DFQT                          WBDFQT
     I              B0HDQT                          WBHDQT
     I              B0HEQT                          WBHEQT
     I              B0AJQT                          WBAJQT
     I              B0AQQT                          WBAQQT
     I              B0AUQT                          WBAUQT
     I              B0EMQT                          WBEMQT
     I              B0DOQT                          WBDOQT
     I              B0ATNA                          WBATNA
     I              B0AKDT                          WBAKDT
     I              B0ANDT                          WBANDT
     I              B0IDVA                          WBIDVA
     I              B0JVST                          WBJVST
     I              B0BZPC                          WBBZPC
     I              B0DGQT                          WBDGQT
     I              B0DIDT                          WBDIDT
     I              B0ALCD                          WBALCD
     I              B0BFDY                          WBBFDY
     I              B0DJDT                          WBDJDT
     I              B0BGDY                          WBBGDY
     I              B0DKDT                          WBDKDT
     I              B0J2ST                          WBJ2ST
     I              B0DJQT                          WBDJQT
     I              B0BNWG                          WBBNWG
     I              B0DLDT                          WBDLDT
     I              B0DPQT                          WBDPQT
     I              B0DQQT                          WBDQQT
     I              B0DMDT                          WBDMDT
     I              B0M0ST                          WBM0ST
     I              B0J9ST                          WBJ9ST
     I              B0KBST                          WBKBST
     I              B0AKC8                          WBAKC8
     I              B0RINB                          WBRINB
     I              B0RHNB                          WBRHNB
     I              B0RGNB                          WBRGNB
     I              B0UVST                          WBUVST
     I              B0UWST                          WBUWST
     I              B0UXST                          WBUXST
     I              B0VSST                          WBVSST
     I              B0AATM                          WBAATM
     I              B0AYNA                          WBAYNA
     I              B0A0NA                          WBA0NA
     I              B0AXDT                          WBAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@C6REMK
      * OMS Transformation Ctl    Retrieval index
      * Renamed input format fields
     I              C6B3AB                          WDB3AB
     I              C6HUNZ                          WDHUNZ
     I              C6OCSC                          WDOCSC
     I              C6UNU1                          WDUNU1
     I              C6VSST                          WDVSST
     I              C6BGTS                          WDBGTS
     I              C6RUU1                          WDRUU1
     I              C6RVU1                          WDRVU1
     I              C6BHTS                          WDBHTS
     I              C6RWU1                          WDRWU1
     I              C6RXU1                          WDRXU1
      *
     I@B7CPZA
      * Item Transaction Detail   Normal KEY Sequence (D)
      * Renamed input format fields
     I              B7AIC3                          WEAIC3
     I              B7HGCD                          WEHGCD
     I              B7AJCD                          WEAJCD
     I              B7W9ST                          WEW9ST
     I              B7BSST                          WEBSST
     I              B7B4DT                          WEB4DT
     I              B7C4NY                          WEC4NY
     I              B7DXNB                          WEDXNB
     I              B7ELDT                          WEELDT
     I              B7HVCD                          WEHVCD
     I              B7F1ST                          WEF1ST
     I              B7AUNA                          WEAUNA
     I              B7A5QT                          WEA5QT
     I              B7AHWG                          WEAHWG
     I              B7AKCS                          WEAKCS
     I              B7CGCD                          WECGCD
     I              B7AYVA                          WEAYVA
     I              B7BJNA                          WEBJNA
     I              B7CKNB                          WECKNB
     I              B7BMST                          WEBMST
     I              B7CQCD                          WECQCD
     I              B7DTCD                          WEDTCD
     I              B7MGNA                          WEMGNA
     I              B7TRBN                          WETRBN
     I              B7TRBS                          WETRBS
     I              B7C4NB                          WEC4NB
     I              B7RINB                          WERINB
     I              B7RHNB                          WERHNB
     I              B7RGNB                          WERGNB
     I              B7M3NA                          WEM3NA
     I              B7AWTM                          WEAWTM
     I              B7XLCD                          WEXLCD
     I              B7K7DT                          WEK7DT
     I              B7UVST                          WEUVST
     I              B7UWST                          WEUWST
     I              B7UXST                          WEUXST
     I              B7VSST                          WEVSST
     I              B7AATM                          WEAATM
     I              B7AYNA                          WEAYNA
     I              B7A0NA                          WEA0NA
     I              B7AXDT                          WEAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WFAIC3
     I              B7HGCD                          WFHGCD
     I              B7AJCD                          WFAJCD
     I              B7W9ST                          WFW9ST
     I              B7BSST                          WFBSST
     I              B7B4DT                          WFB4DT
     I              B7C4NY                          WFC4NY
     I              B7DXNB                          WFDXNB
     I              B7ELDT                          WFELDT
     I              B7HVCD                          WFHVCD
     I              B7F1ST                          WFF1ST
     I              B7AUNA                          WFAUNA
     I              B7A5QT                          WFA5QT
     I              B7AHWG                          WFAHWG
     I              B7AKCS                          WFAKCS
     I              B7CGCD                          WFCGCD
     I              B7AYVA                          WFAYVA
     I              B7BJNA                          WFBJNA
     I              B7CKNB                          WFCKNB
     I              B7BMST                          WFBMST
     I              B7CQCD                          WFCQCD
     I              B7DTCD                          WFDTCD
     I              B7MGNA                          WFMGNA
     I              B7TRBN                          WFTRBN
     I              B7TRBS                          WFTRBS
     I              B7C4NB                          WFC4NB
     I              B7RINB                          WFRINB
     I              B7RHNB                          WFRHNB
     I              B7RGNB                          WFRGNB
     I              B7M3NA                          WFM3NA
     I              B7AWTM                          WFAWTM
     I              B7XLCD                          WFXLCD
     I              B7K7DT                          WFK7DT
     I              B7UVST                          WFUVST
     I              B7UWST                          WFUWST
     I              B7UXST                          WFUXST
     I              B7VSST                          WFVSST
     I              B7AATM                          WFAATM
     I              B7AYNA                          WFAYNA
     I              B7A0NA                          WFA0NA
     I              B7AXDT                          WFAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WGAIC3
     I              B1HGCD                          WGHGCD
     I              B1AJCD                          WGAJCD
     I              B1ELDT                          WGELDT
     I              B1ABWG                          WGABWG
     I              B1AGQT                          WGAGQT
     I              B1AHQT                          WGAHQT
     I              B1AIQT                          WGAIQT
     I              B1CTST                          WGCTST
     I              B1ACWG                          WGACWG
     I              B1ARQT                          WGARQT
     I              B1ASQT                          WGASQT
     I              B1ATQT                          WGATQT
     I              B1HDQT                          WGHDQT
     I              B1HEQT                          WGHEQT
     I              B1F6ST                          WGF6ST
     I              B1BMWG                          WGBMWG
     I              B1DSQT                          WGDSQT
     I              B1DTQT                          WGDTQT
     I              B1DUQT                          WGDUQT
     I              B1DHDT                          WGDHDT
     I              B1AGCS                          WGAGCS
     I              B1AECS                          WGAECS
     I              B1IDVA                          WGIDVA
     I              B1K7DT                          WGK7DT
     I              B1RINB                          WGRINB
     I              B1RHNB                          WGRHNB
     I              B1RGNB                          WGRGNB
     I              B1UVST                          WGUVST
     I              B1UWST                          WGUWST
     I              B1UXST                          WGUXST
     I              B1VSST                          WGVSST
     I              B1AATM                          WGAATM
     I              B1AYNA                          WGAYNA
     I              B1A0NA                          WGA0NA
     I              B1AXDT                          WGAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WHAJCD
     I              ADF8NA                          WHF8NA
     I              ADACNA                          WHACNA
     I              ADADNA                          WHADNA
     I              ADAENA                          WHAENA
     I              ADAJNA                          WHAJNA
     I              ADBTTX                          WHBTTX
     I              ADAOCD                          WHAOCD
     I              ADBGCD                          WHBGCD
     I              ADVHST                          WHVHST
     I              ADMPNA                          WHMPNA
     I              ADWPST                          WHWPST
     I              ADXUST                          WHXUST
     I              ADT0ST                          WHT0ST
     I              ADT1ST                          WHT1ST
     I              ADDBNB                          WHDBNB
     I              ADT2ST                          WHT2ST
     I              ADT3ST                          WHT3ST
     I              ADT4ST                          WHT4ST
     I              ADT6ST                          WHT6ST
     I              ADBWC3                          WHBWC3
     I              ADBTC3                          WHBTC3
     I              ADBUC3                          WHBUC3
     I              ADBVC3                          WHBVC3
     I              ADFCAA                          WHFCAA
     I              ADRQSX                          WHRQSX
     I              ADRRSX                          WHRRSX
     I              ADRSSX                          WHRSSX
     I              ADRTSX                          WHRTSX
     I              ADT7ST                          WHT7ST
     I              ADT8ST                          WHT8ST
     I              ADRNSX                          WHRNSX
     I              ADROSX                          WHROSX
     I              ADRPSX                          WHRPSX
     I              ADUVST                          WHUVST
     I              ADUWST                          WHUWST
     I              ADUXST                          WHUXST
     I              ADVSST                          WHVSST
     I              ADAATM                          WHAATM
     I              ADAYNA                          WHAYNA
     I              ADA0NA                          WHA0NA
     I              ADAXDT                          WHAXDT
      *
     ICAB1RL4
      * Item Balance Detail       Active only
      * Renamed input format fields
     I              B1AIC3                          WIAIC3
     I              B1HGCD                          WIHGCD
     I              B1AJCD                          WIAJCD
     I              B1ELDT                          WIELDT
     I              B1ABWG                          WIABWG
     I              B1AGQT                          WIAGQT
     I              B1AHQT                          WIAHQT
     I              B1AIQT                          WIAIQT
     I              B1CTST                          WICTST
     I              B1ACWG                          WIACWG
     I              B1ARQT                          WIARQT
     I              B1ASQT                          WIASQT
     I              B1ATQT                          WIATQT
     I              B1HDQT                          WIHDQT
     I              B1HEQT                          WIHEQT
     I              B1F6ST                          WIF6ST
     I              B1BMWG                          WIBMWG
     I              B1DSQT                          WIDSQT
     I              B1DTQT                          WIDTQT
     I              B1DUQT                          WIDUQT
     I              B1DHDT                          WIDHDT
     I              B1AGCS                          WIAGCS
     I              B1AECS                          WIAECS
     I              B1IDVA                          WIIDVA
     I              B1K7DT                          WIK7DT
     I              B1RINB                          WIRINB
     I              B1RHNB                          WIRHNB
     I              B1RGNB                          WIRGNB
     I              B1UVST                          WIUVST
     I              B1UWST                          WIUWST
     I              B1UXST                          WIUXST
     I              B1VSST                          WIVSST
     I              B1AATM                          WIAATM
     I              B1AYNA                          WIAYNA
     I              B1A0NA                          WIA0NA
     I              B1AXDT                          WIAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WJAIC3
     I              B0HGCD                          WJHGCD
     I              B0AJCD                          WJAJCD
     I              B0AGCS                          WJAGCS
     I              B0AECS                          WJAECS
     I              B0BACS                          WJBACS
     I              B0BBCS                          WJBBCS
     I              B0CBPR                          WJCBPR
     I              B0GUDT                          WJGUDT
     I              B0XYST                          WJXYST
     I              B0CTPR                          WJCTPR
     I              B0G4DT                          WJG4DT
     I              B0BOWG                          WJBOWG
     I              B0DDQT                          WJDDQT
     I              B0DEQT                          WJDEQT
     I              B0DFQT                          WJDFQT
     I              B0HDQT                          WJHDQT
     I              B0HEQT                          WJHEQT
     I              B0AJQT                          WJAJQT
     I              B0AQQT                          WJAQQT
     I              B0AUQT                          WJAUQT
     I              B0EMQT                          WJEMQT
     I              B0DOQT                          WJDOQT
     I              B0ATNA                          WJATNA
     I              B0AKDT                          WJAKDT
     I              B0ANDT                          WJANDT
     I              B0IDVA                          WJIDVA
     I              B0JVST                          WJJVST
     I              B0BZPC                          WJBZPC
     I              B0DGQT                          WJDGQT
     I              B0DIDT                          WJDIDT
     I              B0ALCD                          WJALCD
     I              B0BFDY                          WJBFDY
     I              B0DJDT                          WJDJDT
     I              B0BGDY                          WJBGDY
     I              B0DKDT                          WJDKDT
     I              B0J2ST                          WJJ2ST
     I              B0DJQT                          WJDJQT
     I              B0BNWG                          WJBNWG
     I              B0DLDT                          WJDLDT
     I              B0DPQT                          WJDPQT
     I              B0DQQT                          WJDQQT
     I              B0DMDT                          WJDMDT
     I              B0M0ST                          WJM0ST
     I              B0J9ST                          WJJ9ST
     I              B0KBST                          WJKBST
     I              B0AKC8                          WJAKC8
     I              B0RINB                          WJRINB
     I              B0RHNB                          WJRHNB
     I              B0RGNB                          WJRGNB
     I              B0UVST                          WJUVST
     I              B0UWST                          WJUWST
     I              B0UXST                          WJUXST
     I              B0VSST                          WJVSST
     I              B0AATM                          WJAATM
     I              B0AYNA                          WJAYNA
     I              B0A0NA                          WJA0NA
     I              B0AXDT                          WJAXDT
      *
     I@L2RESM
      * Warehouse Location        Retrieval index
      * Renamed input format fields
     I              L2AJCD                          WKAJCD
     I              L2YMCD                          WKYMCD
     I              L2YPCD                          WKYPCD
     I              L2LCBY                          WKLCBY
     I              L2LCCT                          WKLCCT
     I              L2WLUS                          WKWLUS
     I              L2WUSD                          WKWUSD
     I              L2WLUN                          WKWLUN
     I              L2AGSX                          WKAGSX
     I              L2UVST                          WKUVST
     I              L2UWST                          WKUWST
     I              L2UXST                          WKUXST
     I              L2VSST                          WKVSST
     I              L2AATM                          WKAATM
     I              L2AYNA                          WKAYNA
     I              L2A0NA                          WKA0NA
     I              L2AXDT                          WKAXDT
      *
     I@B0REYY
      * Item Balance              Acitve records only
      * Renamed input format fields
     I              B0AIC3                          WLAIC3
     I              B0HGCD                          WLHGCD
     I              B0AJCD                          WLAJCD
     I              B0AGCS                          WLAGCS
     I              B0AECS                          WLAECS
     I              B0BACS                          WLBACS
     I              B0BBCS                          WLBBCS
     I              B0CBPR                          WLCBPR
     I              B0GUDT                          WLGUDT
     I              B0XYST                          WLXYST
     I              B0CTPR                          WLCTPR
     I              B0G4DT                          WLG4DT
     I              B0BOWG                          WLBOWG
     I              B0DDQT                          WLDDQT
     I              B0DEQT                          WLDEQT
     I              B0DFQT                          WLDFQT
     I              B0HDQT                          WLHDQT
     I              B0HEQT                          WLHEQT
     I              B0AJQT                          WLAJQT
     I              B0AQQT                          WLAQQT
     I              B0AUQT                          WLAUQT
     I              B0EMQT                          WLEMQT
     I              B0DOQT                          WLDOQT
     I              B0ATNA                          WLATNA
     I              B0AKDT                          WLAKDT
     I              B0ANDT                          WLANDT
     I              B0IDVA                          WLIDVA
     I              B0JVST                          WLJVST
     I              B0BZPC                          WLBZPC
     I              B0DGQT                          WLDGQT
     I              B0DIDT                          WLDIDT
     I              B0ALCD                          WLALCD
     I              B0BFDY                          WLBFDY
     I              B0DJDT                          WLDJDT
     I              B0BGDY                          WLBGDY
     I              B0DKDT                          WLDKDT
     I              B0J2ST                          WLJ2ST
     I              B0DJQT                          WLDJQT
     I              B0BNWG                          WLBNWG
     I              B0DLDT                          WLDLDT
     I              B0DPQT                          WLDPQT
     I              B0DQQT                          WLDQQT
     I              B0DMDT                          WLDMDT
     I              B0M0ST                          WLM0ST
     I              B0J9ST                          WLJ9ST
     I              B0KBST                          WLKBST
     I              B0AKC8                          WLAKC8
     I              B0RINB                          WLRINB
     I              B0RHNB                          WLRHNB
     I              B0RGNB                          WLRGNB
     I              B0UVST                          WLUVST
     I              B0UWST                          WLUWST
     I              B0UXST                          WLUXST
     I              B0VSST                          WLVSST
     I              B0AATM                          WLAATM
     I              B0AYNA                          WLAYNA
     I              B0A0NA                          WLA0NA
     I              B0AXDT                          WLAXDT
      *
     IRB7CPJ3
      * Item Transaction Detail   Retrieval index       NV
      * Renamed input format fields
     I              B7AIC3                          WMAIC3
     I              B7HGCD                          WMHGCD
     I              B7AJCD                          WMAJCD
     I              B7W9ST                          WMW9ST
     I              B7BSST                          WMBSST
     I              B7B4DT                          WMB4DT
     I              B7C4NY                          WMC4NY
     I              B7DXNB                          WMDXNB
     I              B7ELDT                          WMELDT
     I              B7HVCD                          WMHVCD
     I              B7F1ST                          WMF1ST
     I              B7AUNA                          WMAUNA
     I              B7A5QT                          WMA5QT
     I              B7AHWG                          WMAHWG
     I              B7AKCS                          WMAKCS
     I              B7CGCD                          WMCGCD
     I              B7AYVA                          WMAYVA
     I              B7BJNA                          WMBJNA
     I              B7CKNB                          WMCKNB
     I              B7BMST                          WMBMST
     I              B7CQCD                          WMCQCD
     I              B7DTCD                          WMDTCD
     I              B7MGNA                          WMMGNA
     I              B7TRBN                          WMTRBN
     I              B7TRBS                          WMTRBS
     I              B7C4NB                          WMC4NB
     I              B7RINB                          WMRINB
     I              B7RHNB                          WMRHNB
     I              B7RGNB                          WMRGNB
     I              B7M3NA                          WMM3NA
     I              B7AWTM                          WMAWTM
     I              B7XLCD                          WMXLCD
     I              B7K7DT                          WMK7DT
     I              B7UVST                          WMUVST
     I              B7UWST                          WMUWST
     I              B7UXST                          WMUXST
     I              B7VSST                          WMVSST
     I              B7AATM                          WMAATM
     I              B7AYNA                          WMAYNA
     I              B7A0NA                          WMA0NA
     I              B7AXDT                          WMAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          WOAIC3
     I              B1HGCD                          WOHGCD
     I              B1AJCD                          WOAJCD
     I              B1ELDT                          WOELDT
     I              B1ABWG                          WOABWG
     I              B1AGQT                          WOAGQT
     I              B1AHQT                          WOAHQT
     I              B1AIQT                          WOAIQT
     I              B1CTST                          WOCTST
     I              B1ACWG                          WOACWG
     I              B1ARQT                          WOARQT
     I              B1ASQT                          WOASQT
     I              B1ATQT                          WOATQT
     I              B1HDQT                          WOHDQT
     I              B1HEQT                          WOHEQT
     I              B1F6ST                          WOF6ST
     I              B1BMWG                          WOBMWG
     I              B1DSQT                          WODSQT
     I              B1DTQT                          WODTQT
     I              B1DUQT                          WODUQT
     I              B1DHDT                          WODHDT
     I              B1AGCS                          WOAGCS
     I              B1AECS                          WOAECS
     I              B1IDVA                          WOIDVA
     I              B1K7DT                          WOK7DT
     I              B1RINB                          WORINB
     I              B1RHNB                          WORHNB
     I              B1RGNB                          WORGNB
     I              B1UVST                          WOUVST
     I              B1UWST                          WOUWST
     I              B1UXST                          WOUXST
     I              B1VSST                          WOVSST
     I              B1AATM                          WOAATM
     I              B1AYNA                          WOAYNA
     I              B1A0NA                          WOA0NA
     I              B1AXDT                          WOAXDT
      *
     I@DPRETD
      * System Values             Retrieval index       NV
      * Renamed input format fields
     I              DPDOCD                          WRDOCD
     I              DPAUNA                          WRAUNA
     I              DPI5ST                          WRI5ST
     I              DPBXTX                          WRBXTX
     I              DPM8NB                          WRM8NB
     I              DPUVST                          WRUVST
     I              DPUWST                          WRUWST
     I              DPUXST                          WRUXST
     I              DPVSST                          WRVSST
     I              DPAATM                          WRAATM
     I              DPAYNA                          WRAYNA
     I              DPA0NA                          WRA0NA
     I              DPAXDT                          WRAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WFAIC3
     I              B7HGCD                          WFHGCD
     I              B7AJCD                          WFAJCD
     I              B7W9ST                          WFW9ST
     I              B7BSST                          WFBSST
     I              B7B4DT                          WFB4DT
     I              B7C4NY                          WFC4NY
     I              B7DXNB                          WFDXNB
     I              B7ELDT                          WFELDT
     I              B7HVCD                          WFHVCD
     I              B7F1ST                          WFF1ST
     I              B7AUNA                          WFAUNA
     I              B7A5QT                          WFA5QT
     I              B7AHWG                          WFAHWG
     I              B7AKCS                          WFAKCS
     I              B7CGCD                          WFCGCD
     I              B7AYVA                          WFAYVA
     I              B7BJNA                          WFBJNA
     I              B7CKNB                          WFCKNB
     I              B7BMST                          WFBMST
     I              B7CQCD                          WFCQCD
     I              B7DTCD                          WFDTCD
     I              B7MGNA                          WFMGNA
     I              B7TRBN                          WFTRBN
     I              B7TRBS                          WFTRBS
     I              B7C4NB                          WFC4NB
     I              B7RINB                          WFRINB
     I              B7RHNB                          WFRHNB
     I              B7RGNB                          WFRGNB
     I              B7M3NA                          WFM3NA
     I              B7AWTM                          WFAWTM
     I              B7XLCD                          WFXLCD
     I              B7K7DT                          WFK7DT
     I              B7UVST                          WFUVST
     I              B7UWST                          WFUWST
     I              B7UXST                          WFUXST
     I              B7VSST                          WFVSST
     I              B7AATM                          WFAATM
     I              B7AYNA                          WFAYNA
     I              B7A0NA                          WFA0NA
     I              B7AXDT                          WFAXDT
      *
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WGAIC3
     I              B1HGCD                          WGHGCD
     I              B1AJCD                          WGAJCD
     I              B1ELDT                          WGELDT
     I              B1ABWG                          WGABWG
     I              B1AGQT                          WGAGQT
     I              B1AHQT                          WGAHQT
     I              B1AIQT                          WGAIQT
     I              B1CTST                          WGCTST
     I              B1ACWG                          WGACWG
     I              B1ARQT                          WGARQT
     I              B1ASQT                          WGASQT
     I              B1ATQT                          WGATQT
     I              B1HDQT                          WGHDQT
     I              B1HEQT                          WGHEQT
     I              B1F6ST                          WGF6ST
     I              B1BMWG                          WGBMWG
     I              B1DSQT                          WGDSQT
     I              B1DTQT                          WGDTQT
     I              B1DUQT                          WGDUQT
     I              B1DHDT                          WGDHDT
     I              B1AGCS                          WGAGCS
     I              B1AECS                          WGAECS
     I              B1IDVA                          WGIDVA
     I              B1K7DT                          WGK7DT
     I              B1RINB                          WGRINB
     I              B1RHNB                          WGRHNB
     I              B1RGNB                          WGRGNB
     I              B1UVST                          WGUVST
     I              B1UWST                          WGUWST
     I              B1UXST                          WGUXST
     I              B1VSST                          WGVSST
     I              B1AATM                          WGAATM
     I              B1AYNA                          WGAYNA
     I              B1A0NA                          WGA0NA
     I              B1AXDT                          WGAXDT
      *
     IYARDCS      DS                            163
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WJAIC3
     I              B0HGCD                          WJHGCD
     I              B0AJCD                          WJAJCD
     I              B0AGCS                          WJAGCS
     I              B0AECS                          WJAECS
     I              B0BACS                          WJBACS
     I              B0BBCS                          WJBBCS
     I              B0CBPR                          WJCBPR
     I              B0GUDT                          WJGUDT
     I              B0XYST                          WJXYST
     I              B0CTPR                          WJCTPR
     I              B0G4DT                          WJG4DT
     I              B0BOWG                          WJBOWG
     I              B0DDQT                          WJDDQT
     I              B0DEQT                          WJDEQT
     I              B0DFQT                          WJDFQT
     I              B0HDQT                          WJHDQT
     I              B0HEQT                          WJHEQT
     I              B0AJQT                          WJAJQT
     I              B0AQQT                          WJAQQT
     I              B0AUQT                          WJAUQT
     I              B0EMQT                          WJEMQT
     I              B0DOQT                          WJDOQT
     I              B0ATNA                          WJATNA
     I              B0AKDT                          WJAKDT
     I              B0ANDT                          WJANDT
     I              B0IDVA                          WJIDVA
     I              B0JVST                          WJJVST
     I              B0BZPC                          WJBZPC
     I              B0DGQT                          WJDGQT
     I              B0DIDT                          WJDIDT
     I              B0ALCD                          WJALCD
     I              B0BFDY                          WJBFDY
     I              B0DJDT                          WJDJDT
     I              B0BGDY                          WJBGDY
     I              B0DKDT                          WJDKDT
     I              B0J2ST                          WJJ2ST
     I              B0DJQT                          WJDJQT
     I              B0BNWG                          WJBNWG
     I              B0DLDT                          WJDLDT
     I              B0DPQT                          WJDPQT
     I              B0DQQT                          WJDQQT
     I              B0DMDT                          WJDMDT
     I              B0M0ST                          WJM0ST
     I              B0J9ST                          WJJ9ST
     I              B0KBST                          WJKBST
     I              B0AKC8                          WJAKC8
     I              B0RINB                          WJRINB
     I              B0RHNB                          WJRHNB
     I              B0RGNB                          WJRGNB
     I              B0UVST                          WJUVST
     I              B0UWST                          WJUWST
     I              B0UXST                          WJUXST
     I              B0VSST                          WJVSST
     I              B0AATM                          WJAATM
     I              B0AYNA                          WJAYNA
     I              B0A0NA                          WJA0NA
     I              B0AXDT                          WJAXDT
      *
     IYBRDCS      DS                            245
     IYCRDCS      DS                            245
     IYDRDCS      DS                            163
      * Outward parameters
     IPARC        DS                            157
      * RCD : PAR API WIM Inv Shipping2
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Item Code
     I                                    P   3   60PAHGCD
      * I :  Ship From Warehouse
     I                                        7   9 PAVPCD
      * I :  WIM Inventory Trans ID
     I                                       10  12 PANOSC
      * I :  WIM Inventory Trans Type
     I                                       13  15 PANPSC
      * I :  Transaction Date
     I                                    P  16  190PAA9DT
      * I :  Production Date
     I                                    P  20  230PAELDT
      * I :  Item Transaction Source
     I                                       24  25 PAF1ST
      * I :  Transaction Description
     I                                       26  55 PAVQNA
      * I :  Transaction Reason Code
     I                                       56  58 PAA1AB
      * I :  Order Number
     I                                    P  59  620PAC4NB
      * I :  Shift Number
     I                                       63  63 PAXLCD
      * I :  Ship To Warehouse
     I                                       64  66 PAL9AA
      * I :  Transaction Weight
     I                                    P  67  722PAAHWG
      * I :  Transaction Quantity
     I                                    P  73  782PAA5QT
      * I :  USR Unship Flag
     I                                       79  79 PAUSST
      * I :  Inter-Plant Transfer USR
     I                                       80  80 PAA5TX
      * O :  API EccResult-MsgId U
     I                                       81  87 PACLAB
      * O :  API EccResult-MsgDesc U
     I                                       88 137 PAVGU1
      * B :  API Request Key U
     I                                      138 147 PACKAB
      * I :  API Mode U
     I                                      148 157 PACJAB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Item Transaction Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Item Code
     I                                    P   3   60P1HGCD
      * I :  Warehouse Code
     I                                        7   9 P1AJCD
      * I :  Inventory Trans ID
     I                                       10  10 P1W9ST
      * I :  Inventory Trans Type
     I                                       11  12 P1BSST
      * I :  Transaction Date Code
     I                                    P  13  160P1B4DT
      * I :  Production Date
     I                                    P  17  200P1ELDT
      * I :  Item Transaction Source
     I                                       21  22 P1F1ST
      * I :  Description
     I                                       23  52 P1AUNA
      * N :  Transaction Quantity
     I                                    P  53  582P1A5QT
      * N :  Transaction Weight
     I                                    P  59  642P1AHWG
      * I :  Reason Code
     I                                       65  67 P1CQCD
      * N :  Transfer Batch Number
     I                                    P  68  710P1TRBN
      * N :  Transfer Batch Sequence
     I                                    P  72  730P1TRBS
      * I :  Order Number
     I                                    P  74  770P1C4NB
      * I :  Shift Number
     I                                       78  78 P1XLCD
      * I :  Label Date
     I                                    P  79  820P1K7DT
     IP2PARM      DS
      * FLD: Company Item
      * N :  UOM Primary
     I                                        1   2 P2ADCD
      * N :  Conversion Factor 1
     I                                    P   3   74P2AWPC
      * N :  Operation Factor 1
     I                                        8   8 P2LXST
      * N :  UOM Second
     I                                        9  10 P2AECD
      * N :  Conversion Factor 2
     I                                    P  11  154P2AXPC
      * N :  Operation Factor 2
     I                                       16  16 P2LYST
      * N :  UOM Third
     I                                       17  18 P2AFCD
      * N :  UOM Pricing
     I                                       19  20 P2AICD
      * N :  Unit Weight
     I                                    P  21  262P2AIWG
      * N :  Production Date Control
     I                                       27  27 P2FZST
      * N :  Catch Weight Status
     I                                       28  28 P2AVST
     IP3PARM      DS
      * I :  USR Warehouse Code
     I                                        1   3 P3CPCD
     IP4PARM      DS
      * I :  USR Weight Accumulated
     I                                    P   1   62P4CDWG
     IP5PARM      DS
      * I :  USR Quantity
     I                                    P   1   62P5BAQT
     IP6PARM      DS
      * FLD: Item Balance
      * N :  Unit Cost Per Pound
     I                                    P   1   64P6AGCS
     IP7PARM      DS
      * N :  Unit Cost - Detail
     I                                    P   1   64P7ARCS
     IP8PARM      DS
      * FLD: *Arrays
      * I :  USR Unship Flag
     I                                        1   1 P8USST
      * I :  Inter-Plant Transfer USR
     I                                        2   2 P8A5TX
      * I :  Called From Program
     I                                        3  12 P8COAB
      * O :  Send Email f/Failed API U
     I                                       13  13 P8OVSC
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1HGCD    PARM           WP0002  70       Item Code
     C           P1AJCD    PARM           WP0003  3        Warehouse Code
     C           P1W9ST    PARM           WP0004  1        Inventory Trans
     C           P1BSST    PARM           WP0005  2        Inventory Trans
     C           P1B4DT    PARM           WP0006  70       Transaction Dat
     C           P1ELDT    PARM           WP0007  70       Production Date
     C           P1F1ST    PARM           WP0008  2        Item Transactio
     C           P1AUNA    PARM           WP0009 30        Description
     C           P1CQCD    PARM           WP0010  3        Reason Code
     C           P1C4NB    PARM           WP0011  70       Order Number
     C           P1XLCD    PARM           WP0012  1        Shift Number
     C           P1K7DT    PARM           WP0013  70       Label Date
     C           P3CPCD    PARM           WP0014  3        USR Warehouse C
     C           P4CDWG    PARM           WP0015 112       USR Weight Accu
     C           P5BAQT    PARM           WP0016 112       USR Quantity
     C           P8USST    PARM           WP0017  1        USR Unship Flag
     C           P8A5TX    PARM           WP0018  1        Inter-Plant Tra
     C           P8COAB    PARM           WP0019 10        Called From Pro
     C                     PARM P8OVSC    WP0020  1        Send Email f/Fa
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Upd Balances Tran-ToWh XF
     C                     Z-ADDP5BAQT    P1A5QT           Transaction Qua
     C                     Z-ADDP4CDWG    P1AHWG           Transaction Wei
     C                     Z-ADD1         P1TRBS           Transfer Batch
      * Rtv Base Values        RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1HGCD    WL0002           Item Code
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    WUAWNA    P      Description Lin
     C                     MOVELWL0005    P2ADCD    P      UOM Primary
     C                     Z-ADDWL0006    P2AWPC           Conversion Fact
     C                     MOVELWL0007    P2LXST    P      Operation Facto
     C                     MOVELWL0008    P2AECD    P      UOM Second
     C                     Z-ADDWL0009    P2AXPC           Conversion Fact
     C                     MOVELWL0010    P2LYST    P      Operation Facto
     C                     MOVELWL0011    P2AFCD    P      UOM Third
     C                     MOVELWL0012    P2AICD    P      UOM Pricing
     C                     Z-ADDWL0013    P2AIWG           Unit Weight
     C                     MOVELWL0014    P2FZST    P      Production Date
     C                     MOVELWL0015    P2AVST    P      Catch Weight St
     C                     Z-ADDWL0016    WUCHTM           Fresh Chilling
      * RTV Unit Cost          RT - Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0017           Company Number
     C                     Z-ADDP1HGCD    WL0018           Item Code
     C                     MOVELP1AJCD    WL0019    P      Warehouse Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    P6AGCS           Unit Cost Per P
      * get TO Whse unit cost
      * ** Get load id, put into lot#                  FP1127
      * ** Lot Number will go into the From Warehouse record
      * ** Lot Number Usr will go into the To Warehouse record
      * RTV Load ID            RT - Order Header TRG  * 
     C                     EXSR SCRVGN
     C                     Z-ADDWURMNB    WULTNT           Lot Number USR
     C                     Z-ADD*ZERO     WULXNM           Lot Number
      * WI517 DN 10/04/23-Initialize Flags.
     C                     MOVEL'N'       P8OVSC           Send Email f/Fa
     C                     MOVEL'N'       YL0001           API was Called?
     C                     MOVEL'N'       YL0002           Inventory Updat
      * 10/02/23 DN WI517-Added Parms 'Inventory Updated USR',
      *   'Called From Program' & 'API was Called? U'.
      *
     C                     Z-ADD*ZERO     WN0001  30       Item Structure
     C                     Z-ADD*ZERO     WN0002  30       Item Structure
     C                     Z-ADD*ZERO     WN0003  30       Item Structure
     C                     Z-ADD*ZERO     WN0004  50       ITD Sequence Nu
     C                     Z-ADD*ZERO     WN0005  30       Sequence Number
     C                     Z-ADD*ZERO     WN0006 114       USR Transaction
     C                     Z-ADD*ZERO     WN0007 112       Extended Amount
     C                     Z-ADD*ZERO     WN0008 112       Quantity based
     C                     Z-ADD*ZERO     WN0009 112       Quantity based
     C                     Z-ADD*ZERO     WN0010 112       Quantity based
     C                     Z-ADD*ZERO     WN0011 112       On Hand Weight
     C                     Z-ADD*ZERO     WN0012 112       On Hand UOM1 Su
     C                     Z-ADD*ZERO     WN0013 112       Value of On Han
     C                     Z-ADD*ZERO     WN0014  70       Production Date
     C                     Z-ADD*ZERO     WN0015  70       Label Date  USR
     C                     MOVEL*BLANK    WN0016  3        USR Reason Code
      *
      * UPD Balances Transfer  IF
      * NOTES: WI517 DN 10/09/23-Per Business (Ace C./Ryan H.), we will N
      *        pass in the 'negative' Qty/Wgt when processing the WIM API
      *        WIM API logic will handle this scenario.
      * WI517 DN 07/05/23-Get WIM Module Release Status.
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
     C                     EXSR SDRVGN
     C                     MOVEL'N'       YL0002           Inventory Updat
     C                     MOVEL'N'       YL0001           API was Called?
      * WI517 DN 10/09/23-Save Original Transaction Qty/Wgt in LCL contex
      * CASE: *OTHERWISE
     C                     Z-ADDP1A5QT    YL0004           Transaction Qua
     C                     Z-ADDP1AHWG    YL0005           Transaction Wei
      * 08/10/23 DN WI517-Call Existing Legacy Process.
      * CASE: *OTHERWISE
     C                     MOVELP1CQCD    WN0016           USR Reason Code
      * Error if FROM unit cost = 0
      * CASE: PAR.Unit Cost Pricing U/M EQ WRK.ZERO
     C           P6AGCS    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     WN0016           USR Reason Code
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0017 112       Quantity based
     C                     Z-ADD*ZERO     WN0018 112       Quantity based
     C                     Z-ADD*ZERO     WN0019 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0008           USR Qty based o
     C                     Z-ADD*ZERO     WN0009           USR Qty based o
     C                     Z-ADD*ZERO     WN0010           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           P2ADCD    IFEQ P2ADCD                     *IF
     C                     Z-ADDP1A5QT    WN0008           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           P2AECD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
     C           P1A5QT    MULT P2AWPC    WN0018    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           P1A5QT    DIV  P2AWPC    WN0018    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0018    WN0009           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
     C           WN0018    MULT P2AXPC    WN0019    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           WN0018    DIV  P2AXPC    WN0019    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0019    WN0010           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           P2AECD    IFEQ P2ADCD                     *IF
     C                     Z-ADDP1A5QT    WN0009           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           P1A5QT    DIV  P2AWPC    WN0008    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
     C           P1A5QT    MULT P2AWPC    WN0008    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
     C           P1A5QT    MULT P2AXPC    WN0019    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           P1A5QT    DIV  P2AXPC    WN0019    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0019    WN0010           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           P2AFCD    IFEQ P2ADCD                     *IF
     C                     Z-ADDP1A5QT    WN0010           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           P1A5QT    DIV  P2AXPC    WN0018    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
     C           P1A5QT    MULT P2AXPC    WN0018    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0018    WN0009           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           WN0018    DIV  P2AWPC    WN0008    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
     C           WN0018    MULT P2AWPC    WN0008    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P6AGCS    MULT P1AHWG    WN0007    H      Extended Amount
      * Adjust sign of transaction based on transaction type
      * CASE: PAR.Inventory Trans. Type is Transfer Warehouse
     C           P1BSST    IFEQ 'TW'                       *IF
     C                     ADD  1         P1TRBS           Transfer Batch
     C                     Z-ADDP1AHWG    WUAHWG           Transaction Wei
     C                     Z-ADDP1A5QT    WUA5QT           Transaction Qua
      * CASE: PAR.USR Unship Flag is yes
     C           P8USST    IFEQ 'Y'                        *IF
      * if this is an Unship, reverse the TO whse qty/wgt (neg rct)
     C           *ZERO     SUB  WUA5QT    WUA5QT           Transaction Qua
     C           *ZERO     SUB  WUAHWG    WUAHWG           Transaction Wei
     C                     ELSE
      * CASE: *OTHERWISE
      * if this is NOT an Unship, reverse the FROM whse qty, wgt (reverse
     C           *ZERO     SUB  P1A5QT    P1A5QT           Transaction Qua
     C           *ZERO     SUB  WN0008    WN0008           Quantity based
     C           *ZERO     SUB  P1AHWG    P1AHWG           Transaction Wei
     C           *ZERO     SUB  WN0007    WN0007           Extended Amount
     C                     END                             *FI
     C                     END                             *FI
      * 08/10/23 DN WI517-Call Legacy Process if Not Live or Parallel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Not Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0003    IFEQ 'N'                        *IF
     C           YL0003    OREQ 'P'                        *OR
      * 09/26/23 DN WI517-Set 'Inventory Updated USR' Flag.
     C                     MOVEL'Y'       YL0002           Inventory Updat
      * *****************************************************************
      * The following block of code will update Item Balance,
      * Item Balance Detail and Transaction Detail for the FROM ITEM
      * *****************************************************************
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0021           Company Number
     C                     Z-ADDP1HGCD    WL0022           Item Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    WN0001           Item Structure
     C                     Z-ADDWL0024    WN0002           Item Structure
     C                     Z-ADDWL0025    WN0003           Item Structure
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0026           Company Number
     C                     Z-ADDP1HGCD    WL0027           Item Code
     C                     MOVELP1AJCD    WL0028    P      Warehouse Code
     C                     MOVELP1W9ST    WL0029    P      Inventory Trans
     C                     MOVELP1BSST    WL0030    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0031           Transaction Dat
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0032    WN0004           ITD Sequence Nu
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0033           Company Number
     C                     Z-ADDP1HGCD    WL0034           Item Code
     C                     MOVELP1AJCD    WL0035    P      Warehouse Code
     C                     MOVELP1W9ST    WL0036    P      Inventory Trans
     C                     MOVELP1BSST    WL0037    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0038           Transaction Dat
     C                     Z-ADDWN0004    WL0039           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0040           Sequence Number
     C                     Z-ADDP1ELDT    WL0041           Production Date
     C                     MOVELP2ADCD    WL0042    P      UOM Transaction
     C                     MOVELP1F1ST    WL0043    P      Item Transactio
     C                     MOVELP1AUNA    WL0044    P      Description
     C                     Z-ADDP1A5QT    WL0045           Transaction Qua
     C                     Z-ADDP1AHWG    WL0046           Transaction Wei
     C                     Z-ADD*ZERO     WL0047           USR Transaction
     C                     MOVEL'LB'      WL0048    P      UOM Cost
     C                     Z-ADDWN0007    WL0049           Extended Amount
     C                     MOVEL*BLANK    WL0050           Ticket Number
     C                     Z-ADD*ZERO     WL0051           GL Document Num
     C                     MOVEL'N'       WL0052    P      GL Update Statu
     C                     MOVELWN0016    WL0053    P      Reason Code
     C                     MOVEL*BLANK    WL0054           Reference Numbe
     C                     MOVEL*BLANK    WL0055           Lot ID
     C                     Z-ADDP1TRBN    WL0056           Transfer Batch
     C                     Z-ADDP1TRBS    WL0057           Transfer Batch
     C                     Z-ADDP1C4NB    WL0058           Order Number
     C                     Z-ADDWN0001    WL0059           Item Structure
     C                     Z-ADDWN0002    WL0060           Item Structure
     C                     Z-ADDWN0003    WL0061           Item Structure
     C                     MOVEL*BLANK    WL0062           Employee Badge
     C                     Z-ADD*ZERO     WL0063           Production Time
     C                     MOVELP1XLCD    WL0064    P      Shift Number
     C                     Z-ADDP1K7DT    WL0065           Label Date
     C                     MOVEL*BLANK    WL0066           EDI Status 1
     C                     MOVEL*BLANK    WL0067           EDI Status 2
     C                     MOVEL*BLANK    WL0068           EDI Status 3
     C                     MOVEL'A'       WL0069    P      Record Status
     C                     EXSR SGCRRC
      * CHG Value/Qty/Wgt      CH - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0070           Company Number
     C                     Z-ADDP1HGCD    WL0071           Item Code
     C                     MOVELP1AJCD    WL0072    P      Warehouse Code
     C                     Z-ADDP1ELDT    WL0073           Production Date
     C                     Z-ADDWN0001    WL0074           Item Structure
     C                     Z-ADDWN0002    WL0075           Item Structure
     C                     Z-ADDWN0003    WL0076           Item Structure
     C                     MOVELP2ADCD    WL0077    P      UOM Primary
     C                     Z-ADDP2AWPC    WL0078           Conversion Fact
     C                     MOVELP2LXST    WL0079    P      Operation Facto
     C                     MOVELP2AECD    WL0080    P      UOM Second
     C                     Z-ADDP2AXPC    WL0081           Conversion Fact
     C                     MOVELP2LYST    WL0082    P      Operation Facto
     C                     MOVELP2AFCD    WL0083    P      UOM Third
     C                     MOVELP2FZST    WL0084    P      Production Date
     C                     MOVELP2AVST    WL0085    P      Catch Weight St
     C                     MOVELP1W9ST    WL0086    P      Inventory Trans
     C                     MOVELP1BSST    WL0087    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0088           Transaction Dat
     C                     MOVELP2ADCD    WL0089    P      UOM Transaction
     C                     Z-ADDWN0008    WL0090           Transaction Qua
     C                     Z-ADDP1AHWG    WL0091           Transaction Wei
     C                     Z-ADD*ZERO     WL0092           USR Transaction
     C                     MOVEL'LB'      WL0093    P      UOM Cost
     C                     Z-ADDWN0007    WL0094           Extended Amount
     C                     Z-ADDP1K7DT    WL0095           Label Date  USR
     C                     EXSR SHCHRC
      * 11/25/09 PKD Comment out until we know what we need to do here.
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0134           Company Number
     C                     Z-ADDP1HGCD    WL0135           Item Code
     C                     MOVELP1AJCD    WL0136    P      Warehouse Code
     C                     Z-ADDWN0011    WL0137           Quantity on Han
     C                     Z-ADDWN0012    WL0138           Quantity on Han
     C                     Z-ADDWUNFNN    WL0139           Quantity on Han
     C                     Z-ADDWUNFNN    WL0140           Quantity on Han
     C                     Z-ADDWN0013    WL0141           Value of On Han
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0137    WN0011           Quantity on Han
     C                     Z-ADDWL0138    WN0012           Quantity on Han
     C                     Z-ADDWL0139    WUNFNN           Quantity on Han
     C                     Z-ADDWL0140    WUNFNN           Quantity on Han
     C                     Z-ADDWL0141    WN0013           Value of On Han
      * Chg Val/Qty/Wgt        Ch - IC Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0142           Company Number
     C                     Z-ADDP1HGCD    WL0143           Item Code
     C                     MOVELP1AJCD    WL0144    P      Warehouse Code
     C                     Z-ADDWN0011    WL0145           On Hand Weight
     C                     Z-ADDWN0012    WL0146           On Hand UOM1 Su
     C                     Z-ADDWN0013    WL0147           Value of On Han
     C                     EXSR SMCHRC
      * ** FP1127:
      * ** Update location quantity on hand for External warehouse that
      * ** is lot controlled and not Carlisle controlled
      * ** Optional Lot number is passed in from the calling program
      * RTV Warehouse Info     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1AJCD    WL0148    P      Warehouse Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0149    YN0001    P      Warehouse Descr
     C                     MOVELWL0150    YN0002    P      Address Line 1
     C                     MOVELWL0151    YN0003    P      Address Line 2
     C                     MOVELWL0152    YN0004    P      Address Line 3
     C                     MOVELWL0153    YN0005    P      City
     C                     MOVELWL0154    YN0006    P      Zip Postal Code
     C                     MOVELWL0155    YN0007    P      Production Ware
     C                     MOVELWL0156    YN0008    P      State Code
     C                     MOVELWL0157    YL0006    P      Lot Tracking Fl
     C                     MOVELWL0158    YN0009    P      Default Printer
     C                     MOVELWL0159    YN0010    P      Warehouse Type
     C                     MOVELWL0160    YN0011    P      Trans Contol AS
     C                     MOVELWL0161    YL0007    P      Warehouse Locat
     C                     MOVELWL0162    YN0012    P      Warehouse Std C
     C                     Z-ADDWL0163    YN0013           Warehouse Chill
     C                     MOVELWL0164    YN0014    P      Include in Auto
     C                     MOVELWL0165    YN0015    P      Default Manifes
     C                     MOVELWL0166    YN0016    P      Default Load Se
     C                     MOVELWL0167    YN0017    P      WHS Slotting Li
     C                     Z-ADDWL0168    YN0018           Shipping Compan
     C                     Z-ADDWL0169    YN0019           Accounting Comp
     C                     Z-ADDWL0170    YN0020           WHS Sched Prod
     C                     Z-ADDWL0171    YN0021           WHS Inventory C
     C                     MOVELWL0172    YN0022    P      Parent Warehous
     C                     MOVELWL0173    YN0023    P      Default Shippin
     C                     MOVELWL0174    YL0008    P      WHS Live with C
     C                     MOVELWL0175    YN0024    P      WHS PFS Interfa
     C                     MOVELWL0176    YN0025    P      WHS Req Meter R
     C                     MOVELWL0177    YN0026    P      WHS Default Loa
     C                     MOVELWL0178    YN0027    P      WHS TMS Plannin
     C                     MOVELWL0179    YN0028    P      Default Carrier
     C                     MOVELWL0180    YN0029    P      Inventory Logic
     C                     MOVELWL0181    YN0030    P      WHS Auto Inv Re
     C                     MOVELWL0182    YN0031    P      EDI Status 1
     C                     MOVELWL0183    YN0032    P      EDI Status 2
     C                     MOVELWL0184    YN0033    P      EDI Status 3
     C                     MOVELWL0185    YN0034    P      Record Status
     C                     Z-ADDWL0186    YN0035           Job Time
     C                     MOVELWL0187    YN0036    P      User Id
     C                     MOVELWL0188    YN0037    P      Job Name
     C                     Z-ADDWL0189    YN0038           Job Date
      * ** Process lot tracking if External, not Carlisle, Lot trk=Y
      * CASE: Process lots if External, not Carlisle, Lot trk=Y
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : LCL.WHS Live w/Carlisle is *No/Blank
      *   |- c3    : LCL.Lot Tracking Flag is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0007    IFEQ 'E'                        *IF
     C           YL0008    IFEQ *BLANK                     *IF
     C           YL0008    OREQ 'N'
     C           YL0006    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Whse Location Info RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1AJCD    WL0190    P      Warehouse Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0191    WUYMCD    P      Location Code
     C                     MOVELWL0192    YL0009    P      Location Aisle
     C                     Z-ADDWL0193    YL0010           Location Bay
     C                     Z-ADDWL0194    YL0011           Loc Unused Chil
      * ** Lot # will be the "from warehouse" lot# or zeros    FP1127
      * UPD Auto-Loc TR Ord ItmXF - Item Lot Location  * 
     C                     CALL 'PMBVXFR'              90  UPD Auto-Loc TR
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0056  30       Company Number
     C                     PARM P1HGCD    WQ0057  70       Item Code
     C                     PARM P1AJCD    WQ0058  3        Warehouse Code
     C                     PARM P1ELDT    WQ0059  70       Production Date
     C                     PARM WULXNM    WQ0060  50       Lot Number
     C                     PARM WUYMCD    WQ0061  4        Location Code
     C                     PARM WUYNCD    WQ0062  20       Location Level
     C                     PARM P1A5QT    WQ0063  70       Quantity Loc Tr
     C                     PARM P1C4NB    WQ0064  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMBVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * *****************************************************************
      * The following block of code will update Item Balance,
      * Item Balance Detail and Transaction Detail for the TO ITEM
      * *****************************************************************
      * ** 12/05/2008 LJB FP1127 Update Auto-Locate Whse inventory
      * ** Only process auto-locate if not a Carlisle Controlled warehous
      * ** and lot tracking has been turned on.
      * 12/04/06 PKD PK0040 Only add inventory to the To Warehouse
      *              if the Inter-Plant Transfer is No.  If the Inter-Pla
      *              Transfer is Yes, then the receiving plant's receivin
      *              process will add the inventory to the To Warehouse.
      * RTV Shipping Co        RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP3CPCD    WL0195    P      Warehouse Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0196    YL0012           Shipping Compan
      * CASE: PAR.Inter-Plant Transfer USR is No
     C           P8A5TX    IFEQ 'N'                        *IF
      * Validate that Item Balance for TO Whse exists; if not, create it
      * Val Item Balance       RT - Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0012    WL0197           Company Number
     C                     Z-ADDP1HGCD    WL0198           Item Code
     C                     MOVELP3CPCD    WL0199    P      Warehouse Code
     C                     EXSR SQRVGN
      * Create item balance if none exists
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Item Balance       CR - Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0012    WL0200           Company Number
     C                     Z-ADDP1HGCD    WL0201           Item Code
     C                     MOVELP3CPCD    WL0202    P      Warehouse Code
     C                     Z-ADDP7ARCS    WL0203           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0204           Last Cost
     C                     Z-ADD*ZERO     WL0205           Cost per Primar
     C                     Z-ADD*ZERO     WL0206           Cost per Pricin
     C                     Z-ADD*ZERO     WL0207           Revaluation Cos
     C                     Z-ADD*ZERO     WL0208           Revaluation Eff
     C                     MOVELWUGSTX    WL0209    P      Revaluation Cos
     C                     Z-ADD*ZERO     WL0210           Last Revaluatio
     C                     Z-ADD*ZERO     WL0211           Last Revaluatio
     C                     Z-ADD*ZERO     WL0212           On Hand Weight
     C                     Z-ADD*ZERO     WL0213           On Hand UOM1 Su
     C                     Z-ADD*ZERO     WL0214           On Hand UOM2 Su
     C                     Z-ADD*ZERO     WL0215           On Hand UOM3 Su
     C                     Z-ADD*ZERO     WL0216           Quantity In Chi
     C                     Z-ADD*ZERO     WL0217           Weight In Chill
     C                     Z-ADD*ZERO     WL0218           Quantity Schedu
     C                     Z-ADD*ZERO     WL0219           Quantity on Sal
     C                     Z-ADD*ZERO     WL0220           Quantity on Pur
     C                     Z-ADD*ZERO     WL0221           Quantity on Tra
     C                     Z-ADD*ZERO     WL0222           Quantity Avail
     C                     MOVEL*BLANK    WL0223           Cycle Count Cod
     C                     Z-ADD*ZERO     WL0224           Date of Last Or
     C                     Z-ADD*ZERO     WL0225           Date of Last Sh
     C                     Z-ADD*ZERO     WL0226           Value of On Han
     C                     MOVELWUGSTX    WL0227    P      Inventory Plann
     C                     Z-ADD*ZERO     WL0228           Safety Allowanc
     C                     Z-ADD*ZERO     WL0229           Safety Allowanc
     C                     Z-ADD*ZERO     WL0230           Stock Out Date
     C                     MOVEL*BLANK    WL0231           Buyer Code
     C                     Z-ADD*ZERO     WL0232           Lead Time Last
     C                     Z-ADD*ZERO     WL0233           Lead Time Date
     C                     Z-ADD*ZERO     WL0234           Lead Time Next
     C                     Z-ADD*ZERO     WL0235           Lead Time Date
     C                     MOVEL'N'       WL0236    P      Lead Time Excep
     C                     Z-ADD*ZERO     WL0237           Usage Qty per C
     C                     Z-ADD*ZERO     WL0238           Usage Weight pe
     C                     Z-ADD*ZERO     WL0239           Inventory Manag
     C                     Z-ADD*ZERO     WL0240           Minimum Quantit
     C                     Z-ADD*ZERO     WL0241           Maximum Quantit
     C                     Z-ADD*ZERO     WL0242           Last Physical C
     C                     MOVELWUGSTX    WL0243    P      Requisition Mod
     C                     MOVELWUGSTX    WL0244    P      Cost Update Pen
     C                     MOVELWUGSTX    WL0245    P      Post GL Status
     C                     Z-ADD*ZERO     WL0246           Vendor Item_Whs
     C                     Z-ADDWN0001    WL0247           Item Structure
     C                     Z-ADDWN0002    WL0248           Item Structure
     C                     Z-ADDWN0003    WL0249           Item Structure
     C                     MOVELWUUVST    WL0250    P      EDI Status 1
     C                     MOVELWUUWST    WL0251    P      EDI Status 2
     C                     MOVELWUUXST    WL0252    P      EDI Status 3
     C                     MOVEL'A'       WL0253    P      Record Status
     C                     EXSR SRCRRC
     C                     END                             *FI
      * Error if unit cost = 0
      * CASE: PAR.Unit Cost - Detail EQ WRK.ZERO
     C           P7ARCS    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     WN0016           USR Reason Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP1CQCD    WN0016           USR Reason Code
     C                     END                             *FI
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0012    WL0021           Company Number
     C                     Z-ADDP1HGCD    WL0022           Item Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    WN0001           Item Structure
     C                     Z-ADDWL0024    WN0002           Item Structure
     C                     Z-ADDWL0025    WN0003           Item Structure
     C           P7ARCS    MULT WUAHWG    WN0007    H      Extended Amount
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0012    WL0026           Company Number
     C                     Z-ADDP1HGCD    WL0027           Item Code
     C                     MOVELP3CPCD    WL0028    P      Warehouse Code
     C                     MOVELP1W9ST    WL0029    P      Inventory Trans
     C                     MOVELP1BSST    WL0030    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0031           Transaction Dat
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0032    WN0004           ITD Sequence Nu
      * Reset Production/Label Date if Lot Tracking warehouse.
     C                     EXSR UASUBR                     Reset Productio
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0012    WL0033           Company Number
     C                     Z-ADDP1HGCD    WL0034           Item Code
     C                     MOVELP3CPCD    WL0035    P      Warehouse Code
     C                     MOVELP1W9ST    WL0036    P      Inventory Trans
     C                     MOVELP1BSST    WL0037    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0038           Transaction Dat
     C                     Z-ADDWN0004    WL0039           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0040           Sequence Number
     C                     Z-ADDWN0014    WL0041           Production Date
     C                     MOVELP2ADCD    WL0042    P      UOM Transaction
     C                     MOVELP1F1ST    WL0043    P      Item Transactio
     C                     MOVELP1AUNA    WL0044    P      Description
     C                     Z-ADDWUA5QT    WL0045           Transaction Qua
     C                     Z-ADDWUAHWG    WL0046           Transaction Wei
     C                     Z-ADD*ZERO     WL0047           USR Transaction
     C                     MOVEL'LB'      WL0048    P      UOM Cost
     C                     Z-ADDWN0007    WL0049           Extended Amount
     C                     MOVEL*BLANK    WL0050           Ticket Number
     C                     Z-ADD*ZERO     WL0051           GL Document Num
     C                     MOVEL*BLANK    WL0052           GL Update Statu
     C                     MOVELWN0016    WL0053    P      Reason Code
     C                     MOVEL*BLANK    WL0054           Reference Numbe
     C                     MOVEL*BLANK    WL0055           Lot ID
     C                     Z-ADDP1TRBN    WL0056           Transfer Batch
     C                     Z-ADDP1TRBS    WL0057           Transfer Batch
     C                     Z-ADDP1C4NB    WL0058           Order Number
     C                     Z-ADDWN0001    WL0059           Item Structure
     C                     Z-ADDWN0002    WL0060           Item Structure
     C                     Z-ADDWN0003    WL0061           Item Structure
     C                     MOVEL*BLANK    WL0062           Employee Badge
     C                     Z-ADD*ZERO     WL0063           Production Time
     C                     MOVELP1XLCD    WL0064    P      Shift Number
     C                     Z-ADDWN0015    WL0065           Label Date
     C                     MOVEL*BLANK    WL0066           EDI Status 1
     C                     MOVEL*BLANK    WL0067           EDI Status 2
     C                     MOVEL*BLANK    WL0068           EDI Status 3
     C                     MOVEL'A'       WL0069    P      Record Status
     C                     EXSR SGCRRC
      * 11/25/09 PKD Comment out until we know what we need to do here.
      * * Post transaction to Item Balance & Item Balance Detail
      * Prc Create Dtl Receipt IF
      * Prc Create Dtl Receipt RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0012    WL0254           Company Number
     C                     Z-ADDP1HGCD    WL0255           Item Code
     C                     MOVELP3CPCD    WL0256    P      Warehouse Code
     C                     MOVELP1W9ST    WL0257    P      Inventory Trans
     C                     MOVELP1BSST    WL0258    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0259           Transaction Dat
     C                     Z-ADDWN0004    WL0260           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0261           Sequence Number
     C                     MOVELP1XLCD    WL0262    P      Shift Number
     C                     Z-ADDWN0015    WL0263           Label Date
     C                     EXSR SSRVGN
      * ** Process Auto-Locate Whse inventory             FP1127
      * RTV Warehouse Info     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP3CPCD    WL0148    P      Warehouse Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0149    YN0001    P      Warehouse Descr
     C                     MOVELWL0150    YN0002    P      Address Line 1
     C                     MOVELWL0151    YN0003    P      Address Line 2
     C                     MOVELWL0152    YN0004    P      Address Line 3
     C                     MOVELWL0153    YN0005    P      City
     C                     MOVELWL0154    YN0006    P      Zip Postal Code
     C                     MOVELWL0155    YN0007    P      Production Ware
     C                     MOVELWL0156    YN0008    P      State Code
     C                     MOVELWL0157    YL0006    P      Lot Tracking Fl
     C                     MOVELWL0158    YN0009    P      Default Printer
     C                     MOVELWL0159    YN0010    P      Warehouse Type
     C                     MOVELWL0160    YN0011    P      Trans Contol AS
     C                     MOVELWL0161    YL0007    P      Warehouse Locat
     C                     MOVELWL0162    YN0012    P      Warehouse Std C
     C                     Z-ADDWL0163    YN0013           Warehouse Chill
     C                     MOVELWL0164    YN0014    P      Include in Auto
     C                     MOVELWL0165    YN0015    P      Default Manifes
     C                     MOVELWL0166    YN0016    P      Default Load Se
     C                     MOVELWL0167    YN0017    P      WHS Slotting Li
     C                     Z-ADDWL0168    YN0018           Shipping Compan
     C                     Z-ADDWL0169    YN0019           Accounting Comp
     C                     Z-ADDWL0170    YN0020           WHS Sched Prod
     C                     Z-ADDWL0171    YN0021           WHS Inventory C
     C                     MOVELWL0172    YN0022    P      Parent Warehous
     C                     MOVELWL0173    YN0023    P      Default Shippin
     C                     MOVELWL0174    YL0008    P      WHS Live with C
     C                     MOVELWL0175    YN0024    P      WHS PFS Interfa
     C                     MOVELWL0176    YN0025    P      WHS Req Meter R
     C                     MOVELWL0177    YN0026    P      WHS Default Loa
     C                     MOVELWL0178    YN0027    P      WHS TMS Plannin
     C                     MOVELWL0179    YN0028    P      Default Carrier
     C                     MOVELWL0180    YN0029    P      Inventory Logic
     C                     MOVELWL0181    YN0030    P      WHS Auto Inv Re
     C                     MOVELWL0182    YN0031    P      EDI Status 1
     C                     MOVELWL0183    YN0032    P      EDI Status 2
     C                     MOVELWL0184    YN0033    P      EDI Status 3
     C                     MOVELWL0185    YN0034    P      Record Status
     C                     Z-ADDWL0186    YN0035           Job Time
     C                     MOVELWL0187    YN0036    P      User Id
     C                     MOVELWL0188    YN0037    P      Job Name
     C                     Z-ADDWL0189    YN0038           Job Date
      * ** Process lot tracking if External, not Carlisle, Lot trk=Y
      * CASE: Process lots if External, not Carlisle, Lot trk=Y
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : LCL.WHS Live w/Carlisle is *No/Blank
      *   |- c3    : LCL.Lot Tracking Flag is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0007    IFEQ 'E'                        *IF
     C           YL0008    IFEQ *BLANK                     *IF
     C           YL0008    OREQ 'N'
     C           YL0006    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Lot Number is passed in and is optional
      * RTV Whse Location Info RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP3CPCD    WL0190    P      Warehouse Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0191    WUYMCD    P      Location Code
     C                     MOVELWL0192    YL0009    P      Location Aisle
     C                     Z-ADDWL0193    YL0010           Location Bay
     C                     Z-ADDWL0194    YL0011           Loc Unused Chil
      * ** Lot# will be the "to warehouse" lot# or zeros    FP1127
      * UPD Auto-Loc TR Ord ItmXF - Item Lot Location  * 
     C                     CALL 'PMBVXFR'              90  UPD Auto-Loc TR
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0079  30       Company Number
     C                     PARM P1HGCD    WQ0080  70       Item Code
     C                     PARM P3CPCD    WQ0081  3        Warehouse Code
     C                     PARM P1B4DT    WQ0082  70       Production Date
     C                     PARM WULTNT    WQ0083  50       Lot Number
     C                     PARM WUYMCD    WQ0084  4        Location Code
     C                     PARM WUYNCD    WQ0085  20       Location Level
     C                     PARM WUA5QT    WQ0086  70       Quantity Loc Tr
     C                     PARM P1C4NB    WQ0087  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMBVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
      * 08/10/23 DN WI517-Call WIM API if Live or Parallel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Is Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0003    IFEQ 'Y'                        *IF
     C           YL0003    OREQ 'P'                        *OR
     C                     MOVEL'Y'       YL0001           API was Called?
     C                     MOVEL*BLANK    YL0013           API EccResult-M
     C                     MOVEL*BLANK    YL0014           API EccResult-M
     C                     MOVEL*BLANK    YL0015           API Request Key
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,002   CAT  'ry':ZQ   YL0016    P      API Name
      * RTV Numeric Value      RT - System Values  * 
     C                     EXSR SXRVGN
      * Call API Wrapper Program for wim.ordershipping.inventory API.
      * 1/6/24 DN SR08283-Added 'API Request Key U' & 'API Mode U' Parms.
      * API WIM Inv Shipping   UP - WIM Item Trans Detail  * 
     C                     CLEARPARC
     C                     Z-ADDP1AIC3    PAAIC3           Company Number
     C                     Z-ADDP1HGCD    PAHGCD           Item Code
     C                     MOVELP1AJCD    PAVPCD    P      Ship From Wareh
     C                     MOVELP1W9ST    PANOSC    P      WIM Inventory T
     C                     MOVELP1BSST    PANPSC    P      WIM Inventory T
     C                     Z-ADDP1B4DT    PAA9DT           Transaction Dat
     C                     Z-ADDP1ELDT    PAELDT           Production Date
     C                     MOVELP1F1ST    PAF1ST    P      Item Transactio
     C                     MOVELP1AUNA    PAVQNA    P      Transaction Des
     C                     MOVEL*BLANK    PAA1AB    P      Transaction Rea
     C                     Z-ADDP1C4NB    PAC4NB           Order Number
     C                     MOVELP1XLCD    PAXLCD    P      Shift Number
     C                     MOVELP3CPCD    PAL9AA    P      Ship To Warehou
     C                     Z-ADDYL0005    PAAHWG           Transaction Wei
     C                     Z-ADDYL0004    PAA5QT           Transaction Qua
     C                     MOVELP8USST    PAUSST    P      USR Unship Flag
     C                     MOVELP8A5TX    PAA5TX    P      Inter-Plant Tra
     C                     MOVELYL0015    PACKAB    P      API Request Key
     C                     MOVEL'*SNDRCV' PACJAB    P      API Mode U
      *
     C                     CALL 'PVAYUPR'              90  API WIM Inv Shi
     C                     PARM YL0017    WQ0088  50       API Wait Time U
     C                     PARM           PARC             RCD: *Arrays
      *
     C                     MOVELPACLAB    YL0013           API EccResult-M
     C                     MOVELPAVGU1    YL0014           API EccResult-M
     C                     MOVELPACKAB    YL0015           API Request Key
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVAYUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * API Call Successful? If Not, Create Log & Send Email.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.API EccResult-MsgId U is Success
      *   |- c2    : LCL.API EccResult-MsgId U is Timeout
      *   '-
     C           YL0013    IFEQ @CN,004                    *IF
     C           YL0013    OREQ @CN,005                    *OR
     C                     MOVEL'Y'       YL0002           Inventory Updat
      * 01/06/24 DN SR08283-Create Log Record for Timeout Transaction.
      * CASE: LCL.API EccResult-MsgId U is Timeout
     C           YL0013    IFEQ @CN,005                    *IF
      * Crt WIM API Failure LogXF - WIM API Failure Log  * Timeout Failur
     C                     CALL 'PVA8XFR'              90  Crt WIM API Fai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0016    WQ0089 45        API Name
     C                     PARM YL0013    WQ0090  7        API EccResult M
     C                     PARM YL0014    WQ0091 50        API EccResult-M
     C                     PARM YL0015    WQ0092 10        API Request Key
     C                     PARM P8COAB    WQ0093 10        Called From Pro
     C                     PARM P1AIC3    WQ0094  30       Company Number
     C                     PARM P1HGCD    WQ0095  70       Item Code
     C                     PARM P1AJCD    WQ0096  3        Ship From Wareh
     C                     PARM P1W9ST    WQ0097  3        WIM Inventory T
     C                     PARM P1BSST    WQ0098  3        WIM Inventory T
     C                     PARM P1B4DT    WQ0099  70       Transaction Dat
     C                     PARM P1ELDT    WQ0100  70       Production Date
     C                     PARM P1F1ST    WQ0101  2        Item Transactio
     C                     PARM P1AUNA    WQ0102 30        Transaction Des
     C                     PARM *BLANK    WQ0103  3        Transaction Rea
     C                     PARM P1C4NB    WQ0104  70       Order Number
     C                     PARM P1XLCD    WQ0105  1        Shift Number
     C                     PARM P3CPCD    WQ0106  3        Ship To Warehou
     C                     PARM YL0005    WQ0107 112       Transaction Wei
     C                     PARM YL0004    WQ0108 112       Transaction Qua
     C                     PARM P8USST    WQ0109  1        Unship Flag
     C                     PARM P8A5TX    WQ0110  1        Inter Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * SR07943 DN 12/21/23-Added 'API EccResult-MsgId U is Entered' Cond
      * CASE: LCL.API EccResult-MsgId U is Entered
     C           YL0013    IFNE *BLANK                     *IF
     C                     MOVEL'N'       YL0002           Inventory Updat
      * 1/6/24 DN SR08283-Added 'API Request Key' as Input Parm.
      * Crt WIM API Failure LogXF - WIM API Failure Log  * Hardstop Failu
     C                     CALL 'PVA8XFR'              90  Crt WIM API Fai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0016    WQ0111 45        API Name
     C                     PARM YL0013    WQ0112  7        API EccResult M
     C                     PARM YL0014    WQ0113 50        API EccResult-M
     C                     PARM YL0015    WQ0114 10        API Request Key
     C                     PARM P8COAB    WQ0115 10        Called From Pro
     C                     PARM P1AIC3    WQ0116  30       Company Number
     C                     PARM P1HGCD    WQ0117  70       Item Code
     C                     PARM P1AJCD    WQ0118  3        Ship From Wareh
     C                     PARM P1W9ST    WQ0119  3        WIM Inventory T
     C                     PARM P1BSST    WQ0120  3        WIM Inventory T
     C                     PARM P1B4DT    WQ0121  70       Transaction Dat
     C                     PARM P1ELDT    WQ0122  70       Production Date
     C                     PARM P1F1ST    WQ0123  2        Item Transactio
     C                     PARM P1AUNA    WQ0124 30        Transaction Des
     C                     PARM *BLANK    WQ0125  3        Transaction Rea
     C                     PARM P1C4NB    WQ0126  70       Order Number
     C                     PARM P1XLCD    WQ0127  1        Shift Number
     C                     PARM P3CPCD    WQ0128  3        Ship To Warehou
     C                     PARM YL0005    WQ0129 112       Transaction Wei
     C                     PARM YL0004    WQ0130 112       Transaction Qua
     C                     PARM P8USST    WQ0131  1        Unship Flag
     C                     PARM P8A5TX    WQ0132  1        Inter Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Keep Track of Batch Processing Functions so Email will NOT be Sen
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6
      *   |- c1    : PAR.Called From Program is Exc Upd EDI 944 Trsn   XF
      *   |- c2    : PAR.Called From Program is EDT Confirm Ship Detl  DF
      *   |- c3    : PAR.Called From Program is ADD Ready to Confirm  XL
      *   |- c4    : PAR.Called From Program is Exc Upd EDI 945 Trsn   XF
      *   |- c5    : PAR.Called From Program is PFS Reopen Order      XL
      *   |- c6    : PAR.Called From Program is WW Unship Orders       DF
      *   '-
     C           P8COAB    IFEQ @CN,006                    *IF
     C           P8COAB    OREQ @CN,007                    *OR
     C           P8COAB    OREQ @CN,008                    *OR
     C           P8COAB    OREQ @CN,009                    *OR
     C           P8COAB    OREQ @CN,010                    *OR
     C           P8COAB    OREQ @CN,011                    *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Send Email to Business & IT.
      * Prc Eml Shipping & IT  XF - WIM API Failure Log  * 
     C                     CALL 'PVA9XFR'              90  Prc Eml Shippin
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P8COAB    WQ0133 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
      * WI517 DN 10/05/23-Set 'Send Email f/Failed API U' for Failed API
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.API was Called? U is Yes
      *   |- c2    : LCL.Inventory Updated USR is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ 'Y'                        *IF
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P8OVSC           Send Email f/Fa
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0001    WAAIC3           Company Number
     C                     Z-ADDWL0002    WAHGCD           Item Code
      * Establish starting position
     C           KRSSA     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Description Lin
     C                     MOVEL*BLANK    WL0004           Description Lin
     C                     MOVEL*BLANK    WL0005           UOM Primary
     C                     Z-ADD*ZERO     WL0006           Conversion Fact
     C                     MOVEL*BLANK    WL0007           Operation Facto
     C                     MOVEL*BLANK    WL0008           UOM Second
     C                     Z-ADD*ZERO     WL0009           Conversion Fact
     C                     MOVEL*BLANK    WL0010           Operation Facto
     C                     MOVEL*BLANK    WL0011           UOM Third
     C                     MOVEL*BLANK    WL0012           UOM Pricing
     C                     Z-ADD*ZERO     WL0013           Unit Weight
     C                     MOVEL*BLANK    WL0014           Production Date
     C                     MOVEL*BLANK    WL0015           Catch Weight St
     C                     Z-ADD*ZERO     WL0016           Fresh Chilling
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAVNA    WL0003           Description Lin
     C                     MOVELWAAWNA    WL0004           Description Lin
     C                     MOVELWAADCD    WL0005           UOM Primary
     C                     Z-ADDWAAWPC    WL0006           Conversion Fact
     C                     MOVELWALXST    WL0007           Operation Facto
     C                     MOVELWAAECD    WL0008           UOM Second
     C                     Z-ADDWAAXPC    WL0009           Conversion Fact
     C                     MOVELWALYST    WL0010           Operation Facto
     C                     MOVELWAAFCD    WL0011           UOM Third
     C                     MOVELWAAICD    WL0012           UOM Pricing
     C                     Z-ADDWAAIWG    WL0013           Unit Weight
     C                     MOVELWAFZST    WL0014           Production Date
     C                     MOVELWAAVST    WL0015           Catch Weight St
     C                     Z-ADDWACHTM    WL0016           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Unit Cost          RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0017    WBAIC3           Company Number
     C                     Z-ADDWL0018    WBHGCD           Item Code
     C                     MOVELWL0019    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSB     CHAIN@B0REJX              90    *
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAGCS    WL0020           Unit Cost Per P
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Load ID            RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WCAIC3           Company Number
     C                     Z-ADDP1C4NB    WCC4NB           Order Number
      * Establish starting position
     C           KRSSC     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WURMNB           Load ID
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCRMNB    WURMNB           Load ID
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Module Release
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDB3AB           Module ID
     C                     KFLD           WDHUNZ           Release Number
      * Setup key
     C                     MOVEL'WIM'     WDB3AB           Module ID
     C                     Z-ADD1         WDHUNZ           Release Number
      * Establish starting position
     C           KRSSD     CHAIN@C6REMK              90    *
      * Data record not found
     C   90                MOVEL'USR5307' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WDVSST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELWDOCSC    YL0003           Module Release
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0021    WAAIC3           Company Number
     C                     Z-ADDWL0022    WAHGCD           Item Code
      * Establish starting position
     C           KRSSE     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWARINB    WL0023           Item Structure
     C                     Z-ADDWARHNB    WL0024           Item Structure
     C                     Z-ADDWARGNB    WL0025           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WEHGCD    WQSF02           Item Code
     C           *LIKE     DEFN WEAJCD    WQSF03           Warehouse Code
     C           *LIKE     DEFN WEW9ST    WQSF04           Inventory Trans
     C           *LIKE     DEFN WEBSST    WQSF05           Inventory Trans
     C           *LIKE     DEFN WEB4DT    WQSF06           Transaction Dat
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Item Code
     C                     KFLD           WQSF03           Warehouse Code
     C                     KFLD           WQSF04           Inventory Trans
     C                     KFLD           WQSF05           Inventory Trans
     C                     KFLD           WQSF06           Transaction Dat
      * Setup key
     C                     Z-ADDWL0026    WQSF01           Company Number
     C                     Z-ADDWL0027    WQSF02           Item Code
     C                     MOVELWL0028    WQSF03           Warehouse Code
     C                     MOVELWL0029    WQSF04           Inventory Trans
     C                     MOVELWL0030    WQSF05           Inventory Trans
     C                     Z-ADDWL0031    WQSF06           Transaction Dat
      * Establish starting position
     C           KRSSF     SETLL@B7CPZA                    *
     C           KRSSF     READE@B7CPZA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0032           ITD Sequence Nu
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WEC4NY    ADD  1         WL0032           ITD Sequence Nu
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@B7CPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0020  60       Job Time
     C                     MOVEL*BLANK    WN0021 10        User Id
     C                     MOVEL*BLANK    WN0022 10        Job Name
     C                     Z-ADD*ZERO     WN0023  70       Job Date
     C                     Z-ADD*ZERO     WN0024  20       Production Hour
     C                     Z-ADD*ZERO     WN0025 112       Production Weig
     C                     Z-ADD*ZERO     WN0026  50       Production Quan
     C                     Z-ADD*ZERO     WN0027  70       Production Piec
     C                     MOVEL*BLANK    WN0028  1        Export_Domestic
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B7CPJZ
     C                     Z-ADDWL0033    WFAIC3           Company Number
     C                     Z-ADDWL0034    WFHGCD           Item Code
     C                     MOVELWL0035    WFAJCD           Warehouse Code
     C                     MOVELWL0036    WFW9ST           Inventory Trans
     C                     MOVELWL0037    WFBSST           Inventory Trans
     C                     Z-ADDWL0038    WFB4DT           Transaction Dat
     C                     Z-ADDWL0039    WFC4NY           ITD Sequence Nu
     C                     Z-ADDWL0040    WFDXNB           Sequence Number
     C                     Z-ADDWL0041    WFELDT           Production Date
     C                     MOVELWL0042    WFHVCD           UOM Transaction
     C                     MOVELWL0043    WFF1ST           Item Transactio
     C                     MOVELWL0044    WFAUNA           Description
     C                     Z-ADDWL0045    WFA5QT           Transaction Qua
     C                     Z-ADDWL0046    WFAHWG           Transaction Wei
     C                     Z-ADDWL0047    WFAKCS           USR Transaction
     C                     MOVELWL0048    WFCGCD           UOM Cost
     C                     Z-ADDWL0049    WFAYVA           Extended Amount
     C                     MOVELWL0050    WFBJNA           Ticket Number
     C                     Z-ADDWL0051    WFCKNB           GL Document Num
     C                     MOVELWL0052    WFBMST           GL Update Statu
     C                     MOVELWL0053    WFCQCD           Reason Code
     C                     MOVELWL0054    WFDTCD           Reference Numbe
     C                     MOVELWL0055    WFMGNA           Lot ID
     C                     Z-ADDWL0056    WFTRBN           Transfer Batch
     C                     Z-ADDWL0057    WFTRBS           Transfer Batch
     C                     Z-ADDWL0058    WFC4NB           Order Number
     C                     Z-ADDWL0059    WFRINB           Item Structure
     C                     Z-ADDWL0060    WFRHNB           Item Structure
     C                     Z-ADDWL0061    WFRGNB           Item Structure
     C                     MOVELWL0062    WFM3NA           Employee Badge
     C                     Z-ADDWL0063    WFAWTM           Production Time
     C                     MOVELWL0064    WFXLCD           Shift Number
     C                     Z-ADDWL0065    WFK7DT           Label Date
     C                     MOVELWL0066    WFUVST           EDI Status 1
     C                     MOVELWL0067    WFUWST           EDI Status 2
     C                     MOVELWL0068    WFUXST           EDI Status 3
     C                     MOVELWL0069    WFVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WFAXDT    PARM *ZERO     WQ0001 155       Current System
     C           WFAATM    PARM *ZERO     WQ0002 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSG    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFW9ST           Inventory Trans
     C                     KFLD           WFBSST           Inventory Trans
     C                     KFLD           WFB4DT           Transaction Dat
     C                     KFLD           WFC4NY           ITD Sequence Nu
     C                     KFLD           WFDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSG    SETLL@B7CPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0345' W0RTN   7
      * Send message 'Item Transaction Detai EX'
     C                     MOVEL'USR0345' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@B7CPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                     CALL 'POO5XFR'              90  Crt Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WFAIC3    WQ0003  30       Company Number
     C                     PARM WFHGCD    WQ0004  70       Item Code
     C                     PARM WFAJCD    WQ0005  3        Warehouse Code
     C                     PARM WFW9ST    WQ0006  1        Inventory Trans
     C                     PARM WFBSST    WQ0007  2        Inventory Trans
     C                     PARM WFB4DT    WQ0008  70       Transaction Dat
     C                     PARM WFDXNB    WQ0009  30       Sequence Number
     C                     PARM WFELDT    WQ0010  70       Production Date
     C                     PARM WFHVCD    WQ0011  2        UOM Transaction
     C                     PARM WFF1ST    WQ0012  2        Item Transactio
     C                     PARM WFAUNA    WQ0013 30        Description
     C                     PARM WFA5QT    WQ0014 112       Transaction Qua
     C                     PARM WFAHWG    WQ0015 112       Transaction Wei
     C                     PARM WFAKCS    WQ0016 114       USR Transaction
     C                     PARM WFCGCD    WQ0017  2        UOM Cost
     C                     PARM WFAYVA    WQ0018 112       Extended Amount
     C                     PARM WFBJNA    WQ0019  6        Ticket Number
     C                     PARM WFCKNB    WQ0020  80       GL Document Num
     C                     PARM WFBMST    WQ0021  1        GL Update Statu
     C                     PARM WFCQCD    WQ0022  3        Reason Code
     C                     PARM WFDTCD    WQ0023 15        Reference Numbe
     C                     PARM WFMGNA    WQ0024 10        Lot ID
     C                     PARM WFTRBN    WQ0025  70       Transfer Batch
     C                     PARM WFTRBS    WQ0026  30       Transfer Batch
     C                     PARM WFC4NB    WQ0027  70       Order Number
     C                     PARM WFRINB    WQ0028  30       Item Structure
     C                     PARM WFRHNB    WQ0029  30       Item Structure
     C                     PARM WFRGNB    WQ0030  30       Item Structure
     C                     PARM WFM3NA    WQ0031 10        Employee Badge
     C                     PARM WFAWTM    WQ0032  60       Production Time
     C                     PARM WFXLCD    WQ0033  1        Shift Number
     C                     PARM WFK7DT    WQ0034  70       Label Date
     C                     PARM WFVSST    WQ0035  1        Record Status
     C                     PARM WFAATM    WQ0036  60       Job Time
     C                     PARM WFAXDT    WQ0037  70       Job Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * CHG Value/Qty/Wgt      CH - IC Item Balance Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0029 112       Physical Count
     C                     Z-ADD*ZERO     WN0030 112       Physical Count
     C                     Z-ADD*ZERO     WN0031 112       Physical Count
     C                     Z-ADD*ZERO     WN0032 112       Physical Count
     C                     MOVEL*BLANK    WN0033  1        Physical Count
     C                     Z-ADD*ZERO     WN0034 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0035 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0036 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0037 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0038 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0039 112       Weight In Chill
     C                     MOVEL*BLANK    WN0040  1        Update Exceptio
     C                     Z-ADD*ZERO     WN0041 112       Physical Start
     C                     Z-ADD*ZERO     WN0042 112       Physical Start
     C                     Z-ADD*ZERO     WN0043 112       Physical Start
     C                     Z-ADD*ZERO     WN0044 112       Physical Start
     C                     Z-ADD*ZERO     WN0045  70       Physical Start
     C                     Z-ADD*ZERO     WN0046 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0047 114       Last Cost
     C                     Z-ADD*ZERO     WN0048 112       Value of On Han
     C                     Z-ADD*ZERO     WN0049  70       Label Date
     C                     MOVEL*BLANK    WN0050  1        EDI Status 1
     C                     MOVEL*BLANK    WN0051  1        EDI Status 2
     C                     MOVEL*BLANK    WN0052  1        EDI Status 3
     C                     MOVEL*BLANK    WN0053  1        Record Status
     C                     Z-ADD*ZERO     WN0054  60       Job Time
     C                     MOVEL*BLANK    WN0055 10        User Id
     C                     MOVEL*BLANK    WN0056 10        Job Name
     C                     Z-ADD*ZERO     WN0057  70       Job Date
     C                     MOVEL*BLANK    WN0058  1        Shift Number
     C                     MOVEL*BLANK    WN0059  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
     C                     MOVEL'1'       WN0058           Shift Number
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWL0070    WGAIC3           Company Number
     C                     Z-ADDWL0071    WGHGCD           Item Code
     C                     MOVELWL0072    WGAJCD    P      Warehouse Code
     C                     Z-ADDWL0073    WGELDT           Production Date
      *
     C           KLCHSH    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
     C           KLCHSH    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0070    WL0096           Company Number
     C                     Z-ADDWL0071    WL0097           Item Code
     C                     MOVELWL0072    WL0098    P      Warehouse Code
     C                     Z-ADDWL0073    WL0099           Production Date
     C                     Z-ADD*ZERO     WL0100           Physical Count
     C                     Z-ADD*ZERO     WL0101           Physical Count
     C                     Z-ADD*ZERO     WL0102           Physical Count
     C                     Z-ADD*ZERO     WL0103           Physical Count
     C                     MOVEL*BLANK    WL0104           Physical Count
     C                     Z-ADDWL0091    WL0105           Quantity on Han
     C                     Z-ADDWL0090    WL0106           Quantity on Han
     C                     Z-ADD*ZERO     WL0107           Quantity on Han
     C                     Z-ADD*ZERO     WL0108           Quantity on Han
     C                     Z-ADD*ZERO     WL0109           Quantity In Chi
     C                     Z-ADD*ZERO     WL0110           Weight In Chill
     C                     MOVEL'N'       WL0111    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0112           Physical Start
     C                     Z-ADD*ZERO     WL0113           Physical Start
     C                     Z-ADD*ZERO     WL0114           Physical Start
     C                     Z-ADD*ZERO     WL0115           Physical Start
     C                     Z-ADD*ZERO     WL0116           Physical Start
     C                     Z-ADD*ZERO     WL0117           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0118           Last Cost
     C                     Z-ADDWL0094    WL0119           Value of On Han
     C                     Z-ADDWL0095    WL0120           Label Date
     C                     Z-ADDWL0074    WL0121           Item Structure
     C                     Z-ADDWL0075    WL0122           Item Structure
     C                     Z-ADDWL0076    WL0123           Item Structure
     C                     MOVEL*BLANK    WL0124           EDI Status 1
     C                     MOVEL*BLANK    WL0125           EDI Status 2
     C                     MOVEL*BLANK    WL0126           EDI Status 3
     C                     MOVEL'A'       WL0127    P      Record Status
     C                     EXSR SICRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YARDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWL0074    WGRINB           Item Structure
     C                     Z-ADDWL0075    WGRHNB           Item Structure
     C                     Z-ADDWL0076    WGRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YARDC            *Record Data Ch
     C                     ADD  WL0090    WGARQT           Quantity on Han
     C                     ADD  WL0091    WGACWG           Quantity on Han
     C                     ADD  WL0094    WGIDVA           Value of On Han
      * If quantity is zero, so are weight, value of inventory
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WGARQT    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - Item Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0040  30       Company Number
     C                     PARM WGHGCD    WQ0041  70       Item Code
     C                     PARM WGAJCD    WQ0042  3        Warehouse Code
     C                     PARM WL0088    WQ0043  70       Transaction Dat
     C                     PARM WGELDT    WQ0044  70       Production Date
     C                     PARM WL0089    WQ0045  2        UOM Transaction
     C                     PARM WGACWG    WQ0046 112       Transaction Wei
     C                     PARM WL0092    WQ0047 114       USR Transaction
     C                     PARM WL0093    WQ0048  2        UOM Cost
     C                     PARM WGRINB    WQ0049  30       Item Structure
     C                     PARM WGRHNB    WQ0050  30       Item Structure
     C                     PARM WGRGNB    WQ0051  30       Item Structure
     C                     PARM WN0058    WQ0052  1        Shift Number
     C                     PARM WGK7DT    WQ0053  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WGACWG           Quantity on Han
     C                     Z-ADD*ZERO     WGIDVA           Value of On Han
     C                     END                             *FI
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WGAXDT    PARM *ZERO     WQ0054 155       Current System
     C           WGAATM    PARM *ZERO     WQ0055 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WGARQT    IFEQ WUW0NB                     *IF
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWGAJCD    WL0128    P      Warehouse Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0129    WN0059    P      Lot Tracking Fl
      * CASE: PAR.Lot Tracking Flag is Not Yes
     C           WN0059    IFEQ *BLANK                     *IF
     C           WN0059    OREQ 'N'
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0130           Company Number
     C                     Z-ADDWGHGCD    WL0131           Item Code
     C                     MOVELWGAJCD    WL0132    P      Warehouse Code
     C                     Z-ADDWGELDT    WL0133           Production Date
     C                     EXSR SKDLRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0060  60       Job Time
     C                     MOVEL*BLANK    WN0061 10        User Id
     C                     MOVEL*BLANK    WN0062 10        Job Name
     C                     Z-ADD*ZERO     WN0063  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1REJ1
     C                     Z-ADDWL0096    WGAIC3           Company Number
     C                     Z-ADDWL0097    WGHGCD           Item Code
     C                     MOVELWL0098    WGAJCD           Warehouse Code
     C                     Z-ADDWL0099    WGELDT           Production Date
     C                     Z-ADDWL0100    WGABWG           Physical Count
     C                     Z-ADDWL0101    WGAGQT           Physical Count
     C                     Z-ADDWL0102    WGAHQT           Physical Count
     C                     Z-ADDWL0103    WGAIQT           Physical Count
     C                     MOVELWL0104    WGCTST           Physical Count
     C                     Z-ADDWL0105    WGACWG           Quantity on Han
     C                     Z-ADDWL0106    WGARQT           Quantity on Han
     C                     Z-ADDWL0107    WGASQT           Quantity on Han
     C                     Z-ADDWL0108    WGATQT           Quantity on Han
     C                     Z-ADDWL0109    WGHDQT           Quantity In Chi
     C                     Z-ADDWL0110    WGHEQT           Weight In Chill
     C                     MOVELWL0111    WGF6ST           Update Exceptio
     C                     Z-ADDWL0112    WGBMWG           Physical Start
     C                     Z-ADDWL0113    WGDSQT           Physical Start
     C                     Z-ADDWL0114    WGDTQT           Physical Start
     C                     Z-ADDWL0115    WGDUQT           Physical Start
     C                     Z-ADDWL0116    WGDHDT           Physical Start
     C                     Z-ADDWL0117    WGAGCS           Unit Cost Per P
     C                     Z-ADDWL0118    WGAECS           Last Cost
     C                     Z-ADDWL0119    WGIDVA           Value of On Han
     C                     Z-ADDWL0120    WGK7DT           Label Date
     C                     Z-ADDWL0121    WGRINB           Item Structure
     C                     Z-ADDWL0122    WGRHNB           Item Structure
     C                     Z-ADDWL0123    WGRGNB           Item Structure
     C                     MOVELWL0124    WGUVST           EDI Status 1
     C                     MOVELWL0125    WGUWST           EDI Status 2
     C                     MOVELWL0126    WGUXST           EDI Status 3
     C                     MOVELWL0127    WGVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WGAXDT    PARM *ZERO     WQ0038 155       Current System
     C           WGAATM    PARM *ZERO     WQ0039 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSI    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSI    SETLL@B1REJ1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0331' W0RTN   7
      * Send message 'Item Balance Detail    EX'
     C                     MOVEL'USR0331' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@B1REJ1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0128    WHAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0129           Lot Tracking Fl
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHVHST    WL0129           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKDLRC    BEGSR
      *================================================================
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDWL0130    WGAIC3           Company Number
     C                     Z-ADDWL0131    WGHGCD           Item Code
     C                     MOVELWL0132    WGAJCD           Warehouse Code
     C                     Z-ADDWL0133    WGELDT           Production Date
      *
     C           KLDLSK    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
     C           KLDLSK    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0137           Quantity on Han
     C                     Z-ADD*ZERO     WL0138           Quantity on Han
     C                     Z-ADD*ZERO     WL0139           Quantity on Han
     C                     Z-ADD*ZERO     WL0140           Quantity on Han
     C                     Z-ADD*ZERO     WL0141           Value of On Han
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WIHGCD    WQSL02           Item Code
     C           *LIKE     DEFN WIAJCD    WQSL03           Warehouse Code
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Item Code
     C                     KFLD           WQSL03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0134    WQSL01           Company Number
     C                     Z-ADDWL0135    WQSL02           Item Code
     C                     MOVELWL0136    WQSL03           Warehouse Code
      * Establish starting position
     C           KRSSL     SETLLCAB1RL4                    *
     C           KRSSL     READECAB1RL4                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WIACWG    WL0137           Quantity on Han
     C                     ADD  WIARQT    WL0138           Quantity on Han
     C                     ADD  WIASQT    WL0139           Quantity on Han
     C                     ADD  WIATQT    WL0140           Quantity on Han
     C                     ADD  WIIDVA    WL0141           Value of On Han
     C           KRSSL     READECAB1RL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * Chg Val/Qty/Wgt        Ch - IC Item Balance  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0064 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0065 114       Last Cost
     C                     Z-ADD*ZERO     WN0066 114       Cost per Primar
     C                     Z-ADD*ZERO     WN0067 114       Cost per Pricin
     C                     Z-ADD*ZERO     WN0068 114       Revaluation Cos
     C                     Z-ADD*ZERO     WN0069  70       Revaluation Eff
     C                     MOVEL*BLANK    WN0070  1        Revaluation Cos
     C                     Z-ADD*ZERO     WN0071 114       Last Revaluatio
     C                     Z-ADD*ZERO     WN0072  70       Last Revaluatio
     C                     Z-ADD*ZERO     WN0073 112       On Hand UOM2 Su
     C                     Z-ADD*ZERO     WN0074 112       On Hand UOM3 Su
     C                     Z-ADD*ZERO     WN0075 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0076 112       Weight In Chill
     C                     Z-ADD*ZERO     WN0077 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0078 112       Quantity on Sal
     C                     Z-ADD*ZERO     WN0079 112       Quantity on Pur
     C                     Z-ADD*ZERO     WN0080 112       Quantity on Tra
     C                     Z-ADD*ZERO     WN0081 112       Quantity Avail
     C                     MOVEL*BLANK    WN0082  3        Cycle Count Cod
     C                     Z-ADD*ZERO     WN0083  70       Date of Last Or
     C                     Z-ADD*ZERO     WN0084  70       Date of Last Sh
     C                     MOVEL*BLANK    WN0085  1        Inventory Plann
     C                     Z-ADD*ZERO     WN0086  52       Safety Allowanc
     C                     Z-ADD*ZERO     WN0087 112       Safety Allowanc
     C                     Z-ADD*ZERO     WN0088  70       Stock Out Date
     C                     MOVEL*BLANK    WN0089  3        Buyer Code
     C                     Z-ADD*ZERO     WN0090  30       Lead Time Last
     C                     Z-ADD*ZERO     WN0091  70       Lead Time Date
     C                     Z-ADD*ZERO     WN0092  30       Lead Time Next
     C                     Z-ADD*ZERO     WN0093  70       Lead Time Date
     C                     MOVEL*BLANK    WN0094  1        Lead Time Excep
     C                     Z-ADD*ZERO     WN0095 112       Usage Qty per C
     C                     Z-ADD*ZERO     WN0096 112       Usage Weight pe
     C                     Z-ADD*ZERO     WN0097  70       Inventory Manag
     C                     Z-ADD*ZERO     WN0098 112       Minimum Quantit
     C                     Z-ADD*ZERO     WN0099 112       Maximum Quantit
     C                     Z-ADD*ZERO     WN0100  70       Last Physical C
     C                     MOVEL*BLANK    WN0101  1        Requisition Mod
     C                     MOVEL*BLANK    WN0102  1        Cost Update Pen
     C                     MOVEL*BLANK    WN0103  1        Post GL Status
     C                     Z-ADD*ZERO     WN0104  80       Vendor Item_Whs
     C                     Z-ADD*ZERO     WN0105  30       Item Structure
     C                     Z-ADD*ZERO     WN0106  30       Item Structure
     C                     Z-ADD*ZERO     WN0107  30       Item Structure
     C                     MOVEL*BLANK    WN0108  1        EDI Status 1
     C                     MOVEL*BLANK    WN0109  1        EDI Status 2
     C                     MOVEL*BLANK    WN0110  1        EDI Status 3
     C                     MOVEL*BLANK    WN0111  1        Record Status
     C                     Z-ADD*ZERO     WN0112  60       Job Time
     C                     MOVEL*BLANK    WN0113 10        User Id
     C                     MOVEL*BLANK    WN0114 10        Job Name
     C                     Z-ADD*ZERO     WN0115  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWL0142    WJAIC3           Company Number
     C                     Z-ADDWL0143    WJHGCD           Item Code
     C                     MOVELWL0144    WJAJCD    P      Warehouse Code
      *
     C           KLCHSM    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
     C                     KFLD           WJAJCD           Warehouse Code
     C           KLCHSM    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YBRDCS
      * Move non-key fields to @B0REJT
     C                     Z-ADDWL0145    WJBOWG           On Hand Weight
     C                     Z-ADDWL0146    WJDDQT           On Hand UOM1 Su
     C                     Z-ADDWL0147    WJIDVA           Value of On Han
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YBRDC            *Record Data Ch
      * Refresh the available to sell quantity
     C                     Z-ADDWJDDQT    WJDOQT           Quantity Avail
     C                     SUB  WJAQQT    WJDOQT           Quantity Avail
     C                     SUB  WJAUQT    WJDOQT           Quantity Avail
     C                     SUB  WJEMQT    WJDOQT           Quantity Avail
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Warehouse Info     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0148    WHAJCD           Warehouse Code
      * Establish starting position
     C           KRSSN     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0149           Warehouse Descr
     C                     MOVEL*BLANK    WL0150           Address Line 1
     C                     MOVEL*BLANK    WL0151           Address Line 2
     C                     MOVEL*BLANK    WL0152           Address Line 3
     C                     MOVEL*BLANK    WL0153           City
     C                     MOVEL*BLANK    WL0154           Zip Postal Code
     C                     MOVEL*BLANK    WL0155           Production Ware
     C                     MOVEL*BLANK    WL0156           State Code
     C                     MOVEL*BLANK    WL0157           Lot Tracking Fl
     C                     MOVEL*BLANK    WL0158           Default Printer
     C                     MOVEL*BLANK    WL0159           Warehouse Type
     C                     MOVEL*BLANK    WL0160           Trans Contol AS
     C                     MOVEL*BLANK    WL0161           Warehouse Locat
     C                     MOVEL*BLANK    WL0162           Warehouse Std C
     C                     Z-ADD*ZERO     WL0163           Warehouse Chill
     C                     MOVEL*BLANK    WL0164           Include in Auto
     C                     MOVEL*BLANK    WL0165           Default Manifes
     C                     MOVEL*BLANK    WL0166           Default Load Se
     C                     MOVEL*BLANK    WL0167           WHS Slotting Li
     C                     Z-ADD*ZERO     WL0168           Shipping Compan
     C                     Z-ADD*ZERO     WL0169           Accounting Comp
     C                     Z-ADD*ZERO     WL0170           WHS Sched Prod
     C                     Z-ADD*ZERO     WL0171           WHS Inventory C
     C                     MOVEL*BLANK    WL0172           Parent Warehous
     C                     MOVEL*BLANK    WL0173           Default Shippin
     C                     MOVEL*BLANK    WL0174           WHS Live with C
     C                     MOVEL*BLANK    WL0175           WHS PFS Interfa
     C                     MOVEL*BLANK    WL0176           WHS Req Meter R
     C                     MOVEL*BLANK    WL0177           WHS Default Loa
     C                     MOVEL*BLANK    WL0178           WHS TMS Plannin
     C                     MOVEL*BLANK    WL0179           Default Carrier
     C                     MOVEL*BLANK    WL0180           Inventory Logic
     C                     MOVEL*BLANK    WL0181           WHS Auto Inv Re
     C                     MOVEL*BLANK    WL0182           EDI Status 1
     C                     MOVEL*BLANK    WL0183           EDI Status 2
     C                     MOVEL*BLANK    WL0184           EDI Status 3
     C                     MOVEL*BLANK    WL0185           Record Status
     C                     Z-ADD*ZERO     WL0186           Job Time
     C                     MOVEL*BLANK    WL0187           User Id
     C                     MOVEL*BLANK    WL0188           Job Name
     C                     Z-ADD*ZERO     WL0189           Job Date
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHF8NA    WL0149           Warehouse Descr
     C                     MOVELWHACNA    WL0150           Address Line 1
     C                     MOVELWHADNA    WL0151           Address Line 2
     C                     MOVELWHAENA    WL0152           Address Line 3
     C                     MOVELWHAJNA    WL0153           City
     C                     MOVELWHBTTX    WL0154           Zip Postal Code
     C                     MOVELWHAOCD    WL0155           Production Ware
     C                     MOVELWHBGCD    WL0156           State Code
     C                     MOVELWHVHST    WL0157           Lot Tracking Fl
     C                     MOVELWHMPNA    WL0158           Default Printer
     C                     MOVELWHWPST    WL0159           Warehouse Type
     C                     MOVELWHXUST    WL0160           Trans Contol AS
     C                     MOVELWHT0ST    WL0161           Warehouse Locat
     C                     MOVELWHT1ST    WL0162           Warehouse Std C
     C                     Z-ADDWHDBNB    WL0163           Warehouse Chill
     C                     MOVELWHT2ST    WL0164           Include in Auto
     C                     MOVELWHT3ST    WL0165           Default Manifes
     C                     MOVELWHT4ST    WL0166           Default Load Se
     C                     MOVELWHT6ST    WL0167           WHS Slotting Li
     C                     Z-ADDWHBWC3    WL0168           Shipping Compan
     C                     Z-ADDWHBTC3    WL0169           Accounting Comp
     C                     Z-ADDWHBUC3    WL0170           WHS Sched Prod
     C                     Z-ADDWHBVC3    WL0171           WHS Inventory C
     C                     MOVELWHFCAA    WL0172           Parent Warehous
     C                     MOVELWHRQSX    WL0173           Default Shippin
     C                     MOVELWHRRSX    WL0174           WHS Live with C
     C                     MOVELWHRSSX    WL0175           WHS PFS Interfa
     C                     MOVELWHRTSX    WL0176           WHS Req Meter R
     C                     MOVELWHT7ST    WL0177           WHS Default Loa
     C                     MOVELWHT8ST    WL0178           WHS TMS Plannin
     C                     MOVELWHRNSX    WL0179           Default Carrier
     C                     MOVELWHROSX    WL0180           Inventory Logic
     C                     MOVELWHRPSX    WL0181           WHS Auto Inv Re
     C                     MOVELWHUVST    WL0182           EDI Status 1
     C                     MOVELWHUWST    WL0183           EDI Status 2
     C                     MOVELWHUXST    WL0184           EDI Status 3
     C                     MOVELWHVSST    WL0185           Record Status
     C                     Z-ADDWHAATM    WL0186           Job Time
     C                     MOVELWHAYNA    WL0187           User Id
     C                     MOVELWHA0NA    WL0188           Job Name
     C                     Z-ADDWHAXDT    WL0189           Job Date
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Whse Location Info RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAJCD    WQSO01           Warehouse Code
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Warehouse Code
      * Setup key
     C                     MOVELWL0190    WQSO01           Warehouse Code
      * Establish starting position
     C           KRSSO     SETLL@L2RESM                    *
     C           KRSSO     READE@L2RESM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0191           Location Code
     C                     MOVEL*BLANK    WL0192           Location Aisle
     C                     Z-ADD*ZERO     WL0193           Location Bay
     C                     Z-ADD*ZERO     WL0194           Loc Unused Chil
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKYMCD    WL0191           Location Code
     C                     MOVELWKYPCD    WL0192           Location Aisle
     C                     Z-ADDWKLCBY    WL0193           Location Bay
     C                     Z-ADDWKLCCT    WL0194           Loc Unused Chil
     C                     GOTO SOEXIT                     *QUIT
     C           KRSSO     READE@L2RESM                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Shipping Co        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0195    WHAJCD           Warehouse Code
      * Establish starting position
     C           KRSSP     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0196           Shipping Compan
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHBWC3    WL0196           Shipping Compan
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Val Item Balance       RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0197    WLAIC3           Company Number
     C                     Z-ADDWL0198    WLHGCD           Item Code
     C                     MOVELWL0199    WLAJCD           Warehouse Code
      * Establish starting position
     C           KRSSQ     CHAIN@B0REYY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCRRC    BEGSR
      *================================================================
      * Crt Item Balance       CR - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0116  60       Job Time
     C                     MOVEL*BLANK    WN0117 10        User Id
     C                     MOVEL*BLANK    WN0118 10        Job Name
     C                     Z-ADD*ZERO     WN0119  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B0REJT
     C                     Z-ADDWL0200    WJAIC3           Company Number
     C                     Z-ADDWL0201    WJHGCD           Item Code
     C                     MOVELWL0202    WJAJCD           Warehouse Code
     C                     Z-ADDWL0203    WJAGCS           Unit Cost Per P
     C                     Z-ADDWL0204    WJAECS           Last Cost
     C                     Z-ADDWL0205    WJBACS           Cost per Primar
     C                     Z-ADDWL0206    WJBBCS           Cost per Pricin
     C                     Z-ADDWL0207    WJCBPR           Revaluation Cos
     C                     Z-ADDWL0208    WJGUDT           Revaluation Eff
     C                     MOVELWL0209    WJXYST           Revaluation Cos
     C                     Z-ADDWL0210    WJCTPR           Last Revaluatio
     C                     Z-ADDWL0211    WJG4DT           Last Revaluatio
     C                     Z-ADDWL0212    WJBOWG           On Hand Weight
     C                     Z-ADDWL0213    WJDDQT           On Hand UOM1 Su
     C                     Z-ADDWL0214    WJDEQT           On Hand UOM2 Su
     C                     Z-ADDWL0215    WJDFQT           On Hand UOM3 Su
     C                     Z-ADDWL0216    WJHDQT           Quantity In Chi
     C                     Z-ADDWL0217    WJHEQT           Weight In Chill
     C                     Z-ADDWL0218    WJAJQT           Quantity Schedu
     C                     Z-ADDWL0219    WJAQQT           Quantity on Sal
     C                     Z-ADDWL0220    WJAUQT           Quantity on Pur
     C                     Z-ADDWL0221    WJEMQT           Quantity on Tra
     C                     Z-ADDWL0222    WJDOQT           Quantity Avail
     C                     MOVELWL0223    WJATNA           Cycle Count Cod
     C                     Z-ADDWL0224    WJAKDT           Date of Last Or
     C                     Z-ADDWL0225    WJANDT           Date of Last Sh
     C                     Z-ADDWL0226    WJIDVA           Value of On Han
     C                     MOVELWL0227    WJJVST           Inventory Plann
     C                     Z-ADDWL0228    WJBZPC           Safety Allowanc
     C                     Z-ADDWL0229    WJDGQT           Safety Allowanc
     C                     Z-ADDWL0230    WJDIDT           Stock Out Date
     C                     MOVELWL0231    WJALCD           Buyer Code
     C                     Z-ADDWL0232    WJBFDY           Lead Time Last
     C                     Z-ADDWL0233    WJDJDT           Lead Time Date
     C                     Z-ADDWL0234    WJBGDY           Lead Time Next
     C                     Z-ADDWL0235    WJDKDT           Lead Time Date
     C                     MOVELWL0236    WJJ2ST           Lead Time Excep
     C                     Z-ADDWL0237    WJDJQT           Usage Qty per C
     C                     Z-ADDWL0238    WJBNWG           Usage Weight pe
     C                     Z-ADDWL0239    WJDLDT           Inventory Manag
     C                     Z-ADDWL0240    WJDPQT           Minimum Quantit
     C                     Z-ADDWL0241    WJDQQT           Maximum Quantit
     C                     Z-ADDWL0242    WJDMDT           Last Physical C
     C                     MOVELWL0243    WJM0ST           Requisition Mod
     C                     MOVELWL0244    WJJ9ST           Cost Update Pen
     C                     MOVELWL0245    WJKBST           Post GL Status
     C                     Z-ADDWL0246    WJAKC8           Vendor Item_Whs
     C                     Z-ADDWL0247    WJRINB           Item Structure
     C                     Z-ADDWL0248    WJRHNB           Item Structure
     C                     Z-ADDWL0249    WJRGNB           Item Structure
     C                     MOVELWL0250    WJUVST           EDI Status 1
     C                     MOVELWL0251    WJUWST           EDI Status 2
     C                     MOVELWL0252    WJUXST           EDI Status 3
     C                     MOVELWL0253    WJVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
     C           KLCRSR    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
     C                     KFLD           WJAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSR    SETLL@B0REJT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0329' W0RTN   7
      * Send message 'Item Balance           EX'
     C                     MOVEL'USR0329' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C                     WRITE@B0REJT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Prc Create Dtl Receipt RT - Item Transaction Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0120  2        UOM Cost
     C                     Z-ADD*ZERO     WN0121 112       Extended Amount
     C                     MOVEL*BLANK    WN0122  1        GL Update Statu
     C                     MOVEL*BLANK    WN0123 30        Description Lin
     C                     MOVEL*BLANK    WN0124  2        UOM Primary
     C                     Z-ADD*ZERO     WN0125  94       Conversion Fact
     C                     MOVEL*BLANK    WN0126  1        Operation Facto
     C                     MOVEL*BLANK    WN0127  2        UOM Second
     C                     Z-ADD*ZERO     WN0128  94       Conversion Fact
     C                     MOVEL*BLANK    WN0129  1        Operation Facto
     C                     MOVEL*BLANK    WN0130  2        UOM Third
     C                     MOVEL*BLANK    WN0131  2        UOM Pricing
     C                     Z-ADD*ZERO     WN0132 112       Unit Weight
     C                     MOVEL*BLANK    WN0133  1        Production Date
     C                     MOVEL*BLANK    WN0134  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0135  30       Item Structure
     C                     Z-ADD*ZERO     WN0136  30       Item Structure
     C                     Z-ADD*ZERO     WN0137  30       Item Structure
     C                     Z-ADD*ZERO     WN0138 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0139 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0140 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0141 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0142 114       Unit Cost Per P
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMHGCD           Item Code
     C                     KFLD           WMAJCD           Warehouse Code
     C                     KFLD           WMW9ST           Inventory Trans
     C                     KFLD           WMBSST           Inventory Trans
     C                     KFLD           WMB4DT           Transaction Dat
     C                     KFLD           WMC4NY           ITD Sequence Nu
     C                     KFLD           WMDXNB           Sequence Number
      * Setup key
     C                     Z-ADDWL0254    WMAIC3           Company Number
     C                     Z-ADDWL0255    WMHGCD           Item Code
     C                     MOVELWL0256    WMAJCD           Warehouse Code
     C                     MOVELWL0257    WMW9ST           Inventory Trans
     C                     MOVELWL0258    WMBSST           Inventory Trans
     C                     Z-ADDWL0259    WMB4DT           Transaction Dat
     C                     Z-ADDWL0260    WMC4NY           ITD Sequence Nu
     C                     Z-ADDWL0261    WMDXNB           Sequence Number
      * Establish starting position
     C           KRSSS     CHAINRB7CPJ3              90    *
      * Data record not found
     C   90                MOVEL'USR0344' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv Base Values        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMAIC3    WL0001           Company Number
     C                     Z-ADDWMHGCD    WL0002           Item Code
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WN0123    P      Description Lin
     C                     MOVELWL0004    WUAWNA    P      Description Lin
     C                     MOVELWL0005    WN0124    P      UOM Primary
     C                     Z-ADDWL0006    WN0125           Conversion Fact
     C                     MOVELWL0007    WN0126    P      Operation Facto
     C                     MOVELWL0008    WN0127    P      UOM Second
     C                     Z-ADDWL0009    WN0128           Conversion Fact
     C                     MOVELWL0010    WN0129    P      Operation Facto
     C                     MOVELWL0011    WN0130    P      UOM Third
     C                     MOVELWL0012    WUAICD    P      UOM Pricing
     C                     Z-ADDWL0013    WN0132           Unit Weight
     C                     MOVELWL0014    WN0133    P      Production Date
     C                     MOVELWL0015    WN0134    P      Catch Weight St
     C                     Z-ADDWL0016    WUCHTM           Fresh Chilling
      * Rtv Quantity/Dollars   RT - Item Balance  * 
     C                     EXSR STRVGN
      * UPD Value/Qty/Wgt      CH - Item Balance  * 
     C                     EXSR SUCHRC
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Quantity/Dollars   RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWMAIC3    WBAIC3           Company Number
     C                     Z-ADDWMHGCD    WBHGCD           Item Code
     C                     MOVELWMAJCD    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSST     CHAIN@B0REJX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0142           Unit Cost Per P
     C                     Z-ADD*ZERO     WN0138           On Hand Weight
     C                     Z-ADD*ZERO     WN0139           On Hand UOM1 Su
     C                     Z-ADD*ZERO     WN0140           On Hand UOM2 Su
     C                     Z-ADD*ZERO     WN0141           On Hand UOM3 Su
     C                     Z-ADD*ZERO     WUIDVA           Value of On Han
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAGCS    WN0142           Unit Cost Per P
     C                     Z-ADDWBBOWG    WN0138           On Hand Weight
     C                     Z-ADDWBDDQT    WN0139           On Hand UOM1 Su
     C                     Z-ADDWBDEQT    WN0140           On Hand UOM2 Su
     C                     Z-ADDWBDFQT    WN0141           On Hand UOM3 Su
     C                     Z-ADDWBIDVA    WUIDVA           Value of On Han
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * UPD Value/Qty/Wgt      CH - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0143 112       Quantity based
     C                     Z-ADD*ZERO     WN0144 112       Quantity based
     C                     Z-ADD*ZERO     WN0145 112       Quantity based
     C                     Z-ADD*ZERO     WN0146 114       Cost based on U
     C                     Z-ADD*ZERO     WN0147 114       Cost based on U
     C                     Z-ADD*ZERO     WN0148 114       Cost based on U
     C                     Z-ADD*ZERO     WN0149 112       Quantity Total
     C                     Z-ADD*ZERO     WN0150 112       Quantity Total
     C                     Z-ADD*ZERO     WN0151 112       Cost Replace Do
     C                     Z-ADD*ZERO     WN0152 112       USR Allocated P
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      *
     C                     Z-ADD*ZERO     WN0153 114       Cost based on U
     C                     Z-ADD*ZERO     WN0154 114       Cost based on U
     C                     Z-ADD*ZERO     WN0155 114       Cost based on U
      *
      * Clc Convert Cost       IF
      * Initialize parameter values
     C                     Z-ADD*ZERO     WN0146           Cost based on U
     C                     Z-ADD*ZERO     WN0147           Cost based on U
     C                     Z-ADD*ZERO     WN0148           Cost based on U
      * Process based on Unit of Measure entered
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Cost
     C           WN0124    IFEQ WMCGCD                     *IF
     C                     Z-ADDWN0142    WN0146           Cost based on U
      * Process second U/M if entered
      * CASE: PAR.U/M - Second is Entered
     C           WN0127    IFNE *BLANK                     *IF
      * Convert based on operation code
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0126    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0125    IFNE 0                          *IF
     C           WN0142    DIV  WN0125    WN0154    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0126    IFEQ 'D'                        *IF
     C           WN0142    MULT WN0125    WN0154    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0154    WN0147           Cost based on U
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0130    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0129    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0128    IFNE 0                          *IF
     C           WN0154    DIV  WN0128    WN0148    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0129    IFEQ 'D'                        *IF
     C           WN0154    MULT WN0128    WN0148    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Cost
     C           WN0127    IFEQ WMCGCD                     *IF
     C                     Z-ADDWN0142    WN0147           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0126    IFEQ 'M'                        *IF
     C           WN0142    MULT WN0125    WN0146    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0126    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0125    IFNE 0                          *IF
     C           WN0142    DIV  WN0125    WN0146    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0130    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0129    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0128    IFNE 0                          *IF
     C           WN0142    DIV  WN0128    WN0148    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0129    IFEQ 'D'                        *IF
     C           WN0142    MULT WN0128    WN0148    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Cost
     C           WN0130    IFEQ WMCGCD                     *IF
     C                     Z-ADDWN0142    WN0148           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0129    IFEQ 'M'                        *IF
     C           WN0142    MULT WN0128    WN0154    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0129    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0128    IFNE 0                          *IF
     C           WN0142    DIV  WN0128    WN0154    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0154    WN0147           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0126    IFEQ 'M'                        *IF
     C           WN0154    MULT WN0125    WN0146    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0126    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0125    IFNE 0                          *IF
     C           WN0154    DIV  WN0125    WN0146    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0156 112       Quantity based
     C                     Z-ADD*ZERO     WN0157 112       Quantity based
     C                     Z-ADD*ZERO     WN0158 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0143           USR Qty based o
     C                     Z-ADD*ZERO     WN0144           USR Qty based o
     C                     Z-ADD*ZERO     WN0145           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           WN0124    IFEQ WMHVCD                     *IF
     C                     Z-ADDWMA5QT    WN0143           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           WN0127    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0126    IFEQ 'M'                        *IF
     C           WMA5QT    MULT WN0125    WN0157    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0126    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0125    IFNE 0                          *IF
     C           WMA5QT    DIV  WN0125    WN0157    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0157    WN0144           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0130    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0129    IFEQ 'M'                        *IF
     C           WN0157    MULT WN0128    WN0158    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0129    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0128    IFNE 0                          *IF
     C           WN0157    DIV  WN0128    WN0158    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0158    WN0145           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           WN0127    IFEQ WMHVCD                     *IF
     C                     Z-ADDWMA5QT    WN0144           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0126    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0125    IFNE 0                          *IF
     C           WMA5QT    DIV  WN0125    WN0143    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0126    IFEQ 'D'                        *IF
     C           WMA5QT    MULT WN0125    WN0143    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0130    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0129    IFEQ 'M'                        *IF
     C           WMA5QT    MULT WN0128    WN0158    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0129    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0128    IFNE 0                          *IF
     C           WMA5QT    DIV  WN0128    WN0158    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0158    WN0145           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           WN0130    IFEQ WMHVCD                     *IF
     C                     Z-ADDWMA5QT    WN0145           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0129    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0128    IFNE 0                          *IF
     C           WMA5QT    DIV  WN0128    WN0157    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0129    IFEQ 'D'                        *IF
     C           WMA5QT    MULT WN0128    WN0157    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0157    WN0144           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0126    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0125    IFNE 0                          *IF
     C           WN0157    DIV  WN0125    WN0143    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0126    IFEQ 'D'                        *IF
     C           WN0157    MULT WN0125    WN0143    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWMAIC3    WJAIC3           Company Number
     C                     Z-ADDWMHGCD    WJHGCD           Item Code
     C                     MOVELWMAJCD    WJAJCD    P      Warehouse Code
      *
     C           KLCHSU    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
     C                     KFLD           WJAJCD           Warehouse Code
     C           KLCHSU    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YCRDCS
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YCRDC            *Record Data Ch
      * (Creates IB if not found or updates if it exists)
      * Update IC Item Balance Detail
      * UPD Value/Qty          RT - IC Item Balance Detail  * 
     C                     EXSR SVRVGN
      * Update the quantity/weight on hand in the item balance file
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWJAIC3    WL0134           Company Number
     C                     Z-ADDWJHGCD    WL0135           Item Code
     C                     MOVELWJAJCD    WL0136    P      Warehouse Code
     C                     Z-ADDWJBOWG    WL0137           Quantity on Han
     C                     Z-ADDWJDDQT    WL0138           Quantity on Han
     C                     Z-ADDWUNFNN    WL0139           Quantity on Han
     C                     Z-ADDWUNFNN    WL0140           Quantity on Han
     C                     Z-ADDWJIDVA    WL0141           Value of On Han
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0137    WJBOWG           Quantity on Han
     C                     Z-ADDWL0138    WJDDQT           Quantity on Han
     C                     Z-ADDWL0139    WUNFNN           Quantity on Han
     C                     Z-ADDWL0140    WUNFNN           Quantity on Han
     C                     Z-ADDWL0141    WJIDVA           Value of On Han
     C                     Z-ADD*ZERO     WJDOQT           Available Prima
      * Available Primary U/M
     C           WJDDQT    SUB  WJAJQT    WJDOQT           Available Prima
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WJAATM' defaulted for 'Job Time'.
      * Field '(DB1) WJAYNA' defaulted for 'User Id'.
      * Field '(DB1) WJA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WJAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * UPD Value/Qty          RT - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0159 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0160 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0161 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0162 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0163 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0164 114       Last Cost
     C                     Z-ADD*ZERO     WN0165 112       Value of On Han
     C                     MOVEL*BLANK    WN0166  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOHGCD           Item Code
     C                     KFLD           WOAJCD           Warehouse Code
     C                     KFLD           WOELDT           Production Date
      * Setup key
     C                     Z-ADDWJAIC3    WOAIC3           Company Number
     C                     Z-ADDWJHGCD    WOHGCD           Item Code
     C                     MOVELWJAJCD    WOAJCD           Warehouse Code
     C                     Z-ADDWMELDT    WOELDT           Production Date
      * Establish starting position
     C           KRSSV     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
      * CASE: PAR.Quantity based on U/M1 S EQ WRK.ZERO
     C           WN0143    IFEQ WUW0NB                     *IF
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWJAIC3    WL0096           Company Number
     C                     Z-ADDWJHGCD    WL0097           Item Code
     C                     MOVELWJAJCD    WL0098    P      Warehouse Code
     C                     Z-ADDWMELDT    WL0099           Production Date
     C                     Z-ADD*ZERO     WL0100           Physical Count
     C                     Z-ADD*ZERO     WL0101           Physical Count
     C                     Z-ADD*ZERO     WL0102           Physical Count
     C                     Z-ADD*ZERO     WL0103           Physical Count
     C                     MOVEL*BLANK    WL0104           Physical Count
     C                     Z-ADD*ZERO     WL0105           Quantity on Han
     C                     Z-ADDWN0143    WL0106           Quantity on Han
     C                     Z-ADD*ZERO     WL0107           Quantity on Han
     C                     Z-ADD*ZERO     WL0108           Quantity on Han
     C                     Z-ADD*ZERO     WL0109           Quantity In Chi
     C                     Z-ADD*ZERO     WL0110           Weight In Chill
     C                     MOVEL'N'       WL0111    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0112           Physical Start
     C                     Z-ADD*ZERO     WL0113           Physical Start
     C                     Z-ADD*ZERO     WL0114           Physical Start
     C                     Z-ADD*ZERO     WL0115           Physical Start
     C                     Z-ADD*ZERO     WL0116           Physical Start
     C                     Z-ADD*ZERO     WL0117           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0118           Last Cost
     C                     Z-ADD*ZERO     WL0119           Value of On Han
     C                     Z-ADDWMK7DT    WL0120           Label Date
     C                     Z-ADDWJRINB    WL0121           Item Structure
     C                     Z-ADDWJRHNB    WL0122           Item Structure
     C                     Z-ADDWJRGNB    WL0123           Item Structure
     C                     MOVEL*BLANK    WL0124           EDI Status 1
     C                     MOVEL*BLANK    WL0125           EDI Status 2
     C                     MOVEL*BLANK    WL0126           EDI Status 3
     C                     MOVEL'A'       WL0127    P      Record Status
     C                     EXSR SICRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWJAIC3    WL0096           Company Number
     C                     Z-ADDWJHGCD    WL0097           Item Code
     C                     MOVELWJAJCD    WL0098    P      Warehouse Code
     C                     Z-ADDWMELDT    WL0099           Production Date
     C                     Z-ADD*ZERO     WL0100           Physical Count
     C                     Z-ADD*ZERO     WL0101           Physical Count
     C                     Z-ADD*ZERO     WL0102           Physical Count
     C                     Z-ADD*ZERO     WL0103           Physical Count
     C                     MOVEL*BLANK    WL0104           Physical Count
     C                     Z-ADDWMAHWG    WL0105           Quantity on Han
     C                     Z-ADDWN0143    WL0106           Quantity on Han
     C                     Z-ADD*ZERO     WL0107           Quantity on Han
     C                     Z-ADD*ZERO     WL0108           Quantity on Han
     C                     Z-ADD*ZERO     WL0109           Quantity In Chi
     C                     Z-ADD*ZERO     WL0110           Weight In Chill
     C                     MOVEL'N'       WL0111    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0112           Physical Start
     C                     Z-ADD*ZERO     WL0113           Physical Start
     C                     Z-ADD*ZERO     WL0114           Physical Start
     C                     Z-ADD*ZERO     WL0115           Physical Start
     C                     Z-ADD*ZERO     WL0116           Physical Start
     C                     Z-ADD*ZERO     WL0117           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0118           Last Cost
     C                     Z-ADDWMAYVA    WL0119           Value of On Han
     C                     Z-ADDWMK7DT    WL0120           Label Date
     C                     Z-ADDWJRINB    WL0121           Item Structure
     C                     Z-ADDWJRHNB    WL0122           Item Structure
     C                     Z-ADDWJRGNB    WL0123           Item Structure
     C                     MOVEL*BLANK    WL0124           EDI Status 1
     C                     MOVEL*BLANK    WL0125           EDI Status 2
     C                     MOVEL*BLANK    WL0126           EDI Status 3
     C                     MOVEL'A'       WL0127    P      Record Status
     C                     EXSR SICRRC
     C                     END                             *FI
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Calculate new On Hand Value
      * CASE: PAR.Inventory Trans. Type is Adjustment Cycle Count
     C           WMBSST    IFEQ 'AC'                       *IF
     C           WOIDVA    ADD  WMAYVA    WN0165           Value of On Han
     C                     ELSE
      * CASE: PAR.Inventory Trans. Type is Quantity based Avg. Cost
     C           WMBSST    IFEQ 'R'                        *IF
     C           WMBSST    OREQ 'RP'
     C           WMBSST    OREQ 'S'
     C           WMBSST    OREQ 'TW'
     C           WMBSST    OREQ 'RW'
     C           WMBSST    OREQ 'RR'
     C           WOIDVA    ADD  WMAYVA    WN0165           Value of On Han
     C                     END                             *FI
     C                     END                             *FI
     C           WMAHWG    ADD  WOACWG    WN0159           Quantity on Han
     C           WOARQT    ADD  WN0143    WN0160           Quantity on Han
      * If quantity goes TO exactly 0, wgt and value to go 0
      * CASE: PAR.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WN0160    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - IC Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WOAIC3    WQ0065  30       Company Number
     C                     PARM WOHGCD    WQ0066  70       Item Code
     C                     PARM WOAJCD    WQ0067  3        Warehouse Code
     C                     PARM WMB4DT    WQ0068  70       Transaction Dat
     C                     PARM WOELDT    WQ0069  70       Production Date
     C                     PARM WMHVCD    WQ0070  2        UOM Transaction
     C                     PARM WN0159    WQ0071 112       Transaction Wei
     C                     PARM WN0163    WQ0072 114       USR Transaction
     C                     PARM WMCGCD    WQ0073  2        UOM Cost
     C                     PARM WORINB    WQ0074  30       Item Structure
     C                     PARM WORHNB    WQ0075  30       Item Structure
     C                     PARM WORGNB    WQ0076  30       Item Structure
     C                     PARM WL0262    WQ0077  1        Shift Number
     C                     PARM WOK7DT    WQ0078  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WN0159           Quantity on Han
     C                     Z-ADD*ZERO     WN0165           Value of On Han
     C                     END                             *FI
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWOAJCD    WL0128    P      Warehouse Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0129    WN0166    P      Lot Tracking Fl
      * CASE: Qty = 0 & production date <> 0 & Lot Trk=N
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Quantity on Hand - U/M1 EQ WRK.ZERO
      *   |- c2    : DB1.Production Date NE WRK.ZERO
      *   |- c3    : PAR.Lot Tracking Flag is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0160    IFEQ WUW0NB                     *IF
     C           WOELDT    IFNE WUW0NB                     *IF
     C           WN0166    IFEQ *BLANK                     *IF
     C           WN0166    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Dlt Item Bal. Detail   DL - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0130           Company Number
     C                     Z-ADDWOHGCD    WL0131           Item Code
     C                     MOVELWOAJCD    WL0132    P      Warehouse Code
     C                     Z-ADDWOELDT    WL0133           Production Date
     C                     EXSR SKDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
     C                     EXSR SWCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0167  70       Label Date
     C                     MOVEL*BLANK    WN0168  1        EDI Status 1
     C                     MOVEL*BLANK    WN0169  1        EDI Status 2
     C                     MOVEL*BLANK    WN0170  1        EDI Status 3
     C                     MOVEL*BLANK    WN0171  1        Record Status
     C                     Z-ADD*ZERO     WN0172  60       Job Time
     C                     MOVEL*BLANK    WN0173 10        User Id
     C                     MOVEL*BLANK    WN0174 10        Job Name
     C                     Z-ADD*ZERO     WN0175  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWOAIC3    WGAIC3           Company Number
     C                     Z-ADDWOHGCD    WGHGCD           Item Code
     C                     MOVELWOAJCD    WGAJCD    P      Warehouse Code
     C                     Z-ADDWOELDT    WGELDT           Production Date
      *
     C           KLCHSW    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
     C           KLCHSW    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YDRDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWOABWG    WGABWG           Physical Count
     C                     Z-ADDWOAGQT    WGAGQT           Physical Count
     C                     Z-ADDWOAHQT    WGAHQT           Physical Count
     C                     Z-ADDWOAIQT    WGAIQT           Physical Count
     C                     MOVELWOCTST    WGCTST    P      Physical Count
     C                     Z-ADDWN0159    WGACWG           Quantity on Han
     C                     Z-ADDWN0160    WGARQT           Quantity on Han
     C                     Z-ADDWOASQT    WGASQT           Quantity on Han
     C                     Z-ADDWOATQT    WGATQT           Quantity on Han
     C                     Z-ADDWOHDQT    WGHDQT           Quantity In Chi
     C                     Z-ADDWOHEQT    WGHEQT           Weight In Chill
     C                     MOVELWOF6ST    WGF6ST    P      Update Exceptio
     C                     Z-ADDWOBMWG    WGBMWG           Physical Start
     C                     Z-ADDWODSQT    WGDSQT           Physical Start
     C                     Z-ADDWODTQT    WGDTQT           Physical Start
     C                     Z-ADDWODUQT    WGDUQT           Physical Start
     C                     Z-ADDWODHDT    WGDHDT           Physical Start
     C                     Z-ADDWOAGCS    WGAGCS           Unit Cost Per P
     C                     Z-ADDWOAECS    WGAECS           Last Cost
     C                     Z-ADDWN0165    WGIDVA           Value of On Han
     C                     Z-ADDWORINB    WGRINB           Item Structure
     C                     Z-ADDWORHNB    WGRHNB           Item Structure
     C                     Z-ADDWORGNB    WGRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C                     MOVEL##PGM     WGA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WRDOCD           System Value Co
      * Setup key
     C                     MOVEL@CN,003   WRDOCD           System Value Co
      * Establish starting position
     C           KRSSX     CHAIN@DPRETD              90    *
      * Data record not found
     C   90                MOVEL'USR0759' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWRM8NB    YL0017           System Value Nu
     C                     GOTO SXEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Reset Production/Label Date if Lot Tracking warehouse.
      *================================================================
     C                     Z-ADDP1ELDT    WN0014           Production Date
     C                     Z-ADDP1K7DT    WN0015           Label Date  USR
      * Determine the Lot Tracking Flag for From Warehouse.
      * If the From Warehouse Lot Tracking Flag is "N", then perform the
      * following "Clc" to determine if the To Warehouse Lot Tracking
      * Flag is "Y" and replace the Production Date with Job Date if it
      * is "Y".
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1A5QT           Transaction Qua
     C                     Z-ADD*ZERO     P1AHWG           Transaction Wei
     C                     Z-ADD*ZERO     P1TRBN           Transfer Batch
     C                     Z-ADD*ZERO     P1TRBS           Transfer Batch
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2ADCD           UOM Primary
     C                     Z-ADD*ZERO     P2AWPC           Conversion Fact
     C                     MOVEL*BLANK    P2LXST           Operation Facto
     C                     MOVEL*BLANK    P2AECD           UOM Second
     C                     Z-ADD*ZERO     P2AXPC           Conversion Fact
     C                     MOVEL*BLANK    P2LYST           Operation Facto
     C                     MOVEL*BLANK    P2AFCD           UOM Third
     C                     MOVEL*BLANK    P2AICD           UOM Pricing
     C                     Z-ADD*ZERO     P2AIWG           Unit Weight
     C                     MOVEL*BLANK    P2FZST           Production Date
     C                     MOVEL*BLANK    P2AVST           Catch Weight St
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P6AGCS           Unit Cost Per P
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P7ARCS           Unit Cost - Det
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           Production Lead
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WAILNB           Packages per ca
     C                     Z-ADD*ZERO     WACHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           Package Level s
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           FP Std Green We
     C                     Z-ADD*ZERO     WACWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAECS           Last Cost
     C                     Z-ADD*ZERO     WBBACS           Cost per Primar
     C                     Z-ADD*ZERO     WBBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WBCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WBGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WBCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WBG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WBBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WBDDQT           On Hand UOM1 Su
     C                     Z-ADD*ZERO     WBDEQT           On Hand UOM2 Su
     C                     Z-ADD*ZERO     WBDFQT           On Hand UOM3 Su
     C                     Z-ADD*ZERO     WBHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WBHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WBAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WBAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WBEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WBDOQT           Quantity Avail
     C                     Z-ADD*ZERO     WBAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WBANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WBIDVA           Value of On Han
     C                     Z-ADD*ZERO     WBBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WBDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WBDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WBBFDY           Lead Time Last
     C                     Z-ADD*ZERO     WBDJDT           Lead Time Date
     C                     Z-ADD*ZERO     WBBGDY           Lead Time Next
     C                     Z-ADD*ZERO     WBDKDT           Lead Time Date
     C                     Z-ADD*ZERO     WBDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WBBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WBDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WBDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WBDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WBDMDT           Last Physical C
     C                     Z-ADD*ZERO     WBAKC8           Vendor Item_Whs
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Load ID
     C                     Z-ADD*ZERO     WURMNB  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCANC7           AR Customer Num
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WCA1WG           Order Weight To
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCVRVA           A/R order Value
     C                     Z-ADD*ZERO     WCB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WCNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WCNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WCNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WCNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WCNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WCBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WCBQTM           Time of Origina
     C                     Z-ADD*ZERO     WCBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WCBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WCBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WCH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WCH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WCH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WCH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WCH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Lot Number USR
     C                     Z-ADD*ZERO     WULTNT  50
      * Define work field Lot Number
     C                     Z-ADD*ZERO     WULXNM  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHUNZ           Release Number
     C                     MOVE '0'       XDTSDL 26 P
     C                     MOVEL@CN,001   XDTSDL
     C                     MOVELXDTSDL    WDBGTS           Create Date Tim
     C                     MOVELXDTSDL    WDBHTS           Update Date Tim
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Transaction Weight
     C                     Z-ADD*ZERO     WUAHWG 112
      * Define work field Transaction Quantity
     C                     Z-ADD*ZERO     WUA5QT 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WEC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WEDXNB           Sequence Number
     C                     Z-ADD*ZERO     WEELDT           Production Date
     C                     Z-ADD*ZERO     WEA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WEAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WEAKCS           USR Transaction
     C                     Z-ADD*ZERO     WEAYVA           Extended Amount
     C                     Z-ADD*ZERO     WECKNB           GL Document Num
     C                     Z-ADD*ZERO     WETRBN           Transfer Batch
     C                     Z-ADD*ZERO     WETRBS           Transfer Batch
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WEAWTM           Production Time
     C                     Z-ADD*ZERO     WEK7DT           Label Date
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Clear all neither parameters
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGELDT           Production Date
     C                     Z-ADD*ZERO     WGABWG           Physical Count
     C                     Z-ADD*ZERO     WGAGQT           Physical Count
     C                     Z-ADD*ZERO     WGAHQT           Physical Count
     C                     Z-ADD*ZERO     WGAIQT           Physical Count
     C                     Z-ADD*ZERO     WGACWG           Quantity on Han
     C                     Z-ADD*ZERO     WGARQT           Quantity on Han
     C                     Z-ADD*ZERO     WGASQT           Quantity on Han
     C                     Z-ADD*ZERO     WGATQT           Quantity on Han
     C                     Z-ADD*ZERO     WGHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WGHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WGBMWG           Physical Start
     C                     Z-ADD*ZERO     WGDSQT           Physical Start
     C                     Z-ADD*ZERO     WGDTQT           Physical Start
     C                     Z-ADD*ZERO     WGDUQT           Physical Start
     C                     Z-ADD*ZERO     WGDHDT           Physical Start
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAECS           Last Cost
     C                     Z-ADD*ZERO     WGIDVA           Value of On Han
     C                     Z-ADD*ZERO     WGK7DT           Label Date
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WHBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WHBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WHBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WHBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Location Code
     C                     MOVEL*BLANK    WUYMCD  4
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKLCBY           Location Bay
     C                     Z-ADD*ZERO     WKLCCT           Loc Unused Chil
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Location Level
     C                     Z-ADD*ZERO     WUYNCD  20
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field EDI Status 2
     C                     MOVEL*BLANK    WUUWST  1
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Clear all neither parameters
      * Crt Item Balance       CR - Item Balance  * 
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field UOM Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Define work field Value of On Hand Inventor
     C                     Z-ADD*ZERO     WUIDVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRM8NB           System Value Nu
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004 30
     C                     MOVEL*BLANK    WL0005  2
     C                     Z-ADD*ZERO     WL0006  94
     C                     MOVEL*BLANK    WL0007  1
     C                     MOVEL*BLANK    WL0008  2
     C                     Z-ADD*ZERO     WL0009  94
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  2
     C                     MOVEL*BLANK    WL0012  2
     C                     Z-ADD*ZERO     WL0013 112
     C                     MOVEL*BLANK    WL0014  1
     C                     MOVEL*BLANK    WL0015  1
     C                     Z-ADD*ZERO     WL0016  52
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  70
     C                     MOVEL*BLANK    WL0019  3
     C                     Z-ADD*ZERO     WL0020 114
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023  30
     C                     Z-ADD*ZERO     WL0024  30
     C                     Z-ADD*ZERO     WL0025  30
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0026  30
     C                     Z-ADD*ZERO     WL0027  70
     C                     MOVEL*BLANK    WL0028  3
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  2
     C                     Z-ADD*ZERO     WL0031  70
     C                     Z-ADD*ZERO     WL0032  50
      * Define local variables for subroutine SGCRRC.
     C                     Z-ADD*ZERO     WL0033  30
     C                     Z-ADD*ZERO     WL0034  70
     C                     MOVEL*BLANK    WL0035  3
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037  2
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039  50
     C                     Z-ADD*ZERO     WL0040  30
     C                     Z-ADD*ZERO     WL0041  70
     C                     MOVEL*BLANK    WL0042  2
     C                     MOVEL*BLANK    WL0043  2
     C                     MOVEL*BLANK    WL0044 30
     C                     Z-ADD*ZERO     WL0045 112
     C                     Z-ADD*ZERO     WL0046 112
     C                     Z-ADD*ZERO     WL0047 114
     C                     MOVEL*BLANK    WL0048  2
     C                     Z-ADD*ZERO     WL0049 112
     C                     MOVEL*BLANK    WL0050  6
     C                     Z-ADD*ZERO     WL0051  80
     C                     MOVEL*BLANK    WL0052  1
     C                     MOVEL*BLANK    WL0053  3
     C                     MOVEL*BLANK    WL0054 15
     C                     MOVEL*BLANK    WL0055 10
     C                     Z-ADD*ZERO     WL0056  70
     C                     Z-ADD*ZERO     WL0057  30
     C                     Z-ADD*ZERO     WL0058  70
     C                     Z-ADD*ZERO     WL0059  30
     C                     Z-ADD*ZERO     WL0060  30
     C                     Z-ADD*ZERO     WL0061  30
     C                     MOVEL*BLANK    WL0062 10
     C                     Z-ADD*ZERO     WL0063  60
     C                     MOVEL*BLANK    WL0064  1
     C                     Z-ADD*ZERO     WL0065  70
     C                     MOVEL*BLANK    WL0066  1
     C                     MOVEL*BLANK    WL0067  1
     C                     MOVEL*BLANK    WL0068  1
     C                     MOVEL*BLANK    WL0069  1
      * Define local variables for subroutine SHCHRC.
     C                     Z-ADD*ZERO     WL0070  30
     C                     Z-ADD*ZERO     WL0071  70
     C                     MOVEL*BLANK    WL0072  3
     C                     Z-ADD*ZERO     WL0073  70
     C                     Z-ADD*ZERO     WL0074  30
     C                     Z-ADD*ZERO     WL0075  30
     C                     Z-ADD*ZERO     WL0076  30
     C                     MOVEL*BLANK    WL0077  2
     C                     Z-ADD*ZERO     WL0078  94
     C                     MOVEL*BLANK    WL0079  1
     C                     MOVEL*BLANK    WL0080  2
     C                     Z-ADD*ZERO     WL0081  94
     C                     MOVEL*BLANK    WL0082  1
     C                     MOVEL*BLANK    WL0083  2
     C                     MOVEL*BLANK    WL0084  1
     C                     MOVEL*BLANK    WL0085  1
     C                     MOVEL*BLANK    WL0086  1
     C                     MOVEL*BLANK    WL0087  2
     C                     Z-ADD*ZERO     WL0088  70
     C                     MOVEL*BLANK    WL0089  2
     C                     Z-ADD*ZERO     WL0090 112
     C                     Z-ADD*ZERO     WL0091 112
     C                     Z-ADD*ZERO     WL0092 114
     C                     MOVEL*BLANK    WL0093  2
     C                     Z-ADD*ZERO     WL0094 112
     C                     Z-ADD*ZERO     WL0095  70
      * Define local variables for subroutine SICRRC.
     C                     Z-ADD*ZERO     WL0096  30
     C                     Z-ADD*ZERO     WL0097  70
     C                     MOVEL*BLANK    WL0098  3
     C                     Z-ADD*ZERO     WL0099  70
     C                     Z-ADD*ZERO     WL0100 112
     C                     Z-ADD*ZERO     WL0101 112
     C                     Z-ADD*ZERO     WL0102 112
     C                     Z-ADD*ZERO     WL0103 112
     C                     MOVEL*BLANK    WL0104  1
     C                     Z-ADD*ZERO     WL0105 112
     C                     Z-ADD*ZERO     WL0106 112
     C                     Z-ADD*ZERO     WL0107 112
     C                     Z-ADD*ZERO     WL0108 112
     C                     Z-ADD*ZERO     WL0109 112
     C                     Z-ADD*ZERO     WL0110 112
     C                     MOVEL*BLANK    WL0111  1
     C                     Z-ADD*ZERO     WL0112 112
     C                     Z-ADD*ZERO     WL0113 112
     C                     Z-ADD*ZERO     WL0114 112
     C                     Z-ADD*ZERO     WL0115 112
     C                     Z-ADD*ZERO     WL0116  70
     C                     Z-ADD*ZERO     WL0117 114
     C                     Z-ADD*ZERO     WL0118 114
     C                     Z-ADD*ZERO     WL0119 112
     C                     Z-ADD*ZERO     WL0120  70
     C                     Z-ADD*ZERO     WL0121  30
     C                     Z-ADD*ZERO     WL0122  30
     C                     Z-ADD*ZERO     WL0123  30
     C                     MOVEL*BLANK    WL0124  1
     C                     MOVEL*BLANK    WL0125  1
     C                     MOVEL*BLANK    WL0126  1
     C                     MOVEL*BLANK    WL0127  1
      * Define local variables for subroutine SJRVGN.
     C                     MOVEL*BLANK    WL0128  3
     C                     MOVEL*BLANK    WL0129  1
      * Define local variables for subroutine SKDLRC.
     C                     Z-ADD*ZERO     WL0130  30
     C                     Z-ADD*ZERO     WL0131  70
     C                     MOVEL*BLANK    WL0132  3
     C                     Z-ADD*ZERO     WL0133  70
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0134  30
     C                     Z-ADD*ZERO     WL0135  70
     C                     MOVEL*BLANK    WL0136  3
     C                     Z-ADD*ZERO     WL0137 112
     C                     Z-ADD*ZERO     WL0138 112
     C                     Z-ADD*ZERO     WL0139 112
     C                     Z-ADD*ZERO     WL0140 112
     C                     Z-ADD*ZERO     WL0141 112
      * Define local variables for subroutine SMCHRC.
     C                     Z-ADD*ZERO     WL0142  30
     C                     Z-ADD*ZERO     WL0143  70
     C                     MOVEL*BLANK    WL0144  3
     C                     Z-ADD*ZERO     WL0145 112
     C                     Z-ADD*ZERO     WL0146 112
     C                     Z-ADD*ZERO     WL0147 112
      * Define local variables for subroutine SNRVGN.
     C                     MOVEL*BLANK    WL0148  3
     C                     MOVEL*BLANK    WL0149 30
     C                     MOVEL*BLANK    WL0150 30
     C                     MOVEL*BLANK    WL0151 30
     C                     MOVEL*BLANK    WL0152 30
     C                     MOVEL*BLANK    WL0153 20
     C                     MOVEL*BLANK    WL0154 11
     C                     MOVEL*BLANK    WL0155  3
     C                     MOVEL*BLANK    WL0156  2
     C                     MOVEL*BLANK    WL0157  1
     C                     MOVEL*BLANK    WL0158 10
     C                     MOVEL*BLANK    WL0159  2
     C                     MOVEL*BLANK    WL0160  1
     C                     MOVEL*BLANK    WL0161  1
     C                     MOVEL*BLANK    WL0162  1
     C                     Z-ADD*ZERO     WL0163  52
     C                     MOVEL*BLANK    WL0164  1
     C                     MOVEL*BLANK    WL0165  1
     C                     MOVEL*BLANK    WL0166  1
     C                     MOVEL*BLANK    WL0167  1
     C                     Z-ADD*ZERO     WL0168  30
     C                     Z-ADD*ZERO     WL0169  30
     C                     Z-ADD*ZERO     WL0170  30
     C                     Z-ADD*ZERO     WL0171  30
     C                     MOVEL*BLANK    WL0172  3
     C                     MOVEL*BLANK    WL0173  1
     C                     MOVEL*BLANK    WL0174  1
     C                     MOVEL*BLANK    WL0175  1
     C                     MOVEL*BLANK    WL0176  1
     C                     MOVEL*BLANK    WL0177  2
     C                     MOVEL*BLANK    WL0178  2
     C                     MOVEL*BLANK    WL0179  3
     C                     MOVEL*BLANK    WL0180  3
     C                     MOVEL*BLANK    WL0181  3
     C                     MOVEL*BLANK    WL0182  1
     C                     MOVEL*BLANK    WL0183  1
     C                     MOVEL*BLANK    WL0184  1
     C                     MOVEL*BLANK    WL0185  1
     C                     Z-ADD*ZERO     WL0186  60
     C                     MOVEL*BLANK    WL0187 10
     C                     MOVEL*BLANK    WL0188 10
     C                     Z-ADD*ZERO     WL0189  70
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0190  3
     C                     MOVEL*BLANK    WL0191  4
     C                     MOVEL*BLANK    WL0192  2
     C                     Z-ADD*ZERO     WL0193  20
     C                     Z-ADD*ZERO     WL0194  52
      * Define local variables for subroutine SPRVGN.
     C                     MOVEL*BLANK    WL0195  3
     C                     Z-ADD*ZERO     WL0196  30
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0197  30
     C                     Z-ADD*ZERO     WL0198  70
     C                     MOVEL*BLANK    WL0199  3
      * Define local variables for subroutine SRCRRC.
     C                     Z-ADD*ZERO     WL0200  30
     C                     Z-ADD*ZERO     WL0201  70
     C                     MOVEL*BLANK    WL0202  3
     C                     Z-ADD*ZERO     WL0203 114
     C                     Z-ADD*ZERO     WL0204 114
     C                     Z-ADD*ZERO     WL0205 114
     C                     Z-ADD*ZERO     WL0206 114
     C                     Z-ADD*ZERO     WL0207 114
     C                     Z-ADD*ZERO     WL0208  70
     C                     MOVEL*BLANK    WL0209  1
     C                     Z-ADD*ZERO     WL0210 114
     C                     Z-ADD*ZERO     WL0211  70
     C                     Z-ADD*ZERO     WL0212 112
     C                     Z-ADD*ZERO     WL0213 112
     C                     Z-ADD*ZERO     WL0214 112
     C                     Z-ADD*ZERO     WL0215 112
     C                     Z-ADD*ZERO     WL0216 112
     C                     Z-ADD*ZERO     WL0217 112
     C                     Z-ADD*ZERO     WL0218 112
     C                     Z-ADD*ZERO     WL0219 112
     C                     Z-ADD*ZERO     WL0220 112
     C                     Z-ADD*ZERO     WL0221 112
     C                     Z-ADD*ZERO     WL0222 112
     C                     MOVEL*BLANK    WL0223  3
     C                     Z-ADD*ZERO     WL0224  70
     C                     Z-ADD*ZERO     WL0225  70
     C                     Z-ADD*ZERO     WL0226 112
     C                     MOVEL*BLANK    WL0227  1
     C                     Z-ADD*ZERO     WL0228  52
     C                     Z-ADD*ZERO     WL0229 112
     C                     Z-ADD*ZERO     WL0230  70
     C                     MOVEL*BLANK    WL0231  3
     C                     Z-ADD*ZERO     WL0232  30
     C                     Z-ADD*ZERO     WL0233  70
     C                     Z-ADD*ZERO     WL0234  30
     C                     Z-ADD*ZERO     WL0235  70
     C                     MOVEL*BLANK    WL0236  1
     C                     Z-ADD*ZERO     WL0237 112
     C                     Z-ADD*ZERO     WL0238 112
     C                     Z-ADD*ZERO     WL0239  70
     C                     Z-ADD*ZERO     WL0240 112
     C                     Z-ADD*ZERO     WL0241 112
     C                     Z-ADD*ZERO     WL0242  70
     C                     MOVEL*BLANK    WL0243  1
     C                     MOVEL*BLANK    WL0244  1
     C                     MOVEL*BLANK    WL0245  1
     C                     Z-ADD*ZERO     WL0246  80
     C                     Z-ADD*ZERO     WL0247  30
     C                     Z-ADD*ZERO     WL0248  30
     C                     Z-ADD*ZERO     WL0249  30
     C                     MOVEL*BLANK    WL0250  1
     C                     MOVEL*BLANK    WL0251  1
     C                     MOVEL*BLANK    WL0252  1
     C                     MOVEL*BLANK    WL0253  1
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0254  30
     C                     Z-ADD*ZERO     WL0255  70
     C                     MOVEL*BLANK    WL0256  3
     C                     MOVEL*BLANK    WL0257  1
     C                     MOVEL*BLANK    WL0258  2
     C                     Z-ADD*ZERO     WL0259  70
     C                     Z-ADD*ZERO     WL0260  50
     C                     Z-ADD*ZERO     WL0261  30
     C                     MOVEL*BLANK    WL0262  1
     C                     Z-ADD*ZERO     WL0263  70
      * Define local work field API was Called? U
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Inventory Updated USR
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Module Release Status
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Transaction Quantity
     C                     Z-ADD*ZERO     YL0004 112
      * Define local work field Transaction Weight
     C                     Z-ADD*ZERO     YL0005 112
      * Define null work field Warehouse Description
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0005 20
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0006 11
      * Define null work field Production Warehouse Code
     C                     MOVEL*BLANK    YN0007  3
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0008  2
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0006  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0009 10
      * Define null work field Warehouse Type
     C                     MOVEL*BLANK    YN0010  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0011  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0007  1
      * Define null work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YN0013  52
      * Define null work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field Default Manifest Copies
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field Default Load Sequence
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field WHS Slotting Limit Type
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field Shipping Company
     C                     Z-ADD*ZERO     YN0018  30
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0019  30
      * Define null work field WHS Sched Prod Max Days
     C                     Z-ADD*ZERO     YN0020  30
      * Define null work field WHS Inventory Chill Time
     C                     Z-ADD*ZERO     YN0021  30
      * Define null work field Parent Warehouse
     C                     MOVEL*BLANK    YN0022  3
      * Define null work field Default Shipping Whs
     C                     MOVEL*BLANK    YN0023  1
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0008  1
      * Define null work field WHS PFS Interface
     C                     MOVEL*BLANK    YN0024  1
      * Define null work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field WHS Default Load Type
     C                     MOVEL*BLANK    YN0026  2
      * Define null work field WHS TMS Planning Region
     C                     MOVEL*BLANK    YN0027  2
      * Define null work field Default Carrier Code
     C                     MOVEL*BLANK    YN0028  3
      * Define null work field Inventory Logic Version
     C                     MOVEL*BLANK    YN0029  3
      * Define null work field WHS Auto Inv Restoration
     C                     MOVEL*BLANK    YN0030  3
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0031  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0032  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0035  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0036 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0037 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0038  70
      * Define local work field Location Aisle
     C                     MOVEL*BLANK    YL0009  2
      * Define local work field Location Bay
     C                     Z-ADD*ZERO     YL0010  20
      * Define local work field Loc Unused Chill Time
     C                     Z-ADD*ZERO     YL0011  52
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0012  30
      * Define local work field API EccResult-MsgId U
     C                     MOVEL*BLANK    YL0013  7
      * Define local work field API EccResult-MsgDesc U
     C                     MOVEL*BLANK    YL0014 50
      * Define local work field API Request Key U
     C                     MOVEL*BLANK    YL0015 10
      * Define local work field API Name
     C                     MOVEL*BLANK    YL0016 45
      * Define local work field API Wait Time U
     C                     Z-ADD*ZERO     YL0017  50
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
00002 wim.ordershipping.invento
00003 APIWAITTME
00004 ECC0000
00005 TIMEOUT
00006 PUDLXFR
00007 PDL8DFR
00008 PNTKXFR
00009 PUEJXFR
00010 PNTWXFR
00011 PDMLDFR
