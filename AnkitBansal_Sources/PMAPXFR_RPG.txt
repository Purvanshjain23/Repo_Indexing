     H/TITLE Crt WF OrderProdRecs  XP  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJBADE
     H* Date          : 09/22/16  Time  : 11:02:54
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPMEUCPL1IF  E           K        DISK
      * RTV : WF OrderProd Schedule     Retrieval index
      *
     FOPBGWKLSIF  E           K        DISK
      * RSQ : Order Detail             Co/Whse/RqsDt/Itm,Sel A,E
      *
     FCABZREMGIF  E           K        DISK
      * RSQ : Company Item              PrmSch/Co/Item
      *
     FPDJIREL0IF  E           K        DISK
      * RTV : Item Category             Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPMEUCPL0UF  E           K        DISK                      A
      * UPD : WF OrderProd Schedule     Update index
      *
     E                    YDOW        7  1               *Days of week
     I@EUCPXS
      * WF OrderProd Schedule     Retrieval index
      * Renamed input format fields
     I              EUNINY                          WANINY
     I              EUKEAA                          WAKEAA
     I              EUCOC3                          WACOC3
     I              EUKDAA                          WAKDAA
     I              EUSPDT                          WASPDT
     I              EUVQDT                          WAVQDT
     I              EUAPST                          WAAPST
     I              EUEXC7                          WAEXC7
     I              EUNJNY                          WANJNY
     I              EUTUT1                          WATUT1
     I              EUNKNY                          WANKNY
     I              EUSODT                          WASODT
     I              EUNLNY                          WANLNY
     I              EUEYC7                          WAEYC7
     I              EUS1NA                          WAS1NA
     I              EUPIQT                          WAPIQT
     I              EUTWT1                          WATWT1
     I              EURINY                          WARINY
     I              EUTIDT                          WATIDT
     I              EUTJDT                          WATJDT
     I              EUTNDT                          WATNDT
     I              EUTODT                          WATODT
     I              EUOLST                          WAOLST
     I              EUPLAA                          WAPLAA
     I              EUVTNY                          WAVTNY
     I              EUOQST                          WAOQST
     I              EUOSST                          WAOSST
     I              EUICN6                          WAICN6
     I              EUS0CD                          WAS0CD
      *
     I@EUCPXR
      * WF OrderProd Schedule     Update index
      * Renamed input format fields
     I              EUNINY                          WBNINY
     I              EUKEAA                          WBKEAA
     I              EUCOC3                          WBCOC3
     I              EUKDAA                          WBKDAA
     I              EUSPDT                          WBSPDT
     I              EUVQDT                          WBVQDT
     I              EUAPST                          WBAPST
     I              EUEXC7                          WBEXC7
     I              EUNJNY                          WBNJNY
     I              EUTUT1                          WBTUT1
     I              EUNKNY                          WBNKNY
     I              EUSODT                          WBSODT
     I              EUNLNY                          WBNLNY
     I              EUEYC7                          WBEYC7
     I              EUS1NA                          WBS1NA
     I              EUPIQT                          WBPIQT
     I              EUTWT1                          WBTWT1
     I              EURINY                          WBRINY
     I              EUTIDT                          WBTIDT
     I              EUTJDT                          WBTJDT
     I              EUTNDT                          WBTNDT
     I              EUTODT                          WBTODT
     I              EUOLST                          WBOLST
     I              EUPLAA                          WBPLAA
     I              EUVTNY                          WBVTNY
     I              EUOQST                          WBOQST
     I              EUOSST                          WBOSST
     I              EUICN6                          WBICN6
     I              EUS0CD                          WBS0CD
      *
     I@BGWKU4
      * Order Detail             Co/Whse/RqsDt/Itm,Sel A,E
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@BZRENZ
      * Company Item              PrmSch/Co/Item
      * Renamed input format fields
     I              BZAIC3                          WDAIC3
     I              BZHGCD                          WDHGCD
     I              BZAVNA                          WDAVNA
     I              BZAWNA                          WDAWNA
     I              BZL7NA                          WDL7NA
     I              BZL8NA                          WDL8NA
     I              BZL6NA                          WDL6NA
     I              BZMFNA                          WDMFNA
     I              BZADCD                          WDADCD
     I              BZAWPC                          WDAWPC
     I              BZLXST                          WDLXST
     I              BZAECD                          WDAECD
     I              BZAXPC                          WDAXPC
     I              BZLYST                          WDLYST
     I              BZAFCD                          WDAFCD
     I              BZAICD                          WDAICD
     I              BZAIWG                          WDAIWG
     I              BZHICD                          WDHICD
     I              BZRBCD                          WDRBCD
     I              BZFZST                          WDFZST
     I              BZAVST                          WDAVST
     I              BZCZWG                          WDCZWG
     I              BZC0WG                          WDC0WG
     I              BZURTN                          WDURTN
     I              BZAJC8                          WDAJC8
     I              BZRINB                          WDRINB
     I              BZRHNB                          WDRHNB
     I              BZRGNB                          WDRGNB
     I              BZLNCD                          WDLNCD
     I              BZTFNB                          WDTFNB
     I              BZN0CD                          WDN0CD
     I              BZX4ST                          WDX4ST
     I              BZTMVA                          WDTMVA
     I              BZTNVA                          WDTNVA
     I              BZBLPR                          WDBLPR
     I              BZBMPR                          WDBMPR
     I              BZLRCD                          WDLRCD
     I              BZU9ST                          WDU9ST
     I              BZCMCO                          WDCMCO
     I              BZQ1CD                          WDQ1CD
     I              BZQ8CD                          WDQ8CD
     I              BZCHTM                          WDCHTM
     I              BZQZCD                          WDQZCD
     I              BZXWST                          WDXWST
     I              BZXXST                          WDXXST
     I              BZVMST                          WDVMST
     I              BZSWGH                          WDSWGH
     I              BZPPHE                          WDPPHE
     I              BZR3CD                          WDR3CD
     I              BZSDCD                          WDSDCD
     I              BZICN1                          WDICN1
     I              BZSVCD                          WDSVCD
     I              BZICN2                          WDICN2
     I              BZSWCD                          WDSWCD
     I              BZV2NB                          WDV2NB
     I              BZSXCD                          WDSXCD
     I              BZITCN                          WDITCN
     I              BZSYCD                          WDSYCD
     I              BZITC5                          WDITC5
     I              BZSZCD                          WDSZCD
     I              BZICN6                          WDICN6
     I              BZS0CD                          WDS0CD
     I              BZICN7                          WDICN7
     I              BZS1CD                          WDS1CD
     I              BZICN8                          WDICN8
     I              BZS2CD                          WDS2CD
     I              BZICN9                          WDICN9
     I              BZS3CD                          WDS3CD
     I              BZICN0                          WDICN0
     I              BZS4CD                          WDS4CD
     I              BZSFNB                          WDSFNB
     I              BZA3WG                          WDA3WG
     I              BZSJNB                          WDSJNB
     I              BZLLCD                          WDLLCD
     I              BZLMCD                          WDLMCD
     I              BZP3ST                          WDP3ST
     I              BZSKNB                          WDSKNB
     I              BZSLNB                          WDSLNB
     I              BZSMNB                          WDSMNB
     I              BZP4ST                          WDP4ST
     I              BZCFNB                          WDCFNB
     I              BZCGNB                          WDCGNB
     I              BZILNB                          WDILNB
     I              BZCHNB                          WDCHNB
     I              BZCINB                          WDCINB
     I              BZCJNB                          WDCJNB
     I              BZCMNB                          WDCMNB
     I              BZCNNB                          WDCNNB
     I              BZCRNB                          WDCRNB
     I              BZCSNB                          WDCSNB
     I              BZCVNB                          WDCVNB
     I              BZCWNB                          WDCWNB
     I              BZCXNB                          WDCXNB
     I              BZCZNB                          WDCZNB
     I              BZC0NB                          WDC0NB
     I              BZN1CD                          WDN1CD
     I              BZB4NB                          WDB4NB
     I              BZB5NB                          WDB5NB
     I              BZX5ST                          WDX5ST
     I              BZX6ST                          WDX6ST
     I              BZX7ST                          WDX7ST
     I              BZPCCT                          WDPCCT
     I              BZBDNB                          WDBDNB
     I              BZBJNB                          WDBJNB
     I              BZSUST                          WDSUST
     I              BZSVST                          WDSVST
     I              BZSYST                          WDSYST
     I              BZSZST                          WDSZST
     I              BZS1ST                          WDS1ST
     I              BZXRCD                          WDXRCD
     I              BZXTCD                          WDXTCD
     I              BZXUCD                          WDXUCD
     I              BZF5WG                          WDF5WG
     I              BZF6WG                          WDF6WG
     I              BZF7WG                          WDF7WG
     I              BZBLNB                          WDBLNB
     I              BZBNNB                          WDBNNB
     I              BZS2ST                          WDS2ST
     I              BZS4ST                          WDS4ST
     I              BZS5ST                          WDS5ST
     I              BZS6ST                          WDS6ST
     I              BZS8ST                          WDS8ST
     I              BZS9ST                          WDS9ST
     I              BZTCST                          WDTCST
     I              BZTDST                          WDTDST
     I              BZUVST                          WDUVST
     I              BZUWST                          WDUWST
     I              BZUXST                          WDUXST
     I              BZVSST                          WDVSST
     I              BZAATM                          WDAATM
     I              BZAYNA                          WDAYNA
     I              BZA0NA                          WDA0NA
     I              BZAXDT                          WDAXDT
      *
     I@JIREXX
      * Item Category             Retrieval index
      * Renamed input format fields
     I              JIAIC3                          WEAIC3
     I              JIUSNB                          WEUSNB
     I              JISLCD                          WESLCD
     I              JIAUNA                          WEAUNA
     I              JIOHNX                          WEOHNX
     I              JICNAA                          WECNAA
     I              JIUVST                          WEUVST
     I              JIUWST                          WEUWST
     I              JIUXST                          WEUXST
     I              JIVSST                          WEVSST
     I              JIAATM                          WEAATM
     I              JIAYNA                          WEAYNA
     I              JIA0NA                          WEA0NA
     I              JIAXDT                          WEAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WGRMNB
     I              FJAIC3                          WGAIC3
     I              FJAODT                          WGAODT
     I              FJPJST                          WGPJST
     I              FJPKST                          WGPKST
     I              FJRNNB                          WGRNNB
     I              FJDMTX                          WGDMTX
     I              FJDNTX                          WGDNTX
     I              FJDOTX                          WGDOTX
     I              FJWTTX                          WGWTTX
     I              FJWUTX                          WGWUTX
     I              FJRPNB                          WGRPNB
     I              FJFLAM                          WGFLAM
     I              FJXQST                          WGXQST
     I              FJRRNB                          WGRRNB
     I              FJDXTX                          WGDXTX
     I              FJDYTX                          WGDYTX
     I              FJSBNB                          WGSBNB
     I              FJBZNA                          WGBZNA
     I              FJRONB                          WGRONB
     I              FJSQNB                          WGSQNB
     I              FJR1NB                          WGR1NB
     I              FJVCST                          WGVCST
     I              FJVDST                          WGVDST
     I              FJSDNB                          WGSDNB
     I              FJPAOU                          WGPAOU
     I              FJDGWG                          WGDGWG
     I              FJSXNB                          WGSXNB
     I              FJHADT                          WGHADT
     I              FJAART                          WGAART
     I              FJDHWG                          WGDHWG
     I              FJDIWG                          WGDIWG
     I              FJAQDT                          WGAQDT
     I              FJS6NB                          WGS6NB
     I              FJT4NB                          WGT4NB
     I              FJPRTM                          WGPRTM
     I              FJNPSV                          WGNPSV
     I              FJJ8TX                          WGJ8TX
     I              FJTLMI                          WGTLMI
     I              FJJ9TX                          WGJ9TX
     I              FJQ2CD                          WGQ2CD
     I              FJVPCD                          WGVPCD
     I              FJDBCD                          WGDBCD
     I              FJGRWE                          WGGRWE
     I              FJXCCD                          WGXCCD
     I              FJU2ST                          WGU2ST
     I              FJF9DT                          WGF9DT
     I              FJONTM                          WGONTM
     I              FJJ4DT                          WGJ4DT
     I              FJTRTM                          WGTRTM
     I              FJJ5DT                          WGJ5DT
     I              FJSPTM                          WGSPTM
     I              FJJ6DT                          WGJ6DT
     I              FJLFTM                          WGLFTM
     I              FJJ7DT                          WGJ7DT
     I              FJBOTM                          WGBOTM
     I              FJJ8DT                          WGJ8DT
     I              FJBLTM                          WGBLTM
     I              FJKIDT                          WGKIDT
     I              FJASTM                          WGASTM
     I              FJKADT                          WGKADT
     I              FJAJCM                          WGAJCM
     I              FJXACD                          WGXACD
     I              FJOANA                          WGOANA
     I              FJK4TX                          WGK4TX
     I              FJVOAG                          WGVOAG
     I              FJKBDT                          WGKBDT
     I              FJNBBO                          WGNBBO
     I              FJW4CD                          WGW4CD
     I              FJEFDT                          WGEFDT
     I              FJCNTN                          WGCNTN
     I              FJKCDT                          WGKCDT
     I              FJTMIN                          WGTMIN
     I              FJKDDT                          WGKDDT
     I              FJVMNB                          WGVMNB
     I              FJOCFR                          WGOCFR
     I              FJKJDT                          WGKJDT
     I              FJATTM                          WGATTM
     I              FJOTRS                          WGOTRS
     I              FJRNST                          WGRNST
     I              FJBRBK                          WGBRBK
     I              FJEIDT                          WGEIDT
     I              FJRMST                          WGRMST
     I              FJAJCD                          WGAJCD
     I              FJKKDT                          WGKKDT
     I              FJAVTM                          WGAVTM
     I              FJKZDT                          WGKZDT
     I              FJAXTM                          WGAXTM
     I              FJLHOS                          WGLHOS
     I              FJLHOR                          WGLHOR
     I              FJWNTX                          WGWNTX
     I              FJOITX                          WGOITX
     I              FJOJTX                          WGOJTX
     I              FJLLDT                          WGLLDT
     I              FJLSHG                          WGLSHG
     I              FJYPST                          WGYPST
     I              FJK0DT                          WGK0DT
     I              FJAYTM                          WGAYTM
     I              FJKNNX                          WGKNNX
     I              FJICWG                          WGICWG
     I              FJIDWG                          WGIDWG
     I              FJH9SX                          WGH9SX
     I              FJWOTX                          WGWOTX
     I              FJK1DT                          WGK1DT
     I              FJAZTM                          WGAZTM
     I              FJK2DT                          WGK2DT
     I              FJA0TM                          WGA0TM
     I              FJROST                          WGROST
     I              FJRPST                          WGRPST
     I              FJRQST                          WGRQST
     I              FJRRST                          WGRRST
     I              FJZBVA                          WGZBVA
     I              FJWPTX                          WGWPTX
     I              FJWQTX                          WGWQTX
     I              FJWRTX                          WGWRTX
     I              FJWSTX                          WGWSTX
     I              FJRVSX                          WGRVSX
     I              FJRUSX                          WGRUSX
     I              FJRWSX                          WGRWSX
     I              FJRXSX                          WGRXSX
     I              FJRYSX                          WGRYSX
     I              FJRZSX                          WGRZSX
     I              FJR0SX                          WGR0SX
     I              FJR1SX                          WGR1SX
     I              FJR2SX                          WGR2SX
     I              FJR3SX                          WGR3SX
     I              FJR4SX                          WGR4SX
     I              FJPYDT                          WGPYDT
     I              FJCKTM                          WGCKTM
     I              FJPZDT                          WGPZDT
     I              FJCLTM                          WGCLTM
     I              FJP0DT                          WGP0DT
     I              FJCMTM                          WGCMTM
     I              FJP1DT                          WGP1DT
     I              FJCNTM                          WGCNTM
     I              FJP2DT                          WGP2DT
     I              FJCOTM                          WGCOTM
     I              FJP3DT                          WGP3DT
     I              FJCQTM                          WGCQTM
     I              FJUVST                          WGUVST
     I              FJUWST                          WGUWST
     I              FJUXST                          WGUXST
     I              FJAATM                          WGAATM
     I              FJAYNA                          WGAYNA
     I              FJA0NA                          WGA0NA
     I              FJAXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPMEU1    E DSPMEUCPL0
      * UPD : WF OrderProd Schedule     Update index
      * Renamed input format fields
     I              EUNINY                          WBNINY
     I              EUKEAA                          WBKEAA
     I              EUCOC3                          WBCOC3
     I              EUKDAA                          WBKDAA
     I              EUSPDT                          WBSPDT
     I              EUVQDT                          WBVQDT
     I              EUAPST                          WBAPST
     I              EUEXC7                          WBEXC7
     I              EUNJNY                          WBNJNY
     I              EUTUT1                          WBTUT1
     I              EUNKNY                          WBNKNY
     I              EUSODT                          WBSODT
     I              EUNLNY                          WBNLNY
     I              EUEYC7                          WBEYC7
     I              EUS1NA                          WBS1NA
     I              EUPIQT                          WBPIQT
     I              EUTWT1                          WBTWT1
     I              EURINY                          WBRINY
     I              EUTIDT                          WBTIDT
     I              EUTJDT                          WBTJDT
     I              EUTNDT                          WBTNDT
     I              EUTODT                          WBTODT
     I              EUOLST                          WBOLST
     I              EUPLAA                          WBPLAA
     I              EUVTNY                          WBVTNY
     I              EUOQST                          WBOQST
     I              EUOSST                          WBOSST
     I              EUICN6                          WBICN6
     I              EUS0CD                          WBS0CD
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Warehouse Code
     I                                        3   5 P1AJCD
      * I :  Requested Ship Date
     I                                    P   6   90P1A5DT
     IP2PARM      DS
      * I :  Print HoldOvers Usr
     I                                        1   1 P2BLST
     IP3PARM      DS
      * B : MAP Next Production Day Usr
     I                                    P   1   40P3SRDT
     IP4PARM      DS
      * B : MAP Next Production Day Usr2
     I                                    P   1   40P4T3DT
     IP5PARM      DS
      * FLD: Item Category
      * I :  Item Category Code
     I                                        1   3 P5SLCD
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Requested Delv Date Error'
      * Requested Delivery Dt
     I                                    P   1   40ZA0001
      * Message data for 'Scheduled Ship Date Req'd'
      * Scheduled Ship Date
     I                                    P   1   40ZA0002
      * Message data for 'PrdDte Shipped BEF Made'
      * Production AgeDte Fr
     I                                    P   1   40ZA0003
      * Message data for 'Enter Age Days or Dates'
      * Item Age Days
     I                                    P   1   30ZA0004
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0005
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0006
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0007
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0008
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0009
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0010
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0011
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0012
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0013
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0014
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0015
      * Message data for 'Invalid Item Age Days'
      * Item Age Days
     I                                    P   1   30ZA0016
      * Message data for 'Invalid Prod OvrDates'
      * Production AgeDte Fr
     I                                    P   1   40ZA0017
      * Production AgeDte To
     I                                    P   5   80ZA0018
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1AJCD    PARM           WP0002  3        Warehouse Code
     C           P1A5DT    PARM           WP0003  70       Requested Ship
     C           P2BLST    PARM           WP0004  1        Print HoldOvers
     C           P3SRDT    PARM P3SRDT    WP0005  70       Next Production
     C           P4T3DT    PARM P4T3DT    WP0006  70       Next Production
     C           P5SLCD    PARM           WP0007  3        Item Category C
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Crt WF OrderProdRecs  XP
      * MODIFICATION HISTORY
     C                     EXSR UASUBR                     MODIFICATION HI
      * RtvDlt Wf OrderProdRecRT - WF OrderProd Schedule  * 
     C                     EXSR SARVGN
      * E3796 JJH 02/19/15 - Chg Scheduled Ship Date to Requested Ship Da
      * CASE: PAR.Print HoldOvers Usr is no
     C           P2BLST    IFEQ 'N'                        *IF
      * *do not select held overs do not go backwards in date selection
     C                     Z-ADDP1A5DT    WUSQDT           Prior Schedule
     C                     ELSE
      * CASE: *OTHERWISE
      * Go to the Calendar and get the >>>> date from 3 days ago
      * WRK.Prior Schedule Ship DteUs = PAR.Requested Ship Date + CON.-00
     C           P1A5DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-00000003 XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WUSQDT
     C                     ELSE
     C           XDINDT    SUB  1000000   WUSQDT
     C                     END
     C                     END                             *FI
      * E3796 JJH 02/19/15 - Chg Scheduled Ship Date to Requested Ship Da
      * CASE: PAR.Requested Ship Date LE JOB.*Job date
     C           P1A5DT    IFLE ##JDT                      *IF
      * CURRENT DATE GO GET NEXT PRODUCTION DATE
      * GET THE NEXT PRODUCTION DATE BASED ON THE REQUESTED SHIPPED DATE
      * Susan Review 1
      * PAR.Next Production Day Usr = PAR.Requested Ship Date + CON.1 *DA
     C           P1A5DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P3SRDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P3SRDT
     C                     END
      * PAR.Next Production Day Usr2 = PAR.Requested Ship Date + CON.2 *D
     C           P1A5DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD2         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P4T3DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P4T3DT
     C                     END
     C                     ELSE
      * CASE: PAR.Requested Ship Date GT JOB.*Job date
     C           P1A5DT    IFGT ##JDT                      *IF
      * USER HAS ENTERED THE NEXT PRODUCTION DATE DUE THEY HAVE ENTER IT
      * Susan Review 2
      * PAR.Next Production Day Usr = PAR.Requested Ship Date + CON.1 *DA
     C           P1A5DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P3SRDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P3SRDT
     C                     END
      * PAR.Next Production Day Usr2 = PAR.Requested Ship Date + CON.2 *D
     C           P1A5DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD2         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P4T3DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P4T3DT
     C                     END
      * CURRENT DATE GO GET NEXT PRODUCTION DATE
     C                     END                             *FI
     C                     END                             *FI
      * Susan Review 3
      * E3796 JJH 02/19/15 - Chg Scheduled Ship Date to Requested Ship Da
      *  Changed the following parameters
      *  I  Requested Ship Date     POS FLD  WRK Prior Schedule Ship DteU
      *  I  Date To             USR     FLD  PAR Requested Ship Date
      * Rtv PrimSchByGroup    RT - Order Detail  * 
     C                     EXSR SCRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RtvDlt Wf OrderProdRecRT - WF OrderProd Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@EUCPXS                    *
     C                     READ @EUCPXS                  90*
      * Data record not found
     C   90                MOVEL'USR4073' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt WF OrderProdRecs  DO - WF OrderProd Schedule  * 
     C                     EXSR SBDLRC
     C                     READ @EUCPXS                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * Dlt WF OrderProdRecs  DO - WF OrderProd Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EUCPXR
     C                     Z-ADDWANINY    WBNINY           OPS Sequence No
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBNINY           OPS Sequence No
     C           KLDLSB    CHAIN@EUCPXR              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMEUCPL0'MDACP
     C                     MOVEL'@EUCPXR' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EUCPXR                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv PrimSchByGroup    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WUBXSX           Record Created
      * Modification history
     C                     EXSR UBSUBR                     Modification hi
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCAJCD    WQSC02           Warehouse Code
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Warehouse Code
     C                     KFLD           WCA5DT           Requested Ship
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Warehouse Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSC01           Company Number
     C                     MOVELP1AJCD    WQSC02           Warehouse Code
     C                     Z-ADDWUSQDT    WCA5DT           Requested Ship
      * Establish starting position
     C           KPSSC     SETLL@BGWKU4                    *
     C           KRSSC     READE@BGWKU4                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'N'       YL0001           Record Selected
      * Susan Review Item and boxes
      * General information on Boxes, and Combo, and Snd to Carlisle
     C                     EXSR UESUBR                     General informa
      * Selection information for item and no boxes, snd to Carlisle no c
     C                     EXSR UFSUBR                     Selection infor
      * Logical view on the Order detail is only status of A or E
      * A=Avaiable or E=Entered
      * slm 11/06/08 User had addition changes
      * will use the same logical file but do not
      * send in any "E" records
      * CASE: LCL.Record Selected       USR is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * Susan Review invdiual order selection
      * E3796 JJH 02/19/15 - Scheduled Ship Date to Requested Ship Date
      * Based selection for flds from the order detail
      * CASE: Qty > 0, Status A, and le Par Requested ship date
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.Quantity Ordered is Greater than zero
      *   |- c2    : DB1.Detail Line Status is Available
      *   |- c3    : DB1.Requested Ship Date LE PAR.Next Production Day U
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCAVQT    IFGT 0                          *IF
     C           WCGMST    IFEQ 'A'                        *IF
     C           WCA5DT    IFLE P4T3DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * During balance new report found  the select should have been
      * on the schedule  order
      * Use Qty Order instead of Sch Quantity
      * use the 2day work ahead for more data to appear on report
     C                     MOVEL'Y'       YL0001           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0001           Record Selected
     C                     END                             *FI
     C                     END                             *FI
      * IF Record selected write out record
      * CASE: LCL.Record Selected       USR is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * Ready to write out work file
      * RTV Load ID/Cust/ReqDlvRT - Order Header TRG  * 
     C                     EXSR SFRVGN
      * CASE: LCL.Cancelled Flag USR is Yes
     C           YL0010    IFEQ 'Y'                        *IF
      * If canceled order do not create work record
     C                     MOVEL'N'       YL0001           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
      * If Load ID > 0, get DDT from Load Header; ELSE get from Order
      * CASE: LCL.Load ID is Entered
     C           YL0009    IFNE 0                          *IF
      * RTV SchSeqA#Deadline   RT - Load Header  * 
     C                     EXSR SGRVGN
      * If record not found, use values from current Order Detail record
      * CASE:
      *  - NOTc1
      *   |- c1    : PGM.*Return code is *Normal
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD0         YL0011           Schedule Sequen
     C                     Z-ADDWCNVDT    YL0012           Deadline Depart
     C                     Z-ADDWCBUTM    YL0013           Deadline Depart
     C                     END                             *FI
      * Set return code to *Normal to perform next step
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
      * If Load ID not Entered, use values from current Order Detail reco
     C                     Z-ADD0         YL0011           Schedule Sequen
     C                     Z-ADDWCNVDT    YL0012           Deadline Depart
     C                     Z-ADDWCBUTM    YL0013           Deadline Depart
     C                     END                             *FI
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Use Qty Order instead of Sch Quantity
      * Val Age Information   IF
     C                     MOVEL*BLANK    WUB8SX           Error Flag
     C                     MOVEL*BLANK    YL0016           Error Status
     C                     MOVEL*BLANK    WUKWTX           Error Reason De
     C                     MOVEL*BLANK    WUKXTX           Error Reason De
     C                     MOVEL*BLANK    WUKYTX           Error Reason De
     C                     MOVEL*BLANK    WUKZTX           Error Reason De
     C                     MOVEL*BLANK    WUTITX           Error Reason De
      * CASE: PAR.Company Organization is Seaboard
     C           'S'       IFEQ 'S'                        *IF
      * CASE: PAR.Requested Delivery Date is not entered
     C           YL0008    IFEQ 0                          *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  YL0008    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0001
      * Send message 'Requested Delv Date Error'
     C                     MOVEL'USR4329' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: PAR.Scheduled Ship Date is not entered
     C           WCAODT    IFEQ 0                          *IF
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  WCAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0002
      * Send message 'Scheduled Ship Date Req'd'
     C                     MOVEL'USR2230' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Age information   XF - Order Detail  * 
     C                     CALL 'PNQNXFR'              90  Val Age informa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCHGCD    WQ0001  70       Item Code
     C                     PARM WCAJCD    WQ0002  3        Warehouse Code
     C           WUB8SX    PARM WUB8SX    WQ0003  1        Error Flag
     C           WUKWTX    PARM WUKWTX    WQ0004 30        Error Reason De
     C           WUKXTX    PARM WUKXTX    WQ0005 30        Error Reason De
     C           WUKYTX    PARM WUKYTX    WQ0006 30        Error Reason De
     C           WUKZTX    PARM WUKZTX    WQ0007 30        Error Reason De
     C           WUTITX    PARM WUTITX    WQ0008 30        Error Reason De
     C                     PARM WCAIC3    WQ0009  30       Company Number
     C                     PARM WCAODT    WQ0010  70       Scheduled Ship
     C                     PARM YL0008    WQ0011  70       Requested Deliv
     C                     PARM WCRINY    WQ0012  40       Item Age Days
     C                     PARM WCTIDT    WQ0013  70       Production Ovr
     C                     PARM WCTJDT    WQ0014  70       Production Ovr
     C           YL0014    PARM YL0014    WQ0015  70       Production AgeD
     C           YL0015    PARM YL0015    WQ0016  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Verify if message should be sent if validation is required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Error Flag            USR is Yes
      *   |- c2    : PAR.Production Dates Sts Usr is Validation routine
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUB8SX    IFEQ 'Y'                        *IF
     C           'C'       IFEQ 'V'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * message 1 Product is shipped before product is made
      * CASE: WRK.Error Reason Descript 1 NE WRK.Blank for 30          US
     C           WUKWTX    IFNE WUW4TX                     *IF
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  YL0014    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0003
      * Send message 'PrdDte Shipped BEF Made'
     C                     MOVEL'USR4307' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 2 Either Days or override date but not both
      * CASE: WRK.Error Reason Descript 2 NE WRK.Blank for 30          US
     C           WUKXTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWCRINY    ZA0004           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WCTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0005
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WCTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0006
      * Send message 'Enter Age Days or Dates'
     C                     MOVEL'USR4304' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 3 With Chill Days Either Days or Override Dates required
      * CASE: WRK.Error Reason Descript 3 NE WRK.Blank for 30          US
     C           WUKYTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWCRINY    ZA0007           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WCTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0008
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WCTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0009
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 4 From date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 4 NE WRK.Blank for 30          US
     C           WUKZTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWCRINY    ZA0010           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WCTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0011
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WCTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0012
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 5 To date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 5 NE WRK.Blank for 30          US
     C           WUTITX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWCRINY    ZA0013           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WCTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0014
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WCTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0015
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: PAR.Production Ovr AgeDte Fr is not entered
     C           WCTIDT    IFEQ 0                          *IF
      * Setup message data for message
     C                     Z-ADDWCRINY    ZA0016           Item Age Days
      * Send message 'Invalid Item Age Days'
     C                     MOVEL'USR4309' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  YL0014    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0017
      * Convert Production AgeDte To to display format
      * Convert date
     C           1000000   ADD  YL0015    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0018
      * Send message 'Invalid Prod OvrDates'
     C                     MOVEL'USR4310' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     MOVEL'Y'       YL0016           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       WUOLST           OPS Print on De
     C                     Z-ADD002       WUVTNY           OPS U/M Sequenc
      * Susan 6
      * E3796 JJH 02/11/15 - Add OPS Requested Ship Date to WF OrderProd
      *  Schedule.
      * Crt WF OrderProd SchedIF
      * add 1 to sequence number
     C                     ADD  1         YL0017           OPS Sequence No
      * E3796 JJH 02/11/15 - Add OPS Requested Ship Date to WF OrderProd
      *  Schedule.
      * Crt WF OrderProd SchedCR - WF OrderProd Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0017    WL0011           OPS Sequence No
     C                     MOVELYL0006    WL0012    P      OPS Primal Grou
     C                     Z-ADDP1AIC3    WL0013           OPS Company Num
     C                     MOVELP1AJCD    WL0014    P      OPS Warehouse
     C                     Z-ADDWCAODT    WL0015           OPS Schedule Sh
     C                     Z-ADDWCA5DT    WL0016           OPS Requested S
     C                     MOVELWUAPST    WL0017    P      OPS Report Type
     C                     Z-ADDWCC4NB    WL0018           OPS Order Numbe
     C                     Z-ADDYL0009    WL0019           OPS Load Id
     C                     MOVELYL0007    WL0020    P      OPS Customer Na
     C                     Z-ADDYL0011    WL0021           OPS Load Schedu
     C                     Z-ADDYL0012    WL0022           OPS Deadline De
     C                     Z-ADDYL0013    WL0023           OPS Deadline De
     C                     Z-ADDWCHGCD    WL0024           OPS Item Code
     C                     MOVELYL0002    WL0025    P      OPS Item Descri
     C                     Z-ADDWCAVQT    WL0026           OPS Quantity Or
     C                     MOVELWUTWT1    WL0027    P      OPS Sort Break
     C                     Z-ADDWCRINY    WL0028           Item Age Days
     C                     Z-ADDWCTIDT    WL0029           Production Ovr
     C                     Z-ADDWCTJDT    WL0030           Production Ovr
     C                     Z-ADDYL0014    WL0031           Production AgeD
     C                     Z-ADDYL0015    WL0032           Production AgeD
     C                     MOVELWUOLST    WL0033    P      OPS Print on De
     C                     MOVELWCAGCD    WL0034    P      OPS U/M Primary
     C                     Z-ADDWUVTNY    WL0035           OPS U/M Sequenc
     C                     MOVELWUOQST    WL0036    P      OPS Status 1
     C                     MOVELWUOSST    WL0037    P      OPS Status 2
     C                     Z-ADD06        WL0038           Item Category N
     C                     MOVELP5SLCD    WL0039    P      Item Primal Sch
     C                     EXSR SHCRRC
     C                     MOVEL'Y'       WUBXSX           Record Created
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@BGWKU4                  90*
     C                     ENDDO
      * USER: Exit processing
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv PrimSch Sel       RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDICN6    WQSD01           Item Category N
     C           *LIKE     DEFN WDS0CD    WQSD02           Item Primal Sch
     C           *LIKE     DEFN WDAIC3    WQSD03           Company Number
     C           *LIKE     DEFN WDHGCD    WQSD04           Item Code
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Item Category N
     C                     KFLD           WQSD02           Item Primal Sch
     C                     KFLD           WQSD03           Company Number
     C                     KFLD           WQSD04           Item Code
      * Setup key
     C                     Z-ADDWL0007    WQSD01           Item Category N
     C                     MOVELWL0008    WQSD02           Item Primal Sch
     C                     Z-ADDWL0001    WQSD03           Company Number
     C                     Z-ADDWL0002    WQSD04           Item Code
      * Establish starting position
     C           KRSSD     SETLL@BZRENZ                    *
     C           KRSSD     READE@BZRENZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Description Lin
     C                     Z-ADD*ZERO     WL0004           Item Structure
     C                     Z-ADD*ZERO     WL0005           Item Structure
     C                     Z-ADD*ZERO     WL0006           Item Structure
     C                     MOVEL*BLANK    WL0009           Primal Group Co
     C                     MOVEL*BLANK    WL0010           Record Selected
     C                     MOVEL'N'       WL0010           Record Selected
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0010           Record Selected
      * PAR = DB1 By name
     C                     MOVELWDAVNA    WL0003           Description Lin
     C                     Z-ADDWDRINB    WL0004           Item Structure
     C                     Z-ADDWDRHNB    WL0005           Item Structure
     C                     Z-ADDWDRGNB    WL0006           Item Structure
     C                     MOVELWDXRCD    WL0009           Primal Group Co
      * Verify if active
      * CASE: DB1.Record Status is Active
     C           WDVSST    IFEQ 'A'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WL0010           Record Selected
     C                     END                             *FI
      * Select only if Print on Schedule = N ,
      * CASE: DB1.Print On Schedule is no
     C           WDSVST    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WL0010           Record Selected
     C                     END                             *FI
      * Select only Finish Goods
      * CASE: DB1.Item Type Code is Finished Good
     C           WDN0CD    IFEQ 'FG'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WL0010           Record Selected
     C                     END                             *FI
     C           KRSSD     READE@BZRENZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Val Carlisle Intface  RT - Item Category  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEUSNB           Item Category N
     C                     KFLD           WESLCD           Item Category C
      * Setup key
     C                     Z-ADDP1AIC3    WEAIC3           Company Number
     C                     Z-ADD06        WEUSNB           Item Category N
     C                     MOVELP5SLCD    WESLCD           Item Category C
      * Establish starting position
     C           KRSSE     CHAIN@JIREXX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1854' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUUXST           EDI Status 3
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEUXST    WUUXST           EDI Status 3
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Load ID/Cust/ReqDlvRT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0010           Cancelled Flag
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WFAIC3           Company Number
     C                     Z-ADDWCC4NB    WFC4NB           Order Number
      * Establish starting position
     C           KRSSF     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0007           Ship To Name
     C                     Z-ADD*ZERO     YL0008           Requested Deliv
     C                     Z-ADD*ZERO     YL0009           Load ID
     C                     MOVEL*BLANK    YL0010           Cancelled Flag
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Set Cancelled Flag.
      * CASE: DB1.Header Status is Cancelled
     C           WFGWST    IFEQ 'X'                        *IF
     C                     MOVEL'Y'       YL0010           Cancelled Flag
     C                     END                             *FI
      * PAR = DB1 By name
     C                     MOVELWFBRTX    YL0007           Ship To Name
     C                     Z-ADDWFEIDT    YL0008           Requested Deliv
     C                     Z-ADDWFRMNB    YL0009           Load ID
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV SchSeqA#Deadline   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGRMNB           Load ID
      * Setup key
     C                     Z-ADDYL0009    WGRMNB           Load ID
      * Establish starting position
     C           KRSSG     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0011           Schedule Sequen
     C                     Z-ADD*ZERO     YL0012           Deadline Depart
     C                     Z-ADD*ZERO     YL0013           Deadline Depart
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT                     *QUIT
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGT4NB    YL0011           Schedule Sequen
     C                     Z-ADDWGKZDT    YL0012           Deadline Depart
     C                     Z-ADDWGAXTM    YL0013           Deadline Depart
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SGEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * Crt WF OrderProd SchedCR - WF OrderProd Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EUCPXR
     C                     Z-ADDWL0011    WBNINY           OPS Sequence No
     C                     MOVELWL0012    WBKEAA           OPS Primal Grou
     C                     Z-ADDWL0013    WBCOC3           OPS Company Num
     C                     MOVELWL0014    WBKDAA           OPS Warehouse
     C                     Z-ADDWL0015    WBSPDT           OPS Schedule Sh
     C                     Z-ADDWL0016    WBVQDT           OPS Requested S
     C                     MOVELWL0017    WBAPST           OPS Report Type
     C                     Z-ADDWL0018    WBEXC7           OPS Order Numbe
     C                     Z-ADDWL0019    WBNJNY           OPS Load Id
     C                     MOVELWL0020    WBTUT1           OPS Customer Na
     C                     Z-ADDWL0021    WBNKNY           OPS Load Schedu
     C                     Z-ADDWL0022    WBSODT           OPS Deadline De
     C                     Z-ADDWL0023    WBNLNY           OPS Deadline De
     C                     Z-ADDWL0024    WBEYC7           OPS Item Code
     C                     MOVELWL0025    WBS1NA           OPS Item Descri
     C                     Z-ADDWL0026    WBPIQT           OPS Quantity Or
     C                     MOVELWL0027    WBTWT1           OPS Sort Break
     C                     Z-ADDWL0028    WBRINY           Item Age Days
     C                     Z-ADDWL0029    WBTIDT           Production Ovr
     C                     Z-ADDWL0030    WBTJDT           Production Ovr
     C                     Z-ADDWL0031    WBTNDT           Production AgeD
     C                     Z-ADDWL0032    WBTODT           Production AgeD
     C                     MOVELWL0033    WBOLST           OPS Print on De
     C                     MOVELWL0034    WBPLAA           OPS U/M Primary
     C                     Z-ADDWL0035    WBVTNY           OPS U/M Sequenc
     C                     MOVELWL0036    WBOQST           OPS Status 1
     C                     MOVELWL0037    WBOSST           OPS Status 2
     C                     Z-ADDWL0038    WBICN6           Item Category N
     C                     MOVELWL0039    WBS0CD           Item Primal Sch
      *
      * USER: Processing before Data update
      * E3796 JJH 02/23/15 - Requested Ship Date for Production Schedule
      * - Add I Parm: OPS Requested Ship Date
      * Crt WF orderprodSortB XP - WF OrderProd Schedule  * 
     C                     CALL 'PMAOXFR'              90  Crt WF orderpro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBNINY    WQ0017  70       OPS Sequence No
     C                     PARM WBKEAA    WQ0018  6        OPS Primal Grou
     C                     PARM WBCOC3    WQ0019  30       OPS Company Num
     C                     PARM WBKDAA    WQ0020  3        OPS Warehouse
     C                     PARM WBSPDT    WQ0021  70       OPS Schedule Sh
     C                     PARM WBVQDT    WQ0022  70       OPS Requested S
     C                     PARM WBAPST    WQ0023  1        OPS Report Type
     C                     PARM WBEXC7    WQ0024  70       OPS Order Numbe
     C                     PARM WBNJNY    WQ0025  70       OPS Load Id
     C                     PARM WBTUT1    WQ0026 30        OPS Customer Na
     C                     PARM WBNKNY    WQ0027  50       OPS Load Schedu
     C                     PARM WBSODT    WQ0028  70       OPS Deadline De
     C                     PARM WBNLNY    WQ0029  60       OPS Deadline De
     C                     PARM WBEYC7    WQ0030  70       OPS Item Code
     C                     PARM WBS1NA    WQ0031 30        OPS Item Descri
     C                     PARM WBPIQT    WQ0032 112       OPS Quantity Or
     C           WBTWT1    PARM *BLANK    WQ0033 50        OPS Sort Break
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMAOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           KLCRSH    KLIST
     C                     KFLD           WBNINY           OPS Sequence No
      * Check for duplicate primary key
     C           KLCRSH    SETLL@EUCPXR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4074' W0RTN   7
      * Send message 'WF OrderProd Schedule  EX'
     C                     MOVEL'USR4074' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@EUCPXR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * MODIFICATION HISTORY
      *================================================================
      * E4119 JJH 09/21/16 - Include Orders without a Load ID
      * - Modification added after going live with Mercury Gate
      * - If NO Load ID, then get Deadline Deaparture Date/Time from
      *   the Order Detail file.
      * - Set Scheduled Seq Nbr = ZERO as it is not used by Mercury Gate
      * E3796 JJH 02/18/15 - Logic changes for Requested Ship Date for
      *  Production Schedule.
      *  - Changed I PAR from Scheduled Ship Date to Requested Ship Date
      *  - Replace "PAR.Scheduled Ship Date" with "PAR.Requested Ship Dat
      * E3796 JJH 02/11/15 - Add OPS Requested Ship Date to WF OrderProd
      *  Schedule - Recompiled with no logic changes.
      * 06/21/2012 SLM e02098 Add information for Generic process
      * using the item category 6 for the primal reports
      * 12/3/2010 SLM e001196 2 work ahead days
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      * send the item age days and dates to this work file.
      * Rules on the E2098, Need Picnic schedule report & new totals
     C                     EXSR UCSUBR                     Rules on the E2
      * Rules on the E2098, add new rules using the item category
     C                     EXSR UDSUBR                     Rules on the E2
      * E3796 JJH 02/19/15 - Requested Ship Date
      *  - Change Access Path to Co/Whse/RqsDt/Itm,Sel A,E
      *  - Changed I POS from Scheduled Ship Date to Requested Ship Date
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Rules on the E2098, Need Picnic schedule report & new totals
      *================================================================
      * SLM 5/8/2012 - these rules will apply to trim and belly report
      * e2098 add the unit of measure to work file
      * add status to know if the record will print in the detail
      * if Y then record will be added to the totals and print in the det
      * if N then record will be added to the totals no print in the deta
      * new totals by uom and if currently box do not print the detail
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Rules on the E2098, add new rules using the item category
      *================================================================
      * SLM 6/13/2012- these rules will apply to trim and belly report
      * e2098 add the item category 06 number and category 06 code
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * General information on Boxes, and Combo, and Snd to Carlisle
      *================================================================
      * This process is building the data for the combo production schedu
      * processing for combos, no boxes WILL be placed in this data
      * There are some combo's that the production schedule
      * want to appear with
      * the box schedules :
      * that would be any combo that the primal report
      * snd to Carlisle is a C or F,
      *                  do not write this combo to this wrk file
      * Not Snd to Carlisle Not C,F then write this combo to this wrk fil
      *                  write this combo to this wrk file
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Selection information for item and no boxes, snd to Carlisle no
      *================================================================
      * Rtv PrimSch Sel       RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0001           Company Number
     C                     Z-ADDWCHGCD    WL0002           Item Code
     C                     Z-ADD06        WL0007           Item Category N
     C                     MOVELP5SLCD    WL0008    P      Item Primal Sch
     C                     MOVELYL0001    WL0010    P      Record Selected
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0002    P      Description Lin
     C                     Z-ADDWL0004    YL0003           Item Structure
     C                     Z-ADDWL0005    YL0004           Item Structure
     C                     Z-ADDWL0006    YL0005           Item Structure
     C                     MOVELWL0009    YL0006    P      Primal Group Co
     C                     MOVELWL0010    YL0001    P      Record Selected
      * CASE: LCL.Record Selected       USR is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * CASE: DB1.U/M - Ordered is EQ Boxes
     C           WCAGCD    IFEQ 'BX'                       *IF
     C                     MOVEL'N'       YL0001           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
      * IF send to Carlisle or Future totals, the do not send combos
      * IF do not send to Carlisle then include combos only
      * Val Carlisle Intface  RT - Item Category  * 
     C                     EXSR SERVGN
      * CASE: WRK.EDI Status 3 is Send to Carlisle
     C           WUUXST    IFEQ 'C'                        *IF
     C           WUUXST    OREQ 'F'
      * CASE: DB1.U/M - Ordered is Combos
     C           WCAGCD    IFEQ 'CB'                       *IF
     C                     MOVEL'N'       YL0001           Record Selected
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0001           Record Selected
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WANINY           OPS Sequence No
     C                     Z-ADD*ZERO     WACOC3           OPS Company Num
     C                     Z-ADD*ZERO     WASPDT           OPS Schedule Sh
     C                     Z-ADD*ZERO     WAVQDT           OPS Requested S
     C                     Z-ADD*ZERO     WAEXC7           OPS Order Numbe
     C                     Z-ADD*ZERO     WANJNY           OPS Load Id
     C                     Z-ADD*ZERO     WANKNY           OPS Load Schedu
     C                     Z-ADD*ZERO     WASODT           OPS Deadline De
     C                     Z-ADD*ZERO     WANLNY           OPS Deadline De
     C                     Z-ADD*ZERO     WAEYC7           OPS Item Code
     C                     Z-ADD*ZERO     WAPIQT           OPS Quantity Or
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATNDT           Production AgeD
     C                     Z-ADD*ZERO     WATODT           Production AgeD
     C                     Z-ADD*ZERO     WAVTNY           OPS U/M Sequenc
     C                     Z-ADD*ZERO     WAICN6           Item Category N
      * Define work field Prior Schedule Ship DteUs
     C                     Z-ADD*ZERO     WUSQDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WCDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WCDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WCDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WCDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WCGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Item Age Days
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WCTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WCTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Record Created        USR
     C                     MOVEL*BLANK    WUBXSX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAIWG           Unit Weight
     C                     Z-ADD*ZERO     WDCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WDC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WDURTN           Number Cases On
     C                     Z-ADD*ZERO     WDAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDTFNB           Transportation
     C                     Z-ADD*ZERO     WDTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WDTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WDBLPR           Market Overage
     C                     Z-ADD*ZERO     WDBMPR           Standard Overag
     C                     Z-ADD*ZERO     WDCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WDCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WDSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WDPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WDICN1           Item Category N
     C                     Z-ADD*ZERO     WDICN2           Item Category N
     C                     Z-ADD*ZERO     WDV2NB           Item Category N
     C                     Z-ADD*ZERO     WDITCN           Item Category N
     C                     Z-ADD*ZERO     WDITC5           Item Category N
     C                     Z-ADD*ZERO     WDICN6           Item Category N
     C                     Z-ADD*ZERO     WDICN7           Item Category N
     C                     Z-ADD*ZERO     WDICN8           Item Category N
     C                     Z-ADD*ZERO     WDICN9           Item Category N
     C                     Z-ADD*ZERO     WDICN0           Item Category N
     C                     Z-ADD*ZERO     WDSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WDA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WDSJNB           Production Lead
     C                     Z-ADD*ZERO     WDSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WDSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WDSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WDCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WDCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WDILNB           Packages per ca
     C                     Z-ADD*ZERO     WDCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WDCINB           PM Batch Size
     C                     Z-ADD*ZERO     WDCJNB           Package Level s
     C                     Z-ADD*ZERO     WDCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WDCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WDCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WDCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WDCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WDCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WDCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WDCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WDC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WDB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WDB5NB           PM Line Number
     C                     Z-ADD*ZERO     WDBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WDBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WDF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WDF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WDF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WDBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WDBNNB           Production Qty
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEUSNB           Item Category N
     C                     Z-ADD*ZERO     WEOHNX           Item Category T
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WFA0DT           Order Date
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFACDT           Cancel Date
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WFA1WG           Order Weight To
     C                     Z-ADD*ZERO     WFEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WFAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WFATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WFRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WFT3NB           Attach to Order
     C                     Z-ADD*ZERO     WFCONB           Invoice Number
     C                     Z-ADD*ZERO     WFAWDT           Invoice Date
     C                     Z-ADD*ZERO     WFVRVA           A/R order Value
     C                     Z-ADD*ZERO     WFB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WFNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WFNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WFNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WFNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WFNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WFBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WFBQTM           Time of Origina
     C                     Z-ADD*ZERO     WFBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WFBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WFBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WFH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WFH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WFH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WFH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WFH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WFC0C7           Claim Number
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGRMNB           Load ID
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WGRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WGFLAM           Flat Amount
     C                     Z-ADD*ZERO     WGRRNB           Total Stops
     C                     Z-ADD*ZERO     WGSBNB           BOL Time
     C                     Z-ADD*ZERO     WGSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGSDNB           Number Pallets
     C                     Z-ADD*ZERO     WGPAOU           Number Pallets
     C                     Z-ADD*ZERO     WGDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WGSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WGHADT           Actual Arrival
     C                     Z-ADD*ZERO     WGAART           Actual Arrival
     C                     Z-ADD*ZERO     WGDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WGDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WGAQDT           Actual Departur
     C                     Z-ADD*ZERO     WGS6NB           Departure Time
     C                     Z-ADD*ZERO     WGT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WGPRTM           Product Tempera
     C                     Z-ADD*ZERO     WGNPSV           Number Pallets
     C                     Z-ADD*ZERO     WGTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WGGRWE           Gross Weight
     C                     Z-ADD*ZERO     WGF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WGJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WGTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WGJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WGSPTM           Spotted Time
     C                     Z-ADD*ZERO     WGJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WGLFTM           Load Finished T
     C                     Z-ADD*ZERO     WGJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WGBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WGJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WGBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WGKIDT           Truck Departure
     C                     Z-ADD*ZERO     WGASTM           Truck Departure
     C                     Z-ADD*ZERO     WGKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WGAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WGVOAG           Voyage
     C                     Z-ADD*ZERO     WGKBDT           Sail Date
     C                     Z-ADD*ZERO     WGEFDT           Arrival Date
     C                     Z-ADD*ZERO     WGKCDT           Date In
     C                     Z-ADD*ZERO     WGTMIN           Time In
     C                     Z-ADD*ZERO     WGKDDT           Date Out
     C                     Z-ADD*ZERO     WGVMNB           Time Out
     C                     Z-ADD*ZERO     WGOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WGKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WGATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WGBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WGEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WGKKDT           On Yard Date
     C                     Z-ADD*ZERO     WGAVTM           On Yard Time
     C                     Z-ADD*ZERO     WGKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WGAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WGLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WGK0DT           Product Complet
     C                     Z-ADD*ZERO     WGAYTM           Product Complet
     C                     Z-ADD*ZERO     WGKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WGICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WGIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WGK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WGAZTM           Load Door 1
     C                     Z-ADD*ZERO     WGK2DT           Override Total
     C                     Z-ADD*ZERO     WGA0TM           Load Door 2
     C                     Z-ADD*ZERO     WGZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WGPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WGCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WGPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WGCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WGP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WGCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WGP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WGCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WGP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WGCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WGP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WGCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Error Flag            USR
     C                     MOVEL*BLANK    WUB8SX  1
      * Define work field Error Reason Descript 1
     C                     MOVEL*BLANK    WUKWTX 30
      * Define work field Error Reason Descript 2
     C                     MOVEL*BLANK    WUKXTX 30
      * Define work field Error Reason Descript 3
     C                     MOVEL*BLANK    WUKYTX 30
      * Define work field Error Reason Descript 4
     C                     MOVEL*BLANK    WUKZTX 30
      * Define work field Error Reason Descript 5
     C                     MOVEL*BLANK    WUTITX 30
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Blank for 30          USR
     C                     MOVEL*BLANK    WUW4TX 30
      * Define work field OPS Print on Detail Sch
     C                     MOVEL*BLANK    WUOLST  1
      * Define work field OPS U/M Sequence
     C                     Z-ADD*ZERO     WUVTNY  30
      * Define work field OPS Report Type
     C                     MOVEL*BLANK    WUAPST  1
      * Define work field OPS Sort Break
     C                     MOVEL*BLANK    WUTWT1 50
      * Define work field OPS Status 1
     C                     MOVEL*BLANK    WUOQST  1
      * Define work field OPS Status 2
     C                     MOVEL*BLANK    WUOSST  1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003 30
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  20
     C                     MOVEL*BLANK    WL0008  3
     C                     MOVEL*BLANK    WL0009  6
     C                     MOVEL*BLANK    WL0010  1
      * Define local variables for subroutine SHCRRC.
     C                     Z-ADD*ZERO     WL0011  70
     C                     MOVEL*BLANK    WL0012  6
     C                     Z-ADD*ZERO     WL0013  30
     C                     MOVEL*BLANK    WL0014  3
     C                     Z-ADD*ZERO     WL0015  70
     C                     Z-ADD*ZERO     WL0016  70
     C                     MOVEL*BLANK    WL0017  1
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  70
     C                     MOVEL*BLANK    WL0020 30
     C                     Z-ADD*ZERO     WL0021  50
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023  60
     C                     Z-ADD*ZERO     WL0024  70
     C                     MOVEL*BLANK    WL0025 30
     C                     Z-ADD*ZERO     WL0026 112
     C                     MOVEL*BLANK    WL0027 50
     C                     Z-ADD*ZERO     WL0028  40
     C                     Z-ADD*ZERO     WL0029  70
     C                     Z-ADD*ZERO     WL0030  70
     C                     Z-ADD*ZERO     WL0031  70
     C                     Z-ADD*ZERO     WL0032  70
     C                     MOVEL*BLANK    WL0033  1
     C                     MOVEL*BLANK    WL0034  2
     C                     Z-ADD*ZERO     WL0035  30
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037  1
     C                     Z-ADD*ZERO     WL0038  20
     C                     MOVEL*BLANK    WL0039  3
      * Define local work field Record Selected       USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Description Line One
     C                     MOVEL*BLANK    YL0002 30
      * Define local work field Item Structure Class Code
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Item Structure Group Code
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field Item Structure Type Code
     C                     Z-ADD*ZERO     YL0005  30
      * Define local work field Primal Group Code
     C                     MOVEL*BLANK    YL0006  6
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0007 30
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field Cancelled Flag USR
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Schedule Sequence Number
     C                     Z-ADD*ZERO     YL0011  50
      * Define local work field Deadline Departure Date
     C                     Z-ADD*ZERO     YL0012  70
      * Define local work field Deadline Departure Time
     C                     Z-ADD*ZERO     YL0013  60
      * Define local work field Production AgeDte Fr
     C                     Z-ADD*ZERO     YL0014  70
      * Define local work field Production AgeDte To
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Error Status
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field OPS Sequence No
     C                     Z-ADD*ZERO     YL0017  70
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
