     H/TITLE Cnv Carrier Insurance XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 03/27/03  Time  : 15:31:20
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FPOCKREL0IF  E           K        DISK                      A
      * UPD : Carrier Insurance         Update index
      *
     FOMFFREL1UF  E           K        DISK
      * UPD : Carrier                   Update index
      *
     I@FFREBF
      * Carrier                   Retrieval index
      * Renamed input format fields
     I              FFBZNA                          WABZNA
     I              FFADTX                          WAADTX
     I              FFACNA                          WAACNA
     I              FFADNA                          WAADNA
     I              FFAENA                          WAAENA
     I              FFAJNA                          WAAJNA
     I              FFBTTX                          WABTTX
     I              FFEZNB                          WAEZNB
     I              FFBGCD                          WABGCD
     I              FFEEDT                          WAEEDT
     I              FFDUTX                          WADUTX
     I              FFNRVA                          WANRVA
     I              FFNSVA                          WANSVA
     I              FFNTVA                          WANTVA
     I              FFNUVA                          WANUVA
     I              FFP1ST                          WAP1ST
     I              FFDVTX                          WADVTX
     I              FFDWTX                          WADWTX
     I              FFLVCD                          WALVCD
     I              FFS8NB                          WAS8NB
     I              FFS9NB                          WAS9NB
     I              FFNMVA                          WANMVA
     I              FFNOVA                          WANOVA
     I              FFNPVA                          WANPVA
     I              FFNQVA                          WANQVA
     I              FFMFCD                          WAMFCD
     I              FFQXNB                          WAQXNB
     I              FFQ1NB                          WAQ1NB
     I              FFMRNG                          WAMRNG
     I              FFMRNE                          WAMRNE
     I              FFRFNB                          WARFNB
     I              FFMREG                          WAMREG
     I              FFBQPR                          WABQPR
     I              FFBRPR                          WABRPR
     I              FFBSPR                          WABSPR
     I              FFBTPR                          WABTPR
     I              FFBUPR                          WABUPR
     I              FFBVPR                          WABVPR
     I              FFDJWG                          WADJWG
     I              FFDKWG                          WADKWG
     I              FFDLWG                          WADLWG
     I              FFDMWG                          WADMWG
     I              FFDNWG                          WADNWG
     I              FFDOWG                          WADOWG
     I              FFB2PR                          WAB2PR
     I              FFB3PR                          WAB3PR
     I              FFB4PR                          WAB4PR
     I              FFB5PR                          WAB5PR
     I              FFB6PR                          WAB6PR
     I              FFB7PR                          WAB7PR
     I              FFAAC7                          WAAAC7
     I              FFCOFI                          WACOFI
     I              FFK6TX                          WAK6TX
     I              FFOCNA                          WAOCNA
     I              FFODNA                          WAODNA
     I              FFW7CD                          WAW7CD
     I              FFK7TX                          WAK7TX
     I              FFTENO                          WATENO
     I              FFK8TX                          WAK8TX
     I              FFAOFC                          WAAOFC
     I              FFAOLI                          WAAOLI
     I              FFKHDT                          WAKHDT
     I              FFUNUS                          WAUNUS
     I              FFUNU2                          WAUNU2
     I              FFUNU3                          WAUNU3
     I              FFUVST                          WAUVST
     I              FFUWST                          WAUWST
     I              FFUXST                          WAUXST
     I              FFVSST                          WAVSST
     I              FFAATM                          WAAATM
     I              FFAYNA                          WAAYNA
     I              FFA0NA                          WAA0NA
     I              FFAXDT                          WAAXDT
      *
     I@CKREPH
      * Carrier Insurance         Update index
      * Renamed input format fields
     I              CKBZNA                          WBBZNA
     I              CKENAA                          WBENAA
     I              CKCST1                          WBCST1
     I              CKP5NA                          WBP5NA
     I              CKP6NA                          WBP6NA
     I              CKEOAA                          WBEOAA
     I              CKCTT1                          WBCTT1
     I              CKTQNX                          WBTQNX
     I              CKCUT1                          WBCUT1
     I              CKTRNX                          WBTRNX
     I              CKO9DT                          WBO9DT
     I              CKUVST                          WBUVST
     I              CKUWST                          WBUWST
     I              CKUXST                          WBUXST
     I              CKVSST                          WBVSST
     I              CKAATM                          WBAATM
     I              CKAYNA                          WBAYNA
     I              CKA0NA                          WBA0NA
     I              CKAXDT                          WBAXDT
      *
     I@FFREBG
      * Carrier                   Update index
      * Renamed input format fields
     I              FFBZNA                          WCBZNA
     I              FFADTX                          WCADTX
     I              FFACNA                          WCACNA
     I              FFADNA                          WCADNA
     I              FFAENA                          WCAENA
     I              FFAJNA                          WCAJNA
     I              FFBTTX                          WCBTTX
     I              FFEZNB                          WCEZNB
     I              FFBGCD                          WCBGCD
     I              FFEEDT                          WCEEDT
     I              FFDUTX                          WCDUTX
     I              FFNRVA                          WCNRVA
     I              FFNSVA                          WCNSVA
     I              FFNTVA                          WCNTVA
     I              FFNUVA                          WCNUVA
     I              FFP1ST                          WCP1ST
     I              FFDVTX                          WCDVTX
     I              FFDWTX                          WCDWTX
     I              FFLVCD                          WCLVCD
     I              FFS8NB                          WCS8NB
     I              FFS9NB                          WCS9NB
     I              FFNMVA                          WCNMVA
     I              FFNOVA                          WCNOVA
     I              FFNPVA                          WCNPVA
     I              FFNQVA                          WCNQVA
     I              FFMFCD                          WCMFCD
     I              FFQXNB                          WCQXNB
     I              FFQ1NB                          WCQ1NB
     I              FFMRNG                          WCMRNG
     I              FFMRNE                          WCMRNE
     I              FFRFNB                          WCRFNB
     I              FFMREG                          WCMREG
     I              FFBQPR                          WCBQPR
     I              FFBRPR                          WCBRPR
     I              FFBSPR                          WCBSPR
     I              FFBTPR                          WCBTPR
     I              FFBUPR                          WCBUPR
     I              FFBVPR                          WCBVPR
     I              FFDJWG                          WCDJWG
     I              FFDKWG                          WCDKWG
     I              FFDLWG                          WCDLWG
     I              FFDMWG                          WCDMWG
     I              FFDNWG                          WCDNWG
     I              FFDOWG                          WCDOWG
     I              FFB2PR                          WCB2PR
     I              FFB3PR                          WCB3PR
     I              FFB4PR                          WCB4PR
     I              FFB5PR                          WCB5PR
     I              FFB6PR                          WCB6PR
     I              FFB7PR                          WCB7PR
     I              FFAAC7                          WCAAC7
     I              FFCOFI                          WCCOFI
     I              FFK6TX                          WCK6TX
     I              FFOCNA                          WCOCNA
     I              FFODNA                          WCODNA
     I              FFW7CD                          WCW7CD
     I              FFK7TX                          WCK7TX
     I              FFTENO                          WCTENO
     I              FFK8TX                          WCK8TX
     I              FFAOFC                          WCAOFC
     I              FFAOLI                          WCAOLI
     I              FFKHDT                          WCKHDT
     I              FFUNUS                          WCUNUS
     I              FFUNU2                          WCUNU2
     I              FFUNU3                          WCUNU3
     I              FFUVST                          WCUVST
     I              FFUWST                          WCUWST
     I              FFUXST                          WCUXST
     I              FFVSST                          WCVSST
     I              FFAATM                          WCAATM
     I              FFAYNA                          WCAYNA
     I              FFA0NA                          WCA0NA
     I              FFAXDT                          WCAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPOCK1    E DSPOCKREL0
      * UPD : Carrier Insurance         Update index
      * Renamed input format fields
     I              CKBZNA                          WBBZNA
     I              CKENAA                          WBENAA
     I              CKCST1                          WBCST1
     I              CKP5NA                          WBP5NA
     I              CKP6NA                          WBP6NA
     I              CKEOAA                          WBEOAA
     I              CKCTT1                          WBCTT1
     I              CKTQNX                          WBTQNX
     I              CKCUT1                          WBCUT1
     I              CKTRNX                          WBTRNX
     I              CKO9DT                          WBO9DT
     I              CKUVST                          WBUVST
     I              CKUWST                          WBUWST
     I              CKUXST                          WBUXST
     I              CKVSST                          WBVSST
     I              CKAATM                          WBAATM
     I              CKAYNA                          WBAYNA
     I              CKA0NA                          WBA0NA
     I              CKAXDT                          WBAXDT
      *
     IQOMFF1    E DSOMFFREL1
      * UPD : Carrier                   Update index
      * Renamed input format fields
     I              FFBZNA                          WCBZNA
     I              FFADTX                          WCADTX
     I              FFACNA                          WCACNA
     I              FFADNA                          WCADNA
     I              FFAENA                          WCAENA
     I              FFAJNA                          WCAJNA
     I              FFBTTX                          WCBTTX
     I              FFEZNB                          WCEZNB
     I              FFBGCD                          WCBGCD
     I              FFEEDT                          WCEEDT
     I              FFDUTX                          WCDUTX
     I              FFNRVA                          WCNRVA
     I              FFNSVA                          WCNSVA
     I              FFNTVA                          WCNTVA
     I              FFNUVA                          WCNUVA
     I              FFP1ST                          WCP1ST
     I              FFDVTX                          WCDVTX
     I              FFDWTX                          WCDWTX
     I              FFLVCD                          WCLVCD
     I              FFS8NB                          WCS8NB
     I              FFS9NB                          WCS9NB
     I              FFNMVA                          WCNMVA
     I              FFNOVA                          WCNOVA
     I              FFNPVA                          WCNPVA
     I              FFNQVA                          WCNQVA
     I              FFMFCD                          WCMFCD
     I              FFQXNB                          WCQXNB
     I              FFQ1NB                          WCQ1NB
     I              FFMRNG                          WCMRNG
     I              FFMRNE                          WCMRNE
     I              FFRFNB                          WCRFNB
     I              FFMREG                          WCMREG
     I              FFBQPR                          WCBQPR
     I              FFBRPR                          WCBRPR
     I              FFBSPR                          WCBSPR
     I              FFBTPR                          WCBTPR
     I              FFBUPR                          WCBUPR
     I              FFBVPR                          WCBVPR
     I              FFDJWG                          WCDJWG
     I              FFDKWG                          WCDKWG
     I              FFDLWG                          WCDLWG
     I              FFDMWG                          WCDMWG
     I              FFDNWG                          WCDNWG
     I              FFDOWG                          WCDOWG
     I              FFB2PR                          WCB2PR
     I              FFB3PR                          WCB3PR
     I              FFB4PR                          WCB4PR
     I              FFB5PR                          WCB5PR
     I              FFB6PR                          WCB6PR
     I              FFB7PR                          WCB7PR
     I              FFAAC7                          WCAAC7
     I              FFCOFI                          WCCOFI
     I              FFK6TX                          WCK6TX
     I              FFOCNA                          WCOCNA
     I              FFODNA                          WCODNA
     I              FFW7CD                          WCW7CD
     I              FFK7TX                          WCK7TX
     I              FFTENO                          WCTENO
     I              FFK8TX                          WCK8TX
     I              FFAOFC                          WCAOFC
     I              FFAOLI                          WCAOLI
     I              FFKHDT                          WCKHDT
     I              FFUNUS                          WCUNUS
     I              FFUNU2                          WCUNU2
     I              FFUNU3                          WCUNU3
     I              FFUVST                          WCUVST
     I              FFUWST                          WCUWST
     I              FFUXST                          WCUXST
     I              FFVSST                          WCVSST
     I              FFAATM                          WCAATM
     I              FFAYNA                          WCAYNA
     I              FFA0NA                          WCA0NA
     I              FFAXDT                          WCAXDT
      *
     IYARDCS      DS                            641
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Cnv Carrier Insurance XF
      * Cnv Carrier Insurance RT - Carrier  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Cnv Carrier Insurance RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@FFREBF                    *
     C                     READ @FFREBF                  90*
      * Data record not found
     C   90                MOVEL'USR1180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Certificate of Insurance is yes
     C           WACOFI    IFEQ 'Y'                        *IF
      * Cnv Carrier Insurance CR - Carrier Insurance  * CARGO
      * Move input parameters to subroutine local variables.
     C                     MOVELWABZNA    WL0001    P      Carrier Code
     C                     MOVEL'CARGO'   WL0002    P      Insurance Type
     C                     MOVELWAK6TX    WL0003    P      CI Insurance Co
     C                     MOVELWAOCNA    WL0004    P      CI Insurance Co
     C                     MOVELWAODNA    WL0005    P      CI Insurance Co
     C                     MOVELWAW7CD    WL0006    P      CI State Code
     C                     MOVELWAK7TX    WL0007    P      CI Insurance Co
     C                     Z-ADDWATENO    WL0008           CI Insurance Co
     C                     MOVELWAK8TX    WL0009    P      CI Insurance Co
     C                     Z-ADDWAAOFC    WL0010           CI Liability Am
     C                     Z-ADDWAKHDT    WL0011           CI Date of Expi
     C                     MOVELWAUVST    WL0012    P      EDI Status 1
     C                     MOVELWAUWST    WL0013    P      EDI Status 2
     C                     MOVELWAUXST    WL0014    P      EDI Status 3
     C                     MOVELWAVSST    WL0015    P      Record Status
     C                     Z-ADDWAAATM    WL0016           Job Time
     C                     MOVELWAAYNA    WL0017    P      User Id
     C                     MOVELWAA0NA    WL0018    P      Job Name
     C                     Z-ADDWAAXDT    WL0019           Job Date
     C                     EXSR SBCRRC
      * Cnv Carrier Insurance CR - Carrier Insurance  * GEN
      * Move input parameters to subroutine local variables.
     C                     MOVELWABZNA    WL0001    P      Carrier Code
     C                     MOVEL'GEN'     WL0002    P      Insurance Type
     C                     MOVELWAK6TX    WL0003    P      CI Insurance Co
     C                     MOVELWAOCNA    WL0004    P      CI Insurance Co
     C                     MOVELWAODNA    WL0005    P      CI Insurance Co
     C                     MOVELWAW7CD    WL0006    P      CI State Code
     C                     MOVELWAK7TX    WL0007    P      CI Insurance Co
     C                     Z-ADDWATENO    WL0008           CI Insurance Co
     C                     MOVELWAK8TX    WL0009    P      CI Insurance Co
     C                     Z-ADDWAAOLI    WL0010           CI Liability Am
     C                     Z-ADDWAKHDT    WL0011           CI Date of Expi
     C                     MOVELWAUVST    WL0012    P      EDI Status 1
     C                     MOVELWAUWST    WL0013    P      EDI Status 2
     C                     MOVELWAUXST    WL0014    P      EDI Status 3
     C                     MOVELWAVSST    WL0015    P      Record Status
     C                     Z-ADDWAAATM    WL0016           Job Time
     C                     MOVELWAAYNA    WL0017    P      User Id
     C                     MOVELWAA0NA    WL0018    P      Job Name
     C                     Z-ADDWAAXDT    WL0019           Job Date
     C                     EXSR SBCRRC
      * Cnv Carrier Insurance CH - Carrier  * 
     C                     EXSR SCCHRC
     C                     END                             *FI
     C                     READ @FFREBF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Cnv Carrier Insurance CR - Carrier Insurance  * CARGO
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CKREPH
     C                     MOVELWL0001    WBBZNA           Carrier Code
     C                     MOVELWL0002    WBENAA           Insurance Type
     C                     MOVELWL0003    WBCST1           CI Insurance Co
     C                     MOVELWL0004    WBP5NA           CI Insurance Co
     C                     MOVELWL0005    WBP6NA           CI Insurance Co
     C                     MOVELWL0006    WBEOAA           CI State Code
     C                     MOVELWL0007    WBCTT1           CI Insurance Co
     C                     Z-ADDWL0008    WBTQNX           CI Insurance Co
     C                     MOVELWL0009    WBCUT1           CI Insurance Co
     C                     Z-ADDWL0010    WBTRNX           CI Liability Am
     C                     Z-ADDWL0011    WBO9DT           CI Date of Expi
     C                     MOVELWL0012    WBUVST           EDI Status 1
     C                     MOVELWL0013    WBUWST           EDI Status 2
     C                     MOVELWL0014    WBUXST           EDI Status 3
     C                     MOVELWL0015    WBVSST           Record Status
     C                     Z-ADDWL0016    WBAATM           Job Time
     C                     MOVELWL0017    WBAYNA           User Id
     C                     MOVELWL0018    WBA0NA           Job Name
     C                     Z-ADDWL0019    WBAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WBVSST           Record Status
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##JOB     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
     C           KLCRSB    KLIST
     C                     KFLD           WBBZNA           Carrier Code
     C                     KFLD           WBENAA           Insurance Type
      * Check for duplicate primary key
     C           KLCRSB    SETLL@CKREPH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3203' W0RTN   7
      * Send message 'Carrier Insurance      EX'
     C                     MOVEL'USR3203' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@CKREPH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Cnv Carrier Insurance CH - Carrier  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 30        Name
     C                     MOVEL*BLANK    WN0002 30        Address Line 1
     C                     MOVEL*BLANK    WN0003 30        Address Line 2
     C                     MOVEL*BLANK    WN0004 30        Address Line 3
     C                     MOVEL*BLANK    WN0005 20        City
     C                     MOVEL*BLANK    WN0006 11        Zip/Postal Code
     C                     Z-ADD*ZERO     WN0007 110       Telephone Numbe
     C                     MOVEL*BLANK    WN0008  2        State Code
     C                     Z-ADD*ZERO     WN0009  70       Carrier Last Us
     C                     MOVEL*BLANK    WN0010 25        Fax Number
     C                     Z-ADD*ZERO     WN0011 112       Pallet Balance
     C                     Z-ADD*ZERO     WN0012 112       Long hook balan
     C                     Z-ADD*ZERO     WN0013 112       Short hook bala
     C                     Z-ADD*ZERO     WN0014 112       Tub Balance
     C                     MOVEL*BLANK    WN0015  1        OM Carrier Stat
     C                     MOVEL*BLANK    WN0016 30        OM Carrier Comm
     C                     MOVEL*BLANK    WN0017 30        OM Carrier Comm
     C                     MOVEL*BLANK    WN0018 10        AP Vendor Numbe
     C                     Z-ADD*ZERO     WN0019 110       Home Phone
     C                     Z-ADD*ZERO     WN0020 110       Other Phone
     C                     Z-ADD*ZERO     WN0021 112       Flat Rate
     C                     Z-ADD*ZERO     WN0022  72       Rate Per Pound
     C                     Z-ADD*ZERO     WN0023  72       Rate Per Stop
     C                     Z-ADD*ZERO     WN0024  72       Miscellaneous C
     C                     MOVEL*BLANK    WN0025  3        Carrier Rating
     C                     Z-ADD*ZERO     WN0026  70       Mile Range 1
     C                     Z-ADD*ZERO     WN0027  70       Mile Range 2
     C                     Z-ADD*ZERO     WN0028  70       Mile Range 3
     C                     Z-ADD*ZERO     WN0029  70       Mile Range 4
     C                     Z-ADD*ZERO     WN0030  70       Mile Range 5
     C                     Z-ADD*ZERO     WN0031  70       Mile Range 6
     C                     Z-ADD*ZERO     WN0032 114       Mile Rate 1
     C                     Z-ADD*ZERO     WN0033 114       Mile Rate 2
     C                     Z-ADD*ZERO     WN0034 114       Mile Rate 3
     C                     Z-ADD*ZERO     WN0035 114       Mile Rate 4
     C                     Z-ADD*ZERO     WN0036 114       Mile Rate 5
     C                     Z-ADD*ZERO     WN0037 114       Mile Rate 6
     C                     Z-ADD*ZERO     WN0038 112       Weight Range 1
     C                     Z-ADD*ZERO     WN0039 112       Weight Range 2
     C                     Z-ADD*ZERO     WN0040 112       Weight Range 3
     C                     Z-ADD*ZERO     WN0041 112       Weight Range 4
     C                     Z-ADD*ZERO     WN0042 112       Weight Range 5
     C                     Z-ADD*ZERO     WN0043 112       Weight Range 6
     C                     Z-ADD*ZERO     WN0044 114       Weight Rate 1
     C                     Z-ADD*ZERO     WN0045 114       Weight Rate 2
     C                     Z-ADD*ZERO     WN0046 114       Weight Rate 3
     C                     Z-ADD*ZERO     WN0047 114       Weight Rate 4
     C                     Z-ADD*ZERO     WN0048 114       Weight Rate 5
     C                     Z-ADD*ZERO     WN0049 114       Weight Rate 6
     C                     Z-ADD*ZERO     WN0050  70       Contact Number
     C                     MOVEL*BLANK    WN0051  1        Certificate of
     C                     MOVEL*BLANK    WN0052  1        unused status 1
     C                     MOVEL*BLANK    WN0053  1        unused status 2
     C                     MOVEL*BLANK    WN0054  1        unused status 3
     C                     MOVEL*BLANK    WN0055  1        EDI Status 1
     C                     MOVEL*BLANK    WN0056  1        EDI Status 2
     C                     MOVEL*BLANK    WN0057  1        EDI Status 3
     C                     MOVEL*BLANK    WN0058  1        Record Status
     C                     Z-ADD*ZERO     WN0059  60       Job Time
     C                     MOVEL*BLANK    WN0060 10        User Id
     C                     MOVEL*BLANK    WN0061 10        Job Name
     C                     Z-ADD*ZERO     WN0062  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FFREBG
     C                     MOVELWABZNA    WCBZNA    P      Carrier Code
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCBZNA           Carrier Code
     C           KLCHSC    CHAIN@FFREBG              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFFREL1'MDACP
     C                     MOVEL'@FFREBG' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFF1    YARDCS
      * Move non-key fields to @FFREBG
     C                     MOVEL*BLANK    WCK6TX    P      Carrier Unused
     C                     MOVEL*BLANK    WCOCNA    P      Carrier Unused
     C                     MOVEL*BLANK    WCODNA    P      Carrier Unused
     C                     MOVEL*BLANK    WCW7CD    P      Carrier Unused
     C                     MOVEL*BLANK    WCK7TX    P      Carrier Unused
     C                     Z-ADD*ZERO     WCTENO           Carrier Unused
     C                     MOVEL*BLANK    WCK8TX    P      Carrier Unused
     C                     Z-ADD*ZERO     WCAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WCAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WCKHDT           Date of Expirat
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FFREBG                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFFREL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WAEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WANRVA           Pallet Balance
     C                     Z-ADD*ZERO     WANSVA           Long hook balan
     C                     Z-ADD*ZERO     WANTVA           Short hook bala
     C                     Z-ADD*ZERO     WANUVA           Tub Balance
     C                     Z-ADD*ZERO     WAS8NB           Home Phone
     C                     Z-ADD*ZERO     WAS9NB           Other Phone
     C                     Z-ADD*ZERO     WANMVA           Flat Rate
     C                     Z-ADD*ZERO     WANOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WANPVA           Rate Per Stop
     C                     Z-ADD*ZERO     WANQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WAQXNB           Mile Range 1
     C                     Z-ADD*ZERO     WAQ1NB           Mile Range 2
     C                     Z-ADD*ZERO     WAMRNG           Mile Range 3
     C                     Z-ADD*ZERO     WAMRNE           Mile Range 4
     C                     Z-ADD*ZERO     WARFNB           Mile Range 5
     C                     Z-ADD*ZERO     WAMREG           Mile Range 6
     C                     Z-ADD*ZERO     WABQPR           Mile Rate 1
     C                     Z-ADD*ZERO     WABRPR           Mile Rate 2
     C                     Z-ADD*ZERO     WABSPR           Mile Rate 3
     C                     Z-ADD*ZERO     WABTPR           Mile Rate 4
     C                     Z-ADD*ZERO     WABUPR           Mile Rate 5
     C                     Z-ADD*ZERO     WABVPR           Mile Rate 6
     C                     Z-ADD*ZERO     WADJWG           Weight Range 1
     C                     Z-ADD*ZERO     WADKWG           Weight Range 2
     C                     Z-ADD*ZERO     WADLWG           Weight Range 3
     C                     Z-ADD*ZERO     WADMWG           Weight Range 4
     C                     Z-ADD*ZERO     WADNWG           Weight Range 5
     C                     Z-ADD*ZERO     WADOWG           Weight Range 6
     C                     Z-ADD*ZERO     WAB2PR           Weight Rate 1
     C                     Z-ADD*ZERO     WAB3PR           Weight Rate 2
     C                     Z-ADD*ZERO     WAB4PR           Weight Rate 3
     C                     Z-ADD*ZERO     WAB5PR           Weight Rate 4
     C                     Z-ADD*ZERO     WAB6PR           Weight Rate 5
     C                     Z-ADD*ZERO     WAB7PR           Weight Rate 6
     C                     Z-ADD*ZERO     WAAAC7           Contact Number
     C                     Z-ADD*ZERO     WATENO           Carrier Unused
     C                     Z-ADD*ZERO     WAAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WAAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WAKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBTQNX           CI Insurance Co
     C                     Z-ADD*ZERO     WBTRNX           CI Liability Am
     C                     Z-ADD*ZERO     WBO9DT           CI Date of Expi
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBCRRC.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  6
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004 30
     C                     MOVEL*BLANK    WL0005 20
     C                     MOVEL*BLANK    WL0006  2
     C                     MOVEL*BLANK    WL0007 11
     C                     Z-ADD*ZERO     WL0008 110
     C                     MOVEL*BLANK    WL0009 25
     C                     Z-ADD*ZERO     WL0010 110
     C                     Z-ADD*ZERO     WL0011  70
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     MOVEL*BLANK    WL0015  1
     C                     Z-ADD*ZERO     WL0016  60
     C                     MOVEL*BLANK    WL0017 10
     C                     MOVEL*BLANK    WL0018 10
     C                     Z-ADD*ZERO     WL0019  70
      *================================================================
     CSR         ZZEXIT    ENDSR
