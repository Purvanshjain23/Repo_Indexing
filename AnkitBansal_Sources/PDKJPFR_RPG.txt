     H/TITLE Prt Prod Availability PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 02/21/11  Time  : 11:03:18
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDKLREL2IF  E           K        DISK
      * RSQ : Company Item Avail Group  Co/Group/Item
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPDKKREL1IF  E           K        DISK
      * RTV : Availability Group        Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAADREL6IF  E           K        DISK
      * RSQ : Warehouse                 Typ/Whs
      *
     FPDI8CPL4IF  E           K        DISK
      * RSQ : PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      *
     FOPBGWKLFIF  E           K        DISK
      * RSQ : Order Detail              Co/Itm/Whs/SSD(d)/Od Omt
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDI8CPLCIF  E           K        DISK
      * RSQ : PS Prod Item Schedule     Co/Itm/Whs/ShpDte/Typ
      *
     FCAB0RELJIF  E           K        DISK
      * RTV : Item Balance              Acitve records only
      *
     FPOC3REL1IF  E           K        DISK
      * RTV : Availability Group Comnt  Retrieval index
      *
     FPDKJPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Prod Availability PF  Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WAAJCD
     I              ADF8NA                          WAF8NA
     I              ADACNA                          WAACNA
     I              ADADNA                          WAADNA
     I              ADAENA                          WAAENA
     I              ADAJNA                          WAAJNA
     I              ADBTTX                          WABTTX
     I              ADAOCD                          WAAOCD
     I              ADBGCD                          WABGCD
     I              ADVHST                          WAVHST
     I              ADMPNA                          WAMPNA
     I              ADWPST                          WAWPST
     I              ADXUST                          WAXUST
     I              ADT0ST                          WAT0ST
     I              ADT1ST                          WAT1ST
     I              ADDBNB                          WADBNB
     I              ADT2ST                          WAT2ST
     I              ADT3ST                          WAT3ST
     I              ADT4ST                          WAT4ST
     I              ADT6ST                          WAT6ST
     I              ADBWC3                          WABWC3
     I              ADBTC3                          WABTC3
     I              ADBUC3                          WABUC3
     I              ADBVC3                          WABVC3
     I              ADFCAA                          WAFCAA
     I              ADRQSX                          WARQSX
     I              ADRRSX                          WARRSX
     I              ADRSSX                          WARSSX
     I              ADRTSX                          WARTSX
     I              ADT7ST                          WAT7ST
     I              ADT8ST                          WAT8ST
     I              ADRNSX                          WARNSX
     I              ADROSX                          WAROSX
     I              ADRPSX                          WARPSX
     I              ADUVST                          WAUVST
     I              ADUWST                          WAUWST
     I              ADUXST                          WAUXST
     I              ADVSST                          WAVSST
     I              ADAATM                          WAAATM
     I              ADAYNA                          WAAYNA
     I              ADA0NA                          WAA0NA
     I              ADAXDT                          WAAXDT
      *
     I@ADREOJ
      * Warehouse                 Typ/Whs
      * Renamed input format fields
     I              ADAJCD                          WBAJCD
     I              ADF8NA                          WBF8NA
     I              ADACNA                          WBACNA
     I              ADADNA                          WBADNA
     I              ADAENA                          WBAENA
     I              ADAJNA                          WBAJNA
     I              ADBTTX                          WBBTTX
     I              ADAOCD                          WBAOCD
     I              ADBGCD                          WBBGCD
     I              ADVHST                          WBVHST
     I              ADMPNA                          WBMPNA
     I              ADWPST                          WBWPST
     I              ADXUST                          WBXUST
     I              ADT0ST                          WBT0ST
     I              ADT1ST                          WBT1ST
     I              ADDBNB                          WBDBNB
     I              ADT2ST                          WBT2ST
     I              ADT3ST                          WBT3ST
     I              ADT4ST                          WBT4ST
     I              ADT6ST                          WBT6ST
     I              ADBWC3                          WBBWC3
     I              ADBTC3                          WBBTC3
     I              ADBUC3                          WBBUC3
     I              ADBVC3                          WBBVC3
     I              ADFCAA                          WBFCAA
     I              ADRQSX                          WBRQSX
     I              ADRRSX                          WBRRSX
     I              ADRSSX                          WBRSSX
     I              ADRTSX                          WBRTSX
     I              ADT7ST                          WBT7ST
     I              ADT8ST                          WBT8ST
     I              ADRNSX                          WBRNSX
     I              ADROSX                          WBROSX
     I              ADRPSX                          WBRPSX
     I              ADUVST                          WBUVST
     I              ADUWST                          WBUWST
     I              ADUXST                          WBUXST
     I              ADVSST                          WBVSST
     I              ADAATM                          WBAATM
     I              ADAYNA                          WBAYNA
     I              ADA0NA                          WBA0NA
     I              ADAXDT                          WBAXDT
      *
     I@I8CPDZ
      * PS Prod Item Schedule     Co/Itm/Whs/ShpDte/Typ
      * Renamed input format fields
     I              I8AIC3                          WCAIC3
     I              I8V5ST                          WCV5ST
     I              I8ELDT                          WCELDT
     I              I8HGCD                          WCHGCD
     I              I8AJCD                          WCAJCD
     I              I8GPDT                          WCGPDT
     I              I8WTSP                          WCWTSP
     I              I8QTSP                          WCQTSP
     I              I8DJPC                          WCDJPC
     I              I8F8WG                          WCF8WG
     I              I8WTIN                          WCWTIN
     I              I8D5NB                          WCD5NB
     I              I8DXWG                          WCDXWG
     I              I8B2NB                          WCB2NB
     I              I8WTCN                          WCWTCN
     I              I8PSCV                          WCPSCV
     I              I8SAWT                          WCSAWT
     I              I8B9NB                          WCB9NB
     I              I8D1WG                          WCD1WG
     I              I8CBNB                          WCCBNB
     I              I8EZWG                          WCEZWG
     I              I8CCNB                          WCCCNB
     I              I8E0WG                          WCE0WG
     I              I8D6NB                          WCD6NB
     I              I8OAWT                          WCOAWT
     I              I8CDNB                          WCCDNB
     I              I8UNW2                          WCUNW2
     I              I8CENB                          WCCENB
     I              I8F9WG                          WCF9WG
     I              I8BPNB                          WCBPNB
     I              I8GAWG                          WCGAWG
     I              I8BQNB                          WCBQNB
     I              I8GBWG                          WCGBWG
     I              I8BRNB                          WCBRNB
     I              I8GCWG                          WCGCWG
     I              I8BSNB                          WCBSNB
     I              I8GDWG                          WCGDWG
     I              I8BWNB                          WCBWNB
     I              I8GEWG                          WCGEWG
     I              I8PS6U                          WCPS6U
     I              I8WCST                          WCWCST
     I              I8WPST                          WCWPST
     I              I8B5ST                          WCB5ST
     I              I8TFST                          WCTFST
     I              I8TEST                          WCTEST
     I              I8THST                          WCTHST
     I              I8UDST                          WCUDST
     I              I8UFST                          WCUFST
     I              I8UGST                          WCUGST
     I              I8UHST                          WCUHST
     I              I8B6ST                          WCB6ST
     I              I8B7ST                          WCB7ST
     I              I8DVWG                          WCDVWG
     I              I8D7NB                          WCD7NB
     I              I8FCAD                          WCFCAD
     I              I8D9NB                          WCD9NB
     I              I8DWWG                          WCDWWG
     I              I8EANB                          WCEANB
     I              I8SHWT                          WCSHWT
     I              I8EBNB                          WCEBNB
     I              I8AVWT                          WCAVWT
     I              I8ECNB                          WCECNB
     I              I8WTON                          WCWTON
     I              I8EDNB                          WCEDNB
     I              I8FNWT                          WCFNWT
     I              I8EENB                          WCEENB
     I              I8QTAS                          WCQTAS
     I              I8EFNB                          WCEFNB
     I              I8WAIO                          WCWAIO
     I              I8EGNB                          WCEGNB
     I              I8R3CD                          WCR3CD
     I              I8RGNB                          WCRGNB
     I              I8RHNB                          WCRHNB
     I              I8RINB                          WCRINB
     I              I8XRCD                          WCXRCD
     I              I8UVST                          WCUVST
     I              I8UWST                          WCUWST
     I              I8UXST                          WCUXST
     I              I8VSST                          WCVSST
     I              I8AATM                          WCAATM
     I              I8AYNA                          WCAYNA
     I              I8A0NA                          WCA0NA
     I              I8AXDT                          WCAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Company Item Avail Group
      * I : RST Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * I :  PS Available Ship Date
     I                                    P   1   40P2GPDT
     IP3PARM      DS
      * FLD: PS Prod Item Schedule
      * I :  Warehouse Code
     I                                        1   3 P3AJCD
      * I :  Warehouse Type
     I                                        4   5 P3WPST
     IP4PARM      DS
      * FLD: *Arrays
      * N :  Avail Ship Date 1 USR
     I                                    P   1   40P4H6DT
      * N :  Avail Ship Date 2 USR
     I                                    P   5   80P4H7DT
      * N :  Avail Ship Date 3 USR
     I                                    P   9  120P4H8DT
      * N :  Avail Ship Date 4 USR
     I                                    P  13  160P4H9DT
      * N :  Avail Ship Date 5 USR
     I                                    P  17  200P4IADT
      * N :  Avail Ship Date 6 USR
     I                                    P  21  240P4IBDT
      * N :  Avail Ship Date 7 USR
     I                                    P  25  280P4INDT
      * N :  Avail Ship Date 8 USR
     I                                    P  29  320P4IODT
      * N :  Avail Ship Date 9 USR
     I                                    P  33  360P4IPDT
      * N :  Avail Ship Date 10 USR
     I                                    P  37  400P4IQDT
      * N :  Avail Ship Date 11 USR
     I                                    P  41  440P4IRDT
      * N :  Avail Ship Date 12 USR
     I                                    P  45  480P4ISDT
      * N :  Avail Ship Date 13 USR
     I                                    P  49  520P4ITDT
      * N :  Avail Ship Date 14 USR
     I                                    P  53  560P4IUDT
      * N :  Avail Ship Date 15 USR
     I                                    P  57  600P4IVDT
      * N :  Avail Ship Date 16 USR
     I                                    P  61  640P4IWDT
      * N :  Avail Ship Date 17 USR
     I                                    P  65  680P4IXDT
      * N :  Avail Ship Date 18 USR
     I                                    P  69  720P4IYDT
      * N :  Avail Ship Date 19 USR
     I                                    P  73  760P4IZDT
      * N :  Avail Ship Date 20 USR
     I                                    P  77  800P4I0DT
      * N :  Avail Ship Date 21 USR
     I                                    P  81  840P4I1DT
      * N :  USR Day 1
     I                                    P  85  880P4FFDT
      * N :  USR Day 2
     I                                    P  89  920P4E1DT
      * N :  USR Day 3
     I                                    P  93  960P4E2DT
      * N :  USR Day 4
     I                                    P  97 1000P4E3DT
      * N :  USR Day 5
     I                                    P 101 1040P4E4DT
      * N :  USR Day 6
     I                                    P 105 1080P4E5DT
      * N :  USR Day 7
     I                                    P 109 1120P4E6DT
      * N :  USR Day 8
     I                                    P 113 1160P4FKDT
      * N :  USR Day 9
     I                                    P 117 1200P4FLDT
      * N :  USR Day 10
     I                                    P 121 1240P4FGDT
      * N :  USR Day 11
     I                                    P 125 1280P4FHDT
      * N :  USR Day 12
     I                                    P 129 1320P4FIDT
      * N :  USR Day 13
     I                                    P 133 1360P4FJDT
      * N :  USR Day 14
     I                                    P 137 1400P4HPDT
      * N :  USR Day 15
     I                                    P 141 1440P4HQDT
      * N :  USR Day 16
     I                                    P 145 1480P4HRDT
      * N :  USR Day 17
     I                                    P 149 1520P4HSDT
      * N :  USR Day 18
     I                                    P 153 1560P4HTDT
      * N :  USR Day 19
     I                                    P 157 1600P4HUDT
      * N :  USR Day 20
     I                                    P 161 1640P4HVDT
      * N :  USR Day 21
     I                                    P 165 1680P4HWDT
      * I :  Primary/Load Sts USR
     I                                      169 169 P4W4ST
      * I :  Load Size USR
     I                                    P 170 1730P4LDSZ
     IP5PARM      DS
      * FLD: Availability Group
      * I :  Availability Group Code
     I                                        1   3 P5V4CD
     IP6PARM      DS
      * FLD: Company Item
      * N :  Description Line One
     I                                        1  30 P6AVNA
      * N :  Unit Weight
     I                                    P  31  362P6AIWG
      * N :  Fresh Chilling Time
     I                                    P  37  392P6CHTM
      * N :  Piece Count Item
     I                                       40  40 P6PCCT
      * N :  Pieces Per Bag
     I                                    P  41  440P6BDNB
      * N :  Bags Per Unit
     I                                    P  45  480P6BJNB
     IP7PARM      DS
      * I :  Print Zeros USR
     I                                        1   1 P7PTZR
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2GPDT    PARM           WP0002  70       PS Available Sh
     C           P3AJCD    PARM           WP0003  3        Warehouse Code
     C           P3WPST    PARM           WP0004  2        Warehouse Type
     C           P4W4ST    PARM           WP0005  1        Primary/Load St
     C           P4LDSZ    PARM           WP0006  70       Load Size USR
     C           P5V4CD    PARM           WP0007  3        Availability Gr
     C           P7PTZR    PARM           WP0008  1        Print Zeros USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Prod Availability PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$HENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Prod Availability PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN KLAIC3    WQKA01           Company Number
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQKA01           Company Number
      * Establish starting position
     C           KRSA      SETLL@KLREHI                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Availability Gr
     C                     MOVEL'Y'       W0AL02  1        Item Display Se
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $CAIC3           Company Number
     C                     MOVEL*BLANK    $CADTX           Name
     C                     MOVEL*BLANK    $CWPST           Warehouse Type
     C                     MOVEL*BLANK    $CNENA           Warehouse Type
     C                     MOVEL*BLANK    $CAJCD           Warehouse Code
     C                     MOVEL*BLANK    $CF8NA           Warehouse Descr
     C                     MOVEL*BLANK    $CV4CD           Availability Gr
     C                     MOVEL*BLANK    $CNVNA           Availability Gr
     C                     MOVEL*BLANK    $CW4ST           Primary/Load St
     C                     MOVEL*BLANK    $CHLTX           Condition Desc.
     C                     Z-ADD*ZERO     $CLDSZ           Load Size USR
     C                     MOVEL*BLANK    $CPTZR           Print Zeros USR
     C                     MOVEL*BLANK    $CHMTX           Condition Desc.
      * USER: Process before print of first page format
      * 1PG = PAR By name
     C                     Z-ADDP1AIC3    $CAIC3           Company Number
     C                     MOVELP3WPST    $CWPST           Warehouse Type
     C                     MOVELP3AJCD    $CAJCD           Warehouse Code
     C                     MOVELP5V4CD    $CV4CD           Availability Gr
     C                     MOVELP4W4ST    $CW4ST           Primary/Load St
     C                     Z-ADDP4LDSZ    $CLDSZ           Load Size USR
     C                     MOVELP7PTZR    $CPTZR           Print Zeros USR
      * Company
      * CASE: 1PG.Company Number is Equal to zero
     C           $CAIC3    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    $CADTX           Name
     C                     MOVEL'*All'    $CADTX           Name
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SERVGN
     C                     END                             *FI
      * Warehouse type
      * CASE: 1PG.Warehouse Type EQ WRK.BLANK 1               USR
     C           $CWPST    IFEQ WUJ1TX                     *IF
     C                     MOVEL*BLANK    $CNENA           Warehouse Type
     C                     MOVEL'*All'    $CNENA           Warehouse Type
     C                     ELSE
      * CASE: *OTHERWISE
      * 1PG.Warehouse Type Desc = Condition name of 1PG.Warehouse Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1275008   Y2LSNO  70       List number
     C                     PARM $CWPST    W0INVL 25        Warehouse Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CNENA    PARM           W0CNNM 25        Warehouse Type
      *
     C                     END                             *FI
      * Warehouse
      * CASE: 1PG.Warehouse Code is Warehouse Code Blank
     C           $CAJCD    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CF8NA           Warehouse Descr
     C                     MOVEL'*All'    $CF8NA           Warehouse Descr
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
      * Availability Group
      * CASE: 1PG.Availability Group Code is Blank
     C           $CV4CD    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CNVNA           Availability Gr
     C                     MOVEL'*ALL'    $CNVNA           Availability Gr
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Group Description RT - Availability Group  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
      * Unit of Measure
      * CASE: 1PG.Primary/Load Sts USR is *ALL values
     C           $CW4ST    IFEQ 'P'                        *IF
     C           $CW4ST    OREQ 'L'
      * 1PG.Condition Desc. 1  USR = Condition name of 1PG.Primary/Load S
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1280423   Y2LSNO  70       List number
     C                     PARM $CW4ST    W0INVL 25        Primary/Load St
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CHLTX           Condition Desc.
     C                     MOVEL'*All'    $CHLTX           Condition Desc.
     C                     END                             *FI
      * Load Size
      * CASE: 1PG.Primary/Load Sts USR is Primary
     C           $CW4ST    IFEQ 'P'                        *IF
     C                     Z-ADD*ZERO     $CLDSZ           Load Size USR
     C                     END                             *FI
      * 1PG.Condition Desc. 2  USR = Condition name of 1PG.Print Zeros US
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM $CPTZR    W0INVL 25        Print Zeros USR
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CHMTX    PARM           W0CNNM 25        Condition Desc.
      *
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDKLAIC3    $EAIC3           Company Number
     C                     MOVELKLV4CD    $EV4CD           Availability Gr
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDKLAIC3    $DAIC3           Company Number
     C                     Z-ADDKLHGCD    $DHGCD           Item Code
     C                     MOVEL*BLANK    $DAVNA           Description Lin
     C                     MOVEL*BLANK    $DADCD           U/M - Primary
     C                     Z-ADD*ZERO     $DD1AV           Day 1 Availabil
     C                     Z-ADD*ZERO     $DD2AV           Day 2 Availabil
     C                     Z-ADD*ZERO     $DD3AV           Day 3 Availabil
     C                     Z-ADD*ZERO     $DD4AV           Day 4 Availabil
     C                     Z-ADD*ZERO     $DD5AV           Day 5 Availabil
     C                     Z-ADD*ZERO     $DD6AV           Day 6 Availabil
     C                     Z-ADD*ZERO     $DD7AV           Day 7 Availabil
     C                     Z-ADD*ZERO     $DD8AV           Day 8 Availabil
     C                     Z-ADD*ZERO     $DD9AV           Day 9 Availabil
     C                     Z-ADD*ZERO     $DD1AB           Day 10 Availabi
     C                     Z-ADD*ZERO     $DD2AB           Day 11 Availabi
     C                     Z-ADD*ZERO     $DD3AB           Day 12 Availabi
     C                     Z-ADD*ZERO     $DD4AB           Day 13 Availabi
     C                     Z-ADD*ZERO     $DD5AB           Day 14 Availabi
     C                     Z-ADD*ZERO     $DD6AB           Day 15 Availabi
     C                     Z-ADD*ZERO     $DD7AB           Day 16 Availabi
     C                     Z-ADD*ZERO     $DD8AB           Day 17 Availabi
     C                     Z-ADD*ZERO     $DD9AB           Day 18 Availabi
     C                     Z-ADD*ZERO     $DD1AL           Day 19 Availabi
     C                     Z-ADD*ZERO     $DD1AQ           Day 1 ATS Qty U
     C                     Z-ADD*ZERO     $DD2AQ           Day 2 ATS Qty U
     C                     Z-ADD*ZERO     $DD3AQ           Day 3 ATS Qty U
     C                     Z-ADD*ZERO     $DD4AQ           Day 4 ATS Qty U
     C                     Z-ADD*ZERO     $DD5AQ           Day 5 ATS Qty U
     C                     Z-ADD*ZERO     $DD6AQ           Day 6 ATS Qty U
     C                     Z-ADD*ZERO     $DD7AQ           Day 7 ATS Qty U
     C                     Z-ADD*ZERO     $DD8AQ           Day 8 ATS Qty U
     C                     Z-ADD*ZERO     $DD9AQ           Day 9 ATS Qty U
     C                     Z-ADD*ZERO     $DD1AT           Day 10 ATS Qty
     C                     Z-ADD*ZERO     $DD2AT           Day 11 ATS Qty
     C                     Z-ADD*ZERO     $DD3AT           Day 12 ATS Qty
     C                     Z-ADD*ZERO     $DD4AT           Day 13 ATS Qty
     C                     Z-ADD*ZERO     $DD5AT           Day 14 ATS Qty
     C                     Z-ADD*ZERO     $DD6AT           Day 15 ATS Qty
     C                     Z-ADD*ZERO     $DD7AT           Day 16 ATS Qty
     C                     Z-ADD*ZERO     $DD9AT           Day 17 ATS Qty
     C                     Z-ADD*ZERO     $DD1AS           Day 18 ATS Qty
     C                     Z-ADD*ZERO     $DD2AS           Day 19 ATS Qty
     C                     Z-ADD*ZERO     $DD3AS           Day 20 ATS Qty
     C                     Z-ADD*ZERO     $DD4AS           Day 21 ATS Qty
     C                     Z-ADD*ZERO     $DD2AL           Day 20 Availabi
     C                     Z-ADD*ZERO     $DD3AL           Day 21 Availabi
     C                     MOVELKLV4CD    $DV4CD           Availability Gr
     C                     Z-ADDKLIDSQ    $DIDSQ           Item Display Se
     C                     MOVELKLUVST    $DUVST           EDI Status 1
     C                     MOVELKLUWST    $DUWST           EDI Status 2
     C                     MOVELKLUXST    $DUXST           EDI Status 3
     C                     MOVELKLVSST    $DVSST           Record Status
     C                     Z-ADDKLAATM    $DAATM           Job Time
     C                     MOVELKLAYNA    $DAYNA           User Id
     C                     MOVELKLA0NA    $DA0NA           Job Name
     C                     Z-ADDKLAXDT    $DAXDT           Job Date
      * USER: Process before print of detail format
      *
     C                     Z-ADD*ZERO     WN0001 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
     C                     EXSR SHRVGN
      * BPS Rtv Whs Info      RT - Warehouse  * 
     C                     EXSR SIRVGN
      * Rtv PA Tot SD-21      RT - Warehouse  * 
     C                     EXSR SJRVGN
      * WRK fields not being used
      * Total Availability 1-19
      * WRK.Quantity Avail. to Sell =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 +
      *    x11 + x12 + x13 + x14 + x15 + x16 + x17 + x18 + x19)
      * x1    : CUR.Day 1 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Day 2 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Day 3 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Day 4 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Day 5 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x6    : CUR.Day 6 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x7    : CUR.Day 7 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x8    : CUR.Day 8 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x9    : CUR.Day 9 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x10   : CUR.Day 10 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x11   : CUR.Day 11 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x12   : CUR.Day 12 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x13   : CUR.Day 13 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x14   : CUR.Day 14 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x15   : CUR.Day 15 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x16   : CUR.Day 16 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x17   : CUR.Day 17 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x18   : CUR.Day 18 Availability USR
      * +     : PGM.*Synon (17,7) work field
      * x19   : CUR.Day 19 Availability USR
     C           $DD1AV    ADD  $DD2AV    W0WD17           *Synon (17,7) w
     C           W0WD17    ADD  $DD3AV    W0WD16           *Synon (17,7) w
     C           W0WD16    ADD  $DD4AV    W0WD15           *Synon (17,7) w
     C           W0WD15    ADD  $DD5AV    W0WD14           *Synon (17,7) w
     C           W0WD14    ADD  $DD6AV    W0WD13           *Synon (17,7) w
     C           W0WD13    ADD  $DD7AV    W0WD12           *Synon (17,7) w
     C           W0WD12    ADD  $DD8AV    W0WD11           *Synon (17,7) w
     C           W0WD11    ADD  $DD9AV    W0WD10           *Synon (17,7) w
     C           W0WD10    ADD  $DD1AB    W0WD09           *Synon (17,7) w
     C           W0WD09    ADD  $DD2AB    W0WD08           *Synon (17,7) w
     C           W0WD08    ADD  $DD3AB    W0WD07           *Synon (17,7) w
     C           W0WD07    ADD  $DD4AB    W0WD06           *Synon (17,7) w
     C           W0WD06    ADD  $DD5AB    W0WD05           *Synon (17,7) w
     C           W0WD05    ADD  $DD6AB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  $DD7AB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $DD8AB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $DD9AB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $DD1AL    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUDOQT           Quantity Avail.
      * CASE: PAR.Primary/Load Sts USR is Load Size
     C           P4W4ST    IFEQ 'L'                        *IF
     C                     MOVEL'LD'      $DADCD           U/M - Primary
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN KLAIC3    WZA001           Company Number
     C                     Z-ADDKLAIC3    WZA001
     C           *LIKE     DEFN KLV4CD    WZA002           Availability Gr
     C                     MOVELKLV4CD    WZA002
     C           *LIKE     DEFN KLIDSQ    WZA003           Item Display Se
     C                     Z-ADDKLIDSQ    WZA003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@KLREHI                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: PAR.Availability Group Code NE DB1.Availability Group Code
     C           P5V4CD    IFNE KLV4CD                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: PAR.Warehouse Code is Warehouse Code not Blank
     C           P3AJCD    IFNE *BLANK                     *IF
      * Val Item Bal Exist    RT - IC Item Balance  * 
     C                     EXSR SPRVGN
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Availability Gr
     C                     MOVEL*BLANK    W0AL02  1        Item Display Se
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Availability Gr
     C                     MOVEL'Y'       W0AL02  1        Item Display Se
     C                     ELSE
      * Next record - Detect level breaks
     C           KLAIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           KLV4CD    IFNE WZA002                     Availability Gr
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           KLIDSQ    IFNE WZA003                     Item Display Se
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$EKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
      * PRTOBJ calls after print of Availability Group Code format
      * Embedded PRTOBJ : Prt Avail Group Comnt PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Avail Group Comnt PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt Avail Group Comnt PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN C3V4CD    WQKB01           Availability Gr
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Availability Gr
      * Setup key
     C                     MOVEL$EV4CD    WQKB01           Availability Gr
      * Establish starting position
     C           KRSB      SETLL@C3RER7                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Availability Gr
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELC3V4CD    $FV4CD           Availability Gr
     C                     Z-ADDC3DXNB    $FDXNB           Sequence Number
     C                     MOVELC3QKNA    $FQKNA           PA Group Commen
     C                     MOVELC3UVST    $FUVST           EDI Status 1
     C                     MOVELC3UWST    $FUWST           EDI Status 2
     C                     MOVELC3UXST    $FUXST           EDI Status 3
     C                     MOVELC3VSST    $FVSST           Record Status
     C                     Z-ADDC3AATM    $FAATM           Job Time
     C                     MOVELC3AYNA    $FAYNA           User Id
     C                     MOVELC3A0NA    $FA0NA           Job Name
     C                     Z-ADDC3AXDT    $FAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN C3V4CD    WZB001           Availability Gr
     C                     MOVELC3V4CD    WZB001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@C3RER7                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Availability Gr
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Availability Gr
     C                     ELSE
      * Next record - Detect level breaks
     C           C3V4CD    IFNE WZB001                     Availability Gr
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt Avail Group Comnt PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN C3V4CD    WQKC01           Availability Gr
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Availability Gr
      * Setup key
     C                     MOVEL'ALL'     WQKC01           Availability Gr
      * Establish starting position
     C           KRSC      SETLL@C3RER7                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Availability Gr
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELC3V4CD    $GV4CD           Availability Gr
     C                     Z-ADDC3DXNB    $GDXNB           Sequence Number
     C                     MOVELC3QKNA    $GQKNA           PA Group Commen
     C                     MOVELC3UVST    $GUVST           EDI Status 1
     C                     MOVELC3UWST    $GUWST           EDI Status 2
     C                     MOVELC3UXST    $GUXST           EDI Status 3
     C                     MOVELC3VSST    $GVSST           Record Status
     C                     Z-ADDC3AATM    $GAATM           Job Time
     C                     MOVELC3AYNA    $GAYNA           User Id
     C                     MOVELC3A0NA    $GA0NA           Job Name
     C                     Z-ADDC3AXDT    $GAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN C3V4CD    WZC001           Availability Gr
     C                     MOVELC3V4CD    WZC001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@C3RER7                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Availability Gr
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Availability Gr
     C                     ELSE
      * Next record - Detect level breaks
     C           C3V4CD    IFNE WZC001                     Availability Gr
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Prod Availability PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Prod Availability PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $CAIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$CAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VCAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$C1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of Prt Prod Availability PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Availability Group Code of Prt Prod Availability PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Item Display Sequence of Prt Prod Availability PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Detail line. of Prt Prod Availability PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: PAR.Print Zeros USR is no
     C           P7PTZR    IFEQ 'N'                        *IF
      * CASE: WRK.Quantity Avail. to Sell is Equal to zero
     C           WUDOQT    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DHGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$DCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$DDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Prt Avail Group Comnt PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Availability Group Code of Prt Avail Group Comnt PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Detail line. of Prt Avail Group Comnt PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$FDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt Avail Group Comnt PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Availability Group Code of Prt Avail Group Comnt PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Detail line. of Prt Avail Group Comnt PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$GCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$GDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Prod Availability PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  9         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Prod Availability PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Availability Group Code of Prt Prod Availability PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Display Sequence of Prt Prod Availability PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Prod Availability PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD4         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Avail Group Comnt PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Availability Group Code of Prt Avail Group Comnt PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Avail Group Comnt PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Avail Group Comnt PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Availability Group Code of Prt Avail Group Comnt PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Avail Group Comnt PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * TOP = PAR By name
     C                     Z-ADDP4FFDT    $BFFDT           USR Day 1
     C                     Z-ADDP4E1DT    $BE1DT           USR Day 2
     C                     Z-ADDP4E2DT    $BE2DT           USR Day 3
     C                     Z-ADDP4E3DT    $BE3DT           USR Day 4
     C                     Z-ADDP4E4DT    $BE4DT           USR Day 5
     C                     Z-ADDP4E5DT    $BE5DT           USR Day 6
     C                     Z-ADDP4E6DT    $BE6DT           USR Day 7
     C                     Z-ADDP4FKDT    $BFKDT           USR Day 8
     C                     Z-ADDP4FLDT    $BFLDT           USR Day 9
     C                     Z-ADDP4FGDT    $BFGDT           USR Day 10
     C                     Z-ADDP4FHDT    $BFHDT           USR Day 11
     C                     Z-ADDP4FIDT    $BFIDT           USR Day 12
     C                     Z-ADDP4FJDT    $BFJDT           USR Day 13
     C                     Z-ADDP4HPDT    $BHPDT           USR Day 14
     C                     Z-ADDP4HQDT    $BHQDT           USR Day 15
     C                     Z-ADDP4HRDT    $BHRDT           USR Day 16
     C                     Z-ADDP4HSDT    $BHSDT           USR Day 17
     C                     Z-ADDP4HTDT    $BHTDT           USR Day 18
     C                     Z-ADDP4HUDT    $BHUDT           USR Day 19
     C                     Z-ADDP4HVDT    $BHVDT           USR Day 20
     C                     Z-ADDP4HWDT    $BHWDT           USR Day 21
      * Convert fields to external form
      * Convert USR Day 1 to display format
      * Convert date
     C           1000000   ADD  $BFFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBFFDT
      * Convert USR Day 2 to display format
      * Convert date
     C           1000000   ADD  $BE1DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBE1DT
      * Convert USR Day 3 to display format
      * Convert date
     C           1000000   ADD  $BE2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBE2DT
      * Convert USR Day 4 to display format
      * Convert date
     C           1000000   ADD  $BE3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBE3DT
      * Convert USR Day 5 to display format
      * Convert date
     C           1000000   ADD  $BE4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBE4DT
      * Convert USR Day 6 to display format
      * Convert date
     C           1000000   ADD  $BE5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBE5DT
      * Convert USR Day 7 to display format
      * Convert date
     C           1000000   ADD  $BE6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBE6DT
      * Convert USR Day 8 to display format
      * Convert date
     C           1000000   ADD  $BFKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBFKDT
      * Convert USR Day 9 to display format
      * Convert date
     C           1000000   ADD  $BFLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBFLDT
      * Convert USR Day 10 to display format
      * Convert date
     C           1000000   ADD  $BFGDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBFGDT
      * Convert USR Day 11 to display format
      * Convert date
     C           1000000   ADD  $BFHDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBFHDT
      * Convert USR Day 12 to display format
      * Convert date
     C           1000000   ADD  $BFIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBFIDT
      * Convert USR Day 13 to display format
      * Convert date
     C           1000000   ADD  $BFJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBFJDT
      * Convert USR Day 14 to display format
      * Convert date
     C           1000000   ADD  $BHPDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBHPDT
      * Convert USR Day 15 to display format
      * Convert date
     C           1000000   ADD  $BHQDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBHQDT
      * Convert USR Day 16 to display format
      * Convert date
     C           1000000   ADD  $BHRDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBHRDT
      * Convert USR Day 17 to display format
      * Convert date
     C           1000000   ADD  $BHSDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBHSDT
      * Convert USR Day 18 to display format
      * Convert date
     C           1000000   ADD  $BHTDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBHTDT
      * Convert USR Day 19 to display format
      * Convert date
     C           1000000   ADD  $BHUDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBHUDT
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Kill/Prod Day Sts RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDP1AIC3    AFAIC3           Company Number
     C                     Z-ADD##JDT     AFBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSA     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Kill Day Status
     C                     MOVEL*BLANK    YL0002           Production Day
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAFV9ST    YL0001           Kill Day Status
     C                     MOVELAFWAST    YL0002           Production Day
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSB01           Application Cod
     C                     MOVEL'OMS'     WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSC01           Application Cod
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSC01           Application Cod
      * Establish starting position
     C           KRSSC     SETLL@DNRESF                    *
     C           KRSSC     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSC     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Ats ShpDte-21+Sun RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQSD01           Company Number
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSD01           Company Number
     C                     Z-ADDP2GPDT    AFBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSD     SETLL@AFREBE                    *
     C           KRSSD     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR is GT 21
     C           WUCNTU    IFGT 21                         *IF
     C                     GOTO SDEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Move Date
      * CASE: WRK.Count USR is One
     C           WUCNTU    IFEQ 1                          *IF
     C                     Z-ADDAFBCDT    P4FFDT           USR Day 1
      * WRK.Condition Desc. 1  USR = Condition name of DB1.Day of Week
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1159101   Y2LSNO  70       List number
     C                     PARM AFA9ST    W0INVL 25        Day of Week
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     ELSE
      * CASE: WRK.Count USR is Two
     C           WUCNTU    IFEQ 2                          *IF
     C                     Z-ADDAFBCDT    P4E1DT           USR Day 2
      * WRK.Condition Desc. 2  USR = Condition name of DB1.Day of Week
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1159101   Y2LSNO  70       List number
     C                     PARM AFA9ST    W0INVL 25        Day of Week
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUHMTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     ELSE
      * CASE: WRK.Count USR is Three
     C           WUCNTU    IFEQ 3                          *IF
     C                     Z-ADDAFBCDT    P4E2DT           USR Day 3
      * WRK.Condition Desc. 3  USR = Condition name of DB1.Day of Week
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1159101   Y2LSNO  70       List number
     C                     PARM AFA9ST    W0INVL 25        Day of Week
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUHNTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     ELSE
      * CASE: WRK.Count USR is Four
     C           WUCNTU    IFEQ 4                          *IF
     C                     Z-ADDAFBCDT    P4E3DT           USR Day 4
      * WRK.Condition Desc. 4  USR = Condition name of DB1.Day of Week
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1159101   Y2LSNO  70       List number
     C                     PARM AFA9ST    W0INVL 25        Day of Week
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUHOTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     ELSE
      * CASE: WRK.Count USR is Five
     C           WUCNTU    IFEQ 5                          *IF
     C                     Z-ADDAFBCDT    P4E4DT           USR Day 5
      * WRK.Condition Desc. 5  USR = Condition name of DB1.Day of Week
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1159101   Y2LSNO  70       List number
     C                     PARM AFA9ST    W0INVL 25        Day of Week
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUHPTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     ELSE
      * CASE: WRK.Count USR is Six
     C           WUCNTU    IFEQ 6                          *IF
     C                     Z-ADDAFBCDT    P4E5DT           USR Day 6
      * WRK.Condition Desc. 6  USR = Condition name of DB1.Day of Week
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1159101   Y2LSNO  70       List number
     C                     PARM AFA9ST    W0INVL 25        Day of Week
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUHQTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     ELSE
      * CASE: WRK.Count USR is Seven
     C           WUCNTU    IFEQ 7                          *IF
     C                     Z-ADDAFBCDT    P4E6DT           USR Day 7
      * WRK.Condition Desc. 7  USR = Condition name of DB1.Day of Week
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1159101   Y2LSNO  70       List number
     C                     PARM AFA9ST    W0INVL 25        Day of Week
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUHRTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     ELSE
      * CASE: WRK.Count USR is Eight
     C           WUCNTU    IFEQ 8                          *IF
     C                     Z-ADDAFBCDT    P4FKDT           USR Day 8
     C                     ELSE
      * CASE: WRK.Count USR is Nine
     C           WUCNTU    IFEQ 9                          *IF
     C                     Z-ADDAFBCDT    P4FLDT           USR Day 9
     C                     ELSE
      * CASE: WRK.Count USR is Ten
     C           WUCNTU    IFEQ 10                         *IF
     C                     Z-ADDAFBCDT    P4FGDT           USR Day 10
     C                     ELSE
      * CASE: WRK.Count USR is Eleven
     C           WUCNTU    IFEQ 11                         *IF
     C                     Z-ADDAFBCDT    P4FHDT           USR Day 11
     C                     ELSE
      * CASE: WRK.Count USR is Twelve
     C           WUCNTU    IFEQ 12                         *IF
     C                     Z-ADDAFBCDT    P4FIDT           USR Day 12
     C                     ELSE
      * CASE: WRK.Count USR is Thirteen
     C           WUCNTU    IFEQ 13                         *IF
     C                     Z-ADDAFBCDT    P4FJDT           USR Day 13
     C                     ELSE
      * CASE: WRK.Count USR is Fourteen
     C           WUCNTU    IFEQ 14                         *IF
     C                     Z-ADDAFBCDT    P4HPDT           USR Day 14
     C                     ELSE
      * CASE: WRK.Count USR is Fifteen
     C           WUCNTU    IFEQ 15                         *IF
     C                     Z-ADDAFBCDT    P4HQDT           USR Day 15
     C                     ELSE
      * CASE: WRK.Count USR is Sixteen
     C           WUCNTU    IFEQ 16                         *IF
     C                     Z-ADDAFBCDT    P4HRDT           USR Day 16
     C                     ELSE
      * CASE: WRK.Count USR is Seventeen
     C           WUCNTU    IFEQ 17                         *IF
     C                     Z-ADDAFBCDT    P4HSDT           USR Day 17
     C                     ELSE
      * CASE: WRK.Count USR is Eighteen
     C           WUCNTU    IFEQ 18                         *IF
     C                     Z-ADDAFBCDT    P4HTDT           USR Day 18
     C                     ELSE
      * CASE: WRK.Count USR is Nineteen
     C           WUCNTU    IFEQ 19                         *IF
     C                     Z-ADDAFBCDT    P4HUDT           USR Day 19
     C                     ELSE
      * CASE: WRK.Count USR is Twenty
     C           WUCNTU    IFEQ 20                         *IF
     C                     Z-ADDAFBCDT    P4HVDT           USR Day 20
     C                     ELSE
      * CASE: WRK.Count USR is Twenty One
     C           WUCNTU    IFEQ 21                         *IF
     C                     Z-ADDAFBCDT    P4HWDT           USR Day 21
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSSD     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$CAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSE     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $CADTX           Name
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $CADTX           Name
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL$CAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    $CF8NA           Warehouse Descr
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    $CF8NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Group Description RT - Availability Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           KKV4CD           Availability Gr
      * Setup key
     C                     MOVEL$CV4CD    KKV4CD           Availability Gr
      * Establish starting position
     C           KRSSG     CHAIN@KKREG7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2215' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $CNVNA           Availability Gr
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKKNVNA    $CNVNA           Availability Gr
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD$DAIC3    BZAIC3           Company Number
     C                     Z-ADD$DHGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSH     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DAVNA           Description Lin
     C                     MOVEL*BLANK    $DADCD           U/M - Primary
     C                     Z-ADD*ZERO     P6AIWG           Unit Weight
     C                     Z-ADD*ZERO     WURINB           Item Structure
     C                     Z-ADD*ZERO     WURHNB           Item Structure
     C                     Z-ADD*ZERO     WURGNB           Item Structure
     C                     MOVEL*BLANK    WUN0CD           Item Type Code
     C                     MOVEL*BLANK    WUQ1CD           Default Warehou
     C                     Z-ADD*ZERO     P6CHTM           Fresh Chilling
     C                     MOVEL*BLANK    WUQZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    WUXWST           Variety/Rendere
     C                     MOVEL*BLANK    WUVMST           Credit Item Sta
     C                     Z-ADD*ZERO     WUSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WUPPHE           Pieces Per Head
     C                     MOVEL*BLANK    WUR3CD           Department Code
     C                     MOVEL*BLANK    WUSDCD           Group for Packa
     C                     MOVEL*BLANK    WUX5ST           Seconds Item
     C                     MOVEL*BLANK    P6PCCT           Piece Count Ite
     C                     Z-ADD*ZERO     P6BDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     P6BJNB           Bags Per Unit
     C                     MOVEL*BLANK    WUSUST           Export/Domestic
     C                     MOVEL*BLANK    WUSVST           Print On Schedu
     C                     MOVEL*BLANK    WUSYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    WUSZST           Fresh Sched As
     C                     MOVEL*BLANK    WUS1ST           Frozen Inv Allo
     C                     MOVEL*BLANK    WUXRCD           Primal Group Co
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    $DAVNA           Description Lin
     C                     MOVELBZADCD    $DADCD           U/M - Primary
     C                     Z-ADDBZAIWG    P6AIWG           Unit Weight
     C                     Z-ADDBZRINB    WURINB           Item Structure
     C                     Z-ADDBZRHNB    WURHNB           Item Structure
     C                     Z-ADDBZRGNB    WURGNB           Item Structure
     C                     MOVELBZN0CD    WUN0CD           Item Type Code
     C                     MOVELBZQ1CD    WUQ1CD           Default Warehou
     C                     Z-ADDBZCHTM    P6CHTM           Fresh Chilling
     C                     MOVELBZQZCD    WUQZCD           Base/Conv/Loss
     C                     MOVELBZXWST    WUXWST           Variety/Rendere
     C                     MOVELBZVMST    WUVMST           Credit Item Sta
     C                     Z-ADDBZSWGH    WUSWGH           Std Weight/Head
     C                     Z-ADDBZPPHE    WUPPHE           Pieces Per Head
     C                     MOVELBZR3CD    WUR3CD           Department Code
     C                     MOVELBZSDCD    WUSDCD           Group for Packa
     C                     MOVELBZX5ST    WUX5ST           Seconds Item
     C                     MOVELBZPCCT    P6PCCT           Piece Count Ite
     C                     Z-ADDBZBDNB    P6BDNB           Pieces Per Bag
     C                     Z-ADDBZBJNB    P6BJNB           Bags Per Unit
     C                     MOVELBZSUST    WUSUST           Export/Domestic
     C                     MOVELBZSVST    WUSVST           Print On Schedu
     C                     MOVELBZSYST    WUSYST           Fresh Inv Alloc
     C                     MOVELBZSZST    WUSZST           Fresh Sched As
     C                     MOVELBZS1ST    WUS1ST           Frozen Inv Allo
     C                     MOVELBZXRCD    WUXRCD           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVELP3AJCD    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSI     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUWPST           Warehouse Type
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     MOVEL*BLANK    WUT0ST           Warehouse Locat
     C                     MOVEL*BLANK    WUT1ST           Warehouse Std C
     C                     Z-ADD*ZERO     WUDBNB           Warehouse Chill
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAWPST    WUWPST           Warehouse Type
     C                     MOVELWAXUST    WUXUST           Trans Contol AS
     C                     MOVELWAT0ST    WUT0ST           Warehouse Locat
     C                     MOVELWAT1ST    WUT1ST           Warehouse Std C
     C                     Z-ADDWADBNB    WUDBNB           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv PA Tot SD-21      RT - Warehouse  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  70       USR Day 1
     C                     Z-ADD*ZERO     WN0003  70       USR Day 2
     C                     Z-ADD*ZERO     WN0004  70       USR Day 3
     C                     Z-ADD*ZERO     WN0005  70       USR Day 4
     C                     Z-ADD*ZERO     WN0006  70       USR Day 5
     C                     Z-ADD*ZERO     WN0007  70       USR Day 6
     C                     Z-ADD*ZERO     WN0008  70       USR Day 7
     C                     Z-ADD*ZERO     WN0009  70       USR Day 8
     C                     Z-ADD*ZERO     WN0010  70       USR Day 9
     C                     Z-ADD*ZERO     WN0011  70       USR Day 10
     C                     Z-ADD*ZERO     WN0012  70       USR Day 11
     C                     Z-ADD*ZERO     WN0013  70       USR Day 12
     C                     Z-ADD*ZERO     WN0014  70       USR Day 13
     C                     Z-ADD*ZERO     WN0015  70       USR Day 14
     C                     Z-ADD*ZERO     WN0016  70       USR Day 15
     C                     Z-ADD*ZERO     WN0017  70       USR Day 16
     C                     Z-ADD*ZERO     WN0018  70       USR Day 17
     C                     Z-ADD*ZERO     WN0019  70       USR Day 18
     C                     Z-ADD*ZERO     WN0020  70       USR Day 19
     C                     Z-ADD*ZERO     WN0021  70       USR Day 20
     C                     Z-ADD*ZERO     WN0022  70       USR Day 21
     C                     Z-ADD*ZERO     WN0023  61       Day 1 Availabil
     C                     Z-ADD*ZERO     WN0024  61       Day 2 Availabil
     C                     Z-ADD*ZERO     WN0025  61       Day 3 Availabil
     C                     Z-ADD*ZERO     WN0026  61       Day 4 Availabil
     C                     Z-ADD*ZERO     WN0027  61       Day 5 Availabil
     C                     Z-ADD*ZERO     WN0028  61       Day 6 Availabil
     C                     Z-ADD*ZERO     WN0029  61       Day 7 Availabil
     C                     Z-ADD*ZERO     WN0030  61       Day 8 Availabil
     C                     Z-ADD*ZERO     WN0031  61       Day 9 Availabil
     C                     Z-ADD*ZERO     WN0032  61       Day 10 Availabi
     C                     Z-ADD*ZERO     WN0033  61       Day 11 Availabi
     C                     Z-ADD*ZERO     WN0034  61       Day 12 Availabi
     C                     Z-ADD*ZERO     WN0035  61       Day 13 Availabi
     C                     Z-ADD*ZERO     WN0036  61       Day 14 Availabi
     C                     Z-ADD*ZERO     WN0037  61       Day 15 Availabi
     C                     Z-ADD*ZERO     WN0038  61       Day 16 Availabi
     C                     Z-ADD*ZERO     WN0039  61       Day 17 Availabi
     C                     Z-ADD*ZERO     WN0040  61       Day 18 Availabi
     C                     Z-ADD*ZERO     WN0041  61       Day 19 Availabi
     C                     Z-ADD*ZERO     WN0042  61       Day 20 Availabi
     C                     Z-ADD*ZERO     WN0043  61       Day 21 Availabi
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * FP1054 5/20/09  made inventory parms "B"oth, they werent anything
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0002           USR Day 1
     C                     Z-ADD*ZERO     WN0003           USR Day 2
     C                     Z-ADD*ZERO     WN0004           USR Day 3
     C                     Z-ADD*ZERO     WN0005           USR Day 4
     C                     Z-ADD*ZERO     WN0006           USR Day 5
     C                     Z-ADD*ZERO     WN0007           USR Day 6
     C                     Z-ADD*ZERO     WN0008           USR Day 7
     C                     Z-ADD*ZERO     WN0009           USR Day 8
     C                     Z-ADD*ZERO     WN0010           USR Day 9
     C                     Z-ADD*ZERO     WN0011           USR Day 10
     C                     Z-ADD*ZERO     WN0012           USR Day 11
     C                     Z-ADD*ZERO     WN0013           USR Day 12
     C                     Z-ADD*ZERO     WN0014           USR Day 13
     C                     Z-ADD*ZERO     WN0015           USR Day 14
     C                     Z-ADD*ZERO     WN0016           USR Day 15
     C                     Z-ADD*ZERO     WN0017           USR Day 16
     C                     Z-ADD*ZERO     WN0018           USR Day 17
     C                     Z-ADD*ZERO     WN0019           USR Day 18
     C                     Z-ADD*ZERO     WN0020           USR Day 19
     C                     Z-ADD*ZERO     WN0021           USR Day 20
     C                     Z-ADD*ZERO     WN0022           USR Day 21
     C                     Z-ADD*ZERO     YL0003           Day 1 Inventory
     C                     Z-ADD*ZERO     YL0004           Day 2 Inventory
     C                     Z-ADD*ZERO     YL0005           Day 3 Inventory
     C                     Z-ADD*ZERO     YL0006           Day 4 Inventory
     C                     Z-ADD*ZERO     YL0007           Day 5 Inventory
     C                     Z-ADD*ZERO     YL0008           Day 6 Inventory
     C                     Z-ADD*ZERO     YL0009           Day 7 Inventory
     C                     Z-ADD*ZERO     YL0010           Day 8 Inventory
     C                     Z-ADD*ZERO     WN0023           Day 1 Availabil
     C                     Z-ADD*ZERO     WN0024           Day 2 Availabil
     C                     Z-ADD*ZERO     WN0025           Day 3 Availabil
     C                     Z-ADD*ZERO     WN0026           Day 4 Availabil
     C                     Z-ADD*ZERO     WN0027           Day 5 Availabil
     C                     Z-ADD*ZERO     WN0028           Day 6 Availabil
     C                     Z-ADD*ZERO     WN0029           Day 7 Availabil
     C                     Z-ADD*ZERO     WN0030           Day 8 Availabil
     C                     Z-ADD*ZERO     WN0031           Day 9 Availabil
     C                     Z-ADD*ZERO     WN0032           Day 10 Availabi
     C                     Z-ADD*ZERO     WN0033           Day 11 Availabi
     C                     Z-ADD*ZERO     WN0034           Day 12 Availabi
     C                     Z-ADD*ZERO     WN0035           Day 13 Availabi
     C                     Z-ADD*ZERO     WN0036           Day 14 Availabi
     C                     Z-ADD*ZERO     WN0037           Day 15 Availabi
     C                     Z-ADD*ZERO     WN0038           Day 16 Availabi
     C                     Z-ADD*ZERO     WN0039           Day 17 Availabi
     C                     Z-ADD*ZERO     WN0040           Day 18 Availabi
     C                     Z-ADD*ZERO     WN0041           Day 19 Availabi
     C                     Z-ADD*ZERO     WN0042           Day 20 Availabi
     C                     Z-ADD*ZERO     WN0043           Day 21 Availabi
     C                     Z-ADD*ZERO     $DD1AQ           Day 1 ATS Qty U
     C                     Z-ADD*ZERO     $DD2AQ           Day 2 ATS Qty U
     C                     Z-ADD*ZERO     $DD3AQ           Day 3 ATS Qty U
     C                     Z-ADD*ZERO     $DD4AQ           Day 4 ATS Qty U
     C                     Z-ADD*ZERO     $DD5AQ           Day 5 ATS Qty U
     C                     Z-ADD*ZERO     $DD6AQ           Day 6 ATS Qty U
     C                     Z-ADD*ZERO     $DD7AQ           Day 7 ATS Qty U
     C                     Z-ADD*ZERO     $DD8AQ           Day 8 ATS Qty U
     C                     Z-ADD*ZERO     $DD9AQ           Day 9 ATS Qty U
     C                     Z-ADD*ZERO     $DD1AT           Day 10 ATS Qty
     C                     Z-ADD*ZERO     $DD2AT           Day 11 ATS Qty
     C                     Z-ADD*ZERO     $DD3AT           Day 12 ATS Qty
     C                     Z-ADD*ZERO     $DD4AT           Day 13 ATS Qty
     C                     Z-ADD*ZERO     $DD5AT           Day 14 ATS Qty
     C                     Z-ADD*ZERO     $DD6AT           Day 15 ATS Qty
     C                     Z-ADD*ZERO     $DD7AT           Day 16 ATS Qty
     C                     Z-ADD*ZERO     $DD9AT           Day 17 ATS Qty
     C                     Z-ADD*ZERO     $DD1AS           Day 18 ATS Qty
     C                     Z-ADD*ZERO     $DD2AS           Day 19 ATS Qty
     C                     Z-ADD*ZERO     $DD3AS           Day 20 ATS Qty
     C                     Z-ADD*ZERO     $DD4AS           Day 21 ATS Qty
     C                     Z-ADD*ZERO     $DD1AV           Day 1 Avail Tot
     C                     Z-ADD*ZERO     $DD2AV           Day 2 Avail Tot
     C                     Z-ADD*ZERO     $DD3AV           Day 3 Avail Tot
     C                     Z-ADD*ZERO     $DD4AV           Day 4 Avail Tot
     C                     Z-ADD*ZERO     $DD5AV           Day 5 Avail Tot
     C                     Z-ADD*ZERO     $DD6AV           Day 6 Avail Tot
     C                     Z-ADD*ZERO     $DD7AV           Day 7 Avail Tot
     C                     Z-ADD*ZERO     $DD8AV           Day 8 Avail Tot
     C                     Z-ADD*ZERO     $DD9AV           Day 9 Avail Tot
     C                     Z-ADD*ZERO     $DD1AB           Day 10 Avail To
     C                     Z-ADD*ZERO     $DD2AB           Day 11 Avail To
     C                     Z-ADD*ZERO     $DD3AB           Day 12 Avail To
     C                     Z-ADD*ZERO     $DD4AB           Day 13 Avail To
     C                     Z-ADD*ZERO     $DD5AB           Day 14 Avail To
     C                     Z-ADD*ZERO     $DD6AB           Day 15 Avail To
     C                     Z-ADD*ZERO     $DD7AB           Day 16 Avail To
     C                     Z-ADD*ZERO     $DD8AB           Day 17 Avail To
     C                     Z-ADD*ZERO     $DD9AB           Day 18 Avail To
     C                     Z-ADD*ZERO     $DD1AL           Day 19 Avail To
     C                     Z-ADD*ZERO     $DD2AL           Day 20 Avail To
     C                     Z-ADD*ZERO     $DD3AL           Day 21 Avail To
     C                     MOVEL'N'       YL0011           Status - Y or N
      * Establish starting position
     C           *LOVAL    SETLL@ADREOJ                    *
     C                     READ @ADREOJ                  90*
      * Data record not found
     C   90                MOVEL'USR0007' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Check for matching warehouse code and warehouse type
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Warehouse Code is Warehouse Code Blank
      *   |- c2    : PAR.Warehouse Type is Equal blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3AJCD    IFEQ *BLANK                     *IF
     C           P3WPST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     Z-ADD*ZERO     WN0044  70       USR Day 1
     C                     Z-ADD*ZERO     WN0045  70       USR Day 2
     C                     Z-ADD*ZERO     WN0046  70       USR Day 3
     C                     Z-ADD*ZERO     WN0047  70       USR Day 4
     C                     Z-ADD*ZERO     WN0048  70       USR Day 5
     C                     Z-ADD*ZERO     WN0049  70       USR Day 6
     C                     Z-ADD*ZERO     WN0050  70       USR Day 7
     C                     Z-ADD*ZERO     WN0051  70       USR Day 8
     C                     Z-ADD*ZERO     WN0052  70       USR Day 9
     C                     Z-ADD*ZERO     WN0053  70       USR Day 10
     C                     Z-ADD*ZERO     WN0054  70       USR Day 11
     C                     Z-ADD*ZERO     WN0055  70       USR Day 12
     C                     Z-ADD*ZERO     WN0056  70       USR Day 13
     C                     Z-ADD*ZERO     WN0057  70       USR Day 14
     C                     Z-ADD*ZERO     WN0058  70       USR Day 15
     C                     Z-ADD*ZERO     WN0059  70       USR Day 16
     C                     Z-ADD*ZERO     WN0060  70       USR Day 17
     C                     Z-ADD*ZERO     WN0061  70       USR Day 18
     C                     Z-ADD*ZERO     WN0062  70       USR Day 19
     C                     Z-ADD*ZERO     WN0063  70       USR Day 20
     C                     Z-ADD*ZERO     WN0064  70       USR Day 21
     C                     Z-ADD*ZERO     WN0065  61       Day 9 Inventory
     C                     Z-ADD*ZERO     WN0066  61       Day 10 Inventor
     C                     Z-ADD*ZERO     WN0067  61       Day 11 Inventor
     C                     Z-ADD*ZERO     WN0068  61       Day 12 Inventor
     C                     Z-ADD*ZERO     WN0069  61       Day 13 Inventor
     C                     Z-ADD*ZERO     WN0070  61       Day 14 Inventor
     C                     Z-ADD*ZERO     WN0071  61       Day 1 Productio
     C                     Z-ADD*ZERO     WN0072  61       Day 2 Productio
     C                     Z-ADD*ZERO     WN0073  61       Day 3 Productio
     C                     Z-ADD*ZERO     WN0074  61       Day 4 Productio
     C                     Z-ADD*ZERO     WN0075  61       Day 5 Productio
     C                     Z-ADD*ZERO     WN0076  61       Day 6 Productio
     C                     Z-ADD*ZERO     WN0077  61       Day 7 Productio
     C                     Z-ADD*ZERO     WN0078  61       Day 8 Productio
     C                     Z-ADD*ZERO     WN0079  61       Day 9 Productio
     C                     Z-ADD*ZERO     WN0080  61       Day 10 Producti
     C                     Z-ADD*ZERO     WN0081  61       Day 11 Producti
     C                     Z-ADD*ZERO     WN0082  61       Day 12 Producti
     C                     Z-ADD*ZERO     WN0083  61       Day 13 Producti
     C                     Z-ADD*ZERO     WN0084  61       Day 14 Producti
     C                     Z-ADD*ZERO     WN0085  61       Day 15 Producti
     C                     Z-ADD*ZERO     WN0086  61       Day 16 Producti
     C                     Z-ADD*ZERO     WN0087  61       Day 17 Producti
     C                     Z-ADD*ZERO     WN0088  61       Day 18 Producti
     C                     Z-ADD*ZERO     WN0089  61       Day 19 Producti
     C                     Z-ADD*ZERO     WN0090  61       Day 20 Producti
     C                     Z-ADD*ZERO     WN0091  61       Day 21 Producti
     C                     Z-ADD*ZERO     WN0092  61       Day 1 Sales USR
     C                     Z-ADD*ZERO     WN0093  61       Day 2 Sales USR
     C                     Z-ADD*ZERO     WN0094  61       Day 3 Sales USR
     C                     Z-ADD*ZERO     WN0095  61       Day 4 Sales USR
     C                     Z-ADD*ZERO     WN0096  61       Day 5 Sales USR
     C                     Z-ADD*ZERO     WN0097  61       Day 6 Sales USR
     C                     Z-ADD*ZERO     WN0098  61       Day 7 Sales USR
     C                     Z-ADD*ZERO     WN0099  61       Day 8 Sales USR
     C                     Z-ADD*ZERO     WN0100  61       Day 9 Sales USR
     C                     Z-ADD*ZERO     WN0101  61       Day 10 Sales US
     C                     Z-ADD*ZERO     WN0102  61       Day 11 Sales US
     C                     Z-ADD*ZERO     WN0103  61       Day 12 Sales US
     C                     Z-ADD*ZERO     WN0104  61       Day 13 Sales US
     C                     Z-ADD*ZERO     WN0105  61       Day 14 Sales US
     C                     Z-ADD*ZERO     WN0106  61       Day 15 Sales US
     C                     Z-ADD*ZERO     WN0107  61       Day 16 Sales US
     C                     Z-ADD*ZERO     WN0108  61       Day 17 Sales US
     C                     Z-ADD*ZERO     WN0109  61       Day 18 Sales US
     C                     Z-ADD*ZERO     WN0110  61       Day 19 Sales US
     C                     Z-ADD*ZERO     WN0111  61       Day 20 Sales US
     C                     Z-ADD*ZERO     WN0112  61       Day 21 Sales US
     C                     Z-ADD*ZERO     WN0113  61       Day 1 Adjustmen
     C                     Z-ADD*ZERO     WN0114  61       Day 2 Adjustmen
     C                     Z-ADD*ZERO     WN0115  61       Day 3 Adjustmen
     C                     Z-ADD*ZERO     WN0116  61       Day 4 Adjustmen
     C                     Z-ADD*ZERO     WN0117  61       Day 5 Adjustmen
     C                     Z-ADD*ZERO     WN0118  61       Day 6 Adjustmen
     C                     Z-ADD*ZERO     WN0119  61       Day 7 Adjustmen
     C                     Z-ADD*ZERO     WN0120  61       Day 8 Adjustmen
     C                     Z-ADD*ZERO     WN0121  61       Day 9 Adjustmen
     C                     Z-ADD*ZERO     WN0122  61       Day 10 Adjustme
     C                     Z-ADD*ZERO     WN0123  61       Day 11 Adjustme
     C                     Z-ADD*ZERO     WN0124  61       Day 12 Adjustme
     C                     Z-ADD*ZERO     WN0125  61       Day 13 Adjustme
     C                     Z-ADD*ZERO     WN0126  61       Day 14 Adjustme
     C                     Z-ADD*ZERO     WN0127  61       Day 15 Adjustme
     C                     Z-ADD*ZERO     WN0128  61       Day 16 Adjustme
     C                     Z-ADD*ZERO     WN0129  61       Day 17 Adjustme
     C                     Z-ADD*ZERO     WN0130  61       Day 18 Adjustme
     C                     Z-ADD*ZERO     WN0131  61       Day 19 Adjustme
     C                     Z-ADD*ZERO     WN0132  61       Day 20 Adjustme
     C                     Z-ADD*ZERO     WN0133  61       Day 21 Adjustme
     C                     Z-ADD*ZERO     WN0134  61       Day 1 Sched Shi
     C                     Z-ADD*ZERO     WN0135  61       Day 2 Sched Shi
     C                     Z-ADD*ZERO     WN0136  61       Day 3 Sched Shi
     C                     Z-ADD*ZERO     WN0137  61       Day 4 Sched Shi
     C                     Z-ADD*ZERO     WN0138  61       Day 5 Sched Shi
     C                     Z-ADD*ZERO     WN0139  61       Day 6 Sched Shi
     C                     Z-ADD*ZERO     WN0140  61       Day 7 Sched Shi
     C                     Z-ADD*ZERO     WN0141  61       Day 8 Sched Shi
     C                     Z-ADD*ZERO     WN0142  61       Day 9 Sched Shi
     C                     Z-ADD*ZERO     WN0143  61       Day 10 Sched Sh
     C                     Z-ADD*ZERO     WN0144  61       Day 11 Sched Sh
     C                     Z-ADD*ZERO     WN0145  61       Day 12 Sched Sh
     C                     Z-ADD*ZERO     WN0146  61       Day 13 Sched Sh
     C                     Z-ADD*ZERO     WN0147  61       Day 14 Sched Sh
     C                     Z-ADD*ZERO     WN0148  61       Day 15 Sched Sh
     C                     Z-ADD*ZERO     WN0149  61       Day 16 Sched Sh
     C                     Z-ADD*ZERO     WN0150  61       Day 17 Sched Sh
     C                     Z-ADD*ZERO     WN0151  61       Day 18 Sched Sh
     C                     Z-ADD*ZERO     WN0152  61       Day 19 Sched Sh
     C                     Z-ADD*ZERO     WN0153  61       Day 20 Sched Sh
     C                     Z-ADD*ZERO     WN0154  61       Day 21 Sched Sh
      *
      * RTV PA Tot SD-21      IF
      * FP1054 5/20/09 made inventory parms "B"oth, they were Neither
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0044           USR Day 1
     C                     Z-ADD*ZERO     WN0045           USR Day 2
     C                     Z-ADD*ZERO     WN0046           USR Day 3
     C                     Z-ADD*ZERO     WN0047           USR Day 4
     C                     Z-ADD*ZERO     WN0048           USR Day 5
     C                     Z-ADD*ZERO     WN0049           USR Day 6
     C                     Z-ADD*ZERO     WN0050           USR Day 7
     C                     Z-ADD*ZERO     WN0051           USR Day 8
     C                     Z-ADD*ZERO     WN0052           USR Day 9
     C                     Z-ADD*ZERO     WN0053           USR Day 10
     C                     Z-ADD*ZERO     WN0054           USR Day 11
     C                     Z-ADD*ZERO     WN0055           USR Day 12
     C                     Z-ADD*ZERO     WN0056           USR Day 13
     C                     Z-ADD*ZERO     WN0057           USR Day 14
     C                     Z-ADD*ZERO     WN0058           USR Day 15
     C                     Z-ADD*ZERO     WN0059           USR Day 16
     C                     Z-ADD*ZERO     WN0060           USR Day 17
     C                     Z-ADD*ZERO     WN0061           USR Day 18
     C                     Z-ADD*ZERO     WN0062           USR Day 19
     C                     Z-ADD*ZERO     WN0063           USR Day 20
     C                     Z-ADD*ZERO     WN0064           USR Day 21
     C                     Z-ADD*ZERO     YL0003           Day 1 Inventory
     C                     Z-ADD*ZERO     YL0004           Day 2 Inventory
     C                     Z-ADD*ZERO     YL0005           Day 3 Inventory
     C                     Z-ADD*ZERO     YL0006           Day 4 Inventory
     C                     Z-ADD*ZERO     YL0007           Day 5 Inventory
     C                     Z-ADD*ZERO     YL0008           Day 6 Inventory
     C                     Z-ADD*ZERO     YL0009           Day 7 Inventory
     C                     Z-ADD*ZERO     YL0010           Day 8 Inventory
     C                     Z-ADD*ZERO     WN0065           Day 9 Inventory
     C                     Z-ADD*ZERO     WN0066           Day 10 Inventor
     C                     Z-ADD*ZERO     WN0067           Day 11 Inventor
     C                     Z-ADD*ZERO     WN0068           Day 12 Inventor
     C                     Z-ADD*ZERO     WN0069           Day 13 Inventor
     C                     Z-ADD*ZERO     WN0070           Day 14 Inventor
     C                     Z-ADD*ZERO     WN0071           Day 1 Productio
     C                     Z-ADD*ZERO     WN0072           Day 2 Productio
     C                     Z-ADD*ZERO     WN0073           Day 3 Productio
     C                     Z-ADD*ZERO     WN0074           Day 4 Productio
     C                     Z-ADD*ZERO     WN0075           Day 5 Productio
     C                     Z-ADD*ZERO     WN0076           Day 6 Productio
     C                     Z-ADD*ZERO     WN0077           Day 7 Productio
     C                     Z-ADD*ZERO     WN0078           Day 8 Productio
     C                     Z-ADD*ZERO     WN0079           Day 9 Productio
     C                     Z-ADD*ZERO     WN0080           Day 10 Producti
     C                     Z-ADD*ZERO     WN0081           Day 11 Producti
     C                     Z-ADD*ZERO     WN0082           Day 12 Producti
     C                     Z-ADD*ZERO     WN0083           Day 13 Producti
     C                     Z-ADD*ZERO     WN0084           Day 14 Producti
     C                     Z-ADD*ZERO     WN0085           Day 15 Producti
     C                     Z-ADD*ZERO     WN0086           Day 16 Producti
     C                     Z-ADD*ZERO     WN0087           Day 17 Producti
     C                     Z-ADD*ZERO     WN0088           Day 18 Producti
     C                     Z-ADD*ZERO     WN0089           Day 19 Producti
     C                     Z-ADD*ZERO     WN0090           Day 20 Producti
     C                     Z-ADD*ZERO     WN0091           Day 21 Producti
     C                     Z-ADD*ZERO     WN0092           Day 1 Sales USR
     C                     Z-ADD*ZERO     WN0093           Day 2 Sales USR
     C                     Z-ADD*ZERO     WN0094           Day 3 Sales USR
     C                     Z-ADD*ZERO     WN0095           Day 4 Sales USR
     C                     Z-ADD*ZERO     WN0096           Day 5 Sales USR
     C                     Z-ADD*ZERO     WN0097           Day 6 Sales USR
     C                     Z-ADD*ZERO     WN0098           Day 7 Sales USR
     C                     Z-ADD*ZERO     WN0099           Day 8 Sales USR
     C                     Z-ADD*ZERO     WN0100           Day 9 Sales USR
     C                     Z-ADD*ZERO     WN0101           Day 10 Sales US
     C                     Z-ADD*ZERO     WN0102           Day 11 Sales US
     C                     Z-ADD*ZERO     WN0103           Day 12 Sales US
     C                     Z-ADD*ZERO     WN0104           Day 13 Sales US
     C                     Z-ADD*ZERO     WN0105           Day 14 Sales US
     C                     Z-ADD*ZERO     WN0106           Day 15 Sales US
     C                     Z-ADD*ZERO     WN0107           Day 16 Sales US
     C                     Z-ADD*ZERO     WN0108           Day 17 Sales US
     C                     Z-ADD*ZERO     WN0109           Day 18 Sales US
     C                     Z-ADD*ZERO     WN0110           Day 19 Sales US
     C                     Z-ADD*ZERO     WN0111           Day 20 Sales US
     C                     Z-ADD*ZERO     WN0112           Day 21 Sales US
     C                     Z-ADD*ZERO     WN0113           Day 1 Adjustmen
     C                     Z-ADD*ZERO     WN0114           Day 2 Adjustmen
     C                     Z-ADD*ZERO     WN0115           Day 3 Adjustmen
     C                     Z-ADD*ZERO     WN0116           Day 4 Adjustmen
     C                     Z-ADD*ZERO     WN0117           Day 5 Adjustmen
     C                     Z-ADD*ZERO     WN0118           Day 6 Adjustmen
     C                     Z-ADD*ZERO     WN0119           Day 7 Adjustmen
     C                     Z-ADD*ZERO     WN0120           Day 8 Adjustmen
     C                     Z-ADD*ZERO     WN0121           Day 9 Adjustmen
     C                     Z-ADD*ZERO     WN0122           Day 10 Adjustme
     C                     Z-ADD*ZERO     WN0123           Day 11 Adjustme
     C                     Z-ADD*ZERO     WN0124           Day 12 Adjustme
     C                     Z-ADD*ZERO     WN0125           Day 13 Adjustme
     C                     Z-ADD*ZERO     WN0126           Day 14 Adjustme
     C                     Z-ADD*ZERO     WN0127           Day 15 Adjustme
     C                     Z-ADD*ZERO     WN0128           Day 16 Adjustme
     C                     Z-ADD*ZERO     WN0129           Day 17 Adjustme
     C                     Z-ADD*ZERO     WN0130           Day 18 Adjustme
     C                     Z-ADD*ZERO     WN0131           Day 19 Adjustme
     C                     Z-ADD*ZERO     WN0132           Day 20 Adjustme
     C                     Z-ADD*ZERO     WN0133           Day 21 Adjustme
     C                     Z-ADD*ZERO     WN0023           Day 1 Availabil
     C                     Z-ADD*ZERO     WN0024           Day 2 Availabil
     C                     Z-ADD*ZERO     WN0025           Day 3 Availabil
     C                     Z-ADD*ZERO     WN0026           Day 4 Availabil
     C                     Z-ADD*ZERO     WN0027           Day 5 Availabil
     C                     Z-ADD*ZERO     WN0028           Day 6 Availabil
     C                     Z-ADD*ZERO     WN0029           Day 7 Availabil
     C                     Z-ADD*ZERO     WN0030           Day 8 Availabil
     C                     Z-ADD*ZERO     WN0031           Day 9 Availabil
     C                     Z-ADD*ZERO     WN0032           Day 10 Availabi
     C                     Z-ADD*ZERO     WN0033           Day 11 Availabi
     C                     Z-ADD*ZERO     WN0034           Day 12 Availabi
     C                     Z-ADD*ZERO     WN0035           Day 13 Availabi
     C                     Z-ADD*ZERO     WN0036           Day 14 Availabi
     C                     Z-ADD*ZERO     WN0037           Day 15 Availabi
     C                     Z-ADD*ZERO     WN0038           Day 16 Availabi
     C                     Z-ADD*ZERO     WN0039           Day 17 Availabi
     C                     Z-ADD*ZERO     WN0040           Day 18 Availabi
     C                     Z-ADD*ZERO     WN0041           Day 19 Availabi
     C                     Z-ADD*ZERO     WN0042           Day 20 Availabi
     C                     Z-ADD*ZERO     WN0043           Day 21 Availabi
     C                     Z-ADD*ZERO     WN0134           Day 1 Sched Shi
     C                     Z-ADD*ZERO     WN0135           Day 2 Sched Shi
     C                     Z-ADD*ZERO     WN0136           Day 3 Sched Shi
     C                     Z-ADD*ZERO     WN0137           Day 4 Sched Shi
     C                     Z-ADD*ZERO     WN0138           Day 5 Sched Shi
     C                     Z-ADD*ZERO     WN0139           Day 6 Sched Shi
     C                     Z-ADD*ZERO     WN0140           Day 7 Sched Shi
     C                     Z-ADD*ZERO     WN0141           Day 8 Sched Shi
     C                     Z-ADD*ZERO     WN0142           Day 9 Sched Shi
     C                     Z-ADD*ZERO     WN0143           Day 10 Sched Sh
     C                     Z-ADD*ZERO     WN0144           Day 11 Sched Sh
     C                     Z-ADD*ZERO     WN0145           Day 12 Sched Sh
     C                     Z-ADD*ZERO     WN0146           Day 13 Sched Sh
     C                     Z-ADD*ZERO     WN0147           Day 14 Sched Sh
     C                     Z-ADD*ZERO     WN0148           Day 15 Sched Sh
     C                     Z-ADD*ZERO     WN0149           Day 16 Sched Sh
     C                     Z-ADD*ZERO     WN0150           Day 17 Sched Sh
     C                     Z-ADD*ZERO     WN0151           Day 18 Sched Sh
     C                     Z-ADD*ZERO     WN0152           Day 19 Sched Sh
     C                     Z-ADD*ZERO     WN0153           Day 20 Sched Sh
     C                     Z-ADD*ZERO     WN0154           Day 21 Sched Sh
      *
     C                     Z-ADD*ZERO     WN0155  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0156  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0157  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0158  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0159  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0160  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0161  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0162  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0163  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0164  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0165  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0166  92       PS Weight Sched
      *
      * Rtv PA In/Sh SD-6     IF
      * Retrieve Inventory and Scheduled Shipments
      * Rtv PA In/Sh SD-6 WHS RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0001           Company Number
     C                     MOVEL'S'       WL0002    P      Production Type
     C                     Z-ADD##JDT     WL0003           Production Date
     C                     Z-ADD$DHGCD    WL0004           Item Code
     C                     MOVELWBAJCD    WL0005    P      Warehouse Code
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    WN0155           PS Weight Inv O
     C                     Z-ADDWL0007    WN0156           PS Pieces Inv O
     C                     Z-ADDWL0008    WN0157           PS Weight Inv A
     C                     Z-ADDWL0009    WN0158           PS Pieces Inv A
     C                     Z-ADDWL0010    WN0159           PS Weight Ship
     C                     Z-ADDWL0011    WN0160           PS Pieces Ship
     C                     Z-ADDWL0012    WN0161           PS Weight Prod
     C                     Z-ADDWL0013    WN0162           PS Pieces Prod
     C                     Z-ADDWL0014    WN0163           PS Weight Inv A
     C                     Z-ADDWL0015    WN0164           PS Pieces Inv A
     C                     Z-ADDWL0016    WN0165           PS Weight Order
     C                     Z-ADDWL0017    WN0166           PS Weight Sched
      * Inventory / Sales if Chilling Time > 0
      * CASE: Primary
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4W4ST    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           P6AIWG    IFGT *ZERO                      *IF
     C           P6PCCT    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Calculate Quantity based on Unit Weight or Pieces
      * CASE: PAR.Avail Ship Date 1 USR EQ JOB.*Job date
     C           P4FFDT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0167 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0168 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0167    WL0022           Weight Schedule
     C                     Z-ADDWN0168    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0167           Weight Schedule
     C                     Z-ADDWL0023    WN0168           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0155    ADD  WN0157    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0003           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0092           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0161    ADD  WN0163    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0092           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0167    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0134           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0159    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0113    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0113           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0156    ADD  WN0158    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0003           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0092           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0092           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0162    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0092    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0092           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0168    WN0134           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0160    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0113    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0113           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0003    ADD  WN0113    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0092    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0023           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 2 USR EQ JOB.*Job date
     C           P4E1DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0169 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0170 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0169    WL0022           Weight Schedule
     C                     Z-ADDWN0170    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0169           Weight Schedule
     C                     Z-ADDWL0023    WN0170           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0155    ADD  WN0157    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0004           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0093           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0161    ADD  WN0163    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0093           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0169    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0135           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0159    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0114    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0114           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0156    ADD  WN0158    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0004           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0093           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0093           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0162    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0093    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0093           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0170    WN0135           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0160    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0114    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0114           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0004    ADD  WN0114    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0093    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0024           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 3 USR EQ JOB.*Job date
     C           P4E2DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0171 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0172 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0171    WL0022           Weight Schedule
     C                     Z-ADDWN0172    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0171           Weight Schedule
     C                     Z-ADDWL0023    WN0172           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0155    ADD  WN0157    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0005           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0094           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0161    ADD  WN0163    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0094           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0171    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0136           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0159    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0115    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0115           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0156    ADD  WN0158    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0005           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0094           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0094           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0162    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0094    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0094           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0172    WN0136           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0160    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0115    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0115           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0005    ADD  WN0115    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0094    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0025           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 4 USR EQ JOB.*Job date
     C           P4E3DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0173 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0174 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0173    WL0022           Weight Schedule
     C                     Z-ADDWN0174    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0173           Weight Schedule
     C                     Z-ADDWL0023    WN0174           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0155    ADD  WN0157    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0006           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0095           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0161    ADD  WN0163    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0095           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0173    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0137           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0159    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0116    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0116           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0156    ADD  WN0158    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0006           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0095           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0095           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0162    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0095    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0095           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0174    WN0137           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0160    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0116    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0116           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0006    ADD  WN0116    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0095    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0026           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 5 USR EQ JOB.*Job date
     C           P4E4DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0175 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0176 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0175    WL0022           Weight Schedule
     C                     Z-ADDWN0176    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0175           Weight Schedule
     C                     Z-ADDWL0023    WN0176           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0155    ADD  WN0157    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0007           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0096           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0161    ADD  WN0163    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0096           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0175    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0138           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0159    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0117    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0117           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0156    ADD  WN0158    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0007           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0096           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0096           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0162    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0096    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0096           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0176    WN0138           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0160    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0117    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0117           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0007    ADD  WN0117    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0096    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0027           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 6 USR EQ JOB.*Job date
     C           P4E5DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0177 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0178 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0177    WL0022           Weight Schedule
     C                     Z-ADDWN0178    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0177           Weight Schedule
     C                     Z-ADDWL0023    WN0178           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0155    ADD  WN0157    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0008           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0097           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0161    ADD  WN0163    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0097           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0177    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0139           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0159    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0118    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0118           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0156    ADD  WN0158    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0008           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0097           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0097           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0162    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0097    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0097           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0178    WN0139           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0160    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0118    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0118           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0008    ADD  WN0118    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0097    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0028           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 7 USR EQ JOB.*Job date
     C           P4E6DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0179 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0180 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0179    WL0022           Weight Schedule
     C                     Z-ADDWN0180    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0179           Weight Schedule
     C                     Z-ADDWL0023    WN0180           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0155    ADD  WN0157    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0009           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0098           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0161    ADD  WN0163    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0098           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0179    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0140           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0159    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0119    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0119           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0156    ADD  WN0158    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0009           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0098           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0163    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0098           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0162    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0098    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0098           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0180    WN0140           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0160    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0119    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0119           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0009    ADD  WN0119    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0098    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0029           Quantity Availa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4W4ST    IFEQ 'L'                        *IF
     C           P4LDSZ    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Calculate Quantity based on Load Size
      * CASE: PAR.Avail Ship Date 1 USR EQ JOB.*Job date
     C           P4FFDT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0181 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0182 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0156    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0158    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0164    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0162    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0160    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0155    YL0012           PS Weight Inv O
     C                     Z-ADDWN0157    YL0013           PS Weight Inv A
     C                     Z-ADDWN0163    YL0014           PS Weight Inv A
     C                     Z-ADDWN0161    YL0015           PS Weight Prod
     C                     Z-ADDWN0159    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0181    WL0022           Weight Schedule
     C                     Z-ADDWN0182    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0181           Weight Schedule
     C                     Z-ADDWL0023    WN0182           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0181    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0134           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0003           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0092           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0092           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0113    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0113           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0003    ADD  WN0113    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0092    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0023           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 2 USR EQ JOB.*Job date
     C           P4E1DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0183 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0184 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0156    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0158    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0164    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0162    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0160    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0155    YL0012           PS Weight Inv O
     C                     Z-ADDWN0157    YL0013           PS Weight Inv A
     C                     Z-ADDWN0163    YL0014           PS Weight Inv A
     C                     Z-ADDWN0161    YL0015           PS Weight Prod
     C                     Z-ADDWN0159    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0183    WL0022           Weight Schedule
     C                     Z-ADDWN0184    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0183           Weight Schedule
     C                     Z-ADDWL0023    WN0184           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0183    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0135           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0004           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0093           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0093           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0114    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0114           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0004    ADD  WN0114    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0093    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0024           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 3 USR EQ JOB.*Job date
     C           P4E2DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0185 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0186 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0156    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0158    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0164    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0162    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0160    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0155    YL0012           PS Weight Inv O
     C                     Z-ADDWN0157    YL0013           PS Weight Inv A
     C                     Z-ADDWN0163    YL0014           PS Weight Inv A
     C                     Z-ADDWN0161    YL0015           PS Weight Prod
     C                     Z-ADDWN0159    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0185    WL0022           Weight Schedule
     C                     Z-ADDWN0186    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0185           Weight Schedule
     C                     Z-ADDWL0023    WN0186           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0185    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0136           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0005           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0094           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0094           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0115    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0115           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0005    ADD  WN0115    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0094    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0025           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 4 USR EQ JOB.*Job date
     C           P4E3DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0187 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0188 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0156    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0158    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0164    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0162    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0160    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0155    YL0012           PS Weight Inv O
     C                     Z-ADDWN0157    YL0013           PS Weight Inv A
     C                     Z-ADDWN0163    YL0014           PS Weight Inv A
     C                     Z-ADDWN0161    YL0015           PS Weight Prod
     C                     Z-ADDWN0159    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0187    WL0022           Weight Schedule
     C                     Z-ADDWN0188    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0187           Weight Schedule
     C                     Z-ADDWL0023    WN0188           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0187    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0137           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0006           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0095           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0095           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0116    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0116           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0006    ADD  WN0116    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0095    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0026           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 5 USR EQ JOB.*Job date
     C           P4E4DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0189 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0190 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0156    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0158    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0164    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0162    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0160    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0155    YL0012           PS Weight Inv O
     C                     Z-ADDWN0157    YL0013           PS Weight Inv A
     C                     Z-ADDWN0163    YL0014           PS Weight Inv A
     C                     Z-ADDWN0161    YL0015           PS Weight Prod
     C                     Z-ADDWN0159    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0189    WL0022           Weight Schedule
     C                     Z-ADDWN0190    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0189           Weight Schedule
     C                     Z-ADDWL0023    WN0190           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0189    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0138           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0007           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0096           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0096           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0117    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0117           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0007    ADD  WN0117    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0096    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0027           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 6 USR EQ JOB.*Job date
     C           P4E5DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0191 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0192 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0156    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0158    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0164    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0162    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0160    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0155    YL0012           PS Weight Inv O
     C                     Z-ADDWN0157    YL0013           PS Weight Inv A
     C                     Z-ADDWN0163    YL0014           PS Weight Inv A
     C                     Z-ADDWN0161    YL0015           PS Weight Prod
     C                     Z-ADDWN0159    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0191    WL0022           Weight Schedule
     C                     Z-ADDWN0192    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0191           Weight Schedule
     C                     Z-ADDWL0023    WN0192           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0191    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0139           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0008           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0097           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0097           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0118    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0118           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0008    ADD  WN0118    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0097    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0028           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 7 USR EQ JOB.*Job date
     C           P4E6DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0193 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0194 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0156    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0158    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0164    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0162    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0160    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0155    YL0012           PS Weight Inv O
     C                     Z-ADDWN0157    YL0013           PS Weight Inv A
     C                     Z-ADDWN0163    YL0014           PS Weight Inv A
     C                     Z-ADDWN0161    YL0015           PS Weight Prod
     C                     Z-ADDWN0159    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0193    WL0022           Weight Schedule
     C                     Z-ADDWN0194    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0193           Weight Schedule
     C                     Z-ADDWL0023    WN0194           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0193    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0140           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0009           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0098           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0098           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0119    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0119           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0009    ADD  WN0119    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0098    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0029           Quantity Availa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Total Inventory
      * CASE: PAR.Avail Dsp/Prt Type USR is Display
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'T'
      * Total Inventory
      * PAR.Day 8 Inventory USR =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 + x7)
      * x1    : PAR.Day 1 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Day 2 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x3    : PAR.Day 3 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x4    : PAR.Day 4 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x5    : PAR.Day 5 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x6    : PAR.Day 6 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x7    : PAR.Day 7 Inventory USR
     C           YL0003    ADD  YL0004    W0WD05           *Synon (17,7) w
     C           W0WD05    ADD  YL0005    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  YL0006    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  YL0007    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  YL0008    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  YL0009    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0010           Day 8 Inventory
     C                     END                             *FI
      * Rtv PA Dtl SD-21 WHS  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0028           Company Number
     C                     Z-ADD$DHGCD    WL0029           Item Code
     C                     MOVELWBAJCD    WL0030    P      Warehouse Code
     C                     Z-ADDP2GPDT    WL0031           PS Available Sh
     C                     Z-ADDP4FFDT    WL0032           Avail Ship Date
     C                     Z-ADDP4E1DT    WL0033           Avail Ship Date
     C                     Z-ADDP4E2DT    WL0034           Avail Ship Date
     C                     Z-ADDP4E3DT    WL0035           Avail Ship Date
     C                     Z-ADDP4E4DT    WL0036           Avail Ship Date
     C                     Z-ADDP4E5DT    WL0037           Avail Ship Date
     C                     Z-ADDP4E6DT    WL0038           Avail Ship Date
     C                     Z-ADDP4FKDT    WL0039           Avail Ship Date
     C                     Z-ADDP4FLDT    WL0040           Avail Ship Date
     C                     Z-ADDP4FGDT    WL0041           Avail Ship Date
     C                     Z-ADDP4FHDT    WL0042           Avail Ship Date
     C                     Z-ADDP4FIDT    WL0043           Avail Ship Date
     C                     Z-ADDP4FJDT    WL0044           Avail Ship Date
     C                     Z-ADDP4HPDT    WL0045           Avail Ship Date
     C                     Z-ADDP4HQDT    WL0046           Avail Ship Date
     C                     Z-ADDP4HRDT    WL0047           Avail Ship Date
     C                     Z-ADDP4HSDT    WL0048           Avail Ship Date
     C                     Z-ADDP4HTDT    WL0049           Avail Ship Date
     C                     Z-ADDP4HUDT    WL0050           Avail Ship Date
     C                     Z-ADDP4HVDT    WL0051           Avail Ship Date
     C                     Z-ADDP4HWDT    WL0052           Avail Ship Date
     C                     Z-ADDYL0003    WL0074           Day 1 Inventory
     C                     Z-ADDYL0004    WL0075           Day 2 Inventory
     C                     Z-ADDYL0005    WL0076           Day 3 Inventory
     C                     Z-ADDYL0006    WL0077           Day 4 Inventory
     C                     Z-ADDYL0007    WL0078           Day 5 Inventory
     C                     Z-ADDYL0008    WL0079           Day 6 Inventory
     C                     Z-ADDWN0071    WL0080           Day 1 Productio
     C                     Z-ADDWN0072    WL0081           Day 2 Productio
     C                     Z-ADDWN0073    WL0082           Day 3 Productio
     C                     Z-ADDWN0074    WL0083           Day 4 Productio
     C                     Z-ADDWN0075    WL0084           Day 5 Productio
     C                     Z-ADDWN0076    WL0085           Day 6 Productio
     C                     Z-ADDWN0077    WL0086           Day 7 Productio
     C                     Z-ADDWN0078    WL0087           Day 8 Productio
     C                     Z-ADDWN0079    WL0088           Day 9 Productio
     C                     Z-ADDWN0080    WL0089           Day 10 Producti
     C                     Z-ADDWN0081    WL0090           Day 11 Producti
     C                     Z-ADDWN0082    WL0091           Day 12 Producti
     C                     Z-ADDWN0083    WL0092           Day 13 Producti
     C                     Z-ADDWN0084    WL0093           Day 14 Producti
     C                     Z-ADDWN0085    WL0094           Day 15 Producti
     C                     Z-ADDWN0086    WL0095           Day 16 Producti
     C                     Z-ADDWN0087    WL0096           Day 17 Producti
     C                     Z-ADDWN0088    WL0097           Day 18 Producti
     C                     Z-ADDWN0089    WL0098           Day 19 Producti
     C                     Z-ADDWN0090    WL0099           Day 20 Producti
     C                     Z-ADDWN0091    WL0100           Day 21 Producti
     C                     Z-ADDWN0092    WL0101           Day 1 Sales USR
     C                     Z-ADDWN0093    WL0102           Day 2 Sales USR
     C                     Z-ADDWN0094    WL0103           Day 3 Sales USR
     C                     Z-ADDWN0095    WL0104           Day 4 Sales USR
     C                     Z-ADDWN0096    WL0105           Day 5 Sales USR
     C                     Z-ADDWN0097    WL0106           Day 6 Sales USR
     C                     Z-ADDWN0098    WL0107           Day 7 Sales USR
     C                     Z-ADDWN0099    WL0108           Day 8 Sales USR
     C                     Z-ADDWN0100    WL0109           Day 9 Sales USR
     C                     Z-ADDWN0101    WL0110           Day 10 Sales US
     C                     Z-ADDWN0102    WL0111           Day 11 Sales US
     C                     Z-ADDWN0103    WL0112           Day 12 Sales US
     C                     Z-ADDWN0104    WL0113           Day 13 Sales US
     C                     Z-ADDWN0105    WL0114           Day 14 Sales US
     C                     Z-ADDWN0106    WL0115           Day 15 Sales US
     C                     Z-ADDWN0107    WL0116           Day 16 Sales US
     C                     Z-ADDWN0108    WL0117           Day 17 Sales US
     C                     Z-ADDWN0109    WL0118           Day 18 Sales US
     C                     Z-ADDWN0110    WL0119           Day 19 Sales US
     C                     Z-ADDWN0111    WL0120           Day 20 Sales US
     C                     Z-ADDWN0112    WL0121           Day 21 Sales US
     C                     Z-ADDWN0113    WL0122           Day 1 Adjustmen
     C                     Z-ADDWN0114    WL0123           Day 2 Adjustmen
     C                     Z-ADDWN0115    WL0124           Day 3 Adjustmen
     C                     Z-ADDWN0116    WL0125           Day 4 Adjustmen
     C                     Z-ADDWN0117    WL0126           Day 5 Adjustmen
     C                     Z-ADDWN0118    WL0127           Day 6 Adjustmen
     C                     Z-ADDWN0119    WL0128           Day 7 Adjustmen
     C                     Z-ADDWN0120    WL0129           Day 8 Adjustmen
     C                     Z-ADDWN0121    WL0130           Day 9 Adjustmen
     C                     Z-ADDWN0122    WL0131           Day 10 Adjustme
     C                     Z-ADDWN0123    WL0132           Day 11 Adjustme
     C                     Z-ADDWN0124    WL0133           Day 12 Adjustme
     C                     Z-ADDWN0125    WL0134           Day 13 Adjustme
     C                     Z-ADDWN0126    WL0135           Day 14 Adjustme
     C                     Z-ADDWN0127    WL0136           Day 15 Adjustme
     C                     Z-ADDWN0128    WL0137           Day 16 Adjustme
     C                     Z-ADDWN0129    WL0138           Day 17 Adjustme
     C                     Z-ADDWN0130    WL0139           Day 18 Adjustme
     C                     Z-ADDWN0131    WL0140           Day 19 Adjustme
     C                     Z-ADDWN0132    WL0141           Day 20 Adjustme
     C                     Z-ADDWN0133    WL0142           Day 21 Adjustme
     C                     Z-ADDWN0023    WL0143           Day 1 Availabil
     C                     Z-ADDWN0024    WL0144           Day 2 Availabil
     C                     Z-ADDWN0025    WL0145           Day 3 Availabil
     C                     Z-ADDWN0026    WL0146           Day 4 Availabil
     C                     Z-ADDWN0027    WL0147           Day 5 Availabil
     C                     Z-ADDWN0028    WL0148           Day 6 Availabil
     C                     Z-ADDWN0029    WL0149           Day 7 Availabil
     C                     Z-ADDWN0030    WL0150           Day 8 Availabil
     C                     Z-ADDWN0031    WL0151           Day 9 Availabil
     C                     Z-ADDWN0032    WL0152           Day 10 Availabi
     C                     Z-ADDWN0033    WL0153           Day 11 Availabi
     C                     Z-ADDWN0034    WL0154           Day 12 Availabi
     C                     Z-ADDWN0035    WL0155           Day 13 Availabi
     C                     Z-ADDWN0036    WL0156           Day 14 Availabi
     C                     Z-ADDWN0037    WL0157           Day 15 Availabi
     C                     Z-ADDWN0038    WL0158           Day 16 Availabi
     C                     Z-ADDWN0039    WL0159           Day 17 Availabi
     C                     Z-ADDWN0040    WL0160           Day 18 Availabi
     C                     Z-ADDWN0041    WL0161           Day 19 Availabi
     C                     Z-ADDWN0042    WL0162           Day 20 Availabi
     C                     Z-ADDWN0043    WL0163           Day 21 Availabi
     C                     MOVELP4W4ST    WL0164    P      Primary/Load St
     C                     Z-ADDP4LDSZ    WL0165           Load Size USR
     C                     Z-ADDWN0134    WL0166           Day 1 Sched Shi
     C                     Z-ADDWN0135    WL0167           Day 2 Sched Shi
     C                     Z-ADDWN0136    WL0168           Day 3 Sched Shi
     C                     Z-ADDWN0137    WL0169           Day 4 Sched Shi
     C                     Z-ADDWN0138    WL0170           Day 5 Sched Shi
     C                     Z-ADDWN0139    WL0171           Day 6 Sched Shi
     C                     Z-ADDWN0140    WL0172           Day 7 Sched Shi
     C                     Z-ADDWN0141    WL0173           Day 8 Sched Shi
     C                     Z-ADDWN0142    WL0174           Day 9 Sched Shi
     C                     Z-ADDWN0143    WL0175           Day 10 Sched Sh
     C                     Z-ADDWN0144    WL0176           Day 11 Sched Sh
     C                     Z-ADDWN0145    WL0177           Day 12 Sched Sh
     C                     Z-ADDWN0146    WL0178           Day 13 Sched Sh
     C                     Z-ADDWN0147    WL0179           Day 14 Sched Sh
     C                     Z-ADDWN0148    WL0180           Day 15 Sched Sh
     C                     Z-ADDWN0149    WL0181           Day 16 Sched Sh
     C                     Z-ADDWN0150    WL0182           Day 17 Sched Sh
     C                     Z-ADDWN0151    WL0183           Day 18 Sched Sh
     C                     Z-ADDWN0152    WL0184           Day 19 Sched Sh
     C                     Z-ADDWN0153    WL0185           Day 20 Sched Sh
     C                     Z-ADDWN0154    WL0186           Day 21 Sched Sh
     C                     MOVEL'P'       WL0187    P      Avail Dsp/Prt T
     C                     MOVEL$DADCD    WL0188    P      U/M - Primary
     C                     Z-ADDP6AIWG    WL0189           Unit Weight
     C                     Z-ADDP6CHTM    WL0190           Fresh Chilling
     C                     MOVELP6PCCT    WL0191    P      Piece Count Ite
     C                     Z-ADDP6BDNB    WL0192           Pieces Per Bag
     C                     Z-ADDP6BJNB    WL0193           Bags Per Unit
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0053    WN0044           USR Day 1
     C                     Z-ADDWL0054    WN0045           USR Day 2
     C                     Z-ADDWL0055    WN0046           USR Day 3
     C                     Z-ADDWL0056    WN0047           USR Day 4
     C                     Z-ADDWL0057    WN0048           USR Day 5
     C                     Z-ADDWL0058    WN0049           USR Day 6
     C                     Z-ADDWL0059    WN0050           USR Day 7
     C                     Z-ADDWL0060    WN0051           USR Day 8
     C                     Z-ADDWL0061    WN0052           USR Day 9
     C                     Z-ADDWL0062    WN0053           USR Day 10
     C                     Z-ADDWL0063    WN0054           USR Day 11
     C                     Z-ADDWL0064    WN0055           USR Day 12
     C                     Z-ADDWL0065    WN0056           USR Day 13
     C                     Z-ADDWL0066    WN0057           USR Day 14
     C                     Z-ADDWL0067    WN0058           USR Day 15
     C                     Z-ADDWL0068    WN0059           USR Day 16
     C                     Z-ADDWL0069    WN0060           USR Day 17
     C                     Z-ADDWL0070    WN0061           USR Day 18
     C                     Z-ADDWL0071    WN0062           USR Day 19
     C                     Z-ADDWL0072    WN0063           USR Day 20
     C                     Z-ADDWL0073    WN0064           USR Day 21
     C                     Z-ADDWL0080    WN0071           Day 1 Productio
     C                     Z-ADDWL0081    WN0072           Day 2 Productio
     C                     Z-ADDWL0082    WN0073           Day 3 Productio
     C                     Z-ADDWL0083    WN0074           Day 4 Productio
     C                     Z-ADDWL0084    WN0075           Day 5 Productio
     C                     Z-ADDWL0085    WN0076           Day 6 Productio
     C                     Z-ADDWL0086    WN0077           Day 7 Productio
     C                     Z-ADDWL0087    WN0078           Day 8 Productio
     C                     Z-ADDWL0088    WN0079           Day 9 Productio
     C                     Z-ADDWL0089    WN0080           Day 10 Producti
     C                     Z-ADDWL0090    WN0081           Day 11 Producti
     C                     Z-ADDWL0091    WN0082           Day 12 Producti
     C                     Z-ADDWL0092    WN0083           Day 13 Producti
     C                     Z-ADDWL0093    WN0084           Day 14 Producti
     C                     Z-ADDWL0094    WN0085           Day 15 Producti
     C                     Z-ADDWL0095    WN0086           Day 16 Producti
     C                     Z-ADDWL0096    WN0087           Day 17 Producti
     C                     Z-ADDWL0097    WN0088           Day 18 Producti
     C                     Z-ADDWL0098    WN0089           Day 19 Producti
     C                     Z-ADDWL0099    WN0090           Day 20 Producti
     C                     Z-ADDWL0100    WN0091           Day 21 Producti
     C                     Z-ADDWL0101    WN0092           Day 1 Sales USR
     C                     Z-ADDWL0102    WN0093           Day 2 Sales USR
     C                     Z-ADDWL0103    WN0094           Day 3 Sales USR
     C                     Z-ADDWL0104    WN0095           Day 4 Sales USR
     C                     Z-ADDWL0105    WN0096           Day 5 Sales USR
     C                     Z-ADDWL0106    WN0097           Day 6 Sales USR
     C                     Z-ADDWL0107    WN0098           Day 7 Sales USR
     C                     Z-ADDWL0108    WN0099           Day 8 Sales USR
     C                     Z-ADDWL0109    WN0100           Day 9 Sales USR
     C                     Z-ADDWL0110    WN0101           Day 10 Sales US
     C                     Z-ADDWL0111    WN0102           Day 11 Sales US
     C                     Z-ADDWL0112    WN0103           Day 12 Sales US
     C                     Z-ADDWL0113    WN0104           Day 13 Sales US
     C                     Z-ADDWL0114    WN0105           Day 14 Sales US
     C                     Z-ADDWL0115    WN0106           Day 15 Sales US
     C                     Z-ADDWL0116    WN0107           Day 16 Sales US
     C                     Z-ADDWL0117    WN0108           Day 17 Sales US
     C                     Z-ADDWL0118    WN0109           Day 18 Sales US
     C                     Z-ADDWL0119    WN0110           Day 19 Sales US
     C                     Z-ADDWL0120    WN0111           Day 20 Sales US
     C                     Z-ADDWL0121    WN0112           Day 21 Sales US
     C                     Z-ADDWL0122    WN0113           Day 1 Adjustmen
     C                     Z-ADDWL0123    WN0114           Day 2 Adjustmen
     C                     Z-ADDWL0124    WN0115           Day 3 Adjustmen
     C                     Z-ADDWL0125    WN0116           Day 4 Adjustmen
     C                     Z-ADDWL0126    WN0117           Day 5 Adjustmen
     C                     Z-ADDWL0127    WN0118           Day 6 Adjustmen
     C                     Z-ADDWL0128    WN0119           Day 7 Adjustmen
     C                     Z-ADDWL0129    WN0120           Day 8 Adjustmen
     C                     Z-ADDWL0130    WN0121           Day 9 Adjustmen
     C                     Z-ADDWL0131    WN0122           Day 10 Adjustme
     C                     Z-ADDWL0132    WN0123           Day 11 Adjustme
     C                     Z-ADDWL0133    WN0124           Day 12 Adjustme
     C                     Z-ADDWL0134    WN0125           Day 13 Adjustme
     C                     Z-ADDWL0135    WN0126           Day 14 Adjustme
     C                     Z-ADDWL0136    WN0127           Day 15 Adjustme
     C                     Z-ADDWL0137    WN0128           Day 16 Adjustme
     C                     Z-ADDWL0138    WN0129           Day 17 Adjustme
     C                     Z-ADDWL0139    WN0130           Day 18 Adjustme
     C                     Z-ADDWL0140    WN0131           Day 19 Adjustme
     C                     Z-ADDWL0141    WN0132           Day 20 Adjustme
     C                     Z-ADDWL0142    WN0133           Day 21 Adjustme
     C                     Z-ADDWL0143    WN0023           Day 1 Availabil
     C                     Z-ADDWL0144    WN0024           Day 2 Availabil
     C                     Z-ADDWL0145    WN0025           Day 3 Availabil
     C                     Z-ADDWL0146    WN0026           Day 4 Availabil
     C                     Z-ADDWL0147    WN0027           Day 5 Availabil
     C                     Z-ADDWL0148    WN0028           Day 6 Availabil
     C                     Z-ADDWL0149    WN0029           Day 7 Availabil
     C                     Z-ADDWL0150    WN0030           Day 8 Availabil
     C                     Z-ADDWL0151    WN0031           Day 9 Availabil
     C                     Z-ADDWL0152    WN0032           Day 10 Availabi
     C                     Z-ADDWL0153    WN0033           Day 11 Availabi
     C                     Z-ADDWL0154    WN0034           Day 12 Availabi
     C                     Z-ADDWL0155    WN0035           Day 13 Availabi
     C                     Z-ADDWL0156    WN0036           Day 14 Availabi
     C                     Z-ADDWL0157    WN0037           Day 15 Availabi
     C                     Z-ADDWL0158    WN0038           Day 16 Availabi
     C                     Z-ADDWL0159    WN0039           Day 17 Availabi
     C                     Z-ADDWL0160    WN0040           Day 18 Availabi
     C                     Z-ADDWL0161    WN0041           Day 19 Availabi
     C                     Z-ADDWL0162    WN0042           Day 20 Availabi
     C                     Z-ADDWL0163    WN0043           Day 21 Availabi
     C                     Z-ADDWL0166    WN0134           Day 1 Sched Shi
     C                     Z-ADDWL0167    WN0135           Day 2 Sched Shi
     C                     Z-ADDWL0168    WN0136           Day 3 Sched Shi
     C                     Z-ADDWL0169    WN0137           Day 4 Sched Shi
     C                     Z-ADDWL0170    WN0138           Day 5 Sched Shi
     C                     Z-ADDWL0171    WN0139           Day 6 Sched Shi
     C                     Z-ADDWL0172    WN0140           Day 7 Sched Shi
     C                     Z-ADDWL0173    WN0141           Day 8 Sched Shi
     C                     Z-ADDWL0174    WN0142           Day 9 Sched Shi
     C                     Z-ADDWL0175    WN0143           Day 10 Sched Sh
     C                     Z-ADDWL0176    WN0144           Day 11 Sched Sh
     C                     Z-ADDWL0177    WN0145           Day 12 Sched Sh
     C                     Z-ADDWL0178    WN0146           Day 13 Sched Sh
     C                     Z-ADDWL0179    WN0147           Day 14 Sched Sh
     C                     Z-ADDWL0180    WN0148           Day 15 Sched Sh
     C                     Z-ADDWL0181    WN0149           Day 16 Sched Sh
     C                     Z-ADDWL0182    WN0150           Day 17 Sched Sh
     C                     Z-ADDWL0183    WN0151           Day 18 Sched Sh
     C                     Z-ADDWL0184    WN0152           Day 19 Sched Sh
     C                     Z-ADDWL0185    WN0153           Day 20 Sched Sh
     C                     Z-ADDWL0186    WN0154           Day 21 Sched Sh
     C                     MOVEL'Y'       YL0011           Status - Y or N
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Warehouse Code is Warehouse Code Blank
      *   |- c2    : PAR.Warehouse Type EQ DB1.Warehouse Type
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3AJCD    IFEQ *BLANK                     *IF
     C           P3WPST    IFEQ WBWPST                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     Z-ADD*ZERO     WN0218  70       USR Day 1
     C                     Z-ADD*ZERO     WN0219  70       USR Day 2
     C                     Z-ADD*ZERO     WN0220  70       USR Day 3
     C                     Z-ADD*ZERO     WN0221  70       USR Day 4
     C                     Z-ADD*ZERO     WN0222  70       USR Day 5
     C                     Z-ADD*ZERO     WN0223  70       USR Day 6
     C                     Z-ADD*ZERO     WN0224  70       USR Day 7
     C                     Z-ADD*ZERO     WN0225  70       USR Day 8
     C                     Z-ADD*ZERO     WN0226  70       USR Day 9
     C                     Z-ADD*ZERO     WN0227  70       USR Day 10
     C                     Z-ADD*ZERO     WN0228  70       USR Day 11
     C                     Z-ADD*ZERO     WN0229  70       USR Day 12
     C                     Z-ADD*ZERO     WN0230  70       USR Day 13
     C                     Z-ADD*ZERO     WN0231  70       USR Day 14
     C                     Z-ADD*ZERO     WN0232  70       USR Day 15
     C                     Z-ADD*ZERO     WN0233  70       USR Day 16
     C                     Z-ADD*ZERO     WN0234  70       USR Day 17
     C                     Z-ADD*ZERO     WN0235  70       USR Day 18
     C                     Z-ADD*ZERO     WN0236  70       USR Day 19
     C                     Z-ADD*ZERO     WN0237  70       USR Day 20
     C                     Z-ADD*ZERO     WN0238  70       USR Day 21
     C                     Z-ADD*ZERO     WN0239  61       Day 9 Inventory
     C                     Z-ADD*ZERO     WN0240  61       Day 10 Inventor
     C                     Z-ADD*ZERO     WN0241  61       Day 11 Inventor
     C                     Z-ADD*ZERO     WN0242  61       Day 12 Inventor
     C                     Z-ADD*ZERO     WN0243  61       Day 13 Inventor
     C                     Z-ADD*ZERO     WN0244  61       Day 14 Inventor
     C                     Z-ADD*ZERO     WN0245  61       Day 1 Productio
     C                     Z-ADD*ZERO     WN0246  61       Day 2 Productio
     C                     Z-ADD*ZERO     WN0247  61       Day 3 Productio
     C                     Z-ADD*ZERO     WN0248  61       Day 4 Productio
     C                     Z-ADD*ZERO     WN0249  61       Day 5 Productio
     C                     Z-ADD*ZERO     WN0250  61       Day 6 Productio
     C                     Z-ADD*ZERO     WN0251  61       Day 7 Productio
     C                     Z-ADD*ZERO     WN0252  61       Day 8 Productio
     C                     Z-ADD*ZERO     WN0253  61       Day 9 Productio
     C                     Z-ADD*ZERO     WN0254  61       Day 10 Producti
     C                     Z-ADD*ZERO     WN0255  61       Day 11 Producti
     C                     Z-ADD*ZERO     WN0256  61       Day 12 Producti
     C                     Z-ADD*ZERO     WN0257  61       Day 13 Producti
     C                     Z-ADD*ZERO     WN0258  61       Day 14 Producti
     C                     Z-ADD*ZERO     WN0259  61       Day 15 Producti
     C                     Z-ADD*ZERO     WN0260  61       Day 16 Producti
     C                     Z-ADD*ZERO     WN0261  61       Day 17 Producti
     C                     Z-ADD*ZERO     WN0262  61       Day 18 Producti
     C                     Z-ADD*ZERO     WN0263  61       Day 19 Producti
     C                     Z-ADD*ZERO     WN0264  61       Day 20 Producti
     C                     Z-ADD*ZERO     WN0265  61       Day 21 Producti
     C                     Z-ADD*ZERO     WN0266  61       Day 1 Sales USR
     C                     Z-ADD*ZERO     WN0267  61       Day 2 Sales USR
     C                     Z-ADD*ZERO     WN0268  61       Day 3 Sales USR
     C                     Z-ADD*ZERO     WN0269  61       Day 4 Sales USR
     C                     Z-ADD*ZERO     WN0270  61       Day 5 Sales USR
     C                     Z-ADD*ZERO     WN0271  61       Day 6 Sales USR
     C                     Z-ADD*ZERO     WN0272  61       Day 7 Sales USR
     C                     Z-ADD*ZERO     WN0273  61       Day 8 Sales USR
     C                     Z-ADD*ZERO     WN0274  61       Day 9 Sales USR
     C                     Z-ADD*ZERO     WN0275  61       Day 10 Sales US
     C                     Z-ADD*ZERO     WN0276  61       Day 11 Sales US
     C                     Z-ADD*ZERO     WN0277  61       Day 12 Sales US
     C                     Z-ADD*ZERO     WN0278  61       Day 13 Sales US
     C                     Z-ADD*ZERO     WN0279  61       Day 14 Sales US
     C                     Z-ADD*ZERO     WN0280  61       Day 15 Sales US
     C                     Z-ADD*ZERO     WN0281  61       Day 16 Sales US
     C                     Z-ADD*ZERO     WN0282  61       Day 17 Sales US
     C                     Z-ADD*ZERO     WN0283  61       Day 18 Sales US
     C                     Z-ADD*ZERO     WN0284  61       Day 19 Sales US
     C                     Z-ADD*ZERO     WN0285  61       Day 20 Sales US
     C                     Z-ADD*ZERO     WN0286  61       Day 21 Sales US
     C                     Z-ADD*ZERO     WN0287  61       Day 1 Adjustmen
     C                     Z-ADD*ZERO     WN0288  61       Day 2 Adjustmen
     C                     Z-ADD*ZERO     WN0289  61       Day 3 Adjustmen
     C                     Z-ADD*ZERO     WN0290  61       Day 4 Adjustmen
     C                     Z-ADD*ZERO     WN0291  61       Day 5 Adjustmen
     C                     Z-ADD*ZERO     WN0292  61       Day 6 Adjustmen
     C                     Z-ADD*ZERO     WN0293  61       Day 7 Adjustmen
     C                     Z-ADD*ZERO     WN0294  61       Day 8 Adjustmen
     C                     Z-ADD*ZERO     WN0295  61       Day 9 Adjustmen
     C                     Z-ADD*ZERO     WN0296  61       Day 10 Adjustme
     C                     Z-ADD*ZERO     WN0297  61       Day 11 Adjustme
     C                     Z-ADD*ZERO     WN0298  61       Day 12 Adjustme
     C                     Z-ADD*ZERO     WN0299  61       Day 13 Adjustme
     C                     Z-ADD*ZERO     WN0300  61       Day 14 Adjustme
     C                     Z-ADD*ZERO     WN0301  61       Day 15 Adjustme
     C                     Z-ADD*ZERO     WN0302  61       Day 16 Adjustme
     C                     Z-ADD*ZERO     WN0303  61       Day 17 Adjustme
     C                     Z-ADD*ZERO     WN0304  61       Day 18 Adjustme
     C                     Z-ADD*ZERO     WN0305  61       Day 19 Adjustme
     C                     Z-ADD*ZERO     WN0306  61       Day 20 Adjustme
     C                     Z-ADD*ZERO     WN0307  61       Day 21 Adjustme
     C                     Z-ADD*ZERO     WN0308  61       Day 1 Sched Shi
     C                     Z-ADD*ZERO     WN0309  61       Day 2 Sched Shi
     C                     Z-ADD*ZERO     WN0310  61       Day 3 Sched Shi
     C                     Z-ADD*ZERO     WN0311  61       Day 4 Sched Shi
     C                     Z-ADD*ZERO     WN0312  61       Day 5 Sched Shi
     C                     Z-ADD*ZERO     WN0313  61       Day 6 Sched Shi
     C                     Z-ADD*ZERO     WN0314  61       Day 7 Sched Shi
     C                     Z-ADD*ZERO     WN0315  61       Day 8 Sched Shi
     C                     Z-ADD*ZERO     WN0316  61       Day 9 Sched Shi
     C                     Z-ADD*ZERO     WN0317  61       Day 10 Sched Sh
     C                     Z-ADD*ZERO     WN0318  61       Day 11 Sched Sh
     C                     Z-ADD*ZERO     WN0319  61       Day 12 Sched Sh
     C                     Z-ADD*ZERO     WN0320  61       Day 13 Sched Sh
     C                     Z-ADD*ZERO     WN0321  61       Day 14 Sched Sh
     C                     Z-ADD*ZERO     WN0322  61       Day 15 Sched Sh
     C                     Z-ADD*ZERO     WN0323  61       Day 16 Sched Sh
     C                     Z-ADD*ZERO     WN0324  61       Day 17 Sched Sh
     C                     Z-ADD*ZERO     WN0325  61       Day 18 Sched Sh
     C                     Z-ADD*ZERO     WN0326  61       Day 19 Sched Sh
     C                     Z-ADD*ZERO     WN0327  61       Day 20 Sched Sh
     C                     Z-ADD*ZERO     WN0328  61       Day 21 Sched Sh
      *
      * RTV PA Tot SD-21      IF
      * FP1054 5/20/09 made inventory parms "B"oth, they were Neither
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0218           USR Day 1
     C                     Z-ADD*ZERO     WN0219           USR Day 2
     C                     Z-ADD*ZERO     WN0220           USR Day 3
     C                     Z-ADD*ZERO     WN0221           USR Day 4
     C                     Z-ADD*ZERO     WN0222           USR Day 5
     C                     Z-ADD*ZERO     WN0223           USR Day 6
     C                     Z-ADD*ZERO     WN0224           USR Day 7
     C                     Z-ADD*ZERO     WN0225           USR Day 8
     C                     Z-ADD*ZERO     WN0226           USR Day 9
     C                     Z-ADD*ZERO     WN0227           USR Day 10
     C                     Z-ADD*ZERO     WN0228           USR Day 11
     C                     Z-ADD*ZERO     WN0229           USR Day 12
     C                     Z-ADD*ZERO     WN0230           USR Day 13
     C                     Z-ADD*ZERO     WN0231           USR Day 14
     C                     Z-ADD*ZERO     WN0232           USR Day 15
     C                     Z-ADD*ZERO     WN0233           USR Day 16
     C                     Z-ADD*ZERO     WN0234           USR Day 17
     C                     Z-ADD*ZERO     WN0235           USR Day 18
     C                     Z-ADD*ZERO     WN0236           USR Day 19
     C                     Z-ADD*ZERO     WN0237           USR Day 20
     C                     Z-ADD*ZERO     WN0238           USR Day 21
     C                     Z-ADD*ZERO     YL0003           Day 1 Inventory
     C                     Z-ADD*ZERO     YL0004           Day 2 Inventory
     C                     Z-ADD*ZERO     YL0005           Day 3 Inventory
     C                     Z-ADD*ZERO     YL0006           Day 4 Inventory
     C                     Z-ADD*ZERO     YL0007           Day 5 Inventory
     C                     Z-ADD*ZERO     YL0008           Day 6 Inventory
     C                     Z-ADD*ZERO     YL0009           Day 7 Inventory
     C                     Z-ADD*ZERO     YL0010           Day 8 Inventory
     C                     Z-ADD*ZERO     WN0239           Day 9 Inventory
     C                     Z-ADD*ZERO     WN0240           Day 10 Inventor
     C                     Z-ADD*ZERO     WN0241           Day 11 Inventor
     C                     Z-ADD*ZERO     WN0242           Day 12 Inventor
     C                     Z-ADD*ZERO     WN0243           Day 13 Inventor
     C                     Z-ADD*ZERO     WN0244           Day 14 Inventor
     C                     Z-ADD*ZERO     WN0245           Day 1 Productio
     C                     Z-ADD*ZERO     WN0246           Day 2 Productio
     C                     Z-ADD*ZERO     WN0247           Day 3 Productio
     C                     Z-ADD*ZERO     WN0248           Day 4 Productio
     C                     Z-ADD*ZERO     WN0249           Day 5 Productio
     C                     Z-ADD*ZERO     WN0250           Day 6 Productio
     C                     Z-ADD*ZERO     WN0251           Day 7 Productio
     C                     Z-ADD*ZERO     WN0252           Day 8 Productio
     C                     Z-ADD*ZERO     WN0253           Day 9 Productio
     C                     Z-ADD*ZERO     WN0254           Day 10 Producti
     C                     Z-ADD*ZERO     WN0255           Day 11 Producti
     C                     Z-ADD*ZERO     WN0256           Day 12 Producti
     C                     Z-ADD*ZERO     WN0257           Day 13 Producti
     C                     Z-ADD*ZERO     WN0258           Day 14 Producti
     C                     Z-ADD*ZERO     WN0259           Day 15 Producti
     C                     Z-ADD*ZERO     WN0260           Day 16 Producti
     C                     Z-ADD*ZERO     WN0261           Day 17 Producti
     C                     Z-ADD*ZERO     WN0262           Day 18 Producti
     C                     Z-ADD*ZERO     WN0263           Day 19 Producti
     C                     Z-ADD*ZERO     WN0264           Day 20 Producti
     C                     Z-ADD*ZERO     WN0265           Day 21 Producti
     C                     Z-ADD*ZERO     WN0266           Day 1 Sales USR
     C                     Z-ADD*ZERO     WN0267           Day 2 Sales USR
     C                     Z-ADD*ZERO     WN0268           Day 3 Sales USR
     C                     Z-ADD*ZERO     WN0269           Day 4 Sales USR
     C                     Z-ADD*ZERO     WN0270           Day 5 Sales USR
     C                     Z-ADD*ZERO     WN0271           Day 6 Sales USR
     C                     Z-ADD*ZERO     WN0272           Day 7 Sales USR
     C                     Z-ADD*ZERO     WN0273           Day 8 Sales USR
     C                     Z-ADD*ZERO     WN0274           Day 9 Sales USR
     C                     Z-ADD*ZERO     WN0275           Day 10 Sales US
     C                     Z-ADD*ZERO     WN0276           Day 11 Sales US
     C                     Z-ADD*ZERO     WN0277           Day 12 Sales US
     C                     Z-ADD*ZERO     WN0278           Day 13 Sales US
     C                     Z-ADD*ZERO     WN0279           Day 14 Sales US
     C                     Z-ADD*ZERO     WN0280           Day 15 Sales US
     C                     Z-ADD*ZERO     WN0281           Day 16 Sales US
     C                     Z-ADD*ZERO     WN0282           Day 17 Sales US
     C                     Z-ADD*ZERO     WN0283           Day 18 Sales US
     C                     Z-ADD*ZERO     WN0284           Day 19 Sales US
     C                     Z-ADD*ZERO     WN0285           Day 20 Sales US
     C                     Z-ADD*ZERO     WN0286           Day 21 Sales US
     C                     Z-ADD*ZERO     WN0287           Day 1 Adjustmen
     C                     Z-ADD*ZERO     WN0288           Day 2 Adjustmen
     C                     Z-ADD*ZERO     WN0289           Day 3 Adjustmen
     C                     Z-ADD*ZERO     WN0290           Day 4 Adjustmen
     C                     Z-ADD*ZERO     WN0291           Day 5 Adjustmen
     C                     Z-ADD*ZERO     WN0292           Day 6 Adjustmen
     C                     Z-ADD*ZERO     WN0293           Day 7 Adjustmen
     C                     Z-ADD*ZERO     WN0294           Day 8 Adjustmen
     C                     Z-ADD*ZERO     WN0295           Day 9 Adjustmen
     C                     Z-ADD*ZERO     WN0296           Day 10 Adjustme
     C                     Z-ADD*ZERO     WN0297           Day 11 Adjustme
     C                     Z-ADD*ZERO     WN0298           Day 12 Adjustme
     C                     Z-ADD*ZERO     WN0299           Day 13 Adjustme
     C                     Z-ADD*ZERO     WN0300           Day 14 Adjustme
     C                     Z-ADD*ZERO     WN0301           Day 15 Adjustme
     C                     Z-ADD*ZERO     WN0302           Day 16 Adjustme
     C                     Z-ADD*ZERO     WN0303           Day 17 Adjustme
     C                     Z-ADD*ZERO     WN0304           Day 18 Adjustme
     C                     Z-ADD*ZERO     WN0305           Day 19 Adjustme
     C                     Z-ADD*ZERO     WN0306           Day 20 Adjustme
     C                     Z-ADD*ZERO     WN0307           Day 21 Adjustme
     C                     Z-ADD*ZERO     WN0023           Day 1 Availabil
     C                     Z-ADD*ZERO     WN0024           Day 2 Availabil
     C                     Z-ADD*ZERO     WN0025           Day 3 Availabil
     C                     Z-ADD*ZERO     WN0026           Day 4 Availabil
     C                     Z-ADD*ZERO     WN0027           Day 5 Availabil
     C                     Z-ADD*ZERO     WN0028           Day 6 Availabil
     C                     Z-ADD*ZERO     WN0029           Day 7 Availabil
     C                     Z-ADD*ZERO     WN0030           Day 8 Availabil
     C                     Z-ADD*ZERO     WN0031           Day 9 Availabil
     C                     Z-ADD*ZERO     WN0032           Day 10 Availabi
     C                     Z-ADD*ZERO     WN0033           Day 11 Availabi
     C                     Z-ADD*ZERO     WN0034           Day 12 Availabi
     C                     Z-ADD*ZERO     WN0035           Day 13 Availabi
     C                     Z-ADD*ZERO     WN0036           Day 14 Availabi
     C                     Z-ADD*ZERO     WN0037           Day 15 Availabi
     C                     Z-ADD*ZERO     WN0038           Day 16 Availabi
     C                     Z-ADD*ZERO     WN0039           Day 17 Availabi
     C                     Z-ADD*ZERO     WN0040           Day 18 Availabi
     C                     Z-ADD*ZERO     WN0041           Day 19 Availabi
     C                     Z-ADD*ZERO     WN0042           Day 20 Availabi
     C                     Z-ADD*ZERO     WN0043           Day 21 Availabi
     C                     Z-ADD*ZERO     WN0308           Day 1 Sched Shi
     C                     Z-ADD*ZERO     WN0309           Day 2 Sched Shi
     C                     Z-ADD*ZERO     WN0310           Day 3 Sched Shi
     C                     Z-ADD*ZERO     WN0311           Day 4 Sched Shi
     C                     Z-ADD*ZERO     WN0312           Day 5 Sched Shi
     C                     Z-ADD*ZERO     WN0313           Day 6 Sched Shi
     C                     Z-ADD*ZERO     WN0314           Day 7 Sched Shi
     C                     Z-ADD*ZERO     WN0315           Day 8 Sched Shi
     C                     Z-ADD*ZERO     WN0316           Day 9 Sched Shi
     C                     Z-ADD*ZERO     WN0317           Day 10 Sched Sh
     C                     Z-ADD*ZERO     WN0318           Day 11 Sched Sh
     C                     Z-ADD*ZERO     WN0319           Day 12 Sched Sh
     C                     Z-ADD*ZERO     WN0320           Day 13 Sched Sh
     C                     Z-ADD*ZERO     WN0321           Day 14 Sched Sh
     C                     Z-ADD*ZERO     WN0322           Day 15 Sched Sh
     C                     Z-ADD*ZERO     WN0323           Day 16 Sched Sh
     C                     Z-ADD*ZERO     WN0324           Day 17 Sched Sh
     C                     Z-ADD*ZERO     WN0325           Day 18 Sched Sh
     C                     Z-ADD*ZERO     WN0326           Day 19 Sched Sh
     C                     Z-ADD*ZERO     WN0327           Day 20 Sched Sh
     C                     Z-ADD*ZERO     WN0328           Day 21 Sched Sh
      *
     C                     Z-ADD*ZERO     WN0329  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0330  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0331  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0332  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0333  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0334  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0335  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0336  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0337  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0338  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0339  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0340  92       PS Weight Sched
      *
      * Rtv PA In/Sh SD-6     IF
      * Retrieve Inventory and Scheduled Shipments
      * Rtv PA In/Sh SD-6 WHS RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0001           Company Number
     C                     MOVEL'S'       WL0002    P      Production Type
     C                     Z-ADD##JDT     WL0003           Production Date
     C                     Z-ADD$DHGCD    WL0004           Item Code
     C                     MOVELWBAJCD    WL0005    P      Warehouse Code
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    WN0329           PS Weight Inv O
     C                     Z-ADDWL0007    WN0330           PS Pieces Inv O
     C                     Z-ADDWL0008    WN0331           PS Weight Inv A
     C                     Z-ADDWL0009    WN0332           PS Pieces Inv A
     C                     Z-ADDWL0010    WN0333           PS Weight Ship
     C                     Z-ADDWL0011    WN0334           PS Pieces Ship
     C                     Z-ADDWL0012    WN0335           PS Weight Prod
     C                     Z-ADDWL0013    WN0336           PS Pieces Prod
     C                     Z-ADDWL0014    WN0337           PS Weight Inv A
     C                     Z-ADDWL0015    WN0338           PS Pieces Inv A
     C                     Z-ADDWL0016    WN0339           PS Weight Order
     C                     Z-ADDWL0017    WN0340           PS Weight Sched
      * Inventory / Sales if Chilling Time > 0
      * CASE: Primary
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4W4ST    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           P6AIWG    IFGT *ZERO                      *IF
     C           P6PCCT    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Calculate Quantity based on Unit Weight or Pieces
      * CASE: PAR.Avail Ship Date 1 USR EQ JOB.*Job date
     C           P4FFDT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0341 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0342 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0341    WL0022           Weight Schedule
     C                     Z-ADDWN0342    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0341           Weight Schedule
     C                     Z-ADDWL0023    WN0342           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0329    ADD  WN0331    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0003           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0266           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0335    ADD  WN0337    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0266           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0341    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0308           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0333    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0287    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0287           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0330    ADD  WN0332    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0003           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0266           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0266           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0336    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0266    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0266           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0342    WN0308           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0334    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0287    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0287           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0003    ADD  WN0287    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0266    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0023           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 2 USR EQ JOB.*Job date
     C           P4E1DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0343 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0344 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0343    WL0022           Weight Schedule
     C                     Z-ADDWN0344    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0343           Weight Schedule
     C                     Z-ADDWL0023    WN0344           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0329    ADD  WN0331    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0004           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0267           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0335    ADD  WN0337    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0267           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0343    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0309           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0333    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0288    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0288           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0330    ADD  WN0332    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0004           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0267           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0267           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0336    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0267    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0267           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0344    WN0309           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0334    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0288    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0288           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0004    ADD  WN0288    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0267    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0024           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 3 USR EQ JOB.*Job date
     C           P4E2DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0345 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0346 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0345    WL0022           Weight Schedule
     C                     Z-ADDWN0346    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0345           Weight Schedule
     C                     Z-ADDWL0023    WN0346           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0329    ADD  WN0331    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0005           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0268           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0335    ADD  WN0337    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0268           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0345    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0310           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0333    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0289    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0289           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0330    ADD  WN0332    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0005           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0268           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0268           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0336    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0268    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0268           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0346    WN0310           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0334    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0289    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0289           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0005    ADD  WN0289    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0268    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0025           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 4 USR EQ JOB.*Job date
     C           P4E3DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0347 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0348 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0347    WL0022           Weight Schedule
     C                     Z-ADDWN0348    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0347           Weight Schedule
     C                     Z-ADDWL0023    WN0348           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0329    ADD  WN0331    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0006           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0269           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0335    ADD  WN0337    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0269           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0347    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0311           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0333    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0290    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0290           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0330    ADD  WN0332    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0006           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0269           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0269           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0336    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0269    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0269           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0348    WN0311           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0334    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0290    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0290           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0006    ADD  WN0290    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0269    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0026           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 5 USR EQ JOB.*Job date
     C           P4E4DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0349 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0350 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0349    WL0022           Weight Schedule
     C                     Z-ADDWN0350    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0349           Weight Schedule
     C                     Z-ADDWL0023    WN0350           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0329    ADD  WN0331    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0007           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0270           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0335    ADD  WN0337    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0270           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0349    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0312           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0333    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0291    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0291           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0330    ADD  WN0332    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0007           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0270           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0270           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0336    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0270    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0270           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0350    WN0312           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0334    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0291    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0291           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0007    ADD  WN0291    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0270    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0027           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 6 USR EQ JOB.*Job date
     C           P4E5DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0351 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0352 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0351    WL0022           Weight Schedule
     C                     Z-ADDWN0352    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0351           Weight Schedule
     C                     Z-ADDWL0023    WN0352           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0329    ADD  WN0331    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0008           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0271           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0335    ADD  WN0337    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0271           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0351    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0313           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0333    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0292    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0292           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0330    ADD  WN0332    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0008           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0271           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0271           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0336    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0271    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0271           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0352    WN0313           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0334    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0292    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0292           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0008    ADD  WN0292    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0271    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0028           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 7 USR EQ JOB.*Job date
     C           P4E6DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0353 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0354 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0353    WL0022           Weight Schedule
     C                     Z-ADDWN0354    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0353           Weight Schedule
     C                     Z-ADDWL0023    WN0354           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0329    ADD  WN0331    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0009           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0272           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0335    ADD  WN0337    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0272           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0353    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0314           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0333    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0293    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0293           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0330    ADD  WN0332    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0009           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0272           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0337    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0272           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0336    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0272    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0272           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0354    WN0314           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0334    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0293    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0293           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0009    ADD  WN0293    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0272    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0029           Quantity Availa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4W4ST    IFEQ 'L'                        *IF
     C           P4LDSZ    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Calculate Quantity based on Load Size
      * CASE: PAR.Avail Ship Date 1 USR EQ JOB.*Job date
     C           P4FFDT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0355 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0356 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0330    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0332    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0338    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0336    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0334    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0329    YL0012           PS Weight Inv O
     C                     Z-ADDWN0331    YL0013           PS Weight Inv A
     C                     Z-ADDWN0337    YL0014           PS Weight Inv A
     C                     Z-ADDWN0335    YL0015           PS Weight Prod
     C                     Z-ADDWN0333    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0355    WL0022           Weight Schedule
     C                     Z-ADDWN0356    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0355           Weight Schedule
     C                     Z-ADDWL0023    WN0356           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0355    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0308           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0003           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0266           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0266           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0287    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0287           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0003    ADD  WN0287    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0266    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0023           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 2 USR EQ JOB.*Job date
     C           P4E1DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0357 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0358 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0330    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0332    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0338    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0336    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0334    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0329    YL0012           PS Weight Inv O
     C                     Z-ADDWN0331    YL0013           PS Weight Inv A
     C                     Z-ADDWN0337    YL0014           PS Weight Inv A
     C                     Z-ADDWN0335    YL0015           PS Weight Prod
     C                     Z-ADDWN0333    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0357    WL0022           Weight Schedule
     C                     Z-ADDWN0358    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0357           Weight Schedule
     C                     Z-ADDWL0023    WN0358           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0357    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0309           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0004           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0267           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0267           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0288    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0288           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0004    ADD  WN0288    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0267    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0024           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 3 USR EQ JOB.*Job date
     C           P4E2DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0359 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0360 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0330    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0332    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0338    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0336    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0334    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0329    YL0012           PS Weight Inv O
     C                     Z-ADDWN0331    YL0013           PS Weight Inv A
     C                     Z-ADDWN0337    YL0014           PS Weight Inv A
     C                     Z-ADDWN0335    YL0015           PS Weight Prod
     C                     Z-ADDWN0333    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0359    WL0022           Weight Schedule
     C                     Z-ADDWN0360    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0359           Weight Schedule
     C                     Z-ADDWL0023    WN0360           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0359    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0310           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0005           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0268           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0268           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0289    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0289           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0005    ADD  WN0289    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0268    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0025           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 4 USR EQ JOB.*Job date
     C           P4E3DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0361 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0362 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0330    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0332    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0338    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0336    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0334    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0329    YL0012           PS Weight Inv O
     C                     Z-ADDWN0331    YL0013           PS Weight Inv A
     C                     Z-ADDWN0337    YL0014           PS Weight Inv A
     C                     Z-ADDWN0335    YL0015           PS Weight Prod
     C                     Z-ADDWN0333    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0361    WL0022           Weight Schedule
     C                     Z-ADDWN0362    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0361           Weight Schedule
     C                     Z-ADDWL0023    WN0362           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0361    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0311           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0006           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0269           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0269           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0290    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0290           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0006    ADD  WN0290    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0269    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0026           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 5 USR EQ JOB.*Job date
     C           P4E4DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0363 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0364 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0330    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0332    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0338    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0336    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0334    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0329    YL0012           PS Weight Inv O
     C                     Z-ADDWN0331    YL0013           PS Weight Inv A
     C                     Z-ADDWN0337    YL0014           PS Weight Inv A
     C                     Z-ADDWN0335    YL0015           PS Weight Prod
     C                     Z-ADDWN0333    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0363    WL0022           Weight Schedule
     C                     Z-ADDWN0364    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0363           Weight Schedule
     C                     Z-ADDWL0023    WN0364           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0363    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0312           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0007           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0270           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0270           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0291    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0291           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0007    ADD  WN0291    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0270    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0027           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 6 USR EQ JOB.*Job date
     C           P4E5DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0365 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0366 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0330    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0332    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0338    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0336    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0334    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0329    YL0012           PS Weight Inv O
     C                     Z-ADDWN0331    YL0013           PS Weight Inv A
     C                     Z-ADDWN0337    YL0014           PS Weight Inv A
     C                     Z-ADDWN0335    YL0015           PS Weight Prod
     C                     Z-ADDWN0333    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0365    WL0022           Weight Schedule
     C                     Z-ADDWN0366    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0365           Weight Schedule
     C                     Z-ADDWL0023    WN0366           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0365    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0313           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0008           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0271           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0271           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0292    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0292           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0008    ADD  WN0292    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0271    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0028           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 7 USR EQ JOB.*Job date
     C           P4E6DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0367 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0368 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0330    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0332    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0338    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0336    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0334    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0329    YL0012           PS Weight Inv O
     C                     Z-ADDWN0331    YL0013           PS Weight Inv A
     C                     Z-ADDWN0337    YL0014           PS Weight Inv A
     C                     Z-ADDWN0335    YL0015           PS Weight Prod
     C                     Z-ADDWN0333    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0367    WL0022           Weight Schedule
     C                     Z-ADDWN0368    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0367           Weight Schedule
     C                     Z-ADDWL0023    WN0368           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0367    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0314           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0009           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0272           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0272           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0293    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0293           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0009    ADD  WN0293    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0272    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0029           Quantity Availa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Total Inventory
      * CASE: PAR.Avail Dsp/Prt Type USR is Display
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'T'
      * Total Inventory
      * PAR.Day 8 Inventory USR =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 + x7)
      * x1    : PAR.Day 1 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Day 2 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x3    : PAR.Day 3 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x4    : PAR.Day 4 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x5    : PAR.Day 5 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x6    : PAR.Day 6 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x7    : PAR.Day 7 Inventory USR
     C           YL0003    ADD  YL0004    W0WD05           *Synon (17,7) w
     C           W0WD05    ADD  YL0005    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  YL0006    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  YL0007    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  YL0008    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  YL0009    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0010           Day 8 Inventory
     C                     END                             *FI
      * Rtv PA Dtl SD-21 WHS  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0028           Company Number
     C                     Z-ADD$DHGCD    WL0029           Item Code
     C                     MOVELWBAJCD    WL0030    P      Warehouse Code
     C                     Z-ADDP2GPDT    WL0031           PS Available Sh
     C                     Z-ADDP4FFDT    WL0032           Avail Ship Date
     C                     Z-ADDP4E1DT    WL0033           Avail Ship Date
     C                     Z-ADDP4E2DT    WL0034           Avail Ship Date
     C                     Z-ADDP4E3DT    WL0035           Avail Ship Date
     C                     Z-ADDP4E4DT    WL0036           Avail Ship Date
     C                     Z-ADDP4E5DT    WL0037           Avail Ship Date
     C                     Z-ADDP4E6DT    WL0038           Avail Ship Date
     C                     Z-ADDP4FKDT    WL0039           Avail Ship Date
     C                     Z-ADDP4FLDT    WL0040           Avail Ship Date
     C                     Z-ADDP4FGDT    WL0041           Avail Ship Date
     C                     Z-ADDP4FHDT    WL0042           Avail Ship Date
     C                     Z-ADDP4FIDT    WL0043           Avail Ship Date
     C                     Z-ADDP4FJDT    WL0044           Avail Ship Date
     C                     Z-ADDP4HPDT    WL0045           Avail Ship Date
     C                     Z-ADDP4HQDT    WL0046           Avail Ship Date
     C                     Z-ADDP4HRDT    WL0047           Avail Ship Date
     C                     Z-ADDP4HSDT    WL0048           Avail Ship Date
     C                     Z-ADDP4HTDT    WL0049           Avail Ship Date
     C                     Z-ADDP4HUDT    WL0050           Avail Ship Date
     C                     Z-ADDP4HVDT    WL0051           Avail Ship Date
     C                     Z-ADDP4HWDT    WL0052           Avail Ship Date
     C                     Z-ADDYL0003    WL0074           Day 1 Inventory
     C                     Z-ADDYL0004    WL0075           Day 2 Inventory
     C                     Z-ADDYL0005    WL0076           Day 3 Inventory
     C                     Z-ADDYL0006    WL0077           Day 4 Inventory
     C                     Z-ADDYL0007    WL0078           Day 5 Inventory
     C                     Z-ADDYL0008    WL0079           Day 6 Inventory
     C                     Z-ADDWN0245    WL0080           Day 1 Productio
     C                     Z-ADDWN0246    WL0081           Day 2 Productio
     C                     Z-ADDWN0247    WL0082           Day 3 Productio
     C                     Z-ADDWN0248    WL0083           Day 4 Productio
     C                     Z-ADDWN0249    WL0084           Day 5 Productio
     C                     Z-ADDWN0250    WL0085           Day 6 Productio
     C                     Z-ADDWN0251    WL0086           Day 7 Productio
     C                     Z-ADDWN0252    WL0087           Day 8 Productio
     C                     Z-ADDWN0253    WL0088           Day 9 Productio
     C                     Z-ADDWN0254    WL0089           Day 10 Producti
     C                     Z-ADDWN0255    WL0090           Day 11 Producti
     C                     Z-ADDWN0256    WL0091           Day 12 Producti
     C                     Z-ADDWN0257    WL0092           Day 13 Producti
     C                     Z-ADDWN0258    WL0093           Day 14 Producti
     C                     Z-ADDWN0259    WL0094           Day 15 Producti
     C                     Z-ADDWN0260    WL0095           Day 16 Producti
     C                     Z-ADDWN0261    WL0096           Day 17 Producti
     C                     Z-ADDWN0262    WL0097           Day 18 Producti
     C                     Z-ADDWN0263    WL0098           Day 19 Producti
     C                     Z-ADDWN0264    WL0099           Day 20 Producti
     C                     Z-ADDWN0265    WL0100           Day 21 Producti
     C                     Z-ADDWN0266    WL0101           Day 1 Sales USR
     C                     Z-ADDWN0267    WL0102           Day 2 Sales USR
     C                     Z-ADDWN0268    WL0103           Day 3 Sales USR
     C                     Z-ADDWN0269    WL0104           Day 4 Sales USR
     C                     Z-ADDWN0270    WL0105           Day 5 Sales USR
     C                     Z-ADDWN0271    WL0106           Day 6 Sales USR
     C                     Z-ADDWN0272    WL0107           Day 7 Sales USR
     C                     Z-ADDWN0273    WL0108           Day 8 Sales USR
     C                     Z-ADDWN0274    WL0109           Day 9 Sales USR
     C                     Z-ADDWN0275    WL0110           Day 10 Sales US
     C                     Z-ADDWN0276    WL0111           Day 11 Sales US
     C                     Z-ADDWN0277    WL0112           Day 12 Sales US
     C                     Z-ADDWN0278    WL0113           Day 13 Sales US
     C                     Z-ADDWN0279    WL0114           Day 14 Sales US
     C                     Z-ADDWN0280    WL0115           Day 15 Sales US
     C                     Z-ADDWN0281    WL0116           Day 16 Sales US
     C                     Z-ADDWN0282    WL0117           Day 17 Sales US
     C                     Z-ADDWN0283    WL0118           Day 18 Sales US
     C                     Z-ADDWN0284    WL0119           Day 19 Sales US
     C                     Z-ADDWN0285    WL0120           Day 20 Sales US
     C                     Z-ADDWN0286    WL0121           Day 21 Sales US
     C                     Z-ADDWN0287    WL0122           Day 1 Adjustmen
     C                     Z-ADDWN0288    WL0123           Day 2 Adjustmen
     C                     Z-ADDWN0289    WL0124           Day 3 Adjustmen
     C                     Z-ADDWN0290    WL0125           Day 4 Adjustmen
     C                     Z-ADDWN0291    WL0126           Day 5 Adjustmen
     C                     Z-ADDWN0292    WL0127           Day 6 Adjustmen
     C                     Z-ADDWN0293    WL0128           Day 7 Adjustmen
     C                     Z-ADDWN0294    WL0129           Day 8 Adjustmen
     C                     Z-ADDWN0295    WL0130           Day 9 Adjustmen
     C                     Z-ADDWN0296    WL0131           Day 10 Adjustme
     C                     Z-ADDWN0297    WL0132           Day 11 Adjustme
     C                     Z-ADDWN0298    WL0133           Day 12 Adjustme
     C                     Z-ADDWN0299    WL0134           Day 13 Adjustme
     C                     Z-ADDWN0300    WL0135           Day 14 Adjustme
     C                     Z-ADDWN0301    WL0136           Day 15 Adjustme
     C                     Z-ADDWN0302    WL0137           Day 16 Adjustme
     C                     Z-ADDWN0303    WL0138           Day 17 Adjustme
     C                     Z-ADDWN0304    WL0139           Day 18 Adjustme
     C                     Z-ADDWN0305    WL0140           Day 19 Adjustme
     C                     Z-ADDWN0306    WL0141           Day 20 Adjustme
     C                     Z-ADDWN0307    WL0142           Day 21 Adjustme
     C                     Z-ADDWN0023    WL0143           Day 1 Availabil
     C                     Z-ADDWN0024    WL0144           Day 2 Availabil
     C                     Z-ADDWN0025    WL0145           Day 3 Availabil
     C                     Z-ADDWN0026    WL0146           Day 4 Availabil
     C                     Z-ADDWN0027    WL0147           Day 5 Availabil
     C                     Z-ADDWN0028    WL0148           Day 6 Availabil
     C                     Z-ADDWN0029    WL0149           Day 7 Availabil
     C                     Z-ADDWN0030    WL0150           Day 8 Availabil
     C                     Z-ADDWN0031    WL0151           Day 9 Availabil
     C                     Z-ADDWN0032    WL0152           Day 10 Availabi
     C                     Z-ADDWN0033    WL0153           Day 11 Availabi
     C                     Z-ADDWN0034    WL0154           Day 12 Availabi
     C                     Z-ADDWN0035    WL0155           Day 13 Availabi
     C                     Z-ADDWN0036    WL0156           Day 14 Availabi
     C                     Z-ADDWN0037    WL0157           Day 15 Availabi
     C                     Z-ADDWN0038    WL0158           Day 16 Availabi
     C                     Z-ADDWN0039    WL0159           Day 17 Availabi
     C                     Z-ADDWN0040    WL0160           Day 18 Availabi
     C                     Z-ADDWN0041    WL0161           Day 19 Availabi
     C                     Z-ADDWN0042    WL0162           Day 20 Availabi
     C                     Z-ADDWN0043    WL0163           Day 21 Availabi
     C                     MOVELP4W4ST    WL0164    P      Primary/Load St
     C                     Z-ADDP4LDSZ    WL0165           Load Size USR
     C                     Z-ADDWN0308    WL0166           Day 1 Sched Shi
     C                     Z-ADDWN0309    WL0167           Day 2 Sched Shi
     C                     Z-ADDWN0310    WL0168           Day 3 Sched Shi
     C                     Z-ADDWN0311    WL0169           Day 4 Sched Shi
     C                     Z-ADDWN0312    WL0170           Day 5 Sched Shi
     C                     Z-ADDWN0313    WL0171           Day 6 Sched Shi
     C                     Z-ADDWN0314    WL0172           Day 7 Sched Shi
     C                     Z-ADDWN0315    WL0173           Day 8 Sched Shi
     C                     Z-ADDWN0316    WL0174           Day 9 Sched Shi
     C                     Z-ADDWN0317    WL0175           Day 10 Sched Sh
     C                     Z-ADDWN0318    WL0176           Day 11 Sched Sh
     C                     Z-ADDWN0319    WL0177           Day 12 Sched Sh
     C                     Z-ADDWN0320    WL0178           Day 13 Sched Sh
     C                     Z-ADDWN0321    WL0179           Day 14 Sched Sh
     C                     Z-ADDWN0322    WL0180           Day 15 Sched Sh
     C                     Z-ADDWN0323    WL0181           Day 16 Sched Sh
     C                     Z-ADDWN0324    WL0182           Day 17 Sched Sh
     C                     Z-ADDWN0325    WL0183           Day 18 Sched Sh
     C                     Z-ADDWN0326    WL0184           Day 19 Sched Sh
     C                     Z-ADDWN0327    WL0185           Day 20 Sched Sh
     C                     Z-ADDWN0328    WL0186           Day 21 Sched Sh
     C                     MOVEL'P'       WL0187    P      Avail Dsp/Prt T
     C                     MOVEL$DADCD    WL0188    P      U/M - Primary
     C                     Z-ADDP6AIWG    WL0189           Unit Weight
     C                     Z-ADDP6CHTM    WL0190           Fresh Chilling
     C                     MOVELP6PCCT    WL0191    P      Piece Count Ite
     C                     Z-ADDP6BDNB    WL0192           Pieces Per Bag
     C                     Z-ADDP6BJNB    WL0193           Bags Per Unit
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0053    WN0218           USR Day 1
     C                     Z-ADDWL0054    WN0219           USR Day 2
     C                     Z-ADDWL0055    WN0220           USR Day 3
     C                     Z-ADDWL0056    WN0221           USR Day 4
     C                     Z-ADDWL0057    WN0222           USR Day 5
     C                     Z-ADDWL0058    WN0223           USR Day 6
     C                     Z-ADDWL0059    WN0224           USR Day 7
     C                     Z-ADDWL0060    WN0225           USR Day 8
     C                     Z-ADDWL0061    WN0226           USR Day 9
     C                     Z-ADDWL0062    WN0227           USR Day 10
     C                     Z-ADDWL0063    WN0228           USR Day 11
     C                     Z-ADDWL0064    WN0229           USR Day 12
     C                     Z-ADDWL0065    WN0230           USR Day 13
     C                     Z-ADDWL0066    WN0231           USR Day 14
     C                     Z-ADDWL0067    WN0232           USR Day 15
     C                     Z-ADDWL0068    WN0233           USR Day 16
     C                     Z-ADDWL0069    WN0234           USR Day 17
     C                     Z-ADDWL0070    WN0235           USR Day 18
     C                     Z-ADDWL0071    WN0236           USR Day 19
     C                     Z-ADDWL0072    WN0237           USR Day 20
     C                     Z-ADDWL0073    WN0238           USR Day 21
     C                     Z-ADDWL0080    WN0245           Day 1 Productio
     C                     Z-ADDWL0081    WN0246           Day 2 Productio
     C                     Z-ADDWL0082    WN0247           Day 3 Productio
     C                     Z-ADDWL0083    WN0248           Day 4 Productio
     C                     Z-ADDWL0084    WN0249           Day 5 Productio
     C                     Z-ADDWL0085    WN0250           Day 6 Productio
     C                     Z-ADDWL0086    WN0251           Day 7 Productio
     C                     Z-ADDWL0087    WN0252           Day 8 Productio
     C                     Z-ADDWL0088    WN0253           Day 9 Productio
     C                     Z-ADDWL0089    WN0254           Day 10 Producti
     C                     Z-ADDWL0090    WN0255           Day 11 Producti
     C                     Z-ADDWL0091    WN0256           Day 12 Producti
     C                     Z-ADDWL0092    WN0257           Day 13 Producti
     C                     Z-ADDWL0093    WN0258           Day 14 Producti
     C                     Z-ADDWL0094    WN0259           Day 15 Producti
     C                     Z-ADDWL0095    WN0260           Day 16 Producti
     C                     Z-ADDWL0096    WN0261           Day 17 Producti
     C                     Z-ADDWL0097    WN0262           Day 18 Producti
     C                     Z-ADDWL0098    WN0263           Day 19 Producti
     C                     Z-ADDWL0099    WN0264           Day 20 Producti
     C                     Z-ADDWL0100    WN0265           Day 21 Producti
     C                     Z-ADDWL0101    WN0266           Day 1 Sales USR
     C                     Z-ADDWL0102    WN0267           Day 2 Sales USR
     C                     Z-ADDWL0103    WN0268           Day 3 Sales USR
     C                     Z-ADDWL0104    WN0269           Day 4 Sales USR
     C                     Z-ADDWL0105    WN0270           Day 5 Sales USR
     C                     Z-ADDWL0106    WN0271           Day 6 Sales USR
     C                     Z-ADDWL0107    WN0272           Day 7 Sales USR
     C                     Z-ADDWL0108    WN0273           Day 8 Sales USR
     C                     Z-ADDWL0109    WN0274           Day 9 Sales USR
     C                     Z-ADDWL0110    WN0275           Day 10 Sales US
     C                     Z-ADDWL0111    WN0276           Day 11 Sales US
     C                     Z-ADDWL0112    WN0277           Day 12 Sales US
     C                     Z-ADDWL0113    WN0278           Day 13 Sales US
     C                     Z-ADDWL0114    WN0279           Day 14 Sales US
     C                     Z-ADDWL0115    WN0280           Day 15 Sales US
     C                     Z-ADDWL0116    WN0281           Day 16 Sales US
     C                     Z-ADDWL0117    WN0282           Day 17 Sales US
     C                     Z-ADDWL0118    WN0283           Day 18 Sales US
     C                     Z-ADDWL0119    WN0284           Day 19 Sales US
     C                     Z-ADDWL0120    WN0285           Day 20 Sales US
     C                     Z-ADDWL0121    WN0286           Day 21 Sales US
     C                     Z-ADDWL0122    WN0287           Day 1 Adjustmen
     C                     Z-ADDWL0123    WN0288           Day 2 Adjustmen
     C                     Z-ADDWL0124    WN0289           Day 3 Adjustmen
     C                     Z-ADDWL0125    WN0290           Day 4 Adjustmen
     C                     Z-ADDWL0126    WN0291           Day 5 Adjustmen
     C                     Z-ADDWL0127    WN0292           Day 6 Adjustmen
     C                     Z-ADDWL0128    WN0293           Day 7 Adjustmen
     C                     Z-ADDWL0129    WN0294           Day 8 Adjustmen
     C                     Z-ADDWL0130    WN0295           Day 9 Adjustmen
     C                     Z-ADDWL0131    WN0296           Day 10 Adjustme
     C                     Z-ADDWL0132    WN0297           Day 11 Adjustme
     C                     Z-ADDWL0133    WN0298           Day 12 Adjustme
     C                     Z-ADDWL0134    WN0299           Day 13 Adjustme
     C                     Z-ADDWL0135    WN0300           Day 14 Adjustme
     C                     Z-ADDWL0136    WN0301           Day 15 Adjustme
     C                     Z-ADDWL0137    WN0302           Day 16 Adjustme
     C                     Z-ADDWL0138    WN0303           Day 17 Adjustme
     C                     Z-ADDWL0139    WN0304           Day 18 Adjustme
     C                     Z-ADDWL0140    WN0305           Day 19 Adjustme
     C                     Z-ADDWL0141    WN0306           Day 20 Adjustme
     C                     Z-ADDWL0142    WN0307           Day 21 Adjustme
     C                     Z-ADDWL0143    WN0023           Day 1 Availabil
     C                     Z-ADDWL0144    WN0024           Day 2 Availabil
     C                     Z-ADDWL0145    WN0025           Day 3 Availabil
     C                     Z-ADDWL0146    WN0026           Day 4 Availabil
     C                     Z-ADDWL0147    WN0027           Day 5 Availabil
     C                     Z-ADDWL0148    WN0028           Day 6 Availabil
     C                     Z-ADDWL0149    WN0029           Day 7 Availabil
     C                     Z-ADDWL0150    WN0030           Day 8 Availabil
     C                     Z-ADDWL0151    WN0031           Day 9 Availabil
     C                     Z-ADDWL0152    WN0032           Day 10 Availabi
     C                     Z-ADDWL0153    WN0033           Day 11 Availabi
     C                     Z-ADDWL0154    WN0034           Day 12 Availabi
     C                     Z-ADDWL0155    WN0035           Day 13 Availabi
     C                     Z-ADDWL0156    WN0036           Day 14 Availabi
     C                     Z-ADDWL0157    WN0037           Day 15 Availabi
     C                     Z-ADDWL0158    WN0038           Day 16 Availabi
     C                     Z-ADDWL0159    WN0039           Day 17 Availabi
     C                     Z-ADDWL0160    WN0040           Day 18 Availabi
     C                     Z-ADDWL0161    WN0041           Day 19 Availabi
     C                     Z-ADDWL0162    WN0042           Day 20 Availabi
     C                     Z-ADDWL0163    WN0043           Day 21 Availabi
     C                     Z-ADDWL0166    WN0308           Day 1 Sched Shi
     C                     Z-ADDWL0167    WN0309           Day 2 Sched Shi
     C                     Z-ADDWL0168    WN0310           Day 3 Sched Shi
     C                     Z-ADDWL0169    WN0311           Day 4 Sched Shi
     C                     Z-ADDWL0170    WN0312           Day 5 Sched Shi
     C                     Z-ADDWL0171    WN0313           Day 6 Sched Shi
     C                     Z-ADDWL0172    WN0314           Day 7 Sched Shi
     C                     Z-ADDWL0173    WN0315           Day 8 Sched Shi
     C                     Z-ADDWL0174    WN0316           Day 9 Sched Shi
     C                     Z-ADDWL0175    WN0317           Day 10 Sched Sh
     C                     Z-ADDWL0176    WN0318           Day 11 Sched Sh
     C                     Z-ADDWL0177    WN0319           Day 12 Sched Sh
     C                     Z-ADDWL0178    WN0320           Day 13 Sched Sh
     C                     Z-ADDWL0179    WN0321           Day 14 Sched Sh
     C                     Z-ADDWL0180    WN0322           Day 15 Sched Sh
     C                     Z-ADDWL0181    WN0323           Day 16 Sched Sh
     C                     Z-ADDWL0182    WN0324           Day 17 Sched Sh
     C                     Z-ADDWL0183    WN0325           Day 18 Sched Sh
     C                     Z-ADDWL0184    WN0326           Day 19 Sched Sh
     C                     Z-ADDWL0185    WN0327           Day 20 Sched Sh
     C                     Z-ADDWL0186    WN0328           Day 21 Sched Sh
     C                     MOVEL'Y'       YL0011           Status - Y or N
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Warehouse Code EQ DB1.Warehouse Code
     C           P3AJCD    IFEQ WBAJCD                     *IF
      *
     C                     Z-ADD*ZERO     WN0369  70       USR Day 1
     C                     Z-ADD*ZERO     WN0370  70       USR Day 2
     C                     Z-ADD*ZERO     WN0371  70       USR Day 3
     C                     Z-ADD*ZERO     WN0372  70       USR Day 4
     C                     Z-ADD*ZERO     WN0373  70       USR Day 5
     C                     Z-ADD*ZERO     WN0374  70       USR Day 6
     C                     Z-ADD*ZERO     WN0375  70       USR Day 7
     C                     Z-ADD*ZERO     WN0376  70       USR Day 8
     C                     Z-ADD*ZERO     WN0377  70       USR Day 9
     C                     Z-ADD*ZERO     WN0378  70       USR Day 10
     C                     Z-ADD*ZERO     WN0379  70       USR Day 11
     C                     Z-ADD*ZERO     WN0380  70       USR Day 12
     C                     Z-ADD*ZERO     WN0381  70       USR Day 13
     C                     Z-ADD*ZERO     WN0382  70       USR Day 14
     C                     Z-ADD*ZERO     WN0383  70       USR Day 15
     C                     Z-ADD*ZERO     WN0384  70       USR Day 16
     C                     Z-ADD*ZERO     WN0385  70       USR Day 17
     C                     Z-ADD*ZERO     WN0386  70       USR Day 18
     C                     Z-ADD*ZERO     WN0387  70       USR Day 19
     C                     Z-ADD*ZERO     WN0388  70       USR Day 20
     C                     Z-ADD*ZERO     WN0389  70       USR Day 21
     C                     Z-ADD*ZERO     WN0390  61       Day 9 Inventory
     C                     Z-ADD*ZERO     WN0391  61       Day 10 Inventor
     C                     Z-ADD*ZERO     WN0392  61       Day 11 Inventor
     C                     Z-ADD*ZERO     WN0393  61       Day 12 Inventor
     C                     Z-ADD*ZERO     WN0394  61       Day 13 Inventor
     C                     Z-ADD*ZERO     WN0395  61       Day 14 Inventor
     C                     Z-ADD*ZERO     WN0396  61       Day 1 Productio
     C                     Z-ADD*ZERO     WN0397  61       Day 2 Productio
     C                     Z-ADD*ZERO     WN0398  61       Day 3 Productio
     C                     Z-ADD*ZERO     WN0399  61       Day 4 Productio
     C                     Z-ADD*ZERO     WN0400  61       Day 5 Productio
     C                     Z-ADD*ZERO     WN0401  61       Day 6 Productio
     C                     Z-ADD*ZERO     WN0402  61       Day 7 Productio
     C                     Z-ADD*ZERO     WN0403  61       Day 8 Productio
     C                     Z-ADD*ZERO     WN0404  61       Day 9 Productio
     C                     Z-ADD*ZERO     WN0405  61       Day 10 Producti
     C                     Z-ADD*ZERO     WN0406  61       Day 11 Producti
     C                     Z-ADD*ZERO     WN0407  61       Day 12 Producti
     C                     Z-ADD*ZERO     WN0408  61       Day 13 Producti
     C                     Z-ADD*ZERO     WN0409  61       Day 14 Producti
     C                     Z-ADD*ZERO     WN0410  61       Day 15 Producti
     C                     Z-ADD*ZERO     WN0411  61       Day 16 Producti
     C                     Z-ADD*ZERO     WN0412  61       Day 17 Producti
     C                     Z-ADD*ZERO     WN0413  61       Day 18 Producti
     C                     Z-ADD*ZERO     WN0414  61       Day 19 Producti
     C                     Z-ADD*ZERO     WN0415  61       Day 20 Producti
     C                     Z-ADD*ZERO     WN0416  61       Day 21 Producti
     C                     Z-ADD*ZERO     WN0417  61       Day 1 Sales USR
     C                     Z-ADD*ZERO     WN0418  61       Day 2 Sales USR
     C                     Z-ADD*ZERO     WN0419  61       Day 3 Sales USR
     C                     Z-ADD*ZERO     WN0420  61       Day 4 Sales USR
     C                     Z-ADD*ZERO     WN0421  61       Day 5 Sales USR
     C                     Z-ADD*ZERO     WN0422  61       Day 6 Sales USR
     C                     Z-ADD*ZERO     WN0423  61       Day 7 Sales USR
     C                     Z-ADD*ZERO     WN0424  61       Day 8 Sales USR
     C                     Z-ADD*ZERO     WN0425  61       Day 9 Sales USR
     C                     Z-ADD*ZERO     WN0426  61       Day 10 Sales US
     C                     Z-ADD*ZERO     WN0427  61       Day 11 Sales US
     C                     Z-ADD*ZERO     WN0428  61       Day 12 Sales US
     C                     Z-ADD*ZERO     WN0429  61       Day 13 Sales US
     C                     Z-ADD*ZERO     WN0430  61       Day 14 Sales US
     C                     Z-ADD*ZERO     WN0431  61       Day 15 Sales US
     C                     Z-ADD*ZERO     WN0432  61       Day 16 Sales US
     C                     Z-ADD*ZERO     WN0433  61       Day 17 Sales US
     C                     Z-ADD*ZERO     WN0434  61       Day 18 Sales US
     C                     Z-ADD*ZERO     WN0435  61       Day 19 Sales US
     C                     Z-ADD*ZERO     WN0436  61       Day 20 Sales US
     C                     Z-ADD*ZERO     WN0437  61       Day 21 Sales US
     C                     Z-ADD*ZERO     WN0438  61       Day 1 Adjustmen
     C                     Z-ADD*ZERO     WN0439  61       Day 2 Adjustmen
     C                     Z-ADD*ZERO     WN0440  61       Day 3 Adjustmen
     C                     Z-ADD*ZERO     WN0441  61       Day 4 Adjustmen
     C                     Z-ADD*ZERO     WN0442  61       Day 5 Adjustmen
     C                     Z-ADD*ZERO     WN0443  61       Day 6 Adjustmen
     C                     Z-ADD*ZERO     WN0444  61       Day 7 Adjustmen
     C                     Z-ADD*ZERO     WN0445  61       Day 8 Adjustmen
     C                     Z-ADD*ZERO     WN0446  61       Day 9 Adjustmen
     C                     Z-ADD*ZERO     WN0447  61       Day 10 Adjustme
     C                     Z-ADD*ZERO     WN0448  61       Day 11 Adjustme
     C                     Z-ADD*ZERO     WN0449  61       Day 12 Adjustme
     C                     Z-ADD*ZERO     WN0450  61       Day 13 Adjustme
     C                     Z-ADD*ZERO     WN0451  61       Day 14 Adjustme
     C                     Z-ADD*ZERO     WN0452  61       Day 15 Adjustme
     C                     Z-ADD*ZERO     WN0453  61       Day 16 Adjustme
     C                     Z-ADD*ZERO     WN0454  61       Day 17 Adjustme
     C                     Z-ADD*ZERO     WN0455  61       Day 18 Adjustme
     C                     Z-ADD*ZERO     WN0456  61       Day 19 Adjustme
     C                     Z-ADD*ZERO     WN0457  61       Day 20 Adjustme
     C                     Z-ADD*ZERO     WN0458  61       Day 21 Adjustme
     C                     Z-ADD*ZERO     WN0459  61       Day 1 Sched Shi
     C                     Z-ADD*ZERO     WN0460  61       Day 2 Sched Shi
     C                     Z-ADD*ZERO     WN0461  61       Day 3 Sched Shi
     C                     Z-ADD*ZERO     WN0462  61       Day 4 Sched Shi
     C                     Z-ADD*ZERO     WN0463  61       Day 5 Sched Shi
     C                     Z-ADD*ZERO     WN0464  61       Day 6 Sched Shi
     C                     Z-ADD*ZERO     WN0465  61       Day 7 Sched Shi
     C                     Z-ADD*ZERO     WN0466  61       Day 8 Sched Shi
     C                     Z-ADD*ZERO     WN0467  61       Day 9 Sched Shi
     C                     Z-ADD*ZERO     WN0468  61       Day 10 Sched Sh
     C                     Z-ADD*ZERO     WN0469  61       Day 11 Sched Sh
     C                     Z-ADD*ZERO     WN0470  61       Day 12 Sched Sh
     C                     Z-ADD*ZERO     WN0471  61       Day 13 Sched Sh
     C                     Z-ADD*ZERO     WN0472  61       Day 14 Sched Sh
     C                     Z-ADD*ZERO     WN0473  61       Day 15 Sched Sh
     C                     Z-ADD*ZERO     WN0474  61       Day 16 Sched Sh
     C                     Z-ADD*ZERO     WN0475  61       Day 17 Sched Sh
     C                     Z-ADD*ZERO     WN0476  61       Day 18 Sched Sh
     C                     Z-ADD*ZERO     WN0477  61       Day 19 Sched Sh
     C                     Z-ADD*ZERO     WN0478  61       Day 20 Sched Sh
     C                     Z-ADD*ZERO     WN0479  61       Day 21 Sched Sh
      *
      * RTV PA Tot SD-21      IF
      * FP1054 5/20/09 made inventory parms "B"oth, they were Neither
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0369           USR Day 1
     C                     Z-ADD*ZERO     WN0370           USR Day 2
     C                     Z-ADD*ZERO     WN0371           USR Day 3
     C                     Z-ADD*ZERO     WN0372           USR Day 4
     C                     Z-ADD*ZERO     WN0373           USR Day 5
     C                     Z-ADD*ZERO     WN0374           USR Day 6
     C                     Z-ADD*ZERO     WN0375           USR Day 7
     C                     Z-ADD*ZERO     WN0376           USR Day 8
     C                     Z-ADD*ZERO     WN0377           USR Day 9
     C                     Z-ADD*ZERO     WN0378           USR Day 10
     C                     Z-ADD*ZERO     WN0379           USR Day 11
     C                     Z-ADD*ZERO     WN0380           USR Day 12
     C                     Z-ADD*ZERO     WN0381           USR Day 13
     C                     Z-ADD*ZERO     WN0382           USR Day 14
     C                     Z-ADD*ZERO     WN0383           USR Day 15
     C                     Z-ADD*ZERO     WN0384           USR Day 16
     C                     Z-ADD*ZERO     WN0385           USR Day 17
     C                     Z-ADD*ZERO     WN0386           USR Day 18
     C                     Z-ADD*ZERO     WN0387           USR Day 19
     C                     Z-ADD*ZERO     WN0388           USR Day 20
     C                     Z-ADD*ZERO     WN0389           USR Day 21
     C                     Z-ADD*ZERO     YL0003           Day 1 Inventory
     C                     Z-ADD*ZERO     YL0004           Day 2 Inventory
     C                     Z-ADD*ZERO     YL0005           Day 3 Inventory
     C                     Z-ADD*ZERO     YL0006           Day 4 Inventory
     C                     Z-ADD*ZERO     YL0007           Day 5 Inventory
     C                     Z-ADD*ZERO     YL0008           Day 6 Inventory
     C                     Z-ADD*ZERO     YL0009           Day 7 Inventory
     C                     Z-ADD*ZERO     YL0010           Day 8 Inventory
     C                     Z-ADD*ZERO     WN0390           Day 9 Inventory
     C                     Z-ADD*ZERO     WN0391           Day 10 Inventor
     C                     Z-ADD*ZERO     WN0392           Day 11 Inventor
     C                     Z-ADD*ZERO     WN0393           Day 12 Inventor
     C                     Z-ADD*ZERO     WN0394           Day 13 Inventor
     C                     Z-ADD*ZERO     WN0395           Day 14 Inventor
     C                     Z-ADD*ZERO     WN0396           Day 1 Productio
     C                     Z-ADD*ZERO     WN0397           Day 2 Productio
     C                     Z-ADD*ZERO     WN0398           Day 3 Productio
     C                     Z-ADD*ZERO     WN0399           Day 4 Productio
     C                     Z-ADD*ZERO     WN0400           Day 5 Productio
     C                     Z-ADD*ZERO     WN0401           Day 6 Productio
     C                     Z-ADD*ZERO     WN0402           Day 7 Productio
     C                     Z-ADD*ZERO     WN0403           Day 8 Productio
     C                     Z-ADD*ZERO     WN0404           Day 9 Productio
     C                     Z-ADD*ZERO     WN0405           Day 10 Producti
     C                     Z-ADD*ZERO     WN0406           Day 11 Producti
     C                     Z-ADD*ZERO     WN0407           Day 12 Producti
     C                     Z-ADD*ZERO     WN0408           Day 13 Producti
     C                     Z-ADD*ZERO     WN0409           Day 14 Producti
     C                     Z-ADD*ZERO     WN0410           Day 15 Producti
     C                     Z-ADD*ZERO     WN0411           Day 16 Producti
     C                     Z-ADD*ZERO     WN0412           Day 17 Producti
     C                     Z-ADD*ZERO     WN0413           Day 18 Producti
     C                     Z-ADD*ZERO     WN0414           Day 19 Producti
     C                     Z-ADD*ZERO     WN0415           Day 20 Producti
     C                     Z-ADD*ZERO     WN0416           Day 21 Producti
     C                     Z-ADD*ZERO     WN0417           Day 1 Sales USR
     C                     Z-ADD*ZERO     WN0418           Day 2 Sales USR
     C                     Z-ADD*ZERO     WN0419           Day 3 Sales USR
     C                     Z-ADD*ZERO     WN0420           Day 4 Sales USR
     C                     Z-ADD*ZERO     WN0421           Day 5 Sales USR
     C                     Z-ADD*ZERO     WN0422           Day 6 Sales USR
     C                     Z-ADD*ZERO     WN0423           Day 7 Sales USR
     C                     Z-ADD*ZERO     WN0424           Day 8 Sales USR
     C                     Z-ADD*ZERO     WN0425           Day 9 Sales USR
     C                     Z-ADD*ZERO     WN0426           Day 10 Sales US
     C                     Z-ADD*ZERO     WN0427           Day 11 Sales US
     C                     Z-ADD*ZERO     WN0428           Day 12 Sales US
     C                     Z-ADD*ZERO     WN0429           Day 13 Sales US
     C                     Z-ADD*ZERO     WN0430           Day 14 Sales US
     C                     Z-ADD*ZERO     WN0431           Day 15 Sales US
     C                     Z-ADD*ZERO     WN0432           Day 16 Sales US
     C                     Z-ADD*ZERO     WN0433           Day 17 Sales US
     C                     Z-ADD*ZERO     WN0434           Day 18 Sales US
     C                     Z-ADD*ZERO     WN0435           Day 19 Sales US
     C                     Z-ADD*ZERO     WN0436           Day 20 Sales US
     C                     Z-ADD*ZERO     WN0437           Day 21 Sales US
     C                     Z-ADD*ZERO     WN0438           Day 1 Adjustmen
     C                     Z-ADD*ZERO     WN0439           Day 2 Adjustmen
     C                     Z-ADD*ZERO     WN0440           Day 3 Adjustmen
     C                     Z-ADD*ZERO     WN0441           Day 4 Adjustmen
     C                     Z-ADD*ZERO     WN0442           Day 5 Adjustmen
     C                     Z-ADD*ZERO     WN0443           Day 6 Adjustmen
     C                     Z-ADD*ZERO     WN0444           Day 7 Adjustmen
     C                     Z-ADD*ZERO     WN0445           Day 8 Adjustmen
     C                     Z-ADD*ZERO     WN0446           Day 9 Adjustmen
     C                     Z-ADD*ZERO     WN0447           Day 10 Adjustme
     C                     Z-ADD*ZERO     WN0448           Day 11 Adjustme
     C                     Z-ADD*ZERO     WN0449           Day 12 Adjustme
     C                     Z-ADD*ZERO     WN0450           Day 13 Adjustme
     C                     Z-ADD*ZERO     WN0451           Day 14 Adjustme
     C                     Z-ADD*ZERO     WN0452           Day 15 Adjustme
     C                     Z-ADD*ZERO     WN0453           Day 16 Adjustme
     C                     Z-ADD*ZERO     WN0454           Day 17 Adjustme
     C                     Z-ADD*ZERO     WN0455           Day 18 Adjustme
     C                     Z-ADD*ZERO     WN0456           Day 19 Adjustme
     C                     Z-ADD*ZERO     WN0457           Day 20 Adjustme
     C                     Z-ADD*ZERO     WN0458           Day 21 Adjustme
     C                     Z-ADD*ZERO     WN0023           Day 1 Availabil
     C                     Z-ADD*ZERO     WN0024           Day 2 Availabil
     C                     Z-ADD*ZERO     WN0025           Day 3 Availabil
     C                     Z-ADD*ZERO     WN0026           Day 4 Availabil
     C                     Z-ADD*ZERO     WN0027           Day 5 Availabil
     C                     Z-ADD*ZERO     WN0028           Day 6 Availabil
     C                     Z-ADD*ZERO     WN0029           Day 7 Availabil
     C                     Z-ADD*ZERO     WN0030           Day 8 Availabil
     C                     Z-ADD*ZERO     WN0031           Day 9 Availabil
     C                     Z-ADD*ZERO     WN0032           Day 10 Availabi
     C                     Z-ADD*ZERO     WN0033           Day 11 Availabi
     C                     Z-ADD*ZERO     WN0034           Day 12 Availabi
     C                     Z-ADD*ZERO     WN0035           Day 13 Availabi
     C                     Z-ADD*ZERO     WN0036           Day 14 Availabi
     C                     Z-ADD*ZERO     WN0037           Day 15 Availabi
     C                     Z-ADD*ZERO     WN0038           Day 16 Availabi
     C                     Z-ADD*ZERO     WN0039           Day 17 Availabi
     C                     Z-ADD*ZERO     WN0040           Day 18 Availabi
     C                     Z-ADD*ZERO     WN0041           Day 19 Availabi
     C                     Z-ADD*ZERO     WN0042           Day 20 Availabi
     C                     Z-ADD*ZERO     WN0043           Day 21 Availabi
     C                     Z-ADD*ZERO     WN0459           Day 1 Sched Shi
     C                     Z-ADD*ZERO     WN0460           Day 2 Sched Shi
     C                     Z-ADD*ZERO     WN0461           Day 3 Sched Shi
     C                     Z-ADD*ZERO     WN0462           Day 4 Sched Shi
     C                     Z-ADD*ZERO     WN0463           Day 5 Sched Shi
     C                     Z-ADD*ZERO     WN0464           Day 6 Sched Shi
     C                     Z-ADD*ZERO     WN0465           Day 7 Sched Shi
     C                     Z-ADD*ZERO     WN0466           Day 8 Sched Shi
     C                     Z-ADD*ZERO     WN0467           Day 9 Sched Shi
     C                     Z-ADD*ZERO     WN0468           Day 10 Sched Sh
     C                     Z-ADD*ZERO     WN0469           Day 11 Sched Sh
     C                     Z-ADD*ZERO     WN0470           Day 12 Sched Sh
     C                     Z-ADD*ZERO     WN0471           Day 13 Sched Sh
     C                     Z-ADD*ZERO     WN0472           Day 14 Sched Sh
     C                     Z-ADD*ZERO     WN0473           Day 15 Sched Sh
     C                     Z-ADD*ZERO     WN0474           Day 16 Sched Sh
     C                     Z-ADD*ZERO     WN0475           Day 17 Sched Sh
     C                     Z-ADD*ZERO     WN0476           Day 18 Sched Sh
     C                     Z-ADD*ZERO     WN0477           Day 19 Sched Sh
     C                     Z-ADD*ZERO     WN0478           Day 20 Sched Sh
     C                     Z-ADD*ZERO     WN0479           Day 21 Sched Sh
      *
     C                     Z-ADD*ZERO     WN0480  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0481  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0482  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0483  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0484  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0485  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0486  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0487  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0488  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0489  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0490  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0491  92       PS Weight Sched
      *
      * Rtv PA In/Sh SD-6     IF
      * Retrieve Inventory and Scheduled Shipments
      * Rtv PA In/Sh SD-6 WHS RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0001           Company Number
     C                     MOVEL'S'       WL0002    P      Production Type
     C                     Z-ADD##JDT     WL0003           Production Date
     C                     Z-ADD$DHGCD    WL0004           Item Code
     C                     MOVELWBAJCD    WL0005    P      Warehouse Code
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    WN0480           PS Weight Inv O
     C                     Z-ADDWL0007    WN0481           PS Pieces Inv O
     C                     Z-ADDWL0008    WN0482           PS Weight Inv A
     C                     Z-ADDWL0009    WN0483           PS Pieces Inv A
     C                     Z-ADDWL0010    WN0484           PS Weight Ship
     C                     Z-ADDWL0011    WN0485           PS Pieces Ship
     C                     Z-ADDWL0012    WN0486           PS Weight Prod
     C                     Z-ADDWL0013    WN0487           PS Pieces Prod
     C                     Z-ADDWL0014    WN0488           PS Weight Inv A
     C                     Z-ADDWL0015    WN0489           PS Pieces Inv A
     C                     Z-ADDWL0016    WN0490           PS Weight Order
     C                     Z-ADDWL0017    WN0491           PS Weight Sched
      * Inventory / Sales if Chilling Time > 0
      * CASE: Primary
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4W4ST    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           P6AIWG    IFGT *ZERO                      *IF
     C           P6PCCT    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Calculate Quantity based on Unit Weight or Pieces
      * CASE: PAR.Avail Ship Date 1 USR EQ JOB.*Job date
     C           P4FFDT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0492 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0493 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0492    WL0022           Weight Schedule
     C                     Z-ADDWN0493    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0492           Weight Schedule
     C                     Z-ADDWL0023    WN0493           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0480    ADD  WN0482    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0003           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0417           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0486    ADD  WN0488    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0417           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0492    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0459           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0484    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0438    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0438           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0481    ADD  WN0483    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0003           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0417           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0417           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0487    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0417    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0417           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0493    WN0459           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0485    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0438    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0438           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0003    ADD  WN0438    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0417    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0023           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 2 USR EQ JOB.*Job date
     C           P4E1DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0494 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0495 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0494    WL0022           Weight Schedule
     C                     Z-ADDWN0495    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0494           Weight Schedule
     C                     Z-ADDWL0023    WN0495           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0480    ADD  WN0482    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0004           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0418           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0486    ADD  WN0488    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0418           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0494    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0460           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0484    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0439    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0439           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0481    ADD  WN0483    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0004           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0418           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0418           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0487    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0418    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0418           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0495    WN0460           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0485    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0439    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0439           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0004    ADD  WN0439    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0418    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0024           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 3 USR EQ JOB.*Job date
     C           P4E2DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0496 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0497 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0496    WL0022           Weight Schedule
     C                     Z-ADDWN0497    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0496           Weight Schedule
     C                     Z-ADDWL0023    WN0497           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0480    ADD  WN0482    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0005           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0419           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0486    ADD  WN0488    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0419           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0496    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0461           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0484    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0440    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0440           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0481    ADD  WN0483    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0005           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0419           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0419           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0487    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0419    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0419           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0497    WN0461           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0485    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0440    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0440           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0005    ADD  WN0440    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0419    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0025           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 4 USR EQ JOB.*Job date
     C           P4E3DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0498 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0499 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0498    WL0022           Weight Schedule
     C                     Z-ADDWN0499    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0498           Weight Schedule
     C                     Z-ADDWL0023    WN0499           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0480    ADD  WN0482    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0006           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0420           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0486    ADD  WN0488    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0420           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0498    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0462           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0484    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0441    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0441           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0481    ADD  WN0483    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0006           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0420           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0420           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0487    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0420    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0420           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0499    WN0462           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0485    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0441    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0441           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0006    ADD  WN0441    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0420    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0026           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 5 USR EQ JOB.*Job date
     C           P4E4DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0500 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0501 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0500    WL0022           Weight Schedule
     C                     Z-ADDWN0501    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0500           Weight Schedule
     C                     Z-ADDWL0023    WN0501           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0480    ADD  WN0482    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0007           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0421           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0486    ADD  WN0488    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0421           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0500    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0463           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0484    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0442    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0442           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0481    ADD  WN0483    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0007           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0421           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0421           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0487    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0421    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0421           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0501    WN0463           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0485    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0442    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0442           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0007    ADD  WN0442    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0421    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0027           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 6 USR EQ JOB.*Job date
     C           P4E5DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0502 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0503 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0502    WL0022           Weight Schedule
     C                     Z-ADDWN0503    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0502           Weight Schedule
     C                     Z-ADDWL0023    WN0503           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0480    ADD  WN0482    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0008           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0422           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0486    ADD  WN0488    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0422           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0502    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0464           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0484    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0443    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0443           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0481    ADD  WN0483    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0008           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0422           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0422           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0487    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0422    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0422           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0503    WN0464           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0485    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0443    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0443           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0008    ADD  WN0443    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0422    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0028           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 7 USR EQ JOB.*Job date
     C           P4E6DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0504 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0505 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Unt Wgt IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0504    WL0022           Weight Schedule
     C                     Z-ADDWN0505    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0504           Weight Schedule
     C                     Z-ADDWL0023    WN0505           Quantity Schedu
     C                     END                             *FI
      * Calculate Inventory/Reserved/Shipments/Ship Cut Adjustment/Sales
      * CASE: ** Piece Count = N **
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ *BLANK                     *IF
     C           P6PCCT    OREQ 'N'
     C           P6AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Moved calc for non-piece count here.
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : PAR.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Weight Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0480    ADD  WN0482    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0009           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Fresh Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0423           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Reserved
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3 + x4) / x2)
      * x3    : PAR.PS Weight Prod Allocated
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0486    ADD  WN0488    W0WJ01           *Synon (15,0) w
     C           W0WJ01    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0423           Quantity Sales
     C                     END                             *FI
      * Sched Shipments (ie.SALE)
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0504    DIV  P6AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0465           Quantity Sched
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           WN0484    DIV  P6AIWG    W0WJ01    H      *Synon (15,0) w
     C           WN0444    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0444           Quantity Adjust
     C                     ELSE
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 06/24/09 FP1054:  Calcualte Inventory by Pieces
      * Inventory On-Hand
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / (x2 * x4))
      * x1    : PAR.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
     C           WN0481    ADD  WN0483    W0WJ01           *Synon (15,0) w
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           W0WJ01    DIV  W0WD02    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0009           Quantity Invent
      * Reserved (Sales)
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE ( x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0423           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Inv Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0488    DIV  P6AIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0423           Quantity Sales
      * Inv Alloc + Prod Alloc
      * PAR.Quantity Sales USR =
      *    *COMPUTE (x4 + (x3 / (x2 * x1)))
      * x4    : PAR.Quantity Sales USR
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x1    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0487    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0423    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0423           Quantity Sales
     C                     END                             *FI
     C                     Z-ADDWN0505    WN0465           Quantity Sched
      * Comp:Ship Cut Adj(No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / (x4 * x5)))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.Bags Per Unit
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0485    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           WN0444    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0444           Quantity Adjust
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Quantity Avail
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0009    ADD  WN0444    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0423    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0029           Quantity Availa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4W4ST    IFEQ 'L'                        *IF
     C           P4LDSZ    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Calculate Quantity based on Load Size
      * CASE: PAR.Avail Ship Date 1 USR EQ JOB.*Job date
     C           P4FFDT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0506 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0507 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0481    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0483    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0489    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0487    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0485    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0480    YL0012           PS Weight Inv O
     C                     Z-ADDWN0482    YL0013           PS Weight Inv A
     C                     Z-ADDWN0488    YL0014           PS Weight Inv A
     C                     Z-ADDWN0486    YL0015           PS Weight Prod
     C                     Z-ADDWN0484    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0506    WL0022           Weight Schedule
     C                     Z-ADDWN0507    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0506           Weight Schedule
     C                     Z-ADDWL0023    WN0507           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0506    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0459           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0003           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0417           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0417           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0438    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0438           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0003    ADD  WN0438    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0417    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0023           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 2 USR EQ JOB.*Job date
     C           P4E1DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0508 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0509 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0481    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0483    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0489    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0487    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0485    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0480    YL0012           PS Weight Inv O
     C                     Z-ADDWN0482    YL0013           PS Weight Inv A
     C                     Z-ADDWN0488    YL0014           PS Weight Inv A
     C                     Z-ADDWN0486    YL0015           PS Weight Prod
     C                     Z-ADDWN0484    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0508    WL0022           Weight Schedule
     C                     Z-ADDWN0509    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0508           Weight Schedule
     C                     Z-ADDWL0023    WN0509           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0508    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0460           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0004           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0418           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0418           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0439    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0439           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0004    ADD  WN0439    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0418    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0024           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 3 USR EQ JOB.*Job date
     C           P4E2DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0510 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0511 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0481    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0483    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0489    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0487    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0485    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0480    YL0012           PS Weight Inv O
     C                     Z-ADDWN0482    YL0013           PS Weight Inv A
     C                     Z-ADDWN0488    YL0014           PS Weight Inv A
     C                     Z-ADDWN0486    YL0015           PS Weight Prod
     C                     Z-ADDWN0484    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0510    WL0022           Weight Schedule
     C                     Z-ADDWN0511    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0510           Weight Schedule
     C                     Z-ADDWL0023    WN0511           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0510    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0461           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0005           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0419           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0419           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0440    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0440           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0005    ADD  WN0440    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0419    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0025           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 4 USR EQ JOB.*Job date
     C           P4E3DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0512 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0513 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0481    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0483    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0489    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0487    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0485    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0480    YL0012           PS Weight Inv O
     C                     Z-ADDWN0482    YL0013           PS Weight Inv A
     C                     Z-ADDWN0488    YL0014           PS Weight Inv A
     C                     Z-ADDWN0486    YL0015           PS Weight Prod
     C                     Z-ADDWN0484    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0512    WL0022           Weight Schedule
     C                     Z-ADDWN0513    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0512           Weight Schedule
     C                     Z-ADDWL0023    WN0513           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0512    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0462           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0006           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0420           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0420           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0441    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0441           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0006    ADD  WN0441    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0420    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0026           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 5 USR EQ JOB.*Job date
     C           P4E4DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0514 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0515 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0481    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0483    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0489    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0487    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0485    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0480    YL0012           PS Weight Inv O
     C                     Z-ADDWN0482    YL0013           PS Weight Inv A
     C                     Z-ADDWN0488    YL0014           PS Weight Inv A
     C                     Z-ADDWN0486    YL0015           PS Weight Prod
     C                     Z-ADDWN0484    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0514    WL0022           Weight Schedule
     C                     Z-ADDWN0515    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0514           Weight Schedule
     C                     Z-ADDWL0023    WN0515           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0514    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0463           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0007           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0421           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0421           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0442    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0442           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0007    ADD  WN0442    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0421    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0027           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 6 USR EQ JOB.*Job date
     C           P4E5DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0516 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0517 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0481    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0483    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0489    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0487    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0485    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0480    YL0012           PS Weight Inv O
     C                     Z-ADDWN0482    YL0013           PS Weight Inv A
     C                     Z-ADDWN0488    YL0014           PS Weight Inv A
     C                     Z-ADDWN0486    YL0015           PS Weight Prod
     C                     Z-ADDWN0484    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0516    WL0022           Weight Schedule
     C                     Z-ADDWN0517    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0516           Weight Schedule
     C                     Z-ADDWL0023    WN0517           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0516    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0464           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0008           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0422           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0422           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0443    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0443           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0008    ADD  WN0443    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0422    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0028           Quantity Availa
     C                     ELSE
      * CASE: PAR.Avail Ship Date 7 USR EQ JOB.*Job date
     C           P4E6DT    IFEQ ##JDT                      *IF
      *
     C                     Z-ADD*ZERO     WN0518 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0519 112       Quantity Schedu
      *
      * Clc Inv/Sls w/Load Sz IF
      * ---- 02/21/11 PKD Calculate Weight based on Unit Weight. ----
      * OVERRIDE: Weight
      * CASE: ** Piece Count = Y **
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6PCCT    IFEQ 'Y'                        *IF
     C           P6BDNB    IFGT *ZERO                      *IF
     C           P6BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PS Weight Inv On-Hand
      * LCL.PS Weight Inv On-Hand =
      *    *COMPUTE (((x1) / (x2 * x4)) * x10)
      * x1    : PAR.PS Pieces Inv On-Hand
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0481    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           PS Weight Inv O
      * PS Weight Inv Adj
      * LCL.PS Weight Inv Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0483    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           PS Weight Inv A
      * PS Weight Inv Allocated
      * LCL.PS Weight Inv Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0489    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           PS Weight Inv A
      * PS Weight Prod Allocated
      * LCL.PS Weight Prod Allocated =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0487    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0015           PS Weight Prod
      * PS Weight Ship Cut Adj
      * LCL.PS Weight Ship Cut Adj =
      *    *COMPUTE (((x3) / (x2 * x4)) * x10)
      * x3    : PAR.PS Pieces Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x10   : PAR.Unit Weight
     C           P6BDNB    MULT P6BJNB    W0WD02           *Synon (17,7) w
     C           WN0485    DIV  W0WD02    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P6AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           PS Weight Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0480    YL0012           PS Weight Inv O
     C                     Z-ADDWN0482    YL0013           PS Weight Inv A
     C                     Z-ADDWN0488    YL0014           PS Weight Inv A
     C                     Z-ADDWN0486    YL0015           PS Weight Prod
     C                     Z-ADDWN0484    YL0016           PS Weight Ship
     C                     END                             *FI
      * -------------------------------------------------------------
      * Scheduled Shipments
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Avail Dsp/Prt Type USR is Display Detail
      *   |- c2    : PAR.Avail Dsp/Prt Type USR is Print Detail
      *   '-
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'L'                        *OR
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DHGCD    WL0019           Item Code
     C                     MOVELWBAJCD    WL0020    P      Warehouse Code
     C                     Z-ADD##JDT     WL0021           Scheduled Ship
     C                     Z-ADDWN0518    WL0022           Weight Schedule
     C                     Z-ADDWN0519    WL0023           Quantity Schedu
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    WN0518           Weight Schedule
     C                     Z-ADDWL0023    WN0519           Quantity Schedu
      * Scheduled Shipments
      * PAR.Quantity Sched Ship USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           WN0518    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0465           Quantity Sched
     C                     END                             *FI
      * 02/21/11 PKD Replaced with LCL context instead of PAR.
      * Inventory
      * PAR.Quantity Inventory USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Inv Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0012    ADD  YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0009           Quantity Invent
      * Sales ----->  RESERVED
      * CASE: PAR.Chilling Time is GT Zero
     C           P6CHTM    IFGT *ZERO                      *IF
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x3) / x2)
      * x3    : LCL.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0423           Quantity Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * Sales
      * PAR.Quantity Sales USR =
      *    *COMPUTE ((x1 + x3) / x2)
      * x1    : LCL.PS Weight Inv Allocated
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Load Size USR
     C           YL0014    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  P4LDSZ    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0423           Quantity Sales
     C                     END                             *FI
      * Ship Cut Adj (No Dec)
      * PAR.Quantity Adjustment USR =
      *    *COMPUTE (x1 + (x2 / x4))
      * x1    : PAR.Quantity Adjustment USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : LCL.PS Weight Ship Cut Adj
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0016    DIV  P4LDSZ    W0WJ01    H      *Synon (15,0) w
     C           WN0444    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0444           Quantity Adjust
      * Quantity Available
      * PAR.Quantity Available USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Quantity Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Adjustment USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Quantity Sales USR
     C           YL0009    ADD  WN0444    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0423    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0029           Quantity Availa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Total Inventory
      * CASE: PAR.Avail Dsp/Prt Type USR is Display
     C           'P'       IFEQ 'D'                        *IF
     C           'P'       OREQ 'T'
      * Total Inventory
      * PAR.Day 8 Inventory USR =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 + x7)
      * x1    : PAR.Day 1 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Day 2 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x3    : PAR.Day 3 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x4    : PAR.Day 4 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x5    : PAR.Day 5 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x6    : PAR.Day 6 Inventory USR
      * +     : PGM.*Synon (17,7) work field
      * x7    : PAR.Day 7 Inventory USR
     C           YL0003    ADD  YL0004    W0WD05           *Synon (17,7) w
     C           W0WD05    ADD  YL0005    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  YL0006    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  YL0007    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  YL0008    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  YL0009    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0010           Day 8 Inventory
     C                     END                             *FI
      * Rtv PA Dtl SD-21 WHS  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0028           Company Number
     C                     Z-ADD$DHGCD    WL0029           Item Code
     C                     MOVELWBAJCD    WL0030    P      Warehouse Code
     C                     Z-ADDP2GPDT    WL0031           PS Available Sh
     C                     Z-ADDP4FFDT    WL0032           Avail Ship Date
     C                     Z-ADDP4E1DT    WL0033           Avail Ship Date
     C                     Z-ADDP4E2DT    WL0034           Avail Ship Date
     C                     Z-ADDP4E3DT    WL0035           Avail Ship Date
     C                     Z-ADDP4E4DT    WL0036           Avail Ship Date
     C                     Z-ADDP4E5DT    WL0037           Avail Ship Date
     C                     Z-ADDP4E6DT    WL0038           Avail Ship Date
     C                     Z-ADDP4FKDT    WL0039           Avail Ship Date
     C                     Z-ADDP4FLDT    WL0040           Avail Ship Date
     C                     Z-ADDP4FGDT    WL0041           Avail Ship Date
     C                     Z-ADDP4FHDT    WL0042           Avail Ship Date
     C                     Z-ADDP4FIDT    WL0043           Avail Ship Date
     C                     Z-ADDP4FJDT    WL0044           Avail Ship Date
     C                     Z-ADDP4HPDT    WL0045           Avail Ship Date
     C                     Z-ADDP4HQDT    WL0046           Avail Ship Date
     C                     Z-ADDP4HRDT    WL0047           Avail Ship Date
     C                     Z-ADDP4HSDT    WL0048           Avail Ship Date
     C                     Z-ADDP4HTDT    WL0049           Avail Ship Date
     C                     Z-ADDP4HUDT    WL0050           Avail Ship Date
     C                     Z-ADDP4HVDT    WL0051           Avail Ship Date
     C                     Z-ADDP4HWDT    WL0052           Avail Ship Date
     C                     Z-ADDYL0003    WL0074           Day 1 Inventory
     C                     Z-ADDYL0004    WL0075           Day 2 Inventory
     C                     Z-ADDYL0005    WL0076           Day 3 Inventory
     C                     Z-ADDYL0006    WL0077           Day 4 Inventory
     C                     Z-ADDYL0007    WL0078           Day 5 Inventory
     C                     Z-ADDYL0008    WL0079           Day 6 Inventory
     C                     Z-ADDWN0396    WL0080           Day 1 Productio
     C                     Z-ADDWN0397    WL0081           Day 2 Productio
     C                     Z-ADDWN0398    WL0082           Day 3 Productio
     C                     Z-ADDWN0399    WL0083           Day 4 Productio
     C                     Z-ADDWN0400    WL0084           Day 5 Productio
     C                     Z-ADDWN0401    WL0085           Day 6 Productio
     C                     Z-ADDWN0402    WL0086           Day 7 Productio
     C                     Z-ADDWN0403    WL0087           Day 8 Productio
     C                     Z-ADDWN0404    WL0088           Day 9 Productio
     C                     Z-ADDWN0405    WL0089           Day 10 Producti
     C                     Z-ADDWN0406    WL0090           Day 11 Producti
     C                     Z-ADDWN0407    WL0091           Day 12 Producti
     C                     Z-ADDWN0408    WL0092           Day 13 Producti
     C                     Z-ADDWN0409    WL0093           Day 14 Producti
     C                     Z-ADDWN0410    WL0094           Day 15 Producti
     C                     Z-ADDWN0411    WL0095           Day 16 Producti
     C                     Z-ADDWN0412    WL0096           Day 17 Producti
     C                     Z-ADDWN0413    WL0097           Day 18 Producti
     C                     Z-ADDWN0414    WL0098           Day 19 Producti
     C                     Z-ADDWN0415    WL0099           Day 20 Producti
     C                     Z-ADDWN0416    WL0100           Day 21 Producti
     C                     Z-ADDWN0417    WL0101           Day 1 Sales USR
     C                     Z-ADDWN0418    WL0102           Day 2 Sales USR
     C                     Z-ADDWN0419    WL0103           Day 3 Sales USR
     C                     Z-ADDWN0420    WL0104           Day 4 Sales USR
     C                     Z-ADDWN0421    WL0105           Day 5 Sales USR
     C                     Z-ADDWN0422    WL0106           Day 6 Sales USR
     C                     Z-ADDWN0423    WL0107           Day 7 Sales USR
     C                     Z-ADDWN0424    WL0108           Day 8 Sales USR
     C                     Z-ADDWN0425    WL0109           Day 9 Sales USR
     C                     Z-ADDWN0426    WL0110           Day 10 Sales US
     C                     Z-ADDWN0427    WL0111           Day 11 Sales US
     C                     Z-ADDWN0428    WL0112           Day 12 Sales US
     C                     Z-ADDWN0429    WL0113           Day 13 Sales US
     C                     Z-ADDWN0430    WL0114           Day 14 Sales US
     C                     Z-ADDWN0431    WL0115           Day 15 Sales US
     C                     Z-ADDWN0432    WL0116           Day 16 Sales US
     C                     Z-ADDWN0433    WL0117           Day 17 Sales US
     C                     Z-ADDWN0434    WL0118           Day 18 Sales US
     C                     Z-ADDWN0435    WL0119           Day 19 Sales US
     C                     Z-ADDWN0436    WL0120           Day 20 Sales US
     C                     Z-ADDWN0437    WL0121           Day 21 Sales US
     C                     Z-ADDWN0438    WL0122           Day 1 Adjustmen
     C                     Z-ADDWN0439    WL0123           Day 2 Adjustmen
     C                     Z-ADDWN0440    WL0124           Day 3 Adjustmen
     C                     Z-ADDWN0441    WL0125           Day 4 Adjustmen
     C                     Z-ADDWN0442    WL0126           Day 5 Adjustmen
     C                     Z-ADDWN0443    WL0127           Day 6 Adjustmen
     C                     Z-ADDWN0444    WL0128           Day 7 Adjustmen
     C                     Z-ADDWN0445    WL0129           Day 8 Adjustmen
     C                     Z-ADDWN0446    WL0130           Day 9 Adjustmen
     C                     Z-ADDWN0447    WL0131           Day 10 Adjustme
     C                     Z-ADDWN0448    WL0132           Day 11 Adjustme
     C                     Z-ADDWN0449    WL0133           Day 12 Adjustme
     C                     Z-ADDWN0450    WL0134           Day 13 Adjustme
     C                     Z-ADDWN0451    WL0135           Day 14 Adjustme
     C                     Z-ADDWN0452    WL0136           Day 15 Adjustme
     C                     Z-ADDWN0453    WL0137           Day 16 Adjustme
     C                     Z-ADDWN0454    WL0138           Day 17 Adjustme
     C                     Z-ADDWN0455    WL0139           Day 18 Adjustme
     C                     Z-ADDWN0456    WL0140           Day 19 Adjustme
     C                     Z-ADDWN0457    WL0141           Day 20 Adjustme
     C                     Z-ADDWN0458    WL0142           Day 21 Adjustme
     C                     Z-ADDWN0023    WL0143           Day 1 Availabil
     C                     Z-ADDWN0024    WL0144           Day 2 Availabil
     C                     Z-ADDWN0025    WL0145           Day 3 Availabil
     C                     Z-ADDWN0026    WL0146           Day 4 Availabil
     C                     Z-ADDWN0027    WL0147           Day 5 Availabil
     C                     Z-ADDWN0028    WL0148           Day 6 Availabil
     C                     Z-ADDWN0029    WL0149           Day 7 Availabil
     C                     Z-ADDWN0030    WL0150           Day 8 Availabil
     C                     Z-ADDWN0031    WL0151           Day 9 Availabil
     C                     Z-ADDWN0032    WL0152           Day 10 Availabi
     C                     Z-ADDWN0033    WL0153           Day 11 Availabi
     C                     Z-ADDWN0034    WL0154           Day 12 Availabi
     C                     Z-ADDWN0035    WL0155           Day 13 Availabi
     C                     Z-ADDWN0036    WL0156           Day 14 Availabi
     C                     Z-ADDWN0037    WL0157           Day 15 Availabi
     C                     Z-ADDWN0038    WL0158           Day 16 Availabi
     C                     Z-ADDWN0039    WL0159           Day 17 Availabi
     C                     Z-ADDWN0040    WL0160           Day 18 Availabi
     C                     Z-ADDWN0041    WL0161           Day 19 Availabi
     C                     Z-ADDWN0042    WL0162           Day 20 Availabi
     C                     Z-ADDWN0043    WL0163           Day 21 Availabi
     C                     MOVELP4W4ST    WL0164    P      Primary/Load St
     C                     Z-ADDP4LDSZ    WL0165           Load Size USR
     C                     Z-ADDWN0459    WL0166           Day 1 Sched Shi
     C                     Z-ADDWN0460    WL0167           Day 2 Sched Shi
     C                     Z-ADDWN0461    WL0168           Day 3 Sched Shi
     C                     Z-ADDWN0462    WL0169           Day 4 Sched Shi
     C                     Z-ADDWN0463    WL0170           Day 5 Sched Shi
     C                     Z-ADDWN0464    WL0171           Day 6 Sched Shi
     C                     Z-ADDWN0465    WL0172           Day 7 Sched Shi
     C                     Z-ADDWN0466    WL0173           Day 8 Sched Shi
     C                     Z-ADDWN0467    WL0174           Day 9 Sched Shi
     C                     Z-ADDWN0468    WL0175           Day 10 Sched Sh
     C                     Z-ADDWN0469    WL0176           Day 11 Sched Sh
     C                     Z-ADDWN0470    WL0177           Day 12 Sched Sh
     C                     Z-ADDWN0471    WL0178           Day 13 Sched Sh
     C                     Z-ADDWN0472    WL0179           Day 14 Sched Sh
     C                     Z-ADDWN0473    WL0180           Day 15 Sched Sh
     C                     Z-ADDWN0474    WL0181           Day 16 Sched Sh
     C                     Z-ADDWN0475    WL0182           Day 17 Sched Sh
     C                     Z-ADDWN0476    WL0183           Day 18 Sched Sh
     C                     Z-ADDWN0477    WL0184           Day 19 Sched Sh
     C                     Z-ADDWN0478    WL0185           Day 20 Sched Sh
     C                     Z-ADDWN0479    WL0186           Day 21 Sched Sh
     C                     MOVEL'P'       WL0187    P      Avail Dsp/Prt T
     C                     MOVEL$DADCD    WL0188    P      U/M - Primary
     C                     Z-ADDP6AIWG    WL0189           Unit Weight
     C                     Z-ADDP6CHTM    WL0190           Fresh Chilling
     C                     MOVELP6PCCT    WL0191    P      Piece Count Ite
     C                     Z-ADDP6BDNB    WL0192           Pieces Per Bag
     C                     Z-ADDP6BJNB    WL0193           Bags Per Unit
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0053    WN0369           USR Day 1
     C                     Z-ADDWL0054    WN0370           USR Day 2
     C                     Z-ADDWL0055    WN0371           USR Day 3
     C                     Z-ADDWL0056    WN0372           USR Day 4
     C                     Z-ADDWL0057    WN0373           USR Day 5
     C                     Z-ADDWL0058    WN0374           USR Day 6
     C                     Z-ADDWL0059    WN0375           USR Day 7
     C                     Z-ADDWL0060    WN0376           USR Day 8
     C                     Z-ADDWL0061    WN0377           USR Day 9
     C                     Z-ADDWL0062    WN0378           USR Day 10
     C                     Z-ADDWL0063    WN0379           USR Day 11
     C                     Z-ADDWL0064    WN0380           USR Day 12
     C                     Z-ADDWL0065    WN0381           USR Day 13
     C                     Z-ADDWL0066    WN0382           USR Day 14
     C                     Z-ADDWL0067    WN0383           USR Day 15
     C                     Z-ADDWL0068    WN0384           USR Day 16
     C                     Z-ADDWL0069    WN0385           USR Day 17
     C                     Z-ADDWL0070    WN0386           USR Day 18
     C                     Z-ADDWL0071    WN0387           USR Day 19
     C                     Z-ADDWL0072    WN0388           USR Day 20
     C                     Z-ADDWL0073    WN0389           USR Day 21
     C                     Z-ADDWL0080    WN0396           Day 1 Productio
     C                     Z-ADDWL0081    WN0397           Day 2 Productio
     C                     Z-ADDWL0082    WN0398           Day 3 Productio
     C                     Z-ADDWL0083    WN0399           Day 4 Productio
     C                     Z-ADDWL0084    WN0400           Day 5 Productio
     C                     Z-ADDWL0085    WN0401           Day 6 Productio
     C                     Z-ADDWL0086    WN0402           Day 7 Productio
     C                     Z-ADDWL0087    WN0403           Day 8 Productio
     C                     Z-ADDWL0088    WN0404           Day 9 Productio
     C                     Z-ADDWL0089    WN0405           Day 10 Producti
     C                     Z-ADDWL0090    WN0406           Day 11 Producti
     C                     Z-ADDWL0091    WN0407           Day 12 Producti
     C                     Z-ADDWL0092    WN0408           Day 13 Producti
     C                     Z-ADDWL0093    WN0409           Day 14 Producti
     C                     Z-ADDWL0094    WN0410           Day 15 Producti
     C                     Z-ADDWL0095    WN0411           Day 16 Producti
     C                     Z-ADDWL0096    WN0412           Day 17 Producti
     C                     Z-ADDWL0097    WN0413           Day 18 Producti
     C                     Z-ADDWL0098    WN0414           Day 19 Producti
     C                     Z-ADDWL0099    WN0415           Day 20 Producti
     C                     Z-ADDWL0100    WN0416           Day 21 Producti
     C                     Z-ADDWL0101    WN0417           Day 1 Sales USR
     C                     Z-ADDWL0102    WN0418           Day 2 Sales USR
     C                     Z-ADDWL0103    WN0419           Day 3 Sales USR
     C                     Z-ADDWL0104    WN0420           Day 4 Sales USR
     C                     Z-ADDWL0105    WN0421           Day 5 Sales USR
     C                     Z-ADDWL0106    WN0422           Day 6 Sales USR
     C                     Z-ADDWL0107    WN0423           Day 7 Sales USR
     C                     Z-ADDWL0108    WN0424           Day 8 Sales USR
     C                     Z-ADDWL0109    WN0425           Day 9 Sales USR
     C                     Z-ADDWL0110    WN0426           Day 10 Sales US
     C                     Z-ADDWL0111    WN0427           Day 11 Sales US
     C                     Z-ADDWL0112    WN0428           Day 12 Sales US
     C                     Z-ADDWL0113    WN0429           Day 13 Sales US
     C                     Z-ADDWL0114    WN0430           Day 14 Sales US
     C                     Z-ADDWL0115    WN0431           Day 15 Sales US
     C                     Z-ADDWL0116    WN0432           Day 16 Sales US
     C                     Z-ADDWL0117    WN0433           Day 17 Sales US
     C                     Z-ADDWL0118    WN0434           Day 18 Sales US
     C                     Z-ADDWL0119    WN0435           Day 19 Sales US
     C                     Z-ADDWL0120    WN0436           Day 20 Sales US
     C                     Z-ADDWL0121    WN0437           Day 21 Sales US
     C                     Z-ADDWL0122    WN0438           Day 1 Adjustmen
     C                     Z-ADDWL0123    WN0439           Day 2 Adjustmen
     C                     Z-ADDWL0124    WN0440           Day 3 Adjustmen
     C                     Z-ADDWL0125    WN0441           Day 4 Adjustmen
     C                     Z-ADDWL0126    WN0442           Day 5 Adjustmen
     C                     Z-ADDWL0127    WN0443           Day 6 Adjustmen
     C                     Z-ADDWL0128    WN0444           Day 7 Adjustmen
     C                     Z-ADDWL0129    WN0445           Day 8 Adjustmen
     C                     Z-ADDWL0130    WN0446           Day 9 Adjustmen
     C                     Z-ADDWL0131    WN0447           Day 10 Adjustme
     C                     Z-ADDWL0132    WN0448           Day 11 Adjustme
     C                     Z-ADDWL0133    WN0449           Day 12 Adjustme
     C                     Z-ADDWL0134    WN0450           Day 13 Adjustme
     C                     Z-ADDWL0135    WN0451           Day 14 Adjustme
     C                     Z-ADDWL0136    WN0452           Day 15 Adjustme
     C                     Z-ADDWL0137    WN0453           Day 16 Adjustme
     C                     Z-ADDWL0138    WN0454           Day 17 Adjustme
     C                     Z-ADDWL0139    WN0455           Day 18 Adjustme
     C                     Z-ADDWL0140    WN0456           Day 19 Adjustme
     C                     Z-ADDWL0141    WN0457           Day 20 Adjustme
     C                     Z-ADDWL0142    WN0458           Day 21 Adjustme
     C                     Z-ADDWL0143    WN0023           Day 1 Availabil
     C                     Z-ADDWL0144    WN0024           Day 2 Availabil
     C                     Z-ADDWL0145    WN0025           Day 3 Availabil
     C                     Z-ADDWL0146    WN0026           Day 4 Availabil
     C                     Z-ADDWL0147    WN0027           Day 5 Availabil
     C                     Z-ADDWL0148    WN0028           Day 6 Availabil
     C                     Z-ADDWL0149    WN0029           Day 7 Availabil
     C                     Z-ADDWL0150    WN0030           Day 8 Availabil
     C                     Z-ADDWL0151    WN0031           Day 9 Availabil
     C                     Z-ADDWL0152    WN0032           Day 10 Availabi
     C                     Z-ADDWL0153    WN0033           Day 11 Availabi
     C                     Z-ADDWL0154    WN0034           Day 12 Availabi
     C                     Z-ADDWL0155    WN0035           Day 13 Availabi
     C                     Z-ADDWL0156    WN0036           Day 14 Availabi
     C                     Z-ADDWL0157    WN0037           Day 15 Availabi
     C                     Z-ADDWL0158    WN0038           Day 16 Availabi
     C                     Z-ADDWL0159    WN0039           Day 17 Availabi
     C                     Z-ADDWL0160    WN0040           Day 18 Availabi
     C                     Z-ADDWL0161    WN0041           Day 19 Availabi
     C                     Z-ADDWL0162    WN0042           Day 20 Availabi
     C                     Z-ADDWL0163    WN0043           Day 21 Availabi
     C                     Z-ADDWL0166    WN0459           Day 1 Sched Shi
     C                     Z-ADDWL0167    WN0460           Day 2 Sched Shi
     C                     Z-ADDWL0168    WN0461           Day 3 Sched Shi
     C                     Z-ADDWL0169    WN0462           Day 4 Sched Shi
     C                     Z-ADDWL0170    WN0463           Day 5 Sched Shi
     C                     Z-ADDWL0171    WN0464           Day 6 Sched Shi
     C                     Z-ADDWL0172    WN0465           Day 7 Sched Shi
     C                     Z-ADDWL0173    WN0466           Day 8 Sched Shi
     C                     Z-ADDWL0174    WN0467           Day 9 Sched Shi
     C                     Z-ADDWL0175    WN0468           Day 10 Sched Sh
     C                     Z-ADDWL0176    WN0469           Day 11 Sched Sh
     C                     Z-ADDWL0177    WN0470           Day 12 Sched Sh
     C                     Z-ADDWL0178    WN0471           Day 13 Sched Sh
     C                     Z-ADDWL0179    WN0472           Day 14 Sched Sh
     C                     Z-ADDWL0180    WN0473           Day 15 Sched Sh
     C                     Z-ADDWL0181    WN0474           Day 16 Sched Sh
     C                     Z-ADDWL0182    WN0475           Day 17 Sched Sh
     C                     Z-ADDWL0183    WN0476           Day 18 Sched Sh
     C                     Z-ADDWL0184    WN0477           Day 19 Sched Sh
     C                     Z-ADDWL0185    WN0478           Day 20 Sched Sh
     C                     Z-ADDWL0186    WN0479           Day 21 Sched Sh
     C                     MOVEL'Y'       YL0011           Status - Y or N
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Day 1 Availability USR < 0
      * CASE: PAR.Day 1 Availability USR is LT Zero
     C           WN0023    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0023           Day 1 Availabil
     C                     END                             *FI
      * Day 2 Availability USR < 0
      * CASE: PAR.Day 2 Availability USR is LT Zero
     C           WN0024    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0024           Day 2 Availabil
     C                     END                             *FI
      * Day 3 Availability USR < 0
      * CASE: PAR.Day 3 Availability USR is LT Zero
     C           WN0025    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0025           Day 3 Availabil
     C                     END                             *FI
      * Day 4 Availability USR < 0
      * CASE: PAR.Day 4 Availability USR is LT Zero
     C           WN0026    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0026           Day 4 Availabil
     C                     END                             *FI
      * Day 5 Availability USR < 0
      * CASE: PAR.Day 5 Availability USR is LT Zero
     C           WN0027    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0027           Day 5 Availabil
     C                     END                             *FI
      * Day 6 Availability USR < 0
      * CASE: PAR.Day 6 Availability USR is LT Zero
     C           WN0028    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0028           Day 6 Availabil
     C                     END                             *FI
      * Day 7 Availability USR < 0
      * CASE: PAR.Day 7 Availability USR is LT Zero
     C           WN0029    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0029           Day 7 Availabil
     C                     END                             *FI
      * Day 8 Availability USR < 0
      * CASE: PAR.Day 8 Availability USR is LT Zero
     C           WN0030    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0030           Day 8 Availabil
     C                     END                             *FI
      * Day 9 Availability USR < 0
      * CASE: PAR.Day 9 Availability USR is LT Zero
     C           WN0031    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0031           Day 9 Availabil
     C                     END                             *FI
      * Day 10 Availability USR < 0
      * CASE: PAR.Day 10 Availability USR is LT Zero
     C           WN0032    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0032           Day 10 Availabi
     C                     END                             *FI
      * Day 11 Availability USR < 0
      * CASE: PAR.Day 11 Availability USR is LT Zero
     C           WN0033    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0033           Day 11 Availabi
     C                     END                             *FI
      * Day 12 Availability USR < 0
      * CASE: PAR.Day 12 Availability USR is LT Zero
     C           WN0034    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0034           Day 12 Availabi
     C                     END                             *FI
      * Day 13 Availability USR < 0
      * CASE: PAR.Day 13 Availability USR is LT Zero
     C           WN0035    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0035           Day 13 Availabi
     C                     END                             *FI
      * Day 14 Availability USR < 0
      * CASE: PAR.Day 14 Availability USR is LT Zero
     C           WN0036    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0036           Day 14 Availabi
     C                     END                             *FI
      * Day 15 Availability USR < 0
      * CASE: PAR.Day 15 Availability USR is LT Zero
     C           WN0037    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0037           Day 15 Availabi
     C                     END                             *FI
      * Day 16 Availability USR < 0
      * CASE: PAR.Day 16 Availability USR is LT Zero
     C           WN0038    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0038           Day 16 Availabi
     C                     END                             *FI
      * Day 17 Availability USR < 0
      * CASE: PAR.Day 17 Availability USR is LT Zero
     C           WN0039    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0039           Day 17 Availabi
     C                     END                             *FI
      * Day 18 Availability USR < 0
      * CASE: PAR.Day 18 Availability USR is LT Zero
     C           WN0040    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0040           Day 18 Availabi
     C                     END                             *FI
      * Day 19 Availability USR < 0
      * CASE: PAR.Day 19 Availability USR is LT Zero
     C           WN0041    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0041           Day 19 Availabi
     C                     END                             *FI
      * Day 20 Availability USR < 0
      * CASE: PAR.Day 20 Availability USR is LT Zero
     C           WN0042    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0042           Day 20 Availabi
     C                     END                             *FI
      * Day 21 Availability USR < 0
      * CASE: PAR.Day 21 Availability USR is LT Zero
     C           WN0043    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0043           Day 21 Availabi
     C                     END                             *FI
      * Accumulate Availability
      * CASE: LCL.Status - Y or N is yes
     C           YL0011    IFEQ 'Y'                        *IF
     C                     ADD  WN0023    $DD1AV           Day 1 Avail Tot
     C                     ADD  WN0024    $DD2AV           Day 2 Avail Tot
     C                     ADD  WN0025    $DD3AV           Day 3 Avail Tot
     C                     ADD  WN0026    $DD4AV           Day 4 Avail Tot
     C                     ADD  WN0027    $DD5AV           Day 5 Avail Tot
     C                     ADD  WN0028    $DD6AV           Day 6 Avail Tot
     C                     ADD  WN0029    $DD7AV           Day 7 Avail Tot
     C                     ADD  WN0030    $DD8AV           Day 8 Avail Tot
     C                     ADD  WN0031    $DD9AV           Day 9 Avail Tot
     C                     ADD  WN0032    $DD1AB           Day 10 Avail To
     C                     ADD  WN0033    $DD2AB           Day 11 Avail To
     C                     ADD  WN0034    $DD3AB           Day 12 Avail To
     C                     ADD  WN0035    $DD4AB           Day 13 Avail To
     C                     ADD  WN0036    $DD5AB           Day 14 Avail To
     C                     ADD  WN0037    $DD6AB           Day 15 Avail To
     C                     ADD  WN0038    $DD7AB           Day 16 Avail To
     C                     ADD  WN0039    $DD8AB           Day 17 Avail To
     C                     ADD  WN0040    $DD9AB           Day 18 Avail To
     C                     ADD  WN0041    $DD1AL           Day 19 Avail To
     C                     ADD  WN0042    $DD2AL           Day 20 Avail To
     C                     ADD  WN0043    $DD3AL           Day 21 Avail To
     C                     END                             *FI
      * Cumulative Total
      * CASE: LCL.Status - Y or N is yes
     C           YL0011    IFEQ 'Y'                        *IF
     C                     Z-ADDWN0023    $DD1AQ           Day 1 ATS Qty U
     C           $DD1AQ    ADD  WN0024    $DD2AQ           Day 2 ATS Qty U
     C           $DD2AQ    ADD  WN0025    $DD3AQ           Day 3 ATS Qty U
     C           $DD3AQ    ADD  WN0026    $DD4AQ           Day 4 ATS Qty U
     C           $DD4AQ    ADD  WN0027    $DD5AQ           Day 5 ATS Qty U
     C           $DD5AQ    ADD  WN0028    $DD6AQ           Day 6 ATS Qty U
     C           $DD6AQ    ADD  WN0029    $DD7AQ           Day 7 ATS Qty U
     C           $DD7AQ    ADD  WN0030    $DD8AQ           Day 8 ATS Qty U
     C           $DD8AQ    ADD  WN0031    $DD9AQ           Day 9 ATS Qty U
     C           $DD9AQ    ADD  WN0032    $DD1AT           Day 10 ATS Qty
     C           $DD1AT    ADD  WN0033    $DD2AT           Day 11 ATS Qty
     C           $DD2AT    ADD  WN0034    $DD3AT           Day 12 ATS Qty
     C           $DD3AT    ADD  WN0035    $DD4AT           Day 13 ATS Qty
     C           $DD4AT    ADD  WN0036    $DD5AT           Day 14 ATS Qty
     C           $DD5AT    ADD  WN0037    $DD6AT           Day 15 ATS Qty
     C           $DD6AT    ADD  WN0038    $DD7AT           Day 16 ATS Qty
     C           $DD7AT    ADD  WN0039    $DD9AT           Day 17 ATS Qty
     C           $DD9AT    ADD  WN0040    $DD1AS           Day 18 ATS Qty
     C           $DD1AS    ADD  WN0041    $DD2AS           Day 19 ATS Qty
     C           $DD2AS    ADD  WN0042    $DD3AS           Day 20 ATS Qty
     C           $DD3AS    ADD  WN0043    $DD4AS           Day 21 ATS Qty
     C                     END                             *FI
     C                     MOVEL'N'       YL0011           Status - Y or N
     C                     READ @ADREOJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv PA In/Sh SD-6 WHS RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN I8AIC3    WQSK01           Company Number
     C           *LIKE     DEFN I8HGCD    WQSK02           Item Code
     C           *LIKE     DEFN I8AJCD    WQSK03           Warehouse Code
     C           *LIKE     DEFN I8ELDT    WQSK04           Production Date
     C           *LIKE     DEFN I8V5ST    WQSK05           Production Type
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Item Code
     C                     KFLD           WQSK03           Warehouse Code
     C                     KFLD           WQSK04           Production Date
     C                     KFLD           WQSK05           Production Type
      * Setup key
     C                     Z-ADDWL0001    WQSK01           Company Number
     C                     Z-ADDWL0004    WQSK02           Item Code
     C                     MOVELWL0005    WQSK03           Warehouse Code
     C                     Z-ADDWL0003    WQSK04           Production Date
     C                     MOVELWL0002    WQSK05           Production Type
      * Establish starting position
     C           KRSSK     SETLL@I8CPXP                    *
     C           KRSSK     READE@I8CPXP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0006           PS Weight Inv O
     C                     Z-ADD*ZERO     WL0007           PS Pieces Inv O
     C                     Z-ADD*ZERO     WL0008           PS Weight Inv A
     C                     Z-ADD*ZERO     WL0009           PS Pieces Inv A
     C                     Z-ADD*ZERO     WL0010           PS Weight Ship
     C                     Z-ADD*ZERO     WL0011           PS Pieces Ship
     C                     Z-ADD*ZERO     WL0012           PS Weight Prod
     C                     Z-ADD*ZERO     WL0013           PS Pieces Prod
     C                     Z-ADD*ZERO     WL0014           PS Weight Inv A
     C                     Z-ADD*ZERO     WL0015           PS Pieces Inv A
     C                     Z-ADD*ZERO     WL0016           PS Weight Order
     C                     Z-ADD*ZERO     WL0017           PS Weight Sched
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDI8WTIN    WL0006           PS Weight Inv O
     C                     Z-ADDI8D5NB    WL0007           PS Pieces Inv O
     C                     Z-ADDI8EZWG    WL0008           PS Weight Inv A
     C                     Z-ADDI8CCNB    WL0009           PS Pieces Inv A
     C                     Z-ADDI8E0WG    WL0010           PS Weight Ship
     C                     Z-ADDI8D6NB    WL0011           PS Pieces Ship
     C                     Z-ADDI8OAWT    WL0012           PS Weight Prod
     C                     Z-ADDI8CDNB    WL0013           PS Pieces Prod
     C                     Z-ADDI8UNW2    WL0014           PS Weight Inv A
     C                     Z-ADDI8CENB    WL0015           PS Pieces Inv A
     C                     Z-ADDI8DVWG    WL0016           PS Weight Order
     C                     Z-ADDI8SHWT    WL0017           PS Weight Sched
     C           KRSSK     READE@I8CPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Sch Shps Cur Dte  RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0022           Weight Schedule
     C                     Z-ADD*ZERO     WL0023           Quantity Schedu
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSL01           Company Number
     C           *LIKE     DEFN OMHGCD    WQSL02           Item Code
     C           *LIKE     DEFN OMAJCD    WQSL03           Warehouse Code
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Item Code
     C                     KFLD           WQSL03           Warehouse Code
     C                     KFLD           OMAODT           Scheduled Ship
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Item Code
     C                     KFLD           WQSL03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0018    WQSL01           Company Number
     C                     Z-ADDWL0019    WQSL02           Item Code
     C                     MOVELWL0020    WQSL03           Warehouse Code
     C                     Z-ADDWL0021    OMAODT           Scheduled Ship
      * Establish starting position
     C           KPSSL     SETLL@BGWKKG                    *
     C           KRSSL     READE@BGWKKG                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Hdr Sts,BillActTy RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0024           Company Number
     C                     Z-ADDOMC4NB    WL0025           Order Number
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0026    WUGWST    P      Header Status
     C                     MOVELWL0027    WUOBST    P      Billing Activit
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Header Status is Not Comp/Canc/Conf
      *   |- c2    : WRK.Billing Activity Type is Invoice or Transfer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUGWST    IFEQ 'L'                        *IF
     C           WUGWST    OREQ 'A'
     C           WUGWST    OREQ 'E'
     C           WUGWST    OREQ 'H'
     C           WUOBST    IFEQ '1'                        *IF
     C           WUOBST    OREQ '4'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  OMAUWG    WL0022           Weight Schedule
     C                     ADD  OMCCQT    WL0023           Quantity Schedu
     C                     END                             *FI
     C           KRSSL     READE@BGWKKG                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Hdr Sts,BillActTy RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0024    BEAIC3           Company Number
     C                     Z-ADDWL0025    BEC4NB           Order Number
      * Establish starting position
     C           KRSSM     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEGWST    WL0026           Header Status
     C                     MOVELBEOBST    WL0027           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv PA Dtl SD-21 WHS  RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0195  1        Status Flag 1
     C                     MOVEL*BLANK    WN0196  1        Status Flag 2
     C                     MOVEL*BLANK    WN0197  1        Status Flag 3
     C                     MOVEL*BLANK    WN0198  1        Status Flag 4
     C                     MOVEL*BLANK    WN0199  1        Status Flag 5
     C                     MOVEL*BLANK    WN0200  1        Status Flag 6
     C                     MOVEL*BLANK    WN0201  1        Status Flag 7
     C                     MOVEL*BLANK    WN0202  1        Status Flag 8
     C                     MOVEL*BLANK    WN0203  1        Status Flag 9
     C                     MOVEL*BLANK    WN0204  1        Status Flag 10
     C                     MOVEL*BLANK    WN0205  1        Status Flag 11
     C                     MOVEL*BLANK    WN0206  1        Status Flag 12
     C                     MOVEL*BLANK    WN0207  1        Status Flag 13
     C                     MOVEL*BLANK    WN0208  1        Status Flag 14
     C                     MOVEL*BLANK    WN0209  1        Status Flag 15
     C                     MOVEL*BLANK    WN0210  1        Status Flag 16
     C                     MOVEL*BLANK    WN0211  1        Status Flag 17
     C                     MOVEL*BLANK    WN0212  1        Status Flag 18
     C                     MOVEL*BLANK    WN0213  1        Status Flag 19
     C                     MOVEL*BLANK    WN0214  1        Status Flag 20
     C                     MOVEL*BLANK    WN0215  1        Status Flag 21
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * fp1054 4/28/09 include whse txfr in PROD calc
     C                     MOVEL'N'       WN0195           Status Flag 1
     C                     MOVEL'N'       WN0196           Status Flag 2
     C                     MOVEL'N'       WN0197           Status Flag 3
     C                     MOVEL'N'       WN0198           Status Flag 4
     C                     MOVEL'N'       WN0199           Status Flag 5
     C                     MOVEL'N'       WN0200           Status Flag 6
     C                     MOVEL'N'       WN0201           Status Flag 7
     C                     MOVEL'N'       WN0202           Status Flag 8
     C                     MOVEL'N'       WN0203           Status Flag 9
     C                     MOVEL'N'       WN0204           Status Flag 10
     C                     MOVEL'N'       WN0205           Status Flag 11
     C                     MOVEL'N'       WN0206           Status Flag 12
     C                     MOVEL'N'       WN0207           Status Flag 13
     C                     MOVEL'N'       WN0208           Status Flag 14
     C                     MOVEL'N'       WN0209           Status Flag 15
     C                     MOVEL'N'       WN0210           Status Flag 16
     C                     MOVEL'N'       WN0211           Status Flag 17
     C                     MOVEL'N'       WN0212           Status Flag 18
     C                     MOVEL'N'       WN0213           Status Flag 19
     C                     MOVEL'N'       WN0214           Status Flag 20
     C                     MOVEL'N'       WN0215           Status Flag 21
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WCHGCD    WQSN02           Item Code
     C           *LIKE     DEFN WCAJCD    WQSN03           Warehouse Code
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Item Code
     C                     KFLD           WQSN03           Warehouse Code
     C                     KFLD           WCGPDT           PS Available Sh
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Item Code
     C                     KFLD           WQSN03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0028    WQSN01           Company Number
     C                     Z-ADDWL0029    WQSN02           Item Code
     C                     MOVELWL0030    WQSN03           Warehouse Code
     C                     Z-ADDWL0031    WCGPDT           PS Available Sh
      * Establish starting position
     C           KPSSN     SETLL@I8CPDZ                    *
     C           KRSSN     READE@I8CPDZ                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Quit:  Available Ship Date > Day 21
      * CASE: DB1.PS Available Ship Date GT PAR.Avail Ship Date 21 USR
     C           WCGPDT    IFGT WL0052                     *IF
      *
     C                     MOVEL*BLANK    WN0216  1        Ord/Sch Sts USR
      *
      * Rtv PA Ship Only-21  IF
      * 02/21/11 PKD Do not need to Override Weight for Piece Count Items
     C                     MOVEL'S'       WN0216           Ord/Sch Sts USR
      * day 1
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 1 USR is Entered
      *   |- c2    : PAR.Status Flag 1  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0032    IFNE *ZERO                      *IF
     C           WN0195    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0032    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 1
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0166           Day 1 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 1 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0166           Day 1 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 1 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0166           Day 1 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 2
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 2 USR is Entered
      *   |- c2    : PAR.Status Flag 2  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0033    IFNE *ZERO                      *IF
     C           WN0196    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0033    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 2
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0167           Day 2 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 2 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0167           Day 2 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 2 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0167           Day 2 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 3
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 3 USR is Entered
      *   |- c2    : PAR.Status Flag 3  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0034    IFNE *ZERO                      *IF
     C           WN0197    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0034    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 3
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0168           Day 3 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 3 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0168           Day 3 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 3 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0168           Day 3 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 4
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 4 USR is Entered
      *   |- c2    : PAR.Status Flag 4  Y/N is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0035    IFNE *ZERO                      *IF
     C           WN0198    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0035    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 4
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0169           Day 4 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 4 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0169           Day 4 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 4 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0169           Day 4 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 5
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 5 USR is Entered
      *   |- c2    : PAR.Status Flag 5  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0036    IFNE *ZERO                      *IF
     C           WN0199    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0036    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 5
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0170           Day 5 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 5 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0170           Day 5 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 5 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0170           Day 5 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 6
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 6 USR is Entered
      *   |- c2    : PAR.Status Flag 6  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0037    IFNE *ZERO                      *IF
     C           WN0200    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0037    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 6
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0171           Day 6 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 6 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0171           Day 6 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 6 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0171           Day 6 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 7
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 7 USR is Entered
      *   |- c2    : PAR.Status Flag 7  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0038    IFNE *ZERO                      *IF
     C           WN0201    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0038    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 7
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0172           Day 7 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 7 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0172           Day 7 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 7 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0172           Day 7 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 8
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 8 USR is Entered
      *   |- c2    : PAR.Status Flag 8  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0039    IFNE *ZERO                      *IF
     C           WN0202    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0039    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 8
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0173           Day 8 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 8 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0173           Day 8 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 8 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0173           Day 8 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 9
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 9 USR is Entered
      *   |- c2    : PAR.Status Flag 9  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0040    IFNE *ZERO                      *IF
     C           WN0203    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0040    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 9
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0174           Day 9 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 9 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0174           Day 9 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 9 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0174           Day 9 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 10
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 10 USR is Entered
      *   |- c2    : PAR.Status Flag 10 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0041    IFNE *ZERO                      *IF
     C           WN0204    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0041    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 10
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0175           Day 10 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 10 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0175           Day 10 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 10 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0175           Day 10 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 11
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 11 USR is Entered
      *   |- c2    : PAR.Status Flag 11 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0042    IFNE *ZERO                      *IF
     C           WN0205    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0042    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 11
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0176           Day 11 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 11 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0176           Day 11 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 11 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0176           Day 11 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 12
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 12 USR is Entered
      *   |- c2    : PAR.Status Flag 12 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0043    IFNE *ZERO                      *IF
     C           WN0206    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0043    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 12
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0177           Day 12 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 12 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0177           Day 12 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 12 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0177           Day 12 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 13
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 13 USR is Entered
      *   |- c2    : PAR.Status Flag 13 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0044    IFNE *ZERO                      *IF
     C           WN0207    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0044    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 13
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0178           Day 13 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 13 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0178           Day 13 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 13 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0178           Day 13 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 14
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 14 USR is Entered
      *   |- c2    : PAR.Status Flag 14 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0045    IFNE *ZERO                      *IF
     C           WN0208    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0045    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 14
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0179           Day 14 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 14 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0179           Day 14 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 14 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0179           Day 14 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 15
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 15 USR is Entered
      *   |- c2    : PAR.Status Flag 15 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0046    IFNE *ZERO                      *IF
     C           WN0209    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0046    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 15
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0180           Day 15 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 15 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0180           Day 15 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 15 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0180           Day 15 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 16
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 16 USR is Entered
      *   |- c2    : PAR.Status Flag 16 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0047    IFNE *ZERO                      *IF
     C           WN0210    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0047    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 16
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0181           Day 16 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 16 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0181           Day 16 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 16 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0181           Day 16 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 17
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 17 USR is Entered
      *   |- c2    : PAR.Status Flag 17 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0048    IFNE *ZERO                      *IF
     C           WN0211    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0048    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 17
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0182           Day 17 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 17 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0182           Day 17 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 17 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0182           Day 17 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 18
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 18 USR is Entered
      *   |- c2    : PAR.Status Flag 18 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0049    IFNE *ZERO                      *IF
     C           WN0212    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0049    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 18
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0183           Day 18 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 18 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0183           Day 18 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 18 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0183           Day 18 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 19
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 19 USR is Entered
      *   |- c2    : PAR.Status Flag 19 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0050    IFNE *ZERO                      *IF
     C           WN0213    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0050    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 19
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0184           Day 19 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 19 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0184           Day 19 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 19 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0184           Day 19 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 20
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 20 USR is Entered
      *   |- c2    : PAR.Status Flag 20 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0051    IFNE *ZERO                      *IF
     C           WN0214    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0051    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 20
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0185           Day 20 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 20 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0185           Day 20 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 20 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0185           Day 20 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 21
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 21 USR is Entered
      *   |- c2    : PAR.Status Flag 21 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0052    IFNE *ZERO                      *IF
     C           WN0215    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0052    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0216    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 21
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0186           Day 21 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 21 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0186           Day 21 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 21 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0186           Day 21 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PS Available Ship Date GE JOB.*Job date
     C           WCGPDT    IFGE ##JDT                      *IF
      * Calculate Availability
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Calcualte PA w/Unit Weight
      * CASE: PAR.Avail Ship Date 1 USR EQ DB1.PS Available Ship Date
     C           WL0032    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0032    WQ0001  70       Avail Ship Date
     C           WL0053    PARM *ZERO     WQ0002  70       Production Date
     C                     PARM WL0074    WQ0003  61       Quantity Invent
     C           WL0080    PARM WL0080    WQ0004  61       Quantity Produc
     C           WL0101    PARM WL0101    WQ0005  61       Quantity Sales
     C           WL0122    PARM WL0122    WQ0006  61       Quantity Adjust
     C           WL0143    PARM WL0143    WQ0007  61       Quantity Availa
     C           WL0166    PARM WL0166    WQ0008  61       Quantity Sched
     C                     PARM WCAIC3    WQ0009  30       Company Number
     C                     PARM WCV5ST    WQ0010  1        Production Type
     C                     PARM WCELDT    WQ0011  70       Production Date
     C                     PARM WCHGCD    WQ0012  70       Item Code
     C                     PARM WCAJCD    WQ0013  3        Warehouse Code
     C                     PARM WCDXWG    WQ0014  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0015  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0016  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0017  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0018  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0019  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0020  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0021  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0022  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0023  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0024  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0025 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0026  92       PS Weight Order
     C                     PARM WCQTAS    WQ0027  92       PS Weight Sched
     C                     PARM WL0188    WQ0028  2        U/M - Primary
     C                     PARM WL0189    WQ0029 112       Unit Weight
     C                     PARM WL0190    WQ0030  52       Fresh Chilling
     C                     PARM WL0191    WQ0031  1        Piece Count Ite
     C                     PARM WL0192    WQ0032  70       Pieces Per Bag
     C                     PARM WL0193    WQ0033  70       Bags Per Unit
     C                     PARM WL0187    WQ0034  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0195           Status Flag 1
     C                     ELSE
      * CASE: PAR.Avail Ship Date 2 USR EQ DB1.PS Available Ship Date
     C           WL0033    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0033    WQ0035  70       Avail Ship Date
     C           WL0054    PARM *ZERO     WQ0036  70       Production Date
     C                     PARM WL0075    WQ0037  61       Quantity Invent
     C           WL0081    PARM WL0081    WQ0038  61       Quantity Produc
     C           WL0102    PARM WL0102    WQ0039  61       Quantity Sales
     C           WL0123    PARM WL0123    WQ0040  61       Quantity Adjust
     C           WL0144    PARM WL0144    WQ0041  61       Quantity Availa
     C           WL0167    PARM WL0167    WQ0042  61       Quantity Sched
     C                     PARM WCAIC3    WQ0043  30       Company Number
     C                     PARM WCV5ST    WQ0044  1        Production Type
     C                     PARM WCELDT    WQ0045  70       Production Date
     C                     PARM WCHGCD    WQ0046  70       Item Code
     C                     PARM WCAJCD    WQ0047  3        Warehouse Code
     C                     PARM WCDXWG    WQ0048  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0049  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0050  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0051  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0052  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0053  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0054  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0055  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0056  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0057  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0058  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0059 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0060  92       PS Weight Order
     C                     PARM WCQTAS    WQ0061  92       PS Weight Sched
     C                     PARM WL0188    WQ0062  2        U/M - Primary
     C                     PARM WL0189    WQ0063 112       Unit Weight
     C                     PARM WL0190    WQ0064  52       Fresh Chilling
     C                     PARM WL0191    WQ0065  1        Piece Count Ite
     C                     PARM WL0192    WQ0066  70       Pieces Per Bag
     C                     PARM WL0193    WQ0067  70       Bags Per Unit
     C                     PARM WL0187    WQ0068  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0196           Status Flag 2
     C                     ELSE
      * CASE: PAR.Avail Ship Date 3 USR EQ DB1.PS Available Ship Date
     C           WL0034    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0034    WQ0069  70       Avail Ship Date
     C           WL0055    PARM *ZERO     WQ0070  70       Production Date
     C                     PARM WL0076    WQ0071  61       Quantity Invent
     C           WL0082    PARM WL0082    WQ0072  61       Quantity Produc
     C           WL0103    PARM WL0103    WQ0073  61       Quantity Sales
     C           WL0124    PARM WL0124    WQ0074  61       Quantity Adjust
     C           WL0145    PARM WL0145    WQ0075  61       Quantity Availa
     C           WL0168    PARM WL0168    WQ0076  61       Quantity Sched
     C                     PARM WCAIC3    WQ0077  30       Company Number
     C                     PARM WCV5ST    WQ0078  1        Production Type
     C                     PARM WCELDT    WQ0079  70       Production Date
     C                     PARM WCHGCD    WQ0080  70       Item Code
     C                     PARM WCAJCD    WQ0081  3        Warehouse Code
     C                     PARM WCDXWG    WQ0082  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0083  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0084  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0085  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0086  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0087  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0088  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0089  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0090  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0091  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0092  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0093 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0094  92       PS Weight Order
     C                     PARM WCQTAS    WQ0095  92       PS Weight Sched
     C                     PARM WL0188    WQ0096  2        U/M - Primary
     C                     PARM WL0189    WQ0097 112       Unit Weight
     C                     PARM WL0190    WQ0098  52       Fresh Chilling
     C                     PARM WL0191    WQ0099  1        Piece Count Ite
     C                     PARM WL0192    WQ0100  70       Pieces Per Bag
     C                     PARM WL0193    WQ0101  70       Bags Per Unit
     C                     PARM WL0187    WQ0102  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0197           Status Flag 3
     C                     ELSE
      * CASE: PAR.Avail Ship Date 4 USR EQ DB1.PS Available Ship Date
     C           WL0035    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0035    WQ0103  70       Avail Ship Date
     C           WL0056    PARM *ZERO     WQ0104  70       Production Date
     C                     PARM WL0077    WQ0105  61       Quantity Invent
     C           WL0083    PARM WL0083    WQ0106  61       Quantity Produc
     C           WL0104    PARM WL0104    WQ0107  61       Quantity Sales
     C           WL0125    PARM WL0125    WQ0108  61       Quantity Adjust
     C           WL0146    PARM WL0146    WQ0109  61       Quantity Availa
     C           WL0169    PARM WL0169    WQ0110  61       Quantity Sched
     C                     PARM WCAIC3    WQ0111  30       Company Number
     C                     PARM WCV5ST    WQ0112  1        Production Type
     C                     PARM WCELDT    WQ0113  70       Production Date
     C                     PARM WCHGCD    WQ0114  70       Item Code
     C                     PARM WCAJCD    WQ0115  3        Warehouse Code
     C                     PARM WCDXWG    WQ0116  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0117  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0118  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0119  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0120  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0121  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0122  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0123  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0124  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0125  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0126  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0127 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0128  92       PS Weight Order
     C                     PARM WCQTAS    WQ0129  92       PS Weight Sched
     C                     PARM WL0188    WQ0130  2        U/M - Primary
     C                     PARM WL0189    WQ0131 112       Unit Weight
     C                     PARM WL0190    WQ0132  52       Fresh Chilling
     C                     PARM WL0191    WQ0133  1        Piece Count Ite
     C                     PARM WL0192    WQ0134  70       Pieces Per Bag
     C                     PARM WL0193    WQ0135  70       Bags Per Unit
     C                     PARM WL0187    WQ0136  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0198           Status Flag 4
     C                     ELSE
      * CASE: PAR.Avail Ship Date 5 USR EQ DB1.PS Available Ship Date
     C           WL0036    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0036    WQ0137  70       Avail Ship Date
     C           WL0057    PARM *ZERO     WQ0138  70       Production Date
     C                     PARM WL0078    WQ0139  61       Quantity Invent
     C           WL0084    PARM WL0084    WQ0140  61       Quantity Produc
     C           WL0105    PARM WL0105    WQ0141  61       Quantity Sales
     C           WL0126    PARM WL0126    WQ0142  61       Quantity Adjust
     C           WL0147    PARM WL0147    WQ0143  61       Quantity Availa
     C           WL0170    PARM WL0170    WQ0144  61       Quantity Sched
     C                     PARM WCAIC3    WQ0145  30       Company Number
     C                     PARM WCV5ST    WQ0146  1        Production Type
     C                     PARM WCELDT    WQ0147  70       Production Date
     C                     PARM WCHGCD    WQ0148  70       Item Code
     C                     PARM WCAJCD    WQ0149  3        Warehouse Code
     C                     PARM WCDXWG    WQ0150  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0151  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0152  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0153  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0154  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0155  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0156  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0157  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0158  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0159  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0160  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0161 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0162  92       PS Weight Order
     C                     PARM WCQTAS    WQ0163  92       PS Weight Sched
     C                     PARM WL0188    WQ0164  2        U/M - Primary
     C                     PARM WL0189    WQ0165 112       Unit Weight
     C                     PARM WL0190    WQ0166  52       Fresh Chilling
     C                     PARM WL0191    WQ0167  1        Piece Count Ite
     C                     PARM WL0192    WQ0168  70       Pieces Per Bag
     C                     PARM WL0193    WQ0169  70       Bags Per Unit
     C                     PARM WL0187    WQ0170  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0199           Status Flag 5
     C                     ELSE
      * CASE: PAR.Avail Ship Date 6 USR EQ DB1.PS Available Ship Date
     C           WL0037    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0037    WQ0171  70       Avail Ship Date
     C           WL0058    PARM *ZERO     WQ0172  70       Production Date
     C                     PARM WL0079    WQ0173  61       Quantity Invent
     C           WL0085    PARM WL0085    WQ0174  61       Quantity Produc
     C           WL0106    PARM WL0106    WQ0175  61       Quantity Sales
     C           WL0127    PARM WL0127    WQ0176  61       Quantity Adjust
     C           WL0148    PARM WL0148    WQ0177  61       Quantity Availa
     C           WL0171    PARM WL0171    WQ0178  61       Quantity Sched
     C                     PARM WCAIC3    WQ0179  30       Company Number
     C                     PARM WCV5ST    WQ0180  1        Production Type
     C                     PARM WCELDT    WQ0181  70       Production Date
     C                     PARM WCHGCD    WQ0182  70       Item Code
     C                     PARM WCAJCD    WQ0183  3        Warehouse Code
     C                     PARM WCDXWG    WQ0184  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0185  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0186  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0187  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0188  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0189  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0190  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0191  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0192  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0193  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0194  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0195 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0196  92       PS Weight Order
     C                     PARM WCQTAS    WQ0197  92       PS Weight Sched
     C                     PARM WL0188    WQ0198  2        U/M - Primary
     C                     PARM WL0189    WQ0199 112       Unit Weight
     C                     PARM WL0190    WQ0200  52       Fresh Chilling
     C                     PARM WL0191    WQ0201  1        Piece Count Ite
     C                     PARM WL0192    WQ0202  70       Pieces Per Bag
     C                     PARM WL0193    WQ0203  70       Bags Per Unit
     C                     PARM WL0187    WQ0204  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0200           Status Flag 6
     C                     ELSE
      * CASE: PAR.Avail Ship Date 7 USR EQ DB1.PS Available Ship Date
     C           WL0038    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0038    WQ0205  70       Avail Ship Date
     C           WL0059    PARM *ZERO     WQ0206  70       Production Date
     C                     PARM WUQINV    WQ0207  61       Quantity Invent
     C           WL0086    PARM WL0086    WQ0208  61       Quantity Produc
     C           WL0107    PARM WL0107    WQ0209  61       Quantity Sales
     C           WL0128    PARM WL0128    WQ0210  61       Quantity Adjust
     C           WL0149    PARM WL0149    WQ0211  61       Quantity Availa
     C           WL0172    PARM WL0172    WQ0212  61       Quantity Sched
     C                     PARM WCAIC3    WQ0213  30       Company Number
     C                     PARM WCV5ST    WQ0214  1        Production Type
     C                     PARM WCELDT    WQ0215  70       Production Date
     C                     PARM WCHGCD    WQ0216  70       Item Code
     C                     PARM WCAJCD    WQ0217  3        Warehouse Code
     C                     PARM WCDXWG    WQ0218  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0219  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0220  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0221  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0222  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0223  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0224  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0225  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0226  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0227  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0228  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0229 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0230  92       PS Weight Order
     C                     PARM WCQTAS    WQ0231  92       PS Weight Sched
     C                     PARM WL0188    WQ0232  2        U/M - Primary
     C                     PARM WL0189    WQ0233 112       Unit Weight
     C                     PARM WL0190    WQ0234  52       Fresh Chilling
     C                     PARM WL0191    WQ0235  1        Piece Count Ite
     C                     PARM WL0192    WQ0236  70       Pieces Per Bag
     C                     PARM WL0193    WQ0237  70       Bags Per Unit
     C                     PARM WL0187    WQ0238  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0201           Status Flag 7
     C                     ELSE
      * CASE: PAR.Avail Ship Date 8 USR EQ DB1.PS Available Ship Date
     C           WL0039    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0039    WQ0239  70       Avail Ship Date
     C           WL0060    PARM *ZERO     WQ0240  70       Production Date
     C                     PARM WUQINV    WQ0241  61       Quantity Invent
     C           WL0087    PARM WL0087    WQ0242  61       Quantity Produc
     C           WL0108    PARM WL0108    WQ0243  61       Quantity Sales
     C           WL0129    PARM WL0129    WQ0244  61       Quantity Adjust
     C           WL0150    PARM WL0150    WQ0245  61       Quantity Availa
     C           WL0173    PARM WL0173    WQ0246  61       Quantity Sched
     C                     PARM WCAIC3    WQ0247  30       Company Number
     C                     PARM WCV5ST    WQ0248  1        Production Type
     C                     PARM WCELDT    WQ0249  70       Production Date
     C                     PARM WCHGCD    WQ0250  70       Item Code
     C                     PARM WCAJCD    WQ0251  3        Warehouse Code
     C                     PARM WCDXWG    WQ0252  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0253  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0254  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0255  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0256  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0257  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0258  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0259  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0260  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0261  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0262  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0263 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0264  92       PS Weight Order
     C                     PARM WCQTAS    WQ0265  92       PS Weight Sched
     C                     PARM WL0188    WQ0266  2        U/M - Primary
     C                     PARM WL0189    WQ0267 112       Unit Weight
     C                     PARM WL0190    WQ0268  52       Fresh Chilling
     C                     PARM WL0191    WQ0269  1        Piece Count Ite
     C                     PARM WL0192    WQ0270  70       Pieces Per Bag
     C                     PARM WL0193    WQ0271  70       Bags Per Unit
     C                     PARM WL0187    WQ0272  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0202           Status Flag 8
     C                     ELSE
      * CASE: PAR.Avail Ship Date 9 USR EQ DB1.PS Available Ship Date
     C           WL0040    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0040    WQ0273  70       Avail Ship Date
     C           WL0061    PARM *ZERO     WQ0274  70       Production Date
     C                     PARM WUQINV    WQ0275  61       Quantity Invent
     C           WL0088    PARM WL0088    WQ0276  61       Quantity Produc
     C           WL0109    PARM WL0109    WQ0277  61       Quantity Sales
     C           WL0130    PARM WL0130    WQ0278  61       Quantity Adjust
     C           WL0151    PARM WL0151    WQ0279  61       Quantity Availa
     C           WL0174    PARM WL0174    WQ0280  61       Quantity Sched
     C                     PARM WCAIC3    WQ0281  30       Company Number
     C                     PARM WCV5ST    WQ0282  1        Production Type
     C                     PARM WCELDT    WQ0283  70       Production Date
     C                     PARM WCHGCD    WQ0284  70       Item Code
     C                     PARM WCAJCD    WQ0285  3        Warehouse Code
     C                     PARM WCDXWG    WQ0286  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0287  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0288  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0289  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0290  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0291  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0292  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0293  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0294  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0295  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0296  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0297 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0298  92       PS Weight Order
     C                     PARM WCQTAS    WQ0299  92       PS Weight Sched
     C                     PARM WL0188    WQ0300  2        U/M - Primary
     C                     PARM WL0189    WQ0301 112       Unit Weight
     C                     PARM WL0190    WQ0302  52       Fresh Chilling
     C                     PARM WL0191    WQ0303  1        Piece Count Ite
     C                     PARM WL0192    WQ0304  70       Pieces Per Bag
     C                     PARM WL0193    WQ0305  70       Bags Per Unit
     C                     PARM WL0187    WQ0306  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0203           Status Flag 9
     C                     ELSE
      * CASE: PAR.Avail Ship Date 10 USR EQ DB1.PS Available Ship Date
     C           WL0041    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0041    WQ0307  70       Avail Ship Date
     C           WL0062    PARM *ZERO     WQ0308  70       Production Date
     C                     PARM WUQINV    WQ0309  61       Quantity Invent
     C           WL0089    PARM WL0089    WQ0310  61       Quantity Produc
     C           WL0110    PARM WL0110    WQ0311  61       Quantity Sales
     C           WL0131    PARM WL0131    WQ0312  61       Quantity Adjust
     C           WL0152    PARM WL0152    WQ0313  61       Quantity Availa
     C           WL0175    PARM WL0175    WQ0314  61       Quantity Sched
     C                     PARM WCAIC3    WQ0315  30       Company Number
     C                     PARM WCV5ST    WQ0316  1        Production Type
     C                     PARM WCELDT    WQ0317  70       Production Date
     C                     PARM WCHGCD    WQ0318  70       Item Code
     C                     PARM WCAJCD    WQ0319  3        Warehouse Code
     C                     PARM WCDXWG    WQ0320  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0321  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0322  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0323  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0324  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0325  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0326  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0327  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0328  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0329  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0330  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0331 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0332  92       PS Weight Order
     C                     PARM WCQTAS    WQ0333  92       PS Weight Sched
     C                     PARM WL0188    WQ0334  2        U/M - Primary
     C                     PARM WL0189    WQ0335 112       Unit Weight
     C                     PARM WL0190    WQ0336  52       Fresh Chilling
     C                     PARM WL0191    WQ0337  1        Piece Count Ite
     C                     PARM WL0192    WQ0338  70       Pieces Per Bag
     C                     PARM WL0193    WQ0339  70       Bags Per Unit
     C                     PARM WL0187    WQ0340  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0204           Status Flag 10
     C                     ELSE
      * CASE: PAR.Avail Ship Date 11 USR EQ DB1.PS Available Ship Date
     C           WL0042    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0042    WQ0341  70       Avail Ship Date
     C           WL0063    PARM *ZERO     WQ0342  70       Production Date
     C                     PARM WUQINV    WQ0343  61       Quantity Invent
     C           WL0090    PARM WL0090    WQ0344  61       Quantity Produc
     C           WL0111    PARM WL0111    WQ0345  61       Quantity Sales
     C           WL0132    PARM WL0132    WQ0346  61       Quantity Adjust
     C           WL0153    PARM WL0153    WQ0347  61       Quantity Availa
     C           WL0176    PARM WL0176    WQ0348  61       Quantity Sched
     C                     PARM WCAIC3    WQ0349  30       Company Number
     C                     PARM WCV5ST    WQ0350  1        Production Type
     C                     PARM WCELDT    WQ0351  70       Production Date
     C                     PARM WCHGCD    WQ0352  70       Item Code
     C                     PARM WCAJCD    WQ0353  3        Warehouse Code
     C                     PARM WCDXWG    WQ0354  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0355  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0356  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0357  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0358  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0359  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0360  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0361  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0362  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0363  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0364  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0365 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0366  92       PS Weight Order
     C                     PARM WCQTAS    WQ0367  92       PS Weight Sched
     C                     PARM WL0188    WQ0368  2        U/M - Primary
     C                     PARM WL0189    WQ0369 112       Unit Weight
     C                     PARM WL0190    WQ0370  52       Fresh Chilling
     C                     PARM WL0191    WQ0371  1        Piece Count Ite
     C                     PARM WL0192    WQ0372  70       Pieces Per Bag
     C                     PARM WL0193    WQ0373  70       Bags Per Unit
     C                     PARM WL0187    WQ0374  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0205           Status Flag 11
     C                     ELSE
      * CASE: PAR.Avail Ship Date 12 USR EQ DB1.PS Available Ship Date
     C           WL0043    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0043    WQ0375  70       Avail Ship Date
     C           WL0064    PARM *ZERO     WQ0376  70       Production Date
     C                     PARM WUQINV    WQ0377  61       Quantity Invent
     C           WL0091    PARM WL0091    WQ0378  61       Quantity Produc
     C           WL0112    PARM WL0112    WQ0379  61       Quantity Sales
     C           WL0133    PARM WL0133    WQ0380  61       Quantity Adjust
     C           WL0154    PARM WL0154    WQ0381  61       Quantity Availa
     C           WL0177    PARM WL0177    WQ0382  61       Quantity Sched
     C                     PARM WCAIC3    WQ0383  30       Company Number
     C                     PARM WCV5ST    WQ0384  1        Production Type
     C                     PARM WCELDT    WQ0385  70       Production Date
     C                     PARM WCHGCD    WQ0386  70       Item Code
     C                     PARM WCAJCD    WQ0387  3        Warehouse Code
     C                     PARM WCDXWG    WQ0388  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0389  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0390  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0391  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0392  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0393  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0394  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0395  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0396  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0397  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0398  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0399 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0400  92       PS Weight Order
     C                     PARM WCQTAS    WQ0401  92       PS Weight Sched
     C                     PARM WL0188    WQ0402  2        U/M - Primary
     C                     PARM WL0189    WQ0403 112       Unit Weight
     C                     PARM WL0190    WQ0404  52       Fresh Chilling
     C                     PARM WL0191    WQ0405  1        Piece Count Ite
     C                     PARM WL0192    WQ0406  70       Pieces Per Bag
     C                     PARM WL0193    WQ0407  70       Bags Per Unit
     C                     PARM WL0187    WQ0408  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0206           Status Flag 12
     C                     ELSE
      * CASE: PAR.Avail Ship Date 13 USR EQ DB1.PS Available Ship Date
     C           WL0044    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0044    WQ0409  70       Avail Ship Date
     C           WL0065    PARM *ZERO     WQ0410  70       Production Date
     C                     PARM WUQINV    WQ0411  61       Quantity Invent
     C           WL0092    PARM WL0092    WQ0412  61       Quantity Produc
     C           WL0113    PARM WL0113    WQ0413  61       Quantity Sales
     C           WL0134    PARM WL0134    WQ0414  61       Quantity Adjust
     C           WL0155    PARM WL0155    WQ0415  61       Quantity Availa
     C           WL0178    PARM WL0178    WQ0416  61       Quantity Sched
     C                     PARM WCAIC3    WQ0417  30       Company Number
     C                     PARM WCV5ST    WQ0418  1        Production Type
     C                     PARM WCELDT    WQ0419  70       Production Date
     C                     PARM WCHGCD    WQ0420  70       Item Code
     C                     PARM WCAJCD    WQ0421  3        Warehouse Code
     C                     PARM WCDXWG    WQ0422  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0423  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0424  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0425  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0426  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0427  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0428  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0429  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0430  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0431  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0432  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0433 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0434  92       PS Weight Order
     C                     PARM WCQTAS    WQ0435  92       PS Weight Sched
     C                     PARM WL0188    WQ0436  2        U/M - Primary
     C                     PARM WL0189    WQ0437 112       Unit Weight
     C                     PARM WL0190    WQ0438  52       Fresh Chilling
     C                     PARM WL0191    WQ0439  1        Piece Count Ite
     C                     PARM WL0192    WQ0440  70       Pieces Per Bag
     C                     PARM WL0193    WQ0441  70       Bags Per Unit
     C                     PARM WL0187    WQ0442  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0207           Status Flag 13
     C                     ELSE
      * CASE: PAR.Avail Ship Date 14 USR EQ DB1.PS Available Ship Date
     C           WL0045    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0045    WQ0443  70       Avail Ship Date
     C           WL0066    PARM *ZERO     WQ0444  70       Production Date
     C                     PARM WUQINV    WQ0445  61       Quantity Invent
     C           WL0093    PARM WL0093    WQ0446  61       Quantity Produc
     C           WL0114    PARM WL0114    WQ0447  61       Quantity Sales
     C           WL0135    PARM WL0135    WQ0448  61       Quantity Adjust
     C           WL0156    PARM WL0156    WQ0449  61       Quantity Availa
     C           WL0179    PARM WL0179    WQ0450  61       Quantity Sched
     C                     PARM WCAIC3    WQ0451  30       Company Number
     C                     PARM WCV5ST    WQ0452  1        Production Type
     C                     PARM WCELDT    WQ0453  70       Production Date
     C                     PARM WCHGCD    WQ0454  70       Item Code
     C                     PARM WCAJCD    WQ0455  3        Warehouse Code
     C                     PARM WCDXWG    WQ0456  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0457  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0458  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0459  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0460  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0461  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0462  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0463  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0464  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0465  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0466  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0467 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0468  92       PS Weight Order
     C                     PARM WCQTAS    WQ0469  92       PS Weight Sched
     C                     PARM WL0188    WQ0470  2        U/M - Primary
     C                     PARM WL0189    WQ0471 112       Unit Weight
     C                     PARM WL0190    WQ0472  52       Fresh Chilling
     C                     PARM WL0191    WQ0473  1        Piece Count Ite
     C                     PARM WL0192    WQ0474  70       Pieces Per Bag
     C                     PARM WL0193    WQ0475  70       Bags Per Unit
     C                     PARM WL0187    WQ0476  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0208           Status Flag 14
     C                     ELSE
      * CASE: PAR.Avail Ship Date 15 USR EQ DB1.PS Available Ship Date
     C           WL0046    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0046    WQ0477  70       Avail Ship Date
     C           WL0067    PARM *ZERO     WQ0478  70       Production Date
     C                     PARM WUQINV    WQ0479  61       Quantity Invent
     C           WL0094    PARM WL0094    WQ0480  61       Quantity Produc
     C           WL0115    PARM WL0115    WQ0481  61       Quantity Sales
     C           WL0136    PARM WL0136    WQ0482  61       Quantity Adjust
     C           WL0157    PARM WL0157    WQ0483  61       Quantity Availa
     C           WL0180    PARM WL0180    WQ0484  61       Quantity Sched
     C                     PARM WCAIC3    WQ0485  30       Company Number
     C                     PARM WCV5ST    WQ0486  1        Production Type
     C                     PARM WCELDT    WQ0487  70       Production Date
     C                     PARM WCHGCD    WQ0488  70       Item Code
     C                     PARM WCAJCD    WQ0489  3        Warehouse Code
     C                     PARM WCDXWG    WQ0490  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0491  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0492  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0493  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0494  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0495  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0496  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0497  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0498  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0499  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0500  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0501 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0502  92       PS Weight Order
     C                     PARM WCQTAS    WQ0503  92       PS Weight Sched
     C                     PARM WL0188    WQ0504  2        U/M - Primary
     C                     PARM WL0189    WQ0505 112       Unit Weight
     C                     PARM WL0190    WQ0506  52       Fresh Chilling
     C                     PARM WL0191    WQ0507  1        Piece Count Ite
     C                     PARM WL0192    WQ0508  70       Pieces Per Bag
     C                     PARM WL0193    WQ0509  70       Bags Per Unit
     C                     PARM WL0187    WQ0510  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0209           Status Flag 15
     C                     ELSE
      * CASE: PAR.Avail Ship Date 16 USR EQ DB1.PS Available Ship Date
     C           WL0047    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0047    WQ0511  70       Avail Ship Date
     C           WL0068    PARM *ZERO     WQ0512  70       Production Date
     C                     PARM WUQINV    WQ0513  61       Quantity Invent
     C           WL0095    PARM WL0095    WQ0514  61       Quantity Produc
     C           WL0116    PARM WL0116    WQ0515  61       Quantity Sales
     C           WL0137    PARM WL0137    WQ0516  61       Quantity Adjust
     C           WL0158    PARM WL0158    WQ0517  61       Quantity Availa
     C           WL0181    PARM WL0181    WQ0518  61       Quantity Sched
     C                     PARM WCAIC3    WQ0519  30       Company Number
     C                     PARM WCV5ST    WQ0520  1        Production Type
     C                     PARM WCELDT    WQ0521  70       Production Date
     C                     PARM WCHGCD    WQ0522  70       Item Code
     C                     PARM WCAJCD    WQ0523  3        Warehouse Code
     C                     PARM WCDXWG    WQ0524  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0525  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0526  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0527  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0528  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0529  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0530  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0531  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0532  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0533  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0534  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0535 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0536  92       PS Weight Order
     C                     PARM WCQTAS    WQ0537  92       PS Weight Sched
     C                     PARM WL0188    WQ0538  2        U/M - Primary
     C                     PARM WL0189    WQ0539 112       Unit Weight
     C                     PARM WL0190    WQ0540  52       Fresh Chilling
     C                     PARM WL0191    WQ0541  1        Piece Count Ite
     C                     PARM WL0192    WQ0542  70       Pieces Per Bag
     C                     PARM WL0193    WQ0543  70       Bags Per Unit
     C                     PARM WL0187    WQ0544  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0210           Status Flag 16
     C                     ELSE
      * CASE: PAR.Avail Ship Date 17 USR EQ DB1.PS Available Ship Date
     C           WL0048    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0048    WQ0545  70       Avail Ship Date
     C           WL0069    PARM *ZERO     WQ0546  70       Production Date
     C                     PARM WUQINV    WQ0547  61       Quantity Invent
     C           WL0096    PARM WL0096    WQ0548  61       Quantity Produc
     C           WL0117    PARM WL0117    WQ0549  61       Quantity Sales
     C           WL0138    PARM WL0138    WQ0550  61       Quantity Adjust
     C           WL0159    PARM WL0159    WQ0551  61       Quantity Availa
     C           WL0182    PARM WL0182    WQ0552  61       Quantity Sched
     C                     PARM WCAIC3    WQ0553  30       Company Number
     C                     PARM WCV5ST    WQ0554  1        Production Type
     C                     PARM WCELDT    WQ0555  70       Production Date
     C                     PARM WCHGCD    WQ0556  70       Item Code
     C                     PARM WCAJCD    WQ0557  3        Warehouse Code
     C                     PARM WCDXWG    WQ0558  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0559  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0560  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0561  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0562  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0563  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0564  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0565  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0566  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0567  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0568  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0569 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0570  92       PS Weight Order
     C                     PARM WCQTAS    WQ0571  92       PS Weight Sched
     C                     PARM WL0188    WQ0572  2        U/M - Primary
     C                     PARM WL0189    WQ0573 112       Unit Weight
     C                     PARM WL0190    WQ0574  52       Fresh Chilling
     C                     PARM WL0191    WQ0575  1        Piece Count Ite
     C                     PARM WL0192    WQ0576  70       Pieces Per Bag
     C                     PARM WL0193    WQ0577  70       Bags Per Unit
     C                     PARM WL0187    WQ0578  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0211           Status Flag 17
     C                     ELSE
      * CASE: PAR.Avail Ship Date 18 USR EQ DB1.PS Available Ship Date
     C           WL0049    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0049    WQ0579  70       Avail Ship Date
     C           WL0070    PARM *ZERO     WQ0580  70       Production Date
     C                     PARM WUQINV    WQ0581  61       Quantity Invent
     C           WL0097    PARM WL0097    WQ0582  61       Quantity Produc
     C           WL0118    PARM WL0118    WQ0583  61       Quantity Sales
     C           WL0139    PARM WL0139    WQ0584  61       Quantity Adjust
     C           WL0160    PARM WL0160    WQ0585  61       Quantity Availa
     C           WL0183    PARM WL0183    WQ0586  61       Quantity Sched
     C                     PARM WCAIC3    WQ0587  30       Company Number
     C                     PARM WCV5ST    WQ0588  1        Production Type
     C                     PARM WCELDT    WQ0589  70       Production Date
     C                     PARM WCHGCD    WQ0590  70       Item Code
     C                     PARM WCAJCD    WQ0591  3        Warehouse Code
     C                     PARM WCDXWG    WQ0592  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0593  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0594  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0595  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0596  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0597  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0598  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0599  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0600  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0601  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0602  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0603 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0604  92       PS Weight Order
     C                     PARM WCQTAS    WQ0605  92       PS Weight Sched
     C                     PARM WL0188    WQ0606  2        U/M - Primary
     C                     PARM WL0189    WQ0607 112       Unit Weight
     C                     PARM WL0190    WQ0608  52       Fresh Chilling
     C                     PARM WL0191    WQ0609  1        Piece Count Ite
     C                     PARM WL0192    WQ0610  70       Pieces Per Bag
     C                     PARM WL0193    WQ0611  70       Bags Per Unit
     C                     PARM WL0187    WQ0612  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0212           Status Flag 18
     C                     ELSE
      * CASE: PAR.Avail Ship Date 19 USR EQ DB1.PS Available Ship Date
     C           WL0050    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0050    WQ0613  70       Avail Ship Date
     C           WL0071    PARM *ZERO     WQ0614  70       Production Date
     C                     PARM WUQINV    WQ0615  61       Quantity Invent
     C           WL0098    PARM WL0098    WQ0616  61       Quantity Produc
     C           WL0119    PARM WL0119    WQ0617  61       Quantity Sales
     C           WL0140    PARM WL0140    WQ0618  61       Quantity Adjust
     C           WL0161    PARM WL0161    WQ0619  61       Quantity Availa
     C           WL0184    PARM WL0184    WQ0620  61       Quantity Sched
     C                     PARM WCAIC3    WQ0621  30       Company Number
     C                     PARM WCV5ST    WQ0622  1        Production Type
     C                     PARM WCELDT    WQ0623  70       Production Date
     C                     PARM WCHGCD    WQ0624  70       Item Code
     C                     PARM WCAJCD    WQ0625  3        Warehouse Code
     C                     PARM WCDXWG    WQ0626  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0627  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0628  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0629  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0630  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0631  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0632  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0633  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0634  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0635  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0636  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0637 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0638  92       PS Weight Order
     C                     PARM WCQTAS    WQ0639  92       PS Weight Sched
     C                     PARM WL0188    WQ0640  2        U/M - Primary
     C                     PARM WL0189    WQ0641 112       Unit Weight
     C                     PARM WL0190    WQ0642  52       Fresh Chilling
     C                     PARM WL0191    WQ0643  1        Piece Count Ite
     C                     PARM WL0192    WQ0644  70       Pieces Per Bag
     C                     PARM WL0193    WQ0645  70       Bags Per Unit
     C                     PARM WL0187    WQ0646  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0213           Status Flag 19
     C                     ELSE
      * CASE: PAR.Avail Ship Date 20 USR EQ DB1.PS Available Ship Date
     C           WL0051    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0051    WQ0647  70       Avail Ship Date
     C           WL0072    PARM *ZERO     WQ0648  70       Production Date
     C                     PARM WUQINV    WQ0649  61       Quantity Invent
     C           WL0099    PARM WL0099    WQ0650  61       Quantity Produc
     C           WL0120    PARM WL0120    WQ0651  61       Quantity Sales
     C           WL0141    PARM WL0141    WQ0652  61       Quantity Adjust
     C           WL0162    PARM WL0162    WQ0653  61       Quantity Availa
     C           WL0185    PARM WL0185    WQ0654  61       Quantity Sched
     C                     PARM WCAIC3    WQ0655  30       Company Number
     C                     PARM WCV5ST    WQ0656  1        Production Type
     C                     PARM WCELDT    WQ0657  70       Production Date
     C                     PARM WCHGCD    WQ0658  70       Item Code
     C                     PARM WCAJCD    WQ0659  3        Warehouse Code
     C                     PARM WCDXWG    WQ0660  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0661  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0662  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0663  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0664  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0665  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0666  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0667  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0668  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0669  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0670  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0671 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0672  92       PS Weight Order
     C                     PARM WCQTAS    WQ0673  92       PS Weight Sched
     C                     PARM WL0188    WQ0674  2        U/M - Primary
     C                     PARM WL0189    WQ0675 112       Unit Weight
     C                     PARM WL0190    WQ0676  52       Fresh Chilling
     C                     PARM WL0191    WQ0677  1        Piece Count Ite
     C                     PARM WL0192    WQ0678  70       Pieces Per Bag
     C                     PARM WL0193    WQ0679  70       Bags Per Unit
     C                     PARM WL0187    WQ0680  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0214           Status Flag 20
     C                     ELSE
      * CASE: PAR.Avail Ship Date 21 USR EQ DB1.PS Available Ship Date
     C           WL0052    IFEQ WCGPDT                     *IF
      * Clc PA w/Unit Weight  XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYEXFR'              90  Clc PA w/Unit W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0052    WQ0681  70       Avail Ship Date
     C           WL0073    PARM *ZERO     WQ0682  70       Production Date
     C                     PARM WUQINV    WQ0683  61       Quantity Invent
     C           WL0100    PARM WL0100    WQ0684  61       Quantity Produc
     C           WL0121    PARM WL0121    WQ0685  61       Quantity Sales
     C           WL0142    PARM WL0142    WQ0686  61       Quantity Adjust
     C           WL0163    PARM WL0163    WQ0687  61       Quantity Availa
     C           WL0186    PARM WL0186    WQ0688  61       Quantity Sched
     C                     PARM WCAIC3    WQ0689  30       Company Number
     C                     PARM WCV5ST    WQ0690  1        Production Type
     C                     PARM WCELDT    WQ0691  70       Production Date
     C                     PARM WCHGCD    WQ0692  70       Item Code
     C                     PARM WCAJCD    WQ0693  3        Warehouse Code
     C                     PARM WCDXWG    WQ0694  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0695  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0696  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0697  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0698  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0699  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0700  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0701  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0702  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0703  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0704  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0705 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0706  92       PS Weight Order
     C                     PARM WCQTAS    WQ0707  92       PS Weight Sched
     C                     PARM WL0188    WQ0708  2        U/M - Primary
     C                     PARM WL0189    WQ0709 112       Unit Weight
     C                     PARM WL0190    WQ0710  52       Fresh Chilling
     C                     PARM WL0191    WQ0711  1        Piece Count Ite
     C                     PARM WL0192    WQ0712  70       Pieces Per Bag
     C                     PARM WL0193    WQ0713  70       Bags Per Unit
     C                     PARM WL0187    WQ0714  1        Avail Dsp/Prt T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0215           Status Flag 21
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Calculate PA w/ Load Size
      * CASE: PAR.Avail Ship Date 1 USR EQ DB1.PS Available Ship Date
     C           WL0032    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0032    WQ0715  70       Avail Ship Date
     C           WL0053    PARM *ZERO     WQ0716  70       Production Date
     C                     PARM WL0074    WQ0717  61       Quantity Invent
     C           WL0080    PARM WL0080    WQ0718  61       Quantity Produc
     C           WL0101    PARM WL0101    WQ0719  61       Quantity Sales
     C           WL0122    PARM WL0122    WQ0720  61       Quantity Adjust
     C           WL0143    PARM WL0143    WQ0721  61       Quantity Availa
     C           WL0166    PARM WL0166    WQ0722  61       Quantity Sched
     C                     PARM WCAIC3    WQ0723  30       Company Number
     C                     PARM WCV5ST    WQ0724  1        Production Type
     C                     PARM WCELDT    WQ0725  70       Production Date
     C                     PARM WCHGCD    WQ0726  70       Item Code
     C                     PARM WCAJCD    WQ0727  3        Warehouse Code
     C                     PARM WCDXWG    WQ0728  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0729  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0730  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0731  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0732  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0733  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0734  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0735  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0736  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0737  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0738  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0739 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0740  92       PS Weight Order
     C                     PARM WCD7NB    WQ0741  70       PS Pieces Order
     C                     PARM WCQTAS    WQ0742  92       PS Weight Sched
     C                     PARM WCEFNB    WQ0743  70       PS Pieces Sched
     C                     PARM WL0165    WQ0744  70       Load Size USR
     C                     PARM WL0187    WQ0745  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ0746  52       Fresh Chilling
     C                     PARM WL0189    WQ0747 112       Unit Weight
     C                     PARM WL0191    WQ0748  1        Piece Count Ite
     C                     PARM WL0192    WQ0749  70       Pieces Per Bag
     C                     PARM WL0193    WQ0750  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0195           Status Flag 1
     C                     ELSE
      * CASE: PAR.Avail Ship Date 2 USR EQ DB1.PS Available Ship Date
     C           WL0033    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0033    WQ0751  70       Avail Ship Date
     C           WL0054    PARM *ZERO     WQ0752  70       Production Date
     C                     PARM WL0075    WQ0753  61       Quantity Invent
     C           WL0081    PARM WL0081    WQ0754  61       Quantity Produc
     C           WL0102    PARM WL0102    WQ0755  61       Quantity Sales
     C           WL0123    PARM WL0123    WQ0756  61       Quantity Adjust
     C           WL0144    PARM WL0144    WQ0757  61       Quantity Availa
     C           WL0167    PARM WL0167    WQ0758  61       Quantity Sched
     C                     PARM WCAIC3    WQ0759  30       Company Number
     C                     PARM WCV5ST    WQ0760  1        Production Type
     C                     PARM WCELDT    WQ0761  70       Production Date
     C                     PARM WCHGCD    WQ0762  70       Item Code
     C                     PARM WCAJCD    WQ0763  3        Warehouse Code
     C                     PARM WCDXWG    WQ0764  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0765  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0766  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0767  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0768  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0769  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0770  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0771  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0772  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0773  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0774  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0775 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0776  92       PS Weight Order
     C                     PARM WCD7NB    WQ0777  70       PS Pieces Order
     C                     PARM WCQTAS    WQ0778  92       PS Weight Sched
     C                     PARM WCEFNB    WQ0779  70       PS Pieces Sched
     C                     PARM WL0165    WQ0780  70       Load Size USR
     C                     PARM WL0187    WQ0781  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ0782  52       Fresh Chilling
     C                     PARM WL0189    WQ0783 112       Unit Weight
     C                     PARM WL0191    WQ0784  1        Piece Count Ite
     C                     PARM WL0192    WQ0785  70       Pieces Per Bag
     C                     PARM WL0193    WQ0786  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0196           Status Flag 2
     C                     ELSE
      * CASE: PAR.Avail Ship Date 3 USR EQ DB1.PS Available Ship Date
     C           WL0034    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0034    WQ0787  70       Avail Ship Date
     C           WL0055    PARM *ZERO     WQ0788  70       Production Date
     C                     PARM WL0076    WQ0789  61       Quantity Invent
     C           WL0082    PARM WL0082    WQ0790  61       Quantity Produc
     C           WL0103    PARM WL0103    WQ0791  61       Quantity Sales
     C           WL0124    PARM WL0124    WQ0792  61       Quantity Adjust
     C           WL0145    PARM WL0145    WQ0793  61       Quantity Availa
     C           WL0168    PARM WL0168    WQ0794  61       Quantity Sched
     C                     PARM WCAIC3    WQ0795  30       Company Number
     C                     PARM WCV5ST    WQ0796  1        Production Type
     C                     PARM WCELDT    WQ0797  70       Production Date
     C                     PARM WCHGCD    WQ0798  70       Item Code
     C                     PARM WCAJCD    WQ0799  3        Warehouse Code
     C                     PARM WCDXWG    WQ0800  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0801  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0802  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0803  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0804  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0805  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0806  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0807  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0808  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0809  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0810  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0811 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0812  92       PS Weight Order
     C                     PARM WCD7NB    WQ0813  70       PS Pieces Order
     C                     PARM WCQTAS    WQ0814  92       PS Weight Sched
     C                     PARM WCEFNB    WQ0815  70       PS Pieces Sched
     C                     PARM WL0165    WQ0816  70       Load Size USR
     C                     PARM WL0187    WQ0817  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ0818  52       Fresh Chilling
     C                     PARM WL0189    WQ0819 112       Unit Weight
     C                     PARM WL0191    WQ0820  1        Piece Count Ite
     C                     PARM WL0192    WQ0821  70       Pieces Per Bag
     C                     PARM WL0193    WQ0822  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0197           Status Flag 3
     C                     ELSE
      * CASE: PAR.Avail Ship Date 4 USR EQ DB1.PS Available Ship Date
     C           WL0035    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0035    WQ0823  70       Avail Ship Date
     C           WL0056    PARM *ZERO     WQ0824  70       Production Date
     C                     PARM WL0077    WQ0825  61       Quantity Invent
     C           WL0083    PARM WL0083    WQ0826  61       Quantity Produc
     C           WL0104    PARM WL0104    WQ0827  61       Quantity Sales
     C           WL0125    PARM WL0125    WQ0828  61       Quantity Adjust
     C           WL0146    PARM WL0146    WQ0829  61       Quantity Availa
     C           WL0169    PARM WL0169    WQ0830  61       Quantity Sched
     C                     PARM WCAIC3    WQ0831  30       Company Number
     C                     PARM WCV5ST    WQ0832  1        Production Type
     C                     PARM WCELDT    WQ0833  70       Production Date
     C                     PARM WCHGCD    WQ0834  70       Item Code
     C                     PARM WCAJCD    WQ0835  3        Warehouse Code
     C                     PARM WCDXWG    WQ0836  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0837  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0838  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0839  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0840  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0841  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0842  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0843  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0844  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0845  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0846  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0847 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0848  92       PS Weight Order
     C                     PARM WCD7NB    WQ0849  70       PS Pieces Order
     C                     PARM WCQTAS    WQ0850  92       PS Weight Sched
     C                     PARM WCEFNB    WQ0851  70       PS Pieces Sched
     C                     PARM WL0165    WQ0852  70       Load Size USR
     C                     PARM WL0187    WQ0853  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ0854  52       Fresh Chilling
     C                     PARM WL0189    WQ0855 112       Unit Weight
     C                     PARM WL0191    WQ0856  1        Piece Count Ite
     C                     PARM WL0192    WQ0857  70       Pieces Per Bag
     C                     PARM WL0193    WQ0858  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0198           Status Flag 4
     C                     ELSE
      * CASE: PAR.Avail Ship Date 5 USR EQ DB1.PS Available Ship Date
     C           WL0036    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0036    WQ0859  70       Avail Ship Date
     C           WL0057    PARM *ZERO     WQ0860  70       Production Date
     C                     PARM WL0078    WQ0861  61       Quantity Invent
     C           WL0084    PARM WL0084    WQ0862  61       Quantity Produc
     C           WL0105    PARM WL0105    WQ0863  61       Quantity Sales
     C           WL0126    PARM WL0126    WQ0864  61       Quantity Adjust
     C           WL0147    PARM WL0147    WQ0865  61       Quantity Availa
     C           WL0170    PARM WL0170    WQ0866  61       Quantity Sched
     C                     PARM WCAIC3    WQ0867  30       Company Number
     C                     PARM WCV5ST    WQ0868  1        Production Type
     C                     PARM WCELDT    WQ0869  70       Production Date
     C                     PARM WCHGCD    WQ0870  70       Item Code
     C                     PARM WCAJCD    WQ0871  3        Warehouse Code
     C                     PARM WCDXWG    WQ0872  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0873  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0874  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0875  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0876  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0877  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0878  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0879  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0880  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0881  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0882  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0883 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0884  92       PS Weight Order
     C                     PARM WCD7NB    WQ0885  70       PS Pieces Order
     C                     PARM WCQTAS    WQ0886  92       PS Weight Sched
     C                     PARM WCEFNB    WQ0887  70       PS Pieces Sched
     C                     PARM WL0165    WQ0888  70       Load Size USR
     C                     PARM WL0187    WQ0889  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ0890  52       Fresh Chilling
     C                     PARM WL0189    WQ0891 112       Unit Weight
     C                     PARM WL0191    WQ0892  1        Piece Count Ite
     C                     PARM WL0192    WQ0893  70       Pieces Per Bag
     C                     PARM WL0193    WQ0894  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0199           Status Flag 5
     C                     ELSE
      * CASE: PAR.Avail Ship Date 6 USR EQ DB1.PS Available Ship Date
     C           WL0037    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0037    WQ0895  70       Avail Ship Date
     C           WL0058    PARM *ZERO     WQ0896  70       Production Date
     C                     PARM WL0079    WQ0897  61       Quantity Invent
     C           WL0085    PARM WL0085    WQ0898  61       Quantity Produc
     C           WL0106    PARM WL0106    WQ0899  61       Quantity Sales
     C           WL0127    PARM WL0127    WQ0900  61       Quantity Adjust
     C           WL0148    PARM WL0148    WQ0901  61       Quantity Availa
     C           WL0171    PARM WL0171    WQ0902  61       Quantity Sched
     C                     PARM WCAIC3    WQ0903  30       Company Number
     C                     PARM WCV5ST    WQ0904  1        Production Type
     C                     PARM WCELDT    WQ0905  70       Production Date
     C                     PARM WCHGCD    WQ0906  70       Item Code
     C                     PARM WCAJCD    WQ0907  3        Warehouse Code
     C                     PARM WCDXWG    WQ0908  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0909  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0910  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0911  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0912  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0913  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0914  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0915  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0916  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0917  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0918  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0919 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0920  92       PS Weight Order
     C                     PARM WCD7NB    WQ0921  70       PS Pieces Order
     C                     PARM WCQTAS    WQ0922  92       PS Weight Sched
     C                     PARM WCEFNB    WQ0923  70       PS Pieces Sched
     C                     PARM WL0165    WQ0924  70       Load Size USR
     C                     PARM WL0187    WQ0925  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ0926  52       Fresh Chilling
     C                     PARM WL0189    WQ0927 112       Unit Weight
     C                     PARM WL0191    WQ0928  1        Piece Count Ite
     C                     PARM WL0192    WQ0929  70       Pieces Per Bag
     C                     PARM WL0193    WQ0930  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0200           Status Flag 6
     C                     ELSE
      * CASE: PAR.Avail Ship Date 7 USR EQ DB1.PS Available Ship Date
     C           WL0038    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0038    WQ0931  70       Avail Ship Date
     C           WL0059    PARM *ZERO     WQ0932  70       Production Date
     C                     PARM WUQINV    WQ0933  61       Quantity Invent
     C           WL0086    PARM WL0086    WQ0934  61       Quantity Produc
     C           WL0107    PARM WL0107    WQ0935  61       Quantity Sales
     C           WL0128    PARM WL0128    WQ0936  61       Quantity Adjust
     C           WL0149    PARM WL0149    WQ0937  61       Quantity Availa
     C           WL0172    PARM WL0172    WQ0938  61       Quantity Sched
     C                     PARM WCAIC3    WQ0939  30       Company Number
     C                     PARM WCV5ST    WQ0940  1        Production Type
     C                     PARM WCELDT    WQ0941  70       Production Date
     C                     PARM WCHGCD    WQ0942  70       Item Code
     C                     PARM WCAJCD    WQ0943  3        Warehouse Code
     C                     PARM WCDXWG    WQ0944  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0945  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0946  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0947  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0948  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0949  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0950  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0951  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0952  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0953  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0954  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0955 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0956  92       PS Weight Order
     C                     PARM WCD7NB    WQ0957  70       PS Pieces Order
     C                     PARM WCQTAS    WQ0958  92       PS Weight Sched
     C                     PARM WCEFNB    WQ0959  70       PS Pieces Sched
     C                     PARM WL0165    WQ0960  70       Load Size USR
     C                     PARM WL0187    WQ0961  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ0962  52       Fresh Chilling
     C                     PARM WL0189    WQ0963 112       Unit Weight
     C                     PARM WL0191    WQ0964  1        Piece Count Ite
     C                     PARM WL0192    WQ0965  70       Pieces Per Bag
     C                     PARM WL0193    WQ0966  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0201           Status Flag 7
     C                     ELSE
      * CASE: PAR.Avail Ship Date 8 USR EQ DB1.PS Available Ship Date
     C           WL0039    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0039    WQ0967  70       Avail Ship Date
     C           WL0060    PARM *ZERO     WQ0968  70       Production Date
     C                     PARM WUQINV    WQ0969  61       Quantity Invent
     C           WL0087    PARM WL0087    WQ0970  61       Quantity Produc
     C           WL0108    PARM WL0108    WQ0971  61       Quantity Sales
     C           WL0129    PARM WL0129    WQ0972  61       Quantity Adjust
     C           WL0150    PARM WL0150    WQ0973  61       Quantity Availa
     C           WL0173    PARM WL0173    WQ0974  61       Quantity Sched
     C                     PARM WCAIC3    WQ0975  30       Company Number
     C                     PARM WCV5ST    WQ0976  1        Production Type
     C                     PARM WCELDT    WQ0977  70       Production Date
     C                     PARM WCHGCD    WQ0978  70       Item Code
     C                     PARM WCAJCD    WQ0979  3        Warehouse Code
     C                     PARM WCDXWG    WQ0980  92       PS Weight Stand
     C                     PARM WCB2NB    WQ0981  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ0982  92       PS Weight Conve
     C                     PARM WCPSCV    WQ0983  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ0984  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ0985  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ0986  92       PS Weight Prod
     C                     PARM WCCBNB    WQ0987  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ0988  92       PS Weight Prod
     C                     PARM WCCDNB    WQ0989  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ0990  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ0991 112       PS Weight Whse
     C                     PARM WCDVWG    WQ0992  92       PS Weight Order
     C                     PARM WCD7NB    WQ0993  70       PS Pieces Order
     C                     PARM WCQTAS    WQ0994  92       PS Weight Sched
     C                     PARM WCEFNB    WQ0995  70       PS Pieces Sched
     C                     PARM WL0165    WQ0996  70       Load Size USR
     C                     PARM WL0187    WQ0997  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ0998  52       Fresh Chilling
     C                     PARM WL0189    WQ0999 112       Unit Weight
     C                     PARM WL0191    WQ1000  1        Piece Count Ite
     C                     PARM WL0192    WQ1001  70       Pieces Per Bag
     C                     PARM WL0193    WQ1002  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0202           Status Flag 8
     C                     ELSE
      * CASE: PAR.Avail Ship Date 9 USR EQ DB1.PS Available Ship Date
     C           WL0040    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0040    WQ1003  70       Avail Ship Date
     C           WL0061    PARM *ZERO     WQ1004  70       Production Date
     C                     PARM WUQINV    WQ1005  61       Quantity Invent
     C           WL0088    PARM WL0088    WQ1006  61       Quantity Produc
     C           WL0109    PARM WL0109    WQ1007  61       Quantity Sales
     C           WL0130    PARM WL0130    WQ1008  61       Quantity Adjust
     C           WL0151    PARM WL0151    WQ1009  61       Quantity Availa
     C           WL0174    PARM WL0174    WQ1010  61       Quantity Sched
     C                     PARM WCAIC3    WQ1011  30       Company Number
     C                     PARM WCV5ST    WQ1012  1        Production Type
     C                     PARM WCELDT    WQ1013  70       Production Date
     C                     PARM WCHGCD    WQ1014  70       Item Code
     C                     PARM WCAJCD    WQ1015  3        Warehouse Code
     C                     PARM WCDXWG    WQ1016  92       PS Weight Stand
     C                     PARM WCB2NB    WQ1017  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ1018  92       PS Weight Conve
     C                     PARM WCPSCV    WQ1019  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ1020  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ1021  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ1022  92       PS Weight Prod
     C                     PARM WCCBNB    WQ1023  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ1024  92       PS Weight Prod
     C                     PARM WCCDNB    WQ1025  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ1026  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ1027 112       PS Weight Whse
     C                     PARM WCDVWG    WQ1028  92       PS Weight Order
     C                     PARM WCD7NB    WQ1029  70       PS Pieces Order
     C                     PARM WCQTAS    WQ1030  92       PS Weight Sched
     C                     PARM WCEFNB    WQ1031  70       PS Pieces Sched
     C                     PARM WL0165    WQ1032  70       Load Size USR
     C                     PARM WL0187    WQ1033  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ1034  52       Fresh Chilling
     C                     PARM WL0189    WQ1035 112       Unit Weight
     C                     PARM WL0191    WQ1036  1        Piece Count Ite
     C                     PARM WL0192    WQ1037  70       Pieces Per Bag
     C                     PARM WL0193    WQ1038  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0203           Status Flag 9
     C                     ELSE
      * CASE: PAR.Avail Ship Date 10 USR EQ DB1.PS Available Ship Date
     C           WL0041    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0041    WQ1039  70       Avail Ship Date
     C           WL0062    PARM *ZERO     WQ1040  70       Production Date
     C                     PARM WUQINV    WQ1041  61       Quantity Invent
     C           WL0089    PARM WL0089    WQ1042  61       Quantity Produc
     C           WL0110    PARM WL0110    WQ1043  61       Quantity Sales
     C           WL0131    PARM WL0131    WQ1044  61       Quantity Adjust
     C           WL0152    PARM WL0152    WQ1045  61       Quantity Availa
     C           WL0175    PARM WL0175    WQ1046  61       Quantity Sched
     C                     PARM WCAIC3    WQ1047  30       Company Number
     C                     PARM WCV5ST    WQ1048  1        Production Type
     C                     PARM WCELDT    WQ1049  70       Production Date
     C                     PARM WCHGCD    WQ1050  70       Item Code
     C                     PARM WCAJCD    WQ1051  3        Warehouse Code
     C                     PARM WCDXWG    WQ1052  92       PS Weight Stand
     C                     PARM WCB2NB    WQ1053  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ1054  92       PS Weight Conve
     C                     PARM WCPSCV    WQ1055  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ1056  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ1057  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ1058  92       PS Weight Prod
     C                     PARM WCCBNB    WQ1059  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ1060  92       PS Weight Prod
     C                     PARM WCCDNB    WQ1061  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ1062  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ1063 112       PS Weight Whse
     C                     PARM WCDVWG    WQ1064  92       PS Weight Order
     C                     PARM WCD7NB    WQ1065  70       PS Pieces Order
     C                     PARM WCQTAS    WQ1066  92       PS Weight Sched
     C                     PARM WCEFNB    WQ1067  70       PS Pieces Sched
     C                     PARM WL0165    WQ1068  70       Load Size USR
     C                     PARM WL0187    WQ1069  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ1070  52       Fresh Chilling
     C                     PARM WL0189    WQ1071 112       Unit Weight
     C                     PARM WL0191    WQ1072  1        Piece Count Ite
     C                     PARM WL0192    WQ1073  70       Pieces Per Bag
     C                     PARM WL0193    WQ1074  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0204           Status Flag 10
     C                     ELSE
      * CASE: PAR.Avail Ship Date 11 USR EQ DB1.PS Available Ship Date
     C           WL0042    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0042    WQ1075  70       Avail Ship Date
     C           WL0063    PARM *ZERO     WQ1076  70       Production Date
     C                     PARM WUQINV    WQ1077  61       Quantity Invent
     C           WL0090    PARM WL0090    WQ1078  61       Quantity Produc
     C           WL0111    PARM WL0111    WQ1079  61       Quantity Sales
     C           WL0132    PARM WL0132    WQ1080  61       Quantity Adjust
     C           WL0153    PARM WL0153    WQ1081  61       Quantity Availa
     C           WL0176    PARM WL0176    WQ1082  61       Quantity Sched
     C                     PARM WCAIC3    WQ1083  30       Company Number
     C                     PARM WCV5ST    WQ1084  1        Production Type
     C                     PARM WCELDT    WQ1085  70       Production Date
     C                     PARM WCHGCD    WQ1086  70       Item Code
     C                     PARM WCAJCD    WQ1087  3        Warehouse Code
     C                     PARM WCDXWG    WQ1088  92       PS Weight Stand
     C                     PARM WCB2NB    WQ1089  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ1090  92       PS Weight Conve
     C                     PARM WCPSCV    WQ1091  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ1092  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ1093  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ1094  92       PS Weight Prod
     C                     PARM WCCBNB    WQ1095  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ1096  92       PS Weight Prod
     C                     PARM WCCDNB    WQ1097  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ1098  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ1099 112       PS Weight Whse
     C                     PARM WCDVWG    WQ1100  92       PS Weight Order
     C                     PARM WCD7NB    WQ1101  70       PS Pieces Order
     C                     PARM WCQTAS    WQ1102  92       PS Weight Sched
     C                     PARM WCEFNB    WQ1103  70       PS Pieces Sched
     C                     PARM WL0165    WQ1104  70       Load Size USR
     C                     PARM WL0187    WQ1105  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ1106  52       Fresh Chilling
     C                     PARM WL0189    WQ1107 112       Unit Weight
     C                     PARM WL0191    WQ1108  1        Piece Count Ite
     C                     PARM WL0192    WQ1109  70       Pieces Per Bag
     C                     PARM WL0193    WQ1110  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0205           Status Flag 11
     C                     ELSE
      * CASE: PAR.Avail Ship Date 12 USR EQ DB1.PS Available Ship Date
     C           WL0043    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0043    WQ1111  70       Avail Ship Date
     C           WL0064    PARM *ZERO     WQ1112  70       Production Date
     C                     PARM WUQINV    WQ1113  61       Quantity Invent
     C           WL0091    PARM WL0091    WQ1114  61       Quantity Produc
     C           WL0112    PARM WL0112    WQ1115  61       Quantity Sales
     C           WL0133    PARM WL0133    WQ1116  61       Quantity Adjust
     C           WL0154    PARM WL0154    WQ1117  61       Quantity Availa
     C           WL0177    PARM WL0177    WQ1118  61       Quantity Sched
     C                     PARM WCAIC3    WQ1119  30       Company Number
     C                     PARM WCV5ST    WQ1120  1        Production Type
     C                     PARM WCELDT    WQ1121  70       Production Date
     C                     PARM WCHGCD    WQ1122  70       Item Code
     C                     PARM WCAJCD    WQ1123  3        Warehouse Code
     C                     PARM WCDXWG    WQ1124  92       PS Weight Stand
     C                     PARM WCB2NB    WQ1125  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ1126  92       PS Weight Conve
     C                     PARM WCPSCV    WQ1127  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ1128  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ1129  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ1130  92       PS Weight Prod
     C                     PARM WCCBNB    WQ1131  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ1132  92       PS Weight Prod
     C                     PARM WCCDNB    WQ1133  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ1134  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ1135 112       PS Weight Whse
     C                     PARM WCDVWG    WQ1136  92       PS Weight Order
     C                     PARM WCD7NB    WQ1137  70       PS Pieces Order
     C                     PARM WCQTAS    WQ1138  92       PS Weight Sched
     C                     PARM WCEFNB    WQ1139  70       PS Pieces Sched
     C                     PARM WL0165    WQ1140  70       Load Size USR
     C                     PARM WL0187    WQ1141  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ1142  52       Fresh Chilling
     C                     PARM WL0189    WQ1143 112       Unit Weight
     C                     PARM WL0191    WQ1144  1        Piece Count Ite
     C                     PARM WL0192    WQ1145  70       Pieces Per Bag
     C                     PARM WL0193    WQ1146  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0206           Status Flag 12
     C                     ELSE
      * CASE: PAR.Avail Ship Date 13 USR EQ DB1.PS Available Ship Date
     C           WL0044    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0044    WQ1147  70       Avail Ship Date
     C           WL0065    PARM *ZERO     WQ1148  70       Production Date
     C                     PARM WUQINV    WQ1149  61       Quantity Invent
     C           WL0092    PARM WL0092    WQ1150  61       Quantity Produc
     C           WL0113    PARM WL0113    WQ1151  61       Quantity Sales
     C           WL0134    PARM WL0134    WQ1152  61       Quantity Adjust
     C           WL0155    PARM WL0155    WQ1153  61       Quantity Availa
     C           WL0178    PARM WL0178    WQ1154  61       Quantity Sched
     C                     PARM WCAIC3    WQ1155  30       Company Number
     C                     PARM WCV5ST    WQ1156  1        Production Type
     C                     PARM WCELDT    WQ1157  70       Production Date
     C                     PARM WCHGCD    WQ1158  70       Item Code
     C                     PARM WCAJCD    WQ1159  3        Warehouse Code
     C                     PARM WCDXWG    WQ1160  92       PS Weight Stand
     C                     PARM WCB2NB    WQ1161  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ1162  92       PS Weight Conve
     C                     PARM WCPSCV    WQ1163  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ1164  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ1165  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ1166  92       PS Weight Prod
     C                     PARM WCCBNB    WQ1167  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ1168  92       PS Weight Prod
     C                     PARM WCCDNB    WQ1169  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ1170  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ1171 112       PS Weight Whse
     C                     PARM WCDVWG    WQ1172  92       PS Weight Order
     C                     PARM WCD7NB    WQ1173  70       PS Pieces Order
     C                     PARM WCQTAS    WQ1174  92       PS Weight Sched
     C                     PARM WCEFNB    WQ1175  70       PS Pieces Sched
     C                     PARM WL0165    WQ1176  70       Load Size USR
     C                     PARM WL0187    WQ1177  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ1178  52       Fresh Chilling
     C                     PARM WL0189    WQ1179 112       Unit Weight
     C                     PARM WL0191    WQ1180  1        Piece Count Ite
     C                     PARM WL0192    WQ1181  70       Pieces Per Bag
     C                     PARM WL0193    WQ1182  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0207           Status Flag 13
     C                     ELSE
      * CASE: PAR.Avail Ship Date 14 USR EQ DB1.PS Available Ship Date
     C           WL0045    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0045    WQ1183  70       Avail Ship Date
     C           WL0066    PARM *ZERO     WQ1184  70       Production Date
     C                     PARM WUQINV    WQ1185  61       Quantity Invent
     C           WL0093    PARM WL0093    WQ1186  61       Quantity Produc
     C           WL0114    PARM WL0114    WQ1187  61       Quantity Sales
     C           WL0135    PARM WL0135    WQ1188  61       Quantity Adjust
     C           WL0156    PARM WL0156    WQ1189  61       Quantity Availa
     C           WL0179    PARM WL0179    WQ1190  61       Quantity Sched
     C                     PARM WCAIC3    WQ1191  30       Company Number
     C                     PARM WCV5ST    WQ1192  1        Production Type
     C                     PARM WCELDT    WQ1193  70       Production Date
     C                     PARM WCHGCD    WQ1194  70       Item Code
     C                     PARM WCAJCD    WQ1195  3        Warehouse Code
     C                     PARM WCDXWG    WQ1196  92       PS Weight Stand
     C                     PARM WCB2NB    WQ1197  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ1198  92       PS Weight Conve
     C                     PARM WCPSCV    WQ1199  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ1200  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ1201  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ1202  92       PS Weight Prod
     C                     PARM WCCBNB    WQ1203  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ1204  92       PS Weight Prod
     C                     PARM WCCDNB    WQ1205  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ1206  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ1207 112       PS Weight Whse
     C                     PARM WCDVWG    WQ1208  92       PS Weight Order
     C                     PARM WCD7NB    WQ1209  70       PS Pieces Order
     C                     PARM WCQTAS    WQ1210  92       PS Weight Sched
     C                     PARM WCEFNB    WQ1211  70       PS Pieces Sched
     C                     PARM WL0165    WQ1212  70       Load Size USR
     C                     PARM WL0187    WQ1213  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ1214  52       Fresh Chilling
     C                     PARM WL0189    WQ1215 112       Unit Weight
     C                     PARM WL0191    WQ1216  1        Piece Count Ite
     C                     PARM WL0192    WQ1217  70       Pieces Per Bag
     C                     PARM WL0193    WQ1218  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0208           Status Flag 14
     C                     ELSE
      * CASE: PAR.Avail Ship Date 15 USR EQ DB1.PS Available Ship Date
     C           WL0046    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0046    WQ1219  70       Avail Ship Date
     C           WL0067    PARM *ZERO     WQ1220  70       Production Date
     C                     PARM WUQINV    WQ1221  61       Quantity Invent
     C           WL0094    PARM WL0094    WQ1222  61       Quantity Produc
     C           WL0115    PARM WL0115    WQ1223  61       Quantity Sales
     C           WL0136    PARM WL0136    WQ1224  61       Quantity Adjust
     C           WL0157    PARM WL0157    WQ1225  61       Quantity Availa
     C           WL0180    PARM WL0180    WQ1226  61       Quantity Sched
     C                     PARM WCAIC3    WQ1227  30       Company Number
     C                     PARM WCV5ST    WQ1228  1        Production Type
     C                     PARM WCELDT    WQ1229  70       Production Date
     C                     PARM WCHGCD    WQ1230  70       Item Code
     C                     PARM WCAJCD    WQ1231  3        Warehouse Code
     C                     PARM WCDXWG    WQ1232  92       PS Weight Stand
     C                     PARM WCB2NB    WQ1233  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ1234  92       PS Weight Conve
     C                     PARM WCPSCV    WQ1235  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ1236  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ1237  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ1238  92       PS Weight Prod
     C                     PARM WCCBNB    WQ1239  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ1240  92       PS Weight Prod
     C                     PARM WCCDNB    WQ1241  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ1242  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ1243 112       PS Weight Whse
     C                     PARM WCDVWG    WQ1244  92       PS Weight Order
     C                     PARM WCD7NB    WQ1245  70       PS Pieces Order
     C                     PARM WCQTAS    WQ1246  92       PS Weight Sched
     C                     PARM WCEFNB    WQ1247  70       PS Pieces Sched
     C                     PARM WL0165    WQ1248  70       Load Size USR
     C                     PARM WL0187    WQ1249  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ1250  52       Fresh Chilling
     C                     PARM WL0189    WQ1251 112       Unit Weight
     C                     PARM WL0191    WQ1252  1        Piece Count Ite
     C                     PARM WL0192    WQ1253  70       Pieces Per Bag
     C                     PARM WL0193    WQ1254  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0209           Status Flag 15
     C                     ELSE
      * CASE: PAR.Avail Ship Date 16 USR EQ DB1.PS Available Ship Date
     C           WL0047    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0047    WQ1255  70       Avail Ship Date
     C           WL0068    PARM *ZERO     WQ1256  70       Production Date
     C                     PARM WUQINV    WQ1257  61       Quantity Invent
     C           WL0095    PARM WL0095    WQ1258  61       Quantity Produc
     C           WL0116    PARM WL0116    WQ1259  61       Quantity Sales
     C           WL0137    PARM WL0137    WQ1260  61       Quantity Adjust
     C           WL0158    PARM WL0158    WQ1261  61       Quantity Availa
     C           WL0181    PARM WL0181    WQ1262  61       Quantity Sched
     C                     PARM WCAIC3    WQ1263  30       Company Number
     C                     PARM WCV5ST    WQ1264  1        Production Type
     C                     PARM WCELDT    WQ1265  70       Production Date
     C                     PARM WCHGCD    WQ1266  70       Item Code
     C                     PARM WCAJCD    WQ1267  3        Warehouse Code
     C                     PARM WCDXWG    WQ1268  92       PS Weight Stand
     C                     PARM WCB2NB    WQ1269  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ1270  92       PS Weight Conve
     C                     PARM WCPSCV    WQ1271  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ1272  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ1273  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ1274  92       PS Weight Prod
     C                     PARM WCCBNB    WQ1275  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ1276  92       PS Weight Prod
     C                     PARM WCCDNB    WQ1277  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ1278  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ1279 112       PS Weight Whse
     C                     PARM WCDVWG    WQ1280  92       PS Weight Order
     C                     PARM WCD7NB    WQ1281  70       PS Pieces Order
     C                     PARM WCQTAS    WQ1282  92       PS Weight Sched
     C                     PARM WCEFNB    WQ1283  70       PS Pieces Sched
     C                     PARM WL0165    WQ1284  70       Load Size USR
     C                     PARM WL0187    WQ1285  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ1286  52       Fresh Chilling
     C                     PARM WL0189    WQ1287 112       Unit Weight
     C                     PARM WL0191    WQ1288  1        Piece Count Ite
     C                     PARM WL0192    WQ1289  70       Pieces Per Bag
     C                     PARM WL0193    WQ1290  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0210           Status Flag 16
     C                     ELSE
      * CASE: PAR.Avail Ship Date 17 USR EQ DB1.PS Available Ship Date
     C           WL0048    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0048    WQ1291  70       Avail Ship Date
     C           WL0069    PARM *ZERO     WQ1292  70       Production Date
     C                     PARM WUQINV    WQ1293  61       Quantity Invent
     C           WL0096    PARM WL0096    WQ1294  61       Quantity Produc
     C           WL0117    PARM WL0117    WQ1295  61       Quantity Sales
     C           WL0138    PARM WL0138    WQ1296  61       Quantity Adjust
     C           WL0159    PARM WL0159    WQ1297  61       Quantity Availa
     C           WL0182    PARM WL0182    WQ1298  61       Quantity Sched
     C                     PARM WCAIC3    WQ1299  30       Company Number
     C                     PARM WCV5ST    WQ1300  1        Production Type
     C                     PARM WCELDT    WQ1301  70       Production Date
     C                     PARM WCHGCD    WQ1302  70       Item Code
     C                     PARM WCAJCD    WQ1303  3        Warehouse Code
     C                     PARM WCDXWG    WQ1304  92       PS Weight Stand
     C                     PARM WCB2NB    WQ1305  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ1306  92       PS Weight Conve
     C                     PARM WCPSCV    WQ1307  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ1308  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ1309  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ1310  92       PS Weight Prod
     C                     PARM WCCBNB    WQ1311  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ1312  92       PS Weight Prod
     C                     PARM WCCDNB    WQ1313  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ1314  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ1315 112       PS Weight Whse
     C                     PARM WCDVWG    WQ1316  92       PS Weight Order
     C                     PARM WCD7NB    WQ1317  70       PS Pieces Order
     C                     PARM WCQTAS    WQ1318  92       PS Weight Sched
     C                     PARM WCEFNB    WQ1319  70       PS Pieces Sched
     C                     PARM WL0165    WQ1320  70       Load Size USR
     C                     PARM WL0187    WQ1321  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ1322  52       Fresh Chilling
     C                     PARM WL0189    WQ1323 112       Unit Weight
     C                     PARM WL0191    WQ1324  1        Piece Count Ite
     C                     PARM WL0192    WQ1325  70       Pieces Per Bag
     C                     PARM WL0193    WQ1326  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0211           Status Flag 17
     C                     ELSE
      * CASE: PAR.Avail Ship Date 18 USR EQ DB1.PS Available Ship Date
     C           WL0049    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0049    WQ1327  70       Avail Ship Date
     C           WL0070    PARM *ZERO     WQ1328  70       Production Date
     C                     PARM WUQINV    WQ1329  61       Quantity Invent
     C           WL0097    PARM WL0097    WQ1330  61       Quantity Produc
     C           WL0118    PARM WL0118    WQ1331  61       Quantity Sales
     C           WL0139    PARM WL0139    WQ1332  61       Quantity Adjust
     C           WL0160    PARM WL0160    WQ1333  61       Quantity Availa
     C           WL0183    PARM WL0183    WQ1334  61       Quantity Sched
     C                     PARM WCAIC3    WQ1335  30       Company Number
     C                     PARM WCV5ST    WQ1336  1        Production Type
     C                     PARM WCELDT    WQ1337  70       Production Date
     C                     PARM WCHGCD    WQ1338  70       Item Code
     C                     PARM WCAJCD    WQ1339  3        Warehouse Code
     C                     PARM WCDXWG    WQ1340  92       PS Weight Stand
     C                     PARM WCB2NB    WQ1341  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ1342  92       PS Weight Conve
     C                     PARM WCPSCV    WQ1343  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ1344  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ1345  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ1346  92       PS Weight Prod
     C                     PARM WCCBNB    WQ1347  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ1348  92       PS Weight Prod
     C                     PARM WCCDNB    WQ1349  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ1350  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ1351 112       PS Weight Whse
     C                     PARM WCDVWG    WQ1352  92       PS Weight Order
     C                     PARM WCD7NB    WQ1353  70       PS Pieces Order
     C                     PARM WCQTAS    WQ1354  92       PS Weight Sched
     C                     PARM WCEFNB    WQ1355  70       PS Pieces Sched
     C                     PARM WL0165    WQ1356  70       Load Size USR
     C                     PARM WL0187    WQ1357  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ1358  52       Fresh Chilling
     C                     PARM WL0189    WQ1359 112       Unit Weight
     C                     PARM WL0191    WQ1360  1        Piece Count Ite
     C                     PARM WL0192    WQ1361  70       Pieces Per Bag
     C                     PARM WL0193    WQ1362  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0212           Status Flag 18
     C                     ELSE
      * CASE: PAR.Avail Ship Date 19 USR EQ DB1.PS Available Ship Date
     C           WL0050    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0050    WQ1363  70       Avail Ship Date
     C           WL0071    PARM *ZERO     WQ1364  70       Production Date
     C                     PARM WUQINV    WQ1365  61       Quantity Invent
     C           WL0098    PARM WL0098    WQ1366  61       Quantity Produc
     C           WL0119    PARM WL0119    WQ1367  61       Quantity Sales
     C           WL0140    PARM WL0140    WQ1368  61       Quantity Adjust
     C           WL0161    PARM WL0161    WQ1369  61       Quantity Availa
     C           WL0184    PARM WL0184    WQ1370  61       Quantity Sched
     C                     PARM WCAIC3    WQ1371  30       Company Number
     C                     PARM WCV5ST    WQ1372  1        Production Type
     C                     PARM WCELDT    WQ1373  70       Production Date
     C                     PARM WCHGCD    WQ1374  70       Item Code
     C                     PARM WCAJCD    WQ1375  3        Warehouse Code
     C                     PARM WCDXWG    WQ1376  92       PS Weight Stand
     C                     PARM WCB2NB    WQ1377  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ1378  92       PS Weight Conve
     C                     PARM WCPSCV    WQ1379  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ1380  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ1381  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ1382  92       PS Weight Prod
     C                     PARM WCCBNB    WQ1383  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ1384  92       PS Weight Prod
     C                     PARM WCCDNB    WQ1385  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ1386  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ1387 112       PS Weight Whse
     C                     PARM WCDVWG    WQ1388  92       PS Weight Order
     C                     PARM WCD7NB    WQ1389  70       PS Pieces Order
     C                     PARM WCQTAS    WQ1390  92       PS Weight Sched
     C                     PARM WCEFNB    WQ1391  70       PS Pieces Sched
     C                     PARM WL0165    WQ1392  70       Load Size USR
     C                     PARM WL0187    WQ1393  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ1394  52       Fresh Chilling
     C                     PARM WL0189    WQ1395 112       Unit Weight
     C                     PARM WL0191    WQ1396  1        Piece Count Ite
     C                     PARM WL0192    WQ1397  70       Pieces Per Bag
     C                     PARM WL0193    WQ1398  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0213           Status Flag 19
     C                     ELSE
      * CASE: PAR.Avail Ship Date 20 USR EQ DB1.PS Available Ship Date
     C           WL0051    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0051    WQ1399  70       Avail Ship Date
     C           WL0072    PARM *ZERO     WQ1400  70       Production Date
     C                     PARM WUQINV    WQ1401  61       Quantity Invent
     C           WL0099    PARM WL0099    WQ1402  61       Quantity Produc
     C           WL0120    PARM WL0120    WQ1403  61       Quantity Sales
     C           WL0141    PARM WL0141    WQ1404  61       Quantity Adjust
     C           WL0162    PARM WL0162    WQ1405  61       Quantity Availa
     C           WL0185    PARM WL0185    WQ1406  61       Quantity Sched
     C                     PARM WCAIC3    WQ1407  30       Company Number
     C                     PARM WCV5ST    WQ1408  1        Production Type
     C                     PARM WCELDT    WQ1409  70       Production Date
     C                     PARM WCHGCD    WQ1410  70       Item Code
     C                     PARM WCAJCD    WQ1411  3        Warehouse Code
     C                     PARM WCDXWG    WQ1412  92       PS Weight Stand
     C                     PARM WCB2NB    WQ1413  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ1414  92       PS Weight Conve
     C                     PARM WCPSCV    WQ1415  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ1416  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ1417  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ1418  92       PS Weight Prod
     C                     PARM WCCBNB    WQ1419  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ1420  92       PS Weight Prod
     C                     PARM WCCDNB    WQ1421  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ1422  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ1423 112       PS Weight Whse
     C                     PARM WCDVWG    WQ1424  92       PS Weight Order
     C                     PARM WCD7NB    WQ1425  70       PS Pieces Order
     C                     PARM WCQTAS    WQ1426  92       PS Weight Sched
     C                     PARM WCEFNB    WQ1427  70       PS Pieces Sched
     C                     PARM WL0165    WQ1428  70       Load Size USR
     C                     PARM WL0187    WQ1429  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ1430  52       Fresh Chilling
     C                     PARM WL0189    WQ1431 112       Unit Weight
     C                     PARM WL0191    WQ1432  1        Piece Count Ite
     C                     PARM WL0192    WQ1433  70       Pieces Per Bag
     C                     PARM WL0193    WQ1434  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0214           Status Flag 20
     C                     ELSE
      * CASE: PAR.Avail Ship Date 21 USR EQ DB1.PS Available Ship Date
     C           WL0052    IFEQ WCGPDT                     *IF
      * Clc PA w/Load Size    XF - PS Prod Item Schedule  * 
     C                     CALL 'PDYDXFR'              90  Clc PA w/Load S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0052    WQ1435  70       Avail Ship Date
     C           WL0073    PARM *ZERO     WQ1436  70       Production Date
     C                     PARM WUQINV    WQ1437  61       Quantity Invent
     C           WL0100    PARM WL0100    WQ1438  61       Quantity Produc
     C           WL0121    PARM WL0121    WQ1439  61       Quantity Sales
     C           WL0142    PARM WL0142    WQ1440  61       Quantity Adjust
     C           WL0163    PARM WL0163    WQ1441  61       Quantity Availa
     C           WL0186    PARM WL0186    WQ1442  61       Quantity Sched
     C                     PARM WCAIC3    WQ1443  30       Company Number
     C                     PARM WCV5ST    WQ1444  1        Production Type
     C                     PARM WCELDT    WQ1445  70       Production Date
     C                     PARM WCHGCD    WQ1446  70       Item Code
     C                     PARM WCAJCD    WQ1447  3        Warehouse Code
     C                     PARM WCDXWG    WQ1448  92       PS Weight Stand
     C                     PARM WCB2NB    WQ1449  70       PS Pieces Stand
     C                     PARM WCWTCN    WQ1450  92       PS Weight Conve
     C                     PARM WCPSCV    WQ1451  70       PS Pieces Conve
     C                     PARM WCSAWT    WQ1452  92       PS Weight Shipp
     C                     PARM WCB9NB    WQ1453  70       PS Pieces Shipp
     C                     PARM WCD1WG    WQ1454  92       PS Weight Prod
     C                     PARM WCCBNB    WQ1455  70       PS Pieces Prod
     C                     PARM WCOAWT    WQ1456  92       PS Weight Prod
     C                     PARM WCCDNB    WQ1457  70       PS Pieces Prod
     C                     PARM WCBPNB    WQ1458  70       PS Pieces Whse
     C                     PARM WCGAWG    WQ1459 112       PS Weight Whse
     C                     PARM WCDVWG    WQ1460  92       PS Weight Order
     C                     PARM WCD7NB    WQ1461  70       PS Pieces Order
     C                     PARM WCQTAS    WQ1462  92       PS Weight Sched
     C                     PARM WCEFNB    WQ1463  70       PS Pieces Sched
     C                     PARM WL0165    WQ1464  70       Load Size USR
     C                     PARM WL0187    WQ1465  1        Avail Dsp/Prt T
     C                     PARM WL0190    WQ1466  52       Fresh Chilling
     C                     PARM WL0189    WQ1467 112       Unit Weight
     C                     PARM WL0191    WQ1468  1        Piece Count Ite
     C                     PARM WL0192    WQ1469  70       Pieces Per Bag
     C                     PARM WL0193    WQ1470  70       Bags Per Unit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0215           Status Flag 21
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSN     READE@I8CPDZ                  90*
     C                     ENDDO
      * USER: Exit processing
      *
     C                     MOVEL*BLANK    WN0217  1        Ord/Sch Sts USR
      *
      * Rtv PA Ship Only-21  IF
      * 02/21/11 PKD Do not need to Override Weight for Piece Count Items
     C                     MOVEL'S'       WN0217           Ord/Sch Sts USR
      * day 1
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 1 USR is Entered
      *   |- c2    : PAR.Status Flag 1  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0032    IFNE *ZERO                      *IF
     C           WN0195    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0032    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 1
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0166           Day 1 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 1 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0166           Day 1 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 1 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0166           Day 1 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 2
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 2 USR is Entered
      *   |- c2    : PAR.Status Flag 2  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0033    IFNE *ZERO                      *IF
     C           WN0196    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0033    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 2
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0167           Day 2 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 2 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0167           Day 2 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 2 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0167           Day 2 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 3
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 3 USR is Entered
      *   |- c2    : PAR.Status Flag 3  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0034    IFNE *ZERO                      *IF
     C           WN0197    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0034    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 3
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0168           Day 3 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 3 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0168           Day 3 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 3 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0168           Day 3 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 4
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 4 USR is Entered
      *   |- c2    : PAR.Status Flag 4  Y/N is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0035    IFNE *ZERO                      *IF
     C           WN0198    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0035    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 4
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0169           Day 4 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 4 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0169           Day 4 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 4 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0169           Day 4 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 5
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 5 USR is Entered
      *   |- c2    : PAR.Status Flag 5  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0036    IFNE *ZERO                      *IF
     C           WN0199    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0036    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 5
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0170           Day 5 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 5 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0170           Day 5 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 5 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0170           Day 5 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 6
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 6 USR is Entered
      *   |- c2    : PAR.Status Flag 6  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0037    IFNE *ZERO                      *IF
     C           WN0200    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0037    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 6
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0171           Day 6 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 6 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0171           Day 6 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 6 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0171           Day 6 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 7
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 7 USR is Entered
      *   |- c2    : PAR.Status Flag 7  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0038    IFNE *ZERO                      *IF
     C           WN0201    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0038    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 7
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0172           Day 7 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 7 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0172           Day 7 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 7 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0172           Day 7 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 8
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 8 USR is Entered
      *   |- c2    : PAR.Status Flag 8  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0039    IFNE *ZERO                      *IF
     C           WN0202    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0039    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 8
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0173           Day 8 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 8 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0173           Day 8 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 8 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0173           Day 8 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 9
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 9 USR is Entered
      *   |- c2    : PAR.Status Flag 9  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0040    IFNE *ZERO                      *IF
     C           WN0203    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0040    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 9
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0174           Day 9 Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 9 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0174           Day 9 Sched Shi
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 9 Sched Shipments USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0174           Day 9 Sched Shi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 10
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 10 USR is Entered
      *   |- c2    : PAR.Status Flag 10 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0041    IFNE *ZERO                      *IF
     C           WN0204    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0041    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 10
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0175           Day 10 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 10 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0175           Day 10 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 10 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0175           Day 10 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 11
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 11 USR is Entered
      *   |- c2    : PAR.Status Flag 11 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0042    IFNE *ZERO                      *IF
     C           WN0205    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0042    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 11
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0176           Day 11 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 11 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0176           Day 11 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 11 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0176           Day 11 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 12
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 12 USR is Entered
      *   |- c2    : PAR.Status Flag 12 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0043    IFNE *ZERO                      *IF
     C           WN0206    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0043    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 12
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0177           Day 12 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 12 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0177           Day 12 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 12 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0177           Day 12 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 13
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 13 USR is Entered
      *   |- c2    : PAR.Status Flag 13 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0044    IFNE *ZERO                      *IF
     C           WN0207    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0044    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 13
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0178           Day 13 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 13 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0178           Day 13 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 13 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0178           Day 13 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 14
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 14 USR is Entered
      *   |- c2    : PAR.Status Flag 14 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0045    IFNE *ZERO                      *IF
     C           WN0208    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0045    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 14
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0179           Day 14 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 14 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0179           Day 14 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 14 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0179           Day 14 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 15
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 15 USR is Entered
      *   |- c2    : PAR.Status Flag 15 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0046    IFNE *ZERO                      *IF
     C           WN0209    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0046    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 15
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0180           Day 15 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 15 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0180           Day 15 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 15 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0180           Day 15 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 16
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 16 USR is Entered
      *   |- c2    : PAR.Status Flag 16 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0047    IFNE *ZERO                      *IF
     C           WN0210    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0047    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 16
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0181           Day 16 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 16 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0181           Day 16 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 16 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0181           Day 16 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 17
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 17 USR is Entered
      *   |- c2    : PAR.Status Flag 17 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0048    IFNE *ZERO                      *IF
     C           WN0211    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0048    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 17
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0182           Day 17 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 17 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0182           Day 17 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 17 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0182           Day 17 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 18
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 18 USR is Entered
      *   |- c2    : PAR.Status Flag 18 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0049    IFNE *ZERO                      *IF
     C           WN0212    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0049    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 18
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0183           Day 18 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 18 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0183           Day 18 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 18 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0183           Day 18 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 19
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 19 USR is Entered
      *   |- c2    : PAR.Status Flag 19 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0050    IFNE *ZERO                      *IF
     C           WN0213    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0050    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 19
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0184           Day 19 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 19 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0184           Day 19 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 19 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0184           Day 19 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 20
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 20 USR is Entered
      *   |- c2    : PAR.Status Flag 20 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0051    IFNE *ZERO                      *IF
     C           WN0214    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0051    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 20
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0185           Day 20 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 20 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0185           Day 20 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 20 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0185           Day 20 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * day 21
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Avail Ship Date 21 USR is Entered
      *   |- c2    : PAR.Status Flag 21 Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0052    IFNE *ZERO                      *IF
     C           WN0215    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0028    WL0194           Company Number
     C                     Z-ADDWL0029    WL0195           Item Code
     C                     MOVELWL0030    WL0196    P      Warehouse Code
     C                     Z-ADDWL0052    WL0197           Scheduled Ship
     C                     Z-ADDYL0017    WL0198           Weight Schedule
     C                     Z-ADDYL0018    WL0199           Quantity Schedu
     C                     MOVELWN0217    WL0200    P      Ord/Sch Sts USR
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    YL0017           Weight Schedule
     C                     Z-ADDWL0199    YL0018           Quantity Schedu
      * Calculate Sales Quantity 21
      * CASE: Primary UM & (Unit Weight > 0 or piece count item)
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Primary/Load Sts USR is Primary
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   |- c3    : PAR.Piece Count Item is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'P'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WL0189    IFGT *ZERO                      *IF
     C           WL0191    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***Calculate Sales with Unit Weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0191    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0018    WL0186           Day 21 Sched Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * Sched Shipments (No Dec)
      * PAR.Day 21 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Unit Weight
     C           YL0017    DIV  WL0189    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0186           Day 21 Sched Sh
     C                     END                             *FI
     C                     ELSE
      * CASE: Load Size UM and Load Size > 0
      *  - c1 AND c2
      *   |- c1    : PAR.Primary/Load Sts USR is Load Size
      *   |- c2    : PAR.Load Size USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0164    IFEQ 'L'                        *IF
     C           WL0165    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Shipments
      * PAR.Day 21 Sched Shipment USR =
      *    *COMPUTE ((x2 / x4))
      * x2    : LCL.Weight Scheduled SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Load Size USR
     C           YL0017    DIV  WL0165    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0186           Day 21 Sched Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Sched Shipments   RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0198           Weight Schedule
     C                     Z-ADD*ZERO     WL0199           Quantity Schedu
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSO01           Company Number
     C           *LIKE     DEFN OMHGCD    WQSO02           Item Code
     C           *LIKE     DEFN OMAJCD    WQSO03           Warehouse Code
     C           *LIKE     DEFN OMAODT    WQSO04           Scheduled Ship
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Item Code
     C                     KFLD           WQSO03           Warehouse Code
     C                     KFLD           WQSO04           Scheduled Ship
      * Setup key
     C                     Z-ADDWL0194    WQSO01           Company Number
     C                     Z-ADDWL0195    WQSO02           Item Code
     C                     MOVELWL0196    WQSO03           Warehouse Code
     C                     Z-ADDWL0197    WQSO04           Scheduled Ship
      * Establish starting position
     C           KRSSO     SETLL@BGWKKG                    *
     C           KRSSO     READE@BGWKKG                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Hdr Sts,BillActTy RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0024           Company Number
     C                     Z-ADDOMC4NB    WL0025           Order Number
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0026    WUGWST    P      Header Status
     C                     MOVELWL0027    WUOBST    P      Billing Activit
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Header Status is Not Comp/Canc/Conf
      *   |- c2    : WRK.Billing Activity Type is Invoice or Transfer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUGWST    IFEQ 'L'                        *IF
     C           WUGWST    OREQ 'A'
     C           WUGWST    OREQ 'E'
     C           WUGWST    OREQ 'H'
     C           WUOBST    IFEQ '1'                        *IF
     C           WUOBST    OREQ '4'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Ord/Sch Sts USR is Scheduled
     C           WL0200    IFEQ 'S'                        *IF
     C                     ADD  OMAUWG    WL0198           Weight Schedule
     C                     ADD  OMCCQT    WL0199           Quantity Schedu
     C                     ELSE
      * CASE: PAR.Ord/Sch Sts USR is Ordered
     C           WL0200    IFEQ 'O'                        *IF
     C                     ADD  OMD0WG    WL0198           Weight Schedule
     C                     ADD  OMAVQT    WL0199           Quantity Schedu
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@BGWKKG                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Val Item Bal Exist    RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           B0AIC3           Company Number
     C                     KFLD           B0HGCD           Item Code
     C                     KFLD           B0AJCD           Warehouse Code
      * Setup key
     C                     Z-ADDKLAIC3    B0AIC3           Company Number
     C                     Z-ADDKLHGCD    B0HGCD           Item Code
     C                     MOVELP3AJCD    B0AJCD           Warehouse Code
      * Establish starting position
     C           KRSSP     CHAIN@B0REYY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUWXST           Record Found US
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Avail Group Comnt PO
      *================================================================
      * Prt Avail Group Comnt PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Avail Group Comnt PO
      *================================================================
      * Prt Avail Group Comnt PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P4H6DT           Avail Ship Date
     C                     Z-ADD*ZERO     P4H7DT           Avail Ship Date
     C                     Z-ADD*ZERO     P4H8DT           Avail Ship Date
     C                     Z-ADD*ZERO     P4H9DT           Avail Ship Date
     C                     Z-ADD*ZERO     P4IADT           Avail Ship Date
     C                     Z-ADD*ZERO     P4IBDT           Avail Ship Date
     C                     Z-ADD*ZERO     P4INDT           Avail Ship Date
     C                     Z-ADD*ZERO     P4IODT           Avail Ship Date
     C                     Z-ADD*ZERO     P4IPDT           Avail Ship Date
     C                     Z-ADD*ZERO     P4IQDT           Avail Ship Date
     C                     Z-ADD*ZERO     P4IRDT           Avail Ship Date
     C                     Z-ADD*ZERO     P4ISDT           Avail Ship Date
     C                     Z-ADD*ZERO     P4ITDT           Avail Ship Date
     C                     Z-ADD*ZERO     P4IUDT           Avail Ship Date
     C                     Z-ADD*ZERO     P4IVDT           Avail Ship Date
     C                     Z-ADD*ZERO     P4IWDT           Avail Ship Date
     C                     Z-ADD*ZERO     P4IXDT           Avail Ship Date
     C                     Z-ADD*ZERO     P4IYDT           Avail Ship Date
     C                     Z-ADD*ZERO     P4IZDT           Avail Ship Date
     C                     Z-ADD*ZERO     P4I0DT           Avail Ship Date
     C                     Z-ADD*ZERO     P4I1DT           Avail Ship Date
     C                     Z-ADD*ZERO     P4FFDT           USR Day 1
     C                     Z-ADD*ZERO     P4E1DT           USR Day 2
     C                     Z-ADD*ZERO     P4E2DT           USR Day 3
     C                     Z-ADD*ZERO     P4E3DT           USR Day 4
     C                     Z-ADD*ZERO     P4E4DT           USR Day 5
     C                     Z-ADD*ZERO     P4E5DT           USR Day 6
     C                     Z-ADD*ZERO     P4E6DT           USR Day 7
     C                     Z-ADD*ZERO     P4FKDT           USR Day 8
     C                     Z-ADD*ZERO     P4FLDT           USR Day 9
     C                     Z-ADD*ZERO     P4FGDT           USR Day 10
     C                     Z-ADD*ZERO     P4FHDT           USR Day 11
     C                     Z-ADD*ZERO     P4FIDT           USR Day 12
     C                     Z-ADD*ZERO     P4FJDT           USR Day 13
     C                     Z-ADD*ZERO     P4HPDT           USR Day 14
     C                     Z-ADD*ZERO     P4HQDT           USR Day 15
     C                     Z-ADD*ZERO     P4HRDT           USR Day 16
     C                     Z-ADD*ZERO     P4HSDT           USR Day 17
     C                     Z-ADD*ZERO     P4HTDT           USR Day 18
     C                     Z-ADD*ZERO     P4HUDT           USR Day 19
     C                     Z-ADD*ZERO     P4HVDT           USR Day 20
     C                     Z-ADD*ZERO     P4HWDT           USR Day 21
     C                     MOVEL*BLANK    P6AVNA           Description Lin
     C                     Z-ADD*ZERO     P6AIWG           Unit Weight
     C                     Z-ADD*ZERO     P6CHTM           Fresh Chilling
     C                     MOVEL*BLANK    P6PCCT           Piece Count Ite
     C                     Z-ADD*ZERO     P6BDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     P6BJNB           Bags Per Unit
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field Condition Desc. 1  USR
     C                     MOVEL*BLANK    WUHLTX 25
      * Define work field Condition Desc. 2  USR
     C                     MOVEL*BLANK    WUHMTX 25
      * Define work field Condition Desc. 3  USR
     C                     MOVEL*BLANK    WUHNTX 25
      * Define work field Condition Desc. 4  USR
     C                     MOVEL*BLANK    WUHOTX 25
      * Define work field Condition Desc. 5  USR
     C                     MOVEL*BLANK    WUHPTX 25
      * Define work field Condition Desc. 6  USR
     C                     MOVEL*BLANK    WUHQTX 25
      * Define work field Condition Desc. 7  USR
     C                     MOVEL*BLANK    WUHRTX 25
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    KLAIC3           Company Number
     C                     MOVEL*LOVAL    KLV4CD           Availability Gr
     C                     MOVEL*LOVAL    KLIDSQ           Item Display Se
     C                     MOVEL*LOVAL    KLHGCD           Item Code
      * Define work field BLANK 1               USR
     C                     MOVEL*BLANK    WUJ1TX 25
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Department Code
     C                     MOVEL*BLANK    WUR3CD  6
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Export/Domestic
     C                     MOVEL*BLANK    WUSUST  1
      * Define work field Print On Schedule
     C                     MOVEL*BLANK    WUSVST  1
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Inv Allocation Seq
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Primal Group Code
     C                     MOVEL*BLANK    WUXRCD  6
      * Define work field Warehouse Type
     C                     MOVEL*BLANK    WUWPST  2
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WADBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WABWC3           Shipping Compan
     C                     Z-ADD*ZERO     WABTC3           Accounting Comp
     C                     Z-ADD*ZERO     WABUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WABVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Header Status
     C                     MOVEL*BLANK    WUGWST  1
      * Define work field Billing Activity Type
     C                     MOVEL*BLANK    WUOBST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCELDT           Production Date
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WCWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WCQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WCDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WCF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WCWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WCD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WCDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WCB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WCWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WCPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WCSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WCB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WCD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WCCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WCEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WCCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WCE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WCD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WCOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WCCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WCUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WCCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WCF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WCBPNB           PS Pieces Whse
     C                     Z-ADD*ZERO     WCGAWG           PS Weight Whse
     C                     Z-ADD*ZERO     WCBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WCGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WCBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WCGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WCBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WCGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WCBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WCGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WCPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WCDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WCD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WCFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WCD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WCDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WCEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WCSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WCEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WCAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WCECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WCWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WCEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WCFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WCEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WCQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WCEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WCWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WCEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Quantity Inventory USR
     C                     Z-ADD*ZERO     WUQINV  61
      * Define work field Quantity Avail. to Sell
     C                     Z-ADD*ZERO     WUDOQT 112
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    C3V4CD           Availability Gr
     C                     MOVEL*LOVAL    C3DXNB           Sequence Number
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    C3V4CD           Availability Gr
     C                     MOVEL*LOVAL    C3DXNB           Sequence Number
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD05 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD04 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD17 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD16 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD15 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD14 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD13 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD12 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD11 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD10 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD09 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD08 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD07 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD06 177       *Synon (17,7) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  1
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005  3
     C                     Z-ADD*ZERO     WL0006  92
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  92
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010  92
     C                     Z-ADD*ZERO     WL0011  70
     C                     Z-ADD*ZERO     WL0012  92
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  92
     C                     Z-ADD*ZERO     WL0015  70
     C                     Z-ADD*ZERO     WL0016  92
     C                     Z-ADD*ZERO     WL0017  92
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0018  30
     C                     Z-ADD*ZERO     WL0019  70
     C                     MOVEL*BLANK    WL0020  3
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022 112
     C                     Z-ADD*ZERO     WL0023 112
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0024  30
     C                     Z-ADD*ZERO     WL0025  70
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  1
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0028  30
     C                     Z-ADD*ZERO     WL0029  70
     C                     MOVEL*BLANK    WL0030  3
     C                     Z-ADD*ZERO     WL0031  70
     C                     Z-ADD*ZERO     WL0032  70
     C                     Z-ADD*ZERO     WL0033  70
     C                     Z-ADD*ZERO     WL0034  70
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036  70
     C                     Z-ADD*ZERO     WL0037  70
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039  70
     C                     Z-ADD*ZERO     WL0040  70
     C                     Z-ADD*ZERO     WL0041  70
     C                     Z-ADD*ZERO     WL0042  70
     C                     Z-ADD*ZERO     WL0043  70
     C                     Z-ADD*ZERO     WL0044  70
     C                     Z-ADD*ZERO     WL0045  70
     C                     Z-ADD*ZERO     WL0046  70
     C                     Z-ADD*ZERO     WL0047  70
     C                     Z-ADD*ZERO     WL0048  70
     C                     Z-ADD*ZERO     WL0049  70
     C                     Z-ADD*ZERO     WL0050  70
     C                     Z-ADD*ZERO     WL0051  70
     C                     Z-ADD*ZERO     WL0052  70
     C                     Z-ADD*ZERO     WL0053  70
     C                     Z-ADD*ZERO     WL0054  70
     C                     Z-ADD*ZERO     WL0055  70
     C                     Z-ADD*ZERO     WL0056  70
     C                     Z-ADD*ZERO     WL0057  70
     C                     Z-ADD*ZERO     WL0058  70
     C                     Z-ADD*ZERO     WL0059  70
     C                     Z-ADD*ZERO     WL0060  70
     C                     Z-ADD*ZERO     WL0061  70
     C                     Z-ADD*ZERO     WL0062  70
     C                     Z-ADD*ZERO     WL0063  70
     C                     Z-ADD*ZERO     WL0064  70
     C                     Z-ADD*ZERO     WL0065  70
     C                     Z-ADD*ZERO     WL0066  70
     C                     Z-ADD*ZERO     WL0067  70
     C                     Z-ADD*ZERO     WL0068  70
     C                     Z-ADD*ZERO     WL0069  70
     C                     Z-ADD*ZERO     WL0070  70
     C                     Z-ADD*ZERO     WL0071  70
     C                     Z-ADD*ZERO     WL0072  70
     C                     Z-ADD*ZERO     WL0073  70
     C                     Z-ADD*ZERO     WL0074  61
     C                     Z-ADD*ZERO     WL0075  61
     C                     Z-ADD*ZERO     WL0076  61
     C                     Z-ADD*ZERO     WL0077  61
     C                     Z-ADD*ZERO     WL0078  61
     C                     Z-ADD*ZERO     WL0079  61
     C                     Z-ADD*ZERO     WL0080  61
     C                     Z-ADD*ZERO     WL0081  61
     C                     Z-ADD*ZERO     WL0082  61
     C                     Z-ADD*ZERO     WL0083  61
     C                     Z-ADD*ZERO     WL0084  61
     C                     Z-ADD*ZERO     WL0085  61
     C                     Z-ADD*ZERO     WL0086  61
     C                     Z-ADD*ZERO     WL0087  61
     C                     Z-ADD*ZERO     WL0088  61
     C                     Z-ADD*ZERO     WL0089  61
     C                     Z-ADD*ZERO     WL0090  61
     C                     Z-ADD*ZERO     WL0091  61
     C                     Z-ADD*ZERO     WL0092  61
     C                     Z-ADD*ZERO     WL0093  61
     C                     Z-ADD*ZERO     WL0094  61
     C                     Z-ADD*ZERO     WL0095  61
     C                     Z-ADD*ZERO     WL0096  61
     C                     Z-ADD*ZERO     WL0097  61
     C                     Z-ADD*ZERO     WL0098  61
     C                     Z-ADD*ZERO     WL0099  61
     C                     Z-ADD*ZERO     WL0100  61
     C                     Z-ADD*ZERO     WL0101  61
     C                     Z-ADD*ZERO     WL0102  61
     C                     Z-ADD*ZERO     WL0103  61
     C                     Z-ADD*ZERO     WL0104  61
     C                     Z-ADD*ZERO     WL0105  61
     C                     Z-ADD*ZERO     WL0106  61
     C                     Z-ADD*ZERO     WL0107  61
     C                     Z-ADD*ZERO     WL0108  61
     C                     Z-ADD*ZERO     WL0109  61
     C                     Z-ADD*ZERO     WL0110  61
     C                     Z-ADD*ZERO     WL0111  61
     C                     Z-ADD*ZERO     WL0112  61
     C                     Z-ADD*ZERO     WL0113  61
     C                     Z-ADD*ZERO     WL0114  61
     C                     Z-ADD*ZERO     WL0115  61
     C                     Z-ADD*ZERO     WL0116  61
     C                     Z-ADD*ZERO     WL0117  61
     C                     Z-ADD*ZERO     WL0118  61
     C                     Z-ADD*ZERO     WL0119  61
     C                     Z-ADD*ZERO     WL0120  61
     C                     Z-ADD*ZERO     WL0121  61
     C                     Z-ADD*ZERO     WL0122  61
     C                     Z-ADD*ZERO     WL0123  61
     C                     Z-ADD*ZERO     WL0124  61
     C                     Z-ADD*ZERO     WL0125  61
     C                     Z-ADD*ZERO     WL0126  61
     C                     Z-ADD*ZERO     WL0127  61
     C                     Z-ADD*ZERO     WL0128  61
     C                     Z-ADD*ZERO     WL0129  61
     C                     Z-ADD*ZERO     WL0130  61
     C                     Z-ADD*ZERO     WL0131  61
     C                     Z-ADD*ZERO     WL0132  61
     C                     Z-ADD*ZERO     WL0133  61
     C                     Z-ADD*ZERO     WL0134  61
     C                     Z-ADD*ZERO     WL0135  61
     C                     Z-ADD*ZERO     WL0136  61
     C                     Z-ADD*ZERO     WL0137  61
     C                     Z-ADD*ZERO     WL0138  61
     C                     Z-ADD*ZERO     WL0139  61
     C                     Z-ADD*ZERO     WL0140  61
     C                     Z-ADD*ZERO     WL0141  61
     C                     Z-ADD*ZERO     WL0142  61
     C                     Z-ADD*ZERO     WL0143  61
     C                     Z-ADD*ZERO     WL0144  61
     C                     Z-ADD*ZERO     WL0145  61
     C                     Z-ADD*ZERO     WL0146  61
     C                     Z-ADD*ZERO     WL0147  61
     C                     Z-ADD*ZERO     WL0148  61
     C                     Z-ADD*ZERO     WL0149  61
     C                     Z-ADD*ZERO     WL0150  61
     C                     Z-ADD*ZERO     WL0151  61
     C                     Z-ADD*ZERO     WL0152  61
     C                     Z-ADD*ZERO     WL0153  61
     C                     Z-ADD*ZERO     WL0154  61
     C                     Z-ADD*ZERO     WL0155  61
     C                     Z-ADD*ZERO     WL0156  61
     C                     Z-ADD*ZERO     WL0157  61
     C                     Z-ADD*ZERO     WL0158  61
     C                     Z-ADD*ZERO     WL0159  61
     C                     Z-ADD*ZERO     WL0160  61
     C                     Z-ADD*ZERO     WL0161  61
     C                     Z-ADD*ZERO     WL0162  61
     C                     Z-ADD*ZERO     WL0163  61
     C                     MOVEL*BLANK    WL0164  1
     C                     Z-ADD*ZERO     WL0165  70
     C                     Z-ADD*ZERO     WL0166  61
     C                     Z-ADD*ZERO     WL0167  61
     C                     Z-ADD*ZERO     WL0168  61
     C                     Z-ADD*ZERO     WL0169  61
     C                     Z-ADD*ZERO     WL0170  61
     C                     Z-ADD*ZERO     WL0171  61
     C                     Z-ADD*ZERO     WL0172  61
     C                     Z-ADD*ZERO     WL0173  61
     C                     Z-ADD*ZERO     WL0174  61
     C                     Z-ADD*ZERO     WL0175  61
     C                     Z-ADD*ZERO     WL0176  61
     C                     Z-ADD*ZERO     WL0177  61
     C                     Z-ADD*ZERO     WL0178  61
     C                     Z-ADD*ZERO     WL0179  61
     C                     Z-ADD*ZERO     WL0180  61
     C                     Z-ADD*ZERO     WL0181  61
     C                     Z-ADD*ZERO     WL0182  61
     C                     Z-ADD*ZERO     WL0183  61
     C                     Z-ADD*ZERO     WL0184  61
     C                     Z-ADD*ZERO     WL0185  61
     C                     Z-ADD*ZERO     WL0186  61
     C                     MOVEL*BLANK    WL0187  1
     C                     MOVEL*BLANK    WL0188  2
     C                     Z-ADD*ZERO     WL0189 112
     C                     Z-ADD*ZERO     WL0190  52
     C                     MOVEL*BLANK    WL0191  1
     C                     Z-ADD*ZERO     WL0192  70
     C                     Z-ADD*ZERO     WL0193  70
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0194  30
     C                     Z-ADD*ZERO     WL0195  70
     C                     MOVEL*BLANK    WL0196  3
     C                     Z-ADD*ZERO     WL0197  70
     C                     Z-ADD*ZERO     WL0198 112
     C                     Z-ADD*ZERO     WL0199 112
     C                     MOVEL*BLANK    WL0200  1
      * Define local work field Kill Day Status
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Production Day Status
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Day 1 Inventory USR
     C                     Z-ADD*ZERO     YL0003  61
      * Define local work field Day 2 Inventory USR
     C                     Z-ADD*ZERO     YL0004  61
      * Define local work field Day 3 Inventory USR
     C                     Z-ADD*ZERO     YL0005  61
      * Define local work field Day 4 Inventory USR
     C                     Z-ADD*ZERO     YL0006  61
      * Define local work field Day 5 Inventory USR
     C                     Z-ADD*ZERO     YL0007  61
      * Define local work field Day 6 Inventory USR
     C                     Z-ADD*ZERO     YL0008  61
      * Define local work field Day 7 Inventory USR
     C                     Z-ADD*ZERO     YL0009  61
      * Define local work field Day 8 Inventory USR
     C                     Z-ADD*ZERO     YL0010  61
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field PS Weight Inv On-Hand
     C                     Z-ADD*ZERO     YL0012  92
      * Define local work field PS Weight Inv Adj
     C                     Z-ADD*ZERO     YL0013  92
      * Define local work field PS Weight Inv Allocated
     C                     Z-ADD*ZERO     YL0014  92
      * Define local work field PS Weight Prod Allocated
     C                     Z-ADD*ZERO     YL0015  92
      * Define local work field PS Weight Ship Cut Adj
     C                     Z-ADD*ZERO     YL0016  92
      * Define local work field Weight Scheduled SUM
     C                     Z-ADD*ZERO     YL0017 112
      * Define local work field Quantity Scheduled SUM
     C                     Z-ADD*ZERO     YL0018 112
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * This will deallocate and reallocate all scheduled orders. C6096
      * Rtv Kill/Prod Day Sts RT - Calendar  * 
     C                     EXSR SARVGN
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SBRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
      * Rtv Ats ShpDte-21+Sun RT - Calendar  * 
     C                     EXSR SDRVGN
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
