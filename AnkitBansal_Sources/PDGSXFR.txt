     H/TITLE BLD Load Stop Data    XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : COOL:2E  Version: 62050
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 01/11/01  Time  : 09:31:10
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMFJCPLOIF  E           K        DISK
      * RSQ : Load Header               Co/Load, (L,S,I/ departd
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Stop
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDL0CPL1IF  E           K        DISK
      * RTV : Load Stop Data DWN        Retrieval index
      *
     FPDL0CPL0IF  E           K        DISK                      A
      * UPD : Load Stop Data DWN        Update index
      *
     I@FJCPTE
      * Load Header               Co/Load, (L,S,I/ departd
      * Renamed input format fields
     I              FJAIC3                          WAAIC3
     I              FJRMNB                          WARMNB
     I              FJAODT                          WAAODT
     I              FJPJST                          WAPJST
     I              FJPKST                          WAPKST
     I              FJRNNB                          WARNNB
     I              FJDMTX                          WADMTX
     I              FJDNTX                          WADNTX
     I              FJDOTX                          WADOTX
     I              FJWTTX                          WAWTTX
     I              FJWUTX                          WAWUTX
     I              FJRPNB                          WARPNB
     I              FJFLAM                          WAFLAM
     I              FJXQST                          WAXQST
     I              FJRRNB                          WARRNB
     I              FJDXTX                          WADXTX
     I              FJDYTX                          WADYTX
     I              FJSBNB                          WASBNB
     I              FJBZNA                          WABZNA
     I              FJRONB                          WARONB
     I              FJSQNB                          WASQNB
     I              FJR1NB                          WAR1NB
     I              FJVCST                          WAVCST
     I              FJVDST                          WAVDST
     I              FJSDNB                          WASDNB
     I              FJPAOU                          WAPAOU
     I              FJDGWG                          WADGWG
     I              FJSXNB                          WASXNB
     I              FJHADT                          WAHADT
     I              FJAART                          WAAART
     I              FJDHWG                          WADHWG
     I              FJDIWG                          WADIWG
     I              FJAQDT                          WAAQDT
     I              FJS6NB                          WAS6NB
     I              FJT4NB                          WAT4NB
     I              FJPRTM                          WAPRTM
     I              FJNPSV                          WANPSV
     I              FJJ8TX                          WAJ8TX
     I              FJTLMI                          WATLMI
     I              FJJ9TX                          WAJ9TX
     I              FJQ2CD                          WAQ2CD
     I              FJVPCD                          WAVPCD
     I              FJDBCD                          WADBCD
     I              FJGRWE                          WAGRWE
     I              FJXCCD                          WAXCCD
     I              FJU2ST                          WAU2ST
     I              FJF9DT                          WAF9DT
     I              FJONTM                          WAONTM
     I              FJJ4DT                          WAJ4DT
     I              FJTRTM                          WATRTM
     I              FJJ5DT                          WAJ5DT
     I              FJSPTM                          WASPTM
     I              FJJ6DT                          WAJ6DT
     I              FJLFTM                          WALFTM
     I              FJJ7DT                          WAJ7DT
     I              FJBOTM                          WABOTM
     I              FJJ8DT                          WAJ8DT
     I              FJBLTM                          WABLTM
     I              FJKIDT                          WAKIDT
     I              FJASTM                          WAASTM
     I              FJKADT                          WAKADT
     I              FJAJCM                          WAAJCM
     I              FJXACD                          WAXACD
     I              FJOANA                          WAOANA
     I              FJK4TX                          WAK4TX
     I              FJVOAG                          WAVOAG
     I              FJKBDT                          WAKBDT
     I              FJNBBO                          WANBBO
     I              FJW4CD                          WAW4CD
     I              FJEFDT                          WAEFDT
     I              FJCNTN                          WACNTN
     I              FJKCDT                          WAKCDT
     I              FJTMIN                          WATMIN
     I              FJKDDT                          WAKDDT
     I              FJVMNB                          WAVMNB
     I              FJOCFR                          WAOCFR
     I              FJKJDT                          WAKJDT
     I              FJATTM                          WAATTM
     I              FJOTRS                          WAOTRS
     I              FJRNST                          WARNST
     I              FJBRBK                          WABRBK
     I              FJEIDT                          WAEIDT
     I              FJRMST                          WARMST
     I              FJAJCD                          WAAJCD
     I              FJKKDT                          WAKKDT
     I              FJAVTM                          WAAVTM
     I              FJKZDT                          WAKZDT
     I              FJAXTM                          WAAXTM
     I              FJLHOS                          WALHOS
     I              FJLHOR                          WALHOR
     I              FJWNTX                          WAWNTX
     I              FJOITX                          WAOITX
     I              FJOJTX                          WAOJTX
     I              FJLLDT                          WALLDT
     I              FJLSHG                          WALSHG
     I              FJYPST                          WAYPST
     I              FJK0DT                          WAK0DT
     I              FJAYTM                          WAAYTM
     I              FJKNNX                          WAKNNX
     I              FJICWG                          WAICWG
     I              FJIDWG                          WAIDWG
     I              FJH9SX                          WAH9SX
     I              FJWOTX                          WAWOTX
     I              FJK1DT                          WAK1DT
     I              FJAZTM                          WAAZTM
     I              FJK2DT                          WAK2DT
     I              FJA0TM                          WAA0TM
     I              FJROST                          WAROST
     I              FJRPST                          WARPST
     I              FJRQST                          WARQST
     I              FJRRST                          WARRST
     I              FJZBVA                          WAZBVA
     I              FJWPTX                          WAWPTX
     I              FJWQTX                          WAWQTX
     I              FJWRTX                          WAWRTX
     I              FJWSTX                          WAWSTX
     I              FJUVST                          WAUVST
     I              FJUWST                          WAUWST
     I              FJUXST                          WAUXST
     I              FJAATM                          WAAATM
     I              FJAYNA                          WAAYNA
     I              FJA0NA                          WAA0NA
     I              FJAXDT                          WAAXDT
      *
     I@FLCPEB
      * Load Detail               Co/Load/Stop
      * Renamed input format fields
     I              FLAIC3                          WBAIC3
     I              FLRMNB                          WBRMNB
     I              FLRUNB                          WBRUNB
     I              FLRVNB                          WBRVNB
     I              FLDQTX                          WBDQTX
     I              FLRWNB                          WBRWNB
     I              FLRXNB                          WBRXNB
     I              FLSQNB                          WBSQNB
     I              FLT0NB                          WBT0NB
     I              FLT1NB                          WBT1NB
     I              FLR1NB                          WBR1NB
     I              FLC4NB                          WBC4NB
     I              FLVCST                          WBVCST
     I              FLKEDT                          WBKEDT
     I              FLSXNB                          WBSXNB
     I              FLKFDT                          WBKFDT
     I              FLACTM                          WBACTM
     I              FLK5TX                          WBK5TX
     I              FLW5CD                          WBW5CD
     I              FLEJDT                          WBEJDT
     I              FLAGTM                          WBAGTM
     I              FLKJDT                          WBKJDT
     I              FLATTM                          WBATTM
     I              FLHDDT                          WBHDDT
     I              FLAUTM                          WBAUTM
     I              FLKKDT                          WBKKDT
     I              FLAVTM                          WBAVTM
     I              FLZ4NB                          WBZ4NB
     I              FLY7ST                          WBY7ST
     I              FLY2ST                          WBY2ST
     I              FLWHTX                          WBWHTX
     I              FLWITX                          WBWITX
     I              FLWJTX                          WBWJTX
     I              FLWKTX                          WBWKTX
     I              FLWLTX                          WBWLTX
     I              FLN7DT                          WBN7DT
     I              FLN8DT                          WBN8DT
     I              FLN9DT                          WBN9DT
     I              FLB3TM                          WBB3TM
     I              FLB4TM                          WBB4TM
     I              FLB5TM                          WBB5TM
     I              FLIASX                          WBIASX
     I              FLIBSX                          WBIBSX
     I              FLICSX                          WBICSX
     I              FLWVTX                          WBWVTX
     I              FLWWTX                          WBWWTX
     I              FLWXTX                          WBWXTX
     I              FLUVST                          WBUVST
     I              FLUWST                          WBUWST
     I              FLUXST                          WBUXST
     I              FLAATM                          WBAATM
     I              FLAYNA                          WBAYNA
     I              FLA0NA                          WBA0NA
     I              FLAXDT                          WBAXDT
      *
     I@FFREBF
      * Carrier                   Retrieval index
      * Renamed input format fields
     I              FFBZNA                          WCBZNA
     I              FFADTX                          WCADTX
     I              FFACNA                          WCACNA
     I              FFADNA                          WCADNA
     I              FFAENA                          WCAENA
     I              FFAJNA                          WCAJNA
     I              FFBTTX                          WCBTTX
     I              FFEZNB                          WCEZNB
     I              FFBGCD                          WCBGCD
     I              FFEEDT                          WCEEDT
     I              FFDUTX                          WCDUTX
     I              FFNRVA                          WCNRVA
     I              FFNSVA                          WCNSVA
     I              FFNTVA                          WCNTVA
     I              FFNUVA                          WCNUVA
     I              FFP1ST                          WCP1ST
     I              FFDVTX                          WCDVTX
     I              FFDWTX                          WCDWTX
     I              FFLVCD                          WCLVCD
     I              FFS8NB                          WCS8NB
     I              FFS9NB                          WCS9NB
     I              FFNMVA                          WCNMVA
     I              FFNOVA                          WCNOVA
     I              FFNPVA                          WCNPVA
     I              FFNQVA                          WCNQVA
     I              FFMFCD                          WCMFCD
     I              FFQXNB                          WCQXNB
     I              FFQ1NB                          WCQ1NB
     I              FFMRNG                          WCMRNG
     I              FFMRNE                          WCMRNE
     I              FFRFNB                          WCRFNB
     I              FFMREG                          WCMREG
     I              FFBQPR                          WCBQPR
     I              FFBRPR                          WCBRPR
     I              FFBSPR                          WCBSPR
     I              FFBTPR                          WCBTPR
     I              FFBUPR                          WCBUPR
     I              FFBVPR                          WCBVPR
     I              FFDJWG                          WCDJWG
     I              FFDKWG                          WCDKWG
     I              FFDLWG                          WCDLWG
     I              FFDMWG                          WCDMWG
     I              FFDNWG                          WCDNWG
     I              FFDOWG                          WCDOWG
     I              FFB2PR                          WCB2PR
     I              FFB3PR                          WCB3PR
     I              FFB4PR                          WCB4PR
     I              FFB5PR                          WCB5PR
     I              FFB6PR                          WCB6PR
     I              FFB7PR                          WCB7PR
     I              FFAAC7                          WCAAC7
     I              FFCOFI                          WCCOFI
     I              FFK6TX                          WCK6TX
     I              FFOCNA                          WCOCNA
     I              FFODNA                          WCODNA
     I              FFW7CD                          WCW7CD
     I              FFK7TX                          WCK7TX
     I              FFTENO                          WCTENO
     I              FFK8TX                          WCK8TX
     I              FFAOFC                          WCAOFC
     I              FFAOLI                          WCAOLI
     I              FFKHDT                          WCKHDT
     I              FFUNUS                          WCUNUS
     I              FFUNU2                          WCUNU2
     I              FFUNU3                          WCUNU3
     I              FFUVST                          WCUVST
     I              FFUWST                          WCUWST
     I              FFUXST                          WCUXST
     I              FFVSST                          WCVSST
     I              FFAATM                          WCAATM
     I              FFAYNA                          WCAYNA
     I              FFA0NA                          WCA0NA
     I              FFAXDT                          WCAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@L0CPSA
      * Load Stop Data DWN        Retrieval index
      * Renamed input format fields
     I              L0YACD                          WEYACD
     I              L0X8CD                          WEX8CD
     I              L0YDCD                          WEYDCD
     I              L0YBCD                          WEYBCD
     I              L0NOTX                          WENOTX
     I              L0NPTX                          WENPTX
     I              L0DXTX                          WEDXTX
     I              L0YECD                          WEYECD
     I              L0BRTX                          WEBRTX
     I              L0HNNA                          WEHNNA
     I              L0YCCD                          WEYCCD
     I              L0NQTX                          WENQTX
     I              L0NRTX                          WENRTX
     I              L0NSTX                          WENSTX
     I              L0NTTX                          WENTTX
     I              L0NUTX                          WENUTX
     I              L0NVTX                          WENVTX
     I              L0NWTX                          WENWTX
     I              L0W5CD                          WEW5CD
     I              L0NXTX                          WENXTX
      *
     I@L0CPR9
      * Load Stop Data DWN        Update index
      * Renamed input format fields
     I              L0YACD                          WFYACD
     I              L0X8CD                          WFX8CD
     I              L0YDCD                          WFYDCD
     I              L0YBCD                          WFYBCD
     I              L0NOTX                          WFNOTX
     I              L0NPTX                          WFNPTX
     I              L0DXTX                          WFDXTX
     I              L0YECD                          WFYECD
     I              L0BRTX                          WFBRTX
     I              L0HNNA                          WFHNNA
     I              L0YCCD                          WFYCCD
     I              L0NQTX                          WFNQTX
     I              L0NRTX                          WFNRTX
     I              L0NSTX                          WFNSTX
     I              L0NTTX                          WFNTTX
     I              L0NUTX                          WFNUTX
     I              L0NVTX                          WFNVTX
     I              L0NWTX                          WFNWTX
     I              L0W5CD                          WFW5CD
     I              L0NXTX                          WFNXTX
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDL01    E DSPDL0CPL0
      * UPD : Load Stop Data DWN        Update index
      * Renamed input format fields
     I              L0YACD                          WFYACD
     I              L0X8CD                          WFX8CD
     I              L0YDCD                          WFYDCD
     I              L0YBCD                          WFYBCD
     I              L0NOTX                          WFNOTX
     I              L0NPTX                          WFNPTX
     I              L0DXTX                          WFDXTX
     I              L0YECD                          WFYECD
     I              L0BRTX                          WFBRTX
     I              L0HNNA                          WFHNNA
     I              L0YCCD                          WFYCCD
     I              L0NQTX                          WFNQTX
     I              L0NRTX                          WFNRTX
     I              L0NSTX                          WFNSTX
     I              L0NTTX                          WFNTTX
     I              L0NUTX                          WFNUTX
     I              L0NVTX                          WFNVTX
     I              L0NWTX                          WFNWTX
     I              L0W5CD                          WFW5CD
     I              L0NXTX                          WFNXTX
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * N :  USR Counter
     I                                    P   1   30P1WQNB
     IP2PARM      DS
      * O :  USR Counter Alpha
     I                                        1   5 P2PDTX
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P2PDTX    PARM P2PDTX    WP0001  5        USR Counter Alp
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * BLD Load Stop Data    XF
      * Cutoff Year to compare for year 19nn
     C                     Z-ADD*ZERO     P1WQNB           USR Counter
      * BLD Load Stop Data    RT - OM Load Header  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    P2PDTX           USR Counter Alp
     C                     MOVELP1WQNB    P2PDTX           USR Counter Alp
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * BLD Load Stop Data    RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@FJCPTE                    *
     C                     READ @FJCPTE                  90*
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV All Stops Complt? RT - OM Load Detail  * 
     C                     EXSR SBRVGN
      * CASE: WRK.Status - Y or N is no
     C           WUB8ST    IFEQ 'N'                        *IF
      * BLD Load Stop Data    RT - OM Load Detail  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
     C                     READ @FJCPTE                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV All Stops Complt? RT - OM Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Header Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     Z-ADD*ZERO     WURVNB           Stop/Drop
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBRMNB    WQSB02           Load ID
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Load ID
      * Setup key
     C                     Z-ADDWAAIC3    WQSB01           Company Number
     C                     Z-ADDWARMNB    WQSB02           Load ID
      * Establish starting position
     C           KRSSB     SETLL@FLCPEB                    *
     C           KRSSB     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * For a break in stop/drop, check the actual delivery date.
      * The actual delivery date is only on the 1st (lowest) order of the
      * CASE: DB1.Stop/Drop NE WRK.Stop/Drop
     C           WBRVNB    IFNE WURVNB                     *IF
     C                     Z-ADDWBRVNB    WURVNB           Stop/Drop
      * Assume all stops are complete, unless find one that isn't
      * CASE: DB1.Actual Delivery Date is Entered
     C           WBEJDT    IFNE *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * BLD Load Stop Data    RT - OM Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0002  3        Company Alpha
     C                     MOVEL*BLANK    WN0003  4        SCAT Code
     C                     MOVEL*BLANK    WN0004  7        Load Alpha
     C                     MOVEL*BLANK    WN0005  5        Stop Code Alpha
     C                     MOVEL*BLANK    WN0006 50        Carrier Name 50
     C                     MOVEL*BLANK    WN0007 10        Requested Delv
     C                     MOVEL*BLANK    WN0008  7        Order Alpha
     C                     MOVEL*BLANK    WN0009 30        Ship To Name
     C                     MOVEL*BLANK    WN0010 20        Ship To City
     C                     MOVEL*BLANK    WN0011  3        Ship To State 3
     C                     MOVEL*BLANK    WN0012 10        Estimated Arriv
     C                     MOVEL*BLANK    WN0013  5        Estimated Arriv
     C                     MOVEL*BLANK    WN0014 10        Actual Delivery
     C                     MOVEL*BLANK    WN0015  5        Actual Delivery
     C                     MOVEL*BLANK    WN0016 10        Appointment Dat
     C                     MOVEL*BLANK    WN0017  5        Appointment Tim
     C                     MOVEL*BLANK    WN0018 30        Confirmation Na
     C                     MOVEL*BLANK    WN0019 10        Confirmation Nu
     C                     MOVEL*BLANK    WN0020 19        Modify Date & T
     C                     MOVEL*BLANK    WN0021  7        Date From Alpha
     C                     MOVEL*BLANK    WN0022  3        Month MM/  3A
     C                     MOVEL*BLANK    WN0023  3        Day DD/  3A
     C                     MOVEL*BLANK    WN0024  4        Year USR
     C                     MOVEL*BLANK    WN0025  2        Year 2A USR
     C                     MOVEL*BLANK    WN0026  3        Hours HH:  3A
     C                     MOVEL*BLANK    WN0027  2        Minutes  2A
     C                     MOVEL*BLANK    WN0028  6        Month/Day MM/DD
     C                     MOVEL*BLANK    WN0029  4        Time  4A
     C                     MOVEL*BLANK    WN0030 10        Date MM/DD/YYYY
     C                     MOVEL*BLANK    WN0031  5        Time  HH:MM
     C                     MOVEL*BLANK    WN0032  6        Time  6A
     C                     MOVEL*BLANK    WN0033  8        Time  HH:MM:SS
     C                     MOVEL*BLANK    WN0034  2        Seconds 2A
     C                     MOVEL*BLANK    WN0035  3        Seconds :SS  3A
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WBRMNB    WQSC02           Load ID
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Load ID
      * Setup key
     C                     Z-ADDWAAIC3    WQSC01           Company Number
     C                     Z-ADDWARMNB    WQSC02           Load ID
      * Establish starting position
     C           KRSSC     SETLL@FLCPEB                    *
     C           KRSSC     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WN0002           Company Alpha
     C                     MOVELWBAIC3    WN0002           Company Alpha
     C                     MOVEL*BLANK    WN0004           Load Alpha
     C                     MOVELWBRMNB    WN0004           Load Alpha
     C                     MOVEL*BLANK    WN0005           Stop Code Alpha
     C                     MOVELWBRVNB    WN0005           Stop Code Alpha
     C                     MOVEL*BLANK    WN0008           Order Alpha
     C                     MOVELWBC4NB    WN0008           Order Alpha
      * RTV Carrier Name       RT - OM Carrier  * 
     C                     EXSR SDRVGN
     C                     MOVELWN0006    WN0003           SCAT Code
      * RTV Ship Cust,Address  RT - PD Order Header  * 
     C                     EXSR SERVGN
      * Setup requested delivery date
      * CASE: PAR.Requested Delivery Date is entered
     C           WAEIDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WN0021           Date From Alpha
     C                     MOVELWAEIDT    WN0021           Date From Alpha
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0021:ZQ WN0025    P  90  Year 2A USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Setup 19nn or 20nn
      * CASE: PAR.Year 2A USR is >=40
     C           WN0025    IFGE '40'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '19'      CAT  WN0025:ZQ WN0024    P      Year USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '20'      CAT  WN0025:ZQ WN0024    P      Year USR
     C                     END                             *FI
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0021:ZQ WN0022    P  90  Month MM/  3A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0021:ZQ WN0023    P  90  Day DD/  3A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0022    CAT  '/':ZQ    WN0022    P      Month MM/  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0023    CAT  '/':ZQ    WN0023    P      Day DD/  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0022    CAT  WN0023:ZQ WN0028    P      Month/Day MM/DD
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0028    CAT  WN0024:ZQ WN0007    P      Requested Delv
     C                     END                             *FI
      * Setup estimated arrival date
      * CASE: DB1.Estimated Arrival Date is Entered
     C           WBKEDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WN0021           Date From Alpha
     C                     MOVELWBKEDT    WN0021           Date From Alpha
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0021:ZQ WN0025    P  90  Year 2A USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Setup 19nn or 20nn
      * CASE: PAR.Year 2A USR is >=40
     C           WN0025    IFGE '40'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '19'      CAT  WN0025:ZQ WN0024    P      Year USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '20'      CAT  WN0025:ZQ WN0024    P      Year USR
     C                     END                             *FI
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0021:ZQ WN0022    P  90  Month MM/  3A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0021:ZQ WN0023    P  90  Day DD/  3A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0022    CAT  '/':ZQ    WN0022    P      Month MM/  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0023    CAT  '/':ZQ    WN0023    P      Day DD/  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0022    CAT  WN0023:ZQ WN0028    P      Month/Day MM/DD
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0028    CAT  WN0024:ZQ WN0012    P      Estimated Arriv
     C                     END                             *FI
      * Setup estimated arrival time
      * CASE: DB1.Estimated Arrival Time is Entered
     C           WBSXNB    IFGT *ZERO                      *IF
     C                     MOVELWBSXNB    WN0029           Time  4A
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0029:ZQ WN0026    P  90  Hours HH:  3A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0029:ZQ WN0027    P  90  Minutes  2A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0026    CAT  ':':ZQ    WN0026    P      Hours HH:  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0026    CAT  WN0027:ZQ WN0013    P      Estimated Arriv
     C                     END                             *FI
      * Setup appointment date
      * CASE: DB1.Appointment Confirm Date is Entered
     C           WBKFDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WN0021           Date From Alpha
     C                     MOVELWBKFDT    WN0021           Date From Alpha
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0021:ZQ WN0025    P  90  Year 2A USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Setup up 19nn or 20nn
      * CASE: PAR.Year 2A USR is >=40
     C           WN0025    IFGE '40'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '19'      CAT  WN0025:ZQ WN0024    P      Year USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '20'      CAT  WN0025:ZQ WN0024    P      Year USR
     C                     END                             *FI
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0021:ZQ WN0022    P  90  Month MM/  3A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0021:ZQ WN0023    P  90  Day DD/  3A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0022    CAT  '/':ZQ    WN0022    P      Month MM/  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0023    CAT  '/':ZQ    WN0023    P      Day DD/  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0022    CAT  WN0023:ZQ WN0028    P      Month/Day MM/DD
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0028    CAT  WN0024:ZQ WN0016    P      Appointment Dat
     C                     END                             *FI
      * Setup appointment time
      * CASE: DB1.Appointment Confirm Time is Entered
     C           WBACTM    IFGT *ZERO                      *IF
     C                     MOVELWBACTM    WN0029           Time  4A
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0029:ZQ WN0026    P  90  Hours HH:  3A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0029:ZQ WN0027    P  90  Minutes  2A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0026    CAT  ':':ZQ    WN0026    P      Hours HH:  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0026    CAT  WN0027:ZQ WN0017    P      Appointment Tim
     C                     END                             *FI
      * Setup Modified Date and Time
     C                     MOVEL*BLANK    WN0021           Date From Alpha
     C                     MOVEL##JDT     WN0021           Date From Alpha
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0021:ZQ WN0025    P  90  Year 2A USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Setup 19nn or 20nn
      * CASE: PAR.Year 2A USR is >=40
     C           WN0025    IFGE '40'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '19'      CAT  WN0025:ZQ WN0024    P      Year USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '20'      CAT  WN0025:ZQ WN0024    P      Year USR
     C                     END                             *FI
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0021:ZQ WN0022    P  90  Month MM/  3A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0021:ZQ WN0023    P  90  Day DD/  3A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0022    CAT  '/':ZQ    WN0022    P      Month MM/  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0023    CAT  '/':ZQ    WN0023    P      Day DD/  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0022    CAT  WN0023:ZQ WN0028    P      Month/Day MM/DD
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0028    CAT  WN0024:ZQ WN0030    P      Date MM/DD/YYYY
     C                     MOVEL*BLANK    WN0032           Time  6A
     C                     MOVEL##JTM     WN0032           Time  6A
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00006
     C           ZQ        ORGT 00006
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0032:ZQ WN0026    P  90  Hours HH:  3A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00006
     C           ZQ        ORGT 00006
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0032:ZQ WN0027    P  90  Minutes  2A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00006
     C           ZQ        ORGT 00006
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0032:ZQ WN0034    P  90  Seconds 2A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0026    CAT  ':':ZQ    WN0026    P      Hours HH:  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0026    CAT  WN0027:ZQ WN0031    P      Time  HH:MM
     C                     Z-ADD*ZERO     ZQ      50
     C           ':'       CAT  WN0034:ZQ WN0035    P      Seconds :SS  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0031    CAT  WN0035:ZQ WN0033    P      Time  HH:MM:SS
     C                     Z-ADD1         ZQ      50
     C           WN0030    CAT  WN0033:ZQ WN0020    P      Modify Date & T
      * VAL Load Stop Exists   RT - PD Load Stop Data  * 
     C                     EXSR SFRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * CRT PD Load Stop Data  CR - PD Load Stop Data  * 
     C                     EXSR SGCRRC
     C                     ADD  1         P1WQNB           USR Counter
     C                     END                             *FI
     C           KRSSC     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - OM Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WCBZNA           Carrier Code
      * Setup key
     C                     MOVELWABZNA    WCBZNA           Carrier Code
      * Establish starting position
     C           KRSSD     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0006           Name
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCADTX    WN0006           Name
     C                     MOVELWCVSST    WUVSST           Record Status
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Ship Cust,Address  RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WDAIC3           Company Number
     C                     Z-ADDWBC4NB    WDC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUBKC7           Ship To Custome
     C                     MOVEL*BLANK    WN0009           Ship To Name
     C                     MOVEL*BLANK    WUHMNA           Ship To Address
     C                     MOVEL*BLANK    WUHONA           Ship To Address
     C                     MOVEL*BLANK    WUHPNA           Ship To Address
     C                     MOVEL*BLANK    WN0010           Ship To City
     C                     MOVEL*BLANK    WN0011           Ship To State C
     C                     MOVEL*BLANK    WUCKTX           Ship To Zip/Pos
     C                     MOVEL*BLANK    WUU2ST           Export Status
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDBKC7    WUBKC7           Ship To Custome
     C                     MOVELWDBRTX    WN0009           Ship To Name
     C                     MOVELWDHMNA    WUHMNA           Ship To Address
     C                     MOVELWDHONA    WUHONA           Ship To Address
     C                     MOVELWDHPNA    WUHPNA           Ship To Address
     C                     MOVELWDHNNA    WN0010           Ship To City
     C                     MOVELWDDBCD    WN0011           Ship To State C
     C                     MOVELWDCKTX    WUCKTX           Ship To Zip/Pos
     C                     MOVELWDU2ST    WUU2ST           Export Status
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * VAL Load Stop Exists   RT - PD Load Stop Data  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEYACD           Company Alpha
     C                     KFLD           WEX8CD           SCAT Code
     C                     KFLD           WEYDCD           Load Alpha
     C                     KFLD           WEYBCD           Stop Code Alpha
      * Setup key
     C                     MOVELWN0002    WEYACD           Company Alpha
     C                     MOVELWN0003    WEX8CD           SCAT Code
     C                     MOVELWN0004    WEYDCD           Load Alpha
     C                     MOVELWN0005    WEYBCD           Stop Code Alpha
      * Establish starting position
     C           KRSSF     CHAIN@L0CPSA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2609' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * CRT PD Load Stop Data  CR - PD Load Stop Data  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L0CPR9
     C                     MOVELWN0002    WFYACD           Company Alpha
     C                     MOVELWN0003    WFX8CD           SCAT Code
     C                     MOVELWN0004    WFYDCD           Load Alpha
     C                     MOVELWN0005    WFYBCD           Stop Code Alpha
     C                     MOVELWN0006    WFNOTX           Carrier Name 50
     C                     MOVELWN0007    WFNPTX           Requested Delv
     C                     MOVELWADXTX    WFDXTX           Trailer Id
     C                     MOVELWN0008    WFYECD           Order Alpha
     C                     MOVELWN0009    WFBRTX           Ship To Name
     C                     MOVELWN0010    WFHNNA           Ship To City
     C                     MOVELWN0011    WFYCCD           Ship To State 3
     C                     MOVELWN0012    WFNQTX           Estimated Arriv
     C                     MOVELWN0013    WFNRTX           Estimated Arriv
     C                     MOVELWN0014    WFNSTX           Actual Delivery
     C                     MOVELWN0015    WFNTTX           Actual Delivery
     C                     MOVELWN0016    WFNUTX           Appointment Dat
     C                     MOVELWN0017    WFNVTX           Appointment Tim
     C                     MOVELWBK5TX    WFNWTX           Confirmation Na
     C                     MOVELWBW5CD    WFW5CD           Confirmation Nu
     C                     MOVELWN0020    WFNXTX           Modify Date & T
      *
     C           KLCRSG    KLIST
     C                     KFLD           WFYACD           Company Alpha
     C                     KFLD           WFX8CD           SCAT Code
     C                     KFLD           WFYDCD           Load Alpha
     C                     KFLD           WFYBCD           Stop Code Alpha
      * Check for duplicate primary key
     C           KLCRSG    SETLL@L0CPR9                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2610' W0RTN   7
      * Send message 'Load Stop Data UPL     EX'
     C                     MOVEL'USR2610' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@L0CPR9                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1WQNB           USR Counter
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WARPNB           Total Load Orde
     C                     Z-ADD*ZERO     WAFLAM           Flat Amount
     C                     Z-ADD*ZERO     WARRNB           Total Stops
     C                     Z-ADD*ZERO     WASBNB           BOL Time
     C                     Z-ADD*ZERO     WASQNB           Actual Freight
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WASDNB           Number Pallets
     C                     Z-ADD*ZERO     WAPAOU           Number Pallets
     C                     Z-ADD*ZERO     WADGWG           LH Unused Wgt 1
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAHADT           Actual Arrival
     C                     Z-ADD*ZERO     WAAART           Actual Arrival
     C                     Z-ADD*ZERO     WADHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WADIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WAAQDT           Actual Departur
     C                     Z-ADD*ZERO     WAS6NB           Departure Time
     C                     Z-ADD*ZERO     WAT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WAPRTM           Product Tempera
     C                     Z-ADD*ZERO     WANPSV           Number Pallets
     C                     Z-ADD*ZERO     WATLMI           Total Load Mile
     C                     Z-ADD*ZERO     WAGRWE           Gross Weight
     C                     Z-ADD*ZERO     WAF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WAJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WATRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WAJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WASPTM           Spotted Time
     C                     Z-ADD*ZERO     WAJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WALFTM           Load Finished T
     C                     Z-ADD*ZERO     WAJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WABOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WAJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WABLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WAKIDT           Truck Departure
     C                     Z-ADD*ZERO     WAASTM           Truck Departure
     C                     Z-ADD*ZERO     WAKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WAAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WAVOAG           Voyage
     C                     Z-ADD*ZERO     WAKBDT           Sail Date
     C                     Z-ADD*ZERO     WAEFDT           Arrival Date
     C                     Z-ADD*ZERO     WAKCDT           Date In
     C                     Z-ADD*ZERO     WATMIN           Time In
     C                     Z-ADD*ZERO     WAKDDT           Date Out
     C                     Z-ADD*ZERO     WAVMNB           Time Out
     C                     Z-ADD*ZERO     WAOCFR           Ocean Freight
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WABRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WALLDT           Express Mail Da
     C                     Z-ADD*ZERO     WAK0DT           Product Complet
     C                     Z-ADD*ZERO     WAAYTM           Product Complet
     C                     Z-ADD*ZERO     WAKNNX           LH Unused Nbr 1
     C                     Z-ADD*ZERO     WAICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WAIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WAK1DT           Unused Load Dat
     C                     Z-ADD*ZERO     WAAZTM           Load Door 1
     C                     Z-ADD*ZERO     WAK2DT           Unused Load Dat
     C                     Z-ADD*ZERO     WAA0TM           Load Door 2
     C                     Z-ADD*ZERO     WAZBVA           Unused Load Val
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WBRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WBRWNB           Miles to next s
     C                     Z-ADD*ZERO     WBRXNB           Freight Charge
     C                     Z-ADD*ZERO     WBSQNB           Actual Freight
     C                     Z-ADD*ZERO     WBT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WBT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WBKFDT           Appointment Con
     C                     Z-ADD*ZERO     WBACTM           Appointment Con
     C                     Z-ADD*ZERO     WBEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WBAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WBATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WBHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBZ4NB           MPC Number
     C                     Z-ADD*ZERO     WBN7DT           LD Unused Date
     C                     Z-ADD*ZERO     WBN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WBN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WBB3TM           LD Unused Time
     C                     Z-ADD*ZERO     WBB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WBB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Stop/Drop
     C                     Z-ADD*ZERO     WURVNB  50
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WCEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WCNRVA           Pallet Balance
     C                     Z-ADD*ZERO     WCNSVA           Long hook balan
     C                     Z-ADD*ZERO     WCNTVA           Short hook bala
     C                     Z-ADD*ZERO     WCNUVA           Tub Balance
     C                     Z-ADD*ZERO     WCS8NB           Home Phone
     C                     Z-ADD*ZERO     WCS9NB           Other Phone
     C                     Z-ADD*ZERO     WCNMVA           Flat Rate
     C                     Z-ADD*ZERO     WCNOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WCNPVA           Rate Per Stop
     C                     Z-ADD*ZERO     WCNQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WCQXNB           Mile Range 1
     C                     Z-ADD*ZERO     WCQ1NB           Mile Range 2
     C                     Z-ADD*ZERO     WCMRNG           Mile Range 3
     C                     Z-ADD*ZERO     WCMRNE           Mile Range 4
     C                     Z-ADD*ZERO     WCRFNB           Mile Range 5
     C                     Z-ADD*ZERO     WCMREG           Mile Range 6
     C                     Z-ADD*ZERO     WCBQPR           Mile Rate 1
     C                     Z-ADD*ZERO     WCBRPR           Mile Rate 2
     C                     Z-ADD*ZERO     WCBSPR           Mile Rate 3
     C                     Z-ADD*ZERO     WCBTPR           Mile Rate 4
     C                     Z-ADD*ZERO     WCBUPR           Mile Rate 5
     C                     Z-ADD*ZERO     WCBVPR           Mile Rate 6
     C                     Z-ADD*ZERO     WCDJWG           Weight Range 1
     C                     Z-ADD*ZERO     WCDKWG           Weight Range 2
     C                     Z-ADD*ZERO     WCDLWG           Weight Range 3
     C                     Z-ADD*ZERO     WCDMWG           Weight Range 4
     C                     Z-ADD*ZERO     WCDNWG           Weight Range 5
     C                     Z-ADD*ZERO     WCDOWG           Weight Range 6
     C                     Z-ADD*ZERO     WCB2PR           Weight Rate 1
     C                     Z-ADD*ZERO     WCB3PR           Weight Rate 2
     C                     Z-ADD*ZERO     WCB4PR           Weight Rate 3
     C                     Z-ADD*ZERO     WCB5PR           Weight Rate 4
     C                     Z-ADD*ZERO     WCB6PR           Weight Rate 5
     C                     Z-ADD*ZERO     WCB7PR           Weight Rate 6
     C                     Z-ADD*ZERO     WCAAC7           Contact Number
     C                     Z-ADD*ZERO     WCTENO           Insurance Co. P
     C                     Z-ADD*ZERO     WCAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WCAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WCKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Address Line 1
     C                     MOVEL*BLANK    WUHMNA 30
      * Define work field Ship To Address Line 2
     C                     MOVEL*BLANK    WUHONA 30
      * Define work field Ship To Address Line 3
     C                     MOVEL*BLANK    WUHPNA 30
      * Define work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    WUCKTX 11
      * Define work field Export Status
     C                     MOVEL*BLANK    WUU2ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Unused Date
     C                     Z-ADD*ZERO     WDNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WDNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WDNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WDNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WDBPTM           OH Unused Time
     C                     Z-ADD*ZERO     WDBQTM           OH Unused Time
     C                     Z-ADD*ZERO     WDBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WDBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WDBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WDH0NX           OH Unused Nbr 1
     C                     Z-ADD*ZERO     WDH1NX           OH Unused Nbr 2
     C                     Z-ADD*ZERO     WDH2NX           OH Unused Nbr 3
     C                     Z-ADD*ZERO     WDH3NX           OH Unused Nbr 4
     C                     Z-ADD*ZERO     WDH4NX           OH Unused Nbr 5
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
