     H/TITLE Trn Item Whs Trans    PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 12/18/13  Time  : 08:30:01
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPOE9PVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Trn Item Whs Trans    PV  Prompt & validate record
      *
     FPDL7CPL2IF  E           K        DISK
      * RSQ : Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      *
     FPDL5CPL1IF  E           K        DISK
      * RTV : Item Lot Location         Retrieval index
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FPDL3REL0IF  E           K        DISK
      * RTV : Warehouse Location Type   Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB0REL1IF  E           K        DISK
      * RTV : Item Balance              Retrieval index       NV
      *
     FCAB7CPLEIF  E           K        DISK
      * RSQ : Item Transaction Detail   Normal KEY Sequence (D)
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAB1REL4IF  E           K        DISK
      * RTV : Item Balance Detail       Active only
      *
     FCAB0RELJIF  E           K        DISK
      * RTV : Item Balance              Acitve records only
      *
     FCAB7CPL1IF  E           K        DISK
      * RTV : Item Transaction Detail   Retrieval index       NV
      *
     FPDL4REL0IF  E           K        DISK
      * RTV : Item Hold Reason          Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDL7CPL0IF  E           K        DISK                      A
      * UPD : Item Lot Loc Trans        Update index
      *
     FPDL5CPL0UF  E           K        DISK                      A
      * UPD : Item Lot Location         Update index
      *
     FCAB1REL1UF  E           K        DISK                      A
      * UPD : Item Balance Detail       Update index
      *
     FPDL2REL1IF  E           K        DISK                      A
      * UPD : Warehouse Location        Update index
      *
     FCAASREL0UF  E           K        DISK
      * UPD : Company Control           Update index
      *
     FCAB7CPL0IF  E           K        DISK                      A
      * UPD : Item Transaction Detail   Update index
      *
     FCAB0REL0UF  E           K        DISK                      A
      * UPD : Item Balance              Update index
      *
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 019  5 0A
     E                    W0END   7 019  5 0A
     E                    W0NAM   7 019 10
      * Long constants
     E                    @CN#    1  04  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@L7CPUK
      * Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      * Renamed input format fields
     I              L7AIC3                          WAAIC3
     I              L7HGCD                          WAHGCD
     I              L7AJCD                          WAAJCD
     I              L7LTRT                          WALTRT
     I              L7LRDT                          WALRDT
     I              L7LLTS                          WALLTS
     I              L7LSDT                          WALSDT
     I              L7J5QT                          WAJ5QT
     I              L7G8WG                          WAG8WG
     I              L7LLTN                          WALLTN
     I              L7YMCD                          WAYMCD
     I              L7LLCL                          WALLCL
     I              L7BNAA                          WABNAA
     I              L7LLTR                          WALLTR
     I              L7Y2CD                          WAY2CD
     I              L7LLTL                          WALLTL
     I              L7C4NB                          WAC4NB
     I              L7LOST                          WALOST
     I              L7LLTU                          WALLTU
     I              L7LLYT                          WALLYT
     I              L7UVST                          WAUVST
     I              L7UWST                          WAUWST
     I              L7UXST                          WAUXST
     I              L7VSST                          WAVSST
     I              L7AATM                          WAAATM
     I              L7AYNA                          WAAYNA
     I              L7A0NA                          WAA0NA
     I              L7AXDT                          WAAXDT
      *
     I@L7CPS3
      * Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WBAIC3
     I              L7HGCD                          WBHGCD
     I              L7AJCD                          WBAJCD
     I              L7LTRT                          WBLTRT
     I              L7LRDT                          WBLRDT
     I              L7LLTS                          WBLLTS
     I              L7LSDT                          WBLSDT
     I              L7J5QT                          WBJ5QT
     I              L7G8WG                          WBG8WG
     I              L7LLTN                          WBLLTN
     I              L7YMCD                          WBYMCD
     I              L7LLCL                          WBLLCL
     I              L7BNAA                          WBBNAA
     I              L7LLTR                          WBLLTR
     I              L7Y2CD                          WBY2CD
     I              L7LLTL                          WBLLTL
     I              L7C4NB                          WBC4NB
     I              L7LOST                          WBLOST
     I              L7LLTU                          WBLLTU
     I              L7LLYT                          WBLLYT
     I              L7UVST                          WBUVST
     I              L7UWST                          WBUWST
     I              L7UXST                          WBUXST
     I              L7VSST                          WBVSST
     I              L7AATM                          WBAATM
     I              L7AYNA                          WBAYNA
     I              L7A0NA                          WBA0NA
     I              L7AXDT                          WBAXDT
      *
     I@L5CPSV
      * Item Lot Location         Retrieval index
      * Renamed input format fields
     I              L5AIC3                          WCAIC3
     I              L5HGCD                          WCHGCD
     I              L5AJCD                          WCAJCD
     I              L5ELDT                          WCELDT
     I              L5LXNM                          WCLXNM
     I              L5YMCD                          WCYMCD
     I              L5YNCD                          WCYNCD
     I              L5J2QT                          WCJ2QT
     I              L5G5WG                          WCG5WG
     I              L5J3QT                          WCJ3QT
     I              L5G6WG                          WCG6WG
     I              L5J4QT                          WCJ4QT
     I              L5G7WG                          WCG7WG
     I              L5LODT                          WCLODT
     I              L5LPDT                          WCLPDT
     I              L5LQDT                          WCLQDT
     I              L5NBR                           WCNBR
     I              L5YTCD                          WCYTCD
     I              L5AMSX                          WCAMSX
     I              L5ASSX                          WCASSX
     I              L5ATSX                          WCATSX
     I              L5AUSX                          WCAUSX
     I              L5YSCD                          WCYSCD
     I              L5UVST                          WCUVST
     I              L5UWST                          WCUWST
     I              L5UXST                          WCUXST
     I              L5VSST                          WCVSST
     I              L5AATM                          WCAATM
     I              L5AYNA                          WCAYNA
     I              L5A0NA                          WCA0NA
     I              L5AXDT                          WCAXDT
      *
     I@L5CPSL
      * Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WDAIC3
     I              L5HGCD                          WDHGCD
     I              L5AJCD                          WDAJCD
     I              L5ELDT                          WDELDT
     I              L5LXNM                          WDLXNM
     I              L5YMCD                          WDYMCD
     I              L5YNCD                          WDYNCD
     I              L5J2QT                          WDJ2QT
     I              L5G5WG                          WDG5WG
     I              L5J3QT                          WDJ3QT
     I              L5G6WG                          WDG6WG
     I              L5J4QT                          WDJ4QT
     I              L5G7WG                          WDG7WG
     I              L5LODT                          WDLODT
     I              L5LPDT                          WDLPDT
     I              L5LQDT                          WDLQDT
     I              L5NBR                           WDNBR
     I              L5YTCD                          WDYTCD
     I              L5AMSX                          WDAMSX
     I              L5ASSX                          WDASSX
     I              L5ATSX                          WDATSX
     I              L5AUSX                          WDAUSX
     I              L5YSCD                          WDYSCD
     I              L5UVST                          WDUVST
     I              L5UWST                          WDUWST
     I              L5UXST                          WDUXST
     I              L5VSST                          WDVSST
     I              L5AATM                          WDAATM
     I              L5AYNA                          WDAYNA
     I              L5A0NA                          WDA0NA
     I              L5AXDT                          WDAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          WEAIC3
     I              B1HGCD                          WEHGCD
     I              B1AJCD                          WEAJCD
     I              B1ELDT                          WEELDT
     I              B1ABWG                          WEABWG
     I              B1AGQT                          WEAGQT
     I              B1AHQT                          WEAHQT
     I              B1AIQT                          WEAIQT
     I              B1CTST                          WECTST
     I              B1ACWG                          WEACWG
     I              B1ARQT                          WEARQT
     I              B1ASQT                          WEASQT
     I              B1ATQT                          WEATQT
     I              B1HDQT                          WEHDQT
     I              B1HEQT                          WEHEQT
     I              B1F6ST                          WEF6ST
     I              B1BMWG                          WEBMWG
     I              B1DSQT                          WEDSQT
     I              B1DTQT                          WEDTQT
     I              B1DUQT                          WEDUQT
     I              B1DHDT                          WEDHDT
     I              B1AGCS                          WEAGCS
     I              B1AECS                          WEAECS
     I              B1IDVA                          WEIDVA
     I              B1K7DT                          WEK7DT
     I              B1RINB                          WERINB
     I              B1RHNB                          WERHNB
     I              B1RGNB                          WERGNB
     I              B1UVST                          WEUVST
     I              B1UWST                          WEUWST
     I              B1UXST                          WEUXST
     I              B1VSST                          WEVSST
     I              B1AATM                          WEAATM
     I              B1AYNA                          WEAYNA
     I              B1A0NA                          WEA0NA
     I              B1AXDT                          WEAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WFAIC3
     I              B1HGCD                          WFHGCD
     I              B1AJCD                          WFAJCD
     I              B1ELDT                          WFELDT
     I              B1ABWG                          WFABWG
     I              B1AGQT                          WFAGQT
     I              B1AHQT                          WFAHQT
     I              B1AIQT                          WFAIQT
     I              B1CTST                          WFCTST
     I              B1ACWG                          WFACWG
     I              B1ARQT                          WFARQT
     I              B1ASQT                          WFASQT
     I              B1ATQT                          WFATQT
     I              B1HDQT                          WFHDQT
     I              B1HEQT                          WFHEQT
     I              B1F6ST                          WFF6ST
     I              B1BMWG                          WFBMWG
     I              B1DSQT                          WFDSQT
     I              B1DTQT                          WFDTQT
     I              B1DUQT                          WFDUQT
     I              B1DHDT                          WFDHDT
     I              B1AGCS                          WFAGCS
     I              B1AECS                          WFAECS
     I              B1IDVA                          WFIDVA
     I              B1K7DT                          WFK7DT
     I              B1RINB                          WFRINB
     I              B1RHNB                          WFRHNB
     I              B1RGNB                          WFRGNB
     I              B1UVST                          WFUVST
     I              B1UWST                          WFUWST
     I              B1UXST                          WFUXST
     I              B1VSST                          WFVSST
     I              B1AATM                          WFAATM
     I              B1AYNA                          WFAYNA
     I              B1A0NA                          WFA0NA
     I              B1AXDT                          WFAXDT
      *
     I@L2RESM
      * Warehouse Location        Retrieval index
      * Renamed input format fields
     I              L2AJCD                          WGAJCD
     I              L2YMCD                          WGYMCD
     I              L2YPCD                          WGYPCD
     I              L2LCBY                          WGLCBY
     I              L2LCCT                          WGLCCT
     I              L2WLUS                          WGWLUS
     I              L2WUSD                          WGWUSD
     I              L2WLUN                          WGWLUN
     I              L2AGSX                          WGAGSX
     I              L2UVST                          WGUVST
     I              L2UWST                          WGUWST
     I              L2UXST                          WGUXST
     I              L2VSST                          WGVSST
     I              L2AATM                          WGAATM
     I              L2AYNA                          WGAYNA
     I              L2A0NA                          WGA0NA
     I              L2AXDT                          WGAXDT
      *
     I@L2RESN
      * Warehouse Location        Update index
      * Renamed input format fields
     I              L2AJCD                          WHAJCD
     I              L2YMCD                          WHYMCD
     I              L2YPCD                          WHYPCD
     I              L2LCBY                          WHLCBY
     I              L2LCCT                          WHLCCT
     I              L2WLUS                          WHWLUS
     I              L2WUSD                          WHWUSD
     I              L2WLUN                          WHWLUN
     I              L2AGSX                          WHAGSX
     I              L2UVST                          WHUVST
     I              L2UWST                          WHUWST
     I              L2UXST                          WHUXST
     I              L2VSST                          WHVSST
     I              L2AATM                          WHAATM
     I              L2AYNA                          WHAYNA
     I              L2A0NA                          WHA0NA
     I              L2AXDT                          WHAXDT
      *
     I@L3RET8
      * Warehouse Location Type   Retrieval index
      * Renamed input format fields
     I              MEAGSX                          WIAGSX
     I              MEOPNA                          WIOPNA
     I              MESLTY                          WISLTY
     I              MEAHSX                          WIAHSX
     I              MEAISX                          WIAISX
     I              MEUVST                          WIUVST
     I              MEUWST                          WIUWST
     I              MEUXST                          WIUXST
     I              MEVSST                          WIVSST
     I              MEAATM                          WIAATM
     I              MEAYNA                          WIAYNA
     I              MEA0NA                          WIA0NA
     I              MEAXDT                          WIAXDT
      *
     I@ASRECB
      * Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WJAIC3
     I              ASAXNB                          WJAXNB
     I              ASNGNB                          WJNGNB
     I              ASBZNB                          WJBZNB
     I              ASC5NB                          WJC5NB
     I              ASC3NB                          WJC3NB
     I              ASCYNB                          WJCYNB
     I              ASIONB                          WJIONB
     I              ASI6NB                          WJI6NB
     I              ASDCNB                          WJDCNB
     I              ASC7NB                          WJC7NB
     I              ASC2NB                          WJC2NB
     I              ASC1NB                          WJC1NB
     I              ASL8NB                          WJL8NB
     I              ASBANB                          WJBANB
     I              ASCHST                          WJCHST
     I              ASCKST                          WJCKST
     I              ASCIST                          WJCIST
     I              ASCGST                          WJCGST
     I              ASAIPC                          WJAIPC
     I              ASASPC                          WJASPC
     I              ASA2VA                          WJA2VA
     I              ASC2ST                          WJC2ST
     I              ASD8ST                          WJD8ST
     I              ASD7ST                          WJD7ST
     I              ASA8NA                          WJA8NA
     I              ASA9NA                          WJA9NA
     I              ASBANA                          WJBANA
     I              ASBBNA                          WJBBNA
     I              ASEUST                          WJEUST
     I              ASAADY                          WJAADY
     I              ASABDY                          WJABDY
     I              ASACDY                          WJACDY
     I              ASADDY                          WJADDY
     I              ASAEDY                          WJAEDY
     I              ASAFDY                          WJAFDY
     I              ASAGDY                          WJAGDY
     I              ASAHDY                          WJAHDY
     I              ASAENB                          WJAENB
     I              ASALNB                          WJALNB
     I              ASEVNB                          WJEVNB
     I              ASRPOP                          WJRPOP
     I              ASDWNB                          WJDWNB
     I              ASR3NB                          WJR3NB
     I              ASPNST                          WJPNST
     I              ASR4NB                          WJR4NB
     I              ASPOST                          WJPOST
     I              ASSCNB                          WJSCNB
     I              ASVIST                          WJVIST
     I              ASVJST                          WJVJST
     I              ASBVVN                          WJBVVN
     I              ASUVST                          WJUVST
     I              ASUWST                          WJUWST
     I              ASUXST                          WJUXST
     I              ASVSST                          WJVSST
     I              ASAATM                          WJAATM
     I              ASAYNA                          WJAYNA
     I              ASA0NA                          WJA0NA
     I              ASAXDT                          WJAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WKAIC3
     I              BZHGCD                          WKHGCD
     I              BZAVNA                          WKAVNA
     I              BZAWNA                          WKAWNA
     I              BZL7NA                          WKL7NA
     I              BZL8NA                          WKL8NA
     I              BZL6NA                          WKL6NA
     I              BZMFNA                          WKMFNA
     I              BZADCD                          WKADCD
     I              BZAWPC                          WKAWPC
     I              BZLXST                          WKLXST
     I              BZAECD                          WKAECD
     I              BZAXPC                          WKAXPC
     I              BZLYST                          WKLYST
     I              BZAFCD                          WKAFCD
     I              BZAICD                          WKAICD
     I              BZAIWG                          WKAIWG
     I              BZHICD                          WKHICD
     I              BZRBCD                          WKRBCD
     I              BZFZST                          WKFZST
     I              BZAVST                          WKAVST
     I              BZCZWG                          WKCZWG
     I              BZC0WG                          WKC0WG
     I              BZURTN                          WKURTN
     I              BZAJC8                          WKAJC8
     I              BZRINB                          WKRINB
     I              BZRHNB                          WKRHNB
     I              BZRGNB                          WKRGNB
     I              BZLNCD                          WKLNCD
     I              BZTFNB                          WKTFNB
     I              BZN0CD                          WKN0CD
     I              BZX4ST                          WKX4ST
     I              BZTMVA                          WKTMVA
     I              BZTNVA                          WKTNVA
     I              BZBLPR                          WKBLPR
     I              BZBMPR                          WKBMPR
     I              BZLRCD                          WKLRCD
     I              BZU9ST                          WKU9ST
     I              BZCMCO                          WKCMCO
     I              BZQ1CD                          WKQ1CD
     I              BZQ8CD                          WKQ8CD
     I              BZCHTM                          WKCHTM
     I              BZQZCD                          WKQZCD
     I              BZXWST                          WKXWST
     I              BZXXST                          WKXXST
     I              BZVMST                          WKVMST
     I              BZSWGH                          WKSWGH
     I              BZPPHE                          WKPPHE
     I              BZR3CD                          WKR3CD
     I              BZSDCD                          WKSDCD
     I              BZICN1                          WKICN1
     I              BZSVCD                          WKSVCD
     I              BZICN2                          WKICN2
     I              BZSWCD                          WKSWCD
     I              BZV2NB                          WKV2NB
     I              BZSXCD                          WKSXCD
     I              BZITCN                          WKITCN
     I              BZSYCD                          WKSYCD
     I              BZITC5                          WKITC5
     I              BZSZCD                          WKSZCD
     I              BZICN6                          WKICN6
     I              BZS0CD                          WKS0CD
     I              BZICN7                          WKICN7
     I              BZS1CD                          WKS1CD
     I              BZICN8                          WKICN8
     I              BZS2CD                          WKS2CD
     I              BZICN9                          WKICN9
     I              BZS3CD                          WKS3CD
     I              BZICN0                          WKICN0
     I              BZS4CD                          WKS4CD
     I              BZSFNB                          WKSFNB
     I              BZA3WG                          WKA3WG
     I              BZSJNB                          WKSJNB
     I              BZLLCD                          WKLLCD
     I              BZLMCD                          WKLMCD
     I              BZP3ST                          WKP3ST
     I              BZSKNB                          WKSKNB
     I              BZSLNB                          WKSLNB
     I              BZSMNB                          WKSMNB
     I              BZP4ST                          WKP4ST
     I              BZCFNB                          WKCFNB
     I              BZCGNB                          WKCGNB
     I              BZILNB                          WKILNB
     I              BZCHNB                          WKCHNB
     I              BZCINB                          WKCINB
     I              BZCJNB                          WKCJNB
     I              BZCMNB                          WKCMNB
     I              BZCNNB                          WKCNNB
     I              BZCRNB                          WKCRNB
     I              BZCSNB                          WKCSNB
     I              BZCVNB                          WKCVNB
     I              BZCWNB                          WKCWNB
     I              BZCXNB                          WKCXNB
     I              BZCZNB                          WKCZNB
     I              BZC0NB                          WKC0NB
     I              BZN1CD                          WKN1CD
     I              BZB4NB                          WKB4NB
     I              BZB5NB                          WKB5NB
     I              BZX5ST                          WKX5ST
     I              BZX6ST                          WKX6ST
     I              BZX7ST                          WKX7ST
     I              BZPCCT                          WKPCCT
     I              BZBDNB                          WKBDNB
     I              BZBJNB                          WKBJNB
     I              BZSUST                          WKSUST
     I              BZSVST                          WKSVST
     I              BZSYST                          WKSYST
     I              BZSZST                          WKSZST
     I              BZS1ST                          WKS1ST
     I              BZXRCD                          WKXRCD
     I              BZXTCD                          WKXTCD
     I              BZXUCD                          WKXUCD
     I              BZF5WG                          WKF5WG
     I              BZF6WG                          WKF6WG
     I              BZF7WG                          WKF7WG
     I              BZBLNB                          WKBLNB
     I              BZBNNB                          WKBNNB
     I              BZS2ST                          WKS2ST
     I              BZS4ST                          WKS4ST
     I              BZS5ST                          WKS5ST
     I              BZS6ST                          WKS6ST
     I              BZS8ST                          WKS8ST
     I              BZS9ST                          WKS9ST
     I              BZTCST                          WKTCST
     I              BZTDST                          WKTDST
     I              BZUVST                          WKUVST
     I              BZUWST                          WKUWST
     I              BZUXST                          WKUXST
     I              BZVSST                          WKVSST
     I              BZAATM                          WKAATM
     I              BZAYNA                          WKAYNA
     I              BZA0NA                          WKA0NA
     I              BZAXDT                          WKAXDT
      *
     I@B0REJX
      * Item Balance              Retrieval index       NV
      * Renamed input format fields
     I              B0AIC3                          WLAIC3
     I              B0HGCD                          WLHGCD
     I              B0AJCD                          WLAJCD
     I              B0AGCS                          WLAGCS
     I              B0AECS                          WLAECS
     I              B0BACS                          WLBACS
     I              B0BBCS                          WLBBCS
     I              B0CBPR                          WLCBPR
     I              B0GUDT                          WLGUDT
     I              B0XYST                          WLXYST
     I              B0CTPR                          WLCTPR
     I              B0G4DT                          WLG4DT
     I              B0BOWG                          WLBOWG
     I              B0DDQT                          WLDDQT
     I              B0DEQT                          WLDEQT
     I              B0DFQT                          WLDFQT
     I              B0HDQT                          WLHDQT
     I              B0HEQT                          WLHEQT
     I              B0AJQT                          WLAJQT
     I              B0AQQT                          WLAQQT
     I              B0AUQT                          WLAUQT
     I              B0EMQT                          WLEMQT
     I              B0DOQT                          WLDOQT
     I              B0ATNA                          WLATNA
     I              B0AKDT                          WLAKDT
     I              B0ANDT                          WLANDT
     I              B0IDVA                          WLIDVA
     I              B0JVST                          WLJVST
     I              B0BZPC                          WLBZPC
     I              B0DGQT                          WLDGQT
     I              B0DIDT                          WLDIDT
     I              B0ALCD                          WLALCD
     I              B0BFDY                          WLBFDY
     I              B0DJDT                          WLDJDT
     I              B0BGDY                          WLBGDY
     I              B0DKDT                          WLDKDT
     I              B0J2ST                          WLJ2ST
     I              B0DJQT                          WLDJQT
     I              B0BNWG                          WLBNWG
     I              B0DLDT                          WLDLDT
     I              B0DPQT                          WLDPQT
     I              B0DQQT                          WLDQQT
     I              B0DMDT                          WLDMDT
     I              B0M0ST                          WLM0ST
     I              B0J9ST                          WLJ9ST
     I              B0KBST                          WLKBST
     I              B0AKC8                          WLAKC8
     I              B0RINB                          WLRINB
     I              B0RHNB                          WLRHNB
     I              B0RGNB                          WLRGNB
     I              B0UVST                          WLUVST
     I              B0UWST                          WLUWST
     I              B0UXST                          WLUXST
     I              B0VSST                          WLVSST
     I              B0AATM                          WLAATM
     I              B0AYNA                          WLAYNA
     I              B0A0NA                          WLA0NA
     I              B0AXDT                          WLAXDT
      *
     I@B7CPZA
      * Item Transaction Detail   Normal KEY Sequence (D)
      * Renamed input format fields
     I              B7AIC3                          WMAIC3
     I              B7HGCD                          WMHGCD
     I              B7AJCD                          WMAJCD
     I              B7W9ST                          WMW9ST
     I              B7BSST                          WMBSST
     I              B7B4DT                          WMB4DT
     I              B7C4NY                          WMC4NY
     I              B7DXNB                          WMDXNB
     I              B7ELDT                          WMELDT
     I              B7HVCD                          WMHVCD
     I              B7F1ST                          WMF1ST
     I              B7AUNA                          WMAUNA
     I              B7A5QT                          WMA5QT
     I              B7AHWG                          WMAHWG
     I              B7AKCS                          WMAKCS
     I              B7CGCD                          WMCGCD
     I              B7AYVA                          WMAYVA
     I              B7BJNA                          WMBJNA
     I              B7CKNB                          WMCKNB
     I              B7BMST                          WMBMST
     I              B7CQCD                          WMCQCD
     I              B7DTCD                          WMDTCD
     I              B7MGNA                          WMMGNA
     I              B7TRBN                          WMTRBN
     I              B7TRBS                          WMTRBS
     I              B7C4NB                          WMC4NB
     I              B7RINB                          WMRINB
     I              B7RHNB                          WMRHNB
     I              B7RGNB                          WMRGNB
     I              B7M3NA                          WMM3NA
     I              B7AWTM                          WMAWTM
     I              B7XLCD                          WMXLCD
     I              B7K7DT                          WMK7DT
     I              B7UVST                          WMUVST
     I              B7UWST                          WMUWST
     I              B7UXST                          WMUXST
     I              B7VSST                          WMVSST
     I              B7AATM                          WMAATM
     I              B7AYNA                          WMAYNA
     I              B7A0NA                          WMA0NA
     I              B7AXDT                          WMAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WOAIC3
     I              B7HGCD                          WOHGCD
     I              B7AJCD                          WOAJCD
     I              B7W9ST                          WOW9ST
     I              B7BSST                          WOBSST
     I              B7B4DT                          WOB4DT
     I              B7C4NY                          WOC4NY
     I              B7DXNB                          WODXNB
     I              B7ELDT                          WOELDT
     I              B7HVCD                          WOHVCD
     I              B7F1ST                          WOF1ST
     I              B7AUNA                          WOAUNA
     I              B7A5QT                          WOA5QT
     I              B7AHWG                          WOAHWG
     I              B7AKCS                          WOAKCS
     I              B7CGCD                          WOCGCD
     I              B7AYVA                          WOAYVA
     I              B7BJNA                          WOBJNA
     I              B7CKNB                          WOCKNB
     I              B7BMST                          WOBMST
     I              B7CQCD                          WOCQCD
     I              B7DTCD                          WODTCD
     I              B7MGNA                          WOMGNA
     I              B7TRBN                          WOTRBN
     I              B7TRBS                          WOTRBS
     I              B7C4NB                          WOC4NB
     I              B7RINB                          WORINB
     I              B7RHNB                          WORHNB
     I              B7RGNB                          WORGNB
     I              B7M3NA                          WOM3NA
     I              B7AWTM                          WOAWTM
     I              B7XLCD                          WOXLCD
     I              B7K7DT                          WOK7DT
     I              B7UVST                          WOUVST
     I              B7UWST                          WOUWST
     I              B7UXST                          WOUXST
     I              B7VSST                          WOVSST
     I              B7AATM                          WOAATM
     I              B7AYNA                          WOAYNA
     I              B7A0NA                          WOA0NA
     I              B7AXDT                          WOAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WRAJCD
     I              ADF8NA                          WRF8NA
     I              ADACNA                          WRACNA
     I              ADADNA                          WRADNA
     I              ADAENA                          WRAENA
     I              ADAJNA                          WRAJNA
     I              ADBTTX                          WRBTTX
     I              ADAOCD                          WRAOCD
     I              ADBGCD                          WRBGCD
     I              ADVHST                          WRVHST
     I              ADMPNA                          WRMPNA
     I              ADWPST                          WRWPST
     I              ADXUST                          WRXUST
     I              ADT0ST                          WRT0ST
     I              ADT1ST                          WRT1ST
     I              ADDBNB                          WRDBNB
     I              ADT2ST                          WRT2ST
     I              ADT3ST                          WRT3ST
     I              ADT4ST                          WRT4ST
     I              ADT6ST                          WRT6ST
     I              ADBWC3                          WRBWC3
     I              ADBTC3                          WRBTC3
     I              ADBUC3                          WRBUC3
     I              ADBVC3                          WRBVC3
     I              ADFCAA                          WRFCAA
     I              ADRQSX                          WRRQSX
     I              ADRRSX                          WRRRSX
     I              ADRSSX                          WRRSSX
     I              ADRTSX                          WRRTSX
     I              ADT7ST                          WRT7ST
     I              ADT8ST                          WRT8ST
     I              ADRNSX                          WRRNSX
     I              ADROSX                          WRROSX
     I              ADRPSX                          WRRPSX
     I              ADUVST                          WRUVST
     I              ADUWST                          WRUWST
     I              ADUXST                          WRUXST
     I              ADVSST                          WRVSST
     I              ADAATM                          WRAATM
     I              ADAYNA                          WRAYNA
     I              ADA0NA                          WRA0NA
     I              ADAXDT                          WRAXDT
      *
     ICAB1RL4
      * Item Balance Detail       Active only
      * Renamed input format fields
     I              B1AIC3                          WSAIC3
     I              B1HGCD                          WSHGCD
     I              B1AJCD                          WSAJCD
     I              B1ELDT                          WSELDT
     I              B1ABWG                          WSABWG
     I              B1AGQT                          WSAGQT
     I              B1AHQT                          WSAHQT
     I              B1AIQT                          WSAIQT
     I              B1CTST                          WSCTST
     I              B1ACWG                          WSACWG
     I              B1ARQT                          WSARQT
     I              B1ASQT                          WSASQT
     I              B1ATQT                          WSATQT
     I              B1HDQT                          WSHDQT
     I              B1HEQT                          WSHEQT
     I              B1F6ST                          WSF6ST
     I              B1BMWG                          WSBMWG
     I              B1DSQT                          WSDSQT
     I              B1DTQT                          WSDTQT
     I              B1DUQT                          WSDUQT
     I              B1DHDT                          WSDHDT
     I              B1AGCS                          WSAGCS
     I              B1AECS                          WSAECS
     I              B1IDVA                          WSIDVA
     I              B1K7DT                          WSK7DT
     I              B1RINB                          WSRINB
     I              B1RHNB                          WSRHNB
     I              B1RGNB                          WSRGNB
     I              B1UVST                          WSUVST
     I              B1UWST                          WSUWST
     I              B1UXST                          WSUXST
     I              B1VSST                          WSVSST
     I              B1AATM                          WSAATM
     I              B1AYNA                          WSAYNA
     I              B1A0NA                          WSA0NA
     I              B1AXDT                          WSAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WTAIC3
     I              B0HGCD                          WTHGCD
     I              B0AJCD                          WTAJCD
     I              B0AGCS                          WTAGCS
     I              B0AECS                          WTAECS
     I              B0BACS                          WTBACS
     I              B0BBCS                          WTBBCS
     I              B0CBPR                          WTCBPR
     I              B0GUDT                          WTGUDT
     I              B0XYST                          WTXYST
     I              B0CTPR                          WTCTPR
     I              B0G4DT                          WTG4DT
     I              B0BOWG                          WTBOWG
     I              B0DDQT                          WTDDQT
     I              B0DEQT                          WTDEQT
     I              B0DFQT                          WTDFQT
     I              B0HDQT                          WTHDQT
     I              B0HEQT                          WTHEQT
     I              B0AJQT                          WTAJQT
     I              B0AQQT                          WTAQQT
     I              B0AUQT                          WTAUQT
     I              B0EMQT                          WTEMQT
     I              B0DOQT                          WTDOQT
     I              B0ATNA                          WTATNA
     I              B0AKDT                          WTAKDT
     I              B0ANDT                          WTANDT
     I              B0IDVA                          WTIDVA
     I              B0JVST                          WTJVST
     I              B0BZPC                          WTBZPC
     I              B0DGQT                          WTDGQT
     I              B0DIDT                          WTDIDT
     I              B0ALCD                          WTALCD
     I              B0BFDY                          WTBFDY
     I              B0DJDT                          WTDJDT
     I              B0BGDY                          WTBGDY
     I              B0DKDT                          WTDKDT
     I              B0J2ST                          WTJ2ST
     I              B0DJQT                          WTDJQT
     I              B0BNWG                          WTBNWG
     I              B0DLDT                          WTDLDT
     I              B0DPQT                          WTDPQT
     I              B0DQQT                          WTDQQT
     I              B0DMDT                          WTDMDT
     I              B0M0ST                          WTM0ST
     I              B0J9ST                          WTJ9ST
     I              B0KBST                          WTKBST
     I              B0AKC8                          WTAKC8
     I              B0RINB                          WTRINB
     I              B0RHNB                          WTRHNB
     I              B0RGNB                          WTRGNB
     I              B0UVST                          WTUVST
     I              B0UWST                          WTUWST
     I              B0UXST                          WTUXST
     I              B0VSST                          WTVSST
     I              B0AATM                          WTAATM
     I              B0AYNA                          WTAYNA
     I              B0A0NA                          WTA0NA
     I              B0AXDT                          WTAXDT
      *
     I@B0REYY
      * Item Balance              Acitve records only
      * Renamed input format fields
     I              B0AIC3                          WVAIC3
     I              B0HGCD                          WVHGCD
     I              B0AJCD                          WVAJCD
     I              B0AGCS                          WVAGCS
     I              B0AECS                          WVAECS
     I              B0BACS                          WVBACS
     I              B0BBCS                          WVBBCS
     I              B0CBPR                          WVCBPR
     I              B0GUDT                          WVGUDT
     I              B0XYST                          WVXYST
     I              B0CTPR                          WVCTPR
     I              B0G4DT                          WVG4DT
     I              B0BOWG                          WVBOWG
     I              B0DDQT                          WVDDQT
     I              B0DEQT                          WVDEQT
     I              B0DFQT                          WVDFQT
     I              B0HDQT                          WVHDQT
     I              B0HEQT                          WVHEQT
     I              B0AJQT                          WVAJQT
     I              B0AQQT                          WVAQQT
     I              B0AUQT                          WVAUQT
     I              B0EMQT                          WVEMQT
     I              B0DOQT                          WVDOQT
     I              B0ATNA                          WVATNA
     I              B0AKDT                          WVAKDT
     I              B0ANDT                          WVANDT
     I              B0IDVA                          WVIDVA
     I              B0JVST                          WVJVST
     I              B0BZPC                          WVBZPC
     I              B0DGQT                          WVDGQT
     I              B0DIDT                          WVDIDT
     I              B0ALCD                          WVALCD
     I              B0BFDY                          WVBFDY
     I              B0DJDT                          WVDJDT
     I              B0BGDY                          WVBGDY
     I              B0DKDT                          WVDKDT
     I              B0J2ST                          WVJ2ST
     I              B0DJQT                          WVDJQT
     I              B0BNWG                          WVBNWG
     I              B0DLDT                          WVDLDT
     I              B0DPQT                          WVDPQT
     I              B0DQQT                          WVDQQT
     I              B0DMDT                          WVDMDT
     I              B0M0ST                          WVM0ST
     I              B0J9ST                          WVJ9ST
     I              B0KBST                          WVKBST
     I              B0AKC8                          WVAKC8
     I              B0RINB                          WVRINB
     I              B0RHNB                          WVRHNB
     I              B0RGNB                          WVRGNB
     I              B0UVST                          WVUVST
     I              B0UWST                          WVUWST
     I              B0UXST                          WVUXST
     I              B0VSST                          WVVSST
     I              B0AATM                          WVAATM
     I              B0AYNA                          WVAYNA
     I              B0A0NA                          WVA0NA
     I              B0AXDT                          WVAXDT
      *
     IRB7CPJ3
      * Item Transaction Detail   Retrieval index       NV
      * Renamed input format fields
     I              B7AIC3                          WWAIC3
     I              B7HGCD                          WWHGCD
     I              B7AJCD                          WWAJCD
     I              B7W9ST                          WWW9ST
     I              B7BSST                          WWBSST
     I              B7B4DT                          WWB4DT
     I              B7C4NY                          WWC4NY
     I              B7DXNB                          WWDXNB
     I              B7ELDT                          WWELDT
     I              B7HVCD                          WWHVCD
     I              B7F1ST                          WWF1ST
     I              B7AUNA                          WWAUNA
     I              B7A5QT                          WWA5QT
     I              B7AHWG                          WWAHWG
     I              B7AKCS                          WWAKCS
     I              B7CGCD                          WWCGCD
     I              B7AYVA                          WWAYVA
     I              B7BJNA                          WWBJNA
     I              B7CKNB                          WWCKNB
     I              B7BMST                          WWBMST
     I              B7CQCD                          WWCQCD
     I              B7DTCD                          WWDTCD
     I              B7MGNA                          WWMGNA
     I              B7TRBN                          WWTRBN
     I              B7TRBS                          WWTRBS
     I              B7C4NB                          WWC4NB
     I              B7RINB                          WWRINB
     I              B7RHNB                          WWRHNB
     I              B7RGNB                          WWRGNB
     I              B7M3NA                          WWM3NA
     I              B7AWTM                          WWAWTM
     I              B7XLCD                          WWXLCD
     I              B7K7DT                          WWK7DT
     I              B7UVST                          WWUVST
     I              B7UWST                          WWUWST
     I              B7UXST                          WWUXST
     I              B7VSST                          WWVSST
     I              B7AATM                          WWAATM
     I              B7AYNA                          WWAYNA
     I              B7A0NA                          WWA0NA
     I              B7AXDT                          WWAXDT
      *
     I@L4RESS
      * Item Hold Reason          Retrieval index
      * Renamed input format fields
     I              L4AIC3                          WXAIC3
     I              L4YSCD                          WXYSCD
     I              L4OMNA                          WXOMNA
     I              L4ISRU                          WXISRU
     I              L4ISRN                          WXISRN
     I              L4UVST                          WXUVST
     I              L4UWST                          WXUWST
     I              L4UXST                          WXUXST
     I              L4VSST                          WXVSST
     I              L4AATM                          WXAATM
     I              L4AYNA                          WXAYNA
     I              L4A0NA                          WXA0NA
     I              L4AXDT                          WXAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WYAJCD
     I              ADF8NA                          WYF8NA
     I              ADACNA                          WYACNA
     I              ADADNA                          WYADNA
     I              ADAENA                          WYAENA
     I              ADAJNA                          WYAJNA
     I              ADBTTX                          WYBTTX
     I              ADAOCD                          WYAOCD
     I              ADBGCD                          WYBGCD
     I              ADVHST                          WYVHST
     I              ADMPNA                          WYMPNA
     I              ADWPST                          WYWPST
     I              ADXUST                          WYXUST
     I              ADT0ST                          WYT0ST
     I              ADT1ST                          WYT1ST
     I              ADDBNB                          WYDBNB
     I              ADT2ST                          WYT2ST
     I              ADT3ST                          WYT3ST
     I              ADT4ST                          WYT4ST
     I              ADT6ST                          WYT6ST
     I              ADBWC3                          WYBWC3
     I              ADBTC3                          WYBTC3
     I              ADBUC3                          WYBUC3
     I              ADBVC3                          WYBVC3
     I              ADFCAA                          WYFCAA
     I              ADRQSX                          WYRQSX
     I              ADRRSX                          WYRRSX
     I              ADRSSX                          WYRSSX
     I              ADRTSX                          WYRTSX
     I              ADT7ST                          WYT7ST
     I              ADT8ST                          WYT8ST
     I              ADRNSX                          WYRNSX
     I              ADROSX                          WYROSX
     I              ADRPSX                          WYRPSX
     I              ADUVST                          WYUVST
     I              ADUWST                          WYUWST
     I              ADUXST                          WYUXST
     I              ADVSST                          WYVSST
     I              ADAATM                          WYAATM
     I              ADAYNA                          WYAYNA
     I              ADA0NA                          WYA0NA
     I              ADAXDT                          WYAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          TAAIC3
     I              ABADTX                          TAADTX
     I              ABACNA                          TAACNA
     I              ABADNA                          TAADNA
     I              ABAENA                          TAAENA
     I              ABAJNA                          TAAJNA
     I              ABBTTX                          TABTTX
     I              ABBVTX                          TABVTX
     I              ABBWTX                          TABWTX
     I              ABA2NA                          TAA2NA
     I              ABABTX                          TAABTX
     I              ABBGCD                          TABGCD
     I              ABKXCD                          TAKXCD
     I              ABUVST                          TAUVST
     I              ABUWST                          TAUWST
     I              ABUXST                          TAUXST
     I              ABVSST                          TAVSST
     I              ABAATM                          TAAATM
     I              ABAYNA                          TAAYNA
     I              ABA0NA                          TAA0NA
     I              ABAXDT                          TAAXDT
      *
     I@BYREA1
      * Item Default              Retrieval index
      * Renamed input format fields
     I              BYHGCD                          TBHGCD
     I              BYAVNA                          TBAVNA
     I              BYAWNA                          TBAWNA
     I              BYL7NA                          TBL7NA
     I              BYL8NA                          TBL8NA
     I              BYL6NA                          TBL6NA
     I              BYMFNA                          TBMFNA
     I              BYHHCD                          TBHHCD
     I              BYAWPC                          TBAWPC
     I              BYLXST                          TBLXST
     I              BYLGCD                          TBLGCD
     I              BYAXPC                          TBAXPC
     I              BYLYST                          TBLYST
     I              BYLHCD                          TBLHCD
     I              BYLICD                          TBLICD
     I              BYAIWG                          TBAIWG
     I              BYHICD                          TBHICD
     I              BYRBCD                          TBRBCD
     I              BYFZST                          TBFZST
     I              BYAVST                          TBAVST
     I              BYCZWG                          TBCZWG
     I              BYC0WG                          TBC0WG
     I              BYURTN                          TBURTN
     I              BYACC8                          TBACC8
     I              BYRINB                          TBRINB
     I              BYRHNB                          TBRHNB
     I              BYRGNB                          TBRGNB
     I              BYLNCD                          TBLNCD
     I              BYTFNB                          TBTFNB
     I              BYN0CD                          TBN0CD
     I              BYX4ST                          TBX4ST
     I              BYCHTM                          TBCHTM
     I              BYQZCD                          TBQZCD
     I              BYXWST                          TBXWST
     I              BYXXST                          TBXXST
     I              BYVMST                          TBVMST
     I              BYSWGH                          TBSWGH
     I              BYPPHE                          TBPPHE
     I              BYLRCD                          TBLRCD
     I              BYSFNB                          TBSFNB
     I              BYA3WG                          TBA3WG
     I              BYSJNB                          TBSJNB
     I              BYLLCD                          TBLLCD
     I              BYLMCD                          TBLMCD
     I              BYP3ST                          TBP3ST
     I              BYSKNB                          TBSKNB
     I              BYSLNB                          TBSLNB
     I              BYSMNB                          TBSMNB
     I              BYP4ST                          TBP4ST
     I              BYCFNB                          TBCFNB
     I              BYCGNB                          TBCGNB
     I              BYILNB                          TBILNB
     I              BYCHNB                          TBCHNB
     I              BYCINB                          TBCINB
     I              BYCJNB                          TBCJNB
     I              BYCMNB                          TBCMNB
     I              BYCNNB                          TBCNNB
     I              BYCRNB                          TBCRNB
     I              BYCSNB                          TBCSNB
     I              BYCVNB                          TBCVNB
     I              BYCWNB                          TBCWNB
     I              BYCXNB                          TBCXNB
     I              BYCZNB                          TBCZNB
     I              BYC0NB                          TBC0NB
     I              BYN1CD                          TBN1CD
     I              BYB4NB                          TBB4NB
     I              BYX5ST                          TBX5ST
     I              BYX6ST                          TBX6ST
     I              BYX7ST                          TBX7ST
     I              BYTMVA                          TBTMVA
     I              BYTNVA                          TBTNVA
     I              BYBLPR                          TBBLPR
     I              BYBMPR                          TBBMPR
     I              BYU9ST                          TBU9ST
     I              BYCMCO                          TBCMCO
     I              BYQ1CD                          TBQ1CD
     I              BYAIC3                          TBAIC3
     I              BYQ8CD                          TBQ8CD
     I              BYR3CD                          TBR3CD
     I              BYSDCD                          TBSDCD
     I              BYICN1                          TBICN1
     I              BYSVCD                          TBSVCD
     I              BYICN2                          TBICN2
     I              BYSWCD                          TBSWCD
     I              BYV2NB                          TBV2NB
     I              BYSXCD                          TBSXCD
     I              BYITCN                          TBITCN
     I              BYSYCD                          TBSYCD
     I              BYITC5                          TBITC5
     I              BYSZCD                          TBSZCD
     I              BYICN6                          TBICN6
     I              BYS0CD                          TBS0CD
     I              BYICN7                          TBICN7
     I              BYS1CD                          TBS1CD
     I              BYICN8                          TBICN8
     I              BYS2CD                          TBS2CD
     I              BYICN9                          TBICN9
     I              BYS3CD                          TBS3CD
     I              BYICN0                          TBICN0
     I              BYS4CD                          TBS4CD
     I              BYB5NB                          TBB5NB
     I              BYXRCD                          TBXRCD
     I              BYPCCT                          TBPCCT
     I              BYBDNB                          TBBDNB
     I              BYBJNB                          TBBJNB
     I              BYSUST                          TBSUST
     I              BYSVST                          TBSVST
     I              BYSYST                          TBSYST
     I              BYSZST                          TBSZST
     I              BYS1ST                          TBS1ST
     I              BYXTCD                          TBXTCD
     I              BYXUCD                          TBXUCD
     I              BYF5WG                          TBF5WG
     I              BYF6WG                          TBF6WG
     I              BYF7WG                          TBF7WG
     I              BYBLNB                          TBBLNB
     I              BYBNNB                          TBBNNB
     I              BYS2ST                          TBS2ST
     I              BYS4ST                          TBS4ST
     I              BYS5ST                          TBS5ST
     I              BYS6ST                          TBS6ST
     I              BYS8ST                          TBS8ST
     I              BYS9ST                          TBS9ST
     I              BYTCST                          TBTCST
     I              BYTDST                          TBTDST
     I              BYUVST                          TBUVST
     I              BYUWST                          TBUWST
     I              BYUXST                          TBUXST
     I              BYVSST                          TBVSST
     I              BYAHTM                          TBAHTM
     I              BYBEVN                          TBBEVN
     I              BYBFVN                          TBBFVN
     I              BYEKDT                          TBEKDT
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          TCAJVN
     I              DRAUNA                          TCAUNA
     I              DRB8NA                          TCB8NA
     I              DRAHVN                          TCAHVN
     I              DRI6ST                          TCI6ST
     I              DRI7ST                          TCI7ST
     I              DRXMST                          TCXMST
     I              DRXNST                          TCXNST
     I              DRI8ST                          TCI8ST
     I              DRNLNB                          TCNLNB
     I              DRMPNA                          TCMPNA
     I              DRBCCD                          TCBCCD
     I              DRAIC3                          TCAIC3
     I              DRDQCD                          TCDQCD
     I              DRDRCD                          TCDRCD
     I              DRAJCD                          TCAJCD
     I              DRBUVN                          TCBUVN
     I              DRUVST                          TCUVST
     I              DRUWST                          TCUWST
     I              DRUXST                          TCUXST
     I              DRAATM                          TCAATM
     I              DRAYNA                          TCAYNA
     I              DRA0NA                          TCA0NA
     I              DRAXDT                          TCAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          TDAJVN
     I              DTDNCD                          TDDNCD
     I              DTAIC3                          TDAIC3
     I              DTDQCD                          TDDQCD
     I              DTDRCD                          TDDRCD
     I              DTAJCD                          TDAJCD
     I              DTJFST                          TDJFST
     I              DTUVST                          TDUVST
     I              DTUWST                          TDUWST
     I              DTUXST                          TDUXST
     I              DTAATM                          TDAATM
     I              DTAYNA                          TDAYNA
     I              DTA0NA                          TDA0NA
     I              DTAXDT                          TDAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          TEDNCD
     I              DNAUNA                          TEAUNA
     I              DNVKST                          TEVKST
     I              DNRSCD                          TERSCD
     I              DNUVST                          TEUVST
     I              DNUWST                          TEUWST
     I              DNUXST                          TEUXST
     I              DNAATM                          TEAATM
     I              DNAYNA                          TEAYNA
     I              DNA0NA                          TEA0NA
     I              DNAXDT                          TEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQPDL71    E DSPDL7CPL0
      * UPD : Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WBAIC3
     I              L7HGCD                          WBHGCD
     I              L7AJCD                          WBAJCD
     I              L7LTRT                          WBLTRT
     I              L7LRDT                          WBLRDT
     I              L7LLTS                          WBLLTS
     I              L7LSDT                          WBLSDT
     I              L7J5QT                          WBJ5QT
     I              L7G8WG                          WBG8WG
     I              L7LLTN                          WBLLTN
     I              L7YMCD                          WBYMCD
     I              L7LLCL                          WBLLCL
     I              L7BNAA                          WBBNAA
     I              L7LLTR                          WBLLTR
     I              L7Y2CD                          WBY2CD
     I              L7LLTL                          WBLLTL
     I              L7C4NB                          WBC4NB
     I              L7LOST                          WBLOST
     I              L7LLTU                          WBLLTU
     I              L7LLYT                          WBLLYT
     I              L7UVST                          WBUVST
     I              L7UWST                          WBUWST
     I              L7UXST                          WBUXST
     I              L7VSST                          WBVSST
     I              L7AATM                          WBAATM
     I              L7AYNA                          WBAYNA
     I              L7A0NA                          WBA0NA
     I              L7AXDT                          WBAXDT
      *
     IQPDL51    E DSPDL5CPL0
      * UPD : Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WDAIC3
     I              L5HGCD                          WDHGCD
     I              L5AJCD                          WDAJCD
     I              L5ELDT                          WDELDT
     I              L5LXNM                          WDLXNM
     I              L5YMCD                          WDYMCD
     I              L5YNCD                          WDYNCD
     I              L5J2QT                          WDJ2QT
     I              L5G5WG                          WDG5WG
     I              L5J3QT                          WDJ3QT
     I              L5G6WG                          WDG6WG
     I              L5J4QT                          WDJ4QT
     I              L5G7WG                          WDG7WG
     I              L5LODT                          WDLODT
     I              L5LPDT                          WDLPDT
     I              L5LQDT                          WDLQDT
     I              L5NBR                           WDNBR
     I              L5YTCD                          WDYTCD
     I              L5AMSX                          WDAMSX
     I              L5ASSX                          WDASSX
     I              L5ATSX                          WDATSX
     I              L5AUSX                          WDAUSX
     I              L5YSCD                          WDYSCD
     I              L5UVST                          WDUVST
     I              L5UWST                          WDUWST
     I              L5UXST                          WDUXST
     I              L5VSST                          WDVSST
     I              L5AATM                          WDAATM
     I              L5AYNA                          WDAYNA
     I              L5A0NA                          WDA0NA
     I              L5AXDT                          WDAXDT
      *
     IYARDCS      DS                            111
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WFAIC3
     I              B1HGCD                          WFHGCD
     I              B1AJCD                          WFAJCD
     I              B1ELDT                          WFELDT
     I              B1ABWG                          WFABWG
     I              B1AGQT                          WFAGQT
     I              B1AHQT                          WFAHQT
     I              B1AIQT                          WFAIQT
     I              B1CTST                          WFCTST
     I              B1ACWG                          WFACWG
     I              B1ARQT                          WFARQT
     I              B1ASQT                          WFASQT
     I              B1ATQT                          WFATQT
     I              B1HDQT                          WFHDQT
     I              B1HEQT                          WFHEQT
     I              B1F6ST                          WFF6ST
     I              B1BMWG                          WFBMWG
     I              B1DSQT                          WFDSQT
     I              B1DTQT                          WFDTQT
     I              B1DUQT                          WFDUQT
     I              B1DHDT                          WFDHDT
     I              B1AGCS                          WFAGCS
     I              B1AECS                          WFAECS
     I              B1IDVA                          WFIDVA
     I              B1K7DT                          WFK7DT
     I              B1RINB                          WFRINB
     I              B1RHNB                          WFRHNB
     I              B1RGNB                          WFRGNB
     I              B1UVST                          WFUVST
     I              B1UWST                          WFUWST
     I              B1UXST                          WFUXST
     I              B1VSST                          WFVSST
     I              B1AATM                          WFAATM
     I              B1AYNA                          WFAYNA
     I              B1A0NA                          WFA0NA
     I              B1AXDT                          WFAXDT
      *
     IQPDL21    E DSPDL2REL1
      * UPD : Warehouse Location        Update index
      * Renamed input format fields
     I              L2AJCD                          WHAJCD
     I              L2YMCD                          WHYMCD
     I              L2YPCD                          WHYPCD
     I              L2LCBY                          WHLCBY
     I              L2LCCT                          WHLCCT
     I              L2WLUS                          WHWLUS
     I              L2WUSD                          WHWUSD
     I              L2WLUN                          WHWLUN
     I              L2AGSX                          WHAGSX
     I              L2UVST                          WHUVST
     I              L2UWST                          WHUWST
     I              L2UXST                          WHUXST
     I              L2VSST                          WHVSST
     I              L2AATM                          WHAATM
     I              L2AYNA                          WHAYNA
     I              L2A0NA                          WHA0NA
     I              L2AXDT                          WHAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQCAAS1    E DSCAASREL0
      * UPD : Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WJAIC3
     I              ASAXNB                          WJAXNB
     I              ASNGNB                          WJNGNB
     I              ASBZNB                          WJBZNB
     I              ASC5NB                          WJC5NB
     I              ASC3NB                          WJC3NB
     I              ASCYNB                          WJCYNB
     I              ASIONB                          WJIONB
     I              ASI6NB                          WJI6NB
     I              ASDCNB                          WJDCNB
     I              ASC7NB                          WJC7NB
     I              ASC2NB                          WJC2NB
     I              ASC1NB                          WJC1NB
     I              ASL8NB                          WJL8NB
     I              ASBANB                          WJBANB
     I              ASCHST                          WJCHST
     I              ASCKST                          WJCKST
     I              ASCIST                          WJCIST
     I              ASCGST                          WJCGST
     I              ASAIPC                          WJAIPC
     I              ASASPC                          WJASPC
     I              ASA2VA                          WJA2VA
     I              ASC2ST                          WJC2ST
     I              ASD8ST                          WJD8ST
     I              ASD7ST                          WJD7ST
     I              ASA8NA                          WJA8NA
     I              ASA9NA                          WJA9NA
     I              ASBANA                          WJBANA
     I              ASBBNA                          WJBBNA
     I              ASEUST                          WJEUST
     I              ASAADY                          WJAADY
     I              ASABDY                          WJABDY
     I              ASACDY                          WJACDY
     I              ASADDY                          WJADDY
     I              ASAEDY                          WJAEDY
     I              ASAFDY                          WJAFDY
     I              ASAGDY                          WJAGDY
     I              ASAHDY                          WJAHDY
     I              ASAENB                          WJAENB
     I              ASALNB                          WJALNB
     I              ASEVNB                          WJEVNB
     I              ASRPOP                          WJRPOP
     I              ASDWNB                          WJDWNB
     I              ASR3NB                          WJR3NB
     I              ASPNST                          WJPNST
     I              ASR4NB                          WJR4NB
     I              ASPOST                          WJPOST
     I              ASSCNB                          WJSCNB
     I              ASVIST                          WJVIST
     I              ASVJST                          WJVJST
     I              ASBVVN                          WJBVVN
     I              ASUVST                          WJUVST
     I              ASUWST                          WJUWST
     I              ASUXST                          WJUXST
     I              ASVSST                          WJVSST
     I              ASAATM                          WJAATM
     I              ASAYNA                          WJAYNA
     I              ASA0NA                          WJA0NA
     I              ASAXDT                          WJAXDT
      *
     IYBRDCS      DS                            278
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WOAIC3
     I              B7HGCD                          WOHGCD
     I              B7AJCD                          WOAJCD
     I              B7W9ST                          WOW9ST
     I              B7BSST                          WOBSST
     I              B7B4DT                          WOB4DT
     I              B7C4NY                          WOC4NY
     I              B7DXNB                          WODXNB
     I              B7ELDT                          WOELDT
     I              B7HVCD                          WOHVCD
     I              B7F1ST                          WOF1ST
     I              B7AUNA                          WOAUNA
     I              B7A5QT                          WOA5QT
     I              B7AHWG                          WOAHWG
     I              B7AKCS                          WOAKCS
     I              B7CGCD                          WOCGCD
     I              B7AYVA                          WOAYVA
     I              B7BJNA                          WOBJNA
     I              B7CKNB                          WOCKNB
     I              B7BMST                          WOBMST
     I              B7CQCD                          WOCQCD
     I              B7DTCD                          WODTCD
     I              B7MGNA                          WOMGNA
     I              B7TRBN                          WOTRBN
     I              B7TRBS                          WOTRBS
     I              B7C4NB                          WOC4NB
     I              B7RINB                          WORINB
     I              B7RHNB                          WORHNB
     I              B7RGNB                          WORGNB
     I              B7M3NA                          WOM3NA
     I              B7AWTM                          WOAWTM
     I              B7XLCD                          WOXLCD
     I              B7K7DT                          WOK7DT
     I              B7UVST                          WOUVST
     I              B7UWST                          WOUWST
     I              B7UXST                          WOUXST
     I              B7VSST                          WOVSST
     I              B7AATM                          WOAATM
     I              B7AYNA                          WOAYNA
     I              B7A0NA                          WOA0NA
     I              B7AXDT                          WOAXDT
      *
     IYCRDCS      DS                            163
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WTAIC3
     I              B0HGCD                          WTHGCD
     I              B0AJCD                          WTAJCD
     I              B0AGCS                          WTAGCS
     I              B0AECS                          WTAECS
     I              B0BACS                          WTBACS
     I              B0BBCS                          WTBBCS
     I              B0CBPR                          WTCBPR
     I              B0GUDT                          WTGUDT
     I              B0XYST                          WTXYST
     I              B0CTPR                          WTCTPR
     I              B0G4DT                          WTG4DT
     I              B0BOWG                          WTBOWG
     I              B0DDQT                          WTDDQT
     I              B0DEQT                          WTDEQT
     I              B0DFQT                          WTDFQT
     I              B0HDQT                          WTHDQT
     I              B0HEQT                          WTHEQT
     I              B0AJQT                          WTAJQT
     I              B0AQQT                          WTAQQT
     I              B0AUQT                          WTAUQT
     I              B0EMQT                          WTEMQT
     I              B0DOQT                          WTDOQT
     I              B0ATNA                          WTATNA
     I              B0AKDT                          WTAKDT
     I              B0ANDT                          WTANDT
     I              B0IDVA                          WTIDVA
     I              B0JVST                          WTJVST
     I              B0BZPC                          WTBZPC
     I              B0DGQT                          WTDGQT
     I              B0DIDT                          WTDIDT
     I              B0ALCD                          WTALCD
     I              B0BFDY                          WTBFDY
     I              B0DJDT                          WTDJDT
     I              B0BGDY                          WTBGDY
     I              B0DKDT                          WTDKDT
     I              B0J2ST                          WTJ2ST
     I              B0DJQT                          WTDJQT
     I              B0BNWG                          WTBNWG
     I              B0DLDT                          WTDLDT
     I              B0DPQT                          WTDPQT
     I              B0DQQT                          WTDQQT
     I              B0DMDT                          WTDMDT
     I              B0M0ST                          WTM0ST
     I              B0J9ST                          WTJ9ST
     I              B0KBST                          WTKBST
     I              B0AKC8                          WTAKC8
     I              B0RINB                          WTRINB
     I              B0RHNB                          WTRHNB
     I              B0RGNB                          WTRGNB
     I              B0UVST                          WTUVST
     I              B0UWST                          WTUWST
     I              B0UXST                          WTUXST
     I              B0VSST                          WTVSST
     I              B0AATM                          WTAATM
     I              B0AYNA                          WTAYNA
     I              B0A0NA                          WTA0NA
     I              B0AXDT                          WTAXDT
      *
     IYDRDCS      DS                            245
     IYERDCS      DS                            245
     IYFRDCS      DS                            163
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Item Lot Location
      * I : MAP Company Number
     I                                    P   1   20P1AIC3
      * I : MAP Item Code
     I                                    P   3   60P1HGCD
      * I : MAP Warehouse Code
     I                                        7   9 P1AJCD
      * I : MAP Production Date
     I                                    P  10  130P1ELDT
      * I : MAP Lot Number
     I                                    P  14  160P1LXNM
      * I : MAP Location Code
     I                                       17  20 P1YMCD
      * I : MAP Location Level
     I                                    P  21  220P1YNCD
      * I : MAP ILL Item Qty On-Hand
     I                                    P  23  250P1J2QT
      * I : MAP ILL Unit Weight
     I                                    P  26  312P1G5WG
      * I : MAP ILL Avail Ship Date
     I                                    P  32  350P1LODT
      * I : MAP ILL Status
     I                                       36  36 P1AMSX
      * I : MAP Inv Hold Reason Code
     I                                       37  39 P1YSCD
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Enterprise Code 1
     I                                        1   4 P2DQCD
      * N :  Enterprise Code 2
     I                                        5  16 P2DRCD
      * N :  Salesperson Code
     I                                       17  19 P2BCCD
      * N :  System Date Format
     I                                       20  22 P2B8NA
      * N :  User Profile Name
     I                                       23  32 P2AJVN
      * N :  Allow Multi-Company
     I                                       33  33 P2I6ST
      * N :  Allow Multi Warehouse
     I                                       34  34 P2I8ST
      * N :  Default Printer
     I                                       35  44 P2MPNA
      * N :  First Time Flag
     I                                       45  45 P2TAST
      * N :  Name
     I                                       46  75 P2ADTX
      * N :  System Value Alpha
     I                                       76 115 P2BXTX
      * N :  Access Denied (Y/N)
     I                                      116 116 P2WVST
      * N :  Requested Delivery Date
     I                                    P 117 1200P2EIDT
     IP3PARM      DS
      * N :  Record Found USR
     I                                        1   1 P3WXST
     IP4PARM      DS
      * N :  Record Found -PS CD USR
     I                                        1   1 P4VYST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Warehouse Loc DNE'
      * Warehouse Code
     I                                        1   3 ZA0001
      * Location Code
     I                                        4   7 ZA0002
      * Message data for 'Level Invalid'
      * Location Level
     I                                    P   1   20ZA0003
      * Message data for 'Trns Qty GT On Hand'
      * LLT Trans Qty
     I                                    P   1   30ZA0004
      * ILL Item Qty On-Hand
     I                                    P   4   60ZA0005
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0006
      * Application Code
     I                                       11  16 ZA0007
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0008
      * Application Code
     I                                       11  16 ZA0009
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1HGCD    PARM           WP0002  70       Item Code
     C           P1AJCD    PARM           WP0003  3        Warehouse Code
     C           P1ELDT    PARM           WP0004  70       Production Date
     C           P1LXNM    PARM           WP0005  50       Lot Number
     C           P1YMCD    PARM           WP0006  4        Location Code
     C           P1YNCD    PARM           WP0007  20       Location Level
     C           P1J2QT    PARM           WP0008  50       ILL Item Qty On
     C           P1G5WG    PARM           WP0009 112       ILL Unit Weight
     C           P1LODT    PARM           WP0010  70       ILL Avail Ship
     C           P1AMSX    PARM           WP0011  1        ILL Status
     C           P1YSCD    PARM           WP0012  3        Inv Hold Reason
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      *
     C                     Z-ADD*ZERO     WN0001  70       Quantity Loc Tr
     C                     Z-ADD*ZERO     WN0002  70       Avail Ship Date
      *
      * Relocate Item         IF
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * Update From Lot/Location
     C           #DJ5QT    MULT -1        WN0001           Quantity Loc Tr
      *
     C                     Z-ADD*ZERO     WN0003  30       LLT Sequence #
     C                     MOVEL*BLANK    WN0004  1        EDI Status 1
     C                     MOVEL*BLANK    WN0005  1        EDI Status 2
     C                     MOVEL*BLANK    WN0006  1        EDI Status 3
     C                     MOVEL*BLANK    WN0007  1        Record Status
     C                     Z-ADD*ZERO     WN0008  60       Job Time
     C                     MOVEL*BLANK    WN0009 10        User Id
     C                     MOVEL*BLANK    WN0010 10        Job Name
     C                     Z-ADD*ZERO     WN0011  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1HGCD    WL0002           Item Code
     C                     MOVEL#1AJCD    WL0003    P      Warehouse Code
     C                     MOVEL'T'       WL0004    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0005           LLT Trans Date
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    WN0003           LLT Sequence #
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0007           Company Number
     C                     Z-ADD#1HGCD    WL0008           Item Code
     C                     MOVEL#1AJCD    WL0009    P      Warehouse Code
     C                     MOVEL'T'       WL0010    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0011           LLT Trans Date
     C                     Z-ADDWN0003    WL0012           LLT Sequence #
     C                     Z-ADD#1ELDT    WL0013           LLT Production
     C                     Z-ADDWN0001    WL0014           LLT Trans Qty
     C                     Z-ADD*ZERO     WL0015           LLT Trans Wgt
     C                     Z-ADD#1LXNM    WL0016           LLT Lot Number
     C                     MOVEL#1YMCD    WL0017    P      Location Code
     C                     Z-ADD#1YNCD    WL0018           LLT Location Le
     C                     MOVEL#DBNAA    WL0019    P      Transfer Wareho
     C                     Z-ADD#1LXNM    WL0020           LLT Transfer Lo
     C                     MOVEL#DYVCD    WL0021    P      Transfer Locati
     C                     Z-ADD#DSXTX    WL0022           LLT Transfer Lo
     C                     Z-ADD*ZERO     WL0023           Order Number
     C                     MOVEL'P'       WL0024    P      LLT Status
     C                     MOVELWULLTU    WL0025    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0026    P      LTT Unused Sts
     C                     MOVELWN0004    WL0027    P      EDI Status 1
     C                     MOVELWN0005    WL0028    P      EDI Status 2
     C                     MOVELWN0006    WL0029    P      EDI Status 3
     C                     MOVELWN0007    WL0030    P      Record Status
     C                     Z-ADDWN0008    WL0031           Job Time
     C                     MOVELWN0009    WL0032    P      User Id
     C                     MOVELWN0010    WL0033    P      Job Name
     C                     Z-ADDWN0011    WL0034           Job Date
     C                     EXSR SBCRRC
      * Upd ReLoc Qty On-Hand RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0035           Company Number
     C                     Z-ADD#1HGCD    WL0036           Item Code
     C                     MOVEL#1AJCD    WL0037    P      Warehouse Code
     C                     Z-ADD#1ELDT    WL0038           Production Date
     C                     Z-ADD#1LXNM    WL0039           Lot Number
     C                     MOVEL#1YMCD    WL0040    P      Location Code
     C                     Z-ADD#1YNCD    WL0041           Location Level
     C                     Z-ADD#1G5WG    WL0042           ILL Unit Weight
     C                     Z-ADD#1LODT    WL0043           ILL Avail Ship
     C                     Z-ADD#1LPDT    WL0044           ILL Unused Date
     C                     MOVEL#1AMSX    WL0045    P      ILL Status
     C                     MOVEL#1YSCD    WL0046    P      Inv Hold Reason
     C                     Z-ADDWN0001    WL0047           Quantity Loc Tr
     C                     EXSR SCRVGN
      * Create To Lot/Location
      * Val Location Exists   RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBNAA    WL0067    P      Warehouse Code
     C                     MOVEL#DYVCD    WL0068    P      Location Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0069    YL0001    P      Record Found -P
      * Create Warehouse Location if one does not exist.
      * CASE: LCL.Record Found -PS CD USR is Record Not Found
     C           YL0001    IFEQ 'N'                        *IF
     C                     Z-ADD1         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST#DYVCD:ZQ YL0002    P  90  Location Aisle
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST#DYVCD:ZQ YL0003    P  90  Location Bay Al
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0003    YL0004           Location Bay
      * Crt Whs Location      CR - Warehouse Location  * 
     C                     EXSR SJCRRC
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0055  1        WLT Type Code
     C                     Z-ADD*ZERO     WN0056  52       WLT Type Chill
      *
      * Clc Loc Avail Shp Dte IF
      * Rtv Loc Type          RT - Warehouse Location  * 
     C                     EXSR SKRVGN
      * Rtv Chill Time        RT - Warehouse Location Type  * 
     C                     EXSR SLRVGN
      * PAR.ILL Avail Ship Date = PAR.Production Date + PAR.WLT Type Chil
     C           #1ELDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0056    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL@CN,001   XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0002
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0002
     C                     END
      * To Location Available Ship Date
      * CASE: PAR.Avail Ship Date USR LT PAR.ILL Avail Ship Date
     C           WN0002    IFLT #1LODT                     *IF
     C                     Z-ADDWN0002    #1LODT           ILL Avail Ship
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0057  30       LLT Sequence #
     C                     MOVEL*BLANK    WN0058  1        EDI Status 1
     C                     MOVEL*BLANK    WN0059  1        EDI Status 2
     C                     MOVEL*BLANK    WN0060  1        EDI Status 3
     C                     MOVEL*BLANK    WN0061  1        Record Status
     C                     Z-ADD*ZERO     WN0062  60       Job Time
     C                     MOVEL*BLANK    WN0063 10        User Id
     C                     MOVEL*BLANK    WN0064 10        Job Name
     C                     Z-ADD*ZERO     WN0065  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1HGCD    WL0002           Item Code
     C                     MOVEL#DBNAA    WL0003    P      Warehouse Code
     C                     MOVEL'RT'      WL0004    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0005           LLT Trans Date
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    WN0057           LLT Sequence #
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0007           Company Number
     C                     Z-ADD#1HGCD    WL0008           Item Code
     C                     MOVEL#DBNAA    WL0009    P      Warehouse Code
     C                     MOVEL'RT'      WL0010    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0011           LLT Trans Date
     C                     Z-ADDWN0057    WL0012           LLT Sequence #
     C                     Z-ADD#1ELDT    WL0013           LLT Production
     C                     Z-ADD#DJ5QT    WL0014           LLT Trans Qty
     C                     Z-ADD*ZERO     WL0015           LLT Trans Wgt
     C                     Z-ADD#1LXNM    WL0016           LLT Lot Number
     C                     MOVEL#DYVCD    WL0017    P      Location Code
     C                     Z-ADD#DSXTX    WL0018           LLT Location Le
     C                     MOVEL#1AJCD    WL0019    P      Transfer Wareho
     C                     Z-ADD#1LXNM    WL0020           LLT Transfer Lo
     C                     MOVEL#1YMCD    WL0021    P      Transfer Locati
     C                     Z-ADD#1YNCD    WL0022           LLT Transfer Lo
     C                     Z-ADD*ZERO     WL0023           Order Number
     C                     MOVEL'P'       WL0024    P      LLT Status
     C                     MOVELWULLTU    WL0025    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0026    P      LTT Unused Sts
     C                     MOVELWN0058    WL0027    P      EDI Status 1
     C                     MOVELWN0059    WL0028    P      EDI Status 2
     C                     MOVELWN0060    WL0029    P      EDI Status 3
     C                     MOVELWN0061    WL0030    P      Record Status
     C                     Z-ADDWN0062    WL0031           Job Time
     C                     MOVELWN0063    WL0032    P      User Id
     C                     MOVELWN0064    WL0033    P      Job Name
     C                     Z-ADDWN0065    WL0034           Job Date
     C                     EXSR SBCRRC
      * Upd ReLoc Qty On-Hand RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0035           Company Number
     C                     Z-ADD#1HGCD    WL0036           Item Code
     C                     MOVEL#DBNAA    WL0037    P      Warehouse Code
     C                     Z-ADD#1ELDT    WL0038           Production Date
     C                     Z-ADD#1LXNM    WL0039           Lot Number
     C                     MOVEL#DYVCD    WL0040    P      Location Code
     C                     Z-ADD#DSXTX    WL0041           Location Level
     C                     Z-ADD#1G5WG    WL0042           ILL Unit Weight
     C                     Z-ADD#1LODT    WL0043           ILL Avail Ship
     C                     Z-ADD#1LPDT    WL0044           ILL Unused Date
     C                     MOVEL#1AMSX    WL0045    P      ILL Status
     C                     MOVEL#1YSCD    WL0046    P      Inv Hold Reason
     C                     Z-ADD#DJ5QT    WL0047           Quantity Loc Tr
     C                     EXSR SCRVGN
      * ** Process Auto-Locate Whse inventory added       FP1127
      * Transfer Item Balance/Item Balance Detail.
      * CASE: PAR.Reloc/Trans STS USR is Transfer
     C           'T'       IFEQ 'T'                        *IF
      * RTV Next Tran Batch #  CH - Company Control  * 
     C                     EXSR SMCHRC
     C                     Z-ADD#DJ5QT    YL0006           Transaction Qua
      * RTV Label Date         RT - Item Balance Detail  * 
     C                     EXSR SNRVGN
      * Rtv Base Values        RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0070           Company Number
     C                     Z-ADD#1HGCD    WL0071           Item Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0072    YL0008    P      Description Lin
     C                     MOVELWL0073    YL0009    P      Description Lin
     C                     MOVELWL0074    YL0010    P      U/M - Primary
     C                     Z-ADDWL0075    YL0011           Conversion Fact
     C                     MOVELWL0076    YL0012    P      Operation Facto
     C                     MOVELWL0077    YL0013    P      U/M - Second
     C                     Z-ADDWL0078    YL0014           Conversion Fact
     C                     MOVELWL0079    YL0015    P      Operation Facto
     C                     MOVELWL0080    YL0016    P      U/M - Third
     C                     MOVELWL0081    YL0017    P      U/M - Pricing
     C                     Z-ADDWL0082    YL0018           Unit Weight
     C                     MOVELWL0083    YL0019    P      Production Date
     C                     MOVELWL0084    YL0020    P      Catch Weight St
     C                     Z-ADDWL0085    YL0021           Fresh Chilling
      * Clc Convert Weight     XF
     C                     Z-ADD*ZERO     YL0023           USR Weight base
     C                     Z-ADD*ZERO     YL0024           USR Weight base
     C                     Z-ADD*ZERO     YL0025           USR Weight base
     C                     Z-ADDYL0018    YL0023           USR Weight base
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           YL0013    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           YL0012    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           YL0011    IFNE *ZERO                      *IF
     C           YL0018    DIV  YL0011    WUASWG    H      USR Weight
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           YL0012    IFEQ 'D'                        *IF
     C           YL0018    MULT YL0011    WUASWG    H      USR Weight
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUASWG    YL0024           USR Weight base
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           YL0016    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           YL0015    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           YL0014    IFNE *ZERO                      *IF
     C           WUASWG    DIV  YL0014    YL0025    H      USR Weight base
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           YL0015    IFEQ 'D'                        *IF
     C           WUASWG    MULT YL0014    YL0025    H      USR Weight base
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0006    MULT YL0023    YL0026    H      Transaction Wei
      * Rtv Status/Default     RT - Item Balance  * From Warehouse
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0086           Company Number
     C                     Z-ADD#1HGCD    WL0087           Item Code
     C                     MOVEL#1AJCD    WL0088    P      Warehouse Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0089    YL0027           Unit Cost Per P
     C                     MOVELWL0090    YL0028    P      Cost Update Pen
     C                     MOVELWL0091    YL0029    P      Post G/L Status
     C                     Z-ADDWL0092    YL0030           Vendor - Item/W
     C                     MOVELWL0093    YL0031    P      Record Status
      * Rtv Status/Default     RT - Item Balance  * To Warehouse
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0086           Company Number
     C                     Z-ADD#1HGCD    WL0087           Item Code
     C                     MOVEL#DBNAA    WL0088    P      Warehouse Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0089    YL0032           Unit Cost Per P
     C                     MOVELWL0090    WUG0TX    P      Cost Update Pen
     C                     MOVELWL0091    WUG0TX    P      Post G/L Status
     C                     Z-ADDWL0092    WUNFNN           Vendor - Item/W
     C                     MOVELWL0093    YL0031    P      Record Status
      * ** Add: Process Auto-Locate Whse inventory             FP1127
      *
     C                     Z-ADD*ZERO     WN0124  30       Item Structure
     C                     Z-ADD*ZERO     WN0125  30       Item Structure
     C                     Z-ADD*ZERO     WN0126  30       Item Structure
     C                     Z-ADD*ZERO     WN0127  50       ITD Sequence Nu
     C                     Z-ADD*ZERO     WN0128  30       Sequence Number
     C                     Z-ADD*ZERO     WN0129 114       USR Transaction
     C                     Z-ADD*ZERO     WN0130 112       Extended Amount
     C                     Z-ADD*ZERO     WN0131 112       Quantity based
     C                     Z-ADD*ZERO     WN0132 112       Quantity based
     C                     Z-ADD*ZERO     WN0133 112       Quantity based
     C                     Z-ADD*ZERO     WN0134 112       On Hand Weight
     C                     Z-ADD*ZERO     WN0135 112       On Hand U/M1 Su
     C                     Z-ADD*ZERO     WN0136 112       Value of On Han
     C                     Z-ADD*ZERO     WN0137  70       Production Date
     C                     Z-ADD*ZERO     WN0138  70       Label Date  USR
     C                     MOVEL*BLANK    WN0139  3        USR Reason Code
      *
      * UPD Balances Transfer  IF
      * The following block of code will update Item Balance,
      * Item Balance Detail and Transaction Detail for the FROM ITEM
     C                     EXSR UASUBR
      * *****************************************************************
     C                     MOVEL'TRF'     WN0139           USR Reason Code
      * Error if FROM unit cost = 0
      * CASE: PAR.Unit Cost Pricing U/M EQ WRK.ZERO
     C           YL0027    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     WN0139           USR Reason Code
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0140 112       Quantity based
     C                     Z-ADD*ZERO     WN0141 112       Quantity based
     C                     Z-ADD*ZERO     WN0142 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0131           USR Qty based o
     C                     Z-ADD*ZERO     WN0132           USR Qty based o
     C                     Z-ADD*ZERO     WN0133           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           YL0010    IFEQ YL0010                     *IF
     C                     Z-ADDYL0006    WN0131           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           YL0013    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           YL0012    IFEQ 'M'                        *IF
     C           YL0006    MULT YL0011    WN0141    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           YL0012    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           YL0011    IFNE *ZERO                      *IF
     C           YL0006    DIV  YL0011    WN0141    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0141    WN0132           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           YL0016    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           YL0015    IFEQ 'M'                        *IF
     C           WN0141    MULT YL0014    WN0142    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           YL0015    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           YL0014    IFNE *ZERO                      *IF
     C           WN0141    DIV  YL0014    WN0142    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0142    WN0133           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           YL0013    IFEQ YL0010                     *IF
     C                     Z-ADDYL0006    WN0132           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           YL0012    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           YL0011    IFNE *ZERO                      *IF
     C           YL0006    DIV  YL0011    WN0131    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           YL0012    IFEQ 'D'                        *IF
     C           YL0006    MULT YL0011    WN0131    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           YL0016    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           YL0015    IFEQ 'M'                        *IF
     C           YL0006    MULT YL0014    WN0142    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           YL0015    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           YL0014    IFNE *ZERO                      *IF
     C           YL0006    DIV  YL0014    WN0142    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0142    WN0133           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           YL0016    IFEQ YL0010                     *IF
     C                     Z-ADDYL0006    WN0133           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           YL0015    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           YL0014    IFNE *ZERO                      *IF
     C           YL0006    DIV  YL0014    WN0141    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           YL0015    IFEQ 'D'                        *IF
     C           YL0006    MULT YL0014    WN0141    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0141    WN0132           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           YL0012    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           YL0011    IFNE *ZERO                      *IF
     C           WN0141    DIV  YL0011    WN0131    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           YL0012    IFEQ 'D'                        *IF
     C           WN0141    MULT YL0011    WN0131    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0027    MULT YL0026    WN0130    H      Extended Amount
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0094           Company Number
     C                     Z-ADD#1HGCD    WL0095           Item Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0096    WN0124           Item Structure
     C                     Z-ADDWL0097    WN0125           Item Structure
     C                     Z-ADDWL0098    WN0126           Item Structure
      * Adjust sign of transaction based on transaction type
      * CASE: PAR.Inventory Trans. Type is Transfer Warehouse
     C           'TW'      IFEQ 'TW'                       *IF
     C                     ADD  1         YL0033           Transfer Batch
     C                     Z-ADDYL0026    WUAHWG           Transaction Wei
     C                     Z-ADDYL0006    WUA5QT           Transaction Qua
      * CASE: PAR.USR Unship Flag is yes
     C           'N'       IFEQ 'Y'                        *IF
      * if this is an Unship, reverse the TO whse qty/wgt (neg rct)
     C           *ZERO     SUB  WUA5QT    WUA5QT           Transaction Qua
     C           *ZERO     SUB  WUAHWG    WUAHWG           Transaction Wei
     C                     ELSE
      * CASE: *OTHERWISE
      * if this is NOT an Unship, reverse the FROM whse qty, wgt (reverse
     C           *ZERO     SUB  YL0006    YL0006           Transaction Qua
     C           *ZERO     SUB  WN0131    WN0131           Quantity based
     C           *ZERO     SUB  YL0026    YL0026           Transaction Wei
     C           *ZERO     SUB  WN0130    WN0130           Extended Amount
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0099           Company Number
     C                     Z-ADD#1HGCD    WL0100           Item Code
     C                     MOVEL#1AJCD    WL0101    P      Warehouse Code
     C                     MOVEL'T'       WL0102    P      Inventory Trans
     C                     MOVEL'TW'      WL0103    P      Inventory Trans
     C                     Z-ADD##JDT     WL0104           Transaction Dat
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0105    WN0127           ITD Sequence Nu
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0106           Company Number
     C                     Z-ADD#1HGCD    WL0107           Item Code
     C                     MOVEL#1AJCD    WL0108    P      Warehouse Code
     C                     MOVEL'T'       WL0109    P      Inventory Trans
     C                     MOVEL'TW'      WL0110    P      Inventory Trans
     C                     Z-ADD##JDT     WL0111           Transaction Dat
     C                     Z-ADDWN0127    WL0112           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0113           Sequence Number
     C                     Z-ADD#1ELDT    WL0114           Production Date
     C                     MOVELYL0010    WL0115    P      U/M - Transacti
     C                     MOVEL'IC'      WL0116    P      Item Transactio
     C                     MOVEL@CN,003   WL0117    P      Description
     C                     Z-ADDYL0006    WL0118           Transaction Qua
     C                     Z-ADDYL0026    WL0119           Transaction Wei
     C                     Z-ADD*ZERO     WL0120           USR Transaction
     C                     MOVEL'LB'      WL0121    P      U/M - Cost
     C                     Z-ADDWN0130    WL0122           Extended Amount
     C                     MOVEL*BLANK    WL0123           Ticket Number
     C                     Z-ADD*ZERO     WL0124           G/L Document Nu
     C                     MOVEL'N'       WL0125    P      G/L Update Stat
     C                     MOVELWN0139    WL0126    P      Reason Code
     C                     MOVEL*BLANK    WL0127           Reference Numbe
     C                     MOVEL*BLANK    WL0128           Lot ID
     C                     Z-ADDYL0005    WL0129           Transfer Batch
     C                     Z-ADDYL0033    WL0130           Transfer Batch
     C                     Z-ADD*ZERO     WL0131           Order Number
     C                     Z-ADDWN0124    WL0132           Item Structure
     C                     Z-ADDWN0125    WL0133           Item Structure
     C                     Z-ADDWN0126    WL0134           Item Structure
     C                     MOVEL*BLANK    WL0135           Employee Badge
     C                     Z-ADD*ZERO     WL0136           Production Time
     C                     MOVEL'1'       WL0137    P      Shift Number
     C                     Z-ADDYL0007    WL0138           Label Date
     C                     MOVEL*BLANK    WL0139           EDI Status 1
     C                     MOVEL*BLANK    WL0140           EDI Status 2
     C                     MOVEL*BLANK    WL0141           EDI Status 3
     C                     MOVEL'A'       WL0142    P      Record Status
     C                     EXSR SSCRRC
      * CHG Value/Qty/Wgt      CH - IC Item Balance Detail  * 
     C                     EXSR STCHRC
      * 11/25/09 PKD Comment out until we know what we need to do here.
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0181           Company Number
     C                     Z-ADD#1HGCD    WL0182           Item Code
     C                     MOVEL#1AJCD    WL0183    P      Warehouse Code
     C                     Z-ADDWN0134    WL0184           Quantity on Han
     C                     Z-ADDWN0135    WL0185           Quantity on Han
     C                     Z-ADDWUNFNN    WL0186           Quantity on Han
     C                     Z-ADDWUNFNN    WL0187           Quantity on Han
     C                     Z-ADDWN0136    WL0188           Value of On Han
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0184    WN0134           Quantity on Han
     C                     Z-ADDWL0185    WN0135           Quantity on Han
     C                     Z-ADDWL0186    WUNFNN           Quantity on Han
     C                     Z-ADDWL0187    WUNFNN           Quantity on Han
     C                     Z-ADDWL0188    WN0136           Value of On Han
      * Chg Val/Qty/Wgt        Ch - IC Item Balance  * 
     C                     EXSR SYCHRC
      * ** FP1127:
      * ** Update location quantity on hand for External warehouse that
      * ** is lot controlled and not Carlisle controlled
      * ** Optional Lot number is passed in from the calling program
      * RTV Warehouse Info     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0189    P      Warehouse Code
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0190    YN0001    P      Warehouse Descr
     C                     MOVELWL0191    YN0002    P      Address Line 1
     C                     MOVELWL0192    YN0003    P      Address Line 2
     C                     MOVELWL0193    YN0004    P      Address Line 3
     C                     MOVELWL0194    YN0005    P      City
     C                     MOVELWL0195    YN0006    P      Zip/Postal Code
     C                     MOVELWL0196    YN0007    P      Production Ware
     C                     MOVELWL0197    YN0008    P      State Code
     C                     MOVELWL0198    YL0034    P      Lot Tracking Fl
     C                     MOVELWL0199    YN0009    P      Default Printer
     C                     MOVELWL0200    YN0010    P      Warehouse Type
     C                     MOVELWL0201    YN0011    P      Trans Contol AS
     C                     MOVELWL0202    YL0035    P      Warehouse Locat
     C                     MOVELWL0203    YN0012    P      Warehouse Std C
     C                     Z-ADDWL0204    YN0013           Warehouse Chill
     C                     MOVELWL0205    YN0014    P      Include in Auto
     C                     MOVELWL0206    YN0015    P      Default Manifes
     C                     MOVELWL0207    YN0016    P      Default Load Se
     C                     MOVELWL0208    YN0017    P      WHS Slotting Li
     C                     Z-ADDWL0209    YN0018           Shipping Compan
     C                     Z-ADDWL0210    YN0019           Accounting Comp
     C                     Z-ADDWL0211    YN0020           WHS Sched Prod
     C                     Z-ADDWL0212    YN0021           WHS Inventory C
     C                     MOVELWL0213    YN0022    P      Parent Warehous
     C                     MOVELWL0214    YN0023    P      Default Shippin
     C                     MOVELWL0215    YL0036    P      WHS Live w/Carl
     C                     MOVELWL0216    YN0024    P      WHS PFS Interfa
     C                     MOVELWL0217    YN0025    P      WHS Req Meter R
     C                     MOVELWL0218    YN0026    P      WHS Default Loa
     C                     MOVELWL0219    YN0027    P      WHS Unused Sts
     C                     MOVELWL0220    YN0028    P      Default Carrier
     C                     MOVELWL0221    YN0029    P      WHS TPM Locatio
     C                     MOVELWL0222    YN0030    P      WHS Unused Sts
     C                     MOVELWL0223    YN0031    P      EDI Status 1
     C                     MOVELWL0224    YN0032    P      EDI Status 2
     C                     MOVELWL0225    YN0033    P      EDI Status 3
     C                     MOVELWL0226    YN0034    P      Record Status
     C                     Z-ADDWL0227    YN0035           Job Time
     C                     MOVELWL0228    YN0036    P      User Id
     C                     MOVELWL0229    YN0037    P      Job Name
     C                     Z-ADDWL0230    YN0038           Job Date
      * ** Process lot tracking if External, not Carlisle, Lot trk=Y
      * CASE: Process lots if External, not Carlisle, Lot trk=Y
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : LCL.WHS Live w/Carlisle is *No/Blank
      *   |- c3    : LCL.Lot Tracking Flag is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0035    IFEQ 'E'                        *IF
     C           YL0036    IFEQ *BLANK                     *IF
     C           YL0036    OREQ 'N'
     C           YL0034    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Whse Location Info RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0231    P      Warehouse Code
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0232    WUYMCD    P      Location Code
     C                     MOVELWL0233    YL0037    P      Location Aisle
     C                     Z-ADDWL0234    YL0038           Location Bay
     C                     Z-ADDWL0235    YL0039           Loc Unused Chil
      * ** Lot # will be the "from warehouse" lot# or zeros    FP1127
      * UPD Auto-Loc TR Ord ItmXF - Item Lot Location  * 
     C                     CALL 'PMBVXFR'              90  UPD Auto-Loc TR
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0056  30       Company Number
     C                     PARM #1HGCD    WQ0057  70       Item Code
     C                     PARM #1AJCD    WQ0058  3        Warehouse Code
     C                     PARM #1ELDT    WQ0059  70       Production Date
     C                     PARM #1LXNM    WQ0060  50       Lot Number
     C                     PARM WUYMCD    WQ0061  4        Location Code
     C                     PARM WUYNCD    WQ0062  20       Location Level
     C                     PARM YL0006    WQ0063  70       Quantity Loc Tr
     C                     PARM *ZERO     WQ0064  70       Order Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMBVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * *****************************************************************
      * The following block of code will update Item Balance,
      * Item Balance Detail and Transaction Detail for the TO ITEM
      * *****************************************************************
      * ** 12/05/2008 LJB FP1127 Update Auto-Locate Whse inventory
      * ** Only process auto-locate if not a Carlisle Controlled warehous
      * ** and lot tracking has been turned on.
      * 12/04/06 PKD PK0040 Only add inventory to the To Warehouse
      *              if the Inter-Plant Transfer is No.  If the Inter-Pla
      *              Transfer is Yes, then the receiving plant's receivin
      *              process will add the inventory to the To Warehouse.
      * RTV Shipping Co        RT - Warehouse  * 
     C                     EXSR TBRVGN
      * CASE: PAR.Inter-Plant Transfer USR is No
     C           'N'       IFEQ 'N'                        *IF
      * Validate that Item Balance for TO Whse exists; if not, create it
      * Val Item Balance       RT - Item Balance  * 
     C                     EXSR TCRVGN
      * Create item balance if none exists
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Item Balance       CR - Item Balance  * 
     C                     EXSR TDCRRC
     C                     END                             *FI
      * Error if unit cost = 0
      * CASE: PAR.Unit Cost - Detail EQ WRK.ZERO
     C           YL0032    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     WN0139           USR Reason Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'TRF'     WN0139           USR Reason Code
     C                     END                             *FI
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0040    WL0094           Company Number
     C                     Z-ADD#1HGCD    WL0095           Item Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0096    WN0124           Item Structure
     C                     Z-ADDWL0097    WN0125           Item Structure
     C                     Z-ADDWL0098    WN0126           Item Structure
     C           YL0032    MULT WUAHWG    WN0130    H      Extended Amount
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0040    WL0099           Company Number
     C                     Z-ADD#1HGCD    WL0100           Item Code
     C                     MOVEL#DBNAA    WL0101    P      Warehouse Code
     C                     MOVEL'T'       WL0102    P      Inventory Trans
     C                     MOVEL'TW'      WL0103    P      Inventory Trans
     C                     Z-ADD##JDT     WL0104           Transaction Dat
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0105    WN0127           ITD Sequence Nu
      * Reset Production/Label Date if Lot Tracking warehouse.
     C                     EXSR UBSUBR                     Reset Productio
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0040    WL0106           Company Number
     C                     Z-ADD#1HGCD    WL0107           Item Code
     C                     MOVEL#DBNAA    WL0108    P      Warehouse Code
     C                     MOVEL'T'       WL0109    P      Inventory Trans
     C                     MOVEL'TW'      WL0110    P      Inventory Trans
     C                     Z-ADD##JDT     WL0111           Transaction Dat
     C                     Z-ADDWN0127    WL0112           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0113           Sequence Number
     C                     Z-ADDWN0137    WL0114           Production Date
     C                     MOVELYL0010    WL0115    P      U/M - Transacti
     C                     MOVEL'IC'      WL0116    P      Item Transactio
     C                     MOVEL@CN,003   WL0117    P      Description
     C                     Z-ADDWUA5QT    WL0118           Transaction Qua
     C                     Z-ADDWUAHWG    WL0119           Transaction Wei
     C                     Z-ADD*ZERO     WL0120           USR Transaction
     C                     MOVEL'LB'      WL0121    P      U/M - Cost
     C                     Z-ADDWN0130    WL0122           Extended Amount
     C                     MOVEL*BLANK    WL0123           Ticket Number
     C                     Z-ADD*ZERO     WL0124           G/L Document Nu
     C                     MOVEL*BLANK    WL0125           G/L Update Stat
     C                     MOVELWN0139    WL0126    P      Reason Code
     C                     MOVEL*BLANK    WL0127           Reference Numbe
     C                     MOVEL*BLANK    WL0128           Lot ID
     C                     Z-ADDYL0005    WL0129           Transfer Batch
     C                     Z-ADDYL0033    WL0130           Transfer Batch
     C                     Z-ADD*ZERO     WL0131           Order Number
     C                     Z-ADDWN0124    WL0132           Item Structure
     C                     Z-ADDWN0125    WL0133           Item Structure
     C                     Z-ADDWN0126    WL0134           Item Structure
     C                     MOVEL*BLANK    WL0135           Employee Badge
     C                     Z-ADD*ZERO     WL0136           Production Time
     C                     MOVEL'1'       WL0137    P      Shift Number
     C                     Z-ADDWN0138    WL0138           Label Date
     C                     MOVEL*BLANK    WL0139           EDI Status 1
     C                     MOVEL*BLANK    WL0140           EDI Status 2
     C                     MOVEL*BLANK    WL0141           EDI Status 3
     C                     MOVEL'A'       WL0142    P      Record Status
     C                     EXSR SSCRRC
      * 11/25/09 PKD Comment out until we know what we need to do here.
      * * Post transaction to Item Balance & Item Balance Detail
      * Prc Create Dtl Receipt IF
      * Prc Create Dtl Receipt RT - Item Transaction Detail  * 
     C                     EXSR TERVGN
      * ** Process Auto-Locate Whse inventory             FP1127
      * RTV Warehouse Info     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBNAA    WL0189    P      Warehouse Code
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0190    YN0001    P      Warehouse Descr
     C                     MOVELWL0191    YN0002    P      Address Line 1
     C                     MOVELWL0192    YN0003    P      Address Line 2
     C                     MOVELWL0193    YN0004    P      Address Line 3
     C                     MOVELWL0194    YN0005    P      City
     C                     MOVELWL0195    YN0006    P      Zip/Postal Code
     C                     MOVELWL0196    YN0007    P      Production Ware
     C                     MOVELWL0197    YN0008    P      State Code
     C                     MOVELWL0198    YL0034    P      Lot Tracking Fl
     C                     MOVELWL0199    YN0009    P      Default Printer
     C                     MOVELWL0200    YN0010    P      Warehouse Type
     C                     MOVELWL0201    YN0011    P      Trans Contol AS
     C                     MOVELWL0202    YL0035    P      Warehouse Locat
     C                     MOVELWL0203    YN0012    P      Warehouse Std C
     C                     Z-ADDWL0204    YN0013           Warehouse Chill
     C                     MOVELWL0205    YN0014    P      Include in Auto
     C                     MOVELWL0206    YN0015    P      Default Manifes
     C                     MOVELWL0207    YN0016    P      Default Load Se
     C                     MOVELWL0208    YN0017    P      WHS Slotting Li
     C                     Z-ADDWL0209    YN0018           Shipping Compan
     C                     Z-ADDWL0210    YN0019           Accounting Comp
     C                     Z-ADDWL0211    YN0020           WHS Sched Prod
     C                     Z-ADDWL0212    YN0021           WHS Inventory C
     C                     MOVELWL0213    YN0022    P      Parent Warehous
     C                     MOVELWL0214    YN0023    P      Default Shippin
     C                     MOVELWL0215    YL0036    P      WHS Live w/Carl
     C                     MOVELWL0216    YN0024    P      WHS PFS Interfa
     C                     MOVELWL0217    YN0025    P      WHS Req Meter R
     C                     MOVELWL0218    YN0026    P      WHS Default Loa
     C                     MOVELWL0219    YN0027    P      WHS Unused Sts
     C                     MOVELWL0220    YN0028    P      Default Carrier
     C                     MOVELWL0221    YN0029    P      WHS TPM Locatio
     C                     MOVELWL0222    YN0030    P      WHS Unused Sts
     C                     MOVELWL0223    YN0031    P      EDI Status 1
     C                     MOVELWL0224    YN0032    P      EDI Status 2
     C                     MOVELWL0225    YN0033    P      EDI Status 3
     C                     MOVELWL0226    YN0034    P      Record Status
     C                     Z-ADDWL0227    YN0035           Job Time
     C                     MOVELWL0228    YN0036    P      User Id
     C                     MOVELWL0229    YN0037    P      Job Name
     C                     Z-ADDWL0230    YN0038           Job Date
      * ** Process lot tracking if External, not Carlisle, Lot trk=Y
      * CASE: Process lots if External, not Carlisle, Lot trk=Y
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : LCL.WHS Live w/Carlisle is *No/Blank
      *   |- c3    : LCL.Lot Tracking Flag is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0035    IFEQ 'E'                        *IF
     C           YL0036    IFEQ *BLANK                     *IF
     C           YL0036    OREQ 'N'
     C           YL0034    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Lot Number is passed in and is optional
      * RTV Whse Location Info RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBNAA    WL0231    P      Warehouse Code
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0232    WUYMCD    P      Location Code
     C                     MOVELWL0233    YL0037    P      Location Aisle
     C                     Z-ADDWL0234    YL0038           Location Bay
     C                     Z-ADDWL0235    YL0039           Loc Unused Chil
      * ** Lot# will be the "to warehouse" lot# or zeros    FP1127
      * UPD Auto-Loc TR Ord ItmXF - Item Lot Location  * 
     C                     CALL 'PMBVXFR'              90  UPD Auto-Loc TR
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0079  30       Company Number
     C                     PARM #1HGCD    WQ0080  70       Item Code
     C                     PARM #DBNAA    WQ0081  3        Warehouse Code
     C                     PARM ##JDT     WQ0082  70       Production Date
     C                     PARM *ZERO     WQ0083  50       Lot Number
     C                     PARM WUYMCD    WQ0084  4        Location Code
     C                     PARM WUYNCD    WQ0085  20       Location Level
     C                     PARM WUA5QT    WQ0086  70       Quantity Loc Tr
     C                     PARM *ZERO     WQ0087  70       Order Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMBVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * Default Transfer Quantity.
      * CASE: DTL.LLT Trans Qty is GT Zero
     C           #DJ5QT    IFGT *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1J2QT    #DJ5QT           LLT Trans Qty
     C                     END                             *FI
      * SEL:  To Location Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Location Code USR
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DYVCD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Whs Location      SR - Warehouse Location  * 
     C                     CALL 'PDHSSRR'              90  Sel Whs Locatio
     C                     PARM *BLANK    W0RTN   7
     C           #1AJCD    PARM #1AJCD    WQ0088  3        Warehouse Code
     C           #DYVCD    PARM #DYVCD    WQ0089  4        Location Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
      * SEL:  To Warehouse Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Transfer Warehouse Code
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DBNAA'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Whs Location      SR - Warehouse Location  * 
     C                     CALL 'PDHSSRR'              90  Sel Whs Locatio
     C                     PARM *BLANK    W0RTN   7
     C           #DBNAA    PARM #DBNAA    WQ0090  3        Warehouse Code
     C           #DYVCD    PARM #DYVCD    WQ0091  4        Location Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     END
     C                     END                             *FI
      * Init:  To Location Level
      * CASE: DTL.Item Code is Pancreas
     C           #1HGCD    IFEQ 93210                      *IF
     C                     Z-ADD1         #DSXTX           Location Level
     C                     END                             *FI
      * VAL:  To Location Code
      * CASE: DTL.Location Code USR NE WRK.BLANK
     C           #DYVCD    IFNE WUGSTX                     *IF
      * Val Location Exists   RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0067    P      Warehouse Code
     C                     MOVEL#DYVCD    WL0068    P      Location Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0069    P4VYST    P      Record Found -P
      * CASE: PAR.Record Found -PS CD USR is Record Not Found
     C           P4VYST    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#1AJCD    ZA0001           Warehouse Code
     C                     MOVEL#DYVCD    ZA0002           Location Code U
      * Send message 'Warehouse Loc DNE'
     C                     MOVEL'USR2705' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  To Location Level
      * CASE: DTL.Location Level USR is 0 through 5
     C           #DSXTX    IFGE 0                          *IF
     C           #DSXTX    ANDLE5
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#DSXTX    ZA0003           Location Level
      * Send message 'Level Invalid'
     C                     MOVEL'USR3135' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
      * VAL:  Transfer Quantity
      * CASE: DTL.LLT Trans Qty GT DTL.ILL Item Qty On-Hand
     C           #DJ5QT    IFGT #1J2QT                     *IF
      * Setup message data for message
     C                     Z-ADD#DJ5QT    ZA0004           LLT Trans Qty
     C                     Z-ADD#1J2QT    ZA0005           ILL Item Qty On
      * Send message 'Trns Qty GT On Hand'
     C                     MOVEL'USR2704' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
      * Check reference to Item Balance Detail
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Warehouse Location
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Hold Reason
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Screen function fields
     C                     MOVEL*BLANK    #DO6NA           Warehouse Desc
      * Warehouse Desc DRV
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBNAA    WL0236    P      Warehouse Code
     C                     EXSR TJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0237    #DO6NA    P      Warehouse Descr
     C                     END
      * Transfer Warehouse Code required
     C           #DBNAA    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Location Code USR required
     C           #DYVCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * LLT Trans Qty required
     C           #DJ5QT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADD*ZERO     #1LPDT           ILL Unused Date
     C                     Z-ADD*ZERO     #DLTNT           Lot Number USR
     C                     Z-ADDP1G5WG    #1G5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     #1J3QT           ILL Co-Packer L
     C                     Z-ADD*ZERO     #1G6WG           ILl Item Wgt On
     C                     Z-ADD*ZERO     #1J4QT           ILL Unused Qty
     C                     Z-ADD*ZERO     #1G7WG           ILL Unused Wgt
     C                     Z-ADD*ZERO     #1LQDT           ILL Unused Date
     C                     Z-ADD*ZERO     #1NBR            ILL Unused Nbr
     C                     MOVEL*BLANK    #1YTCD           ILL Customer Co
     C                     MOVEL*BLANK    #1ASSX           ILL Unused Sts
     C                     MOVEL*BLANK    #1ATSX           ILL Unused Sts
     C                     MOVEL*BLANK    #1AUSX           ILL Unused Sts
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVEL*BLANK    #DADTX           Name
     C                     MOVELP1AJCD    #1AJCD           Warehouse Code
     C                     MOVEL*BLANK    #DF8NA           Warehouse Descr
     C                     Z-ADDP1LXNM    #1LXNM           Lot Number
     C                     Z-ADDP1ELDT    #1ELDT           Production Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1ELDT
     C                     Z-ADDP1LODT    #1LODT           ILL Avail Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1LODT
     C                     Z-ADDP1HGCD    #1HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1HGCD
     C                     MOVEL*BLANK    #DOONA           Item Desc DRV
     C                     MOVELP1YMCD    #1YMCD           Location Code
     C                     Z-ADDP1J2QT    #1J2QT           ILL Item Qty On
     C                     Z-ADDP1YNCD    #1YNCD           Location Level
     C                     MOVELP1AMSX    #1AMSX           ILL Status
     C                     MOVELP1YSCD    #1YSCD           Inv Hold Reason
     C                     MOVEL*BLANK    #DBNAA           Transfer Wareho
     C                     MOVEL*BLANK    #DO6NA           Warehouse Desc
     C                     MOVEL*BLANK    #DYVCD           Location Code U
     C                     Z-ADD*ZERO     #DJ5QT           LLT Trans Qty
     C                     Z-ADD*ZERO     #DSXTX           Location Level
      * CALC: Screen function fields
     C                     MOVEL*BLANK    #DO6NA           Warehouse Desc
      * Warehouse Desc DRV
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBNAA    WL0236    P      Warehouse Code
     C                     EXSR TJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0237    #DO6NA    P      Warehouse Descr
      * USER: Load screen
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     MOVEL#1YMCD    #DYVCD           Location Code U
     C                     Z-ADD#1YNCD    #DSXTX           Location Level
     C                     Z-ADD#1J2QT    #DJ5QT           LLT Trans Qty
     C                     MOVEL'CFH'     #DBNAA           Transfer Wareho
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     END                             *FI
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR TKRVGN
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0236    P      Warehouse Code
     C                     EXSR TJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0237    #DF8NA    P      Warehouse Descr
     C                     MOVEL*BLANK    #DO6NA           Warehouse Desc
      * Warehouse Desc DRV
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBNAA    WL0236    P      Warehouse Code
     C                     EXSR TJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0237    #DO6NA    P      Warehouse Descr
     C                     MOVEL*BLANK    #DOONA           Item Desc DRV
      * Item Desc DRV
      * Rtv Item Descriptions  RT - OM Item  * 
     C                     EXSR TLRVGN
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1ELDT
      * Convert ILL Avail Ship Date to display format
      * Convert date
     C           1000000   ADD  #1LODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1LODT
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAHGCD    WQSA02           Item Code
     C           *LIKE     DEFN WAAJCD    WQSA03           Warehouse Code
     C           *LIKE     DEFN WALTRT    WQSA04           LLT Trans Type
     C           *LIKE     DEFN WALRDT    WQSA05           LLT Trans Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Item Code
     C                     KFLD           WQSA03           Warehouse Code
     C                     KFLD           WQSA04           LLT Trans Type
     C                     KFLD           WQSA05           LLT Trans Date
      * Setup key
     C                     Z-ADDWL0001    WQSA01           Company Number
     C                     Z-ADDWL0002    WQSA02           Item Code
     C                     MOVELWL0003    WQSA03           Warehouse Code
     C                     MOVELWL0004    WQSA04           LLT Trans Type
     C                     Z-ADDWL0005    WQSA05           LLT Trans Date
      * Establish starting position
     C           KRSSA     SETLL@L7CPUK                    *
     C           KRSSA     READE@L7CPUK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2638' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0006           LLT Sequence #
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WALLTS    ADD  1         WL0006           LLT Sequence #
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@L7CPUK                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L7CPS3
     C                     Z-ADDWL0007    WBAIC3           Company Number
     C                     Z-ADDWL0008    WBHGCD           Item Code
     C                     MOVELWL0009    WBAJCD           Warehouse Code
     C                     MOVELWL0010    WBLTRT           LLT Trans Type
     C                     Z-ADDWL0011    WBLRDT           LLT Trans Date
     C                     Z-ADDWL0012    WBLLTS           LLT Sequence #
     C                     Z-ADDWL0013    WBLSDT           LLT Production
     C                     Z-ADDWL0014    WBJ5QT           LLT Trans Qty
     C                     Z-ADDWL0015    WBG8WG           LLT Trans Wgt
     C                     Z-ADDWL0016    WBLLTN           LLT Lot Number
     C                     MOVELWL0017    WBYMCD           Location Code
     C                     Z-ADDWL0018    WBLLCL           LLT Location Le
     C                     MOVELWL0019    WBBNAA           Transfer Wareho
     C                     Z-ADDWL0020    WBLLTR           LLT Transfer Lo
     C                     MOVELWL0021    WBY2CD           Transfer Locati
     C                     Z-ADDWL0022    WBLLTL           LLT Transfer Lo
     C                     Z-ADDWL0023    WBC4NB           Order Number
     C                     MOVELWL0024    WBLOST           LLT Status
     C                     MOVELWL0025    WBLLTU           LTT Unused Sts
     C                     MOVELWL0026    WBLLYT           LTT Unused Sts
     C                     MOVELWL0027    WBUVST           EDI Status 1
     C                     MOVELWL0028    WBUWST           EDI Status 2
     C                     MOVELWL0029    WBUXST           EDI Status 3
     C                     MOVELWL0030    WBVSST           Record Status
     C                     Z-ADDWL0031    WBAATM           Job Time
     C                     MOVELWL0032    WBAYNA           User Id
     C                     MOVELWL0033    WBA0NA           Job Name
     C                     Z-ADDWL0034    WBAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WBVSST           Record Status
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##JOB     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
     C           KLCRSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
     C                     KFLD           WBLTRT           LLT Trans Type
     C                     KFLD           WBLRDT           LLT Trans Date
     C                     KFLD           WBLLTS           LLT Sequence #
      * Check for duplicate primary key
     C           KLCRSB    SETLL@L7CPS3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2639' W0RTN   7
      * Send message 'Item Lot Loc Trans     EX'
     C                     MOVEL'USR2639' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@L7CPS3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Upd ReLoc Qty On-Hand RT - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0012  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0013  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0014 112       ILl Item Wgt On
     C                     Z-ADD*ZERO     WN0015  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0016 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0017  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0018  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0019  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0020  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0021  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0022  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0023  1        EDI Status 1
     C                     MOVEL*BLANK    WN0024  1        EDI Status 2
     C                     MOVEL*BLANK    WN0025  1        EDI Status 3
     C                     MOVEL*BLANK    WN0026  1        Record Status
     C                     Z-ADD*ZERO     WN0027  60       Job Time
     C                     MOVEL*BLANK    WN0028 10        User Id
     C                     MOVEL*BLANK    WN0029 10        Job Name
     C                     Z-ADD*ZERO     WN0030  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCAJCD           Warehouse Code
     C                     KFLD           WCELDT           Production Date
     C                     KFLD           WCLXNM           Lot Number
     C                     KFLD           WCYMCD           Location Code
     C                     KFLD           WCYNCD           Location Level
      * Setup key
     C                     Z-ADDWL0035    WCAIC3           Company Number
     C                     Z-ADDWL0036    WCHGCD           Item Code
     C                     MOVELWL0037    WCAJCD           Warehouse Code
     C                     Z-ADDWL0038    WCELDT           Production Date
     C                     Z-ADDWL0039    WCLXNM           Lot Number
     C                     MOVELWL0040    WCYMCD           Location Code
     C                     Z-ADDWL0041    WCYNCD           Location Level
      * Establish starting position
     C           KRSSC     CHAIN@L5CPSV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2634' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Item Loc          CR - Item Lot Location  * 
     C                     EXSR SDCRRC
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCJ2QT    ADD  WL0047    WN0012           ILL Item Qty On
      * CASE: PAR.ILL Item Qty On-Hand is GT Zero
     C           WN0012    IFGT *ZERO                      *IF
      * Chg Quantity On-Hand  CH - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0048           Company Number
     C                     Z-ADDWCHGCD    WL0049           Item Code
     C                     MOVELWCAJCD    WL0050    P      Warehouse Code
     C                     Z-ADDWCELDT    WL0051           Production Date
     C                     Z-ADDWCLXNM    WL0052           Lot Number
     C                     MOVELWCYMCD    WL0053    P      Location Code
     C                     Z-ADDWCYNCD    WL0054           Location Level
     C                     Z-ADDWN0012    WL0055           ILL Item Qty On
     C                     EXSR SECHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Del Item Location     DL - IC Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0056           Company Number
     C                     Z-ADDWCHGCD    WL0057           Item Code
     C                     MOVELWCAJCD    WL0058    P      Warehouse Code
     C                     Z-ADDWCELDT    WL0059           Production Date
     C                     Z-ADDWCLXNM    WL0060           Lot Number
     C                     MOVELWCYMCD    WL0061    P      Location Code
     C                     Z-ADDWCYNCD    WL0062           Location Level
     C                     EXSR SFDLRC
      * Del Item Balance Dtl  RT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0063           Company Number
     C                     Z-ADDWCHGCD    WL0064           Item Code
     C                     MOVELWCAJCD    WL0065    P      Warehouse Code
     C                     Z-ADDWCELDT    WL0066           Production Date
     C                     EXSR SGRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt Item Loc          CR - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L5CPSL
     C                     Z-ADDWL0035    WDAIC3           Company Number
     C                     Z-ADDWL0036    WDHGCD           Item Code
     C                     MOVELWL0037    WDAJCD           Warehouse Code
     C                     Z-ADDWL0038    WDELDT           Production Date
     C                     Z-ADDWL0039    WDLXNM           Lot Number
     C                     MOVELWL0040    WDYMCD           Location Code
     C                     Z-ADDWL0041    WDYNCD           Location Level
     C                     Z-ADDWL0047    WDJ2QT           ILL Item Qty On
     C                     Z-ADDWL0042    WDG5WG           ILL Unit Weight
     C                     Z-ADDWN0013    WDJ3QT           ILL Co-Packer L
     C                     Z-ADDWN0014    WDG6WG           ILl Item Wgt On
     C                     Z-ADDWN0015    WDJ4QT           ILL Unused Qty
     C                     Z-ADDWN0016    WDG7WG           ILL Unused Wgt
     C                     Z-ADDWL0043    WDLODT           ILL Avail Ship
     C                     Z-ADDWL0044    WDLPDT           ILL Unused Date
     C                     Z-ADDWN0017    WDLQDT           ILL Unused Date
     C                     Z-ADDWN0018    WDNBR            ILL Unused Nbr
     C                     MOVELWN0019    WDYTCD           ILL Customer Co
     C                     MOVELWL0045    WDAMSX           ILL Status
     C                     MOVELWN0020    WDASSX           ILL Unused Sts
     C                     MOVELWN0021    WDATSX           ILL Unused Sts
     C                     MOVELWN0022    WDAUSX           ILL Unused Sts
     C                     MOVELWL0046    WDYSCD           Inv Hold Reason
     C                     MOVELWN0023    WDUVST           EDI Status 1
     C                     MOVELWN0024    WDUWST           EDI Status 2
     C                     MOVELWN0025    WDUXST           EDI Status 3
     C                     MOVELWN0026    WDVSST           Record Status
     C                     Z-ADDWN0027    WDAATM           Job Time
     C                     MOVELWN0028    WDAYNA           User Id
     C                     MOVELWN0029    WDA0NA           Job Name
     C                     Z-ADDWN0030    WDAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WDVSST           Record Status
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C           KLCRSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
     C                     KFLD           WDELDT           Production Date
     C                     KFLD           WDLXNM           Lot Number
     C                     KFLD           WDYMCD           Location Code
     C                     KFLD           WDYNCD           Location Level
      * Check for duplicate primary key
     C           KLCRSD    SETLL@L5CPSL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2635' W0RTN   7
      * Send message 'Item Lot Location      EX'
     C                     MOVEL'USR2635' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@L5CPSL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Chg Quantity On-Hand  CH - Item Lot Location  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0031 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0032  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0033 112       ILl Item Wgt On
     C                     Z-ADD*ZERO     WN0034  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0035 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0036  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0037  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0038  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0039  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0040  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0041  1        ILL Status
     C                     MOVEL*BLANK    WN0042  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0043  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0044  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0045  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0046  1        EDI Status 1
     C                     MOVEL*BLANK    WN0047  1        EDI Status 2
     C                     MOVEL*BLANK    WN0048  1        EDI Status 3
     C                     MOVEL*BLANK    WN0049  1        Record Status
     C                     Z-ADD*ZERO     WN0050  60       Job Time
     C                     MOVEL*BLANK    WN0051 10        User Id
     C                     MOVEL*BLANK    WN0052 10        Job Name
     C                     Z-ADD*ZERO     WN0053  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @L5CPSL
     C                     Z-ADDWL0048    WDAIC3           Company Number
     C                     Z-ADDWL0049    WDHGCD           Item Code
     C                     MOVELWL0050    WDAJCD    P      Warehouse Code
     C                     Z-ADDWL0051    WDELDT           Production Date
     C                     Z-ADDWL0052    WDLXNM           Lot Number
     C                     MOVELWL0053    WDYMCD    P      Location Code
     C                     Z-ADDWL0054    WDYNCD           Location Level
      *
     C           KLCHSE    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
     C                     KFLD           WDELDT           Production Date
     C                     KFLD           WDLXNM           Lot Number
     C                     KFLD           WDYMCD           Location Code
     C                     KFLD           WDYNCD           Location Level
     C           KLCHSE    CHAIN@L5CPSL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL51    YARDCS
      * Move non-key fields to @L5CPSL
     C                     Z-ADDWL0055    WDJ2QT           ILL Item Qty On
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@L5CPSL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * Del Item Location     DL - IC Item Lot Location  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0054  50       ILL Item Qty On
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L5CPSL
     C                     Z-ADDWL0056    WDAIC3           Company Number
     C                     Z-ADDWL0057    WDHGCD           Item Code
     C                     MOVELWL0058    WDAJCD           Warehouse Code
     C                     Z-ADDWL0059    WDELDT           Production Date
     C                     Z-ADDWL0060    WDLXNM           Lot Number
     C                     MOVELWL0061    WDYMCD           Location Code
     C                     Z-ADDWL0062    WDYNCD           Location Level
      *
     C           KLDLSF    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
     C                     KFLD           WDELDT           Production Date
     C                     KFLD           WDLXNM           Lot Number
     C                     KFLD           WDYMCD           Location Code
     C                     KFLD           WDYNCD           Location Level
     C           KLDLSF    CHAIN@L5CPSL              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L5CPSL                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Del Item Balance Dtl  RT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEELDT           Production Date
      * Setup key
     C                     Z-ADDWL0063    WEAIC3           Company Number
     C                     Z-ADDWL0064    WEHGCD           Item Code
     C                     MOVELWL0065    WEAJCD           Warehouse Code
     C                     Z-ADDWL0066    WEELDT           Production Date
      * Establish starting position
     C           KRSSG     CHAIN@B1REJ0              90    *
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Quantity on Hand - U/M1 is Equal to zero
     C           WEARQT    IFEQ *ZERO                      *IF
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
     C                     EXSR SHDLRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHDLRC    BEGSR
      *================================================================
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDWEAIC3    WFAIC3           Company Number
     C                     Z-ADDWEHGCD    WFHGCD           Item Code
     C                     MOVELWEAJCD    WFAJCD           Warehouse Code
     C                     Z-ADDWEELDT    WFELDT           Production Date
      *
     C           KLDLSH    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
     C           KLDLSH    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Val Location Exists   RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGYMCD           Location Code
      * Setup key
     C                     MOVELWL0067    WGAJCD           Warehouse Code
     C                     MOVELWL0068    WGYMCD           Location Code
      * Establish starting position
     C           KRSSI     CHAIN@L2RESM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0069           Record Found -P
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0069           Record Found -P
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt Whs Location      CR - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L2RESN
     C                     MOVEL#DBNAA    WHAJCD           Warehouse Code
     C                     MOVEL#DYVCD    WHYMCD           Location Code
     C                     MOVELYL0002    WHYPCD           Location Aisle
     C                     Z-ADDYL0004    WHLCBY           Location Bay
     C                     Z-ADD*ZERO     WHLCCT           Loc Unused Chil
     C                     MOVELWUWLUS    WHWLUS           WL Unused Sts 1
     C                     MOVELWUWUSD    WHWUSD           WL Unused Sts 2
     C                     MOVELWUWLUN    WHWLUN           WL PFS Zone
     C                     MOVEL'F'       WHAGSX           WLT Type Code
     C                     MOVELWUUVST    WHUVST           EDI Status 1
     C                     MOVELWUUWST    WHUWST           EDI Status 2
     C                     MOVELWUUXST    WHUXST           EDI Status 3
     C                     MOVELWUVSST    WHVSST           Record Status
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     MOVEL*BLANK    WHAYNA           User Id
     C                     MOVEL*BLANK    WHA0NA           Job Name
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WHVSST           Record Status
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
     C           KLCRSJ    KLIST
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHYMCD           Location Code
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@L2RESN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2629' W0RTN   7
      * Send message 'Warehouse Location     EX'
     C                     MOVEL'USR2629' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@L2RESN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Loc Type          RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGYMCD           Location Code
      * Setup key
     C                     MOVEL#1AJCD    WGAJCD           Warehouse Code
     C                     MOVEL#DYVCD    WGYMCD           Location Code
      * Establish starting position
     C           KRSSK     CHAIN@L2RESM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0055           WLT Type Code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGAGSX    WN0055           WLT Type Code
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WIAGSX           WLT Type Code
      * Setup key
     C                     MOVELWN0055    WIAGSX           WLT Type Code
      * Establish starting position
     C           KRSSL     CHAIN@L3RET8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2660' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0056           WLT Type Chill
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWISLTY    WN0056           WLT Type Chill
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * RTV Next Tran Batch #  CH - Company Control  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0066  40       Current Account
     C                     Z-ADD*ZERO     WN0067  20       Current Account
     C                     Z-ADD*ZERO     WN0068  30       OM Week
     C                     Z-ADD*ZERO     WN0069  70       Next Order Numb
     C                     Z-ADD*ZERO     WN0070  70       Next Invoice Nu
     C                     Z-ADD*ZERO     WN0071  70       Next Credit Mem
     C                     Z-ADD*ZERO     WN0072  70       Next Late Charg
     C                     Z-ADD*ZERO     WN0073  70       Next On Acct Ca
     C                     Z-ADD*ZERO     WN0074  70       Next Voucher Nu
     C                     Z-ADD*ZERO     WN0075  70       Next Customer #
     C                     Z-ADD*ZERO     WN0076  70       Next Inventory
     C                     Z-ADD*ZERO     WN0077  80       Next PFS Batch
     C                     Z-ADD*ZERO     WN0078  70       Next Contract/P
     C                     Z-ADD*ZERO     WN0079  60       Next HPB Batch
     C                     MOVEL*BLANK    WN0080  1        Auto Order Numb
     C                     MOVEL*BLANK    WN0081  1        Auto Voucher Nu
     C                     MOVEL*BLANK    WN0082  1        Auto Customers
     C                     MOVEL*BLANK    WN0083  1        Auto Inv. Ref.
     C                     Z-ADD*ZERO     WN0084  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0085  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0086 112       Late Charge Min
     C                     MOVEL*BLANK    WN0087  1        Print Co Addr o
     C                     MOVEL*BLANK    WN0088  1        Credit Hold Sta
     C                     MOVEL*BLANK    WN0089  1        Allocate Credit
     C                     MOVEL*BLANK    WN0090 30        Message Line 1
     C                     MOVEL*BLANK    WN0091 30        Message Line 2
     C                     MOVEL*BLANK    WN0092 30        Message Line 3
     C                     MOVEL*BLANK    WN0093 30        Message Line 4
     C                     MOVEL*BLANK    WN0094  1        Age by Trans or
     C                     Z-ADD*ZERO     WN0095  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0096  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0097  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0098  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0099  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0100  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0101  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0102  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0103  30       Retention Perio
     C                     Z-ADD*ZERO     WN0104  30       Retention Perio
     C                     Z-ADD*ZERO     WN0105  30       Retention Perio
     C                     Z-ADD*ZERO     WN0106  30       Retention Perio
     C                     Z-ADD*ZERO     WN0107  30       Retention Perio
     C                     Z-ADD*ZERO     WN0108  70       Next Load ID
     C                     MOVEL*BLANK    WN0109  1        Auto Load Numbe
     C                     Z-ADD*ZERO     WN0110  70       Next Item Numbe
     C                     MOVEL*BLANK    WN0111  1        G/L Posted Code
     C                     Z-ADD*ZERO     WN0112  30       Production Numb
     C                     MOVEL*BLANK    WN0113  1        Freight by Poun
     C                     MOVEL*BLANK    WN0114  1        Price Audit Act
     C                     MOVEL*BLANK    WN0115 10        PRT Night Queue
     C                     MOVEL*BLANK    WN0116  1        EDI Status 1
     C                     MOVEL*BLANK    WN0117  1        EDI Status 2
     C                     MOVEL*BLANK    WN0118  1        EDI Status 3
     C                     MOVEL*BLANK    WN0119  1        Record Status
     C                     Z-ADD*ZERO     WN0120  60       Job Time
     C                     MOVEL*BLANK    WN0121 10        User Id
     C                     MOVEL*BLANK    WN0122 10        Job Name
     C                     Z-ADD*ZERO     WN0123  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @ASRECB
     C                     Z-ADD#1AIC3    WJAIC3           Company Number
      *
     C           KLCHSM    KLIST
     C                     KFLD           WJAIC3           Company Number
     C           KLCHSM    CHAIN@ASRECB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAASREL0'MDACP
     C                     MOVEL'@ASRECB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAAS1    YBRDCS
      * USER: Processing after Data read
     C                     MOVEL'Y'       YBRDC            *Record Data Ch
      *
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADDWJBANB    YL0005           Transfer Batch
     C                     ADD  1         WJBANB           Next HPB Batch
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@ASRECB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAASREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Label Date         RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEELDT           Production Date
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3           Company Number
     C                     Z-ADD#1HGCD    WEHGCD           Item Code
     C                     MOVEL#1AJCD    WEAJCD           Warehouse Code
     C                     Z-ADD#1ELDT    WEELDT           Production Date
      * Establish starting position
     C           KRSSN     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEK7DT    YL0007           Label Date
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0070    WKAIC3           Company Number
     C                     Z-ADDWL0071    WKHGCD           Item Code
      * Establish starting position
     C           KRSSO     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0072           Description Lin
     C                     MOVEL*BLANK    WL0073           Description Lin
     C                     MOVEL*BLANK    WL0074           U/M - Primary
     C                     Z-ADD*ZERO     WL0075           Conversion Fact
     C                     MOVEL*BLANK    WL0076           Operation Facto
     C                     MOVEL*BLANK    WL0077           U/M - Second
     C                     Z-ADD*ZERO     WL0078           Conversion Fact
     C                     MOVEL*BLANK    WL0079           Operation Facto
     C                     MOVEL*BLANK    WL0080           U/M - Third
     C                     MOVEL*BLANK    WL0081           U/M - Pricing
     C                     Z-ADD*ZERO     WL0082           Unit Weight
     C                     MOVEL*BLANK    WL0083           Production Date
     C                     MOVEL*BLANK    WL0084           Catch Weight St
     C                     Z-ADD*ZERO     WL0085           Fresh Chilling
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKAVNA    WL0072           Description Lin
     C                     MOVELWKAWNA    WL0073           Description Lin
     C                     MOVELWKADCD    WL0074           U/M - Primary
     C                     Z-ADDWKAWPC    WL0075           Conversion Fact
     C                     MOVELWKLXST    WL0076           Operation Facto
     C                     MOVELWKAECD    WL0077           U/M - Second
     C                     Z-ADDWKAXPC    WL0078           Conversion Fact
     C                     MOVELWKLYST    WL0079           Operation Facto
     C                     MOVELWKAFCD    WL0080           U/M - Third
     C                     MOVELWKAICD    WL0081           U/M - Pricing
     C                     Z-ADDWKAIWG    WL0082           Unit Weight
     C                     MOVELWKFZST    WL0083           Production Date
     C                     MOVELWKAVST    WL0084           Catch Weight St
     C                     Z-ADDWKCHTM    WL0085           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Status/Default     RT - Item Balance  * From Warehouse
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0086    WLAIC3           Company Number
     C                     Z-ADDWL0087    WLHGCD           Item Code
     C                     MOVELWL0088    WLAJCD           Warehouse Code
      * Establish starting position
     C           KRSSP     CHAIN@B0REJX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0089           Unit Cost Per P
     C                     MOVEL*BLANK    WL0090           Cost Update Pen
     C                     MOVEL*BLANK    WL0091           Post G/L Status
     C                     Z-ADD*ZERO     WL0092           Vendor - Item/W
     C                     MOVEL*BLANK    WL0093           Record Status
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWLAGCS    WL0089           Unit Cost Per P
     C                     MOVELWLJ9ST    WL0090           Cost Update Pen
     C                     MOVELWLKBST    WL0091           Post G/L Status
     C                     Z-ADDWLAKC8    WL0092           Vendor - Item/W
     C                     MOVELWLVSST    WL0093           Record Status
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0094    WKAIC3           Company Number
     C                     Z-ADDWL0095    WKHGCD           Item Code
      * Establish starting position
     C           KRSSQ     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKRINB    WL0096           Item Structure
     C                     Z-ADDWKRHNB    WL0097           Item Structure
     C                     Z-ADDWKRGNB    WL0098           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQSR01           Company Number
     C           *LIKE     DEFN WMHGCD    WQSR02           Item Code
     C           *LIKE     DEFN WMAJCD    WQSR03           Warehouse Code
     C           *LIKE     DEFN WMW9ST    WQSR04           Inventory Trans
     C           *LIKE     DEFN WMBSST    WQSR05           Inventory Trans
     C           *LIKE     DEFN WMB4DT    WQSR06           Transaction Dat
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Item Code
     C                     KFLD           WQSR03           Warehouse Code
     C                     KFLD           WQSR04           Inventory Trans
     C                     KFLD           WQSR05           Inventory Trans
     C                     KFLD           WQSR06           Transaction Dat
      * Setup key
     C                     Z-ADDWL0099    WQSR01           Company Number
     C                     Z-ADDWL0100    WQSR02           Item Code
     C                     MOVELWL0101    WQSR03           Warehouse Code
     C                     MOVELWL0102    WQSR04           Inventory Trans
     C                     MOVELWL0103    WQSR05           Inventory Trans
     C                     Z-ADDWL0104    WQSR06           Transaction Dat
      * Establish starting position
     C           KRSSR     SETLL@B7CPZA                    *
     C           KRSSR     READE@B7CPZA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0105           ITD Sequence Nu
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WMC4NY    ADD  1         WL0105           ITD Sequence Nu
     C                     GOTO SREXIT                     *QUIT
     C           KRSSR     READE@B7CPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0143  60       Job Time
     C                     MOVEL*BLANK    WN0144 10        User Id
     C                     MOVEL*BLANK    WN0145 10        Job Name
     C                     Z-ADD*ZERO     WN0146  70       Job Date
     C                     Z-ADD*ZERO     WN0147  20       Production Hour
     C                     Z-ADD*ZERO     WN0148 112       Production Weig
     C                     Z-ADD*ZERO     WN0149  50       Production Quan
     C                     Z-ADD*ZERO     WN0150  70       Production Piec
     C                     MOVEL*BLANK    WN0151  1        Export/Domestic
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B7CPJZ
     C                     Z-ADDWL0106    WOAIC3           Company Number
     C                     Z-ADDWL0107    WOHGCD           Item Code
     C                     MOVELWL0108    WOAJCD           Warehouse Code
     C                     MOVELWL0109    WOW9ST           Inventory Trans
     C                     MOVELWL0110    WOBSST           Inventory Trans
     C                     Z-ADDWL0111    WOB4DT           Transaction Dat
     C                     Z-ADDWL0112    WOC4NY           ITD Sequence Nu
     C                     Z-ADDWL0113    WODXNB           Sequence Number
     C                     Z-ADDWL0114    WOELDT           Production Date
     C                     MOVELWL0115    WOHVCD           U/M - Transacti
     C                     MOVELWL0116    WOF1ST           Item Transactio
     C                     MOVELWL0117    WOAUNA           Description
     C                     Z-ADDWL0118    WOA5QT           Transaction Qua
     C                     Z-ADDWL0119    WOAHWG           Transaction Wei
     C                     Z-ADDWL0120    WOAKCS           USR Transaction
     C                     MOVELWL0121    WOCGCD           U/M - Cost
     C                     Z-ADDWL0122    WOAYVA           Extended Amount
     C                     MOVELWL0123    WOBJNA           Ticket Number
     C                     Z-ADDWL0124    WOCKNB           G/L Document Nu
     C                     MOVELWL0125    WOBMST           G/L Update Stat
     C                     MOVELWL0126    WOCQCD           Reason Code
     C                     MOVELWL0127    WODTCD           Reference Numbe
     C                     MOVELWL0128    WOMGNA           Lot ID
     C                     Z-ADDWL0129    WOTRBN           Transfer Batch
     C                     Z-ADDWL0130    WOTRBS           Transfer Batch
     C                     Z-ADDWL0131    WOC4NB           Order Number
     C                     Z-ADDWL0132    WORINB           Item Structure
     C                     Z-ADDWL0133    WORHNB           Item Structure
     C                     Z-ADDWL0134    WORGNB           Item Structure
     C                     MOVELWL0135    WOM3NA           Employee Badge
     C                     Z-ADDWL0136    WOAWTM           Production Time
     C                     MOVELWL0137    WOXLCD           Shift Number
     C                     Z-ADDWL0138    WOK7DT           Label Date
     C                     MOVELWL0139    WOUVST           EDI Status 1
     C                     MOVELWL0140    WOUWST           EDI Status 2
     C                     MOVELWL0141    WOUXST           EDI Status 3
     C                     MOVELWL0142    WOVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WOAATM           Job Time
     C                     MOVEL##USR     WOAYNA           User Id
     C                     MOVEL##JOB     WOA0NA           Job Name
     C                     Z-ADD##JDT     WOAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WOAXDT    PARM *ZERO     WQ0001 155       Current System
     C           WOAATM    PARM *ZERO     WQ0002 155       Current System
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSS    KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOHGCD           Item Code
     C                     KFLD           WOAJCD           Warehouse Code
     C                     KFLD           WOW9ST           Inventory Trans
     C                     KFLD           WOBSST           Inventory Trans
     C                     KFLD           WOB4DT           Transaction Dat
     C                     KFLD           WOC4NY           ITD Sequence Nu
     C                     KFLD           WODXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSS    SETLL@B7CPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0345' W0RTN   7
      * Send message 'Item Transaction Detai EX'
     C                     MOVEL'USR0345' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@B7CPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                     CALL 'POO5XFR'              90  Crt Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WOAIC3    WQ0003  30       Company Number
     C                     PARM WOHGCD    WQ0004  70       Item Code
     C                     PARM WOAJCD    WQ0005  3        Warehouse Code
     C                     PARM WOW9ST    WQ0006  1        Inventory Trans
     C                     PARM WOBSST    WQ0007  2        Inventory Trans
     C                     PARM WOB4DT    WQ0008  70       Transaction Dat
     C                     PARM WODXNB    WQ0009  30       Sequence Number
     C                     PARM WOELDT    WQ0010  70       Production Date
     C                     PARM WOHVCD    WQ0011  2        U/M - Transacti
     C                     PARM WOF1ST    WQ0012  2        Item Transactio
     C                     PARM WOAUNA    WQ0013 30        Description
     C                     PARM WOA5QT    WQ0014 112       Transaction Qua
     C                     PARM WOAHWG    WQ0015 112       Transaction Wei
     C                     PARM WOAKCS    WQ0016 114       USR Transaction
     C                     PARM WOCGCD    WQ0017  2        U/M - Cost
     C                     PARM WOAYVA    WQ0018 112       Extended Amount
     C                     PARM WOBJNA    WQ0019  6        Ticket Number
     C                     PARM WOCKNB    WQ0020  80       G/L Document Nu
     C                     PARM WOBMST    WQ0021  1        G/L Update Stat
     C                     PARM WOCQCD    WQ0022  3        Reason Code
     C                     PARM WODTCD    WQ0023 15        Reference Numbe
     C                     PARM WOMGNA    WQ0024 10        Lot ID
     C                     PARM WOTRBN    WQ0025  70       Transfer Batch
     C                     PARM WOTRBS    WQ0026  30       Transfer Batch
     C                     PARM WOC4NB    WQ0027  70       Order Number
     C                     PARM WORINB    WQ0028  30       Item Structure
     C                     PARM WORHNB    WQ0029  30       Item Structure
     C                     PARM WORGNB    WQ0030  30       Item Structure
     C                     PARM WOM3NA    WQ0031 10        Employee Badge
     C                     PARM WOAWTM    WQ0032  60       Production Time
     C                     PARM WOXLCD    WQ0033  1        Shift Number
     C                     PARM WOK7DT    WQ0034  70       Label Date
     C                     PARM WOVSST    WQ0035  1        Record Status
     C                     PARM WOAATM    WQ0036  60       Job Time
     C                     PARM WOAXDT    WQ0037  70       Job Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * CHG Value/Qty/Wgt      CH - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0152 112       Physical Count
     C                     Z-ADD*ZERO     WN0153 112       Physical Count
     C                     Z-ADD*ZERO     WN0154 112       Physical Count
     C                     Z-ADD*ZERO     WN0155 112       Physical Count
     C                     MOVEL*BLANK    WN0156  1        Physical Count
     C                     Z-ADD*ZERO     WN0157 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0158 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0159 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0160 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0161 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0162 112       Weight In Chill
     C                     MOVEL*BLANK    WN0163  1        Update Exceptio
     C                     Z-ADD*ZERO     WN0164 112       Physical Start
     C                     Z-ADD*ZERO     WN0165 112       Physical Start
     C                     Z-ADD*ZERO     WN0166 112       Physical Start
     C                     Z-ADD*ZERO     WN0167 112       Physical Start
     C                     Z-ADD*ZERO     WN0168  70       Physical Start
     C                     Z-ADD*ZERO     WN0169 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0170 114       Last Cost
     C                     Z-ADD*ZERO     WN0171 112       Value of On Han
     C                     Z-ADD*ZERO     WN0172  70       Label Date
     C                     MOVEL*BLANK    WN0173  1        EDI Status 1
     C                     MOVEL*BLANK    WN0174  1        EDI Status 2
     C                     MOVEL*BLANK    WN0175  1        EDI Status 3
     C                     MOVEL*BLANK    WN0176  1        Record Status
     C                     Z-ADD*ZERO     WN0177  60       Job Time
     C                     MOVEL*BLANK    WN0178 10        User Id
     C                     MOVEL*BLANK    WN0179 10        Job Name
     C                     Z-ADD*ZERO     WN0180  70       Job Date
     C                     MOVEL*BLANK    WN0181  1        Shift Number
     C                     MOVEL*BLANK    WN0182  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
     C                     MOVEL'1'       WN0181           Shift Number
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADD#1AIC3    WFAIC3           Company Number
     C                     Z-ADD#1HGCD    WFHGCD           Item Code
     C                     MOVEL#1AJCD    WFAJCD    P      Warehouse Code
     C                     Z-ADD#1ELDT    WFELDT           Production Date
      *
     C           KLCHST    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
     C           KLCHST    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0143           Company Number
     C                     Z-ADD#1HGCD    WL0144           Item Code
     C                     MOVEL#1AJCD    WL0145    P      Warehouse Code
     C                     Z-ADD#1ELDT    WL0146           Production Date
     C                     Z-ADD*ZERO     WL0147           Physical Count
     C                     Z-ADD*ZERO     WL0148           Physical Count
     C                     Z-ADD*ZERO     WL0149           Physical Count
     C                     Z-ADD*ZERO     WL0150           Physical Count
     C                     MOVEL*BLANK    WL0151           Physical Count
     C                     Z-ADDYL0026    WL0152           Quantity on Han
     C                     Z-ADDWN0131    WL0153           Quantity on Han
     C                     Z-ADD*ZERO     WL0154           Quantity on Han
     C                     Z-ADD*ZERO     WL0155           Quantity on Han
     C                     Z-ADD*ZERO     WL0156           Quantity In Chi
     C                     Z-ADD*ZERO     WL0157           Weight In Chill
     C                     MOVEL'N'       WL0158    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0159           Physical Start
     C                     Z-ADD*ZERO     WL0160           Physical Start
     C                     Z-ADD*ZERO     WL0161           Physical Start
     C                     Z-ADD*ZERO     WL0162           Physical Start
     C                     Z-ADD*ZERO     WL0163           Physical Start
     C                     Z-ADD*ZERO     WL0164           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0165           Last Cost
     C                     Z-ADDWN0130    WL0166           Value of On Han
     C                     Z-ADDYL0007    WL0167           Label Date
     C                     Z-ADDWN0124    WL0168           Item Structure
     C                     Z-ADDWN0125    WL0169           Item Structure
     C                     Z-ADDWN0126    WL0170           Item Structure
     C                     MOVEL*BLANK    WL0171           EDI Status 1
     C                     MOVEL*BLANK    WL0172           EDI Status 2
     C                     MOVEL*BLANK    WL0173           EDI Status 3
     C                     MOVEL'A'       WL0174    P      Record Status
     C                     EXSR SUCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YCRDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWN0124    WFRINB           Item Structure
     C                     Z-ADDWN0125    WFRHNB           Item Structure
     C                     Z-ADDWN0126    WFRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YCRDC            *Record Data Ch
     C                     ADD  WN0131    WFARQT           Quantity on Han
     C                     ADD  YL0026    WFACWG           Quantity on Han
     C                     ADD  WN0130    WFIDVA           Value of On Han
      * If quantity is zero, so are weight, value of inventory
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WFARQT    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - Item Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WFAIC3    WQ0040  30       Company Number
     C                     PARM WFHGCD    WQ0041  70       Item Code
     C                     PARM WFAJCD    WQ0042  3        Warehouse Code
     C                     PARM ##JDT     WQ0043  70       Transaction Dat
     C                     PARM WFELDT    WQ0044  70       Production Date
     C                     PARM YL0010    WQ0045  2        U/M - Transacti
     C                     PARM WFACWG    WQ0046 112       Transaction Wei
     C                     PARM *ZERO     WQ0047 114       USR Transaction
     C                     PARM 'LB'      WQ0048  2        U/M - Cost
     C                     PARM WFRINB    WQ0049  30       Item Structure
     C                     PARM WFRHNB    WQ0050  30       Item Structure
     C                     PARM WFRGNB    WQ0051  30       Item Structure
     C                     PARM WN0181    WQ0052  1        Shift Number
     C                     PARM WFK7DT    WQ0053  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WFACWG           Quantity on Han
     C                     Z-ADD*ZERO     WFIDVA           Value of On Han
     C                     END                             *FI
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WFAXDT    PARM *ZERO     WQ0054 155       Current System
     C           WFAATM    PARM *ZERO     WQ0055 155       Current System
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WFARQT    IFEQ WUW0NB                     *IF
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWFAJCD    WL0175    P      Warehouse Code
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0176    WN0182    P      Lot Tracking Fl
      * CASE: PAR.Lot Tracking Flag is Not Yes
     C           WN0182    IFEQ *BLANK                     *IF
     C           WN0182    OREQ 'N'
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0177           Company Number
     C                     Z-ADDWFHGCD    WL0178           Item Code
     C                     MOVELWFAJCD    WL0179    P      Warehouse Code
     C                     Z-ADDWFELDT    WL0180           Production Date
     C                     EXSR SWDLRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCRRC    BEGSR
      *================================================================
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0183  60       Job Time
     C                     MOVEL*BLANK    WN0184 10        User Id
     C                     MOVEL*BLANK    WN0185 10        Job Name
     C                     Z-ADD*ZERO     WN0186  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1REJ1
     C                     Z-ADDWL0143    WFAIC3           Company Number
     C                     Z-ADDWL0144    WFHGCD           Item Code
     C                     MOVELWL0145    WFAJCD           Warehouse Code
     C                     Z-ADDWL0146    WFELDT           Production Date
     C                     Z-ADDWL0147    WFABWG           Physical Count
     C                     Z-ADDWL0148    WFAGQT           Physical Count
     C                     Z-ADDWL0149    WFAHQT           Physical Count
     C                     Z-ADDWL0150    WFAIQT           Physical Count
     C                     MOVELWL0151    WFCTST           Physical Count
     C                     Z-ADDWL0152    WFACWG           Quantity on Han
     C                     Z-ADDWL0153    WFARQT           Quantity on Han
     C                     Z-ADDWL0154    WFASQT           Quantity on Han
     C                     Z-ADDWL0155    WFATQT           Quantity on Han
     C                     Z-ADDWL0156    WFHDQT           Quantity In Chi
     C                     Z-ADDWL0157    WFHEQT           Weight In Chill
     C                     MOVELWL0158    WFF6ST           Update Exceptio
     C                     Z-ADDWL0159    WFBMWG           Physical Start
     C                     Z-ADDWL0160    WFDSQT           Physical Start
     C                     Z-ADDWL0161    WFDTQT           Physical Start
     C                     Z-ADDWL0162    WFDUQT           Physical Start
     C                     Z-ADDWL0163    WFDHDT           Physical Start
     C                     Z-ADDWL0164    WFAGCS           Unit Cost Per P
     C                     Z-ADDWL0165    WFAECS           Last Cost
     C                     Z-ADDWL0166    WFIDVA           Value of On Han
     C                     Z-ADDWL0167    WFK7DT           Label Date
     C                     Z-ADDWL0168    WFRINB           Item Structure
     C                     Z-ADDWL0169    WFRHNB           Item Structure
     C                     Z-ADDWL0170    WFRGNB           Item Structure
     C                     MOVELWL0171    WFUVST           EDI Status 1
     C                     MOVELWL0172    WFUWST           EDI Status 2
     C                     MOVELWL0173    WFUXST           EDI Status 3
     C                     MOVELWL0174    WFVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WFAXDT    PARM *ZERO     WQ0038 155       Current System
     C           WFAATM    PARM *ZERO     WQ0039 155       Current System
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSU    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSU    SETLL@B1REJ1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0331' W0RTN   7
      * Send message 'Item Balance Detail    EX'
     C                     MOVEL'USR0331' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C                     WRITE@B1REJ1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WRAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0175    WRAJCD           Warehouse Code
      * Establish starting position
     C           KRSSV     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0176           Lot Tracking Fl
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRVHST    WL0176           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWDLRC    BEGSR
      *================================================================
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDWL0177    WFAIC3           Company Number
     C                     Z-ADDWL0178    WFHGCD           Item Code
     C                     MOVELWL0179    WFAJCD           Warehouse Code
     C                     Z-ADDWL0180    WFELDT           Production Date
      *
     C           KLDLSW    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
     C           KLDLSW    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0184           Quantity on Han
     C                     Z-ADD*ZERO     WL0185           Quantity on Han
     C                     Z-ADD*ZERO     WL0186           Quantity on Han
     C                     Z-ADD*ZERO     WL0187           Quantity on Han
     C                     Z-ADD*ZERO     WL0188           Value of On Han
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSAIC3    WQSX01           Company Number
     C           *LIKE     DEFN WSHGCD    WQSX02           Item Code
     C           *LIKE     DEFN WSAJCD    WQSX03           Warehouse Code
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Item Code
     C                     KFLD           WQSX03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0181    WQSX01           Company Number
     C                     Z-ADDWL0182    WQSX02           Item Code
     C                     MOVELWL0183    WQSX03           Warehouse Code
      * Establish starting position
     C           KRSSX     SETLLCAB1RL4                    *
     C           KRSSX     READECAB1RL4                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WSACWG    WL0184           Quantity on Han
     C                     ADD  WSARQT    WL0185           Quantity on Han
     C                     ADD  WSASQT    WL0186           Quantity on Han
     C                     ADD  WSATQT    WL0187           Quantity on Han
     C                     ADD  WSIDVA    WL0188           Value of On Han
     C           KRSSX     READECAB1RL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * Chg Val/Qty/Wgt        Ch - IC Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0187 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0188 114       Last Cost
     C                     Z-ADD*ZERO     WN0189 114       Cost per Primar
     C                     Z-ADD*ZERO     WN0190 114       Cost per Pricin
     C                     Z-ADD*ZERO     WN0191 114       Revaluation Cos
     C                     Z-ADD*ZERO     WN0192  70       Revaluation Eff
     C                     MOVEL*BLANK    WN0193  1        Revaluation Cos
     C                     Z-ADD*ZERO     WN0194 114       Last Revaluatio
     C                     Z-ADD*ZERO     WN0195  70       Last Revaluatio
     C                     Z-ADD*ZERO     WN0196 112       On Hand U/M2 Su
     C                     Z-ADD*ZERO     WN0197 112       On Hand U/M3 Su
     C                     Z-ADD*ZERO     WN0198 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0199 112       Weight In Chill
     C                     Z-ADD*ZERO     WN0200 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0201 112       Quantity on Sal
     C                     Z-ADD*ZERO     WN0202 112       Quantity on Pur
     C                     Z-ADD*ZERO     WN0203 112       Quantity on Tra
     C                     Z-ADD*ZERO     WN0204 112       Quantity Avail.
     C                     MOVEL*BLANK    WN0205  3        Cycle Count Cod
     C                     Z-ADD*ZERO     WN0206  70       Date of Last Or
     C                     Z-ADD*ZERO     WN0207  70       Date of Last Sh
     C                     MOVEL*BLANK    WN0208  1        Inventory Plann
     C                     Z-ADD*ZERO     WN0209  52       Safety Allowanc
     C                     Z-ADD*ZERO     WN0210 112       Safety Allowanc
     C                     Z-ADD*ZERO     WN0211  70       Stock Out Date
     C                     MOVEL*BLANK    WN0212  3        Buyer Code
     C                     Z-ADD*ZERO     WN0213  30       Lead Time - Las
     C                     Z-ADD*ZERO     WN0214  70       Lead Time - Dat
     C                     Z-ADD*ZERO     WN0215  30       Lead Time - Nex
     C                     Z-ADD*ZERO     WN0216  70       Lead Time - Dat
     C                     MOVEL*BLANK    WN0217  1        Lead Time - Exc
     C                     Z-ADD*ZERO     WN0218 112       Usage Qty per C
     C                     Z-ADD*ZERO     WN0219 112       Usage Weight pe
     C                     Z-ADD*ZERO     WN0220  70       Inventory Manag
     C                     Z-ADD*ZERO     WN0221 112       Minimum Quantit
     C                     Z-ADD*ZERO     WN0222 112       Maximum Quantit
     C                     Z-ADD*ZERO     WN0223  70       Last Physical C
     C                     MOVEL*BLANK    WN0224  1        Requisition Mod
     C                     MOVEL*BLANK    WN0225  1        Cost Update Pen
     C                     MOVEL*BLANK    WN0226  1        Post G/L Status
     C                     Z-ADD*ZERO     WN0227  80       Vendor - Item/W
     C                     Z-ADD*ZERO     WN0228  30       Item Structure
     C                     Z-ADD*ZERO     WN0229  30       Item Structure
     C                     Z-ADD*ZERO     WN0230  30       Item Structure
     C                     MOVEL*BLANK    WN0231  1        EDI Status 1
     C                     MOVEL*BLANK    WN0232  1        EDI Status 2
     C                     MOVEL*BLANK    WN0233  1        EDI Status 3
     C                     MOVEL*BLANK    WN0234  1        Record Status
     C                     Z-ADD*ZERO     WN0235  60       Job Time
     C                     MOVEL*BLANK    WN0236 10        User Id
     C                     MOVEL*BLANK    WN0237 10        Job Name
     C                     Z-ADD*ZERO     WN0238  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADD#1AIC3    WTAIC3           Company Number
     C                     Z-ADD#1HGCD    WTHGCD           Item Code
     C                     MOVEL#1AJCD    WTAJCD    P      Warehouse Code
      *
     C           KLCHSY    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C           KLCHSY    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YDRDCS
      * Move non-key fields to @B0REJT
     C                     Z-ADDWN0134    WTBOWG           On Hand Weight
     C                     Z-ADDWN0135    WTDDQT           On Hand U/M1 Su
     C                     Z-ADDWN0136    WTIDVA           Value of On Han
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YDRDC            *Record Data Ch
      * Refresh the available to sell quantity
     C                     Z-ADDWTDDQT    WTDOQT           Quantity Avail.
     C                     SUB  WTAQQT    WTDOQT           Quantity Avail.
     C                     SUB  WTAUQT    WTDOQT           Quantity Avail.
     C                     SUB  WTEMQT    WTDOQT           Quantity Avail.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##JOB     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Warehouse Info     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WRAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0189    WRAJCD           Warehouse Code
      * Establish starting position
     C           KRSSZ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0190           Warehouse Descr
     C                     MOVEL*BLANK    WL0191           Address Line 1
     C                     MOVEL*BLANK    WL0192           Address Line 2
     C                     MOVEL*BLANK    WL0193           Address Line 3
     C                     MOVEL*BLANK    WL0194           City
     C                     MOVEL*BLANK    WL0195           Zip/Postal Code
     C                     MOVEL*BLANK    WL0196           Production Ware
     C                     MOVEL*BLANK    WL0197           State Code
     C                     MOVEL*BLANK    WL0198           Lot Tracking Fl
     C                     MOVEL*BLANK    WL0199           Default Printer
     C                     MOVEL*BLANK    WL0200           Warehouse Type
     C                     MOVEL*BLANK    WL0201           Trans Contol AS
     C                     MOVEL*BLANK    WL0202           Warehouse Locat
     C                     MOVEL*BLANK    WL0203           Warehouse Std C
     C                     Z-ADD*ZERO     WL0204           Warehouse Chill
     C                     MOVEL*BLANK    WL0205           Include in Auto
     C                     MOVEL*BLANK    WL0206           Default Manifes
     C                     MOVEL*BLANK    WL0207           Default Load Se
     C                     MOVEL*BLANK    WL0208           WHS Slotting Li
     C                     Z-ADD*ZERO     WL0209           Shipping Compan
     C                     Z-ADD*ZERO     WL0210           Accounting Comp
     C                     Z-ADD*ZERO     WL0211           WHS Sched Prod
     C                     Z-ADD*ZERO     WL0212           WHS Inventory C
     C                     MOVEL*BLANK    WL0213           Parent Warehous
     C                     MOVEL*BLANK    WL0214           Default Shippin
     C                     MOVEL*BLANK    WL0215           WHS Live w/Carl
     C                     MOVEL*BLANK    WL0216           WHS PFS Interfa
     C                     MOVEL*BLANK    WL0217           WHS Req Meter R
     C                     MOVEL*BLANK    WL0218           WHS Default Loa
     C                     MOVEL*BLANK    WL0219           WHS Unused Sts
     C                     MOVEL*BLANK    WL0220           Default Carrier
     C                     MOVEL*BLANK    WL0221           WHS TPM Locatio
     C                     MOVEL*BLANK    WL0222           WHS Unused Sts
     C                     MOVEL*BLANK    WL0223           EDI Status 1
     C                     MOVEL*BLANK    WL0224           EDI Status 2
     C                     MOVEL*BLANK    WL0225           EDI Status 3
     C                     MOVEL*BLANK    WL0226           Record Status
     C                     Z-ADD*ZERO     WL0227           Job Time
     C                     MOVEL*BLANK    WL0228           User Id
     C                     MOVEL*BLANK    WL0229           Job Name
     C                     Z-ADD*ZERO     WL0230           Job Date
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRF8NA    WL0190           Warehouse Descr
     C                     MOVELWRACNA    WL0191           Address Line 1
     C                     MOVELWRADNA    WL0192           Address Line 2
     C                     MOVELWRAENA    WL0193           Address Line 3
     C                     MOVELWRAJNA    WL0194           City
     C                     MOVELWRBTTX    WL0195           Zip/Postal Code
     C                     MOVELWRAOCD    WL0196           Production Ware
     C                     MOVELWRBGCD    WL0197           State Code
     C                     MOVELWRVHST    WL0198           Lot Tracking Fl
     C                     MOVELWRMPNA    WL0199           Default Printer
     C                     MOVELWRWPST    WL0200           Warehouse Type
     C                     MOVELWRXUST    WL0201           Trans Contol AS
     C                     MOVELWRT0ST    WL0202           Warehouse Locat
     C                     MOVELWRT1ST    WL0203           Warehouse Std C
     C                     Z-ADDWRDBNB    WL0204           Warehouse Chill
     C                     MOVELWRT2ST    WL0205           Include in Auto
     C                     MOVELWRT3ST    WL0206           Default Manifes
     C                     MOVELWRT4ST    WL0207           Default Load Se
     C                     MOVELWRT6ST    WL0208           WHS Slotting Li
     C                     Z-ADDWRBWC3    WL0209           Shipping Compan
     C                     Z-ADDWRBTC3    WL0210           Accounting Comp
     C                     Z-ADDWRBUC3    WL0211           WHS Sched Prod
     C                     Z-ADDWRBVC3    WL0212           WHS Inventory C
     C                     MOVELWRFCAA    WL0213           Parent Warehous
     C                     MOVELWRRQSX    WL0214           Default Shippin
     C                     MOVELWRRRSX    WL0215           WHS Live w/Carl
     C                     MOVELWRRSSX    WL0216           WHS PFS Interfa
     C                     MOVELWRRTSX    WL0217           WHS Req Meter R
     C                     MOVELWRT7ST    WL0218           WHS Default Loa
     C                     MOVELWRT8ST    WL0219           WHS Unused Sts
     C                     MOVELWRRNSX    WL0220           Default Carrier
     C                     MOVELWRROSX    WL0221           WHS TPM Locatio
     C                     MOVELWRRPSX    WL0222           WHS Unused Sts
     C                     MOVELWRUVST    WL0223           EDI Status 1
     C                     MOVELWRUWST    WL0224           EDI Status 2
     C                     MOVELWRUXST    WL0225           EDI Status 3
     C                     MOVELWRVSST    WL0226           Record Status
     C                     Z-ADDWRAATM    WL0227           Job Time
     C                     MOVELWRAYNA    WL0228           User Id
     C                     MOVELWRA0NA    WL0229           Job Name
     C                     Z-ADDWRAXDT    WL0230           Job Date
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Whse Location Info RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAJCD    WQTA01           Warehouse Code
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Warehouse Code
      * Setup key
     C                     MOVELWL0231    WQTA01           Warehouse Code
      * Establish starting position
     C           KRSTA     SETLL@L2RESM                    *
     C           KRSTA     READE@L2RESM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0232           Location Code
     C                     MOVEL*BLANK    WL0233           Location Aisle
     C                     Z-ADD*ZERO     WL0234           Location Bay
     C                     Z-ADD*ZERO     WL0235           Loc Unused Chil
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGYMCD    WL0232           Location Code
     C                     MOVELWGYPCD    WL0233           Location Aisle
     C                     Z-ADDWGLCBY    WL0234           Location Bay
     C                     Z-ADDWGLCCT    WL0235           Loc Unused Chil
     C                     GOTO TAEXIT                     *QUIT
     C           KRSTA     READE@L2RESM                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Shipping Co        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WRAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#DBNAA    WRAJCD           Warehouse Code
      * Establish starting position
     C           KRSTB     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0040           Shipping Compan
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRBWC3    YL0040           Shipping Compan
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Val Item Balance       RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVHGCD           Item Code
     C                     KFLD           WVAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDYL0040    WVAIC3           Company Number
     C                     Z-ADD#1HGCD    WVHGCD           Item Code
     C                     MOVEL#DBNAA    WVAJCD           Warehouse Code
      * Establish starting position
     C           KRSTC     CHAIN@B0REYY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   W0RTN            *Return code
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDCRRC    BEGSR
      *================================================================
      * Crt Item Balance       CR - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0239  60       Job Time
     C                     MOVEL*BLANK    WN0240 10        User Id
     C                     MOVEL*BLANK    WN0241 10        Job Name
     C                     Z-ADD*ZERO     WN0242  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B0REJT
     C                     Z-ADDYL0040    WTAIC3           Company Number
     C                     Z-ADD#1HGCD    WTHGCD           Item Code
     C                     MOVEL#DBNAA    WTAJCD           Warehouse Code
     C                     Z-ADDYL0032    WTAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WTAECS           Last Cost
     C                     Z-ADD*ZERO     WTBACS           Cost per Primar
     C                     Z-ADD*ZERO     WTBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WTCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WTGUDT           Revaluation Eff
     C                     MOVELWUGSTX    WTXYST           Revaluation Cos
     C                     Z-ADD*ZERO     WTCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WTG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WTBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WTDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WTDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WTDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WTHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WTHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WTAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WTAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WTAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WTEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WTDOQT           Quantity Avail.
     C                     MOVEL*BLANK    WTATNA           Cycle Count Cod
     C                     Z-ADD*ZERO     WTAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WTANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WTIDVA           Value of On Han
     C                     MOVELWUGSTX    WTJVST           Inventory Plann
     C                     Z-ADD*ZERO     WTBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WTDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WTDIDT           Stock Out Date
     C                     MOVEL*BLANK    WTALCD           Buyer Code
     C                     Z-ADD*ZERO     WTBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WTDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WTBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WTDKDT           Lead Time - Dat
     C                     MOVEL'N'       WTJ2ST           Lead Time - Exc
     C                     Z-ADD*ZERO     WTDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WTBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WTDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WTDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WTDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WTDMDT           Last Physical C
     C                     MOVELWUGSTX    WTM0ST           Requisition Mod
     C                     MOVELWUGSTX    WTJ9ST           Cost Update Pen
     C                     MOVELWUGSTX    WTKBST           Post G/L Status
     C                     Z-ADD*ZERO     WTAKC8           Vendor - Item/W
     C                     Z-ADDWN0124    WTRINB           Item Structure
     C                     Z-ADDWN0125    WTRHNB           Item Structure
     C                     Z-ADDWN0126    WTRGNB           Item Structure
     C                     MOVELWUUVST    WTUVST           EDI Status 1
     C                     MOVELWUUWST    WTUWST           EDI Status 2
     C                     MOVELWUUXST    WTUXST           EDI Status 3
     C                     MOVEL'A'       WTVSST           Record Status
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WTAATM' defaulted for 'Job Time'.
      * Field '(DB1) WTAYNA' defaulted for 'User Id'.
      * Field '(DB1) WTA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WTAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##JOB     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
     C           KLCRTD    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRTD    SETLL@B0REJT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0329' W0RTN   7
      * Send message 'Item Balance           EX'
     C                     MOVEL'USR0329' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C                     WRITE@B0REJT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Prc Create Dtl Receipt RT - Item Transaction Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0243  2        U/M - Cost
     C                     Z-ADD*ZERO     WN0244 112       Extended Amount
     C                     MOVEL*BLANK    WN0245  1        G/L Update Stat
     C                     MOVEL*BLANK    WN0246 30        Description Lin
     C                     MOVEL*BLANK    WN0247  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0248  94       Conversion Fact
     C                     MOVEL*BLANK    WN0249  1        Operation Facto
     C                     MOVEL*BLANK    WN0250  2        U/M - Second
     C                     Z-ADD*ZERO     WN0251  94       Conversion Fact
     C                     MOVEL*BLANK    WN0252  1        Operation Facto
     C                     MOVEL*BLANK    WN0253  2        U/M - Third
     C                     MOVEL*BLANK    WN0254  2        U/M - Pricing
     C                     Z-ADD*ZERO     WN0255 112       Unit Weight
     C                     MOVEL*BLANK    WN0256  1        Production Date
     C                     MOVEL*BLANK    WN0257  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0258  30       Item Structure
     C                     Z-ADD*ZERO     WN0259  30       Item Structure
     C                     Z-ADD*ZERO     WN0260  30       Item Structure
     C                     Z-ADD*ZERO     WN0261 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0262 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0263 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0264 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0265 114       Unit Cost Per P
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WWAIC3           Company Number
     C                     KFLD           WWHGCD           Item Code
     C                     KFLD           WWAJCD           Warehouse Code
     C                     KFLD           WWW9ST           Inventory Trans
     C                     KFLD           WWBSST           Inventory Trans
     C                     KFLD           WWB4DT           Transaction Dat
     C                     KFLD           WWC4NY           ITD Sequence Nu
     C                     KFLD           WWDXNB           Sequence Number
      * Setup key
     C                     Z-ADDYL0040    WWAIC3           Company Number
     C                     Z-ADD#1HGCD    WWHGCD           Item Code
     C                     MOVEL#DBNAA    WWAJCD           Warehouse Code
     C                     MOVEL'T'       WWW9ST           Inventory Trans
     C                     MOVEL'TW'      WWBSST           Inventory Trans
     C                     Z-ADD##JDT     WWB4DT           Transaction Dat
     C                     Z-ADDWN0127    WWC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WWDXNB           Sequence Number
      * Establish starting position
     C           KRSTE     CHAINRB7CPJ3              90    *
      * Data record not found
     C   90                MOVEL'USR0344' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv Base Values        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWWAIC3    WL0070           Company Number
     C                     Z-ADDWWHGCD    WL0071           Item Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0072    WN0246    P      Description Lin
     C                     MOVELWL0073    WUAWNA    P      Description Lin
     C                     MOVELWL0074    WN0247    P      U/M - Primary
     C                     Z-ADDWL0075    WN0248           Conversion Fact
     C                     MOVELWL0076    WN0249    P      Operation Facto
     C                     MOVELWL0077    WN0250    P      U/M - Second
     C                     Z-ADDWL0078    WN0251           Conversion Fact
     C                     MOVELWL0079    WN0252    P      Operation Facto
     C                     MOVELWL0080    WN0253    P      U/M - Third
     C                     MOVELWL0081    WUAICD    P      U/M - Pricing
     C                     Z-ADDWL0082    WN0255           Unit Weight
     C                     MOVELWL0083    WN0256    P      Production Date
     C                     MOVELWL0084    WN0257    P      Catch Weight St
     C                     Z-ADDWL0085    WUCHTM           Fresh Chilling
      * Rtv Quantity/Dollars   RT - Item Balance  * 
     C                     EXSR TFRVGN
      * UPD Value/Qty/Wgt      CH - Item Balance  * 
     C                     EXSR TGCHRC
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Quantity/Dollars   RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWWAIC3    WLAIC3           Company Number
     C                     Z-ADDWWHGCD    WLHGCD           Item Code
     C                     MOVELWWAJCD    WLAJCD           Warehouse Code
      * Establish starting position
     C           KRSTF     CHAIN@B0REJX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0265           Unit Cost Per P
     C                     Z-ADD*ZERO     WN0261           On Hand Weight
     C                     Z-ADD*ZERO     WN0262           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WN0263           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WN0264           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WUIDVA           Value of On Han
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWLAGCS    WN0265           Unit Cost Per P
     C                     Z-ADDWLBOWG    WN0261           On Hand Weight
     C                     Z-ADDWLDDQT    WN0262           On Hand U/M1 Su
     C                     Z-ADDWLDEQT    WN0263           On Hand U/M2 Su
     C                     Z-ADDWLDFQT    WN0264           On Hand U/M3 Su
     C                     Z-ADDWLIDVA    WUIDVA           Value of On Han
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCHRC    BEGSR
      *================================================================
      * UPD Value/Qty/Wgt      CH - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0266 112       Quantity based
     C                     Z-ADD*ZERO     WN0267 112       Quantity based
     C                     Z-ADD*ZERO     WN0268 112       Quantity based
     C                     Z-ADD*ZERO     WN0269 114       Cost based on U
     C                     Z-ADD*ZERO     WN0270 114       Cost based on U
     C                     Z-ADD*ZERO     WN0271 114       Cost based on U
     C                     Z-ADD*ZERO     WN0272 112       Quantity Total
     C                     Z-ADD*ZERO     WN0273 112       Quantity Total
     C                     Z-ADD*ZERO     WN0274 112       Cost Replace Do
     C                     Z-ADD*ZERO     WN0275 112       USR Allocated P
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      *
     C                     Z-ADD*ZERO     WN0276 114       Cost based on U
     C                     Z-ADD*ZERO     WN0277 114       Cost based on U
     C                     Z-ADD*ZERO     WN0278 114       Cost based on U
      *
      * Clc Convert Cost       IF
      * Initialize parameter values
     C                     Z-ADD*ZERO     WN0269           Cost based on U
     C                     Z-ADD*ZERO     WN0270           Cost based on U
     C                     Z-ADD*ZERO     WN0271           Cost based on U
      * Process based on Unit of Measure entered
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Cost
     C           WN0247    IFEQ WWCGCD                     *IF
     C                     Z-ADDWN0265    WN0269           Cost based on U
      * Process second U/M if entered
      * CASE: PAR.U/M - Second is Entered
     C           WN0250    IFNE *BLANK                     *IF
      * Convert based on operation code
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0249    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0248    IFNE *ZERO                      *IF
     C           WN0265    DIV  WN0248    WN0277    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0249    IFEQ 'D'                        *IF
     C           WN0265    MULT WN0248    WN0277    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0277    WN0270           Cost based on U
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0253    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0252    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0251    IFNE *ZERO                      *IF
     C           WN0277    DIV  WN0251    WN0271    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0252    IFEQ 'D'                        *IF
     C           WN0277    MULT WN0251    WN0271    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Cost
     C           WN0250    IFEQ WWCGCD                     *IF
     C                     Z-ADDWN0265    WN0270           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0249    IFEQ 'M'                        *IF
     C           WN0265    MULT WN0248    WN0269    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0249    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0248    IFNE *ZERO                      *IF
     C           WN0265    DIV  WN0248    WN0269    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0253    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0252    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0251    IFNE *ZERO                      *IF
     C           WN0265    DIV  WN0251    WN0271    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0252    IFEQ 'D'                        *IF
     C           WN0265    MULT WN0251    WN0271    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Cost
     C           WN0253    IFEQ WWCGCD                     *IF
     C                     Z-ADDWN0265    WN0271           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0252    IFEQ 'M'                        *IF
     C           WN0265    MULT WN0251    WN0277    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0252    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0251    IFNE *ZERO                      *IF
     C           WN0265    DIV  WN0251    WN0277    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0277    WN0270           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0249    IFEQ 'M'                        *IF
     C           WN0277    MULT WN0248    WN0269    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0249    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0248    IFNE *ZERO                      *IF
     C           WN0277    DIV  WN0248    WN0269    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0279 112       Quantity based
     C                     Z-ADD*ZERO     WN0280 112       Quantity based
     C                     Z-ADD*ZERO     WN0281 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0266           USR Qty based o
     C                     Z-ADD*ZERO     WN0267           USR Qty based o
     C                     Z-ADD*ZERO     WN0268           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           WN0247    IFEQ WWHVCD                     *IF
     C                     Z-ADDWWA5QT    WN0266           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           WN0250    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0249    IFEQ 'M'                        *IF
     C           WWA5QT    MULT WN0248    WN0280    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0249    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0248    IFNE *ZERO                      *IF
     C           WWA5QT    DIV  WN0248    WN0280    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0280    WN0267           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0253    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0252    IFEQ 'M'                        *IF
     C           WN0280    MULT WN0251    WN0281    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0252    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0251    IFNE *ZERO                      *IF
     C           WN0280    DIV  WN0251    WN0281    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0281    WN0268           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           WN0250    IFEQ WWHVCD                     *IF
     C                     Z-ADDWWA5QT    WN0267           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0249    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0248    IFNE *ZERO                      *IF
     C           WWA5QT    DIV  WN0248    WN0266    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0249    IFEQ 'D'                        *IF
     C           WWA5QT    MULT WN0248    WN0266    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0253    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0252    IFEQ 'M'                        *IF
     C           WWA5QT    MULT WN0251    WN0281    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0252    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0251    IFNE *ZERO                      *IF
     C           WWA5QT    DIV  WN0251    WN0281    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0281    WN0268           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           WN0253    IFEQ WWHVCD                     *IF
     C                     Z-ADDWWA5QT    WN0268           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0252    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0251    IFNE *ZERO                      *IF
     C           WWA5QT    DIV  WN0251    WN0280    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0252    IFEQ 'D'                        *IF
     C           WWA5QT    MULT WN0251    WN0280    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0280    WN0267           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0249    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0248    IFNE *ZERO                      *IF
     C           WN0280    DIV  WN0248    WN0266    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0249    IFEQ 'D'                        *IF
     C           WN0280    MULT WN0248    WN0266    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWWAIC3    WTAIC3           Company Number
     C                     Z-ADDWWHGCD    WTHGCD           Item Code
     C                     MOVELWWAJCD    WTAJCD    P      Warehouse Code
      *
     C           KLCHTG    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C           KLCHTG    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YERDCS
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YERDC            *Record Data Ch
      * (Creates IB if not found or updates if it exists)
      * Update IC Item Balance Detail
      * UPD Value/Qty          RT - IC Item Balance Detail  * 
     C                     EXSR THRVGN
      * Update the quantity/weight on hand in the item balance file
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0181           Company Number
     C                     Z-ADDWTHGCD    WL0182           Item Code
     C                     MOVELWTAJCD    WL0183    P      Warehouse Code
     C                     Z-ADDWTBOWG    WL0184           Quantity on Han
     C                     Z-ADDWTDDQT    WL0185           Quantity on Han
     C                     Z-ADDWUNFNN    WL0186           Quantity on Han
     C                     Z-ADDWUNFNN    WL0187           Quantity on Han
     C                     Z-ADDWTIDVA    WL0188           Value of On Han
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0184    WTBOWG           Quantity on Han
     C                     Z-ADDWL0185    WTDDQT           Quantity on Han
     C                     Z-ADDWL0186    WUNFNN           Quantity on Han
     C                     Z-ADDWL0187    WUNFNN           Quantity on Han
     C                     Z-ADDWL0188    WTIDVA           Value of On Han
     C                     Z-ADD*ZERO     WTDOQT           Available Prima
      * Available Primary U/M
     C           WTDDQT    SUB  WTAJQT    WTDOQT           Available Prima
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WTAATM' defaulted for 'Job Time'.
      * Field '(DB1) WTAYNA' defaulted for 'User Id'.
      * Field '(DB1) WTA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WTAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##JOB     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * UPD Value/Qty          RT - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0282 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0283 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0284 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0285 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0286 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0287 114       Last Cost
     C                     Z-ADD*ZERO     WN0288 112       Value of On Han
     C                     MOVEL*BLANK    WN0289  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEELDT           Production Date
      * Setup key
     C                     Z-ADDWTAIC3    WEAIC3           Company Number
     C                     Z-ADDWTHGCD    WEHGCD           Item Code
     C                     MOVELWTAJCD    WEAJCD           Warehouse Code
     C                     Z-ADDWWELDT    WEELDT           Production Date
      * Establish starting position
     C           KRSTH     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
      * CASE: PAR.Quantity based on U/M1 S EQ WRK.ZERO
     C           WN0266    IFEQ WUW0NB                     *IF
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0143           Company Number
     C                     Z-ADDWTHGCD    WL0144           Item Code
     C                     MOVELWTAJCD    WL0145    P      Warehouse Code
     C                     Z-ADDWWELDT    WL0146           Production Date
     C                     Z-ADD*ZERO     WL0147           Physical Count
     C                     Z-ADD*ZERO     WL0148           Physical Count
     C                     Z-ADD*ZERO     WL0149           Physical Count
     C                     Z-ADD*ZERO     WL0150           Physical Count
     C                     MOVEL*BLANK    WL0151           Physical Count
     C                     Z-ADD*ZERO     WL0152           Quantity on Han
     C                     Z-ADDWN0266    WL0153           Quantity on Han
     C                     Z-ADD*ZERO     WL0154           Quantity on Han
     C                     Z-ADD*ZERO     WL0155           Quantity on Han
     C                     Z-ADD*ZERO     WL0156           Quantity In Chi
     C                     Z-ADD*ZERO     WL0157           Weight In Chill
     C                     MOVEL'N'       WL0158    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0159           Physical Start
     C                     Z-ADD*ZERO     WL0160           Physical Start
     C                     Z-ADD*ZERO     WL0161           Physical Start
     C                     Z-ADD*ZERO     WL0162           Physical Start
     C                     Z-ADD*ZERO     WL0163           Physical Start
     C                     Z-ADD*ZERO     WL0164           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0165           Last Cost
     C                     Z-ADD*ZERO     WL0166           Value of On Han
     C                     Z-ADDWWK7DT    WL0167           Label Date
     C                     Z-ADDWTRINB    WL0168           Item Structure
     C                     Z-ADDWTRHNB    WL0169           Item Structure
     C                     Z-ADDWTRGNB    WL0170           Item Structure
     C                     MOVEL*BLANK    WL0171           EDI Status 1
     C                     MOVEL*BLANK    WL0172           EDI Status 2
     C                     MOVEL*BLANK    WL0173           EDI Status 3
     C                     MOVEL'A'       WL0174    P      Record Status
     C                     EXSR SUCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0143           Company Number
     C                     Z-ADDWTHGCD    WL0144           Item Code
     C                     MOVELWTAJCD    WL0145    P      Warehouse Code
     C                     Z-ADDWWELDT    WL0146           Production Date
     C                     Z-ADD*ZERO     WL0147           Physical Count
     C                     Z-ADD*ZERO     WL0148           Physical Count
     C                     Z-ADD*ZERO     WL0149           Physical Count
     C                     Z-ADD*ZERO     WL0150           Physical Count
     C                     MOVEL*BLANK    WL0151           Physical Count
     C                     Z-ADDWWAHWG    WL0152           Quantity on Han
     C                     Z-ADDWN0266    WL0153           Quantity on Han
     C                     Z-ADD*ZERO     WL0154           Quantity on Han
     C                     Z-ADD*ZERO     WL0155           Quantity on Han
     C                     Z-ADD*ZERO     WL0156           Quantity In Chi
     C                     Z-ADD*ZERO     WL0157           Weight In Chill
     C                     MOVEL'N'       WL0158    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0159           Physical Start
     C                     Z-ADD*ZERO     WL0160           Physical Start
     C                     Z-ADD*ZERO     WL0161           Physical Start
     C                     Z-ADD*ZERO     WL0162           Physical Start
     C                     Z-ADD*ZERO     WL0163           Physical Start
     C                     Z-ADD*ZERO     WL0164           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0165           Last Cost
     C                     Z-ADDWWAYVA    WL0166           Value of On Han
     C                     Z-ADDWWK7DT    WL0167           Label Date
     C                     Z-ADDWTRINB    WL0168           Item Structure
     C                     Z-ADDWTRHNB    WL0169           Item Structure
     C                     Z-ADDWTRGNB    WL0170           Item Structure
     C                     MOVEL*BLANK    WL0171           EDI Status 1
     C                     MOVEL*BLANK    WL0172           EDI Status 2
     C                     MOVEL*BLANK    WL0173           EDI Status 3
     C                     MOVEL'A'       WL0174    P      Record Status
     C                     EXSR SUCRRC
     C                     END                             *FI
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Calculate new On Hand Value
      * CASE: PAR.Inventory Trans. Type is Adjustment Cycle Count
     C           WWBSST    IFEQ 'AC'                       *IF
     C           WEIDVA    ADD  WWAYVA    WN0288           Value of On Han
     C                     ELSE
      * CASE: PAR.Inventory Trans. Type is Quantity based Avg. Cost
     C           WWBSST    IFEQ 'R'                        *IF
     C           WWBSST    OREQ 'RP'
     C           WWBSST    OREQ 'S'
     C           WWBSST    OREQ 'TW'
     C           WWBSST    OREQ 'RW'
     C           WWBSST    OREQ 'RR'
     C           WEIDVA    ADD  WWAYVA    WN0288           Value of On Han
     C                     END                             *FI
     C                     END                             *FI
     C           WWAHWG    ADD  WEACWG    WN0282           Quantity on Han
     C           WEARQT    ADD  WN0266    WN0283           Quantity on Han
      * If quantity goes TO exactly 0, wgt and value to go 0
      * CASE: PAR.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WN0283    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - IC Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0065  30       Company Number
     C                     PARM WEHGCD    WQ0066  70       Item Code
     C                     PARM WEAJCD    WQ0067  3        Warehouse Code
     C                     PARM WWB4DT    WQ0068  70       Transaction Dat
     C                     PARM WEELDT    WQ0069  70       Production Date
     C                     PARM WWHVCD    WQ0070  2        U/M - Transacti
     C                     PARM WN0282    WQ0071 112       Transaction Wei
     C                     PARM WN0286    WQ0072 114       USR Transaction
     C                     PARM WWCGCD    WQ0073  2        U/M - Cost
     C                     PARM WERINB    WQ0074  30       Item Structure
     C                     PARM WERHNB    WQ0075  30       Item Structure
     C                     PARM WERGNB    WQ0076  30       Item Structure
     C                     PARM '1'       WQ0077  1        Shift Number
     C                     PARM WEK7DT    WQ0078  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WN0282           Quantity on Han
     C                     Z-ADD*ZERO     WN0288           Value of On Han
     C                     END                             *FI
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWEAJCD    WL0175    P      Warehouse Code
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0176    WN0289    P      Lot Tracking Fl
      * CASE: Qty = 0 & production date <> 0 & Lot Trk=N
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Quantity on Hand - U/M1 EQ WRK.ZERO
      *   |- c2    : DB1.Production Date NE WRK.ZERO
      *   |- c3    : PAR.Lot Tracking Flag is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0283    IFEQ WUW0NB                     *IF
     C           WEELDT    IFNE WUW0NB                     *IF
     C           WN0289    IFEQ *BLANK                     *IF
     C           WN0289    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Dlt Item Bal. Detail   DL - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0177           Company Number
     C                     Z-ADDWEHGCD    WL0178           Item Code
     C                     MOVELWEAJCD    WL0179    P      Warehouse Code
     C                     Z-ADDWEELDT    WL0180           Production Date
     C                     EXSR SWDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
     C                     EXSR TICHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICHRC    BEGSR
      *================================================================
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0290  70       Label Date
     C                     MOVEL*BLANK    WN0291  1        EDI Status 1
     C                     MOVEL*BLANK    WN0292  1        EDI Status 2
     C                     MOVEL*BLANK    WN0293  1        EDI Status 3
     C                     MOVEL*BLANK    WN0294  1        Record Status
     C                     Z-ADD*ZERO     WN0295  60       Job Time
     C                     MOVEL*BLANK    WN0296 10        User Id
     C                     MOVEL*BLANK    WN0297 10        Job Name
     C                     Z-ADD*ZERO     WN0298  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWEAIC3    WFAIC3           Company Number
     C                     Z-ADDWEHGCD    WFHGCD           Item Code
     C                     MOVELWEAJCD    WFAJCD    P      Warehouse Code
     C                     Z-ADDWEELDT    WFELDT           Production Date
      *
     C           KLCHTI    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
     C           KLCHTI    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YFRDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWEABWG    WFABWG           Physical Count
     C                     Z-ADDWEAGQT    WFAGQT           Physical Count
     C                     Z-ADDWEAHQT    WFAHQT           Physical Count
     C                     Z-ADDWEAIQT    WFAIQT           Physical Count
     C                     MOVELWECTST    WFCTST    P      Physical Count
     C                     Z-ADDWN0282    WFACWG           Quantity on Han
     C                     Z-ADDWN0283    WFARQT           Quantity on Han
     C                     Z-ADDWEASQT    WFASQT           Quantity on Han
     C                     Z-ADDWEATQT    WFATQT           Quantity on Han
     C                     Z-ADDWEHDQT    WFHDQT           Quantity In Chi
     C                     Z-ADDWEHEQT    WFHEQT           Weight In Chill
     C                     MOVELWEF6ST    WFF6ST    P      Update Exceptio
     C                     Z-ADDWEBMWG    WFBMWG           Physical Start
     C                     Z-ADDWEDSQT    WFDSQT           Physical Start
     C                     Z-ADDWEDTQT    WFDTQT           Physical Start
     C                     Z-ADDWEDUQT    WFDUQT           Physical Start
     C                     Z-ADDWEDHDT    WFDHDT           Physical Start
     C                     Z-ADDWEAGCS    WFAGCS           Unit Cost Per P
     C                     Z-ADDWEAECS    WFAECS           Last Cost
     C                     Z-ADDWN0288    WFIDVA           Value of On Han
     C                     Z-ADDWERINB    WFRINB           Item Structure
     C                     Z-ADDWERHNB    WFRHNB           Item Structure
     C                     Z-ADDWERGNB    WFRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
     C                     MOVEL##PGM     WFA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WYAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0236    WYAJCD           Warehouse Code
      * Establish starting position
     C           KRSTJ     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0237           Warehouse Descr
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWYF8NA    WL0237           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           TAAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    TAAIC3           Company Number
      * Establish starting position
     C           KRSTK     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DADTX           Name
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTAADTX    #DADTX           Name
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Rtv Item Descriptions  RT - OM Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           TBHGCD           Item Code
      * Setup key
     C                     Z-ADD#1HGCD    TBHGCD           Item Code
      * Establish starting position
     C           KRSTL     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DOONA           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTBAVNA    #DOONA           Description Lin
     C                     MOVELTBAWNA    WUAWNA           Description Lin
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           TCAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0299    TCAJVN           User Profile Na
      * Establish starting position
     C           KRSTM     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   W0RTN            *Return code
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTCI6ST    P2I6ST           Allow Multi-Com
     C                     MOVELTCMPNA    P2MPNA           Default Printer
     C                     MOVELTCBCCD    P2BCCD           Salesperson Cod
     C                     Z-ADDTCAIC3    YL0044           Company Number
     C                     MOVELTCBUVN    WN0300           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           TDAJVN           User Profile Na
     C                     KFLD           TDDNCD           Application Cod
      * Setup key
     C                     MOVELWL0238    TDAJVN           User Profile Na
     C                     MOVELWL0239    TDDNCD           Application Cod
      * Establish starting position
     C           KRSTN     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTDAIC3    WL0240           Company Number
     C                     MOVELTDAJCD    WL0241           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TEDNCD    WQTO01           Application Cod
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQTO01           Application Cod
     C                     MOVEL'I/C'     WQTO01           Application Cod
      * Establish starting position
     C           KRSTO     SETLL@DNRESF                    *
     C           KRSTO     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           TERSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELTEAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TPRVGN
     C                     END                             *FI
     C           KRSTO     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TEDNCD    WQTP01           Application Cod
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP01           Application Cod
      * Setup key
     C                     MOVELTERSCD    WQTP01           Application Cod
      * Establish starting position
     C           KRSTP     SETLL@DNRESF                    *
     C           KRSTP     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL@CN,002   W0RTN            *Return code
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTEAUNA    WUAUNA           Description
     C           KRSTP     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * Rtv Allow Multi-Whs   RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           TCAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     TCAJVN           User Profile Na
      * Establish starting position
     C           KRSTQ     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P2I8ST           Allow Multi War
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTCI8ST    P2I8ST           Allow Multi War
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      *
      *================================================================
      * ** 12/18/13 RMC C2954 Crt cab7cpp with system dt alieu jobdate
      * ** 08/25/09 PKD E00475 Do not adjust On-Hand for Internal
      * ** To Whs
      * **
      * ** 12/05/2008 LJB FP1127 Update located on-hand Whse inventory
      * ** Only process loc quantity if not a Carlisle Controlled warehou
      * ** and lot tracking has been turned on.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Reset Production/Label Date if Lot Tracking warehouse.
      *================================================================
     C                     Z-ADD#1ELDT    WN0137           Production Date
     C                     Z-ADDYL0007    WN0138           Label Date  USR
      * Determine the Lot Tracking Flag for From Warehouse.
      * If the From Warehouse Lot Tracking Flag is "N", then perform the
      * following "Clc" to determine if the To Warehouse Lot Tracking
      * Flag is "Y" and replace the Production Date with Job Date if it
      * is "Y".
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** FP1127 LJB 12/2008
      * ** Process Auto-Locate Whse inventory added to UPD Balances
      * ** Transfer IF. Recompile.
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1AJCD    WK1X02  1
     C                     MOVELV1HGCD    WK1X04  1
     C                     MOVEL#1YMCD    WK1X05  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1AJCD'
     C           YPMTFD    OREQ '#1LXNM'
     C           WK1X04    OREQ '?'                        Item Code
     C           YPMTFD    OREQ '#1HGCD'
     C           WK1X05    OREQ '?'                        Location Code
     C           YPMTFD    OREQ '#1YMCD'
     C           YPMTFD    OREQ '#1YNCD'
     C           YPMTFD    OREQ '#1ELDT'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1HGCD' defaulted for 'Item Code'.
      * Field '(DTL) #1AJCD' defaulted for 'Warehouse Code'.
      * Field '(DTL) #1ELDT' defaulted for 'Production Date'.
      * Field '(DTL) #1LXNM' defaulted for 'Lot Number'.
      * Field '(DTL) #1YMCD' defaulted for 'Location Code'.
      * Field '(DTL) #1YNCD' defaulted for 'Location Level'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1J2QT' defaulted for 'ILL Item Qty On-Hand'.
      * Field '(DTL) #1LODT' defaulted for 'ILL Avail Ship Date'.
      * Field '(DTL) #1LPDT' defaulted for 'ILL Unused Date 1'.
      * Field '(DTL) #1AMSX' defaulted for 'ILL Status'.
      * Field '(DTL) #1YSCD' defaulted for 'Inv Hold Reason Code'.
     C                     CALL 'PDK4SRR'              90  Sel Item Lot/Lo
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0092  30       Company Number
     C           #1HGCD    PARM #1HGCD    WQ0093  70       Item Code
     C           #1AJCD    PARM #1AJCD    WQ0094  3        Warehouse Code
     C           #1ELDT    PARM #1ELDT    WQ0095  70       Production Date
     C           #1LXNM    PARM #1LXNM    WQ0096  50       Lot Number
     C           #1YMCD    PARM #1YMCD    WQ0097  4        Location Code
     C           #1YNCD    PARM #1YNCD    WQ0098  20       Location Level
     C           #1J2QT    PARM #1J2QT    WQ0099  50       ILL Item Qty On
     C           #1LODT    PARM #1LODT    WQ0100  70       ILL Avail Ship
     C           #1LPDT    PARM #1LPDT    WQ0101  70       ILL Unused Date
     C           #1AMSX    PARM #1AMSX    WQ0102  1        ILL Status
     C           #1YSCD    PARM #1YSCD    WQ0103  3        Inv Hold Reason
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDK4SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1LXNM    IFNE *ZERO                      Lot Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1HGCD    IFNE *ZERO                      Item Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X04    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1YMCD    IFNE *BLANK                     Location Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X05    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1YNCD    IFNE *ZERO                      Location Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1ELDT    IFNE *ZERO                      Production Date
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Item Balance Detail
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1HGCD    WK1X02  1
     C                     MOVEL#1AJCD    WK1X03  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Item Code
     C           YPMTFD    OREQ '#1HGCD'
     C           WK1X03    OREQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1AJCD'
     C           YPMTFD    OREQ '#1ELDT'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1HGCD' defaulted for 'Item Code'.
      * Field '(DTL) #1AJCD' defaulted for 'Warehouse Code'.
      * Field '(DTL) #1ELDT' defaulted for 'Production Date'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0041' defaulted for 'Label Date'.
     C                     CALL 'PDZESRR'              90  Sel Prod Date-M
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0104  30       Company Number
     C                     PARM #1HGCD    WQ0105  70       Item Code
     C                     PARM #1AJCD    WQ0106  3        Warehouse Code
     C           #1ELDT    PARM #1ELDT    WQ0107  70       Production Date
     C           YL0041    PARM *ZERO     WQ0108  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZESRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1HGCD    IFNE *ZERO                      Item Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X03    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1ELDT    IFNE *ZERO                      Production Date
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HGCD    IFEQ *ZERO                      Item Code
     C           #1ELDT    ANDEQ*ZERO                      Production Date
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEELDT           Production Date
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3
     C                     Z-ADD#1HGCD    WEHGCD
     C                     MOVEL#1AJCD    WEAJCD
     C                     Z-ADD#1ELDT    WEELDT
     C           KLVBWE    CHAIN@B1REJ0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Item Balance Detail    NF'
     C                     MOVEL'USR0330' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0330' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Warehouse Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AJCD    WK1X01  1
     C                     MOVEL#1YMCD    WK1X02  1
     C           WK1X01    IFEQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1AJCD'
     C           WK1X02    OREQ '?'                        Location Code
     C           YPMTFD    OREQ '#1YMCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AJCD' defaulted for 'Warehouse Code'.
      * Field '(DTL) #1YMCD' defaulted for 'Location Code'.
     C                     CALL 'PDHSSRR'              90  Sel Whs Locatio
     C                     PARM *BLANK    W0RTN   7
     C           #1AJCD    PARM #1AJCD    WQ0109  3        Warehouse Code
     C           #1YMCD    PARM #1YMCD    WQ0110  4        Location Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1YMCD    IFNE *BLANK                     Location Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1YMCD    IFEQ *BLANK                     Location Code
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWG    KLIST
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGYMCD           Location Code
      * Setup key
     C                     MOVEL#1AJCD    WGAJCD
     C                     MOVEL#1YMCD    WGYMCD
     C           KLVCWG    CHAIN@L2RESM              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Warehouse Location     NF'
     C                     MOVEL'USR2628' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2628' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Item Hold Reason
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1YSCD    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Inv Hold Reason
     C           YPMTFD    OREQ '#1YSCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1YSCD' defaulted for 'Inv Hold Reason Code'.
     C                     CALL 'PDHWSRR'              90  Sel Item Hold R
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0111  30       Company Number
     C           #1YSCD    PARM #1YSCD    WQ0112  3        Inv Hold Reason
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1YSCD    IFNE *BLANK                     Inv Hold Reason
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1YSCD    IFEQ *BLANK                     Inv Hold Reason
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWX    KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXYSCD           Inv Hold Reason
      * Setup key
     C                     Z-ADD#1AIC3    WXAIC3
     C                     MOVEL#1YSCD    WXYSCD
     C           KLVDWX    CHAIN@L4RESS              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Item Hold Reason       NF'
     C                     MOVEL'USR2632' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2632' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2DQCD           Enterprise Code
     C                     MOVEL*BLANK    P2DRCD           Enterprise Code
     C                     MOVEL*BLANK    P2BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P2B8NA           System Date For
     C                     MOVEL*BLANK    P2AJVN           User Profile Na
     C                     MOVEL*BLANK    P2I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P2I8ST           Allow Multi War
     C                     MOVEL*BLANK    P2MPNA           Default Printer
     C                     MOVEL*BLANK    P2TAST           First Time Flag
     C                     MOVEL*BLANK    P2ADTX           Name
     C                     MOVEL*BLANK    P2BXTX           System Value Al
     C                     MOVEL*BLANK    P2WVST           Access Denied (
     C                     Z-ADD*ZERO     P2EIDT           Requested Deliv
     C                     MOVEL*BLANK    P3WXST           Record Found US
     C                     MOVEL*BLANK    P4VYST           Record Found -P
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field LTT Unused Sts 1
     C                     MOVEL*BLANK    WULLTU  1
      * Define work field LTT Unused Sts 2
     C                     MOVEL*BLANK    WULLYT  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WALRDT           LLT Trans Date
     C                     Z-ADD*ZERO     WALLTS           LLT Sequence #
     C                     Z-ADD*ZERO     WALSDT           LLT Production
     C                     Z-ADD*ZERO     WAJ5QT           LLT Trans Qty
     C                     Z-ADD*ZERO     WAG8WG           LLT Trans Wgt
     C                     Z-ADD*ZERO     WALLTN           LLT Lot Number
     C                     Z-ADD*ZERO     WALLCL           LLT Location Le
     C                     Z-ADD*ZERO     WALLTR           LLT Transfer Lo
     C                     Z-ADD*ZERO     WALLTL           LLT Transfer Lo
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCELDT           Production Date
     C                     Z-ADD*ZERO     WCLXNM           Lot Number
     C                     Z-ADD*ZERO     WCYNCD           Location Level
     C                     Z-ADD*ZERO     WCJ2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     WCG5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     WCJ3QT           ILL Co-Packer L
     C                     Z-ADD*ZERO     WCG6WG           ILl Item Wgt On
     C                     Z-ADD*ZERO     WCJ4QT           ILL Unused Qty
     C                     Z-ADD*ZERO     WCG7WG           ILL Unused Wgt
     C                     Z-ADD*ZERO     WCLODT           ILL Avail Ship
     C                     Z-ADD*ZERO     WCLPDT           ILL Unused Date
     C                     Z-ADD*ZERO     WCLQDT           ILL Unused Date
     C                     Z-ADD*ZERO     WCNBR            ILL Unused Nbr
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEELDT           Production Date
     C                     Z-ADD*ZERO     WEABWG           Physical Count
     C                     Z-ADD*ZERO     WEAGQT           Physical Count
     C                     Z-ADD*ZERO     WEAHQT           Physical Count
     C                     Z-ADD*ZERO     WEAIQT           Physical Count
     C                     Z-ADD*ZERO     WEACWG           Quantity on Han
     C                     Z-ADD*ZERO     WEARQT           Quantity on Han
     C                     Z-ADD*ZERO     WEASQT           Quantity on Han
     C                     Z-ADD*ZERO     WEATQT           Quantity on Han
     C                     Z-ADD*ZERO     WEHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WEHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WEBMWG           Physical Start
     C                     Z-ADD*ZERO     WEDSQT           Physical Start
     C                     Z-ADD*ZERO     WEDTQT           Physical Start
     C                     Z-ADD*ZERO     WEDUQT           Physical Start
     C                     Z-ADD*ZERO     WEDHDT           Physical Start
     C                     Z-ADD*ZERO     WEAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WEAECS           Last Cost
     C                     Z-ADD*ZERO     WEIDVA           Value of On Han
     C                     Z-ADD*ZERO     WEK7DT           Label Date
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGLCBY           Location Bay
     C                     Z-ADD*ZERO     WGLCCT           Loc Unused Chil
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field WL Unused Sts 1
     C                     MOVEL*BLANK    WUWLUS  1
      * Define work field WL Unused Sts 2
     C                     MOVEL*BLANK    WUWUSD  1
      * Define work field WL PFS Zone
     C                     MOVEL*BLANK    WUWLUN  2
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field EDI Status 2
     C                     MOVEL*BLANK    WUUWST  1
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WISLTY           WLT Type Chill
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJAXNB           Current Account
     C                     Z-ADD*ZERO     WJNGNB           Current Account
     C                     Z-ADD*ZERO     WJBZNB           OM Week
     C                     Z-ADD*ZERO     WJC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WJC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WJCYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WJIONB           Next Late Charg
     C                     Z-ADD*ZERO     WJI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WJDCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WJC7NB           Next Customer #
     C                     Z-ADD*ZERO     WJC2NB           Next Inventory
     C                     Z-ADD*ZERO     WJC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WJL8NB           Next Contract/P
     C                     Z-ADD*ZERO     WJBANB           Next HPB Batch
     C                     Z-ADD*ZERO     WJAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WJASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WJA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WJAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WJABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WJACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WJADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WJAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WJAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WJAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WJAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WJAENB           Retention Perio
     C                     Z-ADD*ZERO     WJALNB           Retention Perio
     C                     Z-ADD*ZERO     WJEVNB           Retention Perio
     C                     Z-ADD*ZERO     WJRPOP           Retention Perio
     C                     Z-ADD*ZERO     WJDWNB           Retention Perio
     C                     Z-ADD*ZERO     WJR3NB           Next Load ID
     C                     Z-ADD*ZERO     WJR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WJSCNB           Production Numb
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WKAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WKAIWG           Unit Weight
     C                     Z-ADD*ZERO     WKCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WKC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WKURTN           Number Cases On
     C                     Z-ADD*ZERO     WKAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WKRINB           Item Structure
     C                     Z-ADD*ZERO     WKRHNB           Item Structure
     C                     Z-ADD*ZERO     WKRGNB           Item Structure
     C                     Z-ADD*ZERO     WKTFNB           Transportation
     C                     Z-ADD*ZERO     WKTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WKTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WKBLPR           Market Overage
     C                     Z-ADD*ZERO     WKBMPR           Standard Overag
     C                     Z-ADD*ZERO     WKCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WKCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WKSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WKPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WKICN1           Item Category N
     C                     Z-ADD*ZERO     WKICN2           Item Category N
     C                     Z-ADD*ZERO     WKV2NB           Item Category N
     C                     Z-ADD*ZERO     WKITCN           Item Category N
     C                     Z-ADD*ZERO     WKITC5           Item Category N
     C                     Z-ADD*ZERO     WKICN6           Item Category N
     C                     Z-ADD*ZERO     WKICN7           Item Category N
     C                     Z-ADD*ZERO     WKICN8           Item Category N
     C                     Z-ADD*ZERO     WKICN9           Item Category N
     C                     Z-ADD*ZERO     WKICN0           Item Category N
     C                     Z-ADD*ZERO     WKSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WKA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WKSJNB           Production Lead
     C                     Z-ADD*ZERO     WKSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WKSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WKSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WKCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WKCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WKILNB           Packages per ca
     C                     Z-ADD*ZERO     WKCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WKCINB           PM Batch Size
     C                     Z-ADD*ZERO     WKCJNB           Package Level s
     C                     Z-ADD*ZERO     WKCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WKCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WKCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WKCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WKCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WKCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WKCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WKCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WKC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WKB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WKB5NB           PM Line Number
     C                     Z-ADD*ZERO     WKBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WKBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WKF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WKF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WKF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WKBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WKBNNB           Production Qty
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field USR Weight
     C                     Z-ADD*ZERO     WUASWG 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLHGCD           Item Code
     C                     Z-ADD*ZERO     WLAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WLAECS           Last Cost
     C                     Z-ADD*ZERO     WLBACS           Cost per Primar
     C                     Z-ADD*ZERO     WLBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WLCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WLGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WLCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WLG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WLBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WLDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WLDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WLDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WLHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WLHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WLAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WLAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WLAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WLEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WLDOQT           Quantity Avail.
     C                     Z-ADD*ZERO     WLAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WLANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WLIDVA           Value of On Han
     C                     Z-ADD*ZERO     WLBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WLDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WLDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WLBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WLDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WLBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WLDKDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WLDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WLBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WLDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WLDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WLDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WLDMDT           Last Physical C
     C                     Z-ADD*ZERO     WLAKC8           Vendor - Item/W
     C                     Z-ADD*ZERO     WLRINB           Item Structure
     C                     Z-ADD*ZERO     WLRHNB           Item Structure
     C                     Z-ADD*ZERO     WLRGNB           Item Structure
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Transaction Weight
     C                     Z-ADD*ZERO     WUAHWG 112
      * Define work field Transaction Quantity
     C                     Z-ADD*ZERO     WUA5QT 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMHGCD           Item Code
     C                     Z-ADD*ZERO     WMB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WMC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WMDXNB           Sequence Number
     C                     Z-ADD*ZERO     WMELDT           Production Date
     C                     Z-ADD*ZERO     WMA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WMAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WMAKCS           USR Transaction
     C                     Z-ADD*ZERO     WMAYVA           Extended Amount
     C                     Z-ADD*ZERO     WMCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WMTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WMTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WMC4NB           Order Number
     C                     Z-ADD*ZERO     WMRINB           Item Structure
     C                     Z-ADD*ZERO     WMRHNB           Item Structure
     C                     Z-ADD*ZERO     WMRGNB           Item Structure
     C                     Z-ADD*ZERO     WMAWTM           Production Time
     C                     Z-ADD*ZERO     WMK7DT           Label Date
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Clear all neither parameters
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Clear all neither parameters
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WRBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WRBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WRBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WRBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field Location Code
     C                     MOVEL*BLANK    WUYMCD  4
      * Define work field Location Level
     C                     Z-ADD*ZERO     WUYNCD  20
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Clear all neither parameters
      * Crt Item Balance       CR - Item Balance  * 
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field U/M - Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Value of On Hand Inventor
     C                     Z-ADD*ZERO     WUIDVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXAIC3           Company Number
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TAAIC3           Company Number
     C                     Z-ADD*ZERO     TAAATM           Job Time
     C                     Z-ADD*ZERO     TAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TBHGCD           Item Code
     C                     Z-ADD*ZERO     TBAWPC           Conversion Fact
     C                     Z-ADD*ZERO     TBAXPC           Conversion Fact
     C                     Z-ADD*ZERO     TBAIWG           Unit Weight
     C                     Z-ADD*ZERO     TBCZWG           Minimum Weight
     C                     Z-ADD*ZERO     TBC0WG           Maximum Weight
     C                     Z-ADD*ZERO     TBURTN           Number Cases On
     C                     Z-ADD*ZERO     TBACC8           Vendor item Def
     C                     Z-ADD*ZERO     TBRINB           Item Structure
     C                     Z-ADD*ZERO     TBRHNB           Item Structure
     C                     Z-ADD*ZERO     TBRGNB           Item Structure
     C                     Z-ADD*ZERO     TBTFNB           Transportation
     C                     Z-ADD*ZERO     TBCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     TBSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     TBPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     TBSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     TBA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     TBSJNB           Production Lead
     C                     Z-ADD*ZERO     TBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     TBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     TBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     TBCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     TBCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     TBILNB           Packages per ca
     C                     Z-ADD*ZERO     TBCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     TBCINB           PM Batch Size
     C                     Z-ADD*ZERO     TBCJNB           Package Level s
     C                     Z-ADD*ZERO     TBCMNB           Partial Item Co
     C                     Z-ADD*ZERO     TBCNNB           WIP Item Code
     C                     Z-ADD*ZERO     TBCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     TBCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     TBCVNB           FP Std Green We
     C                     Z-ADD*ZERO     TBCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     TBCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     TBCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     TBC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     TBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     TBTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     TBTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     TBBLPR           Market Overage
     C                     Z-ADD*ZERO     TBBMPR           Standard Overag
     C                     Z-ADD*ZERO     TBCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     TBAIC3           Company Number
     C                     Z-ADD*ZERO     TBICN1           Item Category N
     C                     Z-ADD*ZERO     TBICN2           Item Category N
     C                     Z-ADD*ZERO     TBV2NB           Item Category N
     C                     Z-ADD*ZERO     TBITCN           Item Category N
     C                     Z-ADD*ZERO     TBITC5           Item Category N
     C                     Z-ADD*ZERO     TBICN6           Item Category N
     C                     Z-ADD*ZERO     TBICN7           Item Category N
     C                     Z-ADD*ZERO     TBICN8           Item Category N
     C                     Z-ADD*ZERO     TBICN9           Item Category N
     C                     Z-ADD*ZERO     TBICN0           Item Category N
     C                     Z-ADD*ZERO     TBB5NB           PM Line Number
     C                     Z-ADD*ZERO     TBBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     TBBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     TBF5WG           Item Target Pri
     C                     Z-ADD*ZERO     TBF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     TBF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     TBBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     TBBNNB           Production Qty
     C                     Z-ADD*ZERO     TBAHTM           Job Time
     C                     Z-ADD*ZERO     TBEKDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TCNLNB           Entity Number
     C                     Z-ADD*ZERO     TCAIC3           Company Number
     C                     Z-ADD*ZERO     TCAATM           Job Time
     C                     Z-ADD*ZERO     TCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TDAIC3           Company Number
     C                     Z-ADD*ZERO     TDAATM           Job Time
     C                     Z-ADD*ZERO     TDAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TEAATM           Job Time
     C                     Z-ADD*ZERO     TEAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  3
     C                     MOVEL*BLANK    WL0004  2
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  30
      * Define local variables for subroutine SBCRRC.
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  70
     C                     MOVEL*BLANK    WL0009  3
     C                     MOVEL*BLANK    WL0010  2
     C                     Z-ADD*ZERO     WL0011  70
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  50
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016  50
     C                     MOVEL*BLANK    WL0017  4
     C                     Z-ADD*ZERO     WL0018  20
     C                     MOVEL*BLANK    WL0019  3
     C                     Z-ADD*ZERO     WL0020  50
     C                     MOVEL*BLANK    WL0021  4
     C                     Z-ADD*ZERO     WL0022  20
     C                     Z-ADD*ZERO     WL0023  70
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     Z-ADD*ZERO     WL0031  60
     C                     MOVEL*BLANK    WL0032 10
     C                     MOVEL*BLANK    WL0033 10
     C                     Z-ADD*ZERO     WL0034  70
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0035  30
     C                     Z-ADD*ZERO     WL0036  70
     C                     MOVEL*BLANK    WL0037  3
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039  50
     C                     MOVEL*BLANK    WL0040  4
     C                     Z-ADD*ZERO     WL0041  20
     C                     Z-ADD*ZERO     WL0042 112
     C                     Z-ADD*ZERO     WL0043  70
     C                     Z-ADD*ZERO     WL0044  70
     C                     MOVEL*BLANK    WL0045  1
     C                     MOVEL*BLANK    WL0046  3
     C                     Z-ADD*ZERO     WL0047  70
      * Define local variables for subroutine SECHRC.
     C                     Z-ADD*ZERO     WL0048  30
     C                     Z-ADD*ZERO     WL0049  70
     C                     MOVEL*BLANK    WL0050  3
     C                     Z-ADD*ZERO     WL0051  70
     C                     Z-ADD*ZERO     WL0052  50
     C                     MOVEL*BLANK    WL0053  4
     C                     Z-ADD*ZERO     WL0054  20
     C                     Z-ADD*ZERO     WL0055  50
      * Define local variables for subroutine SFDLRC.
     C                     Z-ADD*ZERO     WL0056  30
     C                     Z-ADD*ZERO     WL0057  70
     C                     MOVEL*BLANK    WL0058  3
     C                     Z-ADD*ZERO     WL0059  70
     C                     Z-ADD*ZERO     WL0060  50
     C                     MOVEL*BLANK    WL0061  4
     C                     Z-ADD*ZERO     WL0062  20
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0063  30
     C                     Z-ADD*ZERO     WL0064  70
     C                     MOVEL*BLANK    WL0065  3
     C                     Z-ADD*ZERO     WL0066  70
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0067  3
     C                     MOVEL*BLANK    WL0068  4
     C                     MOVEL*BLANK    WL0069  1
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0070  30
     C                     Z-ADD*ZERO     WL0071  70
     C                     MOVEL*BLANK    WL0072 30
     C                     MOVEL*BLANK    WL0073 30
     C                     MOVEL*BLANK    WL0074  2
     C                     Z-ADD*ZERO     WL0075  94
     C                     MOVEL*BLANK    WL0076  1
     C                     MOVEL*BLANK    WL0077  2
     C                     Z-ADD*ZERO     WL0078  94
     C                     MOVEL*BLANK    WL0079  1
     C                     MOVEL*BLANK    WL0080  2
     C                     MOVEL*BLANK    WL0081  2
     C                     Z-ADD*ZERO     WL0082 112
     C                     MOVEL*BLANK    WL0083  1
     C                     MOVEL*BLANK    WL0084  1
     C                     Z-ADD*ZERO     WL0085  52
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0086  30
     C                     Z-ADD*ZERO     WL0087  70
     C                     MOVEL*BLANK    WL0088  3
     C                     Z-ADD*ZERO     WL0089 114
     C                     MOVEL*BLANK    WL0090  1
     C                     MOVEL*BLANK    WL0091  1
     C                     Z-ADD*ZERO     WL0092  80
     C                     MOVEL*BLANK    WL0093  1
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0094  30
     C                     Z-ADD*ZERO     WL0095  70
     C                     Z-ADD*ZERO     WL0096  30
     C                     Z-ADD*ZERO     WL0097  30
     C                     Z-ADD*ZERO     WL0098  30
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0099  30
     C                     Z-ADD*ZERO     WL0100  70
     C                     MOVEL*BLANK    WL0101  3
     C                     MOVEL*BLANK    WL0102  1
     C                     MOVEL*BLANK    WL0103  2
     C                     Z-ADD*ZERO     WL0104  70
     C                     Z-ADD*ZERO     WL0105  50
      * Define local variables for subroutine SSCRRC.
     C                     Z-ADD*ZERO     WL0106  30
     C                     Z-ADD*ZERO     WL0107  70
     C                     MOVEL*BLANK    WL0108  3
     C                     MOVEL*BLANK    WL0109  1
     C                     MOVEL*BLANK    WL0110  2
     C                     Z-ADD*ZERO     WL0111  70
     C                     Z-ADD*ZERO     WL0112  50
     C                     Z-ADD*ZERO     WL0113  30
     C                     Z-ADD*ZERO     WL0114  70
     C                     MOVEL*BLANK    WL0115  2
     C                     MOVEL*BLANK    WL0116  2
     C                     MOVEL*BLANK    WL0117 30
     C                     Z-ADD*ZERO     WL0118 112
     C                     Z-ADD*ZERO     WL0119 112
     C                     Z-ADD*ZERO     WL0120 114
     C                     MOVEL*BLANK    WL0121  2
     C                     Z-ADD*ZERO     WL0122 112
     C                     MOVEL*BLANK    WL0123  6
     C                     Z-ADD*ZERO     WL0124  80
     C                     MOVEL*BLANK    WL0125  1
     C                     MOVEL*BLANK    WL0126  3
     C                     MOVEL*BLANK    WL0127 15
     C                     MOVEL*BLANK    WL0128 10
     C                     Z-ADD*ZERO     WL0129  70
     C                     Z-ADD*ZERO     WL0130  30
     C                     Z-ADD*ZERO     WL0131  70
     C                     Z-ADD*ZERO     WL0132  30
     C                     Z-ADD*ZERO     WL0133  30
     C                     Z-ADD*ZERO     WL0134  30
     C                     MOVEL*BLANK    WL0135 10
     C                     Z-ADD*ZERO     WL0136  60
     C                     MOVEL*BLANK    WL0137  1
     C                     Z-ADD*ZERO     WL0138  70
     C                     MOVEL*BLANK    WL0139  1
     C                     MOVEL*BLANK    WL0140  1
     C                     MOVEL*BLANK    WL0141  1
     C                     MOVEL*BLANK    WL0142  1
      * Define local variables for subroutine SUCRRC.
     C                     Z-ADD*ZERO     WL0143  30
     C                     Z-ADD*ZERO     WL0144  70
     C                     MOVEL*BLANK    WL0145  3
     C                     Z-ADD*ZERO     WL0146  70
     C                     Z-ADD*ZERO     WL0147 112
     C                     Z-ADD*ZERO     WL0148 112
     C                     Z-ADD*ZERO     WL0149 112
     C                     Z-ADD*ZERO     WL0150 112
     C                     MOVEL*BLANK    WL0151  1
     C                     Z-ADD*ZERO     WL0152 112
     C                     Z-ADD*ZERO     WL0153 112
     C                     Z-ADD*ZERO     WL0154 112
     C                     Z-ADD*ZERO     WL0155 112
     C                     Z-ADD*ZERO     WL0156 112
     C                     Z-ADD*ZERO     WL0157 112
     C                     MOVEL*BLANK    WL0158  1
     C                     Z-ADD*ZERO     WL0159 112
     C                     Z-ADD*ZERO     WL0160 112
     C                     Z-ADD*ZERO     WL0161 112
     C                     Z-ADD*ZERO     WL0162 112
     C                     Z-ADD*ZERO     WL0163  70
     C                     Z-ADD*ZERO     WL0164 114
     C                     Z-ADD*ZERO     WL0165 114
     C                     Z-ADD*ZERO     WL0166 112
     C                     Z-ADD*ZERO     WL0167  70
     C                     Z-ADD*ZERO     WL0168  30
     C                     Z-ADD*ZERO     WL0169  30
     C                     Z-ADD*ZERO     WL0170  30
     C                     MOVEL*BLANK    WL0171  1
     C                     MOVEL*BLANK    WL0172  1
     C                     MOVEL*BLANK    WL0173  1
     C                     MOVEL*BLANK    WL0174  1
      * Define local variables for subroutine SVRVGN.
     C                     MOVEL*BLANK    WL0175  3
     C                     MOVEL*BLANK    WL0176  1
      * Define local variables for subroutine SWDLRC.
     C                     Z-ADD*ZERO     WL0177  30
     C                     Z-ADD*ZERO     WL0178  70
     C                     MOVEL*BLANK    WL0179  3
     C                     Z-ADD*ZERO     WL0180  70
      * Define local variables for subroutine SXRVGN.
     C                     Z-ADD*ZERO     WL0181  30
     C                     Z-ADD*ZERO     WL0182  70
     C                     MOVEL*BLANK    WL0183  3
     C                     Z-ADD*ZERO     WL0184 112
     C                     Z-ADD*ZERO     WL0185 112
     C                     Z-ADD*ZERO     WL0186 112
     C                     Z-ADD*ZERO     WL0187 112
     C                     Z-ADD*ZERO     WL0188 112
      * Define local variables for subroutine SZRVGN.
     C                     MOVEL*BLANK    WL0189  3
     C                     MOVEL*BLANK    WL0190 30
     C                     MOVEL*BLANK    WL0191 30
     C                     MOVEL*BLANK    WL0192 30
     C                     MOVEL*BLANK    WL0193 30
     C                     MOVEL*BLANK    WL0194 20
     C                     MOVEL*BLANK    WL0195 11
     C                     MOVEL*BLANK    WL0196  3
     C                     MOVEL*BLANK    WL0197  2
     C                     MOVEL*BLANK    WL0198  1
     C                     MOVEL*BLANK    WL0199 10
     C                     MOVEL*BLANK    WL0200  2
     C                     MOVEL*BLANK    WL0201  1
     C                     MOVEL*BLANK    WL0202  1
     C                     MOVEL*BLANK    WL0203  1
     C                     Z-ADD*ZERO     WL0204  52
     C                     MOVEL*BLANK    WL0205  1
     C                     MOVEL*BLANK    WL0206  1
     C                     MOVEL*BLANK    WL0207  1
     C                     MOVEL*BLANK    WL0208  1
     C                     Z-ADD*ZERO     WL0209  30
     C                     Z-ADD*ZERO     WL0210  30
     C                     Z-ADD*ZERO     WL0211  30
     C                     Z-ADD*ZERO     WL0212  30
     C                     MOVEL*BLANK    WL0213  3
     C                     MOVEL*BLANK    WL0214  1
     C                     MOVEL*BLANK    WL0215  1
     C                     MOVEL*BLANK    WL0216  1
     C                     MOVEL*BLANK    WL0217  1
     C                     MOVEL*BLANK    WL0218  2
     C                     MOVEL*BLANK    WL0219  2
     C                     MOVEL*BLANK    WL0220  3
     C                     MOVEL*BLANK    WL0221  3
     C                     MOVEL*BLANK    WL0222  3
     C                     MOVEL*BLANK    WL0223  1
     C                     MOVEL*BLANK    WL0224  1
     C                     MOVEL*BLANK    WL0225  1
     C                     MOVEL*BLANK    WL0226  1
     C                     Z-ADD*ZERO     WL0227  60
     C                     MOVEL*BLANK    WL0228 10
     C                     MOVEL*BLANK    WL0229 10
     C                     Z-ADD*ZERO     WL0230  70
      * Define local variables for subroutine TARVGN.
     C                     MOVEL*BLANK    WL0231  3
     C                     MOVEL*BLANK    WL0232  4
     C                     MOVEL*BLANK    WL0233  2
     C                     Z-ADD*ZERO     WL0234  20
     C                     Z-ADD*ZERO     WL0235  52
      * Define local variables for subroutine TJRVGN.
     C                     MOVEL*BLANK    WL0236  3
     C                     MOVEL*BLANK    WL0237 30
      * Define local variables for subroutine TNRVGN.
     C                     MOVEL*BLANK    WL0238 10
     C                     MOVEL*BLANK    WL0239  6
     C                     Z-ADD*ZERO     WL0240  30
     C                     MOVEL*BLANK    WL0241  3
      * Define local work field Record Found -PS CD USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Location Aisle
     C                     MOVEL*BLANK    YL0002  2
      * Define local work field Location Bay Alpha
     C                     MOVEL*BLANK    YL0003  2
      * Define local work field Location Bay
     C                     Z-ADD*ZERO     YL0004  20
      * Define local work field Transfer Batch Number
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Transaction Quantity
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field Label Date
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field Description Line One
     C                     MOVEL*BLANK    YL0008 30
      * Define local work field Description Line Two
     C                     MOVEL*BLANK    YL0009 30
      * Define local work field U/M - Primary
     C                     MOVEL*BLANK    YL0010  2
      * Define local work field Conversion Factor 1
     C                     Z-ADD*ZERO     YL0011  94
      * Define local work field Operation Factor 1
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field U/M - Second
     C                     MOVEL*BLANK    YL0013  2
      * Define local work field Conversion Factor 2
     C                     Z-ADD*ZERO     YL0014  94
      * Define local work field Operation Factor 2
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field U/M - Third
     C                     MOVEL*BLANK    YL0016  2
      * Define local work field U/M - Pricing
     C                     MOVEL*BLANK    YL0017  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0018 112
      * Define local work field Production Date Control
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field Catch Weight Status
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0021  52
      * Define local work field U/M - Transaction
     C                     MOVEL*BLANK    YL0022  2
      * Define local work field USR Weight based on U/M1
     C                     Z-ADD*ZERO     YL0023 112
      * Define local work field USR Weight based on U/M2
     C                     Z-ADD*ZERO     YL0024 112
      * Define local work field USR Weight based on U/M3
     C                     Z-ADD*ZERO     YL0025 112
      * Define local work field Transaction Weight
     C                     Z-ADD*ZERO     YL0026 112
      * Define local work field Unit Cost Per Pound
     C                     Z-ADD*ZERO     YL0027 114
      * Define local work field Cost Update Pending
     C                     MOVEL*BLANK    YL0028  1
      * Define local work field Post G/L Status
     C                     MOVEL*BLANK    YL0029  1
      * Define local work field Vendor - Item/Whse Deflt.
     C                     Z-ADD*ZERO     YL0030  80
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field Unit Cost - Detail
     C                     Z-ADD*ZERO     YL0032 114
      * Define local work field Transfer Batch Sequence
     C                     Z-ADD*ZERO     YL0033  30
      * Define null work field Warehouse Description
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0005 20
      * Define null work field Zip/Postal Code
     C                     MOVEL*BLANK    YN0006 11
      * Define null work field Production Warehouse Code
     C                     MOVEL*BLANK    YN0007  3
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0008  2
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0034  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0009 10
      * Define null work field Warehouse Type
     C                     MOVEL*BLANK    YN0010  2
      * Define null work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YN0011  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0035  1
      * Define null work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YN0013  52
      * Define null work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field Default Manifest Copies
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field Default Load Sequence
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field WHS Slotting Limit Type
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field Shipping Company
     C                     Z-ADD*ZERO     YN0018  30
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0019  30
      * Define null work field WHS Sched Prod Max Days
     C                     Z-ADD*ZERO     YN0020  30
      * Define null work field WHS Inventory Chill Time
     C                     Z-ADD*ZERO     YN0021  30
      * Define null work field Parent Warehouse
     C                     MOVEL*BLANK    YN0022  3
      * Define null work field Default Shipping Whs
     C                     MOVEL*BLANK    YN0023  1
      * Define local work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    YL0036  1
      * Define null work field WHS PFS Interface
     C                     MOVEL*BLANK    YN0024  1
      * Define null work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field WHS Default Load Type
     C                     MOVEL*BLANK    YN0026  2
      * Define null work field WHS Unused Sts 6
     C                     MOVEL*BLANK    YN0027  2
      * Define null work field Default Carrier Code
     C                     MOVEL*BLANK    YN0028  3
      * Define null work field WHS TPM Location Code
     C                     MOVEL*BLANK    YN0029  3
      * Define null work field WHS Unused Sts 9
     C                     MOVEL*BLANK    YN0030  3
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0031  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0032  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0035  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0036 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0037 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0038  70
      * Define local work field Location Aisle
     C                     MOVEL*BLANK    YL0037  2
      * Define local work field Location Bay
     C                     Z-ADD*ZERO     YL0038  20
      * Define local work field Loc Unused Chill Time
     C                     Z-ADD*ZERO     YL0039  52
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0040  30
      * Define local work field Label Date
     C                     Z-ADD*ZERO     YL0041  70
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0042  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0043  30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0044  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0045  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0299 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0299           User Profile Na
      *
     C                     MOVEL*BLANK    WN0300 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR TMRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0299    ZA0006           User Profile Na
     C                     MOVEL'I/C'     ZA0007           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL@CN,004   P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0300    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0299    WL0238    P      User Profile Na
     C                     MOVEL'I/C'     WL0239    P      Application Cod
     C                     EXSR TNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0240    YL0043           Company Number
     C                     MOVELWL0241    YL0045    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0300    WL0238    P      User Profile Na
     C                     MOVEL'I/C'     WL0239    P      Application Cod
     C                     EXSR TNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0240    YL0043           Company Number
     C                     MOVELWL0241    YL0045    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0045    YL0042           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0299    ZA0008           User Profile Na
     C                     MOVEL'I/C'     ZA0009           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL@CN,004   P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0044    IFNE *ZERO                      *IF
     C                     Z-ADDYL0044    YL0043           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0045    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           YL0042    PARM *BLANK    WQ0113  3        Warehouse Code
     C                     PARM YL0044    WQ0114  30       Shipping Compan
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TORVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Rtv Allow Multi-Whs   RT - User Profile Control  * 
     C                     EXSR TQRVGN
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * ***** Change Log and Comments
     C                     EXSR UCSUBR                     ***** Change Lo
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
01304013160156001572018160185301864
02072020840232802365025840262102625
0335203364036080386404120
** W0END
01306013450156201601018200186001871
02078021130233102369025850262102627
0335403393036110386804121
** W0NAM
V1AIC3    #DADTX    #1AJCD    #DF8NA    #1LXNM    V1ELDT    V1LODT
V1HGCD    #DOONA    #1YMCD    #1J2QT    #1YNCD    #1AMSX    #1YSCD
#DBNAA    #DO6NA    #DYVCD    #DJ5QT    #DSXTX
** @CN
00001 1111111
00002 Y2U0005
00003 Warehouse Transfer
00004 Y2U9999
