// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKZ7XFR
// ?Date: 14.08.2025 Time: 02:50:57
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?H16853 ISE 11/05/2020-Recompiled due to change in Buy Order Number
EXECUTE FUNCTION(Rtv/Chg Crc Net f/liveRT) TYPE(RTVOBJ) FILE(PKA1CPP)           AB1172233;
{
 //?USER: Process Data record

 //?Calculate TH Carcass Net Amt if:
 CASE;

 // IF DB1.TH Carcass Net Amt is Zeros
 IF DB1.TH_Carcass_Net_Amt = *ZERO;

 // AND DB1.TH LIve Net Amt EQ DB1.Th Payment Net Amt
 AND DB1.TH_LIve_Net_Amt = DB1.Th_Payment_Net_Amt;

 // AND DB1.TH CM Carcass Gross Amt is Not Zeros
 AND DB1.TH_CM_Carcass_Gross_Amt <> *ZERO;

 //?Calculate net amount for carcass merit fields
 // WRK.TH Carcass Net Amt = DB1.TH CM Carcass Gross Amt + DB1.TH Additions Amt
 WRK.TH_Carcass_Net_Amt = DB1.TH_CM_Carcass_Gross_Amt + DB1.TH_Additions_Amt;

 // WRK.TH Carcass Net Amt = WRK.TH Carcass Net Amt - DB1.TH Deduction Amt
 WRK.TH_Carcass_Net_Amt = WRK.TH_Carcass_Net_Amt - DB1.TH_Deduction_Amt;

 EXECUTE FUNCTION(Chg Tto Ded/Add/Net   CH) TYPE(CHGOBJ) FILE(PKA1CPP)           AB1143407;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(DB1.TH_Tattoo_Number);
 PARAMETER(DB1.TH_Kill_Date);
 PARAMETER(DB1.TH_Live_Purchase_UOM);
 PARAMETER(DB1.TH_Live_Purchase_Price);
 PARAMETER(DB1.TH_Live_Gross_Amt);
 PARAMETER(DB1.TH_LIve_Net_Amt);
 PARAMETER(DB1.TH_Deduction_Amt);
 PARAMETER(DB1.TH_Total_Net_WO_Adds);
 PARAMETER(WRK.TH_Carcass_Net_Amt);
 PARAMETER(DB1.TH_Additions_Amt);
 PARAMETER(DB1.TH_Payment_Gross);
 PARAMETER(DB1.Th_Payment_Net_Amt);
 PARAMETER(DB1.TH_Accrual_Amount);
 PARAMETER(DB1.TH_Calc_Net_Sts);
 PARAMETER(DB1.TH_Payment_Type);
 PARAMETER(DB1.RS_User_Changed);
 PARAMETER(DB1.RS_Date_Changed);
 PARAMETER(DB1.RS_Time_Changed);
 PARAMETER(DB1.RS_Record_Status);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // PAR.RS Date Changed = JOB.*Job date
   PAR.RS_Date_Changed = JOB.*Job_date;

   // PAR.RS Time Changed = JOB.*Job time
   PAR.RS_Time_Changed = JOB.*Job_time;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

 ENDIF;

}


