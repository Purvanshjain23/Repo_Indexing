/*****************************************************************   */
/*  PROGRAM NUMBER --> HP492CL                                       */
/*  PROGRAM NAME ----> SPECIFY CLOSED PERIOD TO REOPEN               */
/*  PROGRAMMER ------> LEANNE FEDOR                                  */
/*  DATE ------------> 10/24/94                                      */
/*  PROGRAM PURPOSE -> THIS CL CALLS THE PROGRAMS TO REOPEN A        */
/*                     CLOSED PERIOD.                                */
/*                                                                   */
/*********************************************************************/
/* MODIFICATIONS                                                     */
/* DATE      PROGRAMMER                                              */
/*                                                                 */
/*  04/26/95  LEANNE FEDOR                                         */
/*            CHANGED FARM SITE FROM ALPHA TO NUMERIC.             */
/*                                                                 */
/* 08/21/01  LEANNE FEDOR                                          */
/*           WE ADDED A CALL TO THE GENERIC PROGRAM THAT DELETES   */
/*           RECORDS FROM THE NEW 'COSTED TRANSFERS' FILE.         */
/*                                                                 */
/* 04/28/03  LEANNE FEDOR                                          */
/*           WE ADDED A CALL TO REOPEN CLOSED GROUPS. AND, REMOVED */
/*           THE CALL ADDED ON 8/21/02 ABOVE....WE DON'T DO IT THIS*/
/*           WAY ANYMORE.                                          */
/*                                                                 */
/*  07/14/03  LEANNE FEDOR                                         */
/*            REMOVED ALL REFERENCE TO HSP047-EOP FARM FILE; IT    */
/*            NO LONGER EXISTS.                                    */
/*                                                                 */
/*********************************************************************/

             PGM

             DCL        VAR(&QDATA)  TYPE(*CHAR) LEN(240)

             DCL        VAR(&LDEPDT) TYPE(*DEC)  LEN(8)
             DCL        VAR(&LDPER) TYPE(*DEC)  LEN(2)
             DCL        VAR(&LDCCYY) TYPE(*DEC)  LEN(4)
             DCL        VAR(&REOPEN) TYPE(*CHAR) LEN(1)

             CHGVAR     VAR(&REOPEN) VALUE('Y')
             CHGVAR     VAR(&LDEPDT) VALUE(%SST(*LDA 9 8))
             CHGVAR     VAR(&LDPER) VALUE(%SST(*LDA 17 2))
             CHGVAR     VAR(&LDCCYY) VALUE(%SST(*LDA 20 4))


/*********************************************************************/
/*  DELETE COSTED MOVEMENT DATA FOR THE PERIOD                       */
/*********************************************************************/

             CALL       PGM(HP8013) PARM(&LDCCYY &LDPER)


/*********************************************************************/
/* SET UP AND RUN QUERIES OVER REMAINING FILES                       */
/*********************************************************************/

/*  SET UP AND RUN QUERY OVER THE FEED TICKET HEADER FILE            */

             CHGVAR     VAR(%SST(&QDATA 1 240)) VALUE(' ')
             CHGVAR     VAR(%SST(&QDATA 1 10)) VALUE('FHEPDT +
                          *EQ')
             CHGVAR     VAR(%SST(&QDATA 12 8)) VALUE(&LDEPDT)

             OVRDBF     FILE(HSP037) SHARE(*YES)
             OPNQRYF    FILE((HSP037)) OPTION(*INP *UPD) +
                          QRYSLT(&QDATA) KEYFLD(*NONE) SEQONLY(*NO)


/*  SET UP AND RUN QUERY OVER THE EXPENSE TICKET HEADER FILE         */

             CHGVAR     VAR(%SST(&QDATA 1 240)) VALUE(' ')
             CHGVAR     VAR(%SST(&QDATA 1 10)) VALUE('XTEPDT +
                          *EQ')
             CHGVAR     VAR(%SST(&QDATA 12 8)) VALUE(&LDEPDT)

             OVRDBF     FILE(HSP048) SHARE(*YES)
             OPNQRYF    FILE((HSP048)) OPTION(*INP *UPD) +
                          QRYSLT(&QDATA) KEYFLD(*NONE) SEQONLY(*NO)


/*  SET UP AND RUN QUERY OVER THE TRANSFER HEADER FILE               */

             CHGVAR     VAR(%SST(&QDATA 1 240)) VALUE(' ')
             CHGVAR     VAR(%SST(&QDATA 1 10)) VALUE('MHEPDT +
                          *EQ')
             CHGVAR     VAR(%SST(&QDATA 12 8)) VALUE(&LDEPDT)

             OVRDBF     FILE(HSP074) SHARE(*YES)
             OPNQRYF    FILE((HSP074)) OPTION(*INP *UPD) +
                          QRYSLT(&QDATA) KEYFLD(*NONE) SEQONLY(*NO)

/*  SET UP AND RUN QUERY OVER THE SALES HEADER FILE               */

             CHGVAR     VAR(%SST(&QDATA 1 240)) VALUE(' ')
             CHGVAR     VAR(%SST(&QDATA 1 10)) VALUE('SHEPDT +
                          *EQ')
             CHGVAR     VAR(%SST(&QDATA 12 8)) VALUE(&LDEPDT)

             OVRDBF     FILE(HSP084) SHARE(*YES)
             OPNQRYF    FILE((HSP084)) OPTION(*INP *UPD) +
                          QRYSLT(&QDATA) KEYFLD(*NONE) SEQONLY(*NO)


/*  SET UP AND RUN QUERY OVER THE KILLED/DEAD HOG MOVEMENT FILE   */

             CHGVAR     VAR(%SST(&QDATA 1 240)) VALUE(' ')
             CHGVAR     VAR(%SST(&QDATA 1 10)) VALUE('KDEPDT +
                          *EQ')
             CHGVAR     VAR(%SST(&QDATA 12 8)) VALUE(&LDEPDT)

             OVRDBF     FILE(HSP068) SHARE(*YES)
             OPNQRYF    FILE((HSP068)) OPTION(*INP *UPD) +
                          QRYSLT(&QDATA) KEYFLD(*NONE) SEQONLY(*NO)


/*  SET UP AND RUN QUERY OVER THE INVENTORY ADJUSTMENT FILE       */

             CHGVAR     VAR(%SST(&QDATA 1 240)) VALUE(' ')
             CHGVAR     VAR(%SST(&QDATA 1 10)) VALUE('IAEPDT +
                          *EQ')
             CHGVAR     VAR(%SST(&QDATA 12 8)) VALUE(&LDEPDT)

             OVRDBF     FILE(HSP069) SHARE(*YES)
             OPNQRYF    FILE((HSP069)) OPTION(*INP *UPD) +
                          QRYSLT(&QDATA) KEYFLD(*NONE) SEQONLY(*NO)

/*-------------------------------------------------------------------*/
/*  CALL PROGRAM TO REOPEN CLOSED PERIOD                             */
/*-------------------------------------------------------------------*/

             CALL       PGM(HP392)


/*-------------------------------------------------------------------*/
/* DELETE FILE OVERRIDES                                             */
/*-------------------------------------------------------------------*/

             CLOF       OPNID(HSP037)
             CLOF       OPNID(HSP048)
             CLOF       OPNID(HSP068)
             CLOF       OPNID(HSP069)
             CLOF       OPNID(HSP074)
             CLOF       OPNID(HSP084)
             DLTOVR     FILE(*ALL)

/*-------------------------------------------------------------------*/
/*  REOPEN CLOSED GROUPS FOR THE PERIOD                              */
/*-------------------------------------------------------------------*/

             CALL       PGM(HP374CL) PARM(&REOPEN)

 EXIT:       ENDPGM

