     H/TITLE Prt Mex MPG TFP V2    PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME) TGTRLS(V7R3M0)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSHENR
     H* Date          : 09/25/23  Time  : 09:33:02
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDMMREL1IF  E           K        DISK
      * RTV : Export Doc Defaults       Retrieval index
      *
     FPDMRREL1IF  E           K        DISK
      * RTV : Export Doc Order Hdr      Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPUA6CPL1IF  E           K        DISK
      * RTV : Export Doc Order Hdr Ext  Retrieval index
      *
     FOME5REL1IF  E           K        DISK
      * RTV : Country                   Retrieval index
      *
     FPDMSREL5IF  E           K        DISK
      * RSQ : Export Doc Order Dtl      Co/Ord/Doc/Country/Item
      *
     FPUCFCPL1IF  E           K        DISK
      * RTV : Export Doc Order Dtl PRT  Retrieval index
      *
     FPUCFCPL0UF  E           K        DISK
      * UPD : Export Doc Order Dtl PRT  Update index
      *
     FPUHQPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Mex MPG TFP V2    PF  Print file
      *
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  10  6   @CN    25
     I@CFCPJU
      * Export Doc Order Dtl PRT  Update index
      * Renamed input format fields
     I              CFAIC3                          WAAIC3
     I              CFC4NB                          WAC4NB
     I              CFDGSX                          WADGSX
     I              CFKXCD                          WAKXCD
     I              CFHGCD                          WAHGCD
     I              CFRDU1                          WARDU1
     I              CFREU1                          WAREU1
     I              CFRFU1                          WARFU1
     I              CFMYSC                          WAMYSC
     I              CFG2NZ                          WAG2NZ
     I              CFM9SC                          WAM9SC
     I              CFNASC                          WANASC
     I              CFM4SC                          WAM4SC
     I              CFMZSC                          WAMZSC
     I              CFM5SC                          WAM5SC
     I              CFG7NZ                          WAG7NZ
     I              CFG8NZ                          WAG8NZ
     I              CFG9NZ                          WAG9NZ
     I              CFHANZ                          WAHANZ
     I              CFM6SC                          WAM6SC
     I              CFM7SC                          WAM7SC
     I              CFG3NZ                          WAG3NZ
     I              CFXSDT                          WAXSDT
     I              CFRLU1                          WARLU1
     I              CFRMU1                          WARMU1
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
     IQPUCF1    E DSPUCFCPL0
      * UPD : Export Doc Order Dtl PRT  Update index
      * Renamed input format fields
     I              CFAIC3                          WAAIC3
     I              CFC4NB                          WAC4NB
     I              CFDGSX                          WADGSX
     I              CFKXCD                          WAKXCD
     I              CFHGCD                          WAHGCD
     I              CFRDU1                          WARDU1
     I              CFREU1                          WAREU1
     I              CFRFU1                          WARFU1
     I              CFMYSC                          WAMYSC
     I              CFG2NZ                          WAG2NZ
     I              CFM9SC                          WAM9SC
     I              CFNASC                          WANASC
     I              CFM4SC                          WAM4SC
     I              CFMZSC                          WAMZSC
     I              CFM5SC                          WAM5SC
     I              CFG7NZ                          WAG7NZ
     I              CFG8NZ                          WAG8NZ
     I              CFG9NZ                          WAG9NZ
     I              CFHANZ                          WAHANZ
     I              CFM6SC                          WAM6SC
     I              CFM7SC                          WAM7SC
     I              CFG3NZ                          WAG3NZ
     I              CFXSDT                          WAXSDT
     I              CFRLU1                          WARLU1
     I              CFRMU1                          WARMU1
      *
     IYARDCS      DS                            250
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Export Doc Order Hdr
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * I : RST ED Export Document Type
     I                                        7   7 P1DGSX
      * I : RST Country Code
     I                                        8  13 P1KXCD
      * N :  ED Species
     I                                       14  38 P1QITX
     IP2PARM      DS
      * N :  Count USR
     I                                    P   1   30P2CNTU
     IP3PARM      DS
      * B :  USR Overflow
     I                                        1   1 P3DLST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1DGSX    PARM           WP0003  1        ED Export Docum
     C           P1KXCD    PARM           WP0004  6        Country Code
     C           P3DLST    PARM P3DLST    WP0005  1        USR Overflow
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Mex MPG TFP V2    PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$PENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Mex MPG TFP V2    PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN MRAIC3    WQKA01           Company Number
     C           *LIKE     DEFN MRC4NB    WQKA02           Order Number
     C           *LIKE     DEFN MRDGSX    WQKA03           ED Export Docum
     C           *LIKE     DEFN MRKXCD    WQKA04           Country Code
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
     C                     KFLD           WQKA02           Order Number
     C                     KFLD           WQKA03           ED Export Docum
     C                     KFLD           WQKA04           Country Code
      * Setup key
     C                     Z-ADDP1AIC3    WQKA01           Company Number
     C                     Z-ADDP1C4NB    WQKA02           Order Number
     C                     MOVELP1DGSX    WQKA03           ED Export Docum
     C                     MOVELP1KXCD    WQKA04           Country Code
      * Establish starting position
     C           KRSA      SETLL@MRREWT                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Order Number
     C                     MOVEL'Y'       W0AL02  1        ED Export Docum
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDMRAIC3    $DAIC3           Company Number
      * Load related totals format
     C                     Z-ADDMRAIC3    $NAIC3           Company Number
     C                     Z-ADDMRC4NB    $NC4NB           Order Number
     C                     MOVELMRDGSX    $NDGSX           ED Export Docum
     C                     MOVELMRKXCD    $NKXCD           Country Code
     C                     MOVELMRCWSX    $NCWSX           ED Certify that
     C                     MOVEL*BLANK    $NUPTX           Toggle Text 4
     C                     MOVELMROUNA    $NOUNA           ED Inspector Na
     C                     Z-ADD*ZERO     $NAMDX           USR Internal D8
     C                     Z-ADD*ZERO     $NMLNX           Date 8.0 USR
     C                     Z-ADDMRAINX    $NAINX           ED Nbr of prods
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDMRAIC3    $EAIC3           Company Number
     C                     Z-ADDMRC4NB    $EC4NB           Order Number
      * Load related totals format
     C                     Z-ADDMRAIC3    $MAIC3           Company Number
     C                     MOVELMRP1TX    $MP1TX           ED Continue Com
     C                     Z-ADDMRHSWG    $MHSWG           ED Total Gross
     C                     Z-ADDMRBJVL    $MBJVL           ED Total Gross
     C                     MOVELMRDGSX    $MDGSX           ED Export Docum
     C                     MOVELMRKXCD    $MKXCD           Country Code
     C                     MOVELMRRKTX    $MRKTX           ED Date of Slau
     C                     MOVELMRPZTX    $MPZTX           ED Place of Sla
     C                     MOVELMRP0TX    $MP0TX           ED Place of pro
     C                     MOVELMRRLTX    $MRLTX           ED Date of Proc
     C                     MOVEL*BLANK    $MY8TX           Text USR 7
     C                     Z-ADDMRC4NB    $MC4NB           Order Number
     C                     MOVEL*BLANK    $MZ7TX           Text USR 4
     C                     MOVEL*BLANK    $MG5TX           Text 1 USR
     C                     MOVELMRP2TX    $MP2TX           ED Remark Const
     C                     MOVEL*BLANK    $MG6TX           Text 2 USR
     C                     MOVELMRP3TX    $MP3TX           ED Remark Const
     C                     MOVEL*BLANK    $MGZU1           Text 3 USR 30
     C                     MOVELMRP4TX    $MP4TX           ED Remark Const
     C                     MOVEL*BLANK    $MVWT1           Text 4 USR
     C                     MOVELMRP5TX    $MP5TX           ED Remark Const
     C                     MOVELMRP6TX    $MP6TX           ED Remark Const
     C                     MOVELMRRETX    $MRETX           ED Remark Const
     C                     MOVELMRYHTX    $MYHTX           ED Remark Const
     C                     MOVELMRYITX    $MYITX           ED Remark Const
     C                     MOVELMRCWSX    $MCWSX           ED Certify that
     C                     MOVELMROUNA    $MOUNA           ED Inspector Na
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDMRAIC3    $FAIC3           Company Number
     C                     Z-ADDMRC4NB    $FC4NB           Order Number
     C                     MOVELMRDGSX    $FDGSX           ED Export Docum
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDMRAIC3    $GAIC3           Company Number
     C                     Z-ADDMRC4NB    $GC4NB           Order Number
     C                     MOVELMRDGSX    $GDGSX           ED Export Docum
     C                     MOVELMRZMCD    $GZMCD           ED Area Office
     C                     MOVELMRPSTX    $GPSTX           ED Destination
     C                     MOVEL*BLANK    $GX0AA           EDE ISO Alpha_2
     C                     MOVELMRKXCD    $GKXCD           Country Code
     C                     Z-ADD*ZERO     $GMBDT           Date
     C                     Z-ADDMRMQDT    $GMQDT           ED Export Certi
     C                     MOVELMRPUTX    $GPUTX           ED Consignor Na
     C                     MOVELMRPVTX    $GPVTX           ED Consignor Ad
     C                     MOVELMRPWTX    $GPWTX           ED Consignor Ad
     C                     MOVELMRRVTX    $GRVTX           ED Consignor Ad
     C                     MOVEL*BLANK    $GIQT1           Text 5 all caps
     C                     MOVELMRZNCD    $GZNCD           ED Plant Number
     C                     MOVELMRZ7AA    $GZ7AA           ED Consignor St
     C                     MOVELMRPDU1    $GPDU1           ED Consignor Po
     C                     MOVELMRZ8AA    $GZ8AA           ED Consignor Co
     C                     MOVELMRPPU1    $GPPU1           ED Consignor Ad
     C                     MOVEL*BLANK    $GEJNA           Name/Address Li
     C                     MOVEL*BLANK    $GPSU1           Consignor Count
     C                     MOVEL*BLANK    $GEKNA           Name/Address Li
     C                     MOVEL*BLANK    $GELNA           Name/Address Li
     C                     MOVELMRPXTX    $GPXTX           ED Plant Locati
     C                     MOVELMRZOCD    $GZOCD           ED Plant Locati
     C                     MOVELMRRHTX    $GRHTX           ED Consignee Na
     C                     MOVEL*BLANK    $GEMNA           Name/Address Li
     C                     MOVEL*BLANK    $GUMTX           Toggle Text 1
     C                     MOVELMRCTSX    $GCTSX           ED Attachment S
     C                     MOVELMRRITX    $GRITX           ED Consignee Ad
     C                     MOVELMRRJTX    $GRJTX           ED Consignee Ad
     C                     MOVELMRCSSX    $GCSSX           ED Processing P
     C                     MOVEL*BLANK    $GUNTX           Toggle Text 2
     C                     MOVELMRSCTX    $GSCTX           ED Consignee Ad
     C                     MOVELMRCUSX    $GCUSX           ED Attachment T
     C                     MOVEL*BLANK    $GUOTX           Toggle Text 3
     C                     MOVELMRPTTX    $GPTTX           ED Unmarked Txt
     C                     MOVELMRORNA    $GORNA           ED Shipping Mar
     C                     MOVELMRRKTX    $GRKTX           ED Date of Slau
     C                     MOVELMRPZTX    $GPZTX           ED Place of Sla
     C                     MOVELMRRLTX    $GRLTX           ED Date of Proc
     C                     MOVELMRP0TX    $GP0TX           ED Place of pro
     C                     MOVELMRP1TX    $GP1TX           ED Continue Com
     C                     MOVELMRP2TX    $GP2TX           ED Remark Const
     C                     MOVELMRP3TX    $GP3TX           ED Remark Const
     C                     MOVELMRP4TX    $GP4TX           ED Remark Const
     C                     MOVELMRP5TX    $GP5TX           ED Remark Const
     C                     MOVELMRP6TX    $GP6TX           ED Remark Const
     C                     MOVELMRYHTX    $GYHTX           ED Remark Const
     C                     MOVELMRYITX    $GYITX           ED Remark Const
     C                     MOVELMRCWSX    $GCWSX           ED Certify that
     C                     MOVELMROUNA    $GOUNA           ED Inspector Na
     C                     MOVELMRP7TX    $GP7TX           ED Origin Count
     C                     MOVELMRP9TX    $GP9TX           ED Port of Load
     C                     MOVELMROVNA    $GOVNA           ED Transportion
     C                     MOVELMRQATX    $GQATX           ED Seal Number
     C                     MOVELMRQBTX    $GQBTX           ED Seal Number
     C                     MOVELMRQCTX    $GQCTX           ED Can. Import
     C                     MOVELMROWNA    $GOWNA           ED Can. Import
     C                     MOVELMROXNA    $GOXNA           ED Can. Import
     C                     Z-ADDMRABNX    $GABNX           ED Can. Import
     C                     Z-ADDMRACNX    $GACNX           ED Can. Import
     C                     Z-ADDMRADNX    $GADNX           ED Seaboard Pla
     C                     MOVELMRQDTX    $GQDTX           ED USDA Cert Nb
     C                     MOVELMRQETX    $GQETX           ED USDA Cert Nb
     C                     MOVELMROYNA    $GOYNA           ED Can. Port of
     C                     MOVELMROZNA    $GOZNA           ED Can. Reinsp
     C                     MOVELMRO0NA    $GO0NA           ED Can. Reinsp
     C                     MOVELMRO1NA    $GO1NA           ED Can. Reinsp
     C                     MOVELMRCXSX    $GCXSX           ED Herm Sealed
     C                     MOVELMRCYSX    $GCYSX           ED Herm Sealed
     C                     MOVELMRAGNX    $GAGNX           ED Herm Sealed
     C                     MOVELMRCZSX    $GCZSX           ED Whole Bird S
     C                     MOVELMRC0SX    $GC0SX           ED Marked Sts
     C                     MOVELMRC1SX    $GC1SX           ED Tamper Evide
     C                     MOVELMRQFTX    $GQFTX           ED Plant Contac
     C                     Z-ADDMRAHNX    $GAHNX           ED Plant Contac
     C                     MOVELMRQGTX    $GQGTX           ED Modified Tex
     C                     MOVELMRQHTX    $GQHTX           ED Issued Crt f
     C                     MOVELMRQITX    $GQITX           ED Species
     C                     MOVELMRQJTX    $GQJTX           ED Slaughter Pl
     C                     MOVELMRQKTX    $GQKTX           ED Slaughter Pl
     C                     MOVELMRQMTX    $GQMTX           ED Slaughter Pl
     C                     MOVELMRQNTX    $GQNTX           ED Packaging Pl
     C                     MOVELMRQOTX    $GQOTX           ED Packaging Pl
     C                     MOVELMRQPTX    $GQPTX           ED Packaging Pl
     C                     MOVELMRQQTX    $GQQTX           ED Manufact Pla
     C                     MOVELMRQRTX    $GQRTX           ED Manufact Pla
     C                     MOVELMRQSTX    $GQSTX           ED Manufact Pla
     C                     MOVELMRQTTX    $GQTTX           ED USDA Name 1
     C                     MOVELMRQUTX    $GQUTX           ED USDA Name 2
     C                     MOVELMRQVTX    $GQVTX           ED USDA Name 3
     C                     MOVELMRQYTX    $GQYTX           ED Title of Off
     C                     MOVELMRQWTX    $GQWTX           ED Letter of Cr
     C                     MOVELMRQZTX    $GQZTX           ED Unused prd m
     C                     Z-ADDMRAINX    $GAINX           ED Nbr of prods
     C                     MOVELMRQ1TX    $GQ1TX           ED Importer Nam
     C                     MOVELMRQ2TX    $GQ2TX           ED Importer Add
     C                     MOVELMRQ3TX    $GQ3TX           ED Importer Add
     C                     MOVELMRQ4TX    $GQ4TX           ED Purchaser Na
     C                     MOVELMRQ5TX    $GQ5TX           ED Purchaser Ad
     C                     MOVELMRQ6TX    $GQ6TX           ED Purchaser Ad
     C                     MOVELMRQ7TX    $GQ7TX           ED Place Drct S
     C                     MOVELMRQ8TX    $GQ8TX           ED Place Drct S
     C                     MOVELMRQ9TX    $GQ9TX           ED Place Drct S
     C                     MOVELMRSMTX    $GSMTX           ED Place Drct S
     C                     MOVELMRZQCD    $GZQCD           ED Currency
     C                     MOVELMRZRCD    $GZRCD           ED Conditions o
     C                     Z-ADDMRA7VL    $GA7VL           ED Total Unit P
     C                     Z-ADDMRA8VL    $GA8VL           ED Invoice Tota
     C                     MOVELMRC2SX    $GC2SX           ED Live with PH
     C                     MOVELMRC8SX    $GC8SX           ED Print Status
     C                     MOVELMRO5NA    $GO5NA           ED Customer PO
     C                     Z-ADDMRHSWG    $GHSWG           ED Total Gross
     C                     Z-ADDMRBJVL    $GBJVL           ED Total Gross
     C                     MOVELMRRATX    $GRATX           ED Plant Number
     C                     MOVELMRRBTX    $GRBTX           ED Language Xla
     C                     MOVELMRRCTX    $GRCTX           ED Slaughter Da
     C                     MOVELMRRDTX    $GRDTX           ED Production m
     C                     MOVELMRRETX    $GRETX           ED Remark Const
     C                     MOVELMRC3SX    $GC3SX           ED Allow Print
     C                     MOVELMRC4SX    $GC4SX           ED Cert of Orig
     C                     MOVELMRC5SX    $GC5SX           ED Use item lab
     C                     MOVELMRC6SX    $GC6SX           ED Slg_Proc Dat
     C                     MOVELMRC7SX    $GC7SX           ED Total Packag
     C                     Z-ADDMRMRDT    $GMRDT           ED Sail Date
     C                     Z-ADDMRMSDT    $GMSDT           ED Sworn on Dat
     C                     Z-ADDMRAJNX    $GAJNX           ED Consignee Ad
     C                     MOVELMRYFTX    $GYFTX           ED Form Identif
     C                     MOVELMRX9TX    $GX9TX           ED Cold Storage
     C                     MOVELMRYATX    $GYATX           ED Cold Storage
     C                     MOVELMRYBTX    $GYBTX           ED Cold Storage
     C                     MOVELMRB5AA    $GB5AA           ED Cold Storage
     C                     MOVELMRYCTX    $GYCTX           ED Slaughter Da
     C                     MOVELMRYDTX    $GYDTX           ED Production m
     C                     MOVELMRYETX    $GYETX           ED Production m
     C                     MOVELMRB6AA    $GB6AA           ED Booking Nbr
     C                     Z-ADDMRPADT    $GPADT           ED Document Dat
     C                     Z-ADDMRPBDT    $GPBDT           ED Packing Date
     C                     Z-ADDMRPCDT    $GPCDT           ED Expiration D
     C                     Z-ADDMRPDDT    $GPDDT           ED Packing Date
     C                     Z-ADDMRPEDT    $GPEDT           ED Unused Date
     C                     MOVELMRO4SX    $GO4SX           ED Print Kilogr
     C                     MOVELMRO5SX    $GO5SX           ED MPR Canadian
     C                     MOVELMRC1T1    $GC1T1           ED Container Nb
     C                     MOVELMRC2T1    $GC2T1           ED Slaughter Da
     C                     MOVELMRLKSC    $GLKSC           ED Submit Statu
     C                     MOVELMRLLSC    $GLLSC           EDOH Unused Sts
     C                     MOVELMRPIU1    $GPIU1           EDOH Unused Tex
     C                     MOVELMRPJU1    $GPJU1           EDOH Unused Tex
     C                     Z-ADDMRFFNZ    $GFFNZ           EDOH Unused Num
     C                     Z-ADDMRBUDX    $GBUDX           EDOH Unused Dat
     C                     MOVELMRUVST    $GUVST           EDI Status 1
     C                     MOVELMRUWST    $GUWST           EDI Status 2
     C                     MOVELMRUXST    $GUXST           EDI Status 3
     C                     MOVELMRVSST    $GVSST           Record Status
     C                     Z-ADDMRAATM    $GAATM           Job Time
     C                     MOVELMRAYNA    $GAYNA           User Id
     C                     MOVELMRA0NA    $GA0NA           Job Name
     C                     Z-ADDMRAXDT    $GAXDT           Job Date
     C                     MOVELMRSDTX    $GSDTX           ED Consignee Ad
     C                     MOVELMRAAAB    $GAAAB           ED Consignee St
     C                     MOVELMRPHU1    $GPHU1           ED Consignee Po
     C                     MOVELMRABAB    $GABAB           ED Consignee Co
     C                     MOVELMRCVSX    $GCVSX           ED Xlate Desc t
     C                     Z-ADDMRHRWG    $GHRWG           ED Total Net We
     C                     MOVEL*BLANK    $GSWTX           USR Uom
     C                     Z-ADDMRBIVL    $GBIVL           ED Total Net We
     C                     Z-ADDMRK2QT    $GK2QT           ED Nbr of Packa
     C                     MOVEL*BLANK    $GROTX           ED Product Pkg
     C                     MOVEL*BLANK    $GPTU1           Consignee Count
      * USER: Process before print of detail format
      * CASE: DB1.ED Document Date is Not entered
     C           MRPADT    IFEQ *ZERO                      *IF
     C                     Z-ADD##JDT     $GMBDT           Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDMRPADT    $GMBDT           Date
     C                     END                             *FI
     C                     Z-ADD$GMBDT    YL0002           Date
     C                     MOVEL'Lbs'     $GSWTX           USR Uom
     C                     MOVEL$GZNCD    YL0003           ED Plant Number
     C                     Z-ADD$GMQDT    WUMQDT           ED Export Certi
     C                     MOVEL$GORNA    WUORNA           ED Shipping Mar
      * CASE: DB1.ED Total Package UOM EQ WRK.Blank for 4           USR
     C           MRC7SX    IFEQ WUOTTX                     *IF
      * RTV UM/Whs Code        RT - Order Detail  * 
     C                     EXSR SBRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELMRC7SX    WUC7SX           ED Total Packag
     C                     END                             *FI
      * CASE: WRK.ED Total Package UOM is Boxes
     C           WUC7SX    IFEQ 'BX'                       *IF
     C                     MOVEL*BLANK    $GROTX           ED Product Pkg
     C                     MOVEL'BX'      $GROTX           ED Product Pkg
     C                     ELSE
      * CASE: WRK.ED Total Package UOM is Combos
     C           WUC7SX    IFEQ 'CB'                       *IF
     C                     MOVEL*BLANK    $GROTX           ED Product Pkg
     C                     MOVEL'COM'     $GROTX           ED Product Pkg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $GROTX           ED Product Pkg
     C                     MOVEL'BX'      $GROTX           ED Product Pkg
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    $GIQT1           Text 5 all caps
     C                     MOVEL'EST:'    $GIQT1           Text 5 all caps
      * Rtv ISO Code          RT - Export Doc Order Hdr Ext  * 
     C                     EXSR SDRVGN
      * S17057 DN 04/13/21-Get Applicant Addr Info from Exp Doc Defaults.
      * DO2642 DN 07/18/22-Commented Out & Moved Below.
      * DO2642 DN 07/18/22-Get Applicant Addr Info Based on Live with PHI
      * CASE: LCL.ED Live with PHIS is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * Rtv Applicant Addr PHISRT - Export Doc Defaults  * 
     C                     EXSR SERVGN
     C                     Z-ADD0         ZQ      50
     C           YL0006    CAT  ',':ZQ    YL0006    P      ED Consignor Ad
     C                     Z-ADD1         ZQ      50
     C           YL0006    CAT  YL0007:ZQ YL0006    P      ED Consignor Ad
     C                     Z-ADD1         ZQ      50
     C           YL0006    CAT  YL0008:ZQ YL0006    P      ED Consignor Ad
      * Move City/State/Zip to Address Line 2 or Line 3.
      * CASE: CUR.Name/Address Line 3 is *blank
     C           $GELNA    IFEQ *BLANK                     *IF
     C                     MOVELYL0006    $GELNA           Name/Address Li
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0006    $GEMNA           Name/Address Li
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Applicant Addr    RT - Export Doc Defaults  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$GAIC3    WL0005           Company Number
     C                     MOVEL'A'       WL0006    P      ED Export Docum
     C                     MOVEL$GKXCD    WL0007    P      Country Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    $GEJNA    P      ED Consignor Na
     C                     MOVELWL0009    $GEKNA    P      ED Consignor Ad
     C                     MOVELWL0010    $GELNA    P      ED Consignor Ad
     C                     MOVELWL0011    $GEMNA    P      ED Consignor Ad
     C                     MOVELWL0012    P1QITX    P      ED Species
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt MPG Dtl w/o MT V2TFPO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN MRAIC3    WZA001           Company Number
     C                     Z-ADDMRAIC3    WZA001
     C           *LIKE     DEFN MRC4NB    WZA002           Order Number
     C                     Z-ADDMRC4NB    WZA002
     C           *LIKE     DEFN MRDGSX    WZA003           ED Export Docum
     C                     MOVELMRDGSX    WZA003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@MRREWT                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Order Number
     C                     MOVEL*BLANK    W0AL02  1        ED Export Docum
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Order Number
     C                     MOVEL'Y'       W0AL02  1        ED Export Docum
     C                     ELSE
      * Next record - Detect level breaks
     C           MRAIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           MRC4NB    IFNE WZA002                     Order Number
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           MRDGSX    IFNE WZA003                     ED Export Docum
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Order Number format
     C                     MOVEL@CN,002   $MY8TX           Text USR 7
      * Print EST # and address if company value sent to "Y"
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SKRVGN
      * Print if Status is set to Y  (will be as of 10/01/2011)
      * CASE: LCL.Status Flag 1  Y/N is Yes
     C           YL0015    IFEQ 'Y'                        *IF
     C                     MOVEL'Est:'    $MZ7TX           Text USR 4
      * CASE: CUR.Company Number is Guymon
     C           $MAIC3    IFEQ 360                        *IF
     C                     MOVEL*BLANK    $MG5TX           Text 1 USR
     C                     MOVELYL0003    $MG5TX           Text 1 USR
      * CASE: LCL.ED Plant Number is Guymon 13597
     C           YL0003    IFEQ '13597'                    *IF
     C                     MOVEL@CN,004   $MG6TX           Text 2 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,005   $MG6TX           Text 2 USR
     C                     END                             *FI
     C                     MOVEL*BLANK    $MGZU1           Text 3 USR 30
     C                     MOVEL@CN,006   $MGZU1           Text 3 USR 30
     C                     MOVEL@CN,007   $MVWT1           Text 4 USR
     C                     ELSE
      * CASE: CUR.Company Number is St. Joseph
     C           $MAIC3    IFEQ 960                        *IF
     C                     MOVEL*BLANK    $MG5TX           Text 1 USR
     C                     MOVELYL0003    $MG5TX           Text 1 USR
     C                     MOVEL@CN,008   $MG6TX           Text 2 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,009   CAT  'y':ZQ    $MGZU1    P      Text 3 USR 30
     C                     MOVEL@CN,010   $MVWT1           Text 4 USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CUR.ED Remark Constant 5 is Blank
      *   |- c2    : CUR.ED Remark Constant 6 is Not equal to blanks
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $MP6TX    IFEQ *BLANK                     *IF
     C           $MRETX    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL$MRETX    $MP6TX           ED Remark Const
     C                     MOVEL*BLANK    $MRETX           ED Remark Const
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If we are already passed the nominated
      * Start line for this format
     C           @$CLN     IFGE 53
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $MC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$MC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VMC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VMC4NB           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           P3DLST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$MKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Company Number format
      * CASE: CUR.ED Certify that the meat is Selected
     C           $NCWSX    IFEQ 'X'                        *IF
     C                     MOVEL'XXX'     $NUPTX           Toggle Text 4
     C                     END                             *FI
     C                     MOVEL*BLANK    WUR4TX           Date (Alpha) US
     C                     MOVELYL0002    WUR4TX           Date (Alpha) US
     C                     Z-ADD4         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUR4TX:ZQ WUUBT1    P  90  Month/Day Alpha
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUR4TX:ZQ WUT4TX    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           '20'      CAT  WUT4TX:ZQ WUT9TX    P      Year Alpha (YYY
     C                     Z-ADD*ZERO     ZQ      50
     C           WUUBT1    CAT  WUT9TX:ZQ WUGWT1    P      Date (Char-8) U
     C                     MOVE WUGWT1    $NMLNX           Date 8.0 USR
     C           W0PFM     IFEQ 'Y'
      * If we are already passed the nominated
      * Start line for this format
     C           @$CLN     IFGE 78
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$NKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
      * Mention hidden format
     C   99N99             WRITE$OFINTTL
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt MPG Dtl w/o MT V2TFPO: Mainline
      *================================================================
      * Prt MPG Dtl w/o MT V2TFPO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN MSAIC3    WQKB01           Company Number
     C           *LIKE     DEFN MSC4NB    WQKB02           Order Number
     C           *LIKE     DEFN MSDGSX    WQKB03           ED Export Docum
     C           *LIKE     DEFN MSKXCD    WQKB04           Country Code
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Order Number
     C                     KFLD           WQKB03           ED Export Docum
     C                     KFLD           WQKB04           Country Code
      * Setup key
     C                     Z-ADD$GAIC3    WQKB01           Company Number
     C                     Z-ADD$GC4NB    WQKB02           Order Number
     C                     MOVEL$GDGSX    WQKB03           ED Export Docum
     C                     MOVEL$GKXCD    WQKB04           Country Code
      * Establish starting position
     C           KRSB      SETLL@MSREEM                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        ED Export Docum
     C                     MOVEL'Y'       W0BL03  1        Country Code
     C                     MOVEL'Y'       W0BL04  1        ED Item Code
     C                     MOVEL'Y'       W0BL05  1        Order Sequence
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Load key header format
     C                     MOVEL*BLANK    $HW4TX           Blank for 30
     C                     MOVEL*BLANK    $HOUTX           Blank for 4.2
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDMSAIC3    $JAIC3           Company Number
     C                     Z-ADDMSC4NB    $JC4NB           Order Number
     C                     MOVELMSDGSX    $JDGSX           ED Export Docum
     C                     MOVELMSKXCD    $JKXCD           Country Code
     C                     MOVEL*BLANK    $JSHTX           Text USR 40
     C                     Z-ADD*ZERO     $JJBWG           Net Weight SUM
     C                     Z-ADDMSDIC7    $JDIC7           ED Item Code
     C                     MOVELMSO3NA    $JO3NA           ED Item Label L
     C                     MOVELMSRMTX    $JRMTX           ED Chilled_Froz
     C                     MOVELMSRNTX    $JRNTX           ED Product UOM
     C                     MOVEL*BLANK    $JQITX           ED Species
     C                     Z-ADD*ZERO     $JNKQT           Net Quantity SU
     C                     Z-ADDMSAONX    $JAONX           ED Product Nbr
     C                     MOVELMSROTX    $JROTX           ED Product Pkg
     C                     MOVELMSORNA    $JORNA           ED Shipping Mar
     C                     MOVELMSRATX    $JRATX           ED Plant Number
     C                     MOVELMSO4NA    $JO4NA           ED Item Label L
     C                     MOVEL*BLANK    $JRNU1           Blank 5 USR
     C                     MOVEL*BLANK    $JOTTX           Blank for 4
     C                     MOVEL*BLANK    $JJ1TX           BLANK 1
     C                     MOVEL*BLANK    $JOUTX           Blank for 4.2
     C                     MOVELMSRBTX    $JRBTX           ED Language Xla
     C                     MOVELMSK1U1    $JK1U1           ED Language Xla
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
     C                     END
      *
     C           W0BL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP05  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDMSAIC3    $IAIC3           Company Number
     C                     Z-ADDMSC4NB    $IC4NB           Order Number
     C                     MOVELMSDGSX    $IDGSX           ED Export Docum
     C                     MOVELMSKXCD    $IKXCD           Country Code
     C                     Z-ADDMSDPNB    $IDPNB           Order Sequence
     C                     Z-ADDMSUENB    $IUENB           Order Secondary
     C                     Z-ADDMSDIC7    $IDIC7           ED Item Code
     C                     MOVELMSO4NA    $IO4NA           ED Item Label L
     C                     MOVELMSPTTX    $IPTTX           ED Unmarked Txt
     C                     MOVELMSRMTX    $IRMTX           ED Chilled_Froz
     C                     MOVELMSO3NA    $IO3NA           ED Item Label L
     C                     MOVEL*BLANK    $ISHTX           Text USR 40
     C                     Z-ADDMSHJWG    $IHJWG           ED Product Net
     C                     MOVELMSRNTX    $IRNTX           ED Product UOM
     C                     Z-ADDMSHKWG    $IHKWG           ED Product Net
     C                     MOVEL*BLANK    $ISVTX           USR MT
     C                     Z-ADDMSAONX    $IAONX           ED Product Nbr
     C                     MOVELMSROTX    $IROTX           ED Product Pkg
     C                     MOVELMSORNA    $IORNA           ED Shipping Mar
     C                     MOVELMSRATX    $IRATX           ED Plant Number
     C                     MOVEL*BLANK    $IOTTX           Blank for 4
     C                     MOVEL*BLANK    $IJ1TX           BLANK 1
     C                     Z-ADDMSAMNX    $IAMNX           ED Pieces per B
     C                     Z-ADDMSANNX    $IANNX           ED Bags per Uni
     C                     Z-ADDMSAPNX    $IAPNX           ED Total Nbr of
     C                     Z-ADDMSDKPR    $IDKPR           ED Product Unit
     C                     Z-ADDMSA9VL    $IA9VL           ED Producet Ext
     C                     MOVELMSC8SX    $IC8SX           ED Print Status
     C                     MOVELMSRBTX    $IRBTX           ED Language Xla
     C                     Z-ADDMSAJNX    $IAJNX           ED Consignee Ad
     C                     MOVELMSZWTX    $IZWTX           ED Date of Slau
     C                     MOVELMSZXTX    $IZXTX           ED HACCP Catego
     C                     MOVELMSZYTX    $IZYTX           ED Slaughter Da
     C                     MOVELMSZZTX    $IZZTX           ED Production D
     C                     MOVELMSK0U1    $IK0U1           ED Product UID
     C                     MOVELMSK1U1    $IK1U1           ED Language Xla
     C                     MOVELMSIJSC    $IIJSC           ED Unused Statu
     C                     MOVELMSIKSC    $IIKSC           ED Unused Statu
     C                     MOVELMSK2U1    $IK2U1           ED Harmonized T
     C                     Z-ADDMSW0DT    $IW0DT           ED Nbr of Packi
     C                     MOVELMSUVST    $IUVST           EDI Status 1
     C                     MOVELMSUWST    $IUWST           EDI Status 2
     C                     MOVELMSUXST    $IUXST           EDI Status 3
     C                     MOVELMSVSST    $IVSST           Record Status
     C                     Z-ADDMSAATM    $IAATM           Job Time
     C                     MOVELMSAYNA    $IAYNA           User Id
     C                     MOVELMSA0NA    $IA0NA           Job Name
     C                     Z-ADDMSAXDT    $IAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     ADD  $IHJWG    $JJBWG           Net Weight SUM
     C                     ADD  $IAONX    $JNKQT           Net Quantity SU
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN MSAIC3    WZB001           Company Number
     C                     Z-ADDMSAIC3    WZB001
     C           *LIKE     DEFN MSC4NB    WZB002           Order Number
     C                     Z-ADDMSC4NB    WZB002
     C           *LIKE     DEFN MSDGSX    WZB003           ED Export Docum
     C                     MOVELMSDGSX    WZB003
     C           *LIKE     DEFN MSKXCD    WZB004           Country Code
     C                     MOVELMSKXCD    WZB004
     C           *LIKE     DEFN MSDIC7    WZB005           ED Item Code
     C                     Z-ADDMSDIC7    WZB005
     C           *LIKE     DEFN MSDPNB    WZB006           Order Sequence
     C                     Z-ADDMSDPNB    WZB006
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@MSREEM                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: DB1.ED Product Net Weight lbs EQ WRK.ZERO
     C           MSHJWG    IFEQ WUW0NB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Order Number
     C                     MOVEL*BLANK    W0BL02  1        ED Export Docum
     C                     MOVEL*BLANK    W0BL03  1        Country Code
     C                     MOVEL*BLANK    W0BL04  1        ED Item Code
     C                     MOVEL*BLANK    W0BL05  1        Order Sequence
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        ED Export Docum
     C                     MOVEL'Y'       W0BL03  1        Country Code
     C                     MOVEL'Y'       W0BL04  1        ED Item Code
     C                     MOVEL'Y'       W0BL05  1        Order Sequence
     C                     ELSE
      * Next record - Detect level breaks
     C           MSAIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           MSC4NB    IFNE WZB002                     Order Number
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           MSDGSX    IFNE WZB003                     ED Export Docum
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           MSKXCD    IFNE WZB004                     Country Code
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           MSDIC7    IFNE WZB005                     ED Item Code
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C           MSDPNB    IFNE WZB006                     Order Sequence
     C           W0BL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL05
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP05
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of ED Item Code format
     C                     MOVELP1QITX    $JQITX           ED Species
      * DO2642 DN 06/30/22-Get Overflow from Exp Doc Order Dtl PRT File.
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.Overflow is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0013    IFEQ 'Y'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Once 'Overflow=Y', do not continue to read PUCFCPP.
      * Rtv Overflow          RT - Export Doc Order Dtl PRT  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
      * DO2642 DN 06/30/22-Commented Out Old Print/Overflow Method.
      * DO2642 DN 06/30/22-New Print/Overflow Method.
      * CASE: LCL.Overflow is Yes
     C           YL0013    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    P3DLST           USR Overflow
     C                     MOVEL'N'       W0PFM            *Print format
      * Overflow Print Program PUH0PFR will be called in PDQ5UCLP.
      * PUWPXFR will get 1st Item Code to print in Overflow Print program
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P3DLST           USR Overflow
     C                     MOVEL$GORNA    $JORNA           ED Shipping Mar
     C                     Z-ADD1         ZQ      50
     C           $JRMTX    CAT  $JO3NA:ZQ $JSHTX    P      Text USR 40
      * Upd Item Printed      RT - Export Doc Order Dtl PRT  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 4
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Print format
     C                     WRITE$JKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
      * PRTOBJ calls after print of ED Item Code format
      * Embedded PRTOBJ : Prt HC f/Doc Type H    PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt HC f/Doc Type H    PO: Mainline
      *================================================================
      * Prt HC f/Doc Type H    PO: Initialise
     C                     EXSR ZCINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN CFAIC3    WQKC01           Company Number
     C           *LIKE     DEFN CFC4NB    WQKC02           Order Number
     C           *LIKE     DEFN CFDGSX    WQKC03           ED Export Docum
     C           *LIKE     DEFN CFKXCD    WQKC04           Country Code
     C           *LIKE     DEFN CFHGCD    WQKC05           Item Code
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Order Number
     C                     KFLD           WQKC03           ED Export Docum
     C                     KFLD           WQKC04           Country Code
     C                     KFLD           WQKC05           Item Code
      * Setup key
     C                     Z-ADD$JAIC3    WQKC01           Company Number
     C                     Z-ADD$JC4NB    WQKC02           Order Number
     C                     MOVEL$JDGSX    WQKC03           ED Export Docum
     C                     MOVEL$JKXCD    WQKC04           Country Code
     C                     Z-ADD$JDIC7    WQKC05           Item Code
      * Establish starting position
     C           KRSC      SETLL@CFCPJV                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        ED Export Docum
     C                     MOVEL'Y'       W0CL03  1        Country Code
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDCFAIC3    $LAIC3           Company Number
     C                     Z-ADDCFC4NB    $LC4NB           Order Number
     C                     MOVELCFDGSX    $LDGSX           ED Export Docum
     C                     MOVELCFKXCD    $LKXCD           Country Code
     C                     MOVELCFRDU1    $LRDU1           Description Xla
     C                     MOVELCFREU1    $LREU1           Description Xla
     C                     MOVEL*BLANK    $LXKTX           Blank 6 USR
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDCFAIC3    $KAIC3           Company Number
     C                     Z-ADDCFC4NB    $KC4NB           Order Number
     C                     MOVELCFDGSX    $KDGSX           ED Export Docum
     C                     MOVELCFKXCD    $KKXCD           Country Code
     C                     Z-ADDCFHGCD    $KHGCD           Item Code
     C                     MOVELCFRDU1    $KRDU1           Description Xla
     C                     MOVELCFREU1    $KREU1           Description Xla
     C                     MOVELCFRFU1    $KRFU1           Overflow Pg Dsc
     C                     MOVELCFMYSC    $KMYSC           Overflow
     C                     Z-ADDCFG2NZ    $KG2NZ           EDODP Unused Nu
     C                     MOVELCFM9SC    $KM9SC           Skip Ln Before
     C                     MOVELCFNASC    $KNASC           Skip Ln After X
     C                     MOVELCFM4SC    $KM4SC           Prt Inspector N
     C                     MOVELCFMZSC    $KMZSC           Item Printed
     C                     MOVELCFM5SC    $KM5SC           Prt Continuatio
     C                     Z-ADDCFG7NZ    $KG7NZ           # of Blank Line
     C                     Z-ADDCFG8NZ    $KG8NZ           # of Blank Line
     C                     Z-ADDCFG9NZ    $KG9NZ           # of Blank Line
     C                     Z-ADDCFHANZ    $KHANZ           # of Blank Line
     C                     MOVELCFM6SC    $KM6SC           EDODP Unused St
     C                     MOVELCFM7SC    $KM7SC           EDODP Unused St
     C                     Z-ADDCFG3NZ    $KG3NZ           EDODP Unused Nb
     C                     Z-ADDCFXSDT    $KXSDT           EDODP Unused Dt
     C                     MOVELCFRLU1    $KRLU1           EDODP Unused Tx
     C                     MOVELCFRMU1    $KRMU1           EDODP Unused Tx
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN CFAIC3    WZC001           Company Number
     C                     Z-ADDCFAIC3    WZC001
     C           *LIKE     DEFN CFC4NB    WZC002           Order Number
     C                     Z-ADDCFC4NB    WZC002
     C           *LIKE     DEFN CFDGSX    WZC003           ED Export Docum
     C                     MOVELCFDGSX    WZC003
     C           *LIKE     DEFN CFKXCD    WZC004           Country Code
     C                     MOVELCFKXCD    WZC004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@CFCPJV                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Record Processing.
      * CASE: PAR.Overflow is Yes
     C           YL0013    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Description Xlate Line 1 is Entered
      *   |- c2    : DB1.Overflow Pg Dsc Xlate Ln1 is Entered
      *   '-
     C           CFRDU1    IFNE *BLANK                     *IF
     C           CFRFU1    ORNE *BLANK                     *OR
     C                     MOVEL'Y'       YL0014           Prt Exp Doc Ord
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Company Number
     C                     MOVEL*BLANK    W0CL01  1        Order Number
     C                     MOVEL*BLANK    W0CL02  1        ED Export Docum
     C                     MOVEL*BLANK    W0CL03  1        Country Code
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        ED Export Docum
     C                     MOVEL'Y'       W0CL03  1        Country Code
     C                     ELSE
      * Next record - Detect level breaks
     C           CFAIC3    IFNE WZC001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           CFC4NB    IFNE WZC002                     Order Number
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           CFDGSX    IFNE WZC003                     ED Export Docum
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           CFKXCD    IFNE WZC004                     Country Code
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL03    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           YL0014    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$LKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Mex MPG TFP V2    PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Mex MPG TFP V2    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$C1STPAG
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of Prt Mex MPG TFP V2    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$DKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Order Number of Prt Mex MPG TFP V2    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$EKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print ED Export Document Type of Prt Mex MPG TFP V2    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$FKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Detail line. of Prt Mex MPG TFP V2    PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * R16637 DN 10/15/20-Suppress Blank Address Lines.
      * CASE: *OTHERWISE
      * Rtv Live with PHIS    RT - Export Doc Defaults  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     MOVEL'A'       WL0002    P      ED Export Docum
     C                     MOVELP1KXCD    WL0003    P      Country Code
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0001    P      ED Live with PH
      * Fmt Suppress Addr LinesIF
      * CONSIGNOR: Format & Suppress Blank Address Lines.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.ED Consignor Addr 2 is Not Blank
      *   |- c2    : PAR.ED Consignor Addr 3 is Not Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $GPWTX    IFNE *BLANK                     *IF
     C           $GRVTX    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * If Addr4/City is Entered then Concat State & Zip.
      * CASE: PAR.ED Consignor Addr 4 is Not Blank
     C           $GPPU1    IFNE *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           $GPPU1    CAT  $GZ7AA:ZQ $GPPU1    P      ED Consignor Ad
     C                     Z-ADD1         ZQ      50
     C           $GPPU1    CAT  $GPDU1:ZQ $GPPU1    P      ED Consignor Ad
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Check Blank Address Lines to Suppress.
      * CASE: PAR.ED Consignor Addr 2 is eq blank
     C           $GPWTX    IFEQ *BLANK                     *IF
      * Shouldn't have too many scenarios with Addr 2 is blank.
     C                     MOVEL$GRVTX    $GPWTX           ED Consignor Ad
     C                     MOVEL*BLANK    $GRVTX           ED Consignor Ad
     C                     END                             *FI
      * Check Addr 4/City & Suppress Blank Address Line.
      * CASE: PAR.ED Consignor Addr 4 is eq blank
     C           $GPPU1    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Addr4/City is Entered, Concat State & Zip.
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           $GPPU1    CAT  $GZ7AA:ZQ $GPPU1    P      ED Consignor Ad
     C                     Z-ADD1         ZQ      50
     C           $GPPU1    CAT  $GPDU1:ZQ $GPPU1    P      ED Consignor Ad
      * CASE: PAR.ED Consignor Addr 2 is Blank
     C           $GPWTX    IFEQ *BLANK                     *IF
     C                     MOVEL$GPPU1    $GPWTX           ED Consignor Ad
     C                     MOVEL*BLANK    $GPPU1           ED Consignor Ad
     C                     ELSE
      * CASE: PAR.ED Consignor Addr 3 is Blank
     C           $GRVTX    IFEQ *BLANK                     *IF
     C                     MOVEL$GPPU1    $GRVTX           ED Consignor Ad
     C                     MOVEL*BLANK    $GPPU1           ED Consignor Ad
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CONSIGNEE: Format & Suppress Blank Address Lines.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.ED Consignee Addr 2 is Not Blank
      *   |- c2    : PAR.ED Consignee Addr 3 is Not Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $GRJTX    IFNE *BLANK                     *IF
     C           $GSCTX    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * If Addr4/City is Entered then Concat State & Zip.
      * CASE: PAR.ED Consignee Addr 4 is Not Blank
     C           $GSDTX    IFNE *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           $GSDTX    CAT  $GAAAB:ZQ $GSDTX    P      ED Consignee Ad
     C                     Z-ADD1         ZQ      50
     C           $GSDTX    CAT  $GPHU1:ZQ $GSDTX    P      ED Consignee Ad
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Check Blank Address Lines to Suppress.
      * CASE: PAR.ED Consignee Addr 2 is eq blank
     C           $GRJTX    IFEQ *BLANK                     *IF
      * Shouldn't have too many scenarios with Addr 2 is blank.
     C                     MOVEL$GSCTX    YL0009           ED Consignee Ad
     C                     MOVELYL0009    $GRJTX           ED Consignee Ad
     C                     MOVEL*BLANK    $GSCTX           ED Consignee Ad
     C                     MOVELYL0010    $GSCTX           ED Consignee Ad
     C                     END                             *FI
      * Check Addr 4/City & Suppress Blank Address Line.
      * CASE: PAR.ED Consignee Addr 4 is eq blank
     C           $GSDTX    IFEQ *BLANK                     *IF
      * S17055 DN 04/06/21-Concat Consignee State & Zip if Entered.
      * CASE: PAR.ED Consignee Postal is Entered
     C           $GPHU1    IFNE *BLANK                     *IF
      * Get State for Domestic Address Else Concat Only Zip Code.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.ED Consignee State is State code not Blanks
      *   |- c2    : PAR.ED Consignee State is Not International
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $GAAAB    IFNE *BLANK                     *IF
     C           $GAAAB    IFNE '.'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    YL0011           ED Consignee Ad
     C                     MOVEL$GAAAB    YL0011           ED Consignee Ad
     C                     Z-ADD1         ZQ      50
     C           YL0011    CAT  $GPHU1:ZQ YL0011    P      ED Consignee Ad
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0011           ED Consignee Ad
     C                     MOVEL$GPHU1    YL0011           ED Consignee Ad
     C                     END                             *FI
      * Concat State/Zip to Last Non Blank Address Line.
      * CASE: PAR.ED Consignee Addr 3 is Not Blank
     C           $GSCTX    IFNE *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           $GSCTX    CAT  YL0011:ZQ $GSCTX    P      ED Consignee Ad
     C                     ELSE
      * CASE: *OTHERWISE
      * Must Concat on Address 2 Line.
     C                     Z-ADD1         ZQ      50
     C           $GRJTX    CAT  YL0011:ZQ $GRJTX    P      ED Consignee Ad
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Addr4/City is Entered, Concat State & Zip.
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           $GSDTX    CAT  $GAAAB:ZQ YL0011    P      ED Consignee Ad
     C                     Z-ADD1         ZQ      50
     C           YL0011    CAT  $GPHU1:ZQ YL0011    P      ED Consignee Ad
      * CASE: PAR.ED Consignee Addr 2 is Blank
     C           $GRJTX    IFEQ *BLANK                     *IF
     C                     MOVELYL0011    $GRJTX           ED Consignee Ad
     C                     MOVEL*BLANK    $GSDTX           ED Consignee Ad
     C                     MOVELYL0010    $GSDTX           ED Consignee Ad
     C                     ELSE
      * CASE: PAR.ED Consignee Addr 3 is Blank
     C           $GSCTX    IFEQ *BLANK                     *IF
     C                     MOVELYL0011    $GSCTX           ED Consignee Ad
     C                     MOVEL*BLANK    $GSDTX           ED Consignee Ad
     C                     MOVELYL0010    $GSDTX           ED Consignee Ad
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Get Consignor Country Desc.
      * CASE: PAR.ED Consignor Country Code is Entered
     C           $GZ8AA    IFNE *BLANK                     *IF
      * Rtv Country Desc       RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$GZ8AA    WL0013    P      Country Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    $GPSU1    P      Country Descrip
      * Move Country Desc to Addr 3 or 4 if Blank.
      * CASE: PAR.ED Consignor Addr 3 is eq blank
     C           $GRVTX    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $GRVTX           ED Consignor Ad
     C                     MOVEL$GPSU1    $GRVTX           ED Consignor Ad
     C                     MOVEL*BLANK    $GPSU1           Consignor Count
     C                     ELSE
      * CASE: PAR.ED Consignor Addr 4 is eq blank
     C           $GPPU1    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $GPPU1           ED Consignor Ad
     C                     MOVEL$GPSU1    $GPPU1           ED Consignor Ad
     C                     MOVEL*BLANK    $GPSU1           Consignor Count
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Get Consignee Country Desc.
      * CASE: PAR.ED Consignee Country Code is Entered
     C           $GABAB    IFNE *BLANK                     *IF
      * Set 'THE PEOPLE'S REPUBLIC OF CHINA' Else Get Country Desc.
      * CASE: PAR.ED Consignee Country Code is China
     C           $GABAB    IFEQ 'CHN'                      *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,001   CAT  'CHINA':ZQ$GPTU1    P      Consignee Count
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Country Desc       RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$GABAB    WL0013    P      Country Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    $GPTU1    P      Country Descrip
     C                     END                             *FI
      * Move Country Desc to Addr 3 or 4 if Blank.
      * CASE: PAR.ED Consignee Addr 3 is eq blank
     C           $GSCTX    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $GSCTX           ED Consignee Ad
     C                     MOVEL$GPTU1    $GSCTX           ED Consignee Ad
     C                     MOVEL*BLANK    $GPTU1           Consignee Count
     C                     ELSE
      * CASE: PAR.ED Consignee Addr 4 is eq blank
     C           $GSDTX    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $GSDTX           ED Consignee Ad
     C                     MOVEL$GPTU1    $GSDTX           ED Consignee Ad
     C                     MOVEL*BLANK    $GPTU1           Consignee Count
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * DO2642 DN 10/27/22-Concat Consignor Country to Last Line Used in
      * CASE: CUR.ED Consignor Addr 4 is Not Blank
     C           $GPPU1    IFNE *BLANK                     *IF
      * If Country is on Consignor Address Line 4.
      * CASE: CUR.ED Consignor Addr 4 is Not Blank
     C           $GPPU1    IFNE *BLANK                     *IF
     C                     MOVEL$GPPU1    YL0012           Country Code
      * Rtv Country Desc       RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0012    WL0013    P      Country Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    YN0002    P      Country Descrip
      * Check Return Code.
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           $GRVTX    CAT  YL0012:ZQ $GRVTX    P      ED Consignor Ad
     C                     MOVEL*BLANK    $GPPU1           ED Consignor Ad
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * DO2642 DN 07/13/22-Build Export Doc Order Dtl PRT (PUCFCPP) File.
      * CASE: *OTHERWISE
      * Crt Exp Doc Ord Dtl PRTXF - Export Doc Order Dtl PRT  * 
     C                     CALL 'PUWBXFR'              90  Crt Exp Doc Ord
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GAIC3    WQ0001  30       Company Number
     C                     PARM $GC4NB    WQ0002  70       Order Number
     C                     PARM $GDGSX    WQ0003  1        ED Export Docum
     C                     PARM $GKXCD    WQ0004  6        Country Code
     C                     PARM $GCVSX    WQ0005  1        ED Xlate Desc t
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUWBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$GCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$GDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Prt MPG Dtl w/o MT V2TFPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Print format
     C                     WRITE$H1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of Prt MPG Dtl w/o MT V2TFPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Order Number of Prt MPG Dtl w/o MT V2TFPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print ED Export Document Type of Prt MPG Dtl w/o MT V2TFPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Country Code of Prt MPG Dtl w/o MT V2TFPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print ED Item Code of Prt MPG Dtl w/o MT V2TFPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print Order Sequence Number of Prt MPG Dtl w/o MT V2TFPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP05
     C                     END                             FI
      * Print Detail line. of Prt MPG Dtl w/o MT V2TFPO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$IDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt HC f/Doc Type H    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Company Number of Prt HC f/Doc Type H    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Order Number of Prt HC f/Doc Type H    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print ED Export Document Type of Prt HC f/Doc Type H    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print Country Code of Prt HC f/Doc Type H    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print Detail line. of Prt HC f/Doc Type H    PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$KDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Mex MPG TFP V2    PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Mex MPG TFP V2    PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of Prt Mex MPG TFP V2    PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ED Export Document Type of Prt Mex MPG TFP V2    PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Mex MPG TFP V2    PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD20        W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt MPG Dtl w/o MT V2TFPO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  6         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt MPG Dtl w/o MT V2TFPO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of Prt MPG Dtl w/o MT V2TFPO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ED Export Document Type of Prt MPG Dtl w/o MT V2TFPO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Country Code of Prt MPG Dtl w/o MT V2TFPO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ED Item Code of Prt MPG Dtl w/o MT V2TFPO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of Prt MPG Dtl w/o MT V2TFPO
     C           W0BP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt MPG Dtl w/o MT V2TFPO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt HC f/Doc Type H    PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt HC f/Doc Type H    PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of Prt HC f/Doc Type H    PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ED Export Document Type of Prt HC f/Doc Type H    PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Country Code of Prt HC f/Doc Type H    PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt HC f/Doc Type H    PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Live with PHIS    RT - Export Doc Defaults  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           ED Live with PH
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           MMAIC3           Company Number
     C                     KFLD           MMDGSX           ED Export Docum
     C                     KFLD           MMKXCD           Country Code
      * Setup key
     C                     Z-ADDWL0001    MMAIC3           Company Number
     C                     MOVELWL0002    MMDGSX           ED Export Docum
     C                     MOVELWL0003    MMKXCD           Country Code
      * Establish starting position
     C           KRSSA     CHAIN@MMREWN              90    *
      * Data record not found
     C   90                MOVEL'USR2733' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELMMC2SX    WL0004           ED Live with PH
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code        RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     Z-ADD*ZERO     YL0004           Boxes Total Qua
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSB01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSB02           Order Number
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
      * Setup key
     C                     Z-ADD$GAIC3    WQSB01           Company Number
     C                     Z-ADD$GC4NB    WQSB02           Order Number
     C                     Z-ADD1         OMDPNB           Order Sequence
     C                     Z-ADD1         OMUENB           Order Secondary
      * Establish starting position
     C           KPSSB     SETLL@BGWKL1                    *
     C           KRSSB     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WUC7SX           USR Unit of Mea
     C                     GOTO SBEXIT                     *QUIT
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PF3280 -- add "Cases" to the case-stmt
     C                     MOVELOMAJCD    YN0001           Warehouse Code
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : DB1.U/M - Ordered is Combos
      *   |- c2    : DB1.U/M - Ordered is EQ Boxes
      *   |- c3    : DB1.U/M - Ordered is Mixed
      *   |- c4    : DB1.U/M - Ordered is Cases
      *   '-
     C           OMAGCD    IFEQ 'CB'                       *IF
     C           OMAGCD    OREQ 'BX'                       *OR
     C           OMAGCD    OREQ 'MX'                       *OR
     C           OMAGCD    OREQ 'CS'                       *OR
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Sum for later check
      * CASE: DB1.U/M - Ordered is EQ Boxes
     C           OMAGCD    IFEQ 'BX'                       *IF
     C                     ADD  OMAVQT    YL0004           Boxes Total Qua
     C                     END                             *FI
      * CASE: PAR.USR Unit of Measure is *Blank
     C           WUC7SX    IFEQ *BLANK                     *IF
     C                     MOVELOMAGCD    WUC7SX           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.U/M - Ordered EQ PAR.USR Unit of Measure
     C           OMAGCD    IFEQ WUC7SX                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      WUAGCD           U_M_Ordered
     C                     MOVELWUAGCD    WUC7SX           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * E2709 RMC 9/12/13  Classify as BX/CB - never MX
      * CASE: PAR.USR Unit of Measure is Mixed
     C           WUC7SX    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
     C                     EXSR SCRVGN
      * CASE: LCL.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0004    IFLT YL0005                     *IF
     C                     MOVEL'CB'      WUC7SX           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      WUC7SX           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDOMAIC3    KMAIC3           Company Number
     C                     MOVE *BLANK    KMV8CD           Company Value C
     C                     MOVEL'BOXLOAD' KMV8CD           Company Value C
      * Establish starting position
     C           KRSSC     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    YL0005           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv ISO Code          RT - Export Doc Order Hdr Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    $GX0AA           EDE ISO Alpha_2
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           A6AIC3           Company Number
     C                     KFLD           A6C4NB           Order Number
     C                     KFLD           A6DGSX           ED Export Docum
     C                     KFLD           A6KXCD           Country Code
      * Setup key
     C                     Z-ADD$GAIC3    A6AIC3           Company Number
     C                     Z-ADD$GC4NB    A6C4NB           Order Number
     C                     MOVEL$GDGSX    A6DGSX           ED Export Docum
     C                     MOVEL$GKXCD    A6KXCD           Country Code
      * Establish starting position
     C           KRSSD     CHAIN@A6CPDH              90    *
      * Data record not found
     C   90                MOVEL'USR5073' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA6X0AA    $GX0AA           EDE ISO Alpha_2
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Applicant Addr PHISRT - Export Doc Defaults  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    $GEJNA           ED Consignor Na
     C                     MOVEL*BLANK    $GEKNA           ED Consignor Ad
     C                     MOVEL*BLANK    $GELNA           ED Consignor Ad
     C                     MOVEL*BLANK    $GEMNA           ED Consignor Ad
     C                     MOVEL*BLANK    YL0006           ED Consignor Ad
     C                     MOVEL*BLANK    YL0007           ED Consignor St
     C                     MOVEL*BLANK    YL0008           ED Consignor Po
     C                     MOVEL*BLANK    P1QITX           ED Species
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           MMAIC3           Company Number
     C                     KFLD           MMDGSX           ED Export Docum
     C                     KFLD           MMKXCD           Country Code
      * Setup key
     C                     Z-ADD$GAIC3    MMAIC3           Company Number
     C                     MOVEL'A'       MMDGSX           ED Export Docum
     C                     MOVEL$GKXCD    MMKXCD           Country Code
      * Establish starting position
     C           KRSSE     CHAIN@MMREWN              90    *
      * Data record not found
     C   90                MOVEL'USR2733' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELMMPUTX    $GEJNA           ED Consignor Na
     C                     MOVELMMPVTX    $GEKNA           ED Consignor Ad
     C                     MOVELMMPWTX    $GELNA           ED Consignor Ad
     C                     MOVELMMRVTX    $GEMNA           ED Consignor Ad
     C                     MOVELMMPPU1    YL0006           ED Consignor Ad
     C                     MOVELMMZ7AA    YL0007           ED Consignor St
     C                     MOVELMMPDU1    YL0008           ED Consignor Po
     C                     MOVELMMQITX    P1QITX           ED Species
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Applicant Addr    RT - Export Doc Defaults  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0008           ED Consignor Na
     C                     MOVEL*BLANK    WL0009           ED Consignor Ad
     C                     MOVEL*BLANK    WL0010           ED Consignor Ad
     C                     MOVEL*BLANK    WL0011           ED Consignor Ad
     C                     MOVEL*BLANK    WL0012           ED Species
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           MMAIC3           Company Number
     C                     KFLD           MMDGSX           ED Export Docum
     C                     KFLD           MMKXCD           Country Code
      * Setup key
     C                     Z-ADDWL0005    MMAIC3           Company Number
     C                     MOVELWL0006    MMDGSX           ED Export Docum
     C                     MOVELWL0007    MMKXCD           Country Code
      * Establish starting position
     C           KRSSF     CHAIN@MMREWN              90    *
      * Data record not found
     C   90                MOVEL'USR2733' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELMMPUTX    WL0008           ED Consignor Na
     C                     MOVELMMPVTX    WL0009           ED Consignor Ad
     C                     MOVELMMPWTX    WL0010           ED Consignor Ad
     C                     MOVELMMRVTX    WL0011           ED Consignor Ad
     C                     MOVELMMQITX    WL0012           ED Species
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Country Desc       RT - Country  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0014           Country Descrip
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           E5KXCD           Country Code
      * Setup key
     C                     MOVELWL0013    E5KXCD           Country Code
      * Establish starting position
     C           KRSSG     CHAIN@E5REB8              90    *
      * Data record not found
     C   90                MOVEL'USR1158' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELE5DATX    WL0014           Country Descrip
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Overflow          RT - Export Doc Order Dtl PRT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0013           Overflow
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           CFAIC3           Company Number
     C                     KFLD           CFC4NB           Order Number
     C                     KFLD           CFDGSX           ED Export Docum
     C                     KFLD           CFKXCD           Country Code
     C                     KFLD           CFHGCD           Item Code
      * Setup key
     C                     Z-ADD$JAIC3    CFAIC3           Company Number
     C                     Z-ADD$JC4NB    CFC4NB           Order Number
     C                     MOVEL$JDGSX    CFDGSX           ED Export Docum
     C                     MOVEL$JKXCD    CFKXCD           Country Code
     C                     Z-ADD$JDIC7    CFHGCD           Item Code
      * Establish starting position
     C           KRSSH     CHAIN@CFCPJV              90    *
      * Data record not found
     C   90                MOVEL'USR5245' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELCFMYSC    YL0013           Overflow
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Upd Item Printed      RT - Export Doc Order Dtl PRT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           CFAIC3           Company Number
     C                     KFLD           CFC4NB           Order Number
     C                     KFLD           CFDGSX           ED Export Docum
     C                     KFLD           CFKXCD           Country Code
     C                     KFLD           CFHGCD           Item Code
      * Setup key
     C                     Z-ADD$JAIC3    CFAIC3           Company Number
     C                     Z-ADD$JC4NB    CFC4NB           Order Number
     C                     MOVEL$JDGSX    CFDGSX           ED Export Docum
     C                     MOVEL$JKXCD    CFKXCD           Country Code
     C                     Z-ADD$JDIC7    CFHGCD           Item Code
      * Establish starting position
     C           KRSSI     CHAIN@CFCPJV              90    *
      * Data record not found
     C   90                MOVEL'USR5245' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Doc Ord Dtl PRT   CH - Export Doc Order Dtl PRT  * 
     C                     EXSR SJCHRC
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Doc Ord Dtl PRT   CH - Export Doc Order Dtl PRT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @CFCPJU
     C                     Z-ADDCFAIC3    WAAIC3           Company Number
     C                     Z-ADDCFC4NB    WAC4NB           Order Number
     C                     MOVELCFDGSX    WADGSX    P      ED Export Docum
     C                     MOVELCFKXCD    WAKXCD    P      Country Code
     C                     Z-ADDCFHGCD    WAHGCD           Item Code
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WADGSX           ED Export Docum
     C                     KFLD           WAKXCD           Country Code
     C                     KFLD           WAHGCD           Item Code
     C           KLCHSJ    CHAIN@CFCPJU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PUCFCPL0'MDACP
     C                     MOVEL'@CFCPJU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPUCF1    YARDCS
      * Move non-key fields to @CFCPJU
     C                     MOVELCFRDU1    WARDU1    P      Description Xla
     C                     MOVELCFREU1    WAREU1    P      Description Xla
     C                     MOVELCFRFU1    WARFU1    P      Overflow Pg Dsc
     C                     MOVELCFMYSC    WAMYSC    P      Overflow
     C                     Z-ADDCFG2NZ    WAG2NZ           EDODP Unused Nu
     C                     MOVELCFM9SC    WAM9SC    P      Skip Ln Before
     C                     MOVELCFNASC    WANASC    P      Skip Ln After X
     C                     MOVELCFM4SC    WAM4SC    P      Prt Inspector N
     C                     MOVEL'Y'       WAMZSC    P      Item Printed
     C                     MOVELCFM5SC    WAM5SC    P      Prt Continuatio
     C                     Z-ADDCFG7NZ    WAG7NZ           # of Blank Line
     C                     Z-ADDCFG8NZ    WAG8NZ           # of Blank Line
     C                     Z-ADDCFG9NZ    WAG9NZ           # of Blank Line
     C                     Z-ADDCFHANZ    WAHANZ           # of Blank Line
     C                     MOVELCFM6SC    WAM6SC    P      EDODP Unused St
     C                     MOVELCFM7SC    WAM7SC    P      EDODP Unused St
     C                     Z-ADDCFG3NZ    WAG3NZ           EDODP Unused Nb
     C                     Z-ADDCFXSDT    WAXSDT           EDODP Unused Dt
     C                     MOVELCFRLU1    WARLU1    P      EDODP Unused Tx
     C                     MOVELCFRMU1    WARMU1    P      EDODP Unused Tx
      *
      * Set PGM.*Record Data Changed flag
     C           QPUCF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@CFCPJU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPUCFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADD$MAIC3    KMAIC3           Company Number
     C                     MOVEL@CN,003   KMV8CD           Company Value C
      * Establish starting position
     C           KRSSK     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    YL0015           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt MPG Dtl w/o MT V2TFPO
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  50       Count USR
     C                     MOVEL*BLANK    WN0002  1        ED Print Kilogr
      *
      * Prt MPG Dtl w/o MT V2TFPO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt HC f/Doc Type H    PO
      *================================================================
      * Prt HC f/Doc Type H    PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * Prt MPG Dtl w/o MT V2TFPO: Initialise
      *================================================================
      * USER: Initialize program
      * NOTE: Per WI 497, we will now print both Item Label Line 1 & 2 in
      *       one box and the Translated Desc Line 1 & 2 in the next box.
      * RMC 10/3/05 Combined like items into 1 line, so print at total ti
     C                     MOVEL'N'       P3DLST           USR Overflow
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZCINIT    BEGSR
      *================================================================
      * Prt HC f/Doc Type H    PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL'N'       YL0014           Prt Exp Doc Ord
      *================================================================
     CSR         ZCEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1QITX           ED Species
     C                     Z-ADD*ZERO     P2CNTU           Count USR
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    MRAIC3           Company Number
     C                     MOVEL*LOVAL    MRC4NB           Order Number
     C                     MOVEL*LOVAL    MRDGSX           ED Export Docum
     C                     MOVEL*LOVAL    MRKXCD           Country Code
      * Define work field ED Export Certificate Nbr
     C                     Z-ADD*ZERO     WUMQDT  70
      * Define work field ED Shipping Marks Txt
     C                     MOVEL*BLANK    WUORNA 15
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field ED Total Package UOM
     C                     MOVEL*BLANK    WUC7SX  2
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field U_M_Ordered
     C                     MOVEL*BLANK    WUAGCD  2
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    MSAIC3           Company Number
     C                     MOVEL*LOVAL    MSC4NB           Order Number
     C                     MOVEL*LOVAL    MSDGSX           ED Export Docum
     C                     MOVEL*LOVAL    MSKXCD           Country Code
     C                     MOVEL*LOVAL    MSDIC7           ED Item Code
     C                     MOVEL*LOVAL    MSDPNB           Order Sequence
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAG2NZ           EDODP Unused Nu
     C                     Z-ADD*ZERO     WAG7NZ           # of Blank Line
     C                     Z-ADD*ZERO     WAG8NZ           # of Blank Line
     C                     Z-ADD*ZERO     WAG9NZ           # of Blank Line
     C                     Z-ADD*ZERO     WAHANZ           # of Blank Line
     C                     Z-ADD*ZERO     WAG3NZ           EDODP Unused Nb
     C                     Z-ADD*ZERO     WAXSDT           EDODP Unused Dt
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    CFAIC3           Company Number
     C                     MOVEL*LOVAL    CFC4NB           Order Number
     C                     MOVEL*LOVAL    CFDGSX           ED Export Docum
     C                     MOVEL*LOVAL    CFKXCD           Country Code
     C                     MOVEL*LOVAL    CFHGCD           Item Code
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Date (Alpha) USR
     C                     MOVEL*BLANK    WUR4TX  7
      * Define work field Month/Day Alpha MMDD
     C                     MOVEL*BLANK    WUUBT1  4
      * Define work field Year  (Char) USR
     C                     MOVEL*BLANK    WUT4TX  2
      * Define work field Year Alpha (YYYY) USR
     C                     MOVEL*BLANK    WUT9TX  4
      * Define work field Date (Char-8) USR
     C                     MOVEL*BLANK    WUGWT1  8
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  1
     C                     MOVEL*BLANK    WL0003  6
     C                     MOVEL*BLANK    WL0004  1
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     MOVEL*BLANK    WL0006  1
     C                     MOVEL*BLANK    WL0007  6
     C                     MOVEL*BLANK    WL0008 63
     C                     MOVEL*BLANK    WL0009 63
     C                     MOVEL*BLANK    WL0010 63
     C                     MOVEL*BLANK    WL0011 63
     C                     MOVEL*BLANK    WL0012 25
      * Define local variables for subroutine SGRVGN.
     C                     MOVEL*BLANK    WL0013  6
     C                     MOVEL*BLANK    WL0014 30
      * Define local work field ED Live with PHIS
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Date                  USR
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field ED Plant Number
     C                     MOVEL*BLANK    YL0003 10
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0001  3
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0004 112
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0005  50
      * Define local work field ED Consignor Addr 4
     C                     MOVEL*BLANK    YL0006 63
      * Define local work field ED Consignor State
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field ED Consignor Postal
     C                     MOVEL*BLANK    YL0008 20
      * Define local work field ED Consignee Addr 3
     C                     MOVEL*BLANK    YL0009 63
      * Define local work field USR Blank Field
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field ED Consignee Addr 4
     C                     MOVEL*BLANK    YL0011 63
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0012  6
      * Define null work field Country Description
     C                     MOVEL*BLANK    YN0002 30
      * Define local work field Overflow
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field Prt Exp Doc Ord Dtl PRT U
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    YL0015  1
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * DO2642 DN 07/18/22-Get Live with PHIS Flag.
      * Rtv Live with PHIS    RT - Export Doc Defaults  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     MOVEL'A'       WL0002    P      ED Export Docum
     C                     MOVELP1KXCD    WL0003    P      Country Code
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0001    P      ED Live with PH
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 THE PEOPLE'S REPUBLIC OF
00002 Lot No.
00003 MPGMEXEST
00004 Seaboard Foods
00005 Guymon Cold Storage
00006 2700 NE 28th St
00007 Guymon Oklahoma 73942
00008 Triumph Foods, LLC
00009 5302 Stockyards Expresswa
00010 St. Joseph MO  64504
