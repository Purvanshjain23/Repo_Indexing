// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PMVHXFR
// ?Date: 14.08.2025 Time: 03:44:12
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Rtv Lot Tracking Flag RT) TYPE(RTVOBJ) FILE(CAADREP)           AC1506123;
PARAMETER(PAR.Warehouse_Code);
PARAMETER(LCL.Lot_Tracking_Flag);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


EXECUTE FUNCTION(Upd Del Item Bal Dtl  RT) TYPE(RTVOBJ) FILE(CAB1REP)           AC1886224;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Warehouse_Code);
PARAMETER(LCL.Lot_Tracking_Flag);
{
 //?USER: Process Data record

 //?12/13/08 PKD Also check the Physical Count Quantity before
 //?             deleting the Item Balance Detail
 CASE;

 // IF PAR.Lot Tracking Flag is yes
 IF PAR.Lot_Tracking_Flag = 'Y';

 CASE;

 // IF DB1.Quantity on Hand - U/M1 is Equal to zero
 IF DB1.Quantity_on_Hand_UOM1 = *ZERO;

 // AND DB1.Physical Count Qty - U/M1 is Equal to zero
 AND DB1.Physical_Count_Qty_UOM1 = *ZERO;

 EXECUTE FUNCTION(Val Prod Date Exist   RT) TYPE(RTVOBJ) FILE(PDL5CPP)           AC1544117;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(DB1.Warehouse_Code);
 PARAMETER(DB1.Production_Date);
 PARAMETER(PAR.Record_Found_USR);
 {
  //?USER: Processing if Data record not found

  // PAR.Record Found USR = CND.Record Not Found
  PAR.Record_Found_USR = 'N';

  //?USER: Process Data record

  // PAR.Record Found USR = CND.Record Found
  PAR.Record_Found_USR = 'Y';

  QUIT;

 }

 CASE;

 // IF PAR.Record Found USR is Record Not Found
 IF PAR.Record_Found_USR = 'N';

 EXECUTE FUNCTION(Del Item Balance Dtl  DL) TYPE(DLTOBJ) FILE(CAB1REP)           AC1544111;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(DB1.Warehouse_Code);
 PARAMETER(DB1.Production_Date);
 ENDIF;

 ENDIF;

 // IF *OTHERWISE
 IF *OTHERWISE;

 CASE;

 // IF DB1.Quantity on Hand - U/M1 is Equal to zero
 IF DB1.Quantity_on_Hand_UOM1 = *ZERO;

 // AND DB1.Physical Count Qty - U/M1 is Equal to zero
 AND DB1.Physical_Count_Qty_UOM1 = *ZERO;

 EXECUTE FUNCTION(Del Item Balance Dtl  DL) TYPE(DLTOBJ) FILE(CAB1REP)           AC1544111;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(DB1.Warehouse_Code);
 PARAMETER(DB1.Production_Date);
 ENDIF;

 ENDIF;

}


