     H/TITLE EDT Ship Price Details DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSHENR
     H* Date          : 04/25/23  Time  : 14:49:29
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDNKDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: EDT Ship Price Details DF Display file
      *
     FPDIMCPW2IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Detail Pricing      Ord/Dtl/Prc Seq Work
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMFYREL0IF  E           K        DISK
      * RTV : Commodity Markets         Retrieval index
      *
     FPDIMCPL1IF  E           K        DISK
      * RTV : Order Detail Pricing      Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FOPBGWKLDIF  E           K        DISK
      * RSQ : Order Detail              Co/Order#/Item/Whse Not
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAASREL3IF  E           K        DISK
      * RTV : Company Control           Retrieval Active Only
      *
     FOMF0CPL2IF  E           K        DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
     FPDIHREL0IF  E           K        DISK
      * RTV : Price Method Header       Retrieval index
      *
     FPDIKREL2IF  E           K        DISK
      * RSQ : Price Method Detail       K=Co,Meth,Component;Actv
      *
     FPDIJREL1IF  E           K        DISK
      * RTV : Price Method Componant    Retrieval index
      *
     FOPCIREL7IF  E           K        DISK
      * RSQ : OPP Item Contract         RSQ Cont#/Co/Cust/Item
      *
     FPDIHREL3IF  E           K        DISK
      * RSQ : Price Method Header       System/Co/Price Method
      *
     FPDIPREL2IF  E           K        DISK
      * RSQ : Market Date Method        System/Co/Date Method
      *
     FOPCIREL8IF  E           K        DISK
      * RTV : OPP Item Contract         Active only
      *
     FOMF0CPL3IF  E           K        DISK
      * RTV : Commodity Mrkt Price      Active Only
      *
     FPOC6RELBIF  E           K        DISK
      * RSQ : Customer Price Header     ShipTo/PriceCd,Sel Activ
      *
     FPOC7REL1IF  E           K        DISK
      * RTV : Customer Price Detail     Retrieval index
      *
     FPDIMCPW1IF  E           K        DISK
      * RTV : Order Detail Pricing      Rtv Index for Work File
      *
     FPDJKCPL1IF  E           K        DISK
      * RTV : Order Dtl Formula Dtl     Retrieval index
      *
     FPDJKCPW1IF  E           K        DISK
      * RTV : Order Dtl Formula Dtl     Rtv Index for Work File
      *
     FPDK3CPL2IF  E           K        DISK
      * RSQ : Price Change Audit Log    Co/Ord/Seq1&2/AdtSeq (D)
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDIMCPL0UF  E           K        DISK                      A
      * UPD : Order Detail Pricing      Update index
      *
     FPDJKCPL0UF  E           K        DISK                      A
      * UPD : Order Dtl Formula Dtl     Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPDK3CPL0IF  E           K        DISK                      A
      * UPD : Price Change Audit Log    Update index
      *
     FPDJKCPW0UF  E           K        DISK                      A
      * UPD : Order Dtl Formula Dtl     Upd Index for Work File
      *
     FPDIMCPW0UF  E           K        DISK                      A
      * UPD : Order Detail Pricing      Upd Index for Work File
      *
     E                    #L7         7  1
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 046  5 0A
     E                    W0END   7 046  5 0A
     E                    W0NAM   7 046 10
      * Long constants
     E                    @CN#    1  11  6   @CN    25
     I@IMCPSE
      * Order Detail Pricing      Retrieval index
      * Renamed input format fields
     I              IMAIC3                          WAAIC3
     I              IMC4NB                          WAC4NB
     I              IMDPNB                          WADPNB
     I              IMUENB                          WAUENB
     I              IMQ9CD                          WAQ9CD
     I              IMPDSQ                          WAPDSQ
     I              IMBNPR                          WABNPR
     I              IMU6ST                          WAU6ST
     I              IMUVST                          WAUVST
     I              IMUWST                          WAUWST
     I              IMUXST                          WAUXST
     I              IMAATM                          WAAATM
     I              IMAYNA                          WAAYNA
     I              IMA0NA                          WAA0NA
     I              IMAXDT                          WAAXDT
      *
     I@IHREFI
      * Price Method Header       System/Co/Price Method
      * Renamed input format fields
     I              IHAIC3                          WBAIC3
     I              IHQ7CD                          WBQ7CD
     I              IHMLNA                          WBMLNA
     I              IHU0ST                          WBU0ST
     I              IHV8ST                          WBV8ST
     I              IHBYST                          WBBYST
     I              IHRMNY                          WBRMNY
     I              IHH3ST                          WBH3ST
     I              IHH5ST                          WBH5ST
     I              IHH6ST                          WBH6ST
     I              IHH7ST                          WBH7ST
     I              IHUVST                          WBUVST
     I              IHUWST                          WBUWST
     I              IHUXST                          WBUXST
     I              IHAATM                          WBAATM
     I              IHAYNA                          WBAYNA
     I              IHA0NA                          WBA0NA
     I              IHAXDT                          WBAXDT
      *
     I@CIREWP
      * OPP Item Contract         Active only
      * Renamed input format fields
     I              CIAIC3                          WCAIC3
     I              CIBKC7                          WCBKC7
     I              CIHGCD                          WCHGCD
     I              CIAUDT                          WCAUDT
     I              CICWDT                          WCCWDT
     I              CIAUST                          WCAUST
     I              CIANDT                          WCANDT
     I              CIAUNA                          WCAUNA
     I              CIDQQT                          WCDQQT
     I              CIHFQT                          WCHFQT
     I              CIL6NB                          WCL6NB
     I              CIFSQT                          WCFSQT
     I              CIB0PR                          WCB0PR
     I              CIGBDT                          WCGBDT
     I              CIGCDT                          WCGCDT
     I              CIGDDT                          WCGDDT
     I              CIRDCD                          WCRDCD
     I              CIQ7CD                          WCQ7CD
     I              CIRQCD                          WCRQCD
     I              CIR4CD                          WCR4CD
     I              CIUVST                          WCUVST
     I              CIUWST                          WCUWST
     I              CIUXST                          WCUXST
     I              CIVSST                          WCVSST
     I              CIAATM                          WCAATM
     I              CIAYNA                          WCAYNA
     I              CIA0NA                          WCA0NA
     I              CIAXDT                          WCAXDT
      *
     I@F0CPVR
      * Commodity Mrkt Price      Active Only
      * Renamed input format fields
     I              F0LQCD                          WDLQCD
     I              F0LRCD                          WDLRCD
     I              F0EQDT                          WDEQDT
     I              F0A5PR                          WDA5PR
     I              F0B8PR                          WDB8PR
     I              F0UVST                          WDUVST
     I              F0UWST                          WDUWST
     I              F0UXST                          WDUXST
     I              F0VSST                          WDVSST
     I              F0AATM                          WDAATM
     I              F0AYNA                          WDAYNA
     I              F0A0NA                          WDA0NA
     I              F0AXDT                          WDAXDT
      *
     I@IMCPSD
      * Order Detail Pricing      Update index
      * Renamed input format fields
     I              IMAIC3                          WEAIC3
     I              IMC4NB                          WEC4NB
     I              IMDPNB                          WEDPNB
     I              IMUENB                          WEUENB
     I              IMQ9CD                          WEQ9CD
     I              IMPDSQ                          WEPDSQ
     I              IMBNPR                          WEBNPR
     I              IMU6ST                          WEU6ST
     I              IMUVST                          WEUVST
     I              IMUWST                          WEUWST
     I              IMUXST                          WEUXST
     I              IMAATM                          WEAATM
     I              IMAYNA                          WEAYNA
     I              IMA0NA                          WEA0NA
     I              IMAXDT                          WEAXDT
      *
     I@IMCPZ5
      * Order Detail Pricing      Rtv Index for Work File
      * Renamed input format fields
     I              IMAIC3                          WFAIC3
     I              IMC4NB                          WFC4NB
     I              IMDPNB                          WFDPNB
     I              IMUENB                          WFUENB
     I              IMQ9CD                          WFQ9CD
     I              IMPDSQ                          WFPDSQ
     I              IMBNPR                          WFBNPR
     I              IMU6ST                          WFU6ST
     I              IMUVST                          WFUVST
     I              IMUWST                          WFUWST
     I              IMUXST                          WFUXST
     I              IMAATM                          WFAATM
     I              IMAYNA                          WFAYNA
     I              IMA0NA                          WFA0NA
     I              IMAXDT                          WFAXDT
      *
     I@JKCPYE
      * Order Dtl Formula Dtl     Update index
      * Renamed input format fields
     I              JKAIC3                          WGAIC3
     I              JKC4NB                          WGC4NB
     I              JKDPNB                          WGDPNB
     I              JKUENB                          WGUENB
     I              JKQ9CD                          WGQ9CD
     I              JKHGCD                          WGHGCD
     I              JKZXNB                          WGZXNB
     I              JKBOPR                          WGBOPR
     I              JKCDPR                          WGCDPR
     I              JKCEPR                          WGCEPR
     I              JKU6ST                          WGU6ST
     I              JKUVST                          WGUVST
     I              JKUWST                          WGUWST
     I              JKUXST                          WGUXST
     I              JKAATM                          WGAATM
     I              JKAYNA                          WGAYNA
     I              JKA0NA                          WGA0NA
     I              JKAXDT                          WGAXDT
      *
     I@JKCPZ7
      * Order Dtl Formula Dtl     Rtv Index for Work File
      * Renamed input format fields
     I              JKAIC3                          WHAIC3
     I              JKC4NB                          WHC4NB
     I              JKDPNB                          WHDPNB
     I              JKUENB                          WHUENB
     I              JKQ9CD                          WHQ9CD
     I              JKHGCD                          WHHGCD
     I              JKZXNB                          WHZXNB
     I              JKBOPR                          WHBOPR
     I              JKCDPR                          WHCDPR
     I              JKCEPR                          WHCEPR
     I              JKU6ST                          WHU6ST
     I              JKUVST                          WHUVST
     I              JKUWST                          WHUWST
     I              JKUXST                          WHUXST
     I              JKAATM                          WHAATM
     I              JKAYNA                          WHAYNA
     I              JKA0NA                          WHA0NA
     I              JKAXDT                          WHAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WIAIC3
     I              OMC4NB                          WIC4NB
     I              OMDPNB                          WIDPNB
     I              OMUENB                          WIUENB
     I              OMHGCD                          WIHGCD
     I              OMAJCD                          WIAJCD
     I              OMBKC7                          WIBKC7
     I              OMCFC7                          WICFC7
     I              OMGMST                          WIGMST
     I              OMGNST                          WIGNST
     I              OMMAVA                          WIMAVA
     I              OMKDVA                          WIKDVA
     I              OML8VA                          WIL8VA
     I              OML9VA                          WIL9VA
     I              OMGTST                          WIGTST
     I              OMGVST                          WIGVST
     I              OMGUST                          WIGUST
     I              OMQFST                          WIQFST
     I              OMAYVA                          WIAYVA
     I              OMEXDT                          WIEXDT
     I              OMLQCD                          WILQCD
     I              OMRDCD                          WIRDCD
     I              OMQ7CD                          WIQ7CD
     I              OMBZPR                          WIBZPR
     I              OML6NB                          WIL6NB
     I              OMU1ST                          WIU1ST
     I              OMGIDT                          WIGIDT
     I              OMCRCD                          WICRCD
     I              OMAGCD                          WIAGCD
     I              OMRZST                          WIRZST
     I              OMR0ST                          WIR0ST
     I              OMR1ST                          WIR1ST
     I              OMG7NA                          WIG7NA
     I              OMG8NA                          WIG8NA
     I              OMRPCD                          WIRPCD
     I              OMVEST                          WIVEST
     I              OMVGST                          WIVGST
     I              OMAVST                          WIAVST
     I              OMU0ST                          WIU0ST
     I              OMRFCD                          WIRFCD
     I              OMFZST                          WIFZST
     I              OMR1NB                          WIR1NB
     I              OMAVQT                          WIAVQT
     I              OMD0WG                          WID0WG
     I              OMCCQT                          WICCQT
     I              OMAUWG                          WIAUWG
     I              OMCBQT                          WICBQT
     I              OMATWG                          WIATWG
     I              OMAQCS                          WIAQCS
     I              OMAGCS                          WIAGCS
     I              OMAKPR                          WIAKPR
     I              OMALPR                          WIALPR
     I              OMAUPR                          WIAUPR
     I              OMAVWG                          WIAVWG
     I              OMA4WG                          WIA4WG
     I              OMA5DT                          WIA5DT
     I              OMAODT                          WIAODT
     I              OMGNDT                          WIGNDT
     I              OMAMST                          WIAMST
     I              OMANST                          WIANST
     I              OMVAST                          WIVAST
     I              OMRGNB                          WIRGNB
     I              OMRHNB                          WIRHNB
     I              OMRINB                          WIRINB
     I              OMRBCD                          WIRBCD
     I              OMHICD                          WIHICD
     I              OMRNCD                          WIRNCD
     I              OMROCD                          WIROCD
     I              OMCXDT                          WICXDT
     I              OMAJVN                          WIAJVN
     I              OMKXCD                          WIKXCD
     I              OMJPCD                          WIJPCD
     I              OMCQCD                          WICQCD
     I              OMR4CD                          WIR4CD
     I              OMZ1ST                          WIZ1ST
     I              OMZ3ST                          WIZ3ST
     I              OMZ4ST                          WIZ4ST
     I              OMDUPR                          WIDUPR
     I              OMB6VL                          WIB6VL
     I              OMA1AA                          WIA1AA
     I              OMFZSX                          WIFZSX
     I              OMF0SX                          WIF0SX
     I              OMF1SX                          WIF1SX
     I              OMF2SX                          WIF2SX
     I              OMF3SX                          WIF3SX
     I              OMF4SX                          WIF4SX
     I              OMF5SX                          WIF5SX
     I              OMF6SX                          WIF6SX
     I              OMF7SX                          WIF7SX
     I              OMNTDT                          WINTDT
     I              OMNUDT                          WINUDT
     I              OMNVDT                          WINVDT
     I              OMNWDT                          WINWDT
     I              OMNXDT                          WINXDT
     I              OMBUTM                          WIBUTM
     I              OMBVTM                          WIBVTM
     I              OMBWTM                          WIBWTM
     I              OMBXTM                          WIBXTM
     I              OMBYTM                          WIBYTM
     I              OMH5NX                          WIH5NX
     I              OMH6NX                          WIH6NX
     I              OMH7NX                          WIH7NX
     I              OMH8NX                          WIH8NX
     I              OMH9NX                          WIH9NX
     I              OMDVPR                          WIDVPR
     I              OMDWPR                          WIDWPR
     I              OMDXPR                          WIDXPR
     I              OMDYPR                          WIDYPR
     I              OMDZPR                          WIDZPR
     I              OMGSPR                          WIGSPR
     I              OMGTPR                          WIGTPR
     I              OMGUPR                          WIGUPR
     I              OMHOST                          WIHOST
     I              OMHPST                          WIHPST
     I              OMIOST                          WIIOST
     I              OMPEWG                          WIPEWG
     I              OMRINY                          WIRINY
     I              OMTIDT                          WITIDT
     I              OMTJDT                          WITJDT
     I              OMH2ST                          WIH2ST
     I              OMH0ST                          WIH0ST
     I              OMH1ST                          WIH1ST
     I              OMTKDT                          WITKDT
     I              OMTLDT                          WITLDT
     I              OMTMDT                          WITMDT
     I              OMUVST                          WIUVST
     I              OMUWST                          WIUWST
     I              OMUXST                          WIUXST
     I              OMAATM                          WIAATM
     I              OMAYNA                          WIAYNA
     I              OMA0NA                          WIA0NA
     I              OMAXDT                          WIAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WJAIC3
     I              BEC4NB                          WJC4NB
     I              BEJNCD                          WJJNCD
     I              BEANC7                          WJANC7
     I              BEBKC7                          WJBKC7
     I              BEBRTX                          WJBRTX
     I              BEHMNA                          WJHMNA
     I              BEHONA                          WJHONA
     I              BEHPNA                          WJHPNA
     I              BEHNNA                          WJHNNA
     I              BEDBCD                          WJDBCD
     I              BECKTX                          WJCKTX
     I              BEB0C7                          WJB0C7
     I              BEAETX                          WJAETX
     I              BEB1NA                          WJB1NA
     I              BEB3NA                          WJB3NA
     I              BEB4NA                          WJB4NA
     I              BEB2NA                          WJB2NA
     I              BEBHCD                          WJBHCD
     I              BEC8TX                          WJC8TX
     I              BEBCNA                          WJBCNA
     I              BEA0DT                          WJA0DT
     I              BEA5DT                          WJA5DT
     I              BEGNDT                          WJGNDT
     I              BEACDT                          WJACDT
     I              BEAQCD                          WJAQCD
     I              BEB6NA                          WJB6NA
     I              BEBYNA                          WJBYNA
     I              BEBZNA                          WJBZNA
     I              BEGTST                          WJGTST
     I              BEGVST                          WJGVST
     I              BEGUST                          WJGUST
     I              BEQFST                          WJQFST
     I              BECQCD                          WJCQCD
     I              BEGJST                          WJGJST
     I              BEGWST                          WJGWST
     I              BEGXST                          WJGXST
     I              BEGYST                          WJGYST
     I              BEAODT                          WJAODT
     I              BEAIVN                          WJAIVN
     I              BECXDT                          WJCXDT
     I              BEJZVA                          WJJZVA
     I              BEA1WG                          WJA1WG
     I              BEXIST                          WJXIST
     I              BEXJST                          WJXJST
     I              BEXKST                          WJXKST
     I              BEEIDT                          WJEIDT
     I              BEAFTM                          WJAFTM
     I              BEE8CD                          WJE8CD
     I              BEE9CD                          WJE9CD
     I              BERMNB                          WJRMNB
     I              BETBNB                          WJTBNB
     I              BER1NB                          WJR1NB
     I              BEPJST                          WJPJST
     I              BEU0ST                          WJU0ST
     I              BEU1ST                          WJU1ST
     I              BEQ2CD                          WJQ2CD
     I              BEU2ST                          WJU2ST
     I              BEVEST                          WJVEST
     I              BEVFST                          WJVFST
     I              BEVGST                          WJVGST
     I              BERPCD                          WJRPCD
     I              BERNNB                          WJRNNB
     I              BEVDST                          WJVDST
     I              BEATIN                          WJATIN
     I              BEU4ST                          WJU4ST
     I              BEU5ST                          WJU5ST
     I              BERSRN                          WJRSRN
     I              BEMHNA                          WJMHNA
     I              BEMINA                          WJMINA
     I              BEWBST                          WJWBST
     I              BER4CD                          WJR4CD
     I              BEBFCD                          WJBFCD
     I              BEQ4CD                          WJQ4CD
     I              BET3NB                          WJT3NB
     I              BESICD                          WJSICD
     I              BECONB                          WJCONB
     I              BECEST                          WJCEST
     I              BEAWDT                          WJAWDT
     I              BEJPCD                          WJJPCD
     I              BEXUST                          WJXUST
     I              BEZ1ST                          WJZ1ST
     I              BEVRVA                          WJVRVA
     I              BEOBST                          WJOBST
     I              BEBCST                          WJBCST
     I              BEBDST                          WJBDST
     I              BEB7VL                          WJB7VL
     I              BEGASX                          WJGASX
     I              BEGBSX                          WJGBSX
     I              BEGCSX                          WJGCSX
     I              BEGDSX                          WJGDSX
     I              BEFNSX                          WJFNSX
     I              BEFOSX                          WJFOSX
     I              BEFPSX                          WJFPSX
     I              BEFQSX                          WJFQSX
     I              BEFRSX                          WJFRSX
     I              BEFSSX                          WJFSSX
     I              BEFTSX                          WJFTSX
     I              BEFUSX                          WJFUSX
     I              BEFVSX                          WJFVSX
     I              BEFWSX                          WJFWSX
     I              BEFXSX                          WJFXSX
     I              BEFYSX                          WJFYSX
     I              BENODT                          WJNODT
     I              BENPDT                          WJNPDT
     I              BENQDT                          WJNQDT
     I              BENRDT                          WJNRDT
     I              BENSDT                          WJNSDT
     I              BEBPTM                          WJBPTM
     I              BEBQTM                          WJBQTM
     I              BEBRTM                          WJBRTM
     I              BEBSTM                          WJBSTM
     I              BEBTTM                          WJBTTM
     I              BEH0NX                          WJH0NX
     I              BEH1NX                          WJH1NX
     I              BEH2NX                          WJH2NX
     I              BEH3NX                          WJH3NX
     I              BEH4NX                          WJH4NX
     I              BEC0C7                          WJC0C7
     I              BEUVST                          WJUVST
     I              BEUWST                          WJUWST
     I              BEUXST                          WJUXST
     I              BEAATM                          WJAATM
     I              BEAYNA                          WJAYNA
     I              BEA0NA                          WJA0NA
     I              BEAXDT                          WJAXDT
      *
     I@K3CPKP
      * Price Change Audit Log    Update index
      * Renamed input format fields
     I              K3AIC3                          WKAIC3
     I              K3C4NB                          WKC4NB
     I              K3DPNB                          WKDPNB
     I              K3UENB                          WKUENB
     I              K3ASNO                          WKASNO
     I              K3HGCD                          WKHGCD
     I              K3GMST                          WKGMST
     I              K3GNST                          WKGNST
     I              K3AYVA                          WKAYVA
     I              K3YJVA                          WKYJVA
     I              K3U1ST                          WKU1ST
     I              K3PSTL                          WKPSTL
     I              K3U0ST                          WKU0ST
     I              K3RFCD                          WKRFCD
     I              K3PALS                          WKPALS
     I              K3WWCD                          WKWWCD
     I              K3AKPR                          WKAKPR
     I              K3DBPR                          WKDBPR
     I              K3ALPR                          WKALPR
     I              K3DCPR                          WKDCPR
     I              K3JPCD                          WKJPCD
     I              K3WXCD                          WKWXCD
     I              K3PREC                          WKPREC
     I              K3PIDX                          WKPIDX
     I              K3UVST                          WKUVST
     I              K3UWST                          WKUWST
     I              K3UXST                          WKUXST
     I              K3AATM                          WKAATM
     I              K3AYNA                          WKAYNA
     I              K3A0NA                          WKA0NA
     I              K3AXDT                          WKAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WLAIC3
     I              OMC4NB                          WLC4NB
     I              OMDPNB                          WLDPNB
     I              OMUENB                          WLUENB
     I              OMHGCD                          WLHGCD
     I              OMAJCD                          WLAJCD
     I              OMBKC7                          WLBKC7
     I              OMCFC7                          WLCFC7
     I              OMGMST                          WLGMST
     I              OMGNST                          WLGNST
     I              OMMAVA                          WLMAVA
     I              OMKDVA                          WLKDVA
     I              OML8VA                          WLL8VA
     I              OML9VA                          WLL9VA
     I              OMGTST                          WLGTST
     I              OMGVST                          WLGVST
     I              OMGUST                          WLGUST
     I              OMQFST                          WLQFST
     I              OMAYVA                          WLAYVA
     I              OMEXDT                          WLEXDT
     I              OMLQCD                          WLLQCD
     I              OMRDCD                          WLRDCD
     I              OMQ7CD                          WLQ7CD
     I              OMBZPR                          WLBZPR
     I              OML6NB                          WLL6NB
     I              OMU1ST                          WLU1ST
     I              OMGIDT                          WLGIDT
     I              OMCRCD                          WLCRCD
     I              OMAGCD                          WLAGCD
     I              OMRZST                          WLRZST
     I              OMR0ST                          WLR0ST
     I              OMR1ST                          WLR1ST
     I              OMG7NA                          WLG7NA
     I              OMG8NA                          WLG8NA
     I              OMRPCD                          WLRPCD
     I              OMVEST                          WLVEST
     I              OMVGST                          WLVGST
     I              OMAVST                          WLAVST
     I              OMU0ST                          WLU0ST
     I              OMRFCD                          WLRFCD
     I              OMFZST                          WLFZST
     I              OMR1NB                          WLR1NB
     I              OMAVQT                          WLAVQT
     I              OMD0WG                          WLD0WG
     I              OMCCQT                          WLCCQT
     I              OMAUWG                          WLAUWG
     I              OMCBQT                          WLCBQT
     I              OMATWG                          WLATWG
     I              OMAQCS                          WLAQCS
     I              OMAGCS                          WLAGCS
     I              OMAKPR                          WLAKPR
     I              OMALPR                          WLALPR
     I              OMAUPR                          WLAUPR
     I              OMAVWG                          WLAVWG
     I              OMA4WG                          WLA4WG
     I              OMA5DT                          WLA5DT
     I              OMAODT                          WLAODT
     I              OMGNDT                          WLGNDT
     I              OMAMST                          WLAMST
     I              OMANST                          WLANST
     I              OMVAST                          WLVAST
     I              OMRGNB                          WLRGNB
     I              OMRHNB                          WLRHNB
     I              OMRINB                          WLRINB
     I              OMRBCD                          WLRBCD
     I              OMHICD                          WLHICD
     I              OMRNCD                          WLRNCD
     I              OMROCD                          WLROCD
     I              OMCXDT                          WLCXDT
     I              OMAJVN                          WLAJVN
     I              OMKXCD                          WLKXCD
     I              OMJPCD                          WLJPCD
     I              OMCQCD                          WLCQCD
     I              OMR4CD                          WLR4CD
     I              OMZ1ST                          WLZ1ST
     I              OMZ3ST                          WLZ3ST
     I              OMZ4ST                          WLZ4ST
     I              OMDUPR                          WLDUPR
     I              OMB6VL                          WLB6VL
     I              OMA1AA                          WLA1AA
     I              OMFZSX                          WLFZSX
     I              OMF0SX                          WLF0SX
     I              OMF1SX                          WLF1SX
     I              OMF2SX                          WLF2SX
     I              OMF3SX                          WLF3SX
     I              OMF4SX                          WLF4SX
     I              OMF5SX                          WLF5SX
     I              OMF6SX                          WLF6SX
     I              OMF7SX                          WLF7SX
     I              OMNTDT                          WLNTDT
     I              OMNUDT                          WLNUDT
     I              OMNVDT                          WLNVDT
     I              OMNWDT                          WLNWDT
     I              OMNXDT                          WLNXDT
     I              OMBUTM                          WLBUTM
     I              OMBVTM                          WLBVTM
     I              OMBWTM                          WLBWTM
     I              OMBXTM                          WLBXTM
     I              OMBYTM                          WLBYTM
     I              OMH5NX                          WLH5NX
     I              OMH6NX                          WLH6NX
     I              OMH7NX                          WLH7NX
     I              OMH8NX                          WLH8NX
     I              OMH9NX                          WLH9NX
     I              OMDVPR                          WLDVPR
     I              OMDWPR                          WLDWPR
     I              OMDXPR                          WLDXPR
     I              OMDYPR                          WLDYPR
     I              OMDZPR                          WLDZPR
     I              OMGSPR                          WLGSPR
     I              OMGTPR                          WLGTPR
     I              OMGUPR                          WLGUPR
     I              OMHOST                          WLHOST
     I              OMHPST                          WLHPST
     I              OMIOST                          WLIOST
     I              OMPEWG                          WLPEWG
     I              OMRINY                          WLRINY
     I              OMTIDT                          WLTIDT
     I              OMTJDT                          WLTJDT
     I              OMH2ST                          WLH2ST
     I              OMH0ST                          WLH0ST
     I              OMH1ST                          WLH1ST
     I              OMTKDT                          WLTKDT
     I              OMTLDT                          WLTLDT
     I              OMTMDT                          WLTMDT
     I              OMUVST                          WLUVST
     I              OMUWST                          WLUWST
     I              OMUXST                          WLUXST
     I              OMAATM                          WLAATM
     I              OMAYNA                          WLAYNA
     I              OMA0NA                          WLA0NA
     I              OMAXDT                          WLAXDT
      *
     I@JKCPZ6
      * Order Dtl Formula Dtl     Upd Index for Work File
      * Renamed input format fields
     I              JKAIC3                          WMAIC3
     I              JKC4NB                          WMC4NB
     I              JKDPNB                          WMDPNB
     I              JKUENB                          WMUENB
     I              JKQ9CD                          WMQ9CD
     I              JKHGCD                          WMHGCD
     I              JKZXNB                          WMZXNB
     I              JKBOPR                          WMBOPR
     I              JKCDPR                          WMCDPR
     I              JKCEPR                          WMCEPR
     I              JKU6ST                          WMU6ST
     I              JKUVST                          WMUVST
     I              JKUWST                          WMUWST
     I              JKUXST                          WMUXST
     I              JKAATM                          WMAATM
     I              JKAYNA                          WMAYNA
     I              JKA0NA                          WMA0NA
     I              JKAXDT                          WMAXDT
      *
     I@IMCPZ4
      * Order Detail Pricing      Upd Index for Work File
      * Renamed input format fields
     I              IMAIC3                          WOAIC3
     I              IMC4NB                          WOC4NB
     I              IMDPNB                          WODPNB
     I              IMUENB                          WOUENB
     I              IMQ9CD                          WOQ9CD
     I              IMPDSQ                          WOPDSQ
     I              IMBNPR                          WOBNPR
     I              IMU6ST                          WOU6ST
     I              IMUVST                          WOUVST
     I              IMUWST                          WOUWST
     I              IMUXST                          WOUXST
     I              IMAATM                          WOAATM
     I              IMAYNA                          WOAYNA
     I              IMA0NA                          WOA0NA
     I              IMAXDT                          WOAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPARC        DS                             12
      * KEY : Order Detail              Ship To/Price Code/Item
      * I :  Ship To Customer
     I                                    P   1   40PABKC7
      * I :  Price Code
     I                                    P   5   80PABVTM
      * I :  Item Code
     I                                    P   9  120PAHGCD
      *
      * Outward parameters
     IPBRC        DS                             10
      * KEY : Order Detail              Retrieval index
      * I : RST Company Number
     I                                    P   1   20PBAIC3
      * I : RST Order Number
     I                                    P   3   60PBC4NB
      * I : RST Order Sequence Number
     I                                    P   7   80PBDPNB
      * I : RST Order Secondary Line Seq
     I                                    P   9  100PBUENB
      *
     IQPDIM1    E DSPDIMCPL0
      * UPD : Order Detail Pricing      Update index
      * Renamed input format fields
     I              IMAIC3                          WEAIC3
     I              IMC4NB                          WEC4NB
     I              IMDPNB                          WEDPNB
     I              IMUENB                          WEUENB
     I              IMQ9CD                          WEQ9CD
     I              IMPDSQ                          WEPDSQ
     I              IMBNPR                          WEBNPR
     I              IMU6ST                          WEU6ST
     I              IMUVST                          WEUVST
     I              IMUWST                          WEUWST
     I              IMUXST                          WEUXST
     I              IMAATM                          WEAATM
     I              IMAYNA                          WEAYNA
     I              IMA0NA                          WEA0NA
     I              IMAXDT                          WEAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDJK1    E DSPDJKCPL0
      * UPD : Order Dtl Formula Dtl     Update index
      * Renamed input format fields
     I              JKAIC3                          WGAIC3
     I              JKC4NB                          WGC4NB
     I              JKDPNB                          WGDPNB
     I              JKUENB                          WGUENB
     I              JKQ9CD                          WGQ9CD
     I              JKHGCD                          WGHGCD
     I              JKZXNB                          WGZXNB
     I              JKBOPR                          WGBOPR
     I              JKCDPR                          WGCDPR
     I              JKCEPR                          WGCEPR
     I              JKU6ST                          WGU6ST
     I              JKUVST                          WGUVST
     I              JKUWST                          WGUWST
     I              JKUXST                          WGUXST
     I              JKAATM                          WGAATM
     I              JKAYNA                          WGAYNA
     I              JKA0NA                          WGA0NA
     I              JKAXDT                          WGAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WIAIC3
     I              OMC4NB                          WIC4NB
     I              OMDPNB                          WIDPNB
     I              OMUENB                          WIUENB
     I              OMHGCD                          WIHGCD
     I              OMAJCD                          WIAJCD
     I              OMBKC7                          WIBKC7
     I              OMCFC7                          WICFC7
     I              OMGMST                          WIGMST
     I              OMGNST                          WIGNST
     I              OMMAVA                          WIMAVA
     I              OMKDVA                          WIKDVA
     I              OML8VA                          WIL8VA
     I              OML9VA                          WIL9VA
     I              OMGTST                          WIGTST
     I              OMGVST                          WIGVST
     I              OMGUST                          WIGUST
     I              OMQFST                          WIQFST
     I              OMAYVA                          WIAYVA
     I              OMEXDT                          WIEXDT
     I              OMLQCD                          WILQCD
     I              OMRDCD                          WIRDCD
     I              OMQ7CD                          WIQ7CD
     I              OMBZPR                          WIBZPR
     I              OML6NB                          WIL6NB
     I              OMU1ST                          WIU1ST
     I              OMGIDT                          WIGIDT
     I              OMCRCD                          WICRCD
     I              OMAGCD                          WIAGCD
     I              OMRZST                          WIRZST
     I              OMR0ST                          WIR0ST
     I              OMR1ST                          WIR1ST
     I              OMG7NA                          WIG7NA
     I              OMG8NA                          WIG8NA
     I              OMRPCD                          WIRPCD
     I              OMVEST                          WIVEST
     I              OMVGST                          WIVGST
     I              OMAVST                          WIAVST
     I              OMU0ST                          WIU0ST
     I              OMRFCD                          WIRFCD
     I              OMFZST                          WIFZST
     I              OMR1NB                          WIR1NB
     I              OMAVQT                          WIAVQT
     I              OMD0WG                          WID0WG
     I              OMCCQT                          WICCQT
     I              OMAUWG                          WIAUWG
     I              OMCBQT                          WICBQT
     I              OMATWG                          WIATWG
     I              OMAQCS                          WIAQCS
     I              OMAGCS                          WIAGCS
     I              OMAKPR                          WIAKPR
     I              OMALPR                          WIALPR
     I              OMAUPR                          WIAUPR
     I              OMAVWG                          WIAVWG
     I              OMA4WG                          WIA4WG
     I              OMA5DT                          WIA5DT
     I              OMAODT                          WIAODT
     I              OMGNDT                          WIGNDT
     I              OMAMST                          WIAMST
     I              OMANST                          WIANST
     I              OMVAST                          WIVAST
     I              OMRGNB                          WIRGNB
     I              OMRHNB                          WIRHNB
     I              OMRINB                          WIRINB
     I              OMRBCD                          WIRBCD
     I              OMHICD                          WIHICD
     I              OMRNCD                          WIRNCD
     I              OMROCD                          WIROCD
     I              OMCXDT                          WICXDT
     I              OMAJVN                          WIAJVN
     I              OMKXCD                          WIKXCD
     I              OMJPCD                          WIJPCD
     I              OMCQCD                          WICQCD
     I              OMR4CD                          WIR4CD
     I              OMZ1ST                          WIZ1ST
     I              OMZ3ST                          WIZ3ST
     I              OMZ4ST                          WIZ4ST
     I              OMDUPR                          WIDUPR
     I              OMB6VL                          WIB6VL
     I              OMA1AA                          WIA1AA
     I              OMFZSX                          WIFZSX
     I              OMF0SX                          WIF0SX
     I              OMF1SX                          WIF1SX
     I              OMF2SX                          WIF2SX
     I              OMF3SX                          WIF3SX
     I              OMF4SX                          WIF4SX
     I              OMF5SX                          WIF5SX
     I              OMF6SX                          WIF6SX
     I              OMF7SX                          WIF7SX
     I              OMNTDT                          WINTDT
     I              OMNUDT                          WINUDT
     I              OMNVDT                          WINVDT
     I              OMNWDT                          WINWDT
     I              OMNXDT                          WINXDT
     I              OMBUTM                          WIBUTM
     I              OMBVTM                          WIBVTM
     I              OMBWTM                          WIBWTM
     I              OMBXTM                          WIBXTM
     I              OMBYTM                          WIBYTM
     I              OMH5NX                          WIH5NX
     I              OMH6NX                          WIH6NX
     I              OMH7NX                          WIH7NX
     I              OMH8NX                          WIH8NX
     I              OMH9NX                          WIH9NX
     I              OMDVPR                          WIDVPR
     I              OMDWPR                          WIDWPR
     I              OMDXPR                          WIDXPR
     I              OMDYPR                          WIDYPR
     I              OMDZPR                          WIDZPR
     I              OMGSPR                          WIGSPR
     I              OMGTPR                          WIGTPR
     I              OMGUPR                          WIGUPR
     I              OMHOST                          WIHOST
     I              OMHPST                          WIHPST
     I              OMIOST                          WIIOST
     I              OMPEWG                          WIPEWG
     I              OMRINY                          WIRINY
     I              OMTIDT                          WITIDT
     I              OMTJDT                          WITJDT
     I              OMH2ST                          WIH2ST
     I              OMH0ST                          WIH0ST
     I              OMH1ST                          WIH1ST
     I              OMTKDT                          WITKDT
     I              OMTLDT                          WITLDT
     I              OMTMDT                          WITMDT
     I              OMUVST                          WIUVST
     I              OMUWST                          WIUWST
     I              OMUXST                          WIUXST
     I              OMAATM                          WIAATM
     I              OMAYNA                          WIAYNA
     I              OMA0NA                          WIA0NA
     I              OMAXDT                          WIAXDT
      *
     IYARDCS      DS                            525
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WJAIC3
     I              BEC4NB                          WJC4NB
     I              BEJNCD                          WJJNCD
     I              BEANC7                          WJANC7
     I              BEBKC7                          WJBKC7
     I              BEBRTX                          WJBRTX
     I              BEHMNA                          WJHMNA
     I              BEHONA                          WJHONA
     I              BEHPNA                          WJHPNA
     I              BEHNNA                          WJHNNA
     I              BEDBCD                          WJDBCD
     I              BECKTX                          WJCKTX
     I              BEB0C7                          WJB0C7
     I              BEAETX                          WJAETX
     I              BEB1NA                          WJB1NA
     I              BEB3NA                          WJB3NA
     I              BEB4NA                          WJB4NA
     I              BEB2NA                          WJB2NA
     I              BEBHCD                          WJBHCD
     I              BEC8TX                          WJC8TX
     I              BEBCNA                          WJBCNA
     I              BEA0DT                          WJA0DT
     I              BEA5DT                          WJA5DT
     I              BEGNDT                          WJGNDT
     I              BEACDT                          WJACDT
     I              BEAQCD                          WJAQCD
     I              BEB6NA                          WJB6NA
     I              BEBYNA                          WJBYNA
     I              BEBZNA                          WJBZNA
     I              BEGTST                          WJGTST
     I              BEGVST                          WJGVST
     I              BEGUST                          WJGUST
     I              BEQFST                          WJQFST
     I              BECQCD                          WJCQCD
     I              BEGJST                          WJGJST
     I              BEGWST                          WJGWST
     I              BEGXST                          WJGXST
     I              BEGYST                          WJGYST
     I              BEAODT                          WJAODT
     I              BEAIVN                          WJAIVN
     I              BECXDT                          WJCXDT
     I              BEJZVA                          WJJZVA
     I              BEA1WG                          WJA1WG
     I              BEXIST                          WJXIST
     I              BEXJST                          WJXJST
     I              BEXKST                          WJXKST
     I              BEEIDT                          WJEIDT
     I              BEAFTM                          WJAFTM
     I              BEE8CD                          WJE8CD
     I              BEE9CD                          WJE9CD
     I              BERMNB                          WJRMNB
     I              BETBNB                          WJTBNB
     I              BER1NB                          WJR1NB
     I              BEPJST                          WJPJST
     I              BEU0ST                          WJU0ST
     I              BEU1ST                          WJU1ST
     I              BEQ2CD                          WJQ2CD
     I              BEU2ST                          WJU2ST
     I              BEVEST                          WJVEST
     I              BEVFST                          WJVFST
     I              BEVGST                          WJVGST
     I              BERPCD                          WJRPCD
     I              BERNNB                          WJRNNB
     I              BEVDST                          WJVDST
     I              BEATIN                          WJATIN
     I              BEU4ST                          WJU4ST
     I              BEU5ST                          WJU5ST
     I              BERSRN                          WJRSRN
     I              BEMHNA                          WJMHNA
     I              BEMINA                          WJMINA
     I              BEWBST                          WJWBST
     I              BER4CD                          WJR4CD
     I              BEBFCD                          WJBFCD
     I              BEQ4CD                          WJQ4CD
     I              BET3NB                          WJT3NB
     I              BESICD                          WJSICD
     I              BECONB                          WJCONB
     I              BECEST                          WJCEST
     I              BEAWDT                          WJAWDT
     I              BEJPCD                          WJJPCD
     I              BEXUST                          WJXUST
     I              BEZ1ST                          WJZ1ST
     I              BEVRVA                          WJVRVA
     I              BEOBST                          WJOBST
     I              BEBCST                          WJBCST
     I              BEBDST                          WJBDST
     I              BEB7VL                          WJB7VL
     I              BEGASX                          WJGASX
     I              BEGBSX                          WJGBSX
     I              BEGCSX                          WJGCSX
     I              BEGDSX                          WJGDSX
     I              BEFNSX                          WJFNSX
     I              BEFOSX                          WJFOSX
     I              BEFPSX                          WJFPSX
     I              BEFQSX                          WJFQSX
     I              BEFRSX                          WJFRSX
     I              BEFSSX                          WJFSSX
     I              BEFTSX                          WJFTSX
     I              BEFUSX                          WJFUSX
     I              BEFVSX                          WJFVSX
     I              BEFWSX                          WJFWSX
     I              BEFXSX                          WJFXSX
     I              BEFYSX                          WJFYSX
     I              BENODT                          WJNODT
     I              BENPDT                          WJNPDT
     I              BENQDT                          WJNQDT
     I              BENRDT                          WJNRDT
     I              BENSDT                          WJNSDT
     I              BEBPTM                          WJBPTM
     I              BEBQTM                          WJBQTM
     I              BEBRTM                          WJBRTM
     I              BEBSTM                          WJBSTM
     I              BEBTTM                          WJBTTM
     I              BEH0NX                          WJH0NX
     I              BEH1NX                          WJH1NX
     I              BEH2NX                          WJH2NX
     I              BEH3NX                          WJH3NX
     I              BEH4NX                          WJH4NX
     I              BEC0C7                          WJC0C7
     I              BEUVST                          WJUVST
     I              BEUWST                          WJUWST
     I              BEUXST                          WJUXST
     I              BEAATM                          WJAATM
     I              BEAYNA                          WJAYNA
     I              BEA0NA                          WJA0NA
     I              BEAXDT                          WJAXDT
      *
     IYBRDCS      DS                            779
      * Outward parameters
     IPCRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PCAIC3
      * I :  Order Number
     I                                    P   3   60PCC4NB
      * I :  Order Type - Sales
     I                                        7   8 PCJNCD
      * I :  AR Customer Number
     I                                    P   9  120PCANC7
      * I :  Ship To Customer
     I                                    P  13  160PCBKC7
      * I :  Ship To Name
     I                                       17  46 PCBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PCHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PCHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PCHPNA
      * I :  Ship To City
     I                                      137 156 PCHNNA
      * I :  Ship To State Code
     I                                      157 158 PCDBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PCCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PCB0C7
      * I :  Bill to Name
     I                                      174 203 PCAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PCB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PCB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PCB4NA
      * I :  Bill to City
     I                                      294 313 PCB2NA
      * I :  Bill to State Code
     I                                      314 315 PCBHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PCC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PCBCNA
      * I :  Order Date
     I                                    P 342 3450PCA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PCA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PCGNDT
      * I :  Cancel Date
     I                                    P 354 3570PCACDT
      * I :  Terms Code
     I                                      358 359 PCAQCD
      * I :  Special Instructions
     I                                      360 399 PCB6NA
      * I :  Special Instructions 2
     I                                      400 439 PCBYNA
      * I :  Carrier Code
     I                                      440 442 PCBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PCGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PCGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PCGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PCQFST
      * I :  Reason Code
     I                                      447 449 PCCQCD
      * I :  Order in Use
     I                                      450 450 PCGJST
      * I :  Header Status
     I                                      451 451 PCGWST
      * I :  Header Status Last
     I                                      452 452 PCGXST
      * I :  Order Type Print Status
     I                                      453 453 PCGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PCAODT
      * I :  User Original Entry
     I                                      458 467 PCAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PCCXDT
      * I :  Order Value Total
     I                                    P 472 4772PCJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PCA1WG
      * I :  Credit Hold
     I                                      484 484 PCXIST
      * I :  Production Hold
     I                                      485 485 PCXJST
      * I :  New Customer Hold
     I                                      486 486 PCXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PCEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PCAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PCE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PCE9CD
      * I :  Load ID
     I                                    P 510 5130PCRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PCTBNB
      * I :  Rated Freight
     I                                    P 517 5222PCR1NB
      * I :  LTL Flag
     I                                      523 523 PCPJST
      * I :  Price Audit
     I                                      524 524 PCU0ST
      * I :  Price Status
     I                                      525 525 PCU1ST
      * I :  Shipping Method
     I                                      526 527 PCQ2CD
      * I :  Export Status
     I                                      528 528 PCU2ST
      * I :  Palletize
     I                                      529 529 PCVEST
      * I :  Shrink Wrap
     I                                      530 530 PCVFST
      * I :  Slip Sheet
     I                                      531 531 PCVGST
      * I :  Age Code
     I                                      532 532 PCRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PCRNNB
      * I :  Load Type
     I                                      536 536 PCVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PCATIN
      * I :  Load Plan Order
     I                                      541 541 PCU4ST
      * I :  Print Pick Slip
     I                                      542 542 PCU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PCRSRN
      * I :  Special Comment 1
     I                                      547 576 PCMHNA
      * I :  Special Comment 2
     I                                      577 606 PCMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PCWBST
      * I :  Sales Route Code
     I                                      608 610 PCR4CD
      * I :  Manager Level Code
     I                                      611 612 PCBFCD
      * I :  VP Level Code
     I                                      613 615 PCQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PCT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PCSICD
      * I :  Invoice Number
     I                                    P 623 6260PCCONB
      * I :  Invoice Suffix
     I                                      627 628 PCCEST
      * I :  Invoice Date
     I                                    P 629 6320PCAWDT
      * I :  Event Code
     I                                      633 634 PCJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PCXUST
      * I :  Modified Flag
     I                                      636 636 PCZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PCVRVA
      * I :  Billing Activity Type
     I                                      643 643 PCOBST
      * I :  Block Order Flag
     I                                      644 644 PCBCST
      * I :  Order Certification Flag
     I                                      645 645 PCBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PCB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PCGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PCGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PCGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PCGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PCFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PCFOSX
      * I :  Order Emailed
     I                                      658 658 PCFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PCFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PCFRSX
      * I :  Broker Order Status
     I                                      661 661 PCFSSX
      * I :  Air Freight Order
     I                                      662 662 PCFTSX
      * I :  Order Requires Review
     I                                      663 664 PCFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PCFVSX
      * I :  Export USDA Approved
     I                                      667 668 PCFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PCFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PCFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PCNODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PCNPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PCNQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PCNRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PCNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PCBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PCBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PCBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PCBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PCBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PCH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PCH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PCH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PCH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PCH4NX
      * I :  Claim Number
     I                                    P 745 7480PCC0C7
      * I :  EDI Status 1
     I                                      749 749 PCUVST
      * I :  EDI Status 2
     I                                      750 750 PCUWST
      * I :  EDI Status 3
     I                                      751 751 PCUXST
      * I :  Job Time
     I                                    P 752 7550PCAATM
      * I :  User Id
     I                                      756 765 PCAYNA
      * I :  Job Name
     I                                      766 775 PCA0NA
      * I :  Job Date
     I                                    P 776 7790PCAXDT
      *
     IQPDK31    E DSPDK3CPL0
      * UPD : Price Change Audit Log    Update index
      * Renamed input format fields
     I              K3AIC3                          WKAIC3
     I              K3C4NB                          WKC4NB
     I              K3DPNB                          WKDPNB
     I              K3UENB                          WKUENB
     I              K3ASNO                          WKASNO
     I              K3HGCD                          WKHGCD
     I              K3GMST                          WKGMST
     I              K3GNST                          WKGNST
     I              K3AYVA                          WKAYVA
     I              K3YJVA                          WKYJVA
     I              K3U1ST                          WKU1ST
     I              K3PSTL                          WKPSTL
     I              K3U0ST                          WKU0ST
     I              K3RFCD                          WKRFCD
     I              K3PALS                          WKPALS
     I              K3WWCD                          WKWWCD
     I              K3AKPR                          WKAKPR
     I              K3DBPR                          WKDBPR
     I              K3ALPR                          WKALPR
     I              K3DCPR                          WKDCPR
     I              K3JPCD                          WKJPCD
     I              K3WXCD                          WKWXCD
     I              K3PREC                          WKPREC
     I              K3PIDX                          WKPIDX
     I              K3UVST                          WKUVST
     I              K3UWST                          WKUWST
     I              K3UXST                          WKUXST
     I              K3AATM                          WKAATM
     I              K3AYNA                          WKAYNA
     I              K3A0NA                          WKA0NA
     I              K3AXDT                          WKAXDT
      *
     IQPDJK2    E DSPDJKCPW0
      * UPD : Order Dtl Formula Dtl     Upd Index for Work File
      * Renamed input format fields
     I              JKAIC3                          WMAIC3
     I              JKC4NB                          WMC4NB
     I              JKDPNB                          WMDPNB
     I              JKUENB                          WMUENB
     I              JKQ9CD                          WMQ9CD
     I              JKHGCD                          WMHGCD
     I              JKZXNB                          WMZXNB
     I              JKBOPR                          WMBOPR
     I              JKCDPR                          WMCDPR
     I              JKCEPR                          WMCEPR
     I              JKU6ST                          WMU6ST
     I              JKUVST                          WMUVST
     I              JKUWST                          WMUWST
     I              JKUXST                          WMUXST
     I              JKAATM                          WMAATM
     I              JKAYNA                          WMAYNA
     I              JKA0NA                          WMA0NA
     I              JKAXDT                          WMAXDT
      *
     IQPDIM2    E DSPDIMCPW0
      * UPD : Order Detail Pricing      Upd Index for Work File
      * Renamed input format fields
     I              IMAIC3                          WOAIC3
     I              IMC4NB                          WOC4NB
     I              IMDPNB                          WODPNB
     I              IMUENB                          WOUENB
     I              IMQ9CD                          WOQ9CD
     I              IMPDSQ                          WOPDSQ
     I              IMBNPR                          WOBNPR
     I              IMU6ST                          WOU6ST
     I              IMUVST                          WOUVST
     I              IMUWST                          WOUWST
     I              IMUXST                          WOUXST
     I              IMAATM                          WOAATM
     I              IMAYNA                          WOAYNA
     I              IMA0NA                          WOA0NA
     I              IMAXDT                          WOAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail Pricing
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * I : RST Order Sequence Number
     I                                    P   7   80P1DPNB
      * I : RST Order Secondary Line Seq
     I                                    P   9  100P1UENB
     IP2PARM      DS
      * FLD: Order Header TRG
      * I : MAP Order Type - Sales
     I                                        1   2 P2JNCD
      * I : MAP Ship To Customer
     I                                    P   3   60P2BKC7
      * I : MAP Ship To Name
     I                                        7  36 P2BRTX
      * I :  Ship To City
     I                                       37  56 P2HNNA
      * I :  Ship To State Code
     I                                       57  58 P2DBCD
      * I :  Customer Purchase Order #
     I                                       59  73 P2BCNA
      * I : MAP Order Date
     I                                    P  74  770P2A0DT
      * I : MAP Requested Ship Date
     I                                    P  78  810P2A5DT
      * I : MAP Actual Shipped Date
     I                                    P  82  850P2GNDT
      * I :  Scheduled Ship Date
     I                                    P  86  890P2AODT
      * I :  Date of Original Entry
     I                                    P  90  930P2CXDT
      * I :  Billing Activity Type
     I                                       94  94 P2OBST
     IP3PARM      DS
      * FLD: Order Detail
      * I : MAP Item Code
     I                                    P   1   40P3HGCD
      * I : MAP Warehouse Code
     I                                        5   7 P3AJCD
      * I : MAP Detail Line Status
     I                                        8   8 P3GMST
      * I : MAP Extended Amount
     I                                    P   9  142P3AYVA
      * B : MAP Market Pricing Date
     I                                    P  15  180P3EXDT
      * B : MAP Commodity Market Code
     I                                       19  21 P3LQCD
      * B : MAP Date Method Code
     I                                       22  24 P3RDCD
      * B : MAP Price Method Code
     I                                       25  27 P3Q7CD
      * B : MAP Price Overage Override
     I                                    P  28  334P3BZPR
      * B : MAP Contract Number
     I                                    P  34  370P3L6NB
      * B : MAP Price Status
     I                                       38  38 P3U1ST
      * I :  Pricing Date Used
     I                                    P  39  420P3GIDT
      * I : MAP U/M - Base Price
     I                                       43  44 P3CRCD
      * I : MAP U/M - Ordered
     I                                       45  46 P3AGCD
      * I : MAP Order Desc. Line One
     I                                       47  76 P3G7NA
      * I : MAP Price Audit
     I                                       77  77 P3U0ST
      * N : MAP Price Audit Reason Code
     I                                       78  80 P3RFCD
      * I : MAP Quantity Ordered
     I                                    P  81  862P3AVQT
      * I : MAP Weight Ordered
     I                                    P  87  922P3D0WG
      * I : MAP Quantity Scheduled
     I                                    P  93  982P3CCQT
      * I : MAP Weight Scheduled
     I                                    P  99 1042P3AUWG
      * I : MAP Quantity Shipped Total
     I                                    P 105 1102P3CBQT
      * I : MAP Weight Shipped Total
     I                                    P 111 1162P3ATWG
      * B : MAP Unit Price
     I                                    P 117 1224P3AKPR
      * B : MAP Unit Price - Credit
     I                                    P 123 1284P3ALPR
      * B : MAP Unit Price Ordered U/M
     I                                    P 129 1344P3AUPR
      * I : MAP Unit Weight Ordered U/M
     I                                    P 135 1402P3AVWG
      * I : MAP Event Code
     I                                      141 142 P3JPCD
      * I : MAP Released by User Sts Y/N
     I                                      143 143 P3F3SX
      * I : MAP OD Price Type
     I                                      144 146 P3F7SX
      * B : MAP Price Code
     I                                    P 147 1500P3BVTM
      * B : MAP OD Market Begin Date
     I                                    P 151 1540P3TKDT
      * B : MAP OD Market Ending Date
     I                                    P 155 1580P3TLDT
     IP4PARM      DS
      * FLD: *Arrays
      * N :  USR Total Consumed Items
     I                                    P   1   62P4TSVA
      * N :  USR Muscle Yield Amt
     I                                    P   7  122P4TZVA
      * N :  Total Credit Dollars
     I                                    P  13  182P4Y0NB
      * N :  USR Formula Overages
     I                                    P  19  242P4T1VA
      * N :  USR Differential
     I                                    P  25  302P4TYVA
     IP5PARM      DS
      * FLD: *Arrays
      * N :  Cntrt Enter no QT Price
     I                                        1   1 P5WDST
      * N :  Cntrt.# does not Exit
     I                                        2   2 P5WEST
      * N :  Qty ordered > Contract
     I                                        3   3 P5WFST
      * N :  Contract Expired
     I                                        4   4 P5WGST
      * N :  Price Override Required
     I                                        5   5 P5WHST
      * N :  Price Method QT & Cntrt 0
     I                                        6   6 P5WIST
      * N :  Prc Code FRM or MKT
     I                                        7   7 P5WJST
      * N :  Mkt Pricing Date not 0
     I                                        8   8 P5WKST
      * N :  Mkt Meth. and Date both
     I                                        9   9 P5WLST
      * N :  Price Override Req. EXT
     I                                       10  10 P5WMST
      * N :  Contract Exists for Item
     I                                       11  11 P5XSST
      * N :  Price Override not Allowd
     I                                       12  12 P5YXST
     IP6PARM      DS
      * N :  USR Update Flag
     I                                        1   1 P6R4ST
     IP7PARM      DS
      * N :  USR Record Updated
     I                                        1   1 P7YZST
     IP8PARM      DS
      * N :  USR Display field
     I                                        1   1 P8GGST
     IP9PARM      DS
      * FLD: Company Item
      * N :  Default Commod Mark basis
     I                                        1   3 P9LNCD
      * N :  Maximum Audit Value
     I                                    P   4   92P9TMVA
      * N :  Minimum Audit Value
     I                                    P  10  152P9TNVA
      * N :  Commodity Price Group
     I                                       16  22 P9LRCD
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Send Price MSG to Seaboar'
      * Order Number
     I                                        1   7 ZA0001
      * Order Sequence Number
     I                                    P   8   90ZA0002
      * Item Code
     I                                       10  16 ZA0003
      * Catch Weight Status
     I                                       17  17 ZA0004
      * Unit Price
     I                                    P  18  234ZA0005
      * Message data for 'WARNING: Price out of rng'
      * Unit Price
     I                                    P   1   64ZA0006
      * Minimum Price   USR
     I                                    P   7  124ZA0007
      * Maximum Price  USR
     I                                    P  13  184ZA0008
      * Message data for 'Price Method invalid'
      * Price Method Code
     I                                        1   3 ZA0009
      * Message data for 'Market Date Method Inval.'
      * Date Method Code
     I                                        1   3 ZA0010
      * Message data for 'Commodity Market not fnd'
      * Commodity Market Code
     I                                        1   3 ZA0011
      * Message data for 'This item has a Contract'
      * Item Code
     I                                        1   7 ZA0012
      * Contract Number
     I                                    P   8  110ZA0013
      * Message data for 'OPP Contract Error'
      * Contract Number
     I                                    P   1   40ZA0014
      * Message data for 'Quantity Ordered > Contra'
      * Quantity Ordered
     I                                    P   1   62ZA0015
      * Contract Number
     I                                    P   7  100ZA0016
      * Message data for 'Contract Effective date'
      * Contract Number
     I                                    P   1   40ZA0017
      * Message data for 'Price Override Req. W/Man'
      * Price Method Code
     I                                        1   3 ZA0018
      * Price Overage Override
     I                                    P   4   94ZA0019
      * Message data for 'Price Override Req. w/EXT'
      * Price Method Code
     I                                        1   3 ZA0020
      * Price Overage Override
     I                                    P   4   94ZA0021
      * Message data for 'Price Override not allow'
      * Contract Price Override
     I                                    P   1   64ZA0022
      * Message data for 'Market Code must be enter'
      * Commodity Market Code
     I                                        1   3 ZA0023
      * Message data for 'Price Override not allow'
      * Contract Price Override
     I                                    P   1   64ZA0024
      * Message data for 'Date Meth & Prc Dat N/A'
      * Market Pricing Date
     I                                    P   1   40ZA0025
      * Date Method Code
     I                                        5   7 ZA0026
      * Message data for 'No Price for Mkt/Group'
      * Commodity Market Code
     I                                        1   3 ZA0027
      * Commodity Price Group
     I                                        4  10 ZA0028
      * Message data for 'No Price Mkt/Group Deflt'
      * Commodity Market Code
     I                                        1   3 ZA0029
      * Commodity Price Group
     I                                        4  10 ZA0030
      * Default Commod Mark basis
     I                                       11  13 ZA0031
      * Message data for 'No Price for Mkt/Group'
      * Commodity Market Code
     I                                        1   3 ZA0032
      * Commodity Price Group
     I                                        4  10 ZA0033
      * Message data for 'Price Invalid, Reenter'
      * Price
     I                                    P   1   64ZA0034
      * Message data for 'Price mthd/price code inv'
      * Price Method Code
     I                                        1   3 ZA0035
      * Message data for 'Price Code not val f/cust'
      * Price Code
     I                                    P   1   40ZA0036
      * Message data for 'Price Code not val dt rng'
      * Price Code
     I                                    P   1   40ZA0037
      * Message data for 'Price Code not val f/item'
      * Price Code
     I                                    P   1   40ZA0038
      * Item Code
     I                                        5  11 ZA0039
      * Message data for 'Price Code max wgt exceed'
      * Price Code
     I                                    P   1   40ZA0040
      * Weight Allocated USR
     I                                    P   5   92ZA0041
      * Maximum Contract Units
     I                                    P  10  152ZA0042
      * Item Code
     I                                       16  22 ZA0043
      * Message data for 'Price Code max wgt exceed'
      * Price Code
     I                                    P   1   40ZA0044
      * Weight Allocated USR
     I                                    P   5   92ZA0045
      * Maximum Contract Units
     I                                    P  10  152ZA0046
      * Item Code
     I                                       16  22 ZA0047
      * Message data for 'Send Price MSG to Seaboar'
      * Order Number
     I                                        1   7 ZA0048
      * Order Sequence Number
     I                                    P   8   90ZA0049
      * Item Code
     I                                       10  16 ZA0050
      * Catch Weight Status
     I                                       17  17 ZA0051
      * Unit Price
     I                                    P  18  234ZA0052
      * Message data for 'Pricing Error was found'
      * Error Return
     I                                        1   5 ZA0053
      * Message data for 'WARNING: Price out of rng'
      * Unit Price
     I                                    P   1   64ZA0054
      * Minimum Price   USR
     I                                    P   7  124ZA0055
      * Maximum Price  USR
     I                                    P  13  184ZA0056
      * Message data for 'Send Price MSG to Seaboar'
      * Order Number
     I                                        1   7 ZA0057
      * Order Sequence Number
     I                                    P   8   90ZA0058
      * Item Code
     I                                       10  16 ZA0059
      * Catch Weight Status
     I                                       17  17 ZA0060
      * Unit Price
     I                                    P  18  234ZA0061
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1DPNB    PARM           WP0003  30       Order Sequence
     C           P1UENB    PARM           WP0004  30       Order Secondary
     C           P2JNCD    PARM           WP0005  2        Order Type - Sa
     C           P2BKC7    PARM           WP0006  70       Ship To Custome
     C           P2BRTX    PARM           WP0007 30        Ship To Name
     C           P2HNNA    PARM           WP0008 20        Ship To City
     C           P2DBCD    PARM           WP0009  2        Ship To State C
     C           P2BCNA    PARM           WP0010 15        Customer Purcha
     C           P2A0DT    PARM           WP0011  70       Order Date
     C           P2A5DT    PARM           WP0012  70       Requested Ship
     C           P2GNDT    PARM           WP0013  70       Actual Shipped
     C           P2AODT    PARM           WP0014  70       Scheduled Ship
     C           P2CXDT    PARM           WP0015  70       Date of Origina
     C           P2OBST    PARM           WP0016  1        Billing Activit
     C           P3HGCD    PARM           WP0017  70       Item Code
     C           P3AJCD    PARM           WP0018  3        Warehouse Code
     C           P3GMST    PARM           WP0019  1        Detail Line Sta
     C           P3AYVA    PARM           WP0020 112       Extended Amount
     C           P3EXDT    PARM P3EXDT    WP0021  70       Market Pricing
     C           P3LQCD    PARM P3LQCD    WP0022  3        Commodity Marke
     C           P3RDCD    PARM P3RDCD    WP0023  3        Date Method Cod
     C           P3Q7CD    PARM P3Q7CD    WP0024  3        Price Method Co
     C           P3BZPR    PARM P3BZPR    WP0025 114       Price Overage O
     C           P3L6NB    PARM P3L6NB    WP0026  70       Contract Number
     C           P3U1ST    PARM P3U1ST    WP0027  1        Price Status
     C           P3GIDT    PARM           WP0028  70       Pricing Date Us
     C           P3CRCD    PARM           WP0029  2        U/M - Base Pric
     C           P3AGCD    PARM           WP0030  2        U/M - Ordered
     C           P3G7NA    PARM           WP0031 30        Order Desc. Lin
     C           P3U0ST    PARM           WP0032  1        Price Audit
     C           P3AVQT    PARM           WP0033 112       Quantity Ordere
     C           P3D0WG    PARM           WP0034 112       Weight Ordered
     C           P3CCQT    PARM           WP0035 112       Quantity Schedu
     C           P3AUWG    PARM           WP0036 112       Weight Schedule
     C           P3CBQT    PARM           WP0037 112       Quantity Shippe
     C           P3ATWG    PARM           WP0038 112       Weight Shipped
     C           P3AKPR    PARM P3AKPR    WP0039 114       Unit Price
     C           P3ALPR    PARM P3ALPR    WP0040 114       Unit Price - Cr
     C           P3AUPR    PARM P3AUPR    WP0041 114       Unit Price Orde
     C           P3AVWG    PARM           WP0042 112       Unit Weight Ord
     C           P3JPCD    PARM           WP0043  2        Event Code
     C           P3F3SX    PARM           WP0044  1        Released by Use
     C           P3F7SX    PARM           WP0045  3        OD Price Type
     C           P3BVTM    PARM P3BVTM    WP0046  60       Price Code
     C           P3TKDT    PARM P3TKDT    WP0047  70       OD Market Begin
     C           P3TLDT    PARM P3TLDT    WP0048  70       OD Market Endin
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
     C                     Z-ADDP3GIDT    #CGIDT           Pricing Date Us
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SARVGN
      * CTL.USR Desc. 10 = Condition name of CTL.Price Audit
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250401   Y2LSNO  70       List number
     C                     PARM #PU0ST    W0INVL 25        Price Audit
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CNCNA    PARM           W0CNNM 25        USR Desc. 10
      *
      * CTL.USR Description - 15 = Condition name of CTL.Price Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250404   Y2LSNO  70       List number
     C                     PARM #PU1ST    W0INVL 25        Price Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CJUNA    PARM           W0CNNM 25        USR Description
      *
      * RTV Commod. Mkts Desc  RT - Commodity Markets  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CTMCD    WL0001    P      Commodity Marke
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #CJ3NA    P      Commodity Marke
     C                     MOVELP2BRTX    #PBRTX           Ship To Name
     C                     Z-ADDP2AODT    #CHODT           Scheduled Ship
     C                     MOVELP2HNNA    #CHNNA           Ship To City
     C                     MOVELP2DBCD    #CDBCD           Ship To State C
     C                     MOVELP2BCNA    #CBCNA           Customer Purcha
     C                     Z-ADDP3TKDT    #PTKDT           OD Market Begin
     C                     Z-ADDP3TLDT    #PTLDT           OD Market Endin
      * Load User Function Screen fields
     C                     Z-ADD#PBZPR    #CCLPR           Price Overage O
     C                     MOVEL#PQ7CD    #CTKCD           Price Method Co
     C                     MOVEL#PRDCD    #CTLCD           Date Method Cod
     C                     Z-ADD#PL6NB    #CCNBR           Contract Number
     C                     Z-ADD#PEXDT    #CG2DT           Market Pricing
     C                     MOVEL#PLQCD    #CTMCD           Commodity Marke
     C                     MOVELP3U0ST    #PU0ST           Price Audit
     C                     Z-ADD#PBVTM    #CUYNX           Price Code USR
      * VAL Ship Detail Seq    RT - Order Detail Pricing  * 
     C                     EXSR SCRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Recalculate Control Prices using files
      * CLC Pricing using File XF - Order Detail Pricing  * 
     C                     CALL 'PDOJXFR'              90  CLC Pricing usi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0001  30       Company Number
     C                     PARM #2C4NB    WQ0002  70       Order Number
     C                     PARM #2DPNB    WQ0003  30       Order Sequence
     C                     PARM #2UENB    WQ0004  30       Order Secondary
     C                     PARM #2PDSQ    WQ0005  30       Price Detail Se
     C                     PARM #PHGCD    WQ0006  70       Item Code
     C                     PARM #PQ7CD    WQ0007  3        Price Method Co
     C                     PARM #PAGCD    WQ0008  2        U/M - Ordered
     C           #PAKPR    PARM #PAKPR    WQ0009 114       Unit Price
     C           #PALPR    PARM #PALPR    WQ0010 114       Unit Price - Cr
     C           #PAUPR    PARM #PAUPR    WQ0011 114       Unit Price Orde
     C                     PARM '**'      WQ0012  2        Event Called Fr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Price Item         XF - Price Method Header  * 
     C                     CALL 'PDG9XFR'              90  CLC Price Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0013  30       Company Number
     C                     PARM #PQ7CD    WQ0014  3        Price Method Co
     C                     PARM #PBKC7    WQ0015  70       Ship To Custome
     C                     PARM #PGNDT    WQ0016  70       Actual Shipped
     C                     PARM #PAGCD    WQ0017  2        U/M - Ordered
     C                     PARM #PAVQT    WQ0018 112       Quantity Ordere
     C                     PARM #PA5DT    WQ0019  70       Requested Ship
     C           #PAKPR    PARM #PAKPR    WQ0020 114       Unit Price
     C           #PAUPR    PARM #PAUPR    WQ0021 114       Unit Price Orde
     C                     PARM #PHGCD    WQ0022  70       Item Code
     C                     PARM *ZERO     WQ0023  70       Date of Orig. E
     C                     PARM #PLQCD    WQ0024  3        Commodity Marke
     C                     PARM #PEXDT    WQ0025  70       Market Pricing
     C           WUU1ST    PARM WUU1ST    WQ0026  1        Price Status
     C                     PARM #PRDCD    WQ0027  3        Date Method Cod
     C                     PARM #PBZPR    WQ0028 114       Price Overage O
     C           WUGIDT    PARM WUGIDT    WQ0029  70       Pricing Date Us
     C                     PARM '**'      WQ0030  2        Event Called Fr
     C                     PARM #CDWPR    WQ0031 114       OD Ceiling Pric
     C                     PARM #PTKDT    WQ0032  70       OD Market Begin
     C                     PARM #PTLDT    WQ0033  70       OD Market Endin
     C                     PARM #2C4NB    WQ0034  70       Order Number
     C                     PARM #CEIDT    WQ0035  70       Requested Deliv
     C                     PARM #2DPNB    WQ0036  30       Order Sequence
     C                     PARM #2UENB    WQ0037  30       Order Secondary
     C           WUWZST    PARM WUWZST    WQ0038  5        Error Return
     C                     PARM 'S'       WQ0039  1        Price Type Stat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       P6R4ST           USR Update Flag
     C                     END                             *FI
      * Added -Purva 4/30/99
      * R12926 DN 04/30/18-At Order level, get Absorbed Freight Rate from
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0003           Company Number
     C                     Z-ADD#PBKC7    WL0004           Ship To Custome
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0001    P      Type Code
     C                     Z-ADDWL0006    YN0001           Absorbed Freigh
      * Rtv Absorbed Frt Rate RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0007           Company Number
     C                     Z-ADD#2C4NB    WL0008           Order Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YL0002           Absorbed Freigh
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
     C                     EXSR SFRVGN
      * Rtv Gate Price        RT - Order Detail  * 
     C                     EXSR SGRVGN
      * Recalculate Price Order U/M & Extended
      *
     C                     MOVEL*BLANK    WN0001  2        UOM Pricing
     C                     Z-ADD*ZERO     WN0002 112       Unit Weight
     C                     MOVEL*BLANK    WN0003  1        Catch Weight St
     C                     MOVEL*BLANK    WN0004  6        Primal Group Co
     C                     Z-ADD*ZERO     WN0005 114       Price per Pound
     C                     Z-ADD*ZERO     WN0006 112       USR Quantity
     C                     Z-ADD*ZERO     WN0007 112       USR Weight
      *
      * CLC Price,Ext,U/M1Prc  IF
      * *****************************************************************
      * Calculate "Price Per Pound", "Extended Amount", "Primary U/M Pric
      * *****************************************************************
     C                     Z-ADD*ZERO     WN0002           Unit Weight
     C                     MOVEL*BLANK    WN0001           UOM Pricing
     C                     MOVEL*BLANK    WN0003           Catch Weight St
      * Load Quantity Shipped Total field. c2742- do -0- shipped from ord
      * CASE: PAR.Quantity Shipped Total is Equal to zero
     C           #PCBQT    IFEQ 0                          *IF
     C                     Z-ADD1         WUCBQT           Quantity Shippe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#PCBQT    WUCBQT           Quantity Shippe
     C                     END                             *FI
      * Set quantity and weight according to order status  c2742 -0- shpe
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : PAR.Event Code is Entered Thru 03 Picked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PGMST    IFEQ 'L'                        *IF
     C           #PGMST    OREQ 'A'
     C           #PGMST    OREQ 'E'
     C           #PGMST    OREQ 'H'
     C           #PJPCD    IFGE '01'                       *IF
     C           #PJPCD    ANDLE'03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 6/17/09 FP1054 use qty/wgt ordered instead of sched
     C                     Z-ADD#PAVQT    WN0006           USR Quantity
     C                     Z-ADD#PD0WG    WN0007           USR Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUCBQT    WN0006           USR Quantity
     C                     Z-ADD#PATWG    WN0007           USR Weight
     C                     END                             *FI
      * RTV For Price Extent   XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDXRXFR'              90  RTV For Price E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0040  30       Company Number
     C                     PARM #PHGCD    WQ0041  70       Item Code
     C           WN0001    PARM *BLANK    WQ0042  2        UOM Pricing
     C           WN0002    PARM *ZERO     WQ0043 112       Unit Weight
     C           WN0003    PARM *BLANK    WQ0044  1        Catch Weight St
     C           WN0004    PARM *BLANK    WQ0045  6        Primal Group Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check retrieve Unit Weight & C/W error
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : PAR.Catch Weight Status is Y/N Values
      *   |- c3    : PAR.Unit Weight is Not equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           WN0003    IFEQ 'N'                        *IF
     C           WN0003    OREQ 'Y'
     C           WN0002    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           *ZERO     IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL*ZERO     WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZA0002           Order Sequence
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0003           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVELWN0003    ZA0004           Catch Weight St
     C                     Z-ADD*ZERO     ZA0005           Unit Price
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2306' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
      * CASE: PAR.Price Method Code is Extended
     C           #PQ7CD    IFEQ 'EXT'                      *IF
     C                     Z-ADD#PBZPR    #PAYVA           Extended Amount
      * Calculate Unit Price for Extended
      * CASE: PAR.USR Weight is Not equal zero
     C           WN0007    IFNE 0                          *IF
     C           #PAYVA    DIV  WN0007    #PAKPR    H      Unit Price
     C                     END                             *FI
      * Calculate Pricing U/M Price for Extended
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0006    IFNE 0                          *IF
     C           #PAYVA    DIV  WN0006    #PAUPR    H      Unit Price Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Extend price with unit price credit if not zeros
      * CASE:
      *  - (c1 AND c2 AND c3 AND c5 AND c7)
      *   |- c1    : PAR.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : PAR.Event Code is Entered Thru 03 Picked
      *   |- c3    : PAR.Unit Price - Credit is Not Zeros
      *   |- c5    : PAR.Price Audit is Not Manually Price Audit
      *   |- c7    : PAR.Pricing Event Called From is No Price With Credi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PGMST    IFEQ 'L'                        *IF
     C           #PGMST    OREQ 'A'
     C           #PGMST    OREQ 'E'
     C           #PGMST    OREQ 'H'
     C           #PJPCD    IFGE '01'                       *IF
     C           #PJPCD    ANDLE'03'
     C           #PALPR    IFNE 0                          *IF
     C           #PU0ST    IFEQ 'A'                        *IF
     C           #PU0ST    OREQ 'N'
     C           #PU0ST    OREQ *BLANK
     C           'PM'      IFEQ 'OE'                       *IF
     C           'PM'      OREQ 'PS'
     C           'PM'      OREQ 'UWC'
     C           'PM'      OREQ 'UWT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 07/07/08 PKD Replaced w/consideration for .01 manual price
      * Extend Price using Price Overage Override or Unit Price-Credit
      * CASE: PAR.Price Method Code is Deviated
     C           #PQ7CD    IFEQ 'DEV'                      *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0046 112       Extended Amount
     C                     PARM WN0001    WQ0047  2        U/M - Base Pric
     C                     PARM WN0006    WQ0048 112       Quantity Shippe
     C                     PARM WN0007    WQ0049 112       Weight Shipped
     C                     PARM #PBZPR    WQ0050 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & HPB
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is High Plains Biodiesel
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PQ7CD    IFEQ 'MAN'                      *IF
     C           YL0003    IFEQ 'H'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0051 112       Extended Amount
     C                     PARM WN0001    WQ0052  2        U/M - Base Pric
     C                     PARM WN0006    WQ0053 112       Quantity Shippe
     C                     PARM WN0007    WQ0054 112       Weight Shipped
     C                     PARM #PBZPR    WQ0055 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & Not HPB
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is Not HPB
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PQ7CD    IFEQ 'MAN'                      *IF
     C           YL0003    IFEQ 'D'                        *IF
     C           YL0003    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override OR Unit Price-Credit
      * CASE: PS Cst | IC Cst | UNID Itm | OTHER Itm | >.01 Prc
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : PAR.Type Code is Inter Company
      *   |- c2    : PAR.Type Code is Is Promotional/Samples
      *   |- c3    : PAR.Primal Group Code is Samples or Cut Loss
      *   |- c4    : PAR.Primal Group Code is Other
      *   |- c5    : PAR.Price Overage Override is GT .01
      *   '-
     C           YL0001    IFEQ 'IC'                       *IF
     C           YL0001    OREQ 'PS'                       *OR
     C           WN0004    OREQ 'UNID'                     *OR
     C           WN0004    OREQ 'OTHER'                    *OR
     C           #PBZPR    ORGT .01                        *OR
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0056 112       Extended Amount
     C                     PARM WN0001    WQ0057  2        U/M - Base Pric
     C                     PARM WN0006    WQ0058 112       Quantity Shippe
     C                     PARM WN0007    WQ0059 112       Weight Shipped
     C                     PARM #PBZPR    WQ0060 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * ----- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0061 112       Extended Amount
     C                     PARM WN0001    WQ0062  2        U/M - Base Pric
     C                     PARM WN0006    WQ0063 112       Quantity Shippe
     C                     PARM WN0007    WQ0064 112       Weight Shipped
     C                     PARM #PALPR    WQ0065 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ---- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0066 112       Extended Amount
     C                     PARM WN0001    WQ0067  2        U/M - Base Pric
     C                     PARM WN0006    WQ0068 112       Quantity Shippe
     C                     PARM WN0007    WQ0069 112       Weight Shipped
     C                     PARM #PALPR    WQ0070 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 08/28/07 PKD Replaced with Clc OrdDtl Ext Amt    XF
      * 04/28/10 PKD If Unit Price is zero, then use Unit Price-Credit.
      * ** Added Not .01 to force these orders to use Credit Chk Price.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Unit Price is Not Zeros
      *   |- c2    : PAR.Unit Price is Not .01
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PAKPR    IFNE 0                          *IF
     C           #PAKPR    IFNE .01                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0071 112       Extended Amount
     C                     PARM WN0001    WQ0072  2        U/M - Base Pric
     C                     PARM WN0006    WQ0073 112       Quantity Shippe
     C                     PARM WN0007    WQ0074 112       Weight Shipped
     C                     PARM #PAKPR    WQ0075 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Unit Price Ordered U/M
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0006    IFNE 0                          *IF
     C           #PAYVA    DIV  WN0006    #PAUPR    H      Unit Price Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0076 112       Extended Amount
     C                     PARM WN0001    WQ0077  2        U/M - Base Pric
     C                     PARM WN0006    WQ0078 112       Quantity Shippe
     C                     PARM WN0007    WQ0079 112       Weight Shipped
     C                     PARM #PALPR    WQ0080 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
      * RTV Price Maint        XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDP6XFR'              90  RTV Price Maint
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0081  30       Company Number
     C                     PARM #PHGCD    WQ0082  70       Item Code
     C           P9LNCD    PARM *BLANK    WQ0083  3        Default Commod
     C           P9TMVA    PARM *ZERO     WQ0084 112       Maximum Audit V
     C           P9TNVA    PARM *ZERO     WQ0085 112       Minimum Audit V
     C           P9LRCD    PARM *BLANK    WQ0086  7        Commodity Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDYL0002    #CTBNB           Absorbed Freigh
      * Price Method = Manual
      * CASE: CTL.Price Method Code is Manual
     C           #PQ7CD    IFEQ 'MAN'                      *IF
      * Val Manual Price      RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0010           Company Number
     C                     Z-ADD#PHGCD    WL0011           Item Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    YL0004    P      Description Lin
     C                     MOVELWL0013    YL0005    P      Default Commod
     C                     Z-ADDWL0014    YL0006           Market Overage
     C                     Z-ADDWL0015    YL0007           Standard Overag
     C                     MOVELWL0016    YL0008    P      Commodity Price
     C                     Z-ADDWL0017    YL0009           Std Weight_Head
     C                     MOVELWL0018    YL0010    P      Primal Group Co
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Primal Group Code is NE Samples or Cut Loss
      *   |- c2    : LCL.Type Code is Not Promotional/Samples
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0010    IFNE 'UNID'                     *IF
     C           YL0001    IFNE 'PS'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     Z-ADD*ZERO     WN0008  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0009  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0010  74       Percent 7.4 USR
     C                     Z-ADD*ZERO     WN0011 114       Price Adjustmen
      *
      * VAL Manual Price Range IF
      * *---------------------------------------------------------------*
      * Documentation:
      * This internal function will determine if a manual price entered
      * on an order detail line is within the Manual Pricing Acceptance
      * Percentage from the Company Control file. If it does not fall
      * within the percentage range then the market price will be used.
      * If no market price is found then it is a manual price error
      * *---------------------------------------------------------------*
     C                     Z-ADD*ZERO     WUB8PR           Projected Marke
     C                     Z-ADD*ZERO     YL0011           Minimum Price
     C                     Z-ADD*ZERO     YL0012           Maximum Price
     C                     MOVEL'Y'       WUTXST           Error Status  3
      * RTV Manual Price Accpt RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0019           Company Number
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    WN0008           Manual Price Ac
     C                     Z-ADDWL0021    WN0009           CoPk/FdSrv ManP
      * Food Service and Co-Pack Items
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Default Commod Mark basis is Food Service
      *   |- c2    : PAR.Default Commod Mark basis is Co-Pack
      *   '-
     C           P9LNCD    IFEQ 'FSV'                      *IF
     C           P9LNCD    OREQ 'CPK'                      *OR
     C                     Z-ADDWN0009    WN0008           Manual Price Ac
     C                     END                             *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP3LQCD    WL0022    P      Commodity Marke
     C                     MOVELP9LRCD    WL0023    P      Commodity Price
     C                     Z-ADD9999999   WL0024           Market Price Da
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0025    WUB8PR           Commodity Marke
     C                     Z-ADDWL0026    WUE7DT           USR Date Priced
      * Projected Market Price
      * PAR.Projected Market Price =
      *    *COMPUTE (x1 + x2 + (x3 / x4))
      * x1    : PAR.Projected Market Price
      * +     : PGM.*Synon (15,5) work field
      * x2    : PAR.Standard Overage_Underage
      * +     : PGM.*Synon (15,5) work field
      * x3    : PAR.Absorbed Freight Rate CWT
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           WUB8PR    ADD  YL0006    W0WB01           *Synon (15,5) w
     C           YL0002    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WB01    ADD  W0WB02    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    WUB8PR           Projected Marke
      * If a market price is found for co/cust market code default
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x4 - (x1 / x2)) * x3))
      * x4    : CON.1
      * -     : PGM.*Synon (17,7) work field
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0008    DIV  100       W0WD02    H      *Synon (17,7) w
     C           1         SUB  W0WD02    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT WUB8PR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0011           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0008    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT WUB8PR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0012           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PBZPR    IFGE YL0011                     *IF
     C           #PBZPR    IFLE YL0012                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If no price for co/cust market code then use co/item market code
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP9LNCD    WL0022    P      Commodity Marke
     C                     MOVELP9LRCD    WL0023    P      Commodity Price
     C                     Z-ADD9999999   WL0024           Market Price Da
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0025    WUB8PR           Commodity Marke
     C                     Z-ADDWL0026    WUE7DT           USR Date Priced
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0008    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUB8PR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0011           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0008    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT WUB8PR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0012           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PBZPR    IFGE YL0011                     *IF
     C           #PBZPR    IFLE YL0012                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUB8PR           Projected Marke
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Error Status  3 is Yes
     C           WUTXST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#PAKPR    ZA0006           Unit Price
     C                     Z-ADDYL0011    ZA0007           Minimum Price
     C                     Z-ADDYL0012    ZA0008           Maximum Price
      * Send message 'WARNING: Price out of rng'
     C                     MOVEL'USR2374' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * RTV Req Delv/Hdr Sts  RT - Order Header TRG  * 
     C                     EXSR SKRVGN
      * If order has been shipped show qty shipped, otherwise show qty sc
      * CASE: WRK.Header Status is Confirmed & Complete
     C           WUGWST    IFEQ 'C'                        *IF
     C           WUGWST    OREQ 'R'
     C                     MOVEL@CN,001   #CMTTX           Field Descripti
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,002   #CMTTX           Field Descripti
     C                     Z-ADDP3CCQT    #PCBQT           Quantity Shippe
     C                     END                             *FI
      * PK0519 10/22/03
     C                     MOVEL'Y'       YL0013           USR Display 3
      * CASE: CTL.Price Method Code USR is Deviated
     C           #CTKCD    IFEQ 'DEV'                      *IF
     C                     MOVEL'N'       YL0013           USR Display 3
     C                     END                             *FI
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           IMAIC3           Company Number
     C                     KFLD           IMC4NB           Order Number
     C                     KFLD           IMDPNB           Order Sequence
     C                     KFLD           IMUENB           Order Secondary
     C                     KFLD           IMPDSQ           Price Detail Se
      * Setup key
     C                     Z-ADD#2AIC3    IMAIC3
     C                     Z-ADD#2C4NB    IMC4NB
     C                     Z-ADD#2DPNB    IMDPNB
     C                     Z-ADD#2UENB    IMUENB
     C                     Z-ADD#2PDSQ    IMPDSQ
     C           KPOS      SETLL@IMPCZW0
     C           KRST      KLIST
     C                     KFLD           IMAIC3           Company Number
     C                     KFLD           IMC4NB           Order Number
     C                     KFLD           IMDPNB           Order Sequence
     C                     KFLD           IMUENB           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    IMAIC3
     C                     Z-ADD#2C4NB    IMC4NB
     C                     Z-ADD#2DPNB    IMDPNB
     C                     Z-ADD#2UENB    IMUENB
     C           KRST      READE@IMPCZW0               8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2PDSQ    WZPDSQ
     C                     MOVEL#2PDSQ    WZPDSQ           Price Detail Se
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2DPNB    WZDPNB
     C                     MOVEL#2DPNB    WZDPNB           Order Sequence
     C           *LIKE     DEFN #2UENB    WZUENB
     C                     MOVEL#2UENB    WZUENB           Order Secondary
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@IMPCZW0                 90*
     C  N82                READ @IMPCZW0                 90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,38
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
     C                     MOVEL'Y'       P8GGST           USR Display fie
      * This function will check to see if componant can be updated
      * RTV Upd Flag Prc Dtl   IX
     C                     MOVEL'Y'       WUR4ST           USR Update Flag
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7
      *   |- c1    : PAR.Price Method Componant is FRMPRC
      *   |- c2    : PAR.Price Method Componant is MSCYLD
      *   |- c3    : PAR.Price Method Componant is STRITM
      *   |- c4    : PAR.Price Method Componant is SUBCRD
      *   |- c5    : PAR.Price Method Componant is TCRDVY
      *   |- c6    : PAR.Price Method Componant is TLCRDY
      *   |- c7    : PAR.Price Method Componant is TLCRDV
      *   '-
     C           #1Q9CD    IFEQ @CN,003                    *IF
     C           #1Q9CD    OREQ @CN,004                    *OR
     C           #1Q9CD    OREQ @CN,005                    *OR
     C           #1Q9CD    OREQ @CN,006                    *OR
     C           #1Q9CD    OREQ @CN,007                    *OR
     C           #1Q9CD    OREQ @CN,008                    *OR
     C           #1Q9CD    OREQ @CN,009                    *OR
     C                     MOVEL*BLANK    WUR4ST           USR Update Flag
     C                     END                             *FI
      * RTV Price Meth Type    RT - Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0027           Company Number
     C                     MOVEL#PQ7CD    WL0028    P      Price Method Co
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0029    WUV8ST    P      Price Method Ty
      * Set Usr Display Flag for Subfile select field
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : WRK.USR Update Flag is No
      *   |- c2    : WRK.Price Method Type is Extended Pricing
      *   |- c3    : WRK.Price Method Type is Manual Pricing
      *   '-
     C           WUR4ST    IFEQ *BLANK                     *IF
     C           WUV8ST    OREQ 'X'                        *OR
     C           WUV8ST    OREQ 'M'                        *OR
     C                     MOVEL'N'       P8GGST           USR Display fie
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * VAL Check Existence    RT - PD Price Method Detail  * 
     C                     EXSR SMRVGN
      * Do not display record if not found in Price Method Detail File
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * CASE: DB1.Price Method Componant is TCRDVY
     C           IMQ9CD    IFEQ @CN,007                    *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * RTV Description        RT - Price Method Componant  * 
     C                     EXSR SNRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C           IMBNPR    MULT 1         YL0014    H      USR Value
     C                     Z-ADDYL0014    #1BNPR           Componant Price
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C           KRST      READE@IMPCZW0                 82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Market Pricing Date USR
      * External date
     C                     Z-ADDVCG2DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9936  *
     C                     END
     C                     Z-ADDXDINDT    #CG2DT
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile control function fields
      * Select Price Method
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> CTL.Price Method Code USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#CTKCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL OMS System Only    SR - Price Method Header  * 
     C                     CALL 'PDZSSRR'              90  SEL OMS System
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0087  30       Company Number
     C           #CTKCD    PARM #CTKCD    WQ0088  3        Price Method Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
      * Select Date Method
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> CTL.Date Method Code USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#CTLCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL OMS Mkt Date Only  SR - PD Market Date Method  * 
     C                     CALL 'PDZZSRR'              90  SEL OMS Mkt Dat
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0089  30       Company Number
     C           #CTLCD    PARM #CTLCD    WQ0090  3        Date Method Cod
     C           WUMNNA    PARM *BLANK    WQ0091 30        Date Method Des
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZZSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     END                             *FI
      * Select Contract
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> CTL.Contract Number USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#CCNBR'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Item Contract Nbr  SR - OPP Item Contract  * 
     C                     CALL 'PDOFSRR'              90  SEL Item Contra
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0092  30       Company Number
     C           #PBKC7    PARM #PBKC7    WQ0093  70       Ship To Custome
     C           #PHGCD    PARM #PHGCD    WQ0094  70       Item Code
     C           WUAUDT    PARM WUAUDT    WQ0095  70       Effective Date
     C           #CCNBR    PARM *ZERO     WQ0096  70       Contract Number
     C           #CCLPR    PARM *ZERO     WQ0097 114       Contract Price
     C           WUGBDT    PARM *ZERO     WQ0098  70       Contract Mkt Pr
     C           #CTLCD    PARM *BLANK    WQ0099  3        Date Method Cod
     C           #CTKCD    PARM *BLANK    WQ0100  3        Price Method Co
     C           #PLQCD    PARM *BLANK    WQ0101  3        Dft Commodity M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOFSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993431*
     C                     SETON                     3532  *
     C                     END
     C                     END                             *FI
      * Select Market
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> CTL.Commodity Market Code USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#CTMCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Commod. Mkts Actve SR - OM Commodity Markets  * 
     C                     CALL 'PDEDSRR'              90  SEL Commod. Mkt
     C                     PARM *BLANK    W0RTN   7
     C           #CTMCD    PARM #CTMCD    WQ0102  3        Commodity Marke
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEDSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
     C                     END                             *FI
      * Select Price Code  PK0519 10/29/03
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> CTL.Price Code USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#CUYNX'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     YL0015           Price Code
      * Sel Customer Prc Hdr  SL - Customer Price Header  * 
     C                     CALL 'POPOSRR'              90  Sel Customer Pr
     C                     PARM *BLANK    W0RTN   7
     C           #PBKC7    PARM #PBKC7    WQ0103  70       Ship To Custome
     C           YL0015    PARM YL0015    WQ0104  60       Price Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPOSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Price Code is Entered
     C           YL0015    IFGT *ZERO                      *IF
     C                     Z-ADDYL0015    #CUYNX           Price Code USR
     C                     END                             *FI
     C                     END                             *FI
      * Edit Pricing Control Fields
     C                     EXSR UASUBR                     Edit Pricing Co
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
     C                     MOVEL*BLANK    WUR4ST           USR Update Flag
      * 7=Edit Price Details
      * CASE: CTL.*CMD key is CF07
     C           *IN07     IFEQ '1'                        *IF
      * Edt OrdDtl Pricing    ER - Order Detail  * 
     C                     CLEARPBRC
     C                     Z-ADD#2AIC3    PBAIC3           Company Number
     C                     Z-ADD#2C4NB    PBC4NB           Order Number
     C                     Z-ADD#2DPNB    PBDPNB           Order Sequence
     C                     Z-ADD#2UENB    PBUENB           Order Secondary
      *
     C                     CALL 'PNQBE1R'              90  Edt OrdDtl Pric
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Order Deta
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQBE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * If control fields are changed then Pricing will be recalced
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7
      *   |- c1    : CTL.Price Overage Overrid USR NE CTL.Price Overage O
      *   |- c2    : CTL.Price Method Code USR NE CTL.Price Method Code
      *   |- c3    : CTL.Date Method Code USR NE CTL.Date Method Code
      *   |- c4    : CTL.Market Pricing Date USR NE CTL.Market Pricing Da
      *   |- c5    : CTL.Commodity Market Code USR NE CTL.Commodity Marke
      *   |- c6    : CTL.Contract Number USR NE CTL.Contract Number
      *   |- c7    : PAR.USR Update Flag is Yes
      *   '-
     C           #CCLPR    IFNE #PBZPR                     *IF
     C           #CTKCD    ORNE #PQ7CD                     *OR
     C           #CTLCD    ORNE #PRDCD                     *OR
     C           #CG2DT    ORNE #PEXDT                     *OR
     C           #CTMCD    ORNE #PLQCD                     *OR
     C           #CCNBR    ORNE #PL6NB                     *OR
     C           P6R4ST    OREQ 'Y'                        *OR
     C                     MOVEL*BLANK    P6R4ST           USR Update Flag
      * CLC Price Item         XF - Price Method Header  * 
     C                     CALL 'PDG9XFR'              90  CLC Price Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0119  30       Company Number
     C                     PARM #CTKCD    WQ0120  3        Price Method Co
     C                     PARM #PBKC7    WQ0121  70       Ship To Custome
     C                     PARM #PGNDT    WQ0122  70       Actual Shipped
     C                     PARM #PAGCD    WQ0123  2        U/M - Ordered
     C                     PARM #PAVQT    WQ0124 112       Quantity Ordere
     C                     PARM #PA5DT    WQ0125  70       Requested Ship
     C           #PAKPR    PARM #PAKPR    WQ0126 114       Unit Price
     C           #PAUPR    PARM #PAUPR    WQ0127 114       Unit Price Orde
     C                     PARM #PHGCD    WQ0128  70       Item Code
     C                     PARM P2CXDT    WQ0129  70       Date of Orig. E
     C                     PARM #CTMCD    WQ0130  3        Commodity Marke
     C                     PARM #CG2DT    WQ0131  70       Market Pricing
     C           #PU1ST    PARM #PU1ST    WQ0132  1        Price Status
     C                     PARM #CTLCD    WQ0133  3        Date Method Cod
     C                     PARM #CCLPR    WQ0134 114       Price Overage O
     C           WUGIDT    PARM WUGIDT    WQ0135  70       Pricing Date Us
     C                     PARM '**'      WQ0136  2        Event Called Fr
     C                     PARM #CDWPR    WQ0137 114       OD Ceiling Pric
     C                     PARM #PTKDT    WQ0138  70       OD Market Begin
     C                     PARM #PTLDT    WQ0139  70       OD Market Endin
     C                     PARM #2C4NB    WQ0140  70       Order Number
     C                     PARM #CEIDT    WQ0141  70       Requested Deliv
     C                     PARM #2DPNB    WQ0142  30       Order Sequence
     C                     PARM P1UENB    WQ0143  30       Order Secondary
     C           WUWZST    PARM WUWZST    WQ0144  5        Error Return
     C                     PARM 'S'       WQ0145  1        Price Type Stat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993237*
     C                     SETON                     363531*
     C                     END
      * Extend Order detail amount and determine Pricing U/M Price
      *
     C                     MOVEL*BLANK    WN0025  2        UOM Pricing
     C                     Z-ADD*ZERO     WN0026 112       Unit Weight
     C                     MOVEL*BLANK    WN0027  1        Catch Weight St
     C                     MOVEL*BLANK    WN0028  6        Primal Group Co
     C                     Z-ADD*ZERO     WN0029 114       Price per Pound
     C                     Z-ADD*ZERO     WN0030 112       USR Quantity
     C                     Z-ADD*ZERO     WN0031 112       USR Weight
      *
      * CLC Price,Ext,U/M1Prc  IF
      * *****************************************************************
      * Calculate "Price Per Pound", "Extended Amount", "Primary U/M Pric
      * *****************************************************************
     C                     Z-ADD*ZERO     WN0026           Unit Weight
     C                     MOVEL*BLANK    WN0025           UOM Pricing
     C                     MOVEL*BLANK    WN0027           Catch Weight St
      * Load Quantity Shipped Total field. c2742- do -0- shipped from ord
      * CASE: PAR.Quantity Shipped Total is Equal to zero
     C           #PCBQT    IFEQ 0                          *IF
     C                     Z-ADD1         WUCBQT           Quantity Shippe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#PCBQT    WUCBQT           Quantity Shippe
     C                     END                             *FI
      * Set quantity and weight according to order status  c2742 -0- shpe
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : PAR.Event Code is Entered Thru 03 Picked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PGMST    IFEQ 'L'                        *IF
     C           #PGMST    OREQ 'A'
     C           #PGMST    OREQ 'E'
     C           #PGMST    OREQ 'H'
     C           #PJPCD    IFGE '01'                       *IF
     C           #PJPCD    ANDLE'03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 6/17/09 FP1054 use qty/wgt ordered instead of sched
     C                     Z-ADD#PAVQT    WN0030           USR Quantity
     C                     Z-ADD#PD0WG    WN0031           USR Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUCBQT    WN0030           USR Quantity
     C                     Z-ADD#PATWG    WN0031           USR Weight
     C                     END                             *FI
      * RTV For Price Extent   XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDXRXFR'              90  RTV For Price E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0146  30       Company Number
     C                     PARM #PHGCD    WQ0147  70       Item Code
     C           WN0025    PARM *BLANK    WQ0148  2        UOM Pricing
     C           WN0026    PARM *ZERO     WQ0149 112       Unit Weight
     C           WN0027    PARM *BLANK    WQ0150  1        Catch Weight St
     C           WN0028    PARM *BLANK    WQ0151  6        Primal Group Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check retrieve Unit Weight & C/W error
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : PAR.Catch Weight Status is Y/N Values
      *   |- c3    : PAR.Unit Weight is Not equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           WN0027    IFEQ 'N'                        *IF
     C           WN0027    OREQ 'Y'
     C           WN0026    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           *ZERO     IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL*ZERO     WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0048           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0048           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZA0049           Order Sequence
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0050           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0050           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVELWN0027    ZA0051           Catch Weight St
     C                     Z-ADD*ZERO     ZA0052           Unit Price
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2306' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
      * CASE: PAR.Price Method Code is Extended
     C           #PQ7CD    IFEQ 'EXT'                      *IF
     C                     Z-ADD#PBZPR    #PAYVA           Extended Amount
      * Calculate Unit Price for Extended
      * CASE: PAR.USR Weight is Not equal zero
     C           WN0031    IFNE 0                          *IF
     C           #PAYVA    DIV  WN0031    #PAKPR    H      Unit Price
     C                     END                             *FI
      * Calculate Pricing U/M Price for Extended
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0030    IFNE 0                          *IF
     C           #PAYVA    DIV  WN0030    #PAUPR    H      Unit Price Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Extend price with unit price credit if not zeros
      * CASE:
      *  - (c1 AND c2 AND c3 AND c5 AND c7)
      *   |- c1    : PAR.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : PAR.Event Code is Entered Thru 03 Picked
      *   |- c3    : PAR.Unit Price - Credit is Not Zeros
      *   |- c5    : PAR.Price Audit is Not Manually Price Audit
      *   |- c7    : PAR.Pricing Event Called From is No Price With Credi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PGMST    IFEQ 'L'                        *IF
     C           #PGMST    OREQ 'A'
     C           #PGMST    OREQ 'E'
     C           #PGMST    OREQ 'H'
     C           #PJPCD    IFGE '01'                       *IF
     C           #PJPCD    ANDLE'03'
     C           #PALPR    IFNE 0                          *IF
     C           #PU0ST    IFEQ 'A'                        *IF
     C           #PU0ST    OREQ 'N'
     C           #PU0ST    OREQ *BLANK
     C           'PM'      IFEQ 'OE'                       *IF
     C           'PM'      OREQ 'PS'
     C           'PM'      OREQ 'UWC'
     C           'PM'      OREQ 'UWT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 07/07/08 PKD Replaced w/consideration for .01 manual price
      * Extend Price using Price Overage Override or Unit Price-Credit
      * CASE: PAR.Price Method Code is Deviated
     C           #PQ7CD    IFEQ 'DEV'                      *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0152 112       Extended Amount
     C                     PARM WN0025    WQ0153  2        U/M - Base Pric
     C                     PARM WN0030    WQ0154 112       Quantity Shippe
     C                     PARM WN0031    WQ0155 112       Weight Shipped
     C                     PARM #PBZPR    WQ0156 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & HPB
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is High Plains Biodiesel
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PQ7CD    IFEQ 'MAN'                      *IF
     C           YL0003    IFEQ 'H'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0157 112       Extended Amount
     C                     PARM WN0025    WQ0158  2        U/M - Base Pric
     C                     PARM WN0030    WQ0159 112       Quantity Shippe
     C                     PARM WN0031    WQ0160 112       Weight Shipped
     C                     PARM #PBZPR    WQ0161 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & Not HPB
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is Not HPB
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PQ7CD    IFEQ 'MAN'                      *IF
     C           YL0003    IFEQ 'D'                        *IF
     C           YL0003    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override OR Unit Price-Credit
      * CASE: PS Cst | IC Cst | UNID Itm | OTHER Itm | >.01 Prc
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : PAR.Type Code is Inter Company
      *   |- c2    : PAR.Type Code is Is Promotional/Samples
      *   |- c3    : PAR.Primal Group Code is Samples or Cut Loss
      *   |- c4    : PAR.Primal Group Code is Other
      *   |- c5    : PAR.Price Overage Override is GT .01
      *   '-
     C           YL0001    IFEQ 'IC'                       *IF
     C           YL0001    OREQ 'PS'                       *OR
     C           WN0028    OREQ 'UNID'                     *OR
     C           WN0028    OREQ 'OTHER'                    *OR
     C           #PBZPR    ORGT .01                        *OR
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0162 112       Extended Amount
     C                     PARM WN0025    WQ0163  2        U/M - Base Pric
     C                     PARM WN0030    WQ0164 112       Quantity Shippe
     C                     PARM WN0031    WQ0165 112       Weight Shipped
     C                     PARM #PBZPR    WQ0166 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * ----- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0167 112       Extended Amount
     C                     PARM WN0025    WQ0168  2        U/M - Base Pric
     C                     PARM WN0030    WQ0169 112       Quantity Shippe
     C                     PARM WN0031    WQ0170 112       Weight Shipped
     C                     PARM #PALPR    WQ0171 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ---- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0172 112       Extended Amount
     C                     PARM WN0025    WQ0173  2        U/M - Base Pric
     C                     PARM WN0030    WQ0174 112       Quantity Shippe
     C                     PARM WN0031    WQ0175 112       Weight Shipped
     C                     PARM #PALPR    WQ0176 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 08/28/07 PKD Replaced with Clc OrdDtl Ext Amt    XF
      * 04/28/10 PKD If Unit Price is zero, then use Unit Price-Credit.
      * ** Added Not .01 to force these orders to use Credit Chk Price.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Unit Price is Not Zeros
      *   |- c2    : PAR.Unit Price is Not .01
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PAKPR    IFNE 0                          *IF
     C           #PAKPR    IFNE .01                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0177 112       Extended Amount
     C                     PARM WN0025    WQ0178  2        U/M - Base Pric
     C                     PARM WN0030    WQ0179 112       Quantity Shippe
     C                     PARM WN0031    WQ0180 112       Weight Shipped
     C                     PARM #PAKPR    WQ0181 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Unit Price Ordered U/M
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0030    IFNE 0                          *IF
     C           #PAYVA    DIV  WN0030    #PAUPR    H      Unit Price Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0182 112       Extended Amount
     C                     PARM WN0025    WQ0183  2        U/M - Base Pric
     C                     PARM WN0030    WQ0184 112       Quantity Shippe
     C                     PARM WN0031    WQ0185 112       Weight Shipped
     C                     PARM #PALPR    WQ0186 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
     C                     MOVEL#PU1ST    P3U1ST           Price Status
      * Flag as Unpriced if a Pricing Error was Encountered
      * CASE: WRK.Error Return is All Entered Values
     C           WUWZST    IFEQ 'CFR'                      *IF
     C           WUWZST    OREQ 'CID'
     C           WUWZST    OREQ 'CIF'
     C           WUWZST    OREQ 'CIO'
     C           WUWZST    OREQ 'QPE'
     C           WUWZST    OREQ 'EXT'
     C           WUWZST    OREQ 'XPE'
     C           WUWZST    OREQ 'FPE'
     C           WUWZST    OREQ 'IOM'
     C           WUWZST    OREQ 'IOV'
     C           WUWZST    OREQ 'MPE'
     C           WUWZST    OREQ 'KPE'
     C           WUWZST    OREQ 'MKT'
     C           WUWZST    OREQ 'MSC'
     C           WUWZST    OREQ 'OVR'
     C           WUWZST    OREQ 'STR'
     C           WUWZST    OREQ 'SUB'
     C           WUWZST    OREQ 'TRC'
     C           WUWZST    OREQ 'WPA'
     C           WUWZST    OREQ 'RWB'
     C           WUWZST    OREQ 'ITERR'
     C           WUWZST    OREQ 'CRD'
     C           WUWZST    OREQ 'MSL'
     C           WUWZST    OREQ 'GAT'
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Setup message data for message
     C                     MOVELWUWZST    ZA0053           Error Return
      * Send message 'Pricing Error was found'
     C                     MOVEL'USR1953' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Move Usr Screen fields into Screen Control Fields
     C                     EXSR UBSUBR                     Move Usr Screen
      * SFL Execute SFL Subrou US - /UT User Source  * 
      *
      * THIS CODE USED TO RELOAD SUBFILE IN PRICING DETAILS
      *
     C                     EXSR BAIZSF
     C                     MOVEL'Y'       WUR4ST           USR Update Flag
     C                     END                             *FI
      * RTV Item Details       XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKAXFR'              90  RTV Item Detail
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0187  30       Company Number
     C                     PARM #PHGCD    WQ0188  70       Item Code
     C           #PAGCD    PARM *BLANK    WQ0189  2        UOM Primary
     C           WUNFNN    PARM *ZERO     WQ0190  94       Conversion Fact
     C           WUG0TX    PARM *BLANK    WQ0191  1        Operation Facto
     C           WUG0TX    PARM *BLANK    WQ0192  2        UOM Second
     C           WUNFNN    PARM *ZERO     WQ0193  94       Conversion Fact
     C           WUG0TX    PARM *BLANK    WQ0194  1        Operation Facto
     C           WUG0TX    PARM *BLANK    WQ0195  2        UOM Third
     C           #PCRCD    PARM *BLANK    WQ0196  2        UOM Pricing
     C           WUNFNN    PARM *ZERO     WQ0197 112       Unit Weight
     C           WUNFNN    PARM *ZERO     WQ0198 114       Market Overage
     C           WUNFNN    PARM *ZERO     WQ0199 114       Standard Overag
     C           WUG0TX    PARM *BLANK    WQ0200  7        Commodity Price
     C           WUG0TX    PARM *BLANK    WQ0201  1        Item Pricing Op
     C           WUNFNN    PARM *ZERO     WQ0202 114       Item Pricing Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Added the following -Purva 4/30/99
      * Price Method = Manual
      * CASE: CTL.Price Method Code is Manual
     C           #PQ7CD    IFEQ 'MAN'                      *IF
      * Val Manual Price      RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0010           Company Number
     C                     Z-ADD#PHGCD    WL0011           Item Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    YL0004    P      Description Lin
     C                     MOVELWL0013    P9LNCD    P      Default Commod
     C                     Z-ADDWL0014    YL0006           Market Overage
     C                     Z-ADDWL0015    YL0007           Standard Overag
     C                     MOVELWL0016    YL0008    P      Commodity Price
     C                     Z-ADDWL0017    YL0009           Std Weight_Head
     C                     MOVELWL0018    YL0010    P      Primal Group Co
      * R12926 DN 04/30/18-At Order level, get Absorbed Freight Rate from
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0003           Company Number
     C                     Z-ADD#PBKC7    WL0004           Ship To Custome
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0001    P      Type Code
     C                     Z-ADDWL0006    YN0001           Absorbed Freigh
      * Rtv Absorbed Frt Rate RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0007           Company Number
     C                     Z-ADD#2C4NB    WL0008           Order Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YL0002           Absorbed Freigh
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Primal Group Code is NE Samples or Cut Loss
      *   |- c2    : LCL.Type Code is Not Promotional/Samples
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0010    IFNE 'UNID'                     *IF
     C           YL0001    IFNE 'PS'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     Z-ADD*ZERO     WN0032  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0033  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0034  74       Percent 7.4 USR
     C                     Z-ADD*ZERO     WN0035 114       Price Adjustmen
      *
      * VAL Manual Price Range IF
      * *---------------------------------------------------------------*
      * Documentation:
      * This internal function will determine if a manual price entered
      * on an order detail line is within the Manual Pricing Acceptance
      * Percentage from the Company Control file. If it does not fall
      * within the percentage range then the market price will be used.
      * If no market price is found then it is a manual price error
      * *---------------------------------------------------------------*
     C                     Z-ADD*ZERO     WUB8PR           Projected Marke
     C                     Z-ADD*ZERO     YL0011           Minimum Price
     C                     Z-ADD*ZERO     YL0012           Maximum Price
     C                     MOVEL'Y'       WUTXST           Error Status  3
      * RTV Manual Price Accpt RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0019           Company Number
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    WN0032           Manual Price Ac
     C                     Z-ADDWL0021    WN0033           CoPk/FdSrv ManP
      * Food Service and Co-Pack Items
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Default Commod Mark basis is Food Service
      *   |- c2    : PAR.Default Commod Mark basis is Co-Pack
      *   '-
     C           P9LNCD    IFEQ 'FSV'                      *IF
     C           P9LNCD    OREQ 'CPK'                      *OR
     C                     Z-ADDWN0033    WN0032           Manual Price Ac
     C                     END                             *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP3LQCD    WL0022    P      Commodity Marke
     C                     MOVELP9LRCD    WL0023    P      Commodity Price
     C                     Z-ADD9999999   WL0024           Market Price Da
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0025    WUB8PR           Commodity Marke
     C                     Z-ADDWL0026    WUE7DT           USR Date Priced
      * Projected Market Price
      * PAR.Projected Market Price =
      *    *COMPUTE (x1 + x2 + (x3 / x4))
      * x1    : PAR.Projected Market Price
      * +     : PGM.*Synon (15,5) work field
      * x2    : PAR.Standard Overage_Underage
      * +     : PGM.*Synon (15,5) work field
      * x3    : PAR.Absorbed Freight Rate CWT
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           WUB8PR    ADD  YL0007    W0WB01           *Synon (15,5) w
     C           YL0002    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WB01    ADD  W0WB02    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    WUB8PR           Projected Marke
      * If a market price is found for co/cust market code default
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x4 - (x1 / x2)) * x3))
      * x4    : CON.1
      * -     : PGM.*Synon (17,7) work field
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0032    DIV  100       W0WD02    H      *Synon (17,7) w
     C           1         SUB  W0WD02    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT WUB8PR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0011           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0032    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT WUB8PR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0012           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PBZPR    IFGE YL0011                     *IF
     C           #PBZPR    IFLE YL0012                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If no price for co/cust market code then use co/item market code
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP9LNCD    WL0022    P      Commodity Marke
     C                     MOVELP9LRCD    WL0023    P      Commodity Price
     C                     Z-ADD9999999   WL0024           Market Price Da
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0025    WUB8PR           Commodity Marke
     C                     Z-ADDWL0026    WUE7DT           USR Date Priced
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0032    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUB8PR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0011           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0032    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT WUB8PR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0012           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PBZPR    IFGE YL0011                     *IF
     C           #PBZPR    IFLE YL0012                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUB8PR           Projected Marke
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Error Status  3 is Yes
     C           WUTXST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#PAKPR    ZA0054           Unit Price
     C                     Z-ADDYL0011    ZA0055           Minimum Price
     C                     Z-ADDYL0012    ZA0056           Maximum Price
      * Send message 'WARNING: Price out of rng'
     C                     MOVEL'USR2374' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,38
     C                     SETOF                     98    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * Edit Price Componant Value
      * CASE: WRK.USR Update Flag is No
     C           WUR4ST    IFEQ *BLANK                     *IF
      * CASE: RCD.*SFLSEL is *Change
     C           #1SEL     IFEQ '2'                        *IF
      * EDT Ship Price Detail  E1 - Order Detail Pricing  * 
     C                     CALL 'PDN9E1R'              90  EDT Ship Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0203  30       Company Number
     C                     PARM #1C4NB    WQ0204  70       Order Number
     C                     PARM #1DPNB    WQ0205  30       Order Sequence
     C                     PARM #1UENB    WQ0206  30       Order Secondary
     C                     PARM #1PDSQ    WQ0207  30       Price Detail Se
     C                     PARM #PHGCD    WQ0208  70       Item Code
     C                     PARM #PAJCD    WQ0209  3        Warehouse Code
     C                     PARM #RMMNA    WQ0210 30        Price Componant
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDN9E1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CLC Pricing using File XF - Order Detail Pricing  * 
     C                     CALL 'PDOJXFR'              90  CLC Pricing usi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0211  30       Company Number
     C                     PARM #1C4NB    WQ0212  70       Order Number
     C                     PARM #1DPNB    WQ0213  30       Order Sequence
     C                     PARM #1UENB    WQ0214  30       Order Secondary
     C                     PARM #1PDSQ    WQ0215  30       Price Detail Se
     C                     PARM #PHGCD    WQ0216  70       Item Code
     C                     PARM #PQ7CD    WQ0217  3        Price Method Co
     C                     PARM #PAGCD    WQ0218  2        U/M - Ordered
     C           #PAKPR    PARM #PAKPR    WQ0219 114       Unit Price
     C           #PALPR    PARM #PALPR    WQ0220 114       Unit Price - Cr
     C           #PAUPR    PARM #PAUPR    WQ0221 114       Unit Price Orde
     C                     PARM '**'      WQ0222  2        Event Called Fr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Reload Subfile user source
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * USER: Process subfile control (Post-confirm)
      * Copy files from qtemp
      * DEL Ship Detail Pricng RT - PD Ship Detail Pricing  * 
     C                     EXSR SYRVGN
      * CPY Ship Prc f/Qtmp    RT - PD Ship Detail Pricing  * 
     C                     EXSR TARVGN
      * DEL Ship Dtl Formula   RT - PD Ship Dtl Formula Dtl  * 
     C                     EXSR TCRVGN
      * CPY Shp Dtl Form f/QtmpRT - PD Ship Dtl Formula Dtl  * 
     C                     EXSR TERVGN
      * CLC Pricing using File XF - PD Ship Detail Pricing  * 
     C                     CALL 'PDOJXFR'              90  CLC Pricing usi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0223  30       Company Number
     C                     PARM #2C4NB    WQ0224  70       Order Number
     C                     PARM #2DPNB    WQ0225  30       Order Sequence
     C                     PARM #2UENB    WQ0226  30       Order Secondary
     C                     PARM #2PDSQ    WQ0227  30       Price Detail Se
     C                     PARM #PHGCD    WQ0228  70       Item Code
     C                     PARM #PQ7CD    WQ0229  3        Price Method Co
     C                     PARM #PAGCD    WQ0230  2        U/M - Ordered
     C           #PAKPR    PARM #PAKPR    WQ0231 114       Unit Price
     C           #PALPR    PARM #PALPR    WQ0232 114       Unit Price - Cr
     C           #PAUPR    PARM #PAUPR    WQ0233 114       Unit Price Orde
     C                     PARM '02'      WQ0234  2        Event Called Fr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *
     C                     MOVEL*BLANK    WN0044  2        UOM Pricing
     C                     Z-ADD*ZERO     WN0045 112       Unit Weight
     C                     MOVEL*BLANK    WN0046  1        Catch Weight St
     C                     MOVEL*BLANK    WN0047  6        Primal Group Co
     C                     Z-ADD*ZERO     WN0048 114       Price per Pound
     C                     Z-ADD*ZERO     WN0049 112       USR Quantity
     C                     Z-ADD*ZERO     WN0050 112       USR Weight
      *
      * CLC Price,Ext,U/M1Prc  IF
      * *****************************************************************
      * Calculate "Price Per Pound", "Extended Amount", "Primary U/M Pric
      * *****************************************************************
     C                     Z-ADD*ZERO     WN0045           Unit Weight
     C                     MOVEL*BLANK    WN0044           UOM Pricing
     C                     MOVEL*BLANK    WN0046           Catch Weight St
      * Load Quantity Shipped Total field. c2742- do -0- shipped from ord
      * CASE: PAR.Quantity Shipped Total is Equal to zero
     C           #PCBQT    IFEQ 0                          *IF
     C                     Z-ADD1         WUCBQT           Quantity Shippe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#PCBQT    WUCBQT           Quantity Shippe
     C                     END                             *FI
      * Set quantity and weight according to order status  c2742 -0- shpe
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : PAR.Event Code is Entered Thru 03 Picked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PGMST    IFEQ 'L'                        *IF
     C           #PGMST    OREQ 'A'
     C           #PGMST    OREQ 'E'
     C           #PGMST    OREQ 'H'
     C           #PJPCD    IFGE '01'                       *IF
     C           #PJPCD    ANDLE'03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 6/17/09 FP1054 use qty/wgt ordered instead of sched
     C                     Z-ADD#PAVQT    WN0049           USR Quantity
     C                     Z-ADD#PD0WG    WN0050           USR Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUCBQT    WN0049           USR Quantity
     C                     Z-ADD#PATWG    WN0050           USR Weight
     C                     END                             *FI
      * RTV For Price Extent   XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDXRXFR'              90  RTV For Price E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0235  30       Company Number
     C                     PARM #PHGCD    WQ0236  70       Item Code
     C           WN0044    PARM *BLANK    WQ0237  2        UOM Pricing
     C           WN0045    PARM *ZERO     WQ0238 112       Unit Weight
     C           WN0046    PARM *BLANK    WQ0239  1        Catch Weight St
     C           WN0047    PARM *BLANK    WQ0240  6        Primal Group Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check retrieve Unit Weight & C/W error
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : PAR.Catch Weight Status is Y/N Values
      *   |- c3    : PAR.Unit Weight is Not equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           WN0046    IFEQ 'N'                        *IF
     C           WN0046    OREQ 'Y'
     C           WN0045    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           *ZERO     IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL*ZERO     WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0057           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0057           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZA0058           Order Sequence
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0059           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0059           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVELWN0046    ZA0060           Catch Weight St
     C                     Z-ADD*ZERO     ZA0061           Unit Price
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2306' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
      * CASE: PAR.Price Method Code is Extended
     C           #PQ7CD    IFEQ 'EXT'                      *IF
     C                     Z-ADD#PBZPR    #PAYVA           Extended Amount
      * Calculate Unit Price for Extended
      * CASE: PAR.USR Weight is Not equal zero
     C           WN0050    IFNE 0                          *IF
     C           #PAYVA    DIV  WN0050    #PAKPR    H      Unit Price
     C                     END                             *FI
      * Calculate Pricing U/M Price for Extended
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0049    IFNE 0                          *IF
     C           #PAYVA    DIV  WN0049    #PAUPR    H      Unit Price Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Extend price with unit price credit if not zeros
      * CASE:
      *  - (c1 AND c2 AND c3 AND c5 AND c7)
      *   |- c1    : PAR.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : PAR.Event Code is Entered Thru 03 Picked
      *   |- c3    : PAR.Unit Price - Credit is Not Zeros
      *   |- c5    : PAR.Price Audit is Not Manually Price Audit
      *   |- c7    : PAR.Pricing Event Called From is No Price With Credi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PGMST    IFEQ 'L'                        *IF
     C           #PGMST    OREQ 'A'
     C           #PGMST    OREQ 'E'
     C           #PGMST    OREQ 'H'
     C           #PJPCD    IFGE '01'                       *IF
     C           #PJPCD    ANDLE'03'
     C           #PALPR    IFNE 0                          *IF
     C           #PU0ST    IFEQ 'A'                        *IF
     C           #PU0ST    OREQ 'N'
     C           #PU0ST    OREQ *BLANK
     C           'PM'      IFEQ 'OE'                       *IF
     C           'PM'      OREQ 'PS'
     C           'PM'      OREQ 'UWC'
     C           'PM'      OREQ 'UWT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 07/07/08 PKD Replaced w/consideration for .01 manual price
      * Extend Price using Price Overage Override or Unit Price-Credit
      * CASE: PAR.Price Method Code is Deviated
     C           #PQ7CD    IFEQ 'DEV'                      *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0241 112       Extended Amount
     C                     PARM WN0044    WQ0242  2        U/M - Base Pric
     C                     PARM WN0049    WQ0243 112       Quantity Shippe
     C                     PARM WN0050    WQ0244 112       Weight Shipped
     C                     PARM #PBZPR    WQ0245 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & HPB
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is High Plains Biodiesel
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PQ7CD    IFEQ 'MAN'                      *IF
     C           YL0003    IFEQ 'H'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0246 112       Extended Amount
     C                     PARM WN0044    WQ0247  2        U/M - Base Pric
     C                     PARM WN0049    WQ0248 112       Quantity Shippe
     C                     PARM WN0050    WQ0249 112       Weight Shipped
     C                     PARM #PBZPR    WQ0250 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & Not HPB
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is Not HPB
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PQ7CD    IFEQ 'MAN'                      *IF
     C           YL0003    IFEQ 'D'                        *IF
     C           YL0003    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override OR Unit Price-Credit
      * CASE: PS Cst | IC Cst | UNID Itm | OTHER Itm | >.01 Prc
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : PAR.Type Code is Inter Company
      *   |- c2    : PAR.Type Code is Is Promotional/Samples
      *   |- c3    : PAR.Primal Group Code is Samples or Cut Loss
      *   |- c4    : PAR.Primal Group Code is Other
      *   |- c5    : PAR.Price Overage Override is GT .01
      *   '-
     C           YL0001    IFEQ 'IC'                       *IF
     C           YL0001    OREQ 'PS'                       *OR
     C           WN0047    OREQ 'UNID'                     *OR
     C           WN0047    OREQ 'OTHER'                    *OR
     C           #PBZPR    ORGT .01                        *OR
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0251 112       Extended Amount
     C                     PARM WN0044    WQ0252  2        U/M - Base Pric
     C                     PARM WN0049    WQ0253 112       Quantity Shippe
     C                     PARM WN0050    WQ0254 112       Weight Shipped
     C                     PARM #PBZPR    WQ0255 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * ----- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0256 112       Extended Amount
     C                     PARM WN0044    WQ0257  2        U/M - Base Pric
     C                     PARM WN0049    WQ0258 112       Quantity Shippe
     C                     PARM WN0050    WQ0259 112       Weight Shipped
     C                     PARM #PALPR    WQ0260 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ---- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0261 112       Extended Amount
     C                     PARM WN0044    WQ0262  2        U/M - Base Pric
     C                     PARM WN0049    WQ0263 112       Quantity Shippe
     C                     PARM WN0050    WQ0264 112       Weight Shipped
     C                     PARM #PALPR    WQ0265 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 08/28/07 PKD Replaced with Clc OrdDtl Ext Amt    XF
      * 04/28/10 PKD If Unit Price is zero, then use Unit Price-Credit.
      * ** Added Not .01 to force these orders to use Credit Chk Price.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Unit Price is Not Zeros
      *   |- c2    : PAR.Unit Price is Not .01
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PAKPR    IFNE 0                          *IF
     C           #PAKPR    IFNE .01                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0266 112       Extended Amount
     C                     PARM WN0044    WQ0267  2        U/M - Base Pric
     C                     PARM WN0049    WQ0268 112       Quantity Shippe
     C                     PARM WN0050    WQ0269 112       Weight Shipped
     C                     PARM #PAKPR    WQ0270 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Unit Price Ordered U/M
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0049    IFNE 0                          *IF
     C           #PAYVA    DIV  WN0049    #PAUPR    H      Unit Price Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #PAYVA    PARM *ZERO     WQ0271 112       Extended Amount
     C                     PARM WN0044    WQ0272  2        U/M - Base Pric
     C                     PARM WN0049    WQ0273 112       Quantity Shippe
     C                     PARM WN0050    WQ0274 112       Weight Shipped
     C                     PARM #PALPR    WQ0275 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
      * CHG OM Price Maint     CH - Order Detail  * 
     C                     EXSR TGCHRC
      * CHG Ord  Prt,Prc Sts   CH - Order Header TRG  * 
     C                     EXSR THCHRC
      * If price status or unit price changes write to log
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Price Status NE WRK.Price Status Last
      *   |- c2    : CTL.Unit Price NE WRK.Unit Price Last
      *   '-
     C           #PU1ST    IFNE WUPSTL                     *IF
     C           #PAKPR    ORNE WUDBPR                     *OR
      * RTV Next Audit Seq #   RT - PD Price Change Audit Log  * 
     C                     EXSR TIRVGN
      * CRT Price Change Audit CR - PD Price Change Audit Log  * 
     C                     EXSR TJCRRC
     C                     END                             *FI
      * CLC Price/Price Audit  XF - Order Header TRG  * 
     C                     CALL 'PDPRXFR'              90  CLC Price/Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0283  30       Company Number
     C                     PARM #2C4NB    WQ0284  70       Order Number
     C                     PARM #2DPNB    WQ0285  30       Order Sequence
     C                     PARM #2UENB    WQ0286  30       Order Secondary
     C                     PARM 'PM'      WQ0287  3        Pricing Event C
     C           WUB5VL    PARM *ZERO     WQ0288 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0289 112       Order Weight To
     C           WUXJST    PARM WUXJST    WQ0290  1        Production Hold
     C                     PARM '*NO'     WQ0291  4        USR New Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      * USER: Final processing (Post-confirm)
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,38
     C                     SETOF                     98
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN78
     C           P8GGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           YL0013    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @IMPCZW0 fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDIMAIC3    #1AIC3           Company Number
     C                     Z-ADDIMC4NB    #1C4NB           Order Number
     C                     Z-ADDIMDPNB    #1DPNB           Order Sequence
     C                     Z-ADDIMUENB    #1UENB           Order Secondary
     C                     Z-ADDIMPDSQ    #1PDSQ           Price Detail Se
     C                     MOVELIMQ9CD    #1Q9CD           Price Method Co
     C                     MOVELIMU6ST    #1U6ST           PD Status
     C                     MOVELIMUVST    #1UVST           EDI Status 1
     C                     MOVELIMUWST    #1UWST           EDI Status 2
     C                     MOVELIMUXST    #1UXST           EDI Status 3
     C                     Z-ADDIMAATM    #1AATM           Job Time
     C                     MOVELIMAYNA    #1AYNA           User Id
     C                     MOVELIMA0NA    #1A0NA           Job Name
     C                     Z-ADDIMAXDT    #1AXDT           Job Date
     C                     Z-ADDIMBNPR    #1BNPR           Componant Price
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL*BLANK    #RMMNA           Price Componant
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADDP3TKDT    #PTKDT           OD Market Begin
     C                     Z-ADDP3TLDT    #PTLDT           OD Market Endin
     C                     Z-ADDP3D0WG    #PD0WG           Weight Ordered
     C                     MOVELP3F3SX    #PF3SX           Released by Use
     C                     MOVELP3F7SX    #PF7SX           OD Price Type
     C                     Z-ADDP3BVTM    #PBVTM           Price Code
     C                     MOVELP3GMST    #PGMST           Detail Line Sta
     C                     Z-ADDP3AUWG    #PAUWG           Weight Schedule
     C                     MOVELP3JPCD    #PJPCD           Event Code
     C                     MOVELP3RFCD    #PRFCD           Price Audit Rea
     C                     Z-ADDP2A0DT    #PA0DT           Order Date
     C                     Z-ADDP3ALPR    #PALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     #2PDSQ           Price Detail Se
     C                     Z-ADDP3AVQT    #PAVQT           Quantity Ordere
     C                     Z-ADDP3CCQT    #PCCQT           Quantity Schedu
     C                     Z-ADDP3BZPR    #PBZPR           Price Overage O
     C                     MOVELP3Q7CD    #PQ7CD           Price Method Co
     C                     MOVELP3RDCD    #PRDCD           Date Method Cod
     C                     Z-ADDP3L6NB    #PL6NB           Contract Number
     C                     Z-ADDP3EXDT    #PEXDT           Market Pricing
     C                     MOVELP3LQCD    #PLQCD           Commodity Marke
     C                     Z-ADD*ZERO     #CDWPR           OD Ceiling Pric
     C                     MOVELP3U0ST    #PU0ST           Price Audit
     C                     MOVEL*BLANK    #CNCNA           USR Desc. 10
     C                     MOVELP3U1ST    #PU1ST           Price Status
     C                     MOVEL*BLANK    #CJUNA           USR Description
     C                     Z-ADD*ZERO     #CEIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     VCEIDT
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #CAPTX           Company Name
     C                     Z-ADDP2A5DT    #PA5DT           Requested Ship
      * Clear external version also
     C                     Z-ADD*ZERO     VPA5DT
     C                     Z-ADDP2BKC7    #PBKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    VPBKC7
     C                     MOVELP2BRTX    #PBRTX           Ship To Name
     C                     Z-ADD*ZERO     #CHODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     VCHODT
     C                     Z-ADDP1C4NB    #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     MOVELP2JNCD    #PJNCD           Order Type - Sa
     C                     MOVEL*BLANK    #CHNNA           Ship To City
     C                     MOVEL*BLANK    #CDBCD           Ship To State C
     C                     Z-ADDP2GNDT    #PGNDT           Actual Shipped
      * Clear external version also
     C                     Z-ADD*ZERO     VPGNDT
     C                     Z-ADDP1DPNB    #2DPNB           Order Sequence
     C                     Z-ADDP1UENB    #2UENB           Order Secondary
     C                     MOVEL*BLANK    #CBCNA           Customer Purcha
     C                     Z-ADDP3AUPR    #PAUPR           Unit Price Orde
     C                     MOVELP3AGCD    #PAGCD           U/M - Ordered
     C                     Z-ADDP3HGCD    #PHGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    VPHGCD
     C                     MOVELP3AJCD    #PAJCD           Warehouse Code
     C                     Z-ADDP3AKPR    #PAKPR           Unit Price
     C                     MOVELP3CRCD    #PCRCD           U/M - Base Pric
     C                     MOVELP3G7NA    #PG7NA           Order Desc. Lin
     C                     Z-ADDP3AVWG    #PAVWG           Unit Weight Ord
     C                     MOVEL*BLANK    #CMTTX           Field Descripti
     C                     Z-ADDP3CBQT    #PCBQT           Quantity Shippe
     C                     Z-ADDP3AYVA    #PAYVA           Extended Amount
     C                     Z-ADDP3ATWG    #PATWG           Weight Shipped
     C                     Z-ADD*ZERO     #CTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     #CCLPR           Price Overage O
     C                     MOVEL*BLANK    #CTKCD           Price Method Co
     C                     Z-ADD*ZERO     #CUYNX           Price Code USR
     C                     Z-ADD*ZERO     #CCNBR           Contract Number
     C                     MOVEL*BLANK    #CTLCD           Date Method Cod
     C                     Z-ADD*ZERO     #CG2DT           Market Pricing
      * Clear external version also
     C                     Z-ADD*ZERO     VCG2DT
     C                     Z-ADD*ZERO     #CGIDT           Pricing Date Us
      * Clear external version also
     C                     Z-ADD*ZERO     VCGIDT
     C                     MOVEL*BLANK    #CTMCD           Commodity Marke
     C                     MOVEL*BLANK    #CJ3NA           Commodity Marke
     C                     Z-ADD*ZERO     #CDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     #CDYPR           OD Weighted Avg
      * Check restriction within
     C                     EXSR VACKRL
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #CEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCEIDT
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #PA5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VPA5DT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VPBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VPBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #CHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCHODT
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  #PGNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VPGNDT
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VPHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VPHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Market Pricing Date USR to display format
      * Convert date
     C           1000000   ADD  #CG2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCG2DT
      * Convert Pricing Date Used to display format
      * Convert date
     C           1000000   ADD  #CGIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCGIDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#2AIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CAPTX           Name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    #CAPTX           Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Commod. Mkts Desc  RT - Commodity Markets  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           FYLQCD           Commodity Marke
      * Setup key
     C                     MOVELWL0001    FYLQCD           Commodity Marke
      * Establish starting position
     C           KRSSB     CHAIN@FYREDK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1218' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Commodity Marke
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFYJ3NA    WL0002           Commodity Marke
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * VAL Ship Detail Seq    RT - Order Detail Pricing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSC02           Order Number
     C           *LIKE     DEFN WADPNB    WQSC03           Order Sequence
     C           *LIKE     DEFN WAUENB    WQSC04           Order Secondary
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WQSC03           Order Sequence
     C                     KFLD           WQSC04           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    WQSC01           Company Number
     C                     Z-ADD#2C4NB    WQSC02           Order Number
     C                     Z-ADD#2DPNB    WQSC03           Order Sequence
     C                     Z-ADD#2UENB    WQSC04           Order Secondary
      * Establish starting position
     C           KRSSC     SETLL@IMCPSE                    *
     C           KRSSC     READE@IMCPSE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1675' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C           KRSSC     READE@IMCPSE                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0003    EOAIC3           Company Number
     C                     Z-ADDWL0004    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           Type Code
     C                     Z-ADD*ZERO     WL0006           Absorbed Freigh
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOBOCD    WL0005           Type Code
     C                     Z-ADDEOTBNB    WL0006           Absorbed Freigh
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Absorbed Frt Rate RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0009           Absorbed Freigh
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0007    BEAIC3           Company Number
     C                     Z-ADDWL0008    BEC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBETBNB    WL0009           Absorbed Freigh
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           JYAIC3           Company Number
      * Setup key
     C                     Z-ADD#2AIC3    JYAIC3           Company Number
      * Establish starting position
     C           KRSSF     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Company Organiz
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJYYJSX    YL0003           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Gate Price        RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSG01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSG02           Order Number
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    WQSG01           Company Number
     C                     Z-ADD#2C4NB    WQSG02           Order Number
      * Establish starting position
     C           KRSSG     SETLL@BGWKFW                    *
     C           KRSSG     READE@BGWKFW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #CDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     #CDYPR           OD Weighted Avg
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Order Gate Price is Not Zeros
     C           OMDVPR    IFNE 0                          *IF
      * PAR = DB1 By name
     C                     Z-ADDOMDVPR    #CDVPR           Order Gate/Fina
     C                     Z-ADDOMDYPR    #CDYPR           OD Weighted Avg
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSG     READE@BGWKFW                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Val Manual Price      RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0010    BZAIC3           Company Number
     C                     Z-ADDWL0011    BZHGCD           Item Code
      * Establish starting position
     C           KRSSH     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0012           Description Lin
     C                     MOVEL*BLANK    WL0013           Default Commod
     C                     Z-ADD*ZERO     WL0014           Market Overage
     C                     Z-ADD*ZERO     WL0015           Standard Overag
     C                     MOVEL*BLANK    WL0016           Commodity Price
     C                     Z-ADD*ZERO     WL0017           Std Weight_Head
     C                     MOVEL*BLANK    WL0018           Primal Group Co
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WL0012           Description Lin
     C                     MOVELBZLNCD    WL0013           Default Commod
     C                     Z-ADDBZBLPR    WL0014           Market Overage
     C                     Z-ADDBZBMPR    WL0015           Standard Overag
     C                     MOVELBZLRCD    WL0016           Commodity Price
     C                     Z-ADDBZSWGH    WL0017           Std Weight_Head
     C                     MOVELBZXRCD    WL0018           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Manual Price Accpt RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           ASAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0019    ASAIC3           Company Number
      * Establish starting position
     C           KRSSI     CHAIN@ASREVL              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0049' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0020           Manual Price Ac
     C                     Z-ADD*ZERO     WL0021           CoPk/FdSrv ManP
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDASAIPC    WL0020           Manual Price Ac
     C                     Z-ADDASASPC    WL0021           CoPk/FdSrv ManP
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN F0LQCD    WQSJ01           Commodity Marke
     C           *LIKE     DEFN F0LRCD    WQSJ02           Commodity Price
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Commodity Marke
     C                     KFLD           WQSJ02           Commodity Price
     C                     KFLD           F0EQDT           Market Price Da
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Commodity Marke
     C                     KFLD           WQSJ02           Commodity Price
      * Setup key
     C                     MOVELWL0022    WQSJ01           Commodity Marke
     C                     MOVELWL0023    WQSJ02           Commodity Price
     C                     Z-ADDWL0024    F0EQDT           Market Price Da
      * Establish starting position
     C           KPSSJ     SETLL@F0CPEP                    *
     C           KRSSJ     READE@F0CPEP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0025           Commodity Marke
     C                     Z-ADD*ZERO     WL0026           USR Date Priced
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDF0A5PR    WL0025           Commodity Marke
     C                     Z-ADDF0EQDT    WL0026           USR Date Priced
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@F0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Req Delv/Hdr Sts  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    BEAIC3           Company Number
     C                     Z-ADD#2C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSK     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEGWST    WUGWST           Header Status
     C                     Z-ADDBEEIDT    #CEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    WUAFTM           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Price Meth Type    RT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           IHAIC3           Company Number
     C                     KFLD           IHQ7CD           Price Method Co
      * Setup key
     C                     Z-ADDWL0027    IHAIC3           Company Number
     C                     MOVELWL0028    IHQ7CD           Price Method Co
      * Establish starting position
     C           KRSSL     CHAIN@IHRERN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0029           Price Method Ty
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELIHV8ST    WL0029           Price Method Ty
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * VAL Check Existence    RT - PD Price Method Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN IKAIC3    WQSM01           Company Number
     C           *LIKE     DEFN IKQ7CD    WQSM02           Price Method Co
     C           *LIKE     DEFN IKQ9CD    WQSM04           Price Method Co
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Price Method Co
     C                     KFLD           WQSM04           Price Method Co
      * Setup key
     C                     Z-ADD#1AIC3    WQSM01           Company Number
     C                     MOVEL#PQ7CD    WQSM02           Price Method Co
     C                     MOVEL#1Q9CD    WQSM04           Price Method Co
      * Establish starting position
     C           KRSSM     SETLL@IKREL2                    *
     C           KRSSM     READE@IKREL2                  90*
      * Data record not found
     C   90                MOVEL'USR1671' W0RTN   7
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Description        RT - Price Method Componant  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           IJAIC3           Company Number
     C                     KFLD           IJQ9CD           Price Method Co
      * Setup key
     C                     Z-ADD#1AIC3    IJAIC3           Company Number
     C                     MOVEL#1Q9CD    IJQ9CD           Price Method Co
      * Establish starting position
     C           KRSSN     CHAIN@IJRER7              90    *
      * Data record not found
     C   90                MOVEL'USR1669' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELIJMMNA    #RMMNA           Price Componant
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Contract Defaults  RT - OPP Item Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN CIL6NB    WQSO01           Contract Number
     C           *LIKE     DEFN CIAIC3    WQSO02           Company Number
     C           *LIKE     DEFN CIBKC7    WQSO03           Ship To Custome
     C           *LIKE     DEFN CIHGCD    WQSO04           Item Code
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Contract Number
     C                     KFLD           WQSO02           Company Number
     C                     KFLD           WQSO03           Ship To Custome
     C                     KFLD           WQSO04           Item Code
      * Setup key
     C                     Z-ADD#CCNBR    WQSO01           Contract Number
     C                     Z-ADD#2AIC3    WQSO02           Company Number
     C                     Z-ADD#PBKC7    WQSO03           Ship To Custome
     C                     Z-ADD#PHGCD    WQSO04           Item Code
      * Establish starting position
     C           KRSSO     SETLL@CIREWO                    *
     C           KRSSO     READE@CIREWO                  90*
      * Data record not found
     C   90                MOVEL'USR0463' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELCIAUNA    #PG7NA           Description
     C                     Z-ADDCIB0PR    #CCLPR           Contract Price
     C                     Z-ADDCIGBDT    #CG2DT           Contract Mkt Pr
     C                     MOVELCIRDCD    #CTLCD           Date Method Cod
     C                     MOVELCIQ7CD    #CTKCD           Price Method Co
     C                     MOVELCIRQCD    #CTMCD           Dft Commodity M
     C           KRSSO     READE@CIREWO                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * VAL Price Meth Exists  RT - PD Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBYST    WQSP01           System Using Pr
     C           *LIKE     DEFN WBAIC3    WQSP02           Company Number
     C           *LIKE     DEFN WBQ7CD    WQSP03           Price Method Co
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           System Using Pr
     C                     KFLD           WQSP02           Company Number
     C                     KFLD           WQSP03           Price Method Co
      * Setup key
     C                     MOVEL'O'       WQSP01           System Using Pr
     C                     Z-ADD#2AIC3    WQSP02           Company Number
     C                     MOVEL#CTKCD    WQSP03           Price Method Co
      * Establish starting position
     C           KRSSP     SETLL@IHREFI                    *
     C           KRSSP     READE@IHREFI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Price Method De
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBMLNA    WUG0TX           Price Method De
     C           KRSSP     READE@IHREFI                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * VAL Date Method Exists RT - Market Date Method  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN IPBXST    WQSQ01           System using Da
     C           *LIKE     DEFN IPAIC3    WQSQ02           Company Number
     C           *LIKE     DEFN IPRDCD    WQSQ03           Date Method Cod
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           System using Da
     C                     KFLD           WQSQ02           Company Number
     C                     KFLD           WQSQ03           Date Method Cod
      * Setup key
     C                     MOVEL'O'       WQSQ01           System using Da
     C                     Z-ADD#2AIC3    WQSQ02           Company Number
     C                     MOVEL#CTLCD    WQSQ03           Date Method Cod
      * Establish starting position
     C           KRSSQ     SETLL@IPREFJ                    *
     C           KRSSQ     READE@IPREFJ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1681' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Date Method Des
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELIPMNNA    WUG0TX           Date Method Des
     C           KRSSQ     READE@IPREFJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Prc Mth Typ by Sys RT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBYST    WQSR01           System Using Pr
     C           *LIKE     DEFN WBAIC3    WQSR02           Company Number
     C           *LIKE     DEFN WBQ7CD    WQSR03           Price Method Co
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           System Using Pr
     C                     KFLD           WQSR02           Company Number
     C                     KFLD           WQSR03           Price Method Co
      * Setup key
     C                     MOVEL'O'       WQSR01           System Using Pr
     C                     Z-ADD#2AIC3    WQSR02           Company Number
     C                     MOVEL#CTKCD    WQSR03           Price Method Co
      * Establish starting position
     C           KRSSR     SETLL@IHREFI                    *
     C           KRSSR     READE@IHREFI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUV8ST           Price Method Ty
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBV8ST    WUV8ST           Price Method Ty
     C           KRSSR     READE@IHREFI                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Edt for Existing   RT - OPP Item Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSS01           Company Number
     C           *LIKE     DEFN WCBKC7    WQSS02           Ship To Custome
     C           *LIKE     DEFN WCHGCD    WQSS03           Item Code
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WQSS02           Ship To Custome
     C                     KFLD           WQSS03           Item Code
      * Setup key
     C                     Z-ADD#2AIC3    WQSS01           Company Number
     C                     Z-ADD#PBKC7    WQSS02           Ship To Custome
     C                     Z-ADD#PHGCD    WQSS03           Item Code
      * Establish starting position
     C           KRSSS     SETLL@CIREWP                    *
     C           KRSSS     READE@CIREWP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0463' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Effective Date GE DB1.Effective Date
      *   |- c2    : PAR.Effective Date LE DB1.End Date Effective
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PA0DT    IFGE WCAUDT                     *IF
     C           #PA0DT    IFLE WCCWDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END                             *FI
     C                     Z-ADDWCL6NB    WUCNBR           Contract Number
     C           KRSSS     READE@CIREWP                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Val. Contract #    RT - OPP Item Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN CIL6NB    WQST01           Contract Number
     C           *LIKE     DEFN CIAIC3    WQST02           Company Number
     C           *LIKE     DEFN CIBKC7    WQST03           Ship To Custome
     C           *LIKE     DEFN CIHGCD    WQST04           Item Code
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Contract Number
     C                     KFLD           WQST02           Company Number
     C                     KFLD           WQST03           Ship To Custome
     C                     KFLD           WQST04           Item Code
      * Setup key
     C                     Z-ADDWUCNBR    WQST01           Contract Number
     C                     Z-ADD#2AIC3    WQST02           Company Number
     C                     Z-ADD#PBKC7    WQST03           Ship To Custome
     C                     Z-ADD#PHGCD    WQST04           Item Code
      * Establish starting position
     C           KRSST     SETLL@CIREWO                    *
     C           KRSST     READE@CIREWO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0463' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDCIAUDT    WN0012           Effective Date
     C                     Z-ADDCICWDT    WN0013           End Date Effect
     C                     Z-ADDCIDQQT    WN0014           Maximum Quantit
     C                     Z-ADDCIHFQT    WN0015           Quantity Sold
     C           KRSST     READE@CIREWO                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDLQCD    WQSU01           Commodity Marke
     C           *LIKE     DEFN WDLRCD    WQSU02           Commodity Price
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Commodity Marke
     C                     KFLD           WQSU02           Commodity Price
      * Setup key
     C                     MOVELWL0030    WQSU01           Commodity Marke
     C                     MOVELWL0031    WQSU02           Commodity Price
      * Establish starting position
     C           KRSSU     SETLL@F0CPVR                    *
     C           KRSSU     READE@F0CPVR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SUEXIT                     *QUIT
     C           KRSSU     READE@F0CPVR                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Cust Prc Str/End  RT - Customer Price Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN C6BKC7    WQSV01           Ship To Custome
     C           *LIKE     DEFN C6BVTM    WQSV02           Price Code
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Ship To Custome
     C                     KFLD           WQSV02           Price Code
      * Setup key
     C                     Z-ADD#PBKC7    WQSV01           Ship To Custome
     C                     Z-ADD#CUYNX    WQSV02           Price Code
      * Establish starting position
     C           KRSSV     SETLL@C6REMM                    *
     C           KRSSV     READE@C6REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3290' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0017           Price Start Dat
     C                     Z-ADD*ZERO     YL0018           Price End Date
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDC6PLDT    YL0017           Price Start Dat
     C                     Z-ADDC6PMDT    YL0018           Price End Date
     C           KRSSV     READE@C6REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Max Wt and price  RT - Customer Price Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           C7BKC7           Ship To Custome
     C                     KFLD           C7BVTM           Price Code
     C                     KFLD           C7HGCD           Item Code
      * Setup key
     C                     Z-ADD#PBKC7    C7BKC7           Ship To Custome
     C                     Z-ADD#CUYNX    C7BVTM           Price Code
     C                     Z-ADD#PHGCD    C7HGCD           Item Code
      * Establish starting position
     C           KRSSW     CHAIN@C7RESR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3292' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0019           Maximum Contrac
     C                     Z-ADD*ZERO     YL0020           Customer Price
     C                     MOVEL*BLANK    YL0021           Commodity Marke
     C                     MOVEL*BLANK    YL0022           Price Method Co
     C                     MOVEL*BLANK    YL0023           Date Method Cod
     C                     MOVEL*BLANK    YL0024           Contract Unit T
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDC7KWWG    YL0019           Maximum Contrac
     C                     Z-ADDC7FIPR    YL0020           Customer Price
     C                     MOVELC7LQCD    YL0021           Commodity Marke
     C                     MOVELC7Q7CD    YL0022           Price Method Co
     C                     MOVELC7RDCD    YL0023           Date Method Cod
     C                     MOVELC7QNSX    YL0024           Contract Unit T
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SWEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           IHAIC3           Company Number
     C                     KFLD           IHQ7CD           Price Method Co
      * Setup key
     C                     Z-ADD#2AIC3    IHAIC3           Company Number
     C                     MOVELYL0028    IHQ7CD           Price Method Co
      * Establish starting position
     C           KRSSX     CHAIN@IHRERN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0025           Price Method Ty
     C                     MOVEL*BLANK    YL0026           PMH Price Type
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELIHV8ST    YL0025           Price Method Ty
     C                     MOVELIHH3ST    YL0026           PMH Price Type
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * DEL Ship Detail Pricng RT - PD Ship Detail Pricing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSY01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSY02           Order Number
     C           *LIKE     DEFN WADPNB    WQSY03           Order Sequence
     C           *LIKE     DEFN WAUENB    WQSY04           Order Secondary
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Company Number
     C                     KFLD           WQSY02           Order Number
     C                     KFLD           WQSY03           Order Sequence
     C                     KFLD           WQSY04           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    WQSY01           Company Number
     C                     Z-ADD#2C4NB    WQSY02           Order Number
     C                     Z-ADD#2DPNB    WQSY03           Order Sequence
     C                     Z-ADD#2UENB    WQSY04           Order Secondary
      * Establish starting position
     C           KRSSY     SETLL@IMCPSE                    *
     C           KRSSY     READE@IMCPSE                  90*
      * Data record not found
     C   90                MOVEL'USR1675' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DEL Ship Detail Pricng DL - PD Ship Detail Pricing  * 
     C                     EXSR SZDLRC
     C           KRSSY     READE@IMCPSE                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZDLRC    BEGSR
      *================================================================
      * DEL Ship Detail Pricng DL - PD Ship Detail Pricing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @IMCPSD
     C                     Z-ADDWAAIC3    WEAIC3           Company Number
     C                     Z-ADDWAC4NB    WEC4NB           Order Number
     C                     Z-ADDWADPNB    WEDPNB           Order Sequence
     C                     Z-ADDWAUENB    WEUENB           Order Secondary
     C                     MOVELWAQ9CD    WEQ9CD           Price Method Co
      *
     C           KLDLSZ    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEQ9CD           Price Method Co
     C           KLDLSZ    CHAIN@IMCPSD              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDIMCPL0'MDACP
     C                     MOVEL'@IMCPSD' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@IMCPSD                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * CPY Ship Prc f/Qtmp    RT - PD Ship Detail Pricing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQTA01           Company Number
     C           *LIKE     DEFN WFC4NB    WQTA02           Order Number
     C           *LIKE     DEFN WFDPNB    WQTA03           Order Sequence
     C           *LIKE     DEFN WFUENB    WQTA04           Order Secondary
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Company Number
     C                     KFLD           WQTA02           Order Number
     C                     KFLD           WQTA03           Order Sequence
     C                     KFLD           WQTA04           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    WQTA01           Company Number
     C                     Z-ADD#2C4NB    WQTA02           Order Number
     C                     Z-ADD#2DPNB    WQTA03           Order Sequence
     C                     Z-ADD#2UENB    WQTA04           Order Secondary
      * Establish starting position
     C           KRSTA     SETLL@IMCPZ5                    *
     C           KRSTA     READE@IMCPZ5                  90*
      * Data record not found
     C   90                MOVEL'USR1675' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT Ship Price Detail  CR - PD Ship Detail Pricing  * 
     C                     EXSR TBCRRC
     C           KRSTA     READE@IMCPZ5                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCRRC    BEGSR
      *================================================================
      * CRT Ship Price Detail  CR - PD Ship Detail Pricing  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0036  60       Job Time
     C                     MOVEL*BLANK    WN0037 10        User Id
     C                     MOVEL*BLANK    WN0038 10        Job Name
     C                     Z-ADD*ZERO     WN0039  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @IMCPSD
     C                     Z-ADDWFAIC3    WEAIC3           Company Number
     C                     Z-ADDWFC4NB    WEC4NB           Order Number
     C                     Z-ADDWFDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWFUENB    WEUENB           Order Secondary
     C                     MOVELWFQ9CD    WEQ9CD           Price Method Co
     C                     Z-ADDWFPDSQ    WEPDSQ           Price Detail Se
     C                     Z-ADDWFBNPR    WEBNPR           Componant Price
     C                     MOVELWFU6ST    WEU6ST           PD Status
     C                     MOVELWFUVST    WEUVST           EDI Status 1
     C                     MOVELWFUWST    WEUWST           EDI Status 2
     C                     MOVELWFUXST    WEUXST           EDI Status 3
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRTB    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEQ9CD           Price Method Co
      * Check for duplicate primary key
     C           KLCRTB    SETLL@IMCPSD                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1676' W0RTN   7
      * Send message 'Order Detail Pricing   EX'
     C                     MOVEL'USR1676' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C                     WRITE@IMCPSD                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * DEL Ship Dtl Formula   RT - PD Ship Dtl Formula Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN JKAIC3    WQTC01           Company Number
     C           *LIKE     DEFN JKC4NB    WQTC02           Order Number
     C           *LIKE     DEFN JKDPNB    WQTC03           Order Sequence
     C           *LIKE     DEFN JKUENB    WQTC04           Order Secondary
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Company Number
     C                     KFLD           WQTC02           Order Number
     C                     KFLD           WQTC03           Order Sequence
     C                     KFLD           WQTC04           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    WQTC01           Company Number
     C                     Z-ADD#2C4NB    WQTC02           Order Number
     C                     Z-ADD#2DPNB    WQTC03           Order Sequence
     C                     Z-ADD#2UENB    WQTC04           Order Secondary
      * Establish starting position
     C           KRSTC     SETLL@JKCPYF                    *
     C           KRSTC     READE@JKCPYF                  90*
      * Data record not found
     C   90                MOVEL'USR1870' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DEL Ship Dtl Formula   DL - PD Ship Dtl Formula Dtl  * 
     C                     EXSR TDDLRC
     C           KRSTC     READE@JKCPYF                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDDLRC    BEGSR
      *================================================================
      * DEL Ship Dtl Formula   DL - PD Ship Dtl Formula Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @JKCPYE
     C                     Z-ADDJKAIC3    WGAIC3           Company Number
     C                     Z-ADDJKC4NB    WGC4NB           Order Number
     C                     Z-ADDJKDPNB    WGDPNB           Order Sequence
     C                     Z-ADDJKUENB    WGUENB           Order Secondary
     C                     MOVELJKQ9CD    WGQ9CD           Price Method Co
     C                     Z-ADDJKHGCD    WGHGCD           Item Code
     C                     Z-ADDJKZXNB    WGZXNB           Pricing Sequenc
      *
     C           KLDLTD    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGQ9CD           Price Method Co
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGZXNB           Pricing Sequenc
     C           KLDLTD    CHAIN@JKCPYE              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJKCPL0'MDACP
     C                     MOVEL'@JKCPYE' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@JKCPYE                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * CPY Shp Dtl Form f/QtmpRT - PD Ship Dtl Formula Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQTE01           Company Number
     C           *LIKE     DEFN WHC4NB    WQTE02           Order Number
     C           *LIKE     DEFN WHDPNB    WQTE03           Order Sequence
     C           *LIKE     DEFN WHUENB    WQTE04           Order Secondary
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           Company Number
     C                     KFLD           WQTE02           Order Number
     C                     KFLD           WQTE03           Order Sequence
     C                     KFLD           WQTE04           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    WQTE01           Company Number
     C                     Z-ADD#2C4NB    WQTE02           Order Number
     C                     Z-ADD#2DPNB    WQTE03           Order Sequence
     C                     Z-ADD#2UENB    WQTE04           Order Secondary
      * Establish starting position
     C           KRSTE     SETLL@JKCPZ7                    *
     C           KRSTE     READE@JKCPZ7                  90*
      * Data record not found
     C   90                MOVEL'USR1870' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT Ship Dtl Formula   CR - Order Dtl Formula Dtl  * 
     C                     EXSR TFCRRC
     C           KRSTE     READE@JKCPZ7                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCRRC    BEGSR
      *================================================================
      * CRT Ship Dtl Formula   CR - Order Dtl Formula Dtl  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0040  60       Job Time
     C                     MOVEL*BLANK    WN0041 10        User Id
     C                     MOVEL*BLANK    WN0042 10        Job Name
     C                     Z-ADD*ZERO     WN0043  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @JKCPYE
     C                     Z-ADDWHAIC3    WGAIC3           Company Number
     C                     Z-ADDWHC4NB    WGC4NB           Order Number
     C                     Z-ADDWHDPNB    WGDPNB           Order Sequence
     C                     Z-ADDWHUENB    WGUENB           Order Secondary
     C                     MOVELWHQ9CD    WGQ9CD           Price Method Co
     C                     Z-ADDWHHGCD    WGHGCD           Item Code
     C                     Z-ADDWHZXNB    WGZXNB           Pricing Sequenc
     C                     Z-ADDWHBOPR    WGBOPR           Sales Yield
     C                     Z-ADDWHCDPR    WGCDPR           Market Value
     C                     Z-ADDWHCEPR    WGCEPR           Credit Value
     C                     MOVELWHU6ST    WGU6ST           PD Status
     C                     MOVELWHUVST    WGUVST           EDI Status 1
     C                     MOVELWHUWST    WGUWST           EDI Status 2
     C                     MOVELWHUXST    WGUXST           EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C           KLCRTF    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGQ9CD           Price Method Co
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGZXNB           Pricing Sequenc
      * Check for duplicate primary key
     C           KLCRTF    SETLL@JKCPYE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1871' W0RTN   7
      * Send message 'Order Dtl Formula Dtl  EX'
     C                     MOVEL'USR1871' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C                     WRITE@JKCPYE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCHRC    BEGSR
      *================================================================
      * CHG OM Price Maint     CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0051  70       Item Code
     C                     MOVEL*BLANK    WN0052  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0053  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0054  70       Order Group Cod
     C                     MOVEL*BLANK    WN0055  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0056  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0057 112       Billing Detail
     C                     Z-ADD*ZERO     WN0058 112       Billing Detail
     C                     Z-ADD*ZERO     WN0059 112       Billing Detail
     C                     Z-ADD*ZERO     WN0060 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0061  1        Comment Print A
     C                     MOVEL*BLANK    WN0062  1        Comment Print I
     C                     MOVEL*BLANK    WN0063  1        Comment Print P
     C                     MOVEL*BLANK    WN0064  1        Comment Print S
     C                     Z-ADD*ZERO     WN0065  70       Contract Number
     C                     MOVEL*BLANK    WN0066  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0067  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0068  1        Work Confirm St
     C                     MOVEL*BLANK    WN0069  1        Work Over/Short
     C                     MOVEL*BLANK    WN0070  1        OD Production P
     C                     MOVEL*BLANK    WN0071 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0072 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0073  1        Age Code
     C                     MOVEL*BLANK    WN0074  1        Palletize
     C                     MOVEL*BLANK    WN0075  1        Slip Sheet
     C                     MOVEL*BLANK    WN0076  1        Catch Weight St
     C                     MOVEL*BLANK    WN0077  1        Price Audit
     C                     MOVEL*BLANK    WN0078  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0079  1        Production Date
     C                     Z-ADD*ZERO     WN0080 112       Rated Freight
     C                     Z-ADD*ZERO     WN0081 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0082 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0083 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0084 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0085 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0086 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0087 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0088 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0089 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0090 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0091 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0092  70       Requested Ship
     C                     Z-ADD*ZERO     WN0093  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0094  70       Actual Shipped
     C                     MOVEL*BLANK    WN0095  1        Affect Inventor
     C                     MOVEL*BLANK    WN0096  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0097  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0098  30       Item Structure
     C                     Z-ADD*ZERO     WN0099  30       Item Structure
     C                     Z-ADD*ZERO     WN0100  30       Item Structure
     C                     MOVEL*BLANK    WN0101  2        Item Level
     C                     MOVEL*BLANK    WN0102  2        Quality Level
     C                     MOVEL*BLANK    WN0103  2        Pricing Product
     C                     MOVEL*BLANK    WN0104  2        Season Product
     C                     MOVEL*BLANK    WN0105 10        User Profile Na
     C                     MOVEL*BLANK    WN0106  6        Country Code
     C                     MOVEL*BLANK    WN0107  2        Event Code
     C                     MOVEL*BLANK    WN0108  3        Reason Code
     C                     MOVEL*BLANK    WN0109  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0110  1        Modified Flag
     C                     MOVEL*BLANK    WN0111  1        Substituted Fla
     C                     MOVEL*BLANK    WN0112  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0113 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0114 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0115  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0116  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0117  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0118  1        Affect Commissi
     C                     MOVEL*BLANK    WN0119  1        Affect Pricing
     C                     MOVEL*BLANK    WN0120  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0121  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0122  3        Production Ware
     C                     Z-ADD*ZERO     WN0123  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0124  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0125  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0126  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0127  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0128  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0129  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0130  60       Substitution Li
     C                     Z-ADD*ZERO     WN0131  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0132 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0133 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0134 112       OD Item Target
     C                     Z-ADD*ZERO     WN0135 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0136 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0137 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0138 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0139 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0140 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0141 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0142 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0143 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0144  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0145  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0146  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0147 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0148  40       Item Age Days
     C                     Z-ADD*ZERO     WN0149  70       Production Ovr
     C                     Z-ADD*ZERO     WN0150  70       Production Ovr
     C                     MOVEL*BLANK    WN0151  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0152  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0153  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0154  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0155  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0156  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0157  1        EDI Status 1
     C                     MOVEL*BLANK    WN0158  1        EDI Status 2
     C                     MOVEL*BLANK    WN0159  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0160  60       Job Time
     C                     MOVEL*BLANK    WN0161 10        User Id
     C                     MOVEL*BLANK    WN0162 10        Job Name
     C                     Z-ADD*ZERO     WN0163  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADD#2AIC3    WIAIC3           Company Number
     C                     Z-ADD#2C4NB    WIC4NB           Order Number
     C                     Z-ADD#2DPNB    WIDPNB           Order Sequence
     C                     Z-ADD#2UENB    WIUENB           Order Secondary
      *
     C           KLCHTG    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C           KLCHTG    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * USER: Processing after Data read
      * E2247 RMC 10/03/12 Crt chg log if dtl has been sent to MPR USDA
      * CASE: DB1.OD MPR Sent to USDA Sts is yes
     C           WIHOST    IFEQ 'Y'                        *IF
      * If price type changes, then create type: ORDPRT
      * CASE: DB1.OD Price Type NE PAR.OD Price Type
     C           WIF7SX    IFNE #PF7SX                     *IF
      * change log prior has seq in pos 1-3, price type 5-7: '001 NEG
     C                     MOVELWIDPNB    YL0030           Text 3 Length U
     C                     Z-ADD1         ZQ      50
     C           YL0030    CAT  WIF7SX:ZQ YL0031    P      Change Log Prio
     C                     MOVEL*BLANK    YL0032           Change Log New
     C                     MOVEL#PF7SX    YL0032           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0276  70       Load ID
     C                     PARM 'ORDPRT'  WQ0277  6        Load Change Typ
     C                     PARM 'SLS'     WQ0278  3        Department Cont
     C                     PARM YL0031    WQ0279 12        Change Log Prio
     C                     PARM YL0032    WQ0280 12        Change Log New
     C                     PARM WIAIC3    WQ0281  30       Company Number
     C                     PARM WIC4NB    WQ0282  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Move non-key fields to @BGWKL0
     C                     Z-ADD#PAYVA    WIAYVA           Extended Amount
     C                     Z-ADD#PEXDT    WIEXDT           Market Pricing
     C                     MOVEL#PLQCD    WILQCD    P      Commodity Marke
     C                     MOVEL#PRDCD    WIRDCD    P      Date Method Cod
     C                     MOVEL#PQ7CD    WIQ7CD    P      Price Method Co
     C                     Z-ADD#PBZPR    WIBZPR           Price Overage O
     C                     MOVEL#PU1ST    WIU1ST    P      Price Status
     C                     Z-ADDWUGIDT    WIGIDT           Pricing Date Us
     C                     Z-ADD#PAKPR    WIAKPR           Unit Price
     C                     Z-ADD#PAUPR    WIAUPR           Unit Price Orde
     C                     Z-ADDP2CXDT    WICXDT           Date of Origina
     C                     MOVEL#PF3SX    WIF3SX    P      Released by Use
     C                     MOVEL#PF7SX    WIF7SX    P      OD Price Type
     C                     Z-ADD#PBVTM    WIBVTM           Price Code
     C                     Z-ADD#CDVPR    WIDVPR           Order Gate/Fina
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WIAATM' defaulted for 'Job Time'.
      * Field '(DB1) WIAYNA' defaulted for 'User Id'.
      * Field '(DB1) WIA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WIAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCHRC    BEGSR
      *================================================================
      * CHG Ord  Prt,Prc Sts   CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0164  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0165  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0166  70       Ship To Custome
     C                     MOVEL*BLANK    WN0167 30        Ship To Name
     C                     MOVEL*BLANK    WN0168 30        Ship To Address
     C                     MOVEL*BLANK    WN0169 30        Ship To Address
     C                     MOVEL*BLANK    WN0170 30        Ship To Address
     C                     MOVEL*BLANK    WN0171 20        Ship To City
     C                     MOVEL*BLANK    WN0172  2        Ship To State C
     C                     MOVEL*BLANK    WN0173 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0174  70       Bill to Custome
     C                     MOVEL*BLANK    WN0175 30        Bill to Name
     C                     MOVEL*BLANK    WN0176 30        Bill to Address
     C                     MOVEL*BLANK    WN0177 30        Bill to Address
     C                     MOVEL*BLANK    WN0178 30        Bill to Address
     C                     MOVEL*BLANK    WN0179 20        Bill to City
     C                     MOVEL*BLANK    WN0180  2        Bill to State C
     C                     MOVEL*BLANK    WN0181 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0182 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0183  70       Order Date
     C                     Z-ADD*ZERO     WN0184  70       Requested Ship
     C                     Z-ADD*ZERO     WN0185  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0186  70       Cancel Date
     C                     MOVEL*BLANK    WN0187  2        Terms Code
     C                     MOVEL*BLANK    WN0188 40        Special Instruc
     C                     MOVEL*BLANK    WN0189 40        Special Instruc
     C                     MOVEL*BLANK    WN0190  3        Carrier Code
     C                     MOVEL*BLANK    WN0191  1        Comment Print A
     C                     MOVEL*BLANK    WN0192  1        Comment Print I
     C                     MOVEL*BLANK    WN0193  1        Comment Print P
     C                     MOVEL*BLANK    WN0194  1        Comment Print S
     C                     MOVEL*BLANK    WN0195  3        Reason Code
     C                     MOVEL*BLANK    WN0196  1        Order in Use
     C                     MOVEL*BLANK    WN0197  1        Header Status
     C                     MOVEL*BLANK    WN0198  1        Header Status L
     C                     Z-ADD*ZERO     WN0199  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0200 10        User Original E
     C                     Z-ADD*ZERO     WN0201  70       Date of Origina
     C                     Z-ADD*ZERO     WN0202 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0203 112       Order Weight To
     C                     MOVEL*BLANK    WN0204  1        Credit Hold
     C                     MOVEL*BLANK    WN0205  1        Production Hold
     C                     MOVEL*BLANK    WN0206  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0207  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0208  40       Requested Deliv
     C                     MOVEL*BLANK    WN0209  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0210 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0211  70       Load ID
     C                     Z-ADD*ZERO     WN0212  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0213 112       Rated Freight
     C                     MOVEL*BLANK    WN0214  1        LTL Flag
     C                     MOVEL*BLANK    WN0215  1        Price Audit
     C                     MOVEL*BLANK    WN0216  2        Shipping Method
     C                     MOVEL*BLANK    WN0217  1        Export Status
     C                     MOVEL*BLANK    WN0218  1        Palletize
     C                     MOVEL*BLANK    WN0219  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0220  1        Slip Sheet
     C                     MOVEL*BLANK    WN0221  1        Age Code
     C                     Z-ADD*ZERO     WN0222  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0223  1        Load Type
     C                     Z-ADD*ZERO     WN0224  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0225  1        Load Plan Order
     C                     MOVEL*BLANK    WN0226  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0227  70       Resell Referenc
     C                     MOVEL*BLANK    WN0228 30        Special Comment
     C                     MOVEL*BLANK    WN0229 30        Special Comment
     C                     MOVEL*BLANK    WN0230  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0231  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0232  2        Manager Level C
     C                     MOVEL*BLANK    WN0233  3        VP Level Code
     C                     Z-ADD*ZERO     WN0234  70       Attach to Order
     C                     MOVEL*BLANK    WN0235  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0236  70       Invoice Number
     C                     MOVEL*BLANK    WN0237  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0238  70       Invoice Date
     C                     MOVEL*BLANK    WN0239  2        Event Code
     C                     MOVEL*BLANK    WN0240  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0241  1        Modified Flag
     C                     Z-ADD*ZERO     WN0242 112       A/R order Value
     C                     MOVEL*BLANK    WN0243  1        Billing Activit
     C                     MOVEL*BLANK    WN0244  1        Block Order Fla
     C                     MOVEL*BLANK    WN0245  1        Order Certifica
     C                     Z-ADD*ZERO     WN0246 112       Invoice Order V
     C                     MOVEL*BLANK    WN0247  1        Process Sts for
     C                     MOVEL*BLANK    WN0248  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0249  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0250  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0251  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0252  1        Email Cust On O
     C                     MOVEL*BLANK    WN0253  1        Order Emailed
     C                     MOVEL*BLANK    WN0254  1        Export Docs Go
     C                     MOVEL*BLANK    WN0255  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0256  1        Broker Order St
     C                     MOVEL*BLANK    WN0257  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0258  2        Order Requires
     C                     MOVEL*BLANK    WN0259  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0260  2        Export USDA App
     C                     MOVEL*BLANK    WN0261  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0262  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0263  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0264  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0265  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0266  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0267  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0268  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0269  60       Time of Origina
     C                     Z-ADD*ZERO     WN0270  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0271  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0272  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0273 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0274 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0275 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0276 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0277 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0278  70       Claim Number
     C                     MOVEL*BLANK    WN0279  1        EDI Status 1
     C                     MOVEL*BLANK    WN0280  1        EDI Status 2
     C                     MOVEL*BLANK    WN0281  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0282  60       Job Time
     C                     MOVEL*BLANK    WN0283 10        User Id
     C                     MOVEL*BLANK    WN0284 10        Job Name
     C                     Z-ADD*ZERO     WN0285  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#2AIC3    WJAIC3           Company Number
     C                     Z-ADD#2C4NB    WJC4NB           Order Number
      *
     C           KLCHTH    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C           KLCHTH    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YBRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL'N'       WJGYST    P      Order Type Prin
     C                     MOVEL'U'       WJU1ST    P      Price Status
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPCRC
     C                     Z-ADDWJAIC3    PCAIC3           Company Number
     C                     Z-ADDWJC4NB    PCC4NB           Order Number
     C                     MOVELWJJNCD    PCJNCD    P      Order Type - Sa
     C                     Z-ADDWJANC7    PCANC7           AR Customer Num
     C                     Z-ADDWJBKC7    PCBKC7           Ship To Custome
     C                     MOVELWJBRTX    PCBRTX    P      Ship To Name
     C                     MOVELWJHMNA    PCHMNA    P      Ship To Address
     C                     MOVELWJHONA    PCHONA    P      Ship To Address
     C                     MOVELWJHPNA    PCHPNA    P      Ship To Address
     C                     MOVELWJHNNA    PCHNNA    P      Ship To City
     C                     MOVELWJDBCD    PCDBCD    P      Ship To State C
     C                     MOVELWJCKTX    PCCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWJB0C7    PCB0C7           Bill to Custome
     C                     MOVELWJAETX    PCAETX    P      Bill to Name
     C                     MOVELWJB1NA    PCB1NA    P      Bill to Address
     C                     MOVELWJB3NA    PCB3NA    P      Bill to Address
     C                     MOVELWJB4NA    PCB4NA    P      Bill to Address
     C                     MOVELWJB2NA    PCB2NA    P      Bill to City
     C                     MOVELWJBHCD    PCBHCD    P      Bill to State C
     C                     MOVELWJC8TX    PCC8TX    P      Bill to Zip/Pos
     C                     MOVELWJBCNA    PCBCNA    P      Customer Purcha
     C                     Z-ADDWJA0DT    PCA0DT           Order Date
     C                     Z-ADDWJA5DT    PCA5DT           Requested Ship
     C                     Z-ADDWJGNDT    PCGNDT           Actual Shipped
     C                     Z-ADDWJACDT    PCACDT           Cancel Date
     C                     MOVELWJAQCD    PCAQCD    P      Terms Code
     C                     MOVELWJB6NA    PCB6NA    P      Special Instruc
     C                     MOVELWJBYNA    PCBYNA    P      Special Instruc
     C                     MOVELWJBZNA    PCBZNA    P      Carrier Code
     C                     MOVELWJGTST    PCGTST    P      Comment Print A
     C                     MOVELWJGVST    PCGVST    P      Comment Print I
     C                     MOVELWJGUST    PCGUST    P      Comment Print P
     C                     MOVELWJQFST    PCQFST    P      Comment Print S
     C                     MOVELWJCQCD    PCCQCD    P      Reason Code
     C                     MOVELWJGJST    PCGJST    P      Order in Use
     C                     MOVELWJGWST    PCGWST    P      Header Status
     C                     MOVELWJGXST    PCGXST    P      Header Status L
     C                     MOVELWJGYST    PCGYST    P      Order Type Prin
     C                     Z-ADDWJAODT    PCAODT           Scheduled Ship
     C                     MOVELWJAIVN    PCAIVN    P      User Original E
     C                     Z-ADDWJCXDT    PCCXDT           Date of Origina
     C                     Z-ADDWJJZVA    PCJZVA           Order Value Tot
     C                     Z-ADDWJA1WG    PCA1WG           Order Weight To
     C                     MOVELWJXIST    PCXIST    P      Credit Hold
     C                     MOVELWJXJST    PCXJST    P      Production Hold
     C                     MOVELWJXKST    PCXKST    P      New Customer Ho
     C                     Z-ADDWJEIDT    PCEIDT           Requested Deliv
     C                     Z-ADDWJAFTM    PCAFTM           Requested Deliv
     C                     MOVELWJE8CD    PCE8CD    P      Accounts Receiv
     C                     MOVELWJE9CD    PCE9CD    P      Accounts Receiv
     C                     Z-ADDWJRMNB    PCRMNB           Load ID
     C                     Z-ADDWJTBNB    PCTBNB           Absorbed Freigh
     C                     Z-ADDWJR1NB    PCR1NB           Rated Freight
     C                     MOVELWJPJST    PCPJST    P      LTL Flag
     C                     MOVELWJU0ST    PCU0ST    P      Price Audit
     C                     MOVELWJU1ST    PCU1ST    P      Price Status
     C                     MOVELWJQ2CD    PCQ2CD    P      Shipping Method
     C                     MOVELWJU2ST    PCU2ST    P      Export Status
     C                     MOVELWJVEST    PCVEST    P      Palletize
     C                     MOVELWJVFST    PCVFST    P      Shrink Wrap
     C                     MOVELWJVGST    PCVGST    P      Slip Sheet
     C                     MOVELWJRPCD    PCRPCD    P      Age Code
     C                     Z-ADDWJRNNB    PCRNNB           Reefer Temperat
     C                     MOVELWJVDST    PCVDST    P      Load Type
     C                     Z-ADDWJATIN    PCATIN           Attach to Invoi
     C                     MOVELWJU4ST    PCU4ST    P      Load Plan Order
     C                     MOVELWJU5ST    PCU5ST    P      Print Pick Slip
     C                     Z-ADDWJRSRN    PCRSRN           Resell Referenc
     C                     MOVELWJMHNA    PCMHNA    P      Special Comment
     C                     MOVELWJMINA    PCMINA    P      Special Comment
     C                     MOVELWJWBST    PCWBST    P      Affect Auto Acc
     C                     MOVELWJR4CD    PCR4CD    P      Sales Route Cod
     C                     MOVELWJBFCD    PCBFCD    P      Manager Level C
     C                     MOVELWJQ4CD    PCQ4CD    P      VP Level Code
     C                     Z-ADDWJT3NB    PCT3NB           Attach to Order
     C                     MOVELWJSICD    PCSICD    P      Reason for Pric
     C                     Z-ADDWJCONB    PCCONB           Invoice Number
     C                     MOVELWJCEST    PCCEST    P      Invoice Suffix
     C                     Z-ADDWJAWDT    PCAWDT           Invoice Date
     C                     MOVELWJJPCD    PCJPCD    P      Event Code
     C                     MOVELWJXUST    PCXUST    P      Trans Contol AS
     C                     MOVELWJZ1ST    PCZ1ST    P      Modified Flag
     C                     Z-ADDWJVRVA    PCVRVA           A/R order Value
     C                     MOVELWJOBST    PCOBST    P      Billing Activit
     C                     MOVELWJBCST    PCBCST    P      Block Order Fla
     C                     MOVELWJBDST    PCBDST    P      Order Certifica
     C                     Z-ADDWJB7VL    PCB7VL           Invoice Order V
     C                     MOVELWJGASX    PCGASX    P      Process Sts for
     C                     MOVELWJGBSX    PCGBSX    P      Order Conf Fax
     C                     MOVELWJGCSX    PCGCSX    P      Manifest Fax St
     C                     MOVELWJGDSX    PCGDSX    P      Invoice Fax Sts
     C                     MOVELWJFNSX    PCFNSX    P      Transfer in Sto
     C                     MOVELWJFOSX    PCFOSX    P      Email Cust On O
     C                     MOVELWJFPSX    PCFPSX    P      Order Emailed
     C                     MOVELWJFQSX    PCFQSX    P      Export Docs Go
     C                     MOVELWJFRSX    PCFRSX    P      Shipping Temp C
     C                     MOVELWJFSSX    PCFSSX    P      Broker Order St
     C                     MOVELWJFTSX    PCFTSX    P      Air Freight Ord
     C                     MOVELWJFUSX    PCFUSX    P      Order Requires
     C                     MOVELWJFVSX    PCFVSX    P      OH Load Plan Re
     C                     MOVELWJFWSX    PCFWSX    P      Export USDA App
     C                     MOVELWJFXSX    PCFXSX    P      HPB Ship to War
     C                     MOVELWJFYSX    PCFYSX    P      OH TF Exempt Co
     C                     Z-ADDWJNODT    PCNODT           OH Appt Confirm
     C                     Z-ADDWJNPDT    PCNPDT           JPN Invoice Iss
     C                     Z-ADDWJNQDT    PCNQDT           Load Actual Shi
     C                     Z-ADDWJNRDT    PCNRDT           Load BOL Comple
     C                     Z-ADDWJNSDT    PCNSDT           Load Truck Depa
     C                     Z-ADDWJBPTM    PCBPTM           Maximum Gross W
     C                     Z-ADDWJBQTM    PCBQTM           Time of Origina
     C                     Z-ADDWJBRTM    PCBRTM           OH Appt Confirm
     C                     Z-ADDWJBSTM    PCBSTM           Load BOL Comple
     C                     Z-ADDWJBTTM    PCBTTM           Load Truck Depa
     C                     Z-ADDWJH0NX    PCH0NX           Act Frt Referen
     C                     Z-ADDWJH1NX    PCH1NX           Act Non-Ref Frt
     C                     Z-ADDWJH2NX    PCH2NX           OH Fuel Surchar
     C                     Z-ADDWJH3NX    PCH3NX           OH Total Non-Re
     C                     Z-ADDWJH4NX    PCH4NX           OH Total Ref Fr
     C                     Z-ADDWJC0C7    PCC0C7           Claim Number
     C                     MOVELWJUVST    PCUVST    P      EDI Status 1
     C                     MOVELWJUWST    PCUWST    P      EDI Status 2
     C                     MOVELWJUXST    PCUXST    P      EDI Status 3
     C                     Z-ADDWJAATM    PCAATM           Job Time
     C                     MOVELWJAYNA    PCAYNA    P      User Id
     C                     MOVELWJA0NA    PCA0NA    P      Job Name
     C                     Z-ADDWJAXDT    PCAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV Next Audit Seq #   RT - PD Price Change Audit Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN K3AIC3    WQTI01           Company Number
     C           *LIKE     DEFN K3C4NB    WQTI02           Order Number
     C           *LIKE     DEFN K3DPNB    WQTI03           Order Sequence
     C           *LIKE     DEFN K3UENB    WQTI04           Order Secondary
      * Define keylist
     C           KPSTI     KLIST
     C                     KFLD           WQTI01           Company Number
     C                     KFLD           WQTI02           Order Number
     C                     KFLD           WQTI03           Order Sequence
     C                     KFLD           WQTI04           Order Secondary
     C                     KFLD           K3ASNO           Audit Sequence
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI01           Company Number
     C                     KFLD           WQTI02           Order Number
     C                     KFLD           WQTI03           Order Sequence
     C                     KFLD           WQTI04           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    WQTI01           Company Number
     C                     Z-ADD#2C4NB    WQTI02           Order Number
     C                     Z-ADD#2DPNB    WQTI03           Order Sequence
     C                     Z-ADD#2UENB    WQTI04           Order Secondary
     C                     Z-ADD999       K3ASNO           Audit Sequence
      * Establish starting position
     C           KPSTI     SETLL@K3CPKR                    *
     C           KRSTI     READE@K3CPKR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2378' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUQQNB           USR Sequence Nu
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           K3ASNO    ADD  1         WUQQNB           USR Sequence Nu
     C                     GOTO TIEXIT                     *QUIT
     C           KRSTI     READE@K3CPKR                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJCRRC    BEGSR
      *================================================================
      * CRT Price Change Audit CR - PD Price Change Audit Log  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0286  1        EDI Status 1
     C                     MOVEL*BLANK    WN0287  1        EDI Status 2
     C                     MOVEL*BLANK    WN0288  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0289  60       Job Time
     C                     MOVEL*BLANK    WN0290 10        User Id
     C                     MOVEL*BLANK    WN0291 10        Job Name
     C                     Z-ADD*ZERO     WN0292  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @K3CPKP
     C                     Z-ADD#2AIC3    WKAIC3           Company Number
     C                     Z-ADD#2C4NB    WKC4NB           Order Number
     C                     Z-ADD#2DPNB    WKDPNB           Order Sequence
     C                     Z-ADD#2UENB    WKUENB           Order Secondary
     C                     Z-ADDWUQQNB    WKASNO           Audit Sequence
     C                     Z-ADD#PHGCD    WKHGCD           Item Code
     C                     MOVEL#PGMST    WKGMST           Detail Line Sta
     C                     MOVEL#PGMST    WKGNST           Detail Line Sta
     C                     Z-ADD#PAYVA    WKAYVA           Extended Amount
     C                     Z-ADDWUYJVA    WKYJVA           Extended Amount
     C                     MOVEL#PU1ST    WKU1ST           Price Status
     C                     MOVELWUPSTL    WKPSTL           Price Status La
     C                     MOVEL#PU0ST    WKU0ST           Price Audit
     C                     MOVEL#PRFCD    WKRFCD           Price Audit Rea
     C                     MOVEL#PU0ST    WKPALS           Price Audit Las
     C                     MOVEL#PRFCD    WKWWCD           Price Audit Rea
     C                     Z-ADD#PAKPR    WKAKPR           Unit Price
     C                     Z-ADDWUDBPR    WKDBPR           Unit Price Last
     C                     Z-ADD#PALPR    WKALPR           Unit Price - Cr
     C                     Z-ADD#PALPR    WKDCPR           Unit Price - Cr
     C                     MOVEL#PJPCD    WKJPCD           Event Code
     C                     MOVEL#PJPCD    WKWXCD           Event Code Last
     C                     MOVE *BLANK    WKPREC           Price Event Cal
     C                     MOVEL'PM'      WKPREC           Price Event Cal
     C                     MOVEL##PGM     WKPIDX           Program ID . .
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
     C           KLCRTJ    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C                     KFLD           WKASNO           Audit Sequence
      * Check for duplicate primary key
     C           KLCRTJ    SETLL@K3CPKP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2379' W0RTN   7
      * Send message 'Price Change Audit Log EX'
     C                     MOVEL'USR2379' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C                     WRITE@K3CPKP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTK01           Application Cod
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WQTK01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQTK01           Application Cod
     C                     MOVEL'OMS'     WQTK01           Application Cod
      * Establish starting position
     C           KRSTK     SETLL@DNRESF                    *
     C           KRSTK     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TLRVGN
     C                     END                             *FI
     C           KRSTK     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTL01           Application Cod
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTL01           Application Cod
      * Establish starting position
     C           KRSTL     SETLL@DNRESF                    *
     C           KRSTL     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTL     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * DEL Ship Formula Work  RT - Order Dtl Formula Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQTM01           Company Number
     C           *LIKE     DEFN WHC4NB    WQTM02           Order Number
     C           *LIKE     DEFN WHDPNB    WQTM03           Order Sequence
     C           *LIKE     DEFN WHUENB    WQTM04           Order Secondary
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM01           Company Number
     C                     KFLD           WQTM02           Order Number
     C                     KFLD           WQTM03           Order Sequence
     C                     KFLD           WQTM04           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WQTM01           Company Number
     C                     Z-ADDP1C4NB    WQTM02           Order Number
     C                     Z-ADDP1DPNB    WQTM03           Order Sequence
     C                     Z-ADDP1UENB    WQTM04           Order Secondary
      * Establish starting position
     C           KRSTM     SETLL@JKCPZ7                    *
     C           KRSTM     READE@JKCPZ7                  90*
      * Data record not found
     C   90                MOVEL'USR1870' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Ship Dtl Form Work DL - Order Dtl Formula Dtl  * 
     C                     EXSR TNDLRC
     C           KRSTM     READE@JKCPZ7                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNDLRC    BEGSR
      *================================================================
      * DLT Ship Dtl Form Work DL - Order Dtl Formula Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @JKCPZ6
     C                     Z-ADDWHAIC3    WMAIC3           Company Number
     C                     Z-ADDWHC4NB    WMC4NB           Order Number
     C                     Z-ADDWHDPNB    WMDPNB           Order Sequence
     C                     Z-ADDWHUENB    WMUENB           Order Secondary
     C                     MOVELWHQ9CD    WMQ9CD           Price Method Co
     C                     Z-ADDWHHGCD    WMHGCD           Item Code
     C                     Z-ADDWHZXNB    WMZXNB           Pricing Sequenc
      *
     C           KLDLTN    KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
     C                     KFLD           WMDPNB           Order Sequence
     C                     KFLD           WMUENB           Order Secondary
     C                     KFLD           WMQ9CD           Price Method Co
     C                     KFLD           WMHGCD           Item Code
     C                     KFLD           WMZXNB           Pricing Sequenc
     C           KLDLTN    CHAIN@JKCPZ6              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJKCPW0'MDACP
     C                     MOVEL'@JKCPZ6' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@JKCPZ6                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * DEL Shp Dtl Price Wrk  RT - Order Detail Pricing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQTO01           Company Number
     C           *LIKE     DEFN WFC4NB    WQTO02           Order Number
     C           *LIKE     DEFN WFDPNB    WQTO03           Order Sequence
     C           *LIKE     DEFN WFUENB    WQTO04           Order Secondary
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           Company Number
     C                     KFLD           WQTO02           Order Number
     C                     KFLD           WQTO03           Order Sequence
     C                     KFLD           WQTO04           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WQTO01           Company Number
     C                     Z-ADDP1C4NB    WQTO02           Order Number
     C                     Z-ADDP1DPNB    WQTO03           Order Sequence
     C                     Z-ADDP1UENB    WQTO04           Order Secondary
      * Establish starting position
     C           KRSTO     SETLL@IMCPZ5                    *
     C           KRSTO     READE@IMCPZ5                  90*
      * Data record not found
     C   90                MOVEL'USR1675' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Ship Dtl Price Wrk DL - Order Detail Pricing  * 
     C                     EXSR TPDLRC
     C           KRSTO     READE@IMCPZ5                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPDLRC    BEGSR
      *================================================================
      * DLT Ship Dtl Price Wrk DL - Order Detail Pricing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @IMCPZ4
     C                     Z-ADDWFAIC3    WOAIC3           Company Number
     C                     Z-ADDWFC4NB    WOC4NB           Order Number
     C                     Z-ADDWFDPNB    WODPNB           Order Sequence
     C                     Z-ADDWFUENB    WOUENB           Order Secondary
     C                     MOVELWFQ9CD    WOQ9CD           Price Method Co
      *
     C           KLDLTP    KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOC4NB           Order Number
     C                     KFLD           WODPNB           Order Sequence
     C                     KFLD           WOUENB           Order Secondary
     C                     KFLD           WOQ9CD           Price Method Co
     C           KLDLTP    CHAIN@IMCPZ4              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDIMCPW0'MDACP
     C                     MOVEL'@IMCPZ4' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@IMCPZ4                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * CPY Ship PRC t/Qtmp    RT - Order Detail Pricing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQTQ01           Company Number
     C           *LIKE     DEFN WAC4NB    WQTQ02           Order Number
     C           *LIKE     DEFN WADPNB    WQTQ03           Order Sequence
     C           *LIKE     DEFN WAUENB    WQTQ04           Order Secondary
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WQTQ01           Company Number
     C                     KFLD           WQTQ02           Order Number
     C                     KFLD           WQTQ03           Order Sequence
     C                     KFLD           WQTQ04           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WQTQ01           Company Number
     C                     Z-ADDP1C4NB    WQTQ02           Order Number
     C                     Z-ADDP1DPNB    WQTQ03           Order Sequence
     C                     Z-ADDP1UENB    WQTQ04           Order Secondary
      * Establish starting position
     C           KRSTQ     SETLL@IMCPSE                    *
     C           KRSTQ     READE@IMCPSE                  90*
      * Data record not found
     C   90                MOVEL'USR1675' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
     C                     EXSR TRCRRC
     C           KRSTQ     READE@IMCPSE                  90*
     C                     ENDDO
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRCRRC    BEGSR
      *================================================================
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0293  60       Job Time
     C                     MOVEL*BLANK    WN0294 10        User Id
     C                     MOVEL*BLANK    WN0295 10        Job Name
     C                     Z-ADD*ZERO     WN0296  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @IMCPZ4
     C                     Z-ADDWAAIC3    WOAIC3           Company Number
     C                     Z-ADDWAC4NB    WOC4NB           Order Number
     C                     Z-ADDWADPNB    WODPNB           Order Sequence
     C                     Z-ADDWAUENB    WOUENB           Order Secondary
     C                     MOVELWAQ9CD    WOQ9CD           Price Method Co
     C                     Z-ADDWAPDSQ    WOPDSQ           Price Detail Se
     C                     Z-ADDWABNPR    WOBNPR           Componant Price
     C                     MOVELWAU6ST    WOU6ST           PD Status
     C                     MOVELWAUVST    WOUVST           EDI Status 1
     C                     MOVELWAUWST    WOUWST           EDI Status 2
     C                     MOVELWAUXST    WOUXST           EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WOAATM           Job Time
     C                     MOVEL##USR     WOAYNA           User Id
     C                     MOVEL##JOB     WOA0NA           Job Name
     C                     Z-ADD##JDT     WOAXDT           Job Date
     C           KLCRTR    KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOC4NB           Order Number
     C                     KFLD           WODPNB           Order Sequence
     C                     KFLD           WOUENB           Order Secondary
     C                     KFLD           WOQ9CD           Price Method Co
      * Check for duplicate primary key
     C           KLCRTR    SETLL@IMCPZ4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1676' W0RTN   7
      * Send message 'Order Detail Pricing   EX'
     C                     MOVEL'USR1676' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C                     WRITE@IMCPZ4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * CPY Shp Dtl Form T/QtmpRT - Order Dtl Formula Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN JKAIC3    WQTS01           Company Number
     C           *LIKE     DEFN JKC4NB    WQTS02           Order Number
     C           *LIKE     DEFN JKDPNB    WQTS03           Order Sequence
     C           *LIKE     DEFN JKUENB    WQTS04           Order Secondary
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WQTS01           Company Number
     C                     KFLD           WQTS02           Order Number
     C                     KFLD           WQTS03           Order Sequence
     C                     KFLD           WQTS04           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WQTS01           Company Number
     C                     Z-ADDP1C4NB    WQTS02           Order Number
     C                     Z-ADDP1DPNB    WQTS03           Order Sequence
     C                     Z-ADDP1UENB    WQTS04           Order Secondary
      * Establish starting position
     C           KRSTS     SETLL@JKCPYF                    *
     C           KRSTS     READE@JKCPYF                  90*
      * Data record not found
     C   90                MOVEL'USR1870' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT Temporary Record   CR - Order Dtl Formula Dtl  * 
     C                     EXSR TTCRRC
     C           KRSTS     READE@JKCPYF                  90*
     C                     ENDDO
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTCRRC    BEGSR
      *================================================================
      * CRT Temporary Record   CR - Order Dtl Formula Dtl  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0297  60       Job Time
     C                     MOVEL*BLANK    WN0298 10        User Id
     C                     MOVEL*BLANK    WN0299 10        Job Name
     C                     Z-ADD*ZERO     WN0300  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @JKCPZ6
     C                     Z-ADDJKAIC3    WMAIC3           Company Number
     C                     Z-ADDJKC4NB    WMC4NB           Order Number
     C                     Z-ADDJKDPNB    WMDPNB           Order Sequence
     C                     Z-ADDJKUENB    WMUENB           Order Secondary
     C                     MOVELJKQ9CD    WMQ9CD           Price Method Co
     C                     Z-ADDJKHGCD    WMHGCD           Item Code
     C                     Z-ADDJKZXNB    WMZXNB           Pricing Sequenc
     C                     Z-ADDJKBOPR    WMBOPR           Sales Yield
     C                     Z-ADDJKCDPR    WMCDPR           Market Value
     C                     Z-ADDJKCEPR    WMCEPR           Credit Value
     C                     MOVELJKU6ST    WMU6ST           PD Status
     C                     MOVELJKUVST    WMUVST           EDI Status 1
     C                     MOVELJKUWST    WMUWST           EDI Status 2
     C                     MOVELJKUXST    WMUXST           EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WMAATM           Job Time
     C                     MOVEL##USR     WMAYNA           User Id
     C                     MOVEL##JOB     WMA0NA           Job Name
     C                     Z-ADD##JDT     WMAXDT           Job Date
     C           KLCRTT    KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
     C                     KFLD           WMDPNB           Order Sequence
     C                     KFLD           WMUENB           Order Secondary
     C                     KFLD           WMQ9CD           Price Method Co
     C                     KFLD           WMHGCD           Item Code
     C                     KFLD           WMZXNB           Pricing Sequenc
      * Check for duplicate primary key
     C           KLCRTT    SETLL@JKCPZ6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1871' W0RTN   7
      * Send message 'Order Dtl Formula Dtl  EX'
     C                     MOVEL'USR1871' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C                     WRITE@JKCPZ6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Edit Pricing Control Fields
      *================================================================
      * Retrieve Contract Defaults
      * CASE: CTL.Contract Number USR is Entered
     C           #CCNBR    IFGT *ZERO                      *IF
      * RTV Contract Defaults  RT - OPP Item Contract  * 
     C                     EXSR SORVGN
     C                     Z-ADD#CCNBR    WUCNBR           Contract Number
     C                     END                             *FI
      * Validate price method code
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CTL.Price Method Code USR NE WRK.BLANK
      *   |- c2    : CTL.Price Method Code USR is NE Deviated
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CTKCD    IFNE WUGSTX                     *IF
     C           #CTKCD    IFNE 'DEV'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * VAL Price Meth Exists  RT - PD Price Method Header  * 
     C                     EXSR SPRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,010                    *IF
      * Setup message data for message
     C                     MOVEL#CTKCD    ZA0009           Price Method Co
      * Send message 'Price Method invalid'
     C                     MOVEL'USR1957' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate date method code
      * CASE: CTL.Date Method Code USR NE WRK.BLANK
     C           #CTLCD    IFNE WUGSTX                     *IF
      * VAL Date Method Exists RT - Market Date Method  * 
     C                     EXSR SQRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,010                    *IF
      * Setup message data for message
     C                     MOVEL#CTLCD    ZA0010           Date Method Cod
      * Send message 'Market Date Method Inval.'
     C                     MOVEL'USR2161' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Commodity Market
      * CASE: CTL.Commodity Market Code USR NE WRK.BLANK
     C           #CTMCD    IFNE WUGSTX                     *IF
      * RTV Commod. Mkts Desc  RT - OM Commodity Markets  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CTMCD    WL0001    P      Commodity Marke
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WUJ3NA    P      Commodity Marke
      * CASE: WRK.Commodity Market Desc EQ WRK.BLANK
     C           WUJ3NA    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#CTMCD    ZA0011           Commodity Marke
      * Send message 'Commodity Market not fnd'
     C                     MOVEL'USR2162' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUJ3NA    #CJ3NA           Commodity Marke
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0012  70       Effective Date
     C                     Z-ADD*ZERO     WN0013  70       End Date Effect
     C                     Z-ADD*ZERO     WN0014 112       Maximum Quantit
     C                     Z-ADD*ZERO     WN0015 112       Quantity Sold
      *
      * EDT Order Detail Edits IF
     C                     MOVEL*BLANK    P5XSST           Contract Exists
     C                     MOVEL*BLANK    P5WDST           Cntrt Enter no
     C                     MOVEL*BLANK    P5WEST           Cntrt.# does no
     C                     MOVEL*BLANK    P5WFST           Qty ordered > C
     C                     MOVEL*BLANK    P5WGST           Contract Expire
     C                     MOVEL*BLANK    P5WHST           Price Override
     C                     MOVEL*BLANK    P5WIST           Price Method QT
     C                     MOVEL*BLANK    P5WJST           Prc Code FRM or
     C                     MOVEL*BLANK    P5WKST           Mkt Pricing Dat
     C                     MOVEL*BLANK    P5WLST           Mkt Meth. and D
     C                     MOVEL*BLANK    P5WMST           Price Override
     C                     MOVEL*BLANK    P5YXST           Price Override
      * Get Price Method Type
      * RTV Prc Mth Typ by Sys RT - Price Method Header  * 
     C                     EXSR SRRVGN
      * Check if Contract exists for Item
      * A Contract Exists for this customer and item.
      * CASE: PAR.Contract Number is Zero
     C           WUCNBR    IFEQ 0                          *IF
      * RTV Edt for Existing   RT - OPP Item Contract  * 
     C                     EXSR SSRVGN
     C                     Z-ADDWUCNBR    WUL6NB           Contract Number
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,011                    *IF
     C                     MOVEL'Y'       P5XSST           Contract Exists
     C                     END                             *FI
     C                     END                             *FI
      * Edit Contract Number
      * CASE: PAR.Contract Number is Entered
     C           WUCNBR    IFGT 0                          *IF
      * RTV Val. Contract #    RT - OPP Item Contract  * 
     C                     EXSR STRVGN
      * Set Contract Error Parms
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,010                    *IF
     C                     MOVEL'Y'       P5WEST           Cntrt.# does no
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0015    ADD  #PCBQT    WUCAQT           Total Quantity
      * CASE: WRK.Total Quantity Ordered GT PAR.Maximum Quantity
     C           WUCAQT    IFGT WN0014                     *IF
     C                     MOVEL'Y'       P5WFST           Qty ordered > C
     C                     END                             *FI
      * CASE: PAR.End Date Effective LE PAR.Order Date
     C           WN0013    IFLE #PA0DT                     *IF
     C                     MOVEL'Y'       P5WGST           Contract Expire
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validity Checking
      * Price Override and Manual Price Method
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Type is Manual Pricing
      *   |- c2    : PAR.Price Overage Override is Equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUV8ST    IFEQ 'M'                        *IF
     C           #CCLPR    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P5WHST           Price Override
     C                     END                             *FI
      * Price override and EXT price method
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Type is Extended Pricing
      *   |- c2    : PAR.Price Overage Override is Equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUV8ST    IFEQ 'X'                        *IF
     C           #CCLPR    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P5WMST           Price Override
     C                     END                             *FI
      * FRM / MKT Checks
      * CASE: PAR.Price Method Type is Market or Formula
     C           WUV8ST    IFEQ 'F'                        *IF
     C           WUV8ST    OREQ 'K'
      * Market Code Must be entered
      * CASE: PAR.Commodity Market Code is Not Entered
     C           #CTMCD    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       P5WJST           Prc Code FRM or
     C                     END                             *FI
      * Market Price Date field not zero
      * CASE: PAR.Market Pricing Date is NE Zero
     C           #CG2DT    IFNE 0                          *IF
     C                     MOVEL'Y'       P5WKST           Mkt Pricing Dat
     C                     END                             *FI
      * CASE: PAR.Price Overage Override is Not Zeros
     C           #CCLPR    IFNE 0                          *IF
     C                     MOVEL'Y'       P5YXST           Price Override
     C                     END                             *FI
     C                     END                             *FI
      * MKT date Method entered and Mkt Price Date both entered.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Date Method Code is Entered
      *   |- c2    : PAR.Market Pricing Date is NE Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CTLCD    IFNE *BLANK                     *IF
     C           #CG2DT    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P5WLST           Mkt Meth. and D
     C                     END                             *FI
      * Copy of edit that go in to program code
      * Contract exists for this item
      * CASE: PAR.Contract Exists for Item is yes
     C           P5XSST    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0012           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0012           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADDWUL6NB    ZA0013           Contract Number
      * Send message 'This item has a Contract'
     C                     MOVEL'USR1851' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Contract not found
      * CASE: PAR.Cntrt.# does not Exit is yes
     C           P5WEST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#PL6NB    ZA0014           Contract Number
      * Send message 'OPP Contract Error'
     C                     MOVEL'USR1803' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Quantity ordered exceeds contact quantity available
      * CASE: PAR.Qty ordered > Contract is yes
     C           P5WFST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#PAVQT    ZA0015           Quantity Ordere
     C                     Z-ADD#PL6NB    ZA0016           Contract Number
      * Send message 'Quantity Ordered > Contra'
     C                     MOVEL'USR1806' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Contract has passed expiration date
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Contract Expired is yes
      *   |- c2    : CTL.Contract Number is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5WGST    IFEQ 'Y'                        *IF
     C           #PL6NB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#PL6NB    ZA0017           Contract Number
      * Send message 'Contract Effective date'
     C                     MOVEL'USR1810' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Validity Checking error messages
      * Price Override required for MAN Price Code
      * CASE: PAR.Price Override Required is yes
     C           P5WHST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#PQ7CD    ZA0018           Price Method Co
     C                     Z-ADD#PBZPR    ZA0019           Price Overage O
      * Send message 'Price Override Req. W/Man'
     C                     MOVEL'USR1772' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Price Override required when Price Method is EXT
      * CASE: PAR.Price Override Req. EXT is yes
     C           P5WMST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#PQ7CD    ZA0020           Price Method Co
     C                     Z-ADD#PBZPR    ZA0021           Price Overage O
      * Send message 'Price Override Req. w/EXT'
     C                     MOVEL'USR1774' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Price Override not allowed for FRM or MKT
      * CASE: PAR.Price Override not Allowd is yes
     C           P5YXST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#CCLPR    ZA0022           Price Overage O
      * Send message 'Price Override not allow'
     C                     MOVEL'USR1807' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * Market code must be entered with FRM or MKT price code
      * CASE: PAR.Prc Code FRM or MKT is yes
     C           P5WJST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#CTMCD    ZA0023           Commodity Marke
      * Send message 'Market Code must be enter'
     C                     MOVEL'USR1750' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
      * Override is not allowed if Market or Formula Processing
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Price Method Type is Market or Formula
      *   |- c2    : CTL.Price Overage Overrid USR is Not Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUV8ST    IFEQ 'F'                        *IF
     C           WUV8ST    OREQ 'K'
     C           #CCLPR    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#CCLPR    ZA0024           Price Overage O
      * Send message 'Price Override not allow'
     C                     MOVEL'USR1807' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * Date method/Pricing Date
      * CASE: PAR.Mkt Meth. and Date both is yes
     C           P5WLST    IFEQ 'Y'                        *IF
      * CASE: CTL.Date Method Code USR is Day Prior Ship
     C           #CTLCD    IFEQ 'DPS'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #PEXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0025
     C                     MOVEL#PRDCD    ZA0026           Date Method Cod
      * Send message 'Date Meth & Prc Dat N/A'
     C                     MOVEL'USR2097' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If price method is MKT then make sure price exists.
      * CASE: CTL.Price Method Code USR is Market
     C           #CTKCD    IFEQ 'MKT'                      *IF
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CTMCD    WL0030    P      Commodity Marke
     C                     MOVELP9LRCD    WL0031    P      Commodity Price
     C                     EXSR SURVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,010                    *IF
      * Check Commodity market from company/item file
      * CASE: CTL.Commodity Market Code USR NE PAR.Default Commod Mark ba
     C           #CTMCD    IFNE P9LNCD                     *IF
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP9LNCD    WL0030    P      Commodity Marke
     C                     MOVELP9LRCD    WL0031    P      Commodity Price
     C                     EXSR SURVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,010                    *IF
      * Setup message data for message
     C                     MOVEL#CTMCD    ZA0027           Commodity Marke
     C                     MOVELP9LRCD    ZA0028           Commodity Price
      * Send message 'No Price for Mkt/Group'
     C                     MOVEL'USR2349' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#CTMCD    ZA0029           Commodity Marke
     C                     MOVELP9LRCD    ZA0030           Commodity Price
     C                     MOVELP9LNCD    ZA0031           Default Commod
      * Send message 'No Price Mkt/Group Deflt'
     C                     MOVEL'USR2350' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#CTMCD    ZA0032           Commodity Marke
     C                     MOVELP9LRCD    ZA0033           Commodity Price
      * Send message 'No Price for Mkt/Group'
     C                     MOVEL'USR2349' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
      * * OMS292 ---- Edit Manual Prices against commodity table.
      * *  The following logic was added so that all manual orders would
      * *  be verified against the OM Commodity Market Price Table.
      * *  John Tremper - 10/20/97
      * *****************************************************************
      * Editing all Manual Prices against the commodity table.
      * CASE: CTL.Price Method Code USR is Manual
     C           #CTKCD    IFEQ 'MAN'                      *IF
      * Val Manual Price      RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0010           Company Number
     C                     Z-ADD#PHGCD    WL0011           Item Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    YL0004    P      Description Lin
     C                     MOVELWL0013    P9LNCD    P      Default Commod
     C                     Z-ADDWL0014    YL0006           Market Overage
     C                     Z-ADDWL0015    YL0007           Standard Overag
     C                     MOVELWL0016    P9LRCD    P      Commodity Price
     C                     Z-ADDWL0017    YL0009           Std Weight_Head
     C                     MOVELWL0018    YL0010    P      Primal Group Co
      * R12926 DN 04/30/18-At Order level, get Absorbed Freight Rate from
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0003           Company Number
     C                     Z-ADD#PBKC7    WL0004           Ship To Custome
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0001    P      Type Code
     C                     Z-ADDWL0006    YN0001           Absorbed Freigh
      * Rtv Absorbed Frt Rate RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0007           Company Number
     C                     Z-ADD#2C4NB    WL0008           Order Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YL0002           Absorbed Freigh
      * Validate Manual Price
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Primal Group Code is NE Samples or Cut Loss
      *   |- c2    : LCL.Type Code is Not Promotional/Samples
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0010    IFNE 'UNID'                     *IF
     C           YL0001    IFNE 'PS'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     Z-ADD*ZERO     WN0016  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0017  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0018  74       Percent 7.4 USR
     C                     Z-ADD*ZERO     WN0019 114       Price Adjustmen
      *
      * VAL Manual Price Range IF
      * *---------------------------------------------------------------*
      * Documentation:
      * This internal function will determine if a manual price entered
      * on an order detail line is within the Manual Pricing Acceptance
      * Percentage from the Company Control file. If it does not fall
      * within the percentage range then the market price will be used.
      * If no market price is found then it is a manual price error
      * *---------------------------------------------------------------*
     C                     Z-ADD*ZERO     YL0016           Projected Marke
     C                     Z-ADD*ZERO     YL0011           Minimum Price
     C                     Z-ADD*ZERO     YL0012           Maximum Price
     C                     MOVEL'Y'       WUTXST           Error Status  3
      * RTV Manual Price Accpt RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0019           Company Number
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    WN0016           Manual Price Ac
     C                     Z-ADDWL0021    WN0017           CoPk/FdSrv ManP
      * Food Service and Co-Pack Items
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Default Commod Mark basis is Food Service
      *   |- c2    : PAR.Default Commod Mark basis is Co-Pack
      *   '-
     C           P9LNCD    IFEQ 'FSV'                      *IF
     C           P9LNCD    OREQ 'CPK'                      *OR
     C                     Z-ADDWN0017    WN0016           Manual Price Ac
     C                     END                             *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP9LNCD    WL0022    P      Commodity Marke
     C                     MOVELP9LRCD    WL0023    P      Commodity Price
     C                     Z-ADD9999999   WL0024           Market Price Da
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0025    YL0016           Commodity Marke
     C                     Z-ADDWL0026    WUE7DT           USR Date Priced
      * Projected Market Price
      * PAR.Projected Market Price =
      *    *COMPUTE (x1 + x2 + (x3 / x4))
      * x1    : PAR.Projected Market Price
      * +     : PGM.*Synon (15,5) work field
      * x2    : PAR.Standard Overage_Underage
      * +     : PGM.*Synon (15,5) work field
      * x3    : PAR.Absorbed Freight Rate CWT
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           YL0016    ADD  YL0006    W0WB01           *Synon (15,5) w
     C           YL0002    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WB01    ADD  W0WB02    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0016           Projected Marke
      * If a market price is found for co/cust market code default
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x4 - (x1 / x2)) * x3))
      * x4    : CON.1
      * -     : PGM.*Synon (17,7) work field
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0016    DIV  100       W0WD02    H      *Synon (17,7) w
     C           1         SUB  W0WD02    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT YL0016    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0011           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0016    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT YL0016    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0012           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CCLPR    IFGE YL0011                     *IF
     C           #CCLPR    IFLE YL0012                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If no price for co/cust market code then use co/item market code
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP9LNCD    WL0022    P      Commodity Marke
     C                     MOVELP9LRCD    WL0023    P      Commodity Price
     C                     Z-ADD9999999   WL0024           Market Price Da
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0025    YL0016           Commodity Marke
     C                     Z-ADDWL0026    WUE7DT           USR Date Priced
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0016    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT YL0016    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0011           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0016    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT YL0016    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0012           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CCLPR    IFGE YL0011                     *IF
     C           #CCLPR    IFLE YL0012                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0016           Projected Marke
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.@Error Return is Manual Price Error
     C           WUWYST    IFEQ 'MPE'                      *IF
      * Setup message data for message
     C                     Z-ADDWUA5PR    ZA0034           Commodity Marke
      * Send message 'Price Invalid, Reenter'
     C                     MOVEL'USR2580' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             *FI
      * Price Code I  - PK0519 10/20/03
      * CASE:
      *  - (c1ANDc2)OR(c3ANDc4)
      *   |- c1    : CTL.Price Code USR is Not Entered
      *   |- c2    : CTL.Price Method Code USR is Deviated
      *   |- c3    : CTL.Price Code USR is Entered
      *   |- c4    : CTL.Price Method Code USR is NE Deviated
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CUYNX    IFEQ *ZERO                      *IF
     C           #CTKCD    IFEQ 'DEV'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #CUYNX    IFGT *ZERO                      *IF
     C           #CTKCD    IFNE 'DEV'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#CTKCD    ZA0035           Price Method Co
      * Send message 'Price mthd/price code inv'
     C                     MOVEL'USR3321' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993332*
      *
     C                     END                             *FI
      * Price Code II - PK0519 10/20/03
      * CASE: CTL.Price Code USR is Entered
     C           #CUYNX    IFGT *ZERO                      *IF
      * Rtv Cust Prc Str/End  RT - Customer Price Header  * 
     C                     EXSR SVRVGN
      * CASE: LCL.Price Start Date is Not Entered
     C           YL0017    IFEQ *ZERO                      *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#CUYNX    ZA0036           Price Code USR
      * Send message 'Price Code not val f/cust'
     C                     MOVEL'USR3318' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val date range
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Scheduled Ship Date LT LCL.Price Start Date
      *   |- c2    : PAR.Scheduled Ship Date GT LCL.Price End Date
      *   '-
     C           P2AODT    IFLT YL0017                     *IF
     C           P2AODT    ORGT YL0018                     *OR
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#CUYNX    ZA0037           Price Code USR
      * Send message 'Price Code not val dt rng'
     C                     MOVEL'USR3317' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
      * Rtv Max Wt and price  RT - Customer Price Detail  * 
     C                     EXSR SWRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,010                    *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#CUYNX    ZA0038           Price Code USR
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0039           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0039           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code not val f/item'
     C                     MOVEL'USR3319' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Sum weights shipped/ordered for ship to /price code
      *
     C                     Z-ADD*ZERO     WN0020 112       Total Weight Or
     C                     Z-ADD*ZERO     WN0021 112       Total Quantity
     C                     Z-ADD*ZERO     WN0022 112       Maximum Contrac
     C                     Z-ADD*ZERO     WN0023 114       Customer Price
     C                     MOVEL*BLANK    WN0024  1        Contract Unit T
      *
      * Clc Sum Ship/Ord Unit IF
     C                     MOVEL'N'       WUECST           Error Status
     C           #PAVQT    MULT #PAVWG    YL0027           Weight Ordered
      * CLC Sum Ship/Ord Unit XF - Order Detail  * 
     C                     CLEARPARC
     C                     Z-ADD#PBKC7    PABKC7           Ship To Custome
     C                     Z-ADD#CUYNX    PABVTM           Price Code
     C                     Z-ADD#PHGCD    PAHGCD           Item Code
      *
     C                     CALL 'PPA6XFR'              90  CLC Sum Ship/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Deta
     C           WN0020    PARM WN0020    WQ0105 112       Total Weight Or
     C                     PARM #2C4NB    WQ0106  70       Order Number
     C           WN0021    PARM WN0021    WQ0107 112       Total Quantity
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     ADD  YL0027    WN0020           Total Weight Or
     C                     ADD  #PAVQT    WN0021           Total Quantity
      * 5/13/10 SAZ P205-Add parm for Max Unit Type;rtv Contract Unit Typ
      * Rtv Cust Prc hdr/dtl  XF - Customer Price Header  * 
     C                     CALL 'PPA7XFR'              90  Rtv Cust Prc hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #PBKC7    WQ0108  70       Ship To Custome
     C                     PARM #CUYNX    WQ0109  60       Price Code
     C           WUPLDT    PARM *ZERO     WQ0110  70       Price Start Dat
     C           WUPMDT    PARM *ZERO     WQ0111  70       Price End Date
     C                     PARM #PHGCD    WQ0112  70       Item Code
     C           WN0022    PARM *ZERO     WQ0113 112       Maximum Contrac
     C           WN0023    PARM *ZERO     WQ0114 114       Customer Price
     C           #PLQCD    PARM *BLANK    WQ0115  3        Commodity Marke
     C           YL0028    PARM *BLANK    WQ0116  3        Price Method Co
     C           #PRDCD    PARM *BLANK    WQ0117  3        Date Method Cod
     C           WN0024    PARM *BLANK    WQ0118  1        Contract Unit T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     MOVELYL0028    #PQ7CD           Price Method Co
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
     C                     EXSR SXRVGN
      * 5/13/10 SAZ P205-Use Contract Unit Type to check Qty or Weight-Lb
      * Use Contract Unit Type to check Qty or Weight-Lbs
      * VAL: Total Weight and Quantity w/Maximum
      * CASE: PAR.Contract Unit Type is Weight-LB
     C           WN0024    IFEQ 'W'                        *IF
      * CASE: PAR.Total Weight Ordered USR GT PAR.Maximum Contract Units
     C           WN0020    IFGT WN0022                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C           WN0020    SUB  WN0022    YL0029           Weight Allocate
      * Setup message data for message
     C                     Z-ADD#CUYNX    ZA0040           Price Code
     C                     Z-ADDYL0029    ZA0041           Weight Allocate
     C                     Z-ADDWN0022    ZA0042           Maximum Contrac
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0043           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0043           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code max wgt exceed'
     C                     MOVEL'USR3320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If Contract Unit type = Quantity
      * CASE: PAR.Total Quantity Ordered GT PAR.Maximum Contract Units
     C           WN0021    IFGT WN0022                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C           WN0021    SUB  WN0022    YL0029           Weight Allocate
      * Setup message data for message
     C                     Z-ADD#CUYNX    ZA0044           Price Code
     C                     Z-ADDYL0029    ZA0045           Weight Allocate
     C                     Z-ADDWN0022    ZA0046           Maximum Contrac
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0047           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0047           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code max wgt exceed'
     C                     MOVEL'USR3320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Original code
      * OUT: No Errors
      * CASE: PAR.Error Status is no
     C           WUECST    IFEQ 'N'                        *IF
     C                     Z-ADDWN0023    #CCLPR           Price Overage O
      * CASE: PAR.PMH Price Type is Invoice Price
     C           YL0026    IFEQ 'I'                        *IF
     C                     Z-ADDWN0023    #CCLPR           Price Overage O
     C                     Z-ADD*ZERO     #CDWPR           OD Ceiling Pric
     C                     ELSE
      * CASE: PAR.PMH Price Type is Ceiling Price
     C           YL0026    IFEQ 'C'                        *IF
     C                     Z-ADD*ZERO     #CCLPR           Price Overage O
     C                     Z-ADDWN0023    #CDWPR           OD Ceiling Pric
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Move Usr Screen fields into Screen Control Fields
      *================================================================
     C                     Z-ADD#CCLPR    #PBZPR           Price Overage O
     C                     MOVEL#CTKCD    #PQ7CD           Price Method Co
     C                     MOVEL#CTLCD    #PRDCD           Date Method Cod
     C                     Z-ADD#CG2DT    #PEXDT           Market Pricing
     C                     MOVEL#CTMCD    #PLQCD           Commodity Marke
     C                     Z-ADD#CCNBR    #PL6NB           Contract Number
     C                     Z-ADD#CUYNX    #PBVTM           Price Code
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV2AIC3    WK1X01  1
     C                     MOVELV2C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#2AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#2C4NB'
     C           YPMTFD    OREQ '#2DPNB'
     C           YPMTFD    OREQ '#2UENB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2AIC3' defaulted for 'Company Number'.
      * Field '(CTL) #2C4NB' defaulted for 'Order Number'.
      * Field '(CTL) #2DPNB' defaulted for 'Order Sequence Number'.
      * Field '(CTL) #2UENB' defaulted for 'Order Secondary Line Seq'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #PHGCD' defaulted for 'Item Code'.
      * Field '(CTL) #PBZPR' defaulted for 'Price Overage Override'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0033' defaulted for 'Record Selected       USR'.
     C                     CALL 'POKJSRR'              90  Sel Item f/Pric
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0292  30       Company Number
     C           #2C4NB    PARM #2C4NB    WQ0293  70       Order Number
     C           #2DPNB    PARM *ZERO     WQ0294  30       Order Sequence
     C           #2UENB    PARM *ZERO     WQ0295  30       Order Secondary
     C           #PHGCD    PARM #PHGCD    WQ0296  70       Item Code
     C           #PBZPR    PARM *ZERO     WQ0297 114       Price Overage O
     C           YL0033    PARM YL0033    WQ0298  1        Record Selected
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POKJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2DPNB    IFNE *ZERO                      Order Sequence
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2UENB    IFNE *ZERO                      Order Secondary
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VA999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVAWL    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
     C                     KFLD           WLDPNB           Order Sequence
     C                     KFLD           WLUENB           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    WLAIC3
     C                     Z-ADD#2C4NB    WLC4NB
     C                     Z-ADD#2DPNB    WLDPNB
     C                     Z-ADD#2UENB    WLUENB
     C           KLVAWL    CHAIN@BGWKL1              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
     C           VA999     TAG
      * Restrictor relation not satisfied
      * Send message 'Order Detail           NF'
     C                     MOVEL'USR1309' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR1309' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 04608
     C           ZINPOS    ANDLE05632
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  18        W0CSRR  50
     C           04608     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD18        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3RFCD           Price Audit Rea
     C                     Z-ADD*ZERO     P4TSVA           USR Total Consu
     C                     Z-ADD*ZERO     P4TZVA           USR Muscle Yiel
     C                     Z-ADD*ZERO     P4Y0NB           Total Credit Do
     C                     Z-ADD*ZERO     P4T1VA           USR Formula Ove
     C                     Z-ADD*ZERO     P4TYVA           USR Differentia
     C                     MOVEL*BLANK    P5WDST           Cntrt Enter no
     C                     MOVEL*BLANK    P5WEST           Cntrt.# does no
     C                     MOVEL*BLANK    P5WFST           Qty ordered > C
     C                     MOVEL*BLANK    P5WGST           Contract Expire
     C                     MOVEL*BLANK    P5WHST           Price Override
     C                     MOVEL*BLANK    P5WIST           Price Method QT
     C                     MOVEL*BLANK    P5WJST           Prc Code FRM or
     C                     MOVEL*BLANK    P5WKST           Mkt Pricing Dat
     C                     MOVEL*BLANK    P5WLST           Mkt Meth. and D
     C                     MOVEL*BLANK    P5WMST           Price Override
     C                     MOVEL*BLANK    P5XSST           Contract Exists
     C                     MOVEL*BLANK    P5YXST           Price Override
     C                     MOVEL*BLANK    P6R4ST           USR Update Flag
     C                     MOVEL*BLANK    P7YZST           USR Record Upda
     C                     MOVEL*BLANK    P8GGST           USR Display fie
     C                     MOVEL*BLANK    P9LNCD           Default Commod
     C                     Z-ADD*ZERO     P9TMVA           Maximum Audit V
     C                     Z-ADD*ZERO     P9TNVA           Minimum Audit V
     C                     MOVEL*BLANK    P9LRCD           Commodity Price
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAPDSQ           Price Detail Se
     C                     Z-ADD*ZERO     WABNPR           Componant Price
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Price Status
     C                     MOVEL*BLANK    WUU1ST  1
      * Define work field Pricing Date Used
     C                     Z-ADD*ZERO     WUGIDT  70
      * Define work field Error Return
     C                     MOVEL*BLANK    WUWZST  5
      * Define work field Quantity Shipped Total
     C                     Z-ADD*ZERO     WUCBQT 112
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Projected Market Price
     C                     Z-ADD*ZERO     WUB8PR 114
      * Define work field Error Status  3
     C                     MOVEL*BLANK    WUTXST  1
      * Define work field USR Date Priced
     C                     Z-ADD*ZERO     WUE7DT  70
      * Define work field Header Status
     C                     MOVEL*BLANK    WUGWST  1
      * Define work field Requested Delivery Time
     C                     Z-ADD*ZERO     WUAFTM  40
      * Define work field USR Update Flag
     C                     MOVEL*BLANK    WUR4ST  1
      * Define work field Price Method Type
     C                     MOVEL*BLANK    WUV8ST  1
      * Define work field Date Method Description
     C                     MOVEL*BLANK    WUMNNA 30
      * Define work field Effective Date
     C                     Z-ADD*ZERO     WUAUDT  70
      * Define work field Contract Mkt Price Date
     C                     Z-ADD*ZERO     WUGBDT  70
      * Define work field Contract Number USR
     C                     Z-ADD*ZERO     WUCNBR  70
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBRMNY           Decimal Places
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Commodity Market Desc
     C                     MOVEL*BLANK    WUJ3NA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCAUDT           Effective Date
     C                     Z-ADD*ZERO     WCCWDT           End Date Effect
     C                     Z-ADD*ZERO     WCANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WCDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WCHFQT           Quantity Sold
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCFSQT           Open Commitment
     C                     Z-ADD*ZERO     WCB0PR           Contract Price
     C                     Z-ADD*ZERO     WCGBDT           Contract Mkt Pr
     C                     Z-ADD*ZERO     WCGCDT           Entered Date
     C                     Z-ADD*ZERO     WCGDDT           Date Sold
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Contract Number
     C                     Z-ADD*ZERO     WUL6NB  70
      * Define work field Total Quantity Ordered
     C                     Z-ADD*ZERO     WUCAQT 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDEQDT           Market Price Da
     C                     Z-ADD*ZERO     WDA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WDB8PR           Projected Marke
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field @Error Return
     C                     MOVEL*BLANK    WUWYST  5
      * Define work field Commodity Market Price
     C                     Z-ADD*ZERO     WUA5PR 114
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field Price Start Date
     C                     Z-ADD*ZERO     WUPLDT  70
      * Define work field Price End Date
     C                     Z-ADD*ZERO     WUPMDT  70
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Clear all neither parameters
      * CRT Ship Price Detail  CR - PD Ship Detail Pricing  * 
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGZXNB           Pricing Sequenc
     C                     Z-ADD*ZERO     WGBOPR           Sales Yield
     C                     Z-ADD*ZERO     WGCDPR           Market Value
     C                     Z-ADD*ZERO     WGCEPR           Credit Value
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIDPNB           Order Sequence
     C                     Z-ADD*ZERO     WIUENB           Order Secondary
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WIBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WICFC7           Order Group Cod
     C                     Z-ADD*ZERO     WIMAVA           Billing Detail
     C                     Z-ADD*ZERO     WIKDVA           Billing Detail
     C                     Z-ADD*ZERO     WIL8VA           Billing Detail
     C                     Z-ADD*ZERO     WIL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WIAYVA           Extended Amount
     C                     Z-ADD*ZERO     WIEXDT           Market Pricing
     C                     Z-ADD*ZERO     WIBZPR           Price Overage O
     C                     Z-ADD*ZERO     WIL6NB           Contract Number
     C                     Z-ADD*ZERO     WIGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WIR1NB           Rated Freight
     C                     Z-ADD*ZERO     WIAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WID0WG           Weight Ordered
     C                     Z-ADD*ZERO     WICCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WIAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WICBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WIATWG           Weight Shipped
     C                     Z-ADD*ZERO     WIAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WIAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WIAKPR           Unit Price
     C                     Z-ADD*ZERO     WIALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WIAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WIAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WIA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WIA5DT           Requested Ship
     C                     Z-ADD*ZERO     WIAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WIGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WIRGNB           Item Structure
     C                     Z-ADD*ZERO     WIRHNB           Item Structure
     C                     Z-ADD*ZERO     WIRINB           Item Structure
     C                     Z-ADD*ZERO     WICXDT           Date of Origina
     C                     Z-ADD*ZERO     WIDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WIB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WIA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WINTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WINUDT           Consumed Item C
     C                     Z-ADD*ZERO     WINVDT           Deadline Depart
     C                     Z-ADD*ZERO     WINWDT           OD Price Type R
     C                     Z-ADD*ZERO     WINXDT           OD Firm Date
     C                     Z-ADD*ZERO     WIBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WIBVTM           Price Code
     C                     Z-ADD*ZERO     WIBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WIBXTM           Substitution Li
     C                     Z-ADD*ZERO     WIBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WIH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WIH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WIH7NX           OD Item Target
     C                     Z-ADD*ZERO     WIH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WIH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WIDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WIDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WIDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WIDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WIDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WIGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WIGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WIGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WIPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WIRINY           Item Age Days
     C                     Z-ADD*ZERO     WITIDT           Production Ovr
     C                     Z-ADD*ZERO     WITJDT           Production Ovr
     C                     Z-ADD*ZERO     WITKDT           OD Market Begin
     C                     Z-ADD*ZERO     WITLDT           OD Market Endin
     C                     Z-ADD*ZERO     WITMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJC4NB           Order Number
     C                     Z-ADD*ZERO     WJANC7           AR Customer Num
     C                     Z-ADD*ZERO     WJBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WJB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WJA0DT           Order Date
     C                     Z-ADD*ZERO     WJA5DT           Requested Ship
     C                     Z-ADD*ZERO     WJGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WJACDT           Cancel Date
     C                     Z-ADD*ZERO     WJAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WJCXDT           Date of Origina
     C                     Z-ADD*ZERO     WJJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WJA1WG           Order Weight To
     C                     Z-ADD*ZERO     WJEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WJAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WJRMNB           Load ID
     C                     Z-ADD*ZERO     WJTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WJR1NB           Rated Freight
     C                     Z-ADD*ZERO     WJRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WJATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WJRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WJT3NB           Attach to Order
     C                     Z-ADD*ZERO     WJCONB           Invoice Number
     C                     Z-ADD*ZERO     WJAWDT           Invoice Date
     C                     Z-ADD*ZERO     WJVRVA           A/R order Value
     C                     Z-ADD*ZERO     WJB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WJNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WJNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WJNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WJNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WJNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WJBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WJBQTM           Time of Origina
     C                     Z-ADD*ZERO     WJBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WJBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WJBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WJH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WJH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WJH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WJH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WJH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WJC0C7           Claim Number
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field Price Status Last
     C                     MOVEL*BLANK    WUPSTL  1
      * Define work field Unit Price Last
     C                     Z-ADD*ZERO     WUDBPR 114
      * Define work field USR Sequence Num. New ATR
     C                     Z-ADD*ZERO     WUQQNB  30
      * Define work field Extended Amount Last
     C                     Z-ADD*ZERO     WUYJVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADD*ZERO     WKDPNB           Order Sequence
     C                     Z-ADD*ZERO     WKUENB           Order Secondary
     C                     Z-ADD*ZERO     WKASNO           Audit Sequence
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKAYVA           Extended Amount
     C                     Z-ADD*ZERO     WKYJVA           Extended Amount
     C                     Z-ADD*ZERO     WKAKPR           Unit Price
     C                     Z-ADD*ZERO     WKDBPR           Unit Price Last
     C                     Z-ADD*ZERO     WKALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WKDCPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Unused Parm - Value   USR
     C                     Z-ADD*ZERO     WUB5VL 112
      * Define work field Order Weight Total
     C                     Z-ADD*ZERO     WUA1WG 112
      * Define work field Production Hold
     C                     MOVEL*BLANK    WUXJST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Clear all neither parameters
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Clear all neither parameters
      * CRT Temporary Record   CR - Order Dtl Formula Dtl  * 
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005  2
     C                     Z-ADD*ZERO     WL0006  52
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  52
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  70
     C                     MOVEL*BLANK    WL0012 30
     C                     MOVEL*BLANK    WL0013  3
     C                     Z-ADD*ZERO     WL0014 114
     C                     Z-ADD*ZERO     WL0015 114
     C                     MOVEL*BLANK    WL0016  7
     C                     Z-ADD*ZERO     WL0017 112
     C                     MOVEL*BLANK    WL0018  6
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0019  30
     C                     Z-ADD*ZERO     WL0020  52
     C                     Z-ADD*ZERO     WL0021  52
      * Define local variables for subroutine SJRVGN.
     C                     MOVEL*BLANK    WL0022  3
     C                     MOVEL*BLANK    WL0023  7
     C                     Z-ADD*ZERO     WL0024  70
     C                     Z-ADD*ZERO     WL0025 114
     C                     Z-ADD*ZERO     WL0026  70
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0027  30
     C                     MOVEL*BLANK    WL0028  3
     C                     MOVEL*BLANK    WL0029  1
      * Define local variables for subroutine SURVGN.
     C                     MOVEL*BLANK    WL0030  3
     C                     MOVEL*BLANK    WL0031  7
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0001  2
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0001  52
      * Define local work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YL0002  52
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0002  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0003  1
      * Define null work field OD Gate/Final Price Adj
     C                     Z-ADD*ZERO     YN0003 114
      * Define local work field Description Line One
     C                     MOVEL*BLANK    YL0004 30
      * Define local work field Default Commod Mark basis
     C                     MOVEL*BLANK    YL0005  3
      * Define local work field Market Overage
     C                     Z-ADD*ZERO     YL0006 114
      * Define local work field Standard Overage_Underage
     C                     Z-ADD*ZERO     YL0007 114
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0008  7
      * Define local work field Std Weight_Head_Var_Ren
     C                     Z-ADD*ZERO     YL0009 112
      * Define local work field Primal Group Code
     C                     MOVEL*BLANK    YL0010  6
      * Define local work field Minimum Price   USR
     C                     Z-ADD*ZERO     YL0011 114
      * Define local work field Maximum Price  USR
     C                     Z-ADD*ZERO     YL0012 114
      * Define local work field USR Display 3
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field USR Value
     C                     Z-ADD*ZERO     YL0014 112
      * Define local work field Price Code
     C                     Z-ADD*ZERO     YL0015  60
      * Define local work field Projected Market Price
     C                     Z-ADD*ZERO     YL0016 114
      * Define local work field Price Start Date
     C                     Z-ADD*ZERO     YL0017  70
      * Define local work field Price End Date
     C                     Z-ADD*ZERO     YL0018  70
      * Define local work field Maximum Contract Units
     C                     Z-ADD*ZERO     YL0019 112
      * Define local work field Customer Price /UM Prc
     C                     Z-ADD*ZERO     YL0020 114
      * Define local work field Commodity Market Code
     C                     MOVEL*BLANK    YL0021  3
      * Define local work field Price Method Code
     C                     MOVEL*BLANK    YL0022  3
      * Define local work field Date Method Code
     C                     MOVEL*BLANK    YL0023  3
      * Define local work field Contract Unit Type
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field Price Method Type
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field PMH Price Type
     C                     MOVEL*BLANK    YL0026  1
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0027 112
      * Define local work field Price Method Code
     C                     MOVEL*BLANK    YL0028  3
      * Define local work field Weight Allocated USR
     C                     Z-ADD*ZERO     YL0029  92
      * Define local work field Text 3 Length USR
     C                     MOVEL*BLANK    YL0030  3
      * Define local work field Change Log Prior Value
     C                     MOVEL*BLANK    YL0031 12
      * Define local work field Change Log New Value
     C                     MOVEL*BLANK    YL0032 12
      * Define local work field Record Selected       USR
     C                     MOVEL*BLANK    YL0033  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD04        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * E1892 RMC 1/12/12 customer price header - sel active
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TKRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'N'       P7YZST           USR Record Upda
      * *** Delete Records from Qtemp
      * DEL Ship Formula Work  RT - Order Dtl Formula Dtl  * 
     C                     EXSR TMRVGN
      * DEL Shp Dtl Price Wrk  RT - Order Detail Pricing  * 
     C                     EXSR TORVGN
      * CPY Ship PRC t/Qtmp    RT - Order Detail Pricing  * 
     C                     EXSR TQRVGN
      * CPY Shp Dtl Form T/QtmpRT - Order Dtl Formula Dtl  * 
     C                     EXSR TSRVGN
     C                     MOVELP3U1ST    #PU1ST           Price Status
     C                     MOVELP3U1ST    WUPSTL           Price Status La
     C                     Z-ADDP3AKPR    WUDBPR           Unit Price Last
     C                     Z-ADDP3AYVA    WUYJVA           Extended Amount
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
00789007910081200814008400104501053
01096013010130901352015570156501569
01590016080181301819018280185501870
02069020840211102126023250236702562
02581026230283702879030870311003128
03343033660338403400036030361003652
03908046120461504648
** W0END
00789007990081200823008470104701079
01103013070133501359015630156601588
01591016150181501821018420186601871
02075020860212202127023480237902577
02593026350284902884030980311203133
03349033680339103407036050363903663
03919046120464404660
** W0NAM
#PU0ST    #CNCNA    #PU1ST    #CJUNA    VCEIDT    V2AIC3    #CAPTX
VPA5DT    VPBKC7    #PBRTX    VCHODT    V2C4NB    #PJNCD    #CHNNA
#CDBCD    VPGNDT    #2DPNB    #2UENB    #CBCNA    #PAUPR    #PAGCD
VPHGCD    #PAJCD    #PAKPR    #PCRCD    #PG7NA    #PAVWG    #CMTTX
#PCBQT    #PAYVA    #PATWG    #CTBNB    #CCLPR    #CTKCD    #CUYNX
#CCNBR    #CTLCD    VCG2DT    VCGIDT    #CTMCD    #CJ3NA    #CDVPR
#CDYPR    #1SEL     #RMMNA    #1BNPR
** @CN
00001 Qty Shipped  . :
00002 Qty Scheduled  :
00003 FRMPRC
00004 MSCYLD
00005 STRITM
00006 SUBCRD
00007 TCRDVY
00008 TLCRDY
00009 TLCRDV
00010 Y2U0005
00011 Y2U0003
