     H/TITLE PRC Lckbx to A/R Post  XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSHENR
     H* Date          : 05/16/23  Time  : 12:32:47
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDMACPL1IF  E           K        DISK
      * RTV : A/R Lockbox Deposit       Retrieval index
      *
     FCAEBREL2IF  E           K        DISK
      * RSQ : Bank Master               Lockbox Number
      *
     FPDMCCPL1IF  E           K        DISK
      * RTV : A/R Lockbox Check         Retrieval index
      *
     FPDMDCPL2IF  E           K        DISK
      * RSQ : A/R Lockbox Invoice       bx/ddte/bch/itm/inv
      *
     FARBDCPLGIF  E           K        DISK
      * RSQ : A/R Header                RSQ Inv/Sfx (Open)  N
      *
     FPDJ3CPL2IF  E           K        DISK
      * RSQ : A/R Adjustment Type       Co/Type Active Records
      *
     FARBECPL1IF  E           K        DISK
      * RTV : A/R Detail                Retrieval index       V
      *
     FPBC0CPL1IF  E           K        DISK
      * RTV : A/R Header Ext            Retrieval index
      *
     FOMHSTPL1IF  E           K        DISK
      * RTV : Sales History             Retrieval index
      *
     FCAASREL2IF  E           K        DISK
      * RTV : Company Control           Retrieval index       NV
      *
     FARBDCPMAIF  E           K        DISK
      * RSQ : A/R Header                Inv/InvSfx/Co
      *
     FARBECPL0IF  E           K        DISK                      A
      * UPD : A/R Detail                Update index
      *
     FARBDCPL0UF  E           K        DISK                      A
      * UPD : A/R Header                Update index
      *
     FCAASREL0UF  E           K        DISK
      * UPD : Company Control           Update index
      *
     FPDJ2CPL0IF  E           K        DISK                      A
      * UPD : A/R Bank Deposit          Update index
      *
      * Long constants
     E                    @CN#    1  03  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@MACPTS
      * A/R Lockbox Deposit       Retrieval index
      * Renamed input format fields
     I              MABEC3                          WABEC3
     I              MALWDT                          WALWDT
     I              MAYWNX                          WAYWNX
     I              MANMC1                          WANMC1
     I              MANMC2                          WANMC2
     I              MAZXVA                          WAZXVA
     I              MAAWSX                          WAAWSX
      *
     I@EBREJT
      * Bank Master               Lockbox Number
      * Renamed input format fields
     I              EBG4CD                          WBG4CD
     I              EBAUNA                          WBAUNA
     I              EBIVTX                          WBIVTX
     I              EBD4C7                          WBD4C7
     I              EBD5C7                          WBD5C7
     I              EBJOSX                          WBJOSX
     I              EBUVST                          WBUVST
     I              EBUWST                          WBUWST
     I              EBUXST                          WBUXST
     I              EBVSST                          WBVSST
     I              EBAATM                          WBAATM
     I              EBAYNA                          WBAYNA
     I              EBA0NA                          WBA0NA
     I              EBAXDT                          WBAXDT
      *
     I@MCCPTY
      * A/R Lockbox Check         Retrieval index
      * Renamed input format fields
     I              MCBEC3                          WCBEC3
     I              MCLWDT                          WCLWDT
     I              MCYWNX                          WCYWNX
     I              MCBFC3                          WCBFC3
     I              MCBGC3                          WCBGC3
     I              MCO1TX                          WCO1TX
     I              MCLXDT                          WCLXDT
     I              MCZZVA                          WCZZVA
     I              MCCWC7                          WCCWC7
     I              MCO2TX                          WCO2TX
     I              MCABSX                          WCABSX
     I              MCADSX                          WCADSX
      *
     I@MDCPT7
      * A/R Lockbox Invoice       bx/ddte/bch/itm/inv
      * Renamed input format fields
     I              MDBEC3                          WDBEC3
     I              MDLWDT                          WDLWDT
     I              MDYWNX                          WDYWNX
     I              MDBFC3                          WDBFC3
     I              MDBGC3                          WDBGC3
     I              MDNMC5                          WDNMC5
     I              MDNMC4                          WDNMC4
     I              MDNMC3                          WDNMC3
     I              MDZ0VA                          WDZ0VA
     I              MDAIC3                          WDAIC3
     I              MDUHCD                          WDUHCD
     I              MDAFSX                          WDAFSX
     I              MDNGNA                          WDNGNA
      *
     I@BDCPU3
      * A/R Header                RSQ Inv/Sfx (Open)  N
      * Renamed input format fields
     I              BDAIC3                          WEAIC3
     I              BDCONB                          WECONB
     I              BDCEST                          WECEST
     I              BDUHCD                          WEUHCD
     I              BDBSVA                          WEBSVA
     I              BDAIVA                          WEAIVA
     I              BDAOVA                          WEAOVA
     I              BDBGVA                          WEBGVA
     I              BDAJST                          WEAJST
     I              BDE3ST                          WEE3ST
     I              BDG4CD                          WEG4CD
     I              BDCKNB                          WECKNB
     I              BDCAC7                          WECAC7
     I              BDBKC7                          WEBKC7
     I              BDBCCD                          WEBCCD
     I              BDR4CD                          WER4CD
     I              BDB4DT                          WEB4DT
     I              BDATDT                          WEATDT
     I              BDH0DT                          WEH0DT
     I              BDH3DT                          WEH3DT
     I              BDH4DT                          WEH4DT
     I              BDH5DT                          WEH5DT
     I              BDANC7                          WEANC7
     I              BDCPTX                          WECPTX
     I              BDBSDY                          WEBSDY
     I              BDUVST                          WEUVST
     I              BDUWST                          WEUWST
     I              BDUXST                          WEUXST
     I              BDAATM                          WEAATM
     I              BDAYNA                          WEAYNA
     I              BDA0NA                          WEA0NA
     I              BDAXDT                          WEAXDT
      *
     I@J3CPCZ
      * A/R Adjustment Type       Co/Type Active Records
      * Renamed input format fields
     I              J3AIC3                          WFAIC3
     I              J3UHCD                          WFUHCD
     I              J3NFNA                          WFNFNA
     I              J3EAZT                          WFEAZT
     I              J3IZTX                          WFIZTX
     I              J3UKVA                          WFUKVA
     I              J3A5ST                          WFA5ST
     I              J3GLTS                          WFGLTS
     I              J3SYSC                          WFSYSC
     I              J3UVST                          WFUVST
     I              J3UWST                          WFUWST
     I              J3UXST                          WFUXST
     I              J3VSST                          WFVSST
     I              J3AATM                          WFAATM
     I              J3AYNA                          WFAYNA
     I              J3A0NA                          WFA0NA
     I              J3AXDT                          WFAXDT
      *
     I@BFCPFO
      * A/R Detail                Retrieval index       V
      * Renamed input format fields
     I              BFAIC3                          WGAIC3
     I              BFCONB                          WGCONB
     I              BFCEST                          WGCEST
     I              BFDXNB                          WGDXNB
     I              BFUHCD                          WGUHCD
     I              BFBSVA                          WGBSVA
     I              BFCPTX                          WGCPTX
     I              BFNGNA                          WGNGNA
     I              BFB4DT                          WGB4DT
     I              BFDVDT                          WGDVDT
     I              BFYXNX                          WGYXNX
     I              BFHYDT                          WGHYDT
     I              BFG4CD                          WGG4CD
     I              BFCKNB                          WGCKNB
     I              BFA5ST                          WGA5ST
     I              BFAJST                          WGAJST
     I              BFB1VN                          WGB1VN
     I              BFEAZT                          WGEAZT
     I              BFC1NY                          WGC1NY
     I              BFIZTX                          WGIZTX
     I              BFETSX                          WGETSX
     I              BFW3SX                          WGW3SX
     I              BFW4SX                          WGW4SX
     I              BFW5SX                          WGW5SX
     I              BFW6SX                          WGW6SX
     I              BFW7SX                          WGW7SX
     I              BFW8SX                          WGW8SX
     I              BFQHDT                          WGQHDT
     I              BFQIDT                          WGQIDT
     I              BFQJDT                          WGQJDT
     I              BFQKDT                          WGQKDT
     I              BFQLDT                          WGQLDT
     I              BFGLVL                          WGGLVL
     I              BFGMVL                          WGGMVL
     I              BFGNVL                          WGGNVL
     I              BFGOVL                          WGGOVL
     I              BFGPVL                          WGGPVL
     I              BFUVST                          WGUVST
     I              BFUWST                          WGUWST
     I              BFUXST                          WGUXST
     I              BFAATM                          WGAATM
     I              BFAYNA                          WGAYNA
     I              BFA0NA                          WGA0NA
     I              BFAXDT                          WGAXDT
      *
     I@C0CPYP
      * A/R Header Ext            Retrieval index
      * Renamed input format fields
     I              C0AIC3                          WHAIC3
     I              C0CONB                          WHCONB
     I              C0CEST                          WHCEST
     I              C0JNCD                          WHJNCD
     I              C0U9AA                          WHU9AA
     I              C0ATIN                          WHATIN
     I              C0T3NB                          WHT3NB
     I              C0V7DT                          WHV7DT
     I              C0HLNB                          WHHLNB
     I              C0C0C7                          WHC0C7
     I              C0D1SC                          WHD1SC
     I              C0D2SC                          WHD2SC
     I              C0D3SC                          WHD3SC
     I              C0FTU1                          WHFTU1
     I              C0FUU1                          WHFUU1
     I              C0V8DT                          WHV8DT
     I              C0V9DT                          WHV9DT
     I              C0WADT                          WHWADT
     I              C0HMNB                          WHHMNB
     I              C0N2NB                          WHN2NB
     I              C0UUN3                          WHUUN3
     I              C0UVST                          WHUVST
     I              C0UWST                          WHUWST
     I              C0UXST                          WHUXST
     I              C0AATM                          WHAATM
     I              C0AYNA                          WHAYNA
     I              C0A0NA                          WHA0NA
     I              C0AXDT                          WHAXDT
      *
     I@FHSTD3
      * Sales History             Retrieval index
      * Renamed input format fields
     I              F4AIC3                          WIAIC3
     I              F4C4NB                          WIC4NB
     I              F4DPNB                          WIDPNB
     I              F4UENB                          WIUENB
     I              F4MONA                          WIMONA
     I              F4RJCD                          WIRJCD
     I              F4RKCD                          WIRKCD
     I              F4GPTX                          WIGPTX
     I              F4ABTX                          WIABTX
     I              F4KXCD                          WIKXCD
     I              F4BOCD                          WIBOCD
     I              F4BTC7                          WIBTC7
     I              F4ANC7                          WIANC7
     I              F4AQTX                          WIAQTX
     I              F4BKC7                          WIBKC7
     I              F4BRTX                          WIBRTX
     I              F4HNNA                          WIHNNA
     I              F4DBCD                          WIDBCD
     I              F4CKTX                          WICKTX
     I              F4BCNA                          WIBCNA
     I              F4A0DT                          WIA0DT
     I              F4ACDT                          WIACDT
     I              F4R4CD                          WIR4CD
     I              F4R5CD                          WIR5CD
     I              F4BFCD                          WIBFCD
     I              F4Q4CD                          WIQ4CD
     I              F4AQCD                          WIAQCD
     I              F4TBNB                          WITBNB
     I              F4BZNA                          WIBZNA
     I              F4RLCD                          WIRLCD
     I              F4JNCD                          WIJNCD
     I              F4Q2CD                          WIQ2CD
     I              F4U2ST                          WIU2ST
     I              F4ATIN                          WIATIN
     I              F4T3NB                          WIT3NB
     I              F4RSRN                          WIRSRN
     I              F4ORIT                          WIORIT
     I              F4AJCD                          WIAJCD
     I              F4AVQT                          WIAVQT
     I              F4D0WG                          WID0WG
     I              F4CCQT                          WICCQT
     I              F4AUWG                          WIAUWG
     I              F4AGCD                          WIAGCD
     I              F4AKPR                          WIAKPR
     I              F4AUPR                          WIAUPR
     I              F4CRCD                          WICRCD
     I              F4A5DT                          WIA5DT
     I              F4AWDT                          WIAWDT
     I              F4HDDT                          WIHDDT
     I              F4AGCS                          WIAGCS
     I              F4AQCS                          WIAQCS
     I              F4AVWG                          WIAVWG
     I              F4AYVA                          WIAYVA
     I              F4AMST                          WIAMST
     I              F4ANST                          WIANST
     I              F4VAST                          WIVAST
     I              F4L6NB                          WIL6NB
     I              F4UMCD                          WIUMCD
     I              F4HCDT                          WIHCDT
     I              F4ESNB                          WIESNB
     I              F4ETNB                          WIETNB
     I              F4BZNB                          WIBZNB
     I              F4EXQT                          WIEXQT
     I              F4BYWG                          WIBYWG
     I              F4S5NB                          WIS5NB
     I              F4MAVA                          WIMAVA
     I              F4KDVA                          WIKDVA
     I              F4USVA                          WIUSVA
     I              F4UTVA                          WIUTVA
     I              F4A4WG                          WIA4WG
     I              F4CKNB                          WICKNB
     I              F4BMST                          WIBMST
     I              F4R8NB                          WIR8NB
     I              F4RMCD                          WIRMCD
     I              F4BZPR                          WIBZPR
     I              F4RDCD                          WIRDCD
     I              F4Q7CD                          WIQ7CD
     I              F4EXDT                          WIEXDT
     I              F4LQCD                          WILQCD
     I              F4HICD                          WIHICD
     I              F4RBCD                          WIRBCD
     I              F4RGNB                          WIRGNB
     I              F4RHNB                          WIRHNB
     I              F4RINB                          WIRINB
     I              F4R1NB                          WIR1NB
     I              F4CONB                          WICONB
     I              F4CEST                          WICEST
     I              F4GNDT                          WIGNDT
     I              F4RMNB                          WIRMNB
     I              F4AODT                          WIAODT
     I              F4LLCD                          WILLCD
     I              F4LMCD                          WILMCD
     I              F4SKNB                          WISKNB
     I              F4SLNB                          WISLNB
     I              F4SMNB                          WISMNB
     I              F4G7NA                          WIG7NA
     I              F4ONVA                          WIONVA
     I              F4N0CD                          WIN0CD
     I              F4B4NB                          WIB4NB
     I              F4B5NB                          WIB5NB
     I              F4N1CD                          WIN1CD
     I              F4GIDT                          WIGIDT
     I              F4Z1ST                          WIZ1ST
     I              F4ULVA                          WIULVA
     I              F4UNVA                          WIUNVA
     I              F4UOVA                          WIUOVA
     I              F4UPVA                          WIUPVA
     I              F4UQVA                          WIUQVA
     I              F4SDCD                          WISDCD
     I              F4QZCD                          WIQZCD
     I              F4XWST                          WIXWST
     I              F4T9CD                          WIT9CD
     I              F4UBCD                          WIUBCD
     I              F4CFC7                          WICFC7
     I              F4X1CD                          WIX1CD
     I              F4GASX                          WIGASX
     I              F4DUPR                          WIDUPR
     I              F4B6VL                          WIB6VL
     I              F4IANX                          WIIANX
     I              F4IBNX                          WIIBNX
     I              F4RPCD                          WIRPCD
     I              F4NYDT                          WINYDT
     I              F4BZTM                          WIBZTM
     I              F4Z4NB                          WIZ4NB
     I              F4XACD                          WIXACD
     I              F4OANA                          WIOANA
     I              F4OKTX                          WIOKTX
     I              F4K4TX                          WIK4TX
     I              F4NBBO                          WINBBO
     I              F4OCFR                          WIOCFR
     I              F4C0C7                          WIC0C7
     I              F4A1AA                          WIA1AA
     I              F4VEST                          WIVEST
     I              F4A5PR                          WIA5PR
     I              F4CDPR                          WICDPR
     I              F4D0PR                          WID0PR
     I              F4D0VL                          WID0VL
     I              F4IRSX                          WIIRSX
     I              F4CEVL                          WICEVL
     I              F4ISSX                          WIISSX
     I              F4ITSX                          WIITSX
     I              F4IUSX                          WIIUSX
     I              F4OHDT                          WIOHDT
     I              F4D9PR                          WID9PR
     I              F4CFVL                          WICFVL
     I              F4UVST                          WIUVST
     I              F4UWST                          WIUWST
     I              F4UXST                          WIUXST
     I              F4AATM                          WIAATM
     I              F4AYNA                          WIAYNA
     I              F4A0NA                          WIA0NA
     I              F4AXDT                          WIAXDT
      *
     I@BFCPFN
      * A/R Detail                Update index
      * Renamed input format fields
     I              BFAIC3                          WJAIC3
     I              BFCONB                          WJCONB
     I              BFCEST                          WJCEST
     I              BFDXNB                          WJDXNB
     I              BFUHCD                          WJUHCD
     I              BFBSVA                          WJBSVA
     I              BFCPTX                          WJCPTX
     I              BFNGNA                          WJNGNA
     I              BFB4DT                          WJB4DT
     I              BFDVDT                          WJDVDT
     I              BFYXNX                          WJYXNX
     I              BFHYDT                          WJHYDT
     I              BFG4CD                          WJG4CD
     I              BFCKNB                          WJCKNB
     I              BFA5ST                          WJA5ST
     I              BFAJST                          WJAJST
     I              BFB1VN                          WJB1VN
     I              BFEAZT                          WJEAZT
     I              BFC1NY                          WJC1NY
     I              BFIZTX                          WJIZTX
     I              BFETSX                          WJETSX
     I              BFW3SX                          WJW3SX
     I              BFW4SX                          WJW4SX
     I              BFW5SX                          WJW5SX
     I              BFW6SX                          WJW6SX
     I              BFW7SX                          WJW7SX
     I              BFW8SX                          WJW8SX
     I              BFQHDT                          WJQHDT
     I              BFQIDT                          WJQIDT
     I              BFQJDT                          WJQJDT
     I              BFQKDT                          WJQKDT
     I              BFQLDT                          WJQLDT
     I              BFGLVL                          WJGLVL
     I              BFGMVL                          WJGMVL
     I              BFGNVL                          WJGNVL
     I              BFGOVL                          WJGOVL
     I              BFGPVL                          WJGPVL
     I              BFUVST                          WJUVST
     I              BFUWST                          WJUWST
     I              BFUXST                          WJUXST
     I              BFAATM                          WJAATM
     I              BFAYNA                          WJAYNA
     I              BFA0NA                          WJA0NA
     I              BFAXDT                          WJAXDT
      *
     I@BDCPFG
      * A/R Header                Update index
      * Renamed input format fields
     I              BDAIC3                          WKAIC3
     I              BDCONB                          WKCONB
     I              BDCEST                          WKCEST
     I              BDUHCD                          WKUHCD
     I              BDBSVA                          WKBSVA
     I              BDAIVA                          WKAIVA
     I              BDAOVA                          WKAOVA
     I              BDBGVA                          WKBGVA
     I              BDAJST                          WKAJST
     I              BDE3ST                          WKE3ST
     I              BDG4CD                          WKG4CD
     I              BDCKNB                          WKCKNB
     I              BDCAC7                          WKCAC7
     I              BDBKC7                          WKBKC7
     I              BDBCCD                          WKBCCD
     I              BDR4CD                          WKR4CD
     I              BDB4DT                          WKB4DT
     I              BDATDT                          WKATDT
     I              BDH0DT                          WKH0DT
     I              BDH3DT                          WKH3DT
     I              BDH4DT                          WKH4DT
     I              BDH5DT                          WKH5DT
     I              BDANC7                          WKANC7
     I              BDCPTX                          WKCPTX
     I              BDBSDY                          WKBSDY
     I              BDUVST                          WKUVST
     I              BDUWST                          WKUWST
     I              BDUXST                          WKUXST
     I              BDAATM                          WKAATM
     I              BDAYNA                          WKAYNA
     I              BDA0NA                          WKA0NA
     I              BDAXDT                          WKAXDT
      *
     I@ASREGT
      * Company Control           Retrieval index       NV
      * Renamed input format fields
     I              ASAIC3                          WLAIC3
     I              ASAXNB                          WLAXNB
     I              ASNGNB                          WLNGNB
     I              ASBZNB                          WLBZNB
     I              ASC5NB                          WLC5NB
     I              ASC3NB                          WLC3NB
     I              ASCYNB                          WLCYNB
     I              ASIONB                          WLIONB
     I              ASI6NB                          WLI6NB
     I              ASDCNB                          WLDCNB
     I              ASC7NB                          WLC7NB
     I              ASC2NB                          WLC2NB
     I              ASC1NB                          WLC1NB
     I              ASL8NB                          WLL8NB
     I              ASBANB                          WLBANB
     I              ASCHST                          WLCHST
     I              ASCKST                          WLCKST
     I              ASCIST                          WLCIST
     I              ASCGST                          WLCGST
     I              ASAIPC                          WLAIPC
     I              ASASPC                          WLASPC
     I              ASA2VA                          WLA2VA
     I              ASC2ST                          WLC2ST
     I              ASD8ST                          WLD8ST
     I              ASD7ST                          WLD7ST
     I              ASA8NA                          WLA8NA
     I              ASA9NA                          WLA9NA
     I              ASBANA                          WLBANA
     I              ASBBNA                          WLBBNA
     I              ASEUST                          WLEUST
     I              ASAADY                          WLAADY
     I              ASABDY                          WLABDY
     I              ASACDY                          WLACDY
     I              ASADDY                          WLADDY
     I              ASAEDY                          WLAEDY
     I              ASAFDY                          WLAFDY
     I              ASAGDY                          WLAGDY
     I              ASAHDY                          WLAHDY
     I              ASAENB                          WLAENB
     I              ASALNB                          WLALNB
     I              ASEVNB                          WLEVNB
     I              ASRPOP                          WLRPOP
     I              ASDWNB                          WLDWNB
     I              ASR3NB                          WLR3NB
     I              ASPNST                          WLPNST
     I              ASR4NB                          WLR4NB
     I              ASPOST                          WLPOST
     I              ASSCNB                          WLSCNB
     I              ASVIST                          WLVIST
     I              ASVJST                          WLVJST
     I              ASBVVN                          WLBVVN
     I              ASUVST                          WLUVST
     I              ASUWST                          WLUWST
     I              ASUXST                          WLUXST
     I              ASVSST                          WLVSST
     I              ASAATM                          WLAATM
     I              ASAYNA                          WLAYNA
     I              ASA0NA                          WLA0NA
     I              ASAXDT                          WLAXDT
      *
     I@BDCPP3
      * A/R Header                Inv/InvSfx/Co
      * Renamed input format fields
     I              BDAIC3                          WMAIC3
     I              BDCONB                          WMCONB
     I              BDCEST                          WMCEST
     I              BDUHCD                          WMUHCD
     I              BDBSVA                          WMBSVA
     I              BDAIVA                          WMAIVA
     I              BDAOVA                          WMAOVA
     I              BDBGVA                          WMBGVA
     I              BDAJST                          WMAJST
     I              BDE3ST                          WME3ST
     I              BDG4CD                          WMG4CD
     I              BDCKNB                          WMCKNB
     I              BDCAC7                          WMCAC7
     I              BDBKC7                          WMBKC7
     I              BDBCCD                          WMBCCD
     I              BDR4CD                          WMR4CD
     I              BDB4DT                          WMB4DT
     I              BDATDT                          WMATDT
     I              BDH0DT                          WMH0DT
     I              BDH3DT                          WMH3DT
     I              BDH4DT                          WMH4DT
     I              BDH5DT                          WMH5DT
     I              BDANC7                          WMANC7
     I              BDCPTX                          WMCPTX
     I              BDBSDY                          WMBSDY
     I              BDUVST                          WMUVST
     I              BDUWST                          WMUWST
     I              BDUXST                          WMUXST
     I              BDAATM                          WMAATM
     I              BDAYNA                          WMAYNA
     I              BDA0NA                          WMA0NA
     I              BDAXDT                          WMAXDT
      *
     I@ASRECB
      * Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WOAIC3
     I              ASAXNB                          WOAXNB
     I              ASNGNB                          WONGNB
     I              ASBZNB                          WOBZNB
     I              ASC5NB                          WOC5NB
     I              ASC3NB                          WOC3NB
     I              ASCYNB                          WOCYNB
     I              ASIONB                          WOIONB
     I              ASI6NB                          WOI6NB
     I              ASDCNB                          WODCNB
     I              ASC7NB                          WOC7NB
     I              ASC2NB                          WOC2NB
     I              ASC1NB                          WOC1NB
     I              ASL8NB                          WOL8NB
     I              ASBANB                          WOBANB
     I              ASCHST                          WOCHST
     I              ASCKST                          WOCKST
     I              ASCIST                          WOCIST
     I              ASCGST                          WOCGST
     I              ASAIPC                          WOAIPC
     I              ASASPC                          WOASPC
     I              ASA2VA                          WOA2VA
     I              ASC2ST                          WOC2ST
     I              ASD8ST                          WOD8ST
     I              ASD7ST                          WOD7ST
     I              ASA8NA                          WOA8NA
     I              ASA9NA                          WOA9NA
     I              ASBANA                          WOBANA
     I              ASBBNA                          WOBBNA
     I              ASEUST                          WOEUST
     I              ASAADY                          WOAADY
     I              ASABDY                          WOABDY
     I              ASACDY                          WOACDY
     I              ASADDY                          WOADDY
     I              ASAEDY                          WOAEDY
     I              ASAFDY                          WOAFDY
     I              ASAGDY                          WOAGDY
     I              ASAHDY                          WOAHDY
     I              ASAENB                          WOAENB
     I              ASALNB                          WOALNB
     I              ASEVNB                          WOEVNB
     I              ASRPOP                          WORPOP
     I              ASDWNB                          WODWNB
     I              ASR3NB                          WOR3NB
     I              ASPNST                          WOPNST
     I              ASR4NB                          WOR4NB
     I              ASPOST                          WOPOST
     I              ASSCNB                          WOSCNB
     I              ASVIST                          WOVIST
     I              ASVJST                          WOVJST
     I              ASBVVN                          WOBVVN
     I              ASUVST                          WOUVST
     I              ASUWST                          WOUWST
     I              ASUXST                          WOUXST
     I              ASVSST                          WOVSST
     I              ASAATM                          WOAATM
     I              ASAYNA                          WOAYNA
     I              ASA0NA                          WOA0NA
     I              ASAXDT                          WOAXDT
      *
     I@J2CPCM
      * A/R Bank Deposit          Update index
      * Renamed input format fields
     I              J2G4CD                          WRG4CD
     I              J2HXDT                          WRHXDT
     I              J2YXNX                          WRYXNX
     I              J2UIVA                          WRUIVA
     I              J2UJVA                          WRUJVA
     I              J2AJST                          WRAJST
     I              J2CKNB                          WRCKNB
     I              J2BHNB                          WRBHNB
     I              J2BINB                          WRBINB
     I              J2E2VL                          WRE2VL
     I              J2E3VL                          WRE3VL
     I              J2E4VL                          WRE4VL
     I              J2E5VL                          WRE5VL
     I              J2E6VL                          WRE6VL
     I              J2E7VL                          WRE7VL
     I              J2E8VL                          WRE8VL
     I              J2E9VL                          WRE9VL
     I              J2FAVL                          WRFAVL
     I              J2FBVL                          WRFBVL
     I              J2FCVL                          WRFCVL
     I              J2FDVL                          WRFDVL
     I              J2HYDT                          WRHYDT
     I              J2UVST                          WRUVST
     I              J2UWST                          WRUWST
     I              J2UXST                          WRUXST
     I              J2VSST                          WRVSST
     I              J2AATM                          WRAATM
     I              J2AYNA                          WRAYNA
     I              J2A0NA                          WRA0NA
     I              J2AXDT                          WRAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * Outward parameters
     IPARC        DS                             23
      * KEY : A/R Lockbox Invoice       bx/ddte/bch/itm/inv
      * I :  LckBx Number
     I                                    P   1   40PABEC3
      * I :  LckBx Deposit Date
     I                                    P   5   80PALWDT
      * I :  LckBx Deposit Time
     I                                    P   9  110PAYWNX
      * I :  LckBx Batch Number
     I                                    P  12  130PABFC3
      * I :  LckBx Item Number
     I                                    P  14  150PABGC3
      * I :  LckBx Invoice Number
     I                                    P  16  200PANMC3
      * I :  Adjustment Type Code
     I                                       21  23 PAUHCD
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQARBE1    E DSARBECPL0
      * UPD : A/R Detail                Update index
      * Renamed input format fields
     I              BFAIC3                          WJAIC3
     I              BFCONB                          WJCONB
     I              BFCEST                          WJCEST
     I              BFDXNB                          WJDXNB
     I              BFUHCD                          WJUHCD
     I              BFBSVA                          WJBSVA
     I              BFCPTX                          WJCPTX
     I              BFNGNA                          WJNGNA
     I              BFB4DT                          WJB4DT
     I              BFDVDT                          WJDVDT
     I              BFYXNX                          WJYXNX
     I              BFHYDT                          WJHYDT
     I              BFG4CD                          WJG4CD
     I              BFCKNB                          WJCKNB
     I              BFA5ST                          WJA5ST
     I              BFAJST                          WJAJST
     I              BFB1VN                          WJB1VN
     I              BFEAZT                          WJEAZT
     I              BFC1NY                          WJC1NY
     I              BFIZTX                          WJIZTX
     I              BFETSX                          WJETSX
     I              BFW3SX                          WJW3SX
     I              BFW4SX                          WJW4SX
     I              BFW5SX                          WJW5SX
     I              BFW6SX                          WJW6SX
     I              BFW7SX                          WJW7SX
     I              BFW8SX                          WJW8SX
     I              BFQHDT                          WJQHDT
     I              BFQIDT                          WJQIDT
     I              BFQJDT                          WJQJDT
     I              BFQKDT                          WJQKDT
     I              BFQLDT                          WJQLDT
     I              BFGLVL                          WJGLVL
     I              BFGMVL                          WJGMVL
     I              BFGNVL                          WJGNVL
     I              BFGOVL                          WJGOVL
     I              BFGPVL                          WJGPVL
     I              BFUVST                          WJUVST
     I              BFUWST                          WJUWST
     I              BFUXST                          WJUXST
     I              BFAATM                          WJAATM
     I              BFAYNA                          WJAYNA
     I              BFA0NA                          WJA0NA
     I              BFAXDT                          WJAXDT
      *
     IQARBD1    E DSARBDCPL0
      * UPD : A/R Header                Update index
      * Renamed input format fields
     I              BDAIC3                          WKAIC3
     I              BDCONB                          WKCONB
     I              BDCEST                          WKCEST
     I              BDUHCD                          WKUHCD
     I              BDBSVA                          WKBSVA
     I              BDAIVA                          WKAIVA
     I              BDAOVA                          WKAOVA
     I              BDBGVA                          WKBGVA
     I              BDAJST                          WKAJST
     I              BDE3ST                          WKE3ST
     I              BDG4CD                          WKG4CD
     I              BDCKNB                          WKCKNB
     I              BDCAC7                          WKCAC7
     I              BDBKC7                          WKBKC7
     I              BDBCCD                          WKBCCD
     I              BDR4CD                          WKR4CD
     I              BDB4DT                          WKB4DT
     I              BDATDT                          WKATDT
     I              BDH0DT                          WKH0DT
     I              BDH3DT                          WKH3DT
     I              BDH4DT                          WKH4DT
     I              BDH5DT                          WKH5DT
     I              BDANC7                          WKANC7
     I              BDCPTX                          WKCPTX
     I              BDBSDY                          WKBSDY
     I              BDUVST                          WKUVST
     I              BDUWST                          WKUWST
     I              BDUXST                          WKUXST
     I              BDAATM                          WKAATM
     I              BDAYNA                          WKAYNA
     I              BDA0NA                          WKA0NA
     I              BDAXDT                          WKAXDT
      *
     IYARDCS      DS                            134
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCAAS1    E DSCAASREL0
      * UPD : Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WOAIC3
     I              ASAXNB                          WOAXNB
     I              ASNGNB                          WONGNB
     I              ASBZNB                          WOBZNB
     I              ASC5NB                          WOC5NB
     I              ASC3NB                          WOC3NB
     I              ASCYNB                          WOCYNB
     I              ASIONB                          WOIONB
     I              ASI6NB                          WOI6NB
     I              ASDCNB                          WODCNB
     I              ASC7NB                          WOC7NB
     I              ASC2NB                          WOC2NB
     I              ASC1NB                          WOC1NB
     I              ASL8NB                          WOL8NB
     I              ASBANB                          WOBANB
     I              ASCHST                          WOCHST
     I              ASCKST                          WOCKST
     I              ASCIST                          WOCIST
     I              ASCGST                          WOCGST
     I              ASAIPC                          WOAIPC
     I              ASASPC                          WOASPC
     I              ASA2VA                          WOA2VA
     I              ASC2ST                          WOC2ST
     I              ASD8ST                          WOD8ST
     I              ASD7ST                          WOD7ST
     I              ASA8NA                          WOA8NA
     I              ASA9NA                          WOA9NA
     I              ASBANA                          WOBANA
     I              ASBBNA                          WOBBNA
     I              ASEUST                          WOEUST
     I              ASAADY                          WOAADY
     I              ASABDY                          WOABDY
     I              ASACDY                          WOACDY
     I              ASADDY                          WOADDY
     I              ASAEDY                          WOAEDY
     I              ASAFDY                          WOAFDY
     I              ASAGDY                          WOAGDY
     I              ASAHDY                          WOAHDY
     I              ASAENB                          WOAENB
     I              ASALNB                          WOALNB
     I              ASEVNB                          WOEVNB
     I              ASRPOP                          WORPOP
     I              ASDWNB                          WODWNB
     I              ASR3NB                          WOR3NB
     I              ASPNST                          WOPNST
     I              ASR4NB                          WOR4NB
     I              ASPOST                          WOPOST
     I              ASSCNB                          WOSCNB
     I              ASVIST                          WOVIST
     I              ASVJST                          WOVJST
     I              ASBVVN                          WOBVVN
     I              ASUVST                          WOUVST
     I              ASUWST                          WOUWST
     I              ASUXST                          WOUXST
     I              ASVSST                          WOVSST
     I              ASAATM                          WOAATM
     I              ASAYNA                          WOAYNA
     I              ASA0NA                          WOA0NA
     I              ASAXDT                          WOAXDT
      *
     IYBRDCS      DS                            278
     IQPDJ21    E DSPDJ2CPL0
      * UPD : A/R Bank Deposit          Update index
      * Renamed input format fields
     I              J2G4CD                          WRG4CD
     I              J2HXDT                          WRHXDT
     I              J2YXNX                          WRYXNX
     I              J2UIVA                          WRUIVA
     I              J2UJVA                          WRUJVA
     I              J2AJST                          WRAJST
     I              J2CKNB                          WRCKNB
     I              J2BHNB                          WRBHNB
     I              J2BINB                          WRBINB
     I              J2E2VL                          WRE2VL
     I              J2E3VL                          WRE3VL
     I              J2E4VL                          WRE4VL
     I              J2E5VL                          WRE5VL
     I              J2E6VL                          WRE6VL
     I              J2E7VL                          WRE7VL
     I              J2E8VL                          WRE8VL
     I              J2E9VL                          WRE9VL
     I              J2FAVL                          WRFAVL
     I              J2FBVL                          WRFBVL
     I              J2FCVL                          WRFCVL
     I              J2FDVL                          WRFDVL
     I              J2HYDT                          WRHYDT
     I              J2UVST                          WRUVST
     I              J2UWST                          WRUWST
     I              J2UXST                          WRUXST
     I              J2VSST                          WRVSST
     I              J2AATM                          WRAATM
     I              J2AYNA                          WRAYNA
     I              J2A0NA                          WRA0NA
     I              J2AXDT                          WRAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             24
      * RCD: A/R Lockbox Deposit       Retrieval index
      * I :  LckBx Number
     I                                    P   1   40P1BEC3
      * I :  LckBx Deposit Date
     I                                    P   5   80P1LWDT
      * I :  LckBx Deposit Time
     I                                    P   9  110P1YWNX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           RCD: A/R Lockbo
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRC Lckbx to A/R Post  XF
      * RMC 5/16/2023 For getting the ar exempt for RB , added check for
      *     adjustment type= PAY. a RB payment came in with PAY
      * RMC 12/15/22 W116222 the below didnt work right. changed to check
      *   for adj type=CB AND the suffix is RB/CB rather than OR.
      * SUFFIX=IN AND ADJ TYPE=CB WERENT GETTING THE TF EXEMPT CODE
      * RMC 1/11/18 S12308 get ar tf exempt from ar header ext for CB,RB
      * RMC 2/25/15 C3977 -  for CB suffix, output orig inv from a/r head
      * RMC 4/12/14 E3103 -  for CB suffix, force exempt to NE
      * RMC 1/24/14 E2991 -  for CB, get next # from company control
      * PRC Lckbx to A/R Post  RT - A/R Lockbox Deposit  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * PRC Lckbx to A/R Post  RT - A/R Lockbox Deposit  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  6        Bank Code
     C                     Z-ADD*ZERO     WN0002 112       Total Cash Appl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WABEC3           LckBx Number
     C                     KFLD           WALWDT           LckBx Deposit D
     C                     KFLD           WAYWNX           LckBx Deposit T
      * Setup key
     C                     Z-ADDP1BEC3    WABEC3           LckBx Number
     C                     Z-ADDP1LWDT    WALWDT           LckBx Deposit D
     C                     Z-ADDP1YWNX    WAYWNX           LckBx Deposit T
      * Establish starting position
     C           KRSSA     CHAIN@MACPTS              90    *
      * Data record not found
     C   90                MOVEL'USR2646' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Determine Bank.
     C                     EXSR UASUBR                     Determine Bank.
     C                     Z-ADD*ZERO     WN0002           Total Cash Appl
      * *** Process the Bank Deposit. ***
      * PRC Lckbx to A/R Post  RT - A/R Lockbox Check  * 
     C                     EXSR SCRVGN
      * *** Create a Bank Deposit Record. ***
      * CRT AR A/R Bank DepositCR - A/R Bank Deposit  * 
     C                     EXSR SPCRRC
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Bank Cd f/Lckbx   RT - Bank Master  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBD4C7    WQSB02           Bank LckBx Numb
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB02           Bank LckBx Numb
      * Setup key
     C                     Z-ADDWABEC3    WQSB02           Bank LckBx Numb
      * Establish starting position
     C           KRSSB     SETLL@EBREJT                    *
     C           KRSSB     READE@EBREJT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0850' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0001           Bank Code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBG4CD    WN0001           Bank Code
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@EBREJT                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * PRC Lckbx to A/R Post  RT - A/R Lockbox Check  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCBEC3    WQSC01           LckBx Number
     C           *LIKE     DEFN WCLWDT    WQSC02           LckBx Deposit D
     C           *LIKE     DEFN WCYWNX    WQSC03           LckBx Deposit T
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           LckBx Number
     C                     KFLD           WQSC02           LckBx Deposit D
     C                     KFLD           WQSC03           LckBx Deposit T
      * Setup key
     C                     Z-ADDWABEC3    WQSC01           LckBx Number
     C                     Z-ADDWALWDT    WQSC02           LckBx Deposit D
     C                     Z-ADDWAYWNX    WQSC03           LckBx Deposit T
      * Establish starting position
     C           KRSSC     SETLL@MCCPTY                    *
     C           KRSSC     READE@MCCPTY                  90*
      * Data record not found
     C   90                MOVEL'USR2650' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.LckBx Hold Flag is No
     C           WCADSX    IFEQ 'N'                        *IF
      * *** Process all of the invoice trans. for each check. ***
     C                     EXSR UBSUBR                     *** Process all
     C                     END                             *FI
     C           KRSSC     READE@MCCPTY                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * PRC Lckbx to A/R Post  RT - A/R Lockbox Invoice  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  90       Save Invoice Nu
     C                     MOVEL*BLANK    WN0004  3        Save Adjustment
     C                     Z-ADD*ZERO     WN0005 112       LckBx Total Inv
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0003           Save Invoice Nu
     C                     MOVEL*BLANK    WN0004           Save Adjustment
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDBEC3    WQSD02           LckBx Number
     C           *LIKE     DEFN WDLWDT    WQSD03           LckBx Deposit D
     C           *LIKE     DEFN WDYWNX    WQSD04           LckBx Deposit T
     C           *LIKE     DEFN WDBFC3    WQSD05           LckBx Batch Num
     C           *LIKE     DEFN WDBGC3    WQSD06           LckBx Item Numb
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD02           LckBx Number
     C                     KFLD           WQSD03           LckBx Deposit D
     C                     KFLD           WQSD04           LckBx Deposit T
     C                     KFLD           WQSD05           LckBx Batch Num
     C                     KFLD           WQSD06           LckBx Item Numb
      * Setup key
     C                     Z-ADDWCBEC3    WQSD02           LckBx Number
     C                     Z-ADDWCLWDT    WQSD03           LckBx Deposit D
     C                     Z-ADDWCYWNX    WQSD04           LckBx Deposit T
     C                     Z-ADDWCBFC3    WQSD05           LckBx Batch Num
     C                     Z-ADDWCBGC3    WQSD06           LckBx Item Numb
      * Establish starting position
     C           KRSSD     SETLL@MDCPT7                    *
     C           KRSSD     READE@MDCPT7                  90*
      * Data record not found
     C   90                MOVEL'USR2652' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.LckBx Invoice Number EQ PAR.Save Invoice Number
      *   |- c2    : DB1.Adjustment Type Code EQ PAR.Save Adjustment Type
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDNMC3    IFEQ WN0003                     *IF
     C           WDUHCD    IFEQ WN0004                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * *** Skip Lockbox Invoice Record ***
     C                     ELSE
      * CASE: *OTHERWISE
      * Find A/R Header record for the Lockbox Invoice.
     C                     EXSR UCSUBR                     Find A/R Header
     C                     END                             *FI
     C                     Z-ADDWDNMC3    WN0003           Save Invoice Nu
     C                     MOVELWDUHCD    WN0004           Save Adjustment
     C                     MOVEL*BLANK    W0RTN            *Return code
     C           KRSSD     READE@MDCPT7                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * PRC Lckbx to A/R Post RTV - A/R Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0006  30       Sequence Number
     C                     MOVEL*BLANK    WN0007  3        Cash/Adj
     C                     Z-ADD*ZERO     WN0008  30       G/L Posting Com
     C                     MOVEL*BLANK    WN0009  8        G/L ID Code JDE
     C                     Z-ADD*ZERO     WN0010 112       Adjustment Amou
     C                     Z-ADD*ZERO     WN0011 112       Amount Paid
     C                     Z-ADD*ZERO     WN0012 112       Remaining Balan
     C                     Z-ADD*ZERO     WN0013  70       Last Payment Da
     C                     Z-ADD*ZERO     WN0014  70       Paid in Full Da
     C                     Z-ADD*ZERO     WN0015  50       Days to Pay
     C                     Z-ADD*ZERO     WN0016  70       Invoice Number
     C                     MOVEL*BLANK    WN0017  1        First Time Flag
     C                     MOVEL*BLANK    WN0018  1        Record Created
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * modification history
     C                     EXSR UDSUBR                     modification hi
      * Declare restrictor key work fields
     C           *LIKE     DEFN WECONB    WQSE02           Invoice Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE02           Invoice Number
      * Setup key
     C                     Z-ADDWDNMC3    WQSE02           Invoice Number
      * Establish starting position
     C           KRSSE     SETLL@BDCPU3                    *
     C           KRSSE     READE@BDCPU3                  90*
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * *** Get G/L Code for Adjustment Type.
      * RTV G/L ID Code JDE    RT - A/R Adjustment Type  * 
     C                     EXSR SFRVGN
      * Determine Values for Miscellaneous A/R Fields.
     C                     EXSR UESUBR                     Determine Value
      * File Creates & Updates.
     C                     EXSR UHSUBR                     File Creates &
      * *** Stop after first A/R Header Record. ***
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@BDCPU3                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV G/L ID Code JDE    RT - A/R Adjustment Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFUHCD    WQSF02           Adjustment Type
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Adjustment Type
      * Setup key
     C                     Z-ADDWEAIC3    WQSF01           Company Number
     C                     MOVELWDUHCD    WQSF02           Adjustment Type
      * Establish starting position
     C           KRSSF     SETLL@J3CPCZ                    *
     C           KRSSF     READE@J3CPCZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2041' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0009           G/L ID Code JDE
     C                     MOVEL*BLANK    WN0007           Cash/Adj
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFIZTX    WN0009           G/L ID Code JDE
     C                     MOVELWFA5ST    WN0007           Cash/Adj
     C           KRSSF     READE@J3CPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Next Seq. No.      RT - A/R Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WGCONB    WQSG02           Invoice Number
     C           *LIKE     DEFN WGCEST    WQSG03           Invoice Suffix
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Invoice Number
     C                     KFLD           WQSG03           Invoice Suffix
     C                     KFLD           WGDXNB           Sequence Number
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Invoice Number
     C                     KFLD           WQSG03           Invoice Suffix
      * Setup key
     C                     Z-ADDWEAIC3    WQSG01           Company Number
     C                     Z-ADDWECONB    WQSG02           Invoice Number
     C                     MOVELWECEST    WQSG03           Invoice Suffix
     C                     Z-ADDWN0006    WGDXNB           Sequence Number
      * Establish starting position
     C           KPSSG     SETLL@BFCPFO                    *
     C           KRSSG     READE@BFCPFO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0178' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WN0006           Sequence Number
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWGDXNB    WN0006           Sequence Number
     C           KRSSG     READE@BFCPFO                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     ADD  1         WN0006           Sequence Number
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Orig Order/Inv    RT - A/R Header Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHCONB           Invoice Number
     C                     KFLD           WHCEST           Invoice Suffix
      * Setup key
     C                     Z-ADDWL0001    WHAIC3           Company Number
     C                     Z-ADDWL0002    WHCONB           Invoice Number
     C                     MOVELWL0003    WHCEST           Invoice Suffix
      * Establish starting position
     C           KRSSH     CHAIN@C0CPYP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4952' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0004           Attach to Invoi
     C                     Z-ADD*ZERO     WL0005           Attach to Order
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHATIN    WL0004           Attach to Invoi
     C                     Z-ADDWHT3NB    WL0005           Attach to Order
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV TF AR Exempt f/ordRT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WIC4NB    WQSI02           Order Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
      * Setup key
     C                     Z-ADDWL0006    WQSI01           Company Number
     C                     Z-ADDWL0007    WQSI02           Order Number
      * Establish starting position
     C           KRSSI     SETLL@FHSTD3                    *
     C           KRSSI     READE@FHSTD3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1241' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0008           Order TF Exempt
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIIUSX    WL0008           Order TF Exempt
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@FHSTD3                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * CRT A/R Detail (Lckbx) CR - A/R Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BFCPFN
     C                     Z-ADDWEAIC3    WJAIC3           Company Number
     C                     Z-ADDWECONB    WJCONB           Invoice Number
     C                     MOVELWECEST    WJCEST           Invoice Suffix
     C                     Z-ADDWN0006    WJDXNB           Sequence Number
     C                     MOVELWDUHCD    WJUHCD           Adjustment Type
     C                     Z-ADDWN0005    WJBSVA           Transaction Amo
     C                     MOVELWCO1TX    WJCPTX           A/R Check Numbe
     C                     MOVELYL0004    WJNGNA           Explanation
     C                     Z-ADD##JDT     WJB4DT           Transaction Dat
     C                     Z-ADDWDLWDT    WJDVDT           Payment/Deposit
     C                     Z-ADDWDYWNX    WJYXNX           Deposit Time
     C                     Z-ADD*ZERO     WJHYDT           G/L Post Date
     C                     MOVELWN0001    WJG4CD           Bank Code
     C                     Z-ADD*ZERO     WJCKNB           GL Document Num
     C                     MOVELWN0007    WJA5ST           Cash/Adj
     C                     MOVEL'E'       WJAJST           A/R Processing
     C                     MOVEL@CN,001   WJB1VN           Originating Pro
     C                     MOVEL*BLANK    WJEAZT           Effect on Accou
     C                     Z-ADDWN0008    WJC1NY           G/L Posting Com
     C                     MOVELWN0009    WJIZTX           G/L ID Code JDE
     C                     MOVEL'N'       WJETSX           Post Adjustment
     C                     MOVELYL0001    WJW3SX           A/R TF Exempt C
     C                     MOVEL*BLANK    WJW4SX           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WJW5SX           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WJW6SX           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WJW7SX           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WJW8SX           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WJQHDT           TFS Adj Week-En
     C                     Z-ADDWEH3DT    WJQIDT           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WJQJDT           A/R Invoice Num
     C                     Z-ADD*ZERO     WJQKDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WJQLDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WJGLVL           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WJGMVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WJGNVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WJGOVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WJGPVL           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WJUVST           EDI Status 1
     C                     MOVEL*BLANK    WJUWST           EDI Status 2
     C                     MOVEL*BLANK    WJUXST           EDI Status 3
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL@CN,002   WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      *
     C           KLCRSJ    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJCONB           Invoice Number
     C                     KFLD           WJCEST           Invoice Suffix
     C                     KFLD           WJDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@BFCPFN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0179' W0RTN   7
      * Send message 'A/R Detail             EX'
     C                     MOVEL'USR0179' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@BFCPFN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * CHG A/R Detail (Lckbx) CH - A/R Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0019  3        Adjustment Type
     C                     Z-ADD*ZERO     WN0020 112       Transaction Amo
     C                     MOVEL*BLANK    WN0021  1        A/R Processing
     C                     MOVEL*BLANK    WN0022  1        Purge Status
     C                     Z-ADD*ZERO     WN0023  80       GL Document Num
     C                     Z-ADD*ZERO     WN0024  70       Order Number Re
     C                     Z-ADD*ZERO     WN0025  70       Ship To Custome
     C                     MOVEL*BLANK    WN0026  3        Salesperson Cod
     C                     MOVEL*BLANK    WN0027  3        Sales Route Cod
     C                     Z-ADD*ZERO     WN0028  70       Transaction Dat
     C                     Z-ADD*ZERO     WN0029  70       Due Date
     C                     Z-ADD*ZERO     WN0030  70       Original Inv fo
     C                     Z-ADD*ZERO     WN0031  70       Last G/L Post D
     C                     Z-ADD*ZERO     WN0032  70       AR Customer Num
     C                     MOVEL*BLANK    WN0033  1        EDI Status 1
     C                     MOVEL*BLANK    WN0034  1        EDI Status 2
     C                     MOVEL*BLANK    WN0035  1        EDI Status 3
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BDCPFG
     C                     Z-ADDWEAIC3    WKAIC3           Company Number
     C                     Z-ADDWECONB    WKCONB           Invoice Number
     C                     MOVELWECEST    WKCEST    P      Invoice Suffix
      *
     C           KLCHSK    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKCONB           Invoice Number
     C                     KFLD           WKCEST           Invoice Suffix
     C           KLCHSK    CHAIN@BDCPFG              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ARBDCPL0'MDACP
     C                     MOVEL'@BDCPFG' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QARBD1    YARDCS
      * Move non-key fields to @BDCPFG
     C                     Z-ADDWN0010    WKAIVA           Adjustment Amou
     C                     Z-ADDWN0011    WKAOVA           Amount Paid
     C                     Z-ADDWN0012    WKBGVA           Remaining Balan
     C                     MOVELWN0001    WKG4CD    P      Bank Code
     C                     Z-ADDWN0013    WKH0DT           Last Payment Da
     C                     Z-ADDWN0014    WKH4DT           Paid in Full Da
     C                     MOVELWCO1TX    WKCPTX    P      A/R Check Numbe
     C                     Z-ADDWN0015    WKBSDY           Days to Pay
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL@CN,002   WKAYNA    P      User Id
     C                     MOVEL##PGM     WKA0NA    P      Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QARBD1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BDCPFG                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKARBDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Next CB Number     RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WLAIC3           Company Number
      * Setup key
     C                     Z-ADD*ZERO     WLAIC3           Company Number
      * Establish starting position
     C           KRSSL     CHAIN@ASREGT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0005           Next Charge Bac
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWLIONB    YL0005           Next Charge Bac
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Check invc exists  RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMCONB    WQSM01           Invoice Number
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Invoice Number
      * Setup key
     C                     Z-ADDWL0009    WQSM01           Invoice Number
      * Establish starting position
     C           KRSSM     SETLL@BDCPP3                    *
     C           KRSSM     READE@BDCPP3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0174' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSM     READE@BDCPP3                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * RTV Next Charge Back# CH - Company Control  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0036  40       Current Account
     C                     Z-ADD*ZERO     WN0037  20       Current Account
     C                     Z-ADD*ZERO     WN0038  30       OM Week
     C                     Z-ADD*ZERO     WN0039  70       Next Order Numb
     C                     Z-ADD*ZERO     WN0040  70       Next Invoice Nu
     C                     Z-ADD*ZERO     WN0041  70       Next Credit Mem
     C                     Z-ADD*ZERO     WN0042  70       Next On Acct Ca
     C                     Z-ADD*ZERO     WN0043  70       Next Voucher Nu
     C                     Z-ADD*ZERO     WN0044  70       Next Customer #
     C                     Z-ADD*ZERO     WN0045  70       Next Inventory
     C                     Z-ADD*ZERO     WN0046  80       Next PFS Batch
     C                     Z-ADD*ZERO     WN0047  70       Next Contract/P
     C                     Z-ADD*ZERO     WN0048  60       Next HPB Batch
     C                     MOVEL*BLANK    WN0049  1        Auto Order Numb
     C                     MOVEL*BLANK    WN0050  1        Auto Voucher Nu
     C                     MOVEL*BLANK    WN0051  1        Auto Customers
     C                     MOVEL*BLANK    WN0052  1        Auto Inv. Ref.
     C                     Z-ADD*ZERO     WN0053  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0054  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0055 112       Late Charge Min
     C                     MOVEL*BLANK    WN0056  1        Print Co Addr o
     C                     MOVEL*BLANK    WN0057  1        Credit Hold Sta
     C                     MOVEL*BLANK    WN0058  1        Allocate Credit
     C                     MOVEL*BLANK    WN0059 30        Message Line 1
     C                     MOVEL*BLANK    WN0060 30        Message Line 2
     C                     MOVEL*BLANK    WN0061 30        Message Line 3
     C                     MOVEL*BLANK    WN0062 30        Message Line 4
     C                     MOVEL*BLANK    WN0063  1        Age by Trans or
     C                     Z-ADD*ZERO     WN0064  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0065  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0066  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0067  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0068  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0069  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0070  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0071  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0072  30       Retention Perio
     C                     Z-ADD*ZERO     WN0073  30       Retention Perio
     C                     Z-ADD*ZERO     WN0074  30       Retention Perio
     C                     Z-ADD*ZERO     WN0075  30       Retention Perio
     C                     Z-ADD*ZERO     WN0076  30       Retention Perio
     C                     Z-ADD*ZERO     WN0077  70       Next Load ID
     C                     MOVEL*BLANK    WN0078  1        Auto Load Numbe
     C                     Z-ADD*ZERO     WN0079  70       Next Item Numbe
     C                     MOVEL*BLANK    WN0080  1        G/L Posted Code
     C                     Z-ADD*ZERO     WN0081  30       Production Numb
     C                     MOVEL*BLANK    WN0082  1        Freight by Poun
     C                     MOVEL*BLANK    WN0083  1        Price Audit Act
     C                     MOVEL*BLANK    WN0084 10        PRT Night Queue
     C                     MOVEL*BLANK    WN0085  1        EDI Status 1
     C                     MOVEL*BLANK    WN0086  1        EDI Status 2
     C                     MOVEL*BLANK    WN0087  1        EDI Status 3
     C                     MOVEL*BLANK    WN0088  1        Record Status
     C                     Z-ADD*ZERO     WN0089  60       Job Time
     C                     MOVEL*BLANK    WN0090 10        User Id
     C                     MOVEL*BLANK    WN0091 10        Job Name
     C                     Z-ADD*ZERO     WN0092  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @ASRECB
     C                     Z-ADD*ZERO     WOAIC3           Company Number
      *
     C           KLCHSN    KLIST
     C                     KFLD           WOAIC3           Company Number
     C           KLCHSN    CHAIN@ASRECB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAASREL0'MDACP
     C                     MOVEL'@ASRECB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAAS1    YBRDCS
      * Move non-key fields to @ASRECB
     C                     Z-ADDYL0005    WOIONB           Next Charge Bac
      *
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WOAATM' defaulted for 'Job Time'.
      * Field '(DB1) WOAYNA' defaulted for 'User Id'.
      * Field '(DB1) WOA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WOAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WOAATM           Job Time
     C                     MOVEL##USR     WOAYNA           User Id
     C                     MOVEL##JOB     WOA0NA           Job Name
     C                     Z-ADD##JDT     WOAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@ASRECB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAASREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * CRT A/R Detail (Lckbx) CR - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BDCPFG
     C                     Z-ADDWEAIC3    WKAIC3           Company Number
     C                     Z-ADDWN0016    WKCONB           Invoice Number
     C                     MOVEL'CB'      WKCEST           Invoice Suffix
     C                     MOVELWDUHCD    WKUHCD           Adjustment Type
     C                     Z-ADDWN0005    WKBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WKAIVA           Adjustment Amou
     C                     Z-ADD*ZERO     WKAOVA           Amount Paid
     C                     Z-ADDWN0005    WKBGVA           Remaining Balan
     C                     MOVEL'E'       WKAJST           A/R Processing
     C                     MOVEL'O'       WKE3ST           Purge Status
     C                     MOVELWN0001    WKG4CD           Bank Code
     C                     Z-ADD*ZERO     WKCKNB           GL Document Num
     C                     Z-ADDWECAC7    WKCAC7           Order Number Re
     C                     Z-ADDWEBKC7    WKBKC7           Ship To Custome
     C                     MOVELWEBCCD    WKBCCD           Salesperson Cod
     C                     MOVELWER4CD    WKR4CD           Sales Route Cod
     C                     Z-ADDWDLWDT    WKB4DT           Transaction Dat
     C                     Z-ADDWDLWDT    WKATDT           Due Date
     C                     Z-ADD*ZERO     WKH0DT           Last Payment Da
     C                     Z-ADDYL0006    WKH3DT           Original Inv fo
     C                     Z-ADD*ZERO     WKH4DT           Paid in Full Da
     C                     Z-ADD*ZERO     WKH5DT           Last G/L Post D
     C                     Z-ADDWEANC7    WKANC7           AR Customer Num
     C                     MOVELWECPTX    WKCPTX           A/R Check Numbe
     C                     Z-ADD*ZERO     WKBSDY           Days to Pay
     C                     MOVEL*BLANK    WKUVST           EDI Status 1
     C                     MOVEL*BLANK    WKUWST           EDI Status 2
     C                     MOVEL*BLANK    WKUXST           EDI Status 3
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL@CN,002   WKAYNA           User Id
     C                     MOVEL##PGM     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      *
      * USER: Processing before Data update
     C                     MOVEL'N'       WN0018           Record Created
     C           KLCRSO    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKCONB           Invoice Number
     C                     KFLD           WKCEST           Invoice Suffix
      * Check for duplicate primary key
     C           KLCRSO    SETLL@BDCPFG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0175' W0RTN   7
      * Send message 'A/R Header             EX'
     C                     MOVEL'USR0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@BDCPFG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
     C                     MOVEL'Y'       WN0018           Record Created
      * E6933 DN  08/12/16 - Create A/R Header Ext record.
      * Crt A/R Header Ext    XF - A/R Header Ext  * 
     C                     CALL 'PBX3XFR'              90  Crt A/R Header
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WKAIC3    WQ0012  30       Company Number
     C                     PARM WKCONB    WQ0013  70       Invoice Number
     C                     PARM WKCEST    WQ0014  2        Invoice Suffix
     C                     PARM WKBGVA    WQ0015 112       Remaining Balan
     C                     PARM WKCAC7    WQ0016  70       Order Number Re
     C                     PARM WKH3DT    WQ0017  70       Original Inv fo
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBX3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * CRT AR A/R Bank DepositCR - A/R Bank Deposit  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @J2CPCM
     C                     MOVELWN0001    WRG4CD           Bank Code
     C                     Z-ADDWALWDT    WRHXDT           Deposit Date
     C                     Z-ADDWAYWNX    WRYXNX           Deposit Time
     C                     Z-ADDWAZXVA    WRUIVA           Deposit Amount
     C                     Z-ADDWN0002    WRUJVA           Total Cash Appl
     C                     MOVEL'E'       WRAJST           A/R Processing
     C                     Z-ADD*ZERO     WRCKNB           GL Document Num
     C                     Z-ADDWANMC2    WRBHNB           Number of Depos
     C                     Z-ADD*ZERO     WRBINB           Number of Appli
     C                     Z-ADD*ZERO     WRE2VL           CD TF Internal
     C                     Z-ADD*ZERO     WRE3VL           CD TF Immediate
     C                     Z-ADD*ZERO     WRE4VL           CD TF 1 Day Fun
     C                     Z-ADD*ZERO     WRE5VL           CD TF 2 Day Fun
     C                     Z-ADD*ZERO     WRE6VL           CD SB Exempt Im
     C                     Z-ADD*ZERO     WRE7VL           CD SB 1 Day Exe
     C                     Z-ADD*ZERO     WRE8VL           CD SB 2 Day Exe
     C                     Z-ADD*ZERO     WRE9VL           SBD Exempt Tota
     C                     Z-ADD*ZERO     WRFAVL           ARBD Unused Amt
     C                     Z-ADD*ZERO     WRFBVL           ARBD Unused Amt
     C                     Z-ADD*ZERO     WRFCVL           ARBD Unused Amt
     C                     Z-ADD*ZERO     WRFDVL           ARBD Unused Amt
     C                     Z-ADD*ZERO     WRHYDT           G/L Post Date
     C                     MOVEL*BLANK    WRUVST           EDI Status 1
     C                     MOVEL*BLANK    WRUWST           EDI Status 2
     C                     MOVEL*BLANK    WRUXST           EDI Status 3
     C                     MOVEL'A'       WRVSST           Record Status
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL@CN,002   WRAYNA           User Id
     C                     MOVEL##PGM     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
     C           KLCRSP    KLIST
     C                     KFLD           WRG4CD           Bank Code
     C                     KFLD           WRHXDT           Deposit Date
     C                     KFLD           WRYXNX           Deposit Time
      * Check for duplicate primary key
     C           KLCRSP    SETLL@J2CPCM                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2040' W0RTN   7
      * Send message 'A/R Bank Deposit       EX'
     C                     MOVEL'USR2040' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@J2CPCM                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Determine Bank.
      *================================================================
      * *********************************************************
      * note: If other banks are added later, insert code here to
      *       set the bank code based on the (?lockbox number?).
      * *********************************************************
      * Get Bank Code from Bank Master    PK0289 5/24/01
      * *********************************************************
      * RTV Bank Cd f/Lckbx   RT - Bank Master  * 
     C                     EXSR SBRVGN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * *** Process all of the invoice trans. for each check. ***
      *================================================================
      * PRC Lckbx to A/R Post  RT - A/R Lockbox Invoice  * 
     C                     EXSR SDRVGN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Find A/R Header record for the Lockbox Invoice.
      *================================================================
      * RTV Total Inv/Adj Amt  XF - A/R Lockbox Invoice  * 
     C                     CLEARPARC
     C                     Z-ADDWDBEC3    PABEC3           LckBx Number
     C                     Z-ADDWDLWDT    PALWDT           LckBx Deposit D
     C                     Z-ADDWDYWNX    PAYWNX           LckBx Deposit T
     C                     Z-ADDWDBFC3    PABFC3           LckBx Batch Num
     C                     Z-ADDWDBGC3    PABGC3           LckBx Item Numb
     C                     Z-ADDWDNMC3    PANMC3           LckBx Invoice N
     C                     MOVELWDUHCD    PAUHCD    P      Adjustment Type
      *
     C                     CALL 'PDLOXFR'              90  RTV Total Inv/A
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: A/R Lockbo
     C           WN0005    PARM WN0005    WQ0001 112       LckBx Total Inv
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *** Find A/R Header record for the Lockbox Invoice. ***
      * ***     - Suffix: 'IN', 'CB', or 'DM'               ***
      * ***     - Purge Status: Open                        ***
      * PRC Lckbx to A/R Post RTV - A/R Header  * 
     C                     EXSR SERVGN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * modification history
      *================================================================
      * RMC 5/16/2023 For getting the ar exempt for RB , added check for
      *     adjustment type= PAY. a RB payment came in with PAY
      * 01/11/2018 RMC S12308 get ar exempt from a/r header ext for CB, R
      * 04/26/2008 slm Get the TF Exempt Flag from the 1st Sales History
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Determine Values for Miscellaneous A/R Fields.
      *================================================================
      * Transaction Amounts.
      * CASE: PAR.Adjustment Type Code is Regular Pay
     C           WDUHCD    IFEQ 'PAY'                      *IF
      * Calculate "payment" transaction amounts.
     C                     EXSR UFSUBR                     Calculate "paym
     C                     ELSE
      * CASE: *OTHERWISE
      * Calculate "adjustment" transaction amounts.
     C                     EXSR UGSUBR                     Calculate "adju
     C                     END                             *FI
      * *** remaining balance due ***
     C           WEBGVA    SUB  WN0005    WN0012           Remaining Balan
      * CASE: PAR.Remaining Balance Due is less or equal to zero
     C           WN0012    IFLE 0                          *IF
     C                     Z-ADD##JDT     WN0014           Paid in Full Da
      * PAR.Days to Pay = PAR.LckBx Deposit Date - DB1.Transaction Date C
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WEB4DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WDLWDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     WN0015
     C                     ELSE
     C           XDURR     MULT -1        WN0015
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEH4DT    WN0014           Paid in Full Da
     C                     Z-ADDWEBSDY    WN0015           Days to Pay
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Calculate "payment" transaction amounts.
      *================================================================
     C           WEAOVA    ADD  WN0005    WN0011           Amount Paid
     C                     Z-ADDWEAIVA    WN0010           Adjustment Amou
     C                     Z-ADDWDLWDT    WN0013           Last Payment Da
      * *** add to "total cash applied" for Bank Deposit Record. ***
     C                     ADD  WN0005    WN0002           Total Cash Appl
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Calculate "adjustment" transaction amounts.
      *================================================================
     C                     Z-ADDWEAOVA    WN0011           Amount Paid
     C           WEAIVA    ADD  WN0005    WN0010           Adjustment Amou
     C                     Z-ADDWEH0DT    WN0013           Last Payment Da
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * File Creates & Updates.
      *================================================================
      * *** Create A/R Detail for Invoice Transaction. ***
     C                     Z-ADD*ZERO     WN0006           Sequence Number
      * RTV Next Seq. No.      RT - A/R Detail  * 
     C                     EXSR SGRVGN
      * 1/11/2018 RMC If the Suffix is "RB" use Exempt from Orig Inv
      *  Use a/r header ext for both CB &  RB
      * 5/12/2014 RMC If the Suffix is "CB" use Exempt from Orig Inv
      * after  05/16/23
      * CASE:
      *  - (c1ORc4)AND (c2ORc3)
      *   |- c1    : PAR.Adjustment Type Code is Chargeback
      *   |- c4    : PAR.Adjustment Type Code is Regular Pay
      *   |- c2    : DB1.Invoice Suffix is Charge Backs
      *   |- c3    : DB1.Invoice Suffix is Rebill
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           WDUHCD    IFEQ 'CB'                       *IF
     C           WDUHCD    OREQ 'PAY'                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WECEST    IFEQ 'CB'                       *IF
     C           WECEST    OREQ 'RB'                       *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * added type = PAY. a RB payment came in with PAY
     C                     MOVEL'NE'      YL0001           A/R TF Exempt C
      * Rtv Orig Order/Inv    RT - A/R Header Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0001           Company Number
     C                     Z-ADDWECONB    WL0002           Invoice Number
     C                     MOVELWECEST    WL0003    P      Invoice Suffix
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    YL0002           Attach to Invoi
     C                     Z-ADDWL0005    YL0003           Attach to Order
      * RTV TF AR Exempt f/ordRT - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0006           Company Number
     C                     Z-ADDYL0003    WL0007           Order Number
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YL0001    P      Order TF Exempt
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv TF Exempt By Inv  XF - Sales History  * 
     C                     CALL 'PMUJXFR'              90  Rtv TF Exempt B
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WECONB    WQ0002  70       Invoice Number
     C           YL0001    PARM YL0001    WQ0003  2        Order TF Exempt
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMUJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * VAL Acct ID JDE-8 dgt  UP - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'ARACTRET'             90  VAL Acct ID JDE
     C                     PARM WN0009    WQ0004  8        G/L ID Code Alp
     C                     PARM *BLANK    WQ0005 12        Cost Center. .
     C                     PARM *BLANK    WQ0006  6        Object Account
     C                     PARM *BLANK    WQ0007  8        Subsidiary . .
     C                     PARM *BLANK    WQ0008 30        Description
     C           WN0008    PARM *ZERO     WQ0009  30       G/L Posting Com
     C                     PARM *BLANK    WQ0010  1        JDE Posting Edi
     C                     PARM *BLANK    WQ0011  7        Error Return te
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ARACTRET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Populate Explanation for Chargebacks
      * CASE: PAR.Adjustment Type Code is Chargeback
     C           WDUHCD    IFEQ 'CB'                       *IF
     C                     MOVELWDNGNA    YL0004           Explanation
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0004           Explanation
     C                     END                             *FI
      * C3977 RMC 2/25/15 output orig inv for CB
      * CRT A/R Detail (Lckbx) CR - A/R Detail  * 
     C                     EXSR SJCRRC
      * *** Update A/R Header for Invoice Transaction. ***
      * CHG A/R Detail (Lckbx) CH - A/R Header  * 
     C                     EXSR SKCHRC
      * *** Update A/R Header for Invoice Transaction. ***
      * *** PK0333 ***
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Adjustment Type Code is Chargeback
      *   |- c2    : PAR.Adjustment Type Code is Accrual Chargeback
      *   '-
     C           WDUHCD    IFEQ 'CB'                       *IF
     C           WDUHCD    OREQ 'ACB'                      *OR
      * Create A/R Header for Chargeback Transaction.
     C                     EXSR UISUBR                     Create A/R Head
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Create A/R Header for Chargeback Transaction.
      *================================================================
     C                     MOVEL'Y'       WN0017           First Time Flag
     C                     MOVEL'N'       WN0018           Record Created
      * DO WHILE: PAR.Record Created        USR is No
     C           WN0018    DOWEQ'N'                        *DOW
      * *** Create a Chargeback record in the A/R Header file. ***
     C                     EXSR UJSUBR                     *** Create a Ch
     C                     END                             *ITR
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * *** Create a Chargeback record in the A/R Header file. ***
      *================================================================
      * *** Convert the invoice nbr into a Chargeback Reference nbr. ***
      * RTV Next CB Number     RT - Company Control  * 
     C                     EXSR SLRVGN
     C                     ADD  1         YL0005           Next Charge Bac
      * RTV Check invc exists  RT - A/R Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0005    WL0009           Invoice Number
     C                     EXSR SMRVGN
      * DO WHILE: PGM.*Return code is *Record already exists
     C           W0RTN     DOWEQ@CN,003                    *DOW
     C                     ADD  1         YL0005           Next Charge Bac
      * RTV Check invc exists  RT - A/R Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0005    WL0009           Invoice Number
     C                     EXSR SMRVGN
     C                     END                             *ITR
      * RTV Next Charge Back# CH - Company Control  * 
     C                     EXSR SNCHRC
     C                     Z-ADDYL0005    WN0016           Invoice Number
     C                     Z-ADDWECONB    YL0006           Original Inv fo
      * *** Create a Chargeback record in the A/R Header file. ***
      * CRT A/R Detail (Lckbx) CR - A/R Header  * 
     C                     EXSR SOCRRC
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABEC3           LckBx Number
     C                     Z-ADD*ZERO     WALWDT           LckBx Deposit D
     C                     Z-ADD*ZERO     WAYWNX           LckBx Deposit T
     C                     Z-ADD*ZERO     WANMC1           LckBx Dpst Nbr
     C                     Z-ADD*ZERO     WANMC2           LckBx Dpst Nbr
     C                     Z-ADD*ZERO     WAZXVA           LckBx Deposit A
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBD4C7           Bank LckBx Numb
     C                     Z-ADD*ZERO     WBD5C7           Bank Default Co
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCBEC3           LckBx Number
     C                     Z-ADD*ZERO     WCLWDT           LckBx Deposit D
     C                     Z-ADD*ZERO     WCYWNX           LckBx Deposit T
     C                     Z-ADD*ZERO     WCBFC3           LckBx Batch Num
     C                     Z-ADD*ZERO     WCBGC3           LckBx Item Numb
     C                     Z-ADD*ZERO     WCLXDT           LckBx Check Dat
     C                     Z-ADD*ZERO     WCZZVA           LckBx Check Amo
     C                     Z-ADD*ZERO     WCCWC7           LckBx Customer
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDBEC3           LckBx Number
     C                     Z-ADD*ZERO     WDLWDT           LckBx Deposit D
     C                     Z-ADD*ZERO     WDYWNX           LckBx Deposit T
     C                     Z-ADD*ZERO     WDBFC3           LckBx Batch Num
     C                     Z-ADD*ZERO     WDBGC3           LckBx Item Numb
     C                     Z-ADD*ZERO     WDNMC5           LckBx Seq Numbe
     C                     Z-ADD*ZERO     WDNMC4           LckBx Seq Count
     C                     Z-ADD*ZERO     WDNMC3           LckBx Invoice N
     C                     Z-ADD*ZERO     WDZ0VA           LckBx Invoice A
     C                     Z-ADD*ZERO     WDAIC3           Company Number
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WEAIVA           Adjustment Amou
     C                     Z-ADD*ZERO     WEAOVA           Amount Paid
     C                     Z-ADD*ZERO     WEBGVA           Remaining Balan
     C                     Z-ADD*ZERO     WECKNB           GL Document Num
     C                     Z-ADD*ZERO     WECAC7           Order Number Re
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WEATDT           Due Date
     C                     Z-ADD*ZERO     WEH0DT           Last Payment Da
     C                     Z-ADD*ZERO     WEH3DT           Original Inv fo
     C                     Z-ADD*ZERO     WEH4DT           Paid in Full Da
     C                     Z-ADD*ZERO     WEH5DT           Last G/L Post D
     C                     Z-ADD*ZERO     WEANC7           AR Customer Num
     C                     Z-ADD*ZERO     WEBSDY           Days to Pay
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFUKVA           Adjustment Limi
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGCONB           Invoice Number
     C                     Z-ADD*ZERO     WGDXNB           Sequence Number
     C                     Z-ADD*ZERO     WGBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WGB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WGDVDT           Payment/Deposit
     C                     Z-ADD*ZERO     WGYXNX           Deposit Time
     C                     Z-ADD*ZERO     WGHYDT           G/L Post Date
     C                     Z-ADD*ZERO     WGCKNB           GL Document Num
     C                     Z-ADD*ZERO     WGC1NY           G/L Posting Com
     C                     Z-ADD*ZERO     WGQHDT           TFS Adj Week-En
     C                     Z-ADD*ZERO     WGQIDT           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WGQJDT           A/R Invoice Num
     C                     Z-ADD*ZERO     WGQKDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WGQLDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WGGLVL           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WGGMVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WGGNVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WGGOVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WGGPVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHCONB           Invoice Number
     C                     Z-ADD*ZERO     WHATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WHT3NB           Attach to Order
     C                     Z-ADD*ZERO     WHV7DT           Orig Inv Actual
     C                     Z-ADD*ZERO     WHHLNB           Attach to Load
     C                     Z-ADD*ZERO     WHC0C7           Claim Number
     C                     Z-ADD*ZERO     WHV8DT           AR Ord Ref Actu
     C                     Z-ADD*ZERO     WHV9DT           AHE Unused Dte
     C                     Z-ADD*ZERO     WHWADT           AHE Unused Dte
     C                     Z-ADD*ZERO     WHHMNB           AHE Unused Nbr
     C                     Z-ADD*ZERO     WHN2NB           AHE Unused Nbr
     C                     Z-ADD*ZERO     WHUUN3           AHE Unused Nbr
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIDPNB           Order Sequence
     C                     Z-ADD*ZERO     WIUENB           Order Secondary
     C                     Z-ADD*ZERO     WIBTC7           Parent Customer
     C                     Z-ADD*ZERO     WIANC7           AR Customer Num
     C                     Z-ADD*ZERO     WIBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WIA0DT           Order Date
     C                     Z-ADD*ZERO     WIACDT           Cancel Date
     C                     Z-ADD*ZERO     WITBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WIATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WIT3NB           Attach to Order
     C                     Z-ADD*ZERO     WIRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WIORIT           Original Item
     C                     Z-ADD*ZERO     WIAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WID0WG           Weight Ordered
     C                     Z-ADD*ZERO     WICCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WIAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WIAKPR           Unit Price
     C                     Z-ADD*ZERO     WIAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WIA5DT           Requested Ship
     C                     Z-ADD*ZERO     WIAWDT           Invoice Date
     C                     Z-ADD*ZERO     WIHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WIAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WIAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WIAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WIAYVA           Extended Amount
     C                     Z-ADD*ZERO     WIL6NB           Contract Number
     C                     Z-ADD*ZERO     WIHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WIESNB           Accounting Year
     C                     Z-ADD*ZERO     WIETNB           Accounting Peri
     C                     Z-ADD*ZERO     WIBZNB           OM Week
     C                     Z-ADD*ZERO     WIEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WIBYWG           Weight Billed
     C                     Z-ADD*ZERO     WIS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WIMAVA           Billing Detail
     C                     Z-ADD*ZERO     WIKDVA           Billing Detail
     C                     Z-ADD*ZERO     WIUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WIUTVA           Standard Overag
     C                     Z-ADD*ZERO     WIA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WICKNB           GL Document Num
     C                     Z-ADD*ZERO     WIR8NB           Shipping Compan
     C                     Z-ADD*ZERO     WIBZPR           Price Overage O
     C                     Z-ADD*ZERO     WIEXDT           Market Pricing
     C                     Z-ADD*ZERO     WIRGNB           Item Structure
     C                     Z-ADD*ZERO     WIRHNB           Item Structure
     C                     Z-ADD*ZERO     WIRINB           Item Structure
     C                     Z-ADD*ZERO     WIR1NB           Rated Freight
     C                     Z-ADD*ZERO     WICONB           Invoice Number
     C                     Z-ADD*ZERO     WIGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WIRMNB           Load ID
     C                     Z-ADD*ZERO     WIAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WISKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WISLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WISMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WIONVA           Actual Freight
     C                     Z-ADD*ZERO     WIB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WIB5NB           PM Line Number
     C                     Z-ADD*ZERO     WIGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WIULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WIUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WIUOVA           Commission Amou
     C                     Z-ADD*ZERO     WIUPVA           Financials Amou
     C                     Z-ADD*ZERO     WIUQVA           Financials Amou
     C                     Z-ADD*ZERO     WICFC7           Order Group Cod
     C                     Z-ADD*ZERO     WIDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WIB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WIIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WIIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WINYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WIBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WIZ4NB           MPC Number
     C                     Z-ADD*ZERO     WIOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WIC0C7           Claim Number
     C                     Z-ADD*ZERO     WIA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WIA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WICDPR           Market Value
     C                     Z-ADD*ZERO     WID0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WID0VL           Raw Material Co
     C                     Z-ADD*ZERO     WICEVL           Sales Expense T
     C                     Z-ADD*ZERO     WIOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WID9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WICFVL           HST Item Target
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLAXNB           Current Account
     C                     Z-ADD*ZERO     WLNGNB           Current Account
     C                     Z-ADD*ZERO     WLBZNB           OM Week
     C                     Z-ADD*ZERO     WLC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WLC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WLCYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WLIONB           Next Charge Bac
     C                     Z-ADD*ZERO     WLI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WLDCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WLC7NB           Next Customer #
     C                     Z-ADD*ZERO     WLC2NB           Next Inventory
     C                     Z-ADD*ZERO     WLC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WLL8NB           Next Contract/P
     C                     Z-ADD*ZERO     WLBANB           Next HPB Batch
     C                     Z-ADD*ZERO     WLAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WLASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WLA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WLAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WLABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WLACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WLADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WLAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WLAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WLAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WLAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WLAENB           Retention Perio
     C                     Z-ADD*ZERO     WLALNB           Retention Perio
     C                     Z-ADD*ZERO     WLEVNB           Retention Perio
     C                     Z-ADD*ZERO     WLRPOP           Retention Perio
     C                     Z-ADD*ZERO     WLDWNB           Retention Perio
     C                     Z-ADD*ZERO     WLR3NB           Next Load ID
     C                     Z-ADD*ZERO     WLR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WLSCNB           Production Numb
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRHXDT           Deposit Date
     C                     Z-ADD*ZERO     WRYXNX           Deposit Time
     C                     Z-ADD*ZERO     WRUIVA           Deposit Amount
     C                     Z-ADD*ZERO     WRUJVA           Total Cash Appl
     C                     Z-ADD*ZERO     WRCKNB           GL Document Num
     C                     Z-ADD*ZERO     WRBHNB           Number of Depos
     C                     Z-ADD*ZERO     WRBINB           Number of Appli
     C                     Z-ADD*ZERO     WRE2VL           CD TF Internal
     C                     Z-ADD*ZERO     WRE3VL           CD TF Immediate
     C                     Z-ADD*ZERO     WRE4VL           CD TF 1 Day Fun
     C                     Z-ADD*ZERO     WRE5VL           CD TF 2 Day Fun
     C                     Z-ADD*ZERO     WRE6VL           CD SB Exempt Im
     C                     Z-ADD*ZERO     WRE7VL           CD SB 1 Day Exe
     C                     Z-ADD*ZERO     WRE8VL           CD SB 2 Day Exe
     C                     Z-ADD*ZERO     WRE9VL           SBD Exempt Tota
     C                     Z-ADD*ZERO     WRFAVL           ARBD Unused Amt
     C                     Z-ADD*ZERO     WRFBVL           ARBD Unused Amt
     C                     Z-ADD*ZERO     WRFCVL           ARBD Unused Amt
     C                     Z-ADD*ZERO     WRFDVL           ARBD Unused Amt
     C                     Z-ADD*ZERO     WRHYDT           G/L Post Date
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  2
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005  70
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008  2
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0009  70
      * Define local work field A/R TF Exempt Code
     C                     MOVEL*BLANK    YL0001  2
      * Define local work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Attach to Order Number
     C                     Z-ADD*ZERO     YL0003  70
      * Define null work field Cost Center. . . . . . .
     C                     MOVEL*BLANK    YN0001 12
      * Define null work field Object Account . . . . .
     C                     MOVEL*BLANK    YN0002  6
      * Define null work field Subsidiary . . . . . . .
     C                     MOVEL*BLANK    YN0003  8
      * Define null work field Description
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field JDE Posting Edit Code USR
     C                     MOVEL*BLANK    YN0005  1
      * Define null work field Error Return text
     C                     MOVEL*BLANK    YN0006  7
      * Define local work field Explanation
     C                     MOVEL*BLANK    YL0004 30
      * Define local work field Next Charge Back Number
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Original Inv for CB
     C                     Z-ADD*ZERO     YL0006  70
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PDLMXFR
00002 LOCKBOX
00003 Y2U0003
