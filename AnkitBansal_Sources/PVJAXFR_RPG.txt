     H/TITLE Exc Fix Consignee Addr XF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 01/23/25  Time  : 06:23:46
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDMRREL1  IF   E           K DISK
      * RTV : Export Doc Order Hdr      Retrieval index
      *
     FPOA2REL4  IF   E           K DISK
      * RSQ : Consignee Name Address    Name/Address
      *
     FPDMRREL0  UF   E           K DISK
      * UPD : Export Doc Order Hdr      Update index
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      * Outward parameters
     D PARC            DS          3848
      * RCD : Export Doc Order Hdr      Retrieval index
      * I : RST Company Number
     D  PAAIC3                 1      2P 0
      * I : RST Order Number
     D  PAC4NB                 3      6P 0
      * I : RST ED Export Document Type
     D  PADGSX                 7      7
      * I : RST Country Code
     D  PAKXCD                 8     13
      * I :  ED Consignee Addr 3
     D  PASCTX               581    643
      * I :  ED Consignee Addr 4
     D  PASDTX               644    706
      *
     D QPDMR1        E DS                  EXTNAME(PDMRREL0)
      * UPD : Export Doc Order Hdr      Update index
      * Renamed input format fields
     D  WCAIC3       E                     EXTFLD(MRAIC3)
     D  WCC4NB       E                     EXTFLD(MRC4NB)
     D  WCDGSX       E                     EXTFLD(MRDGSX)
     D  WCKXCD       E                     EXTFLD(MRKXCD)
     D  WCZMCD       E                     EXTFLD(MRZMCD)
     D  WCPSTX       E                     EXTFLD(MRPSTX)
     D  WCPUTX       E                     EXTFLD(MRPUTX)
     D  WCPVTX       E                     EXTFLD(MRPVTX)
     D  WCPWTX       E                     EXTFLD(MRPWTX)
     D  WCRVTX       E                     EXTFLD(MRRVTX)
     D  WCPPU1       E                     EXTFLD(MRPPU1)
     D  WCZ7AA       E                     EXTFLD(MRZ7AA)
     D  WCPDU1       E                     EXTFLD(MRPDU1)
     D  WCZ8AA       E                     EXTFLD(MRZ8AA)
     D  WCRHTX       E                     EXTFLD(MRRHTX)
     D  WCRITX       E                     EXTFLD(MRRITX)
     D  WCRJTX       E                     EXTFLD(MRRJTX)
     D  WCSCTX       E                     EXTFLD(MRSCTX)
     D  WCSDTX       E                     EXTFLD(MRSDTX)
     D  WCAAAB       E                     EXTFLD(MRAAAB)
     D  WCPHU1       E                     EXTFLD(MRPHU1)
     D  WCABAB       E                     EXTFLD(MRABAB)
     D  WCPXTX       E                     EXTFLD(MRPXTX)
     D  WCZOCD       E                     EXTFLD(MRZOCD)
     D  WCZNCD       E                     EXTFLD(MRZNCD)
     D  WCCSSX       E                     EXTFLD(MRCSSX)
     D  WCCTSX       E                     EXTFLD(MRCTSX)
     D  WCCUSX       E                     EXTFLD(MRCUSX)
     D  WCCVSX       E                     EXTFLD(MRCVSX)
     D  WCPTTX       E                     EXTFLD(MRPTTX)
     D  WCORNA       E                     EXTFLD(MRORNA)
     D  WCRKTX       E                     EXTFLD(MRRKTX)
     D  WCPZTX       E                     EXTFLD(MRPZTX)
     D  WCRLTX       E                     EXTFLD(MRRLTX)
     D  WCP0TX       E                     EXTFLD(MRP0TX)
     D  WCP1TX       E                     EXTFLD(MRP1TX)
     D  WCP2TX       E                     EXTFLD(MRP2TX)
     D  WCP3TX       E                     EXTFLD(MRP3TX)
     D  WCP4TX       E                     EXTFLD(MRP4TX)
     D  WCP5TX       E                     EXTFLD(MRP5TX)
     D  WCP6TX       E                     EXTFLD(MRP6TX)
     D  WCYHTX       E                     EXTFLD(MRYHTX)
     D  WCYITX       E                     EXTFLD(MRYITX)
     D  WCCWSX       E                     EXTFLD(MRCWSX)
     D  WCOUNA       E                     EXTFLD(MROUNA)
     D  WCP7TX       E                     EXTFLD(MRP7TX)
     D  WCP9TX       E                     EXTFLD(MRP9TX)
     D  WCOVNA       E                     EXTFLD(MROVNA)
     D  WCQATX       E                     EXTFLD(MRQATX)
     D  WCQBTX       E                     EXTFLD(MRQBTX)
     D  WCQCTX       E                     EXTFLD(MRQCTX)
     D  WCOWNA       E                     EXTFLD(MROWNA)
     D  WCOXNA       E                     EXTFLD(MROXNA)
     D  WCABNX       E                     EXTFLD(MRABNX)
     D  WCACNX       E                     EXTFLD(MRACNX)
     D  WCADNX       E                     EXTFLD(MRADNX)
     D  WCQDTX       E                     EXTFLD(MRQDTX)
     D  WCQETX       E                     EXTFLD(MRQETX)
     D  WCOYNA       E                     EXTFLD(MROYNA)
     D  WCOZNA       E                     EXTFLD(MROZNA)
     D  WCO0NA       E                     EXTFLD(MRO0NA)
     D  WCO1NA       E                     EXTFLD(MRO1NA)
     D  WCCXSX       E                     EXTFLD(MRCXSX)
     D  WCCYSX       E                     EXTFLD(MRCYSX)
     D  WCAGNX       E                     EXTFLD(MRAGNX)
     D  WCCZSX       E                     EXTFLD(MRCZSX)
     D  WCC0SX       E                     EXTFLD(MRC0SX)
     D  WCC1SX       E                     EXTFLD(MRC1SX)
     D  WCQFTX       E                     EXTFLD(MRQFTX)
     D  WCAHNX       E                     EXTFLD(MRAHNX)
     D  WCQGTX       E                     EXTFLD(MRQGTX)
     D  WCQHTX       E                     EXTFLD(MRQHTX)
     D  WCQITX       E                     EXTFLD(MRQITX)
     D  WCQJTX       E                     EXTFLD(MRQJTX)
     D  WCQKTX       E                     EXTFLD(MRQKTX)
     D  WCQMTX       E                     EXTFLD(MRQMTX)
     D  WCQNTX       E                     EXTFLD(MRQNTX)
     D  WCQOTX       E                     EXTFLD(MRQOTX)
     D  WCQPTX       E                     EXTFLD(MRQPTX)
     D  WCQQTX       E                     EXTFLD(MRQQTX)
     D  WCQRTX       E                     EXTFLD(MRQRTX)
     D  WCQSTX       E                     EXTFLD(MRQSTX)
     D  WCQTTX       E                     EXTFLD(MRQTTX)
     D  WCQUTX       E                     EXTFLD(MRQUTX)
     D  WCQVTX       E                     EXTFLD(MRQVTX)
     D  WCQYTX       E                     EXTFLD(MRQYTX)
     D  WCQWTX       E                     EXTFLD(MRQWTX)
     D  WCQZTX       E                     EXTFLD(MRQZTX)
     D  WCAINX       E                     EXTFLD(MRAINX)
     D  WCQ1TX       E                     EXTFLD(MRQ1TX)
     D  WCQ2TX       E                     EXTFLD(MRQ2TX)
     D  WCQ3TX       E                     EXTFLD(MRQ3TX)
     D  WCQ4TX       E                     EXTFLD(MRQ4TX)
     D  WCQ5TX       E                     EXTFLD(MRQ5TX)
     D  WCQ6TX       E                     EXTFLD(MRQ6TX)
     D  WCQ7TX       E                     EXTFLD(MRQ7TX)
     D  WCQ8TX       E                     EXTFLD(MRQ8TX)
     D  WCQ9TX       E                     EXTFLD(MRQ9TX)
     D  WCSMTX       E                     EXTFLD(MRSMTX)
     D  WCZQCD       E                     EXTFLD(MRZQCD)
     D  WCZRCD       E                     EXTFLD(MRZRCD)
     D  WCA7VL       E                     EXTFLD(MRA7VL)
     D  WCA8VL       E                     EXTFLD(MRA8VL)
     D  WCC2SX       E                     EXTFLD(MRC2SX)
     D  WCC8SX       E                     EXTFLD(MRC8SX)
     D  WCHRWG       E                     EXTFLD(MRHRWG)
     D  WCBIVL       E                     EXTFLD(MRBIVL)
     D  WCK2QT       E                     EXTFLD(MRK2QT)
     D  WCO5NA       E                     EXTFLD(MRO5NA)
     D  WCHSWG       E                     EXTFLD(MRHSWG)
     D  WCBJVL       E                     EXTFLD(MRBJVL)
     D  WCRATX       E                     EXTFLD(MRRATX)
     D  WCRBTX       E                     EXTFLD(MRRBTX)
     D  WCRCTX       E                     EXTFLD(MRRCTX)
     D  WCRDTX       E                     EXTFLD(MRRDTX)
     D  WCRETX       E                     EXTFLD(MRRETX)
     D  WCC3SX       E                     EXTFLD(MRC3SX)
     D  WCC4SX       E                     EXTFLD(MRC4SX)
     D  WCC5SX       E                     EXTFLD(MRC5SX)
     D  WCC6SX       E                     EXTFLD(MRC6SX)
     D  WCC7SX       E                     EXTFLD(MRC7SX)
     D  WCMQDT       E                     EXTFLD(MRMQDT)
     D  WCMRDT       E                     EXTFLD(MRMRDT)
     D  WCMSDT       E                     EXTFLD(MRMSDT)
     D  WCAJNX       E                     EXTFLD(MRAJNX)
     D  WCYFTX       E                     EXTFLD(MRYFTX)
     D  WCX9TX       E                     EXTFLD(MRX9TX)
     D  WCYATX       E                     EXTFLD(MRYATX)
     D  WCYBTX       E                     EXTFLD(MRYBTX)
     D  WCB5AA       E                     EXTFLD(MRB5AA)
     D  WCYCTX       E                     EXTFLD(MRYCTX)
     D  WCYDTX       E                     EXTFLD(MRYDTX)
     D  WCYETX       E                     EXTFLD(MRYETX)
     D  WCB6AA       E                     EXTFLD(MRB6AA)
     D  WCPADT       E                     EXTFLD(MRPADT)
     D  WCPBDT       E                     EXTFLD(MRPBDT)
     D  WCPCDT       E                     EXTFLD(MRPCDT)
     D  WCPDDT       E                     EXTFLD(MRPDDT)
     D  WCPEDT       E                     EXTFLD(MRPEDT)
     D  WCO4SX       E                     EXTFLD(MRO4SX)
     D  WCO5SX       E                     EXTFLD(MRO5SX)
     D  WCC1T1       E                     EXTFLD(MRC1T1)
     D  WCC2T1       E                     EXTFLD(MRC2T1)
     D  WCLKSC       E                     EXTFLD(MRLKSC)
     D  WCLLSC       E                     EXTFLD(MRLLSC)
     D  WCPIU1       E                     EXTFLD(MRPIU1)
     D  WCPJU1       E                     EXTFLD(MRPJU1)
     D  WCFFNZ       E                     EXTFLD(MRFFNZ)
     D  WCBUDX       E                     EXTFLD(MRBUDX)
     D  WCUVST       E                     EXTFLD(MRUVST)
     D  WCUWST       E                     EXTFLD(MRUWST)
     D  WCUXST       E                     EXTFLD(MRUXST)
     D  WCVSST       E                     EXTFLD(MRVSST)
     D  WCAATM       E                     EXTFLD(MRAATM)
     D  WCAYNA       E                     EXTFLD(MRAYNA)
     D  WCA0NA       E                     EXTFLD(MRA0NA)
     D  WCAXDT       E                     EXTFLD(MRAXDT)
      *
     D YARDCS          DS          3848
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              3  0
     D  WP0002         S              7  0
     D  WP0003         S              1
     D  WP0004         S              6
     D  WP0005         S              1
     D  WP0006         S              1
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  WN0001         S             63
     D  WN0002         S             63
     D  YL0001         S              1
     D  YL0002         S             63
     D  YL0003         S             63
     D  WQSB01         S                   LIKE(WBI8SX)
     D  WQSB02         S                   LIKE(WBX0TX)
     D  WQSB03         S                   LIKE(WBX1TX)
     D  Y0CX01         S              1
     D  W0CLPG         S             10
     D  WN0003         S             15
     D  WN0004         S             20
     D  WN0005         S             30
     D  WN0006         S              2
     D  WN0007         S             10
     D  WN0008         S              1
     D  WN0009         S              1
     D  WN0010         S              1
     D  WN0011         S              1
     D  WN0012         S             10
     D  WN0013         S             70
     D  WN0014         S             70
     D  WN0015         S             70
     D  WN0016         S             70
     D  WN0017         S             70
     D  WN0018         S              1
     D  WN0019         S             40
     D  WN0020         S             10
     D  WN0021         S             18
     D  WN0022         S             15
     D  WN0023         S             10
     D  WN0024         S             10
     D  WN0025         S             30
     D  WN0026         S             30
     D  WN0027         S             30
     D  WN0028         S             10  0
     D  WN0029         S             10  0
     D  WN0030         S             10  0
     D  WN0031         S              3
     D  WN0032         S              8
     D  WN0033         S             30
     D  WN0034         S             30
     D  WN0035         S             30
     D  WN0036         S             30
     D  WN0037         S              1
     D  WN0038         S              1
     D  WN0039         S             20
     D  WN0040         S              1
     D  WN0041         S              1
     D  WN0042         S              1
     D  WN0043         S             30
     D  WN0044         S             10  0
     D  WN0045         S             10
     D  WN0046         S             50
     D  WN0047         S             25
     D  WN0048         S             40
     D  WN0049         S             40
     D  WN0050         S             40
     D  WN0051         S             40
     D  WN0052         S             40
     D  WN0053         S             40
     D  WN0054         S             40
     D  WN0055         S             40
     D  WN0056         S             40
     D  WN0057         S             40
     D  WN0058         S             40
     D  WN0059         S             40
     D  WN0060         S             20
     D  WN0061         S             10
     D  WN0062         S             20
     D  WN0063         S              2  0
     D  WN0064         S             30
     D  WN0065         S             30
     D  WN0066         S             30
     D  WN0067         S             30
     D  WN0068         S             30
     D  WN0069         S             30
     D  WN0070         S             63
     D  WN0071         S             63
     D  WN0072         S             63
     D  WN0073         S             63
     D  WN0074         S              5
     D  WN0075         S              5
     D  WN0076         S              6  2
     D  WN0077         S              9  2
     D  WN0078         S              1
     D  WN0079         S              1
     D  WN0080         S              9  1
     D  WN0081         S              7  4
     D  WN0082         S              5  0
     D  WN0083         S             15
     D  WN0084         S              9  1
     D  WN0085         S              7  4
     D  WN0086         S             10
     D  WN0087         S             25
     D  WN0088         S             25
     D  WN0089         S             30
     D  WN0090         S              1
     D  WN0091         S              1
     D  WN0092         S              1
     D  WN0093         S              2
     D  WN0094         S              2
     D  WN0095         S              7  0
     D  WN0096         S              7  0
     D  WN0097         S              7  0
     D  WN0098         S              7  0
     D  WN0099         S              7  0
     D  WN0100         S              7  0
     D  WN0101         S              7  0
     D  WN0102         S              7  0
     D  WN0103         S              1
     D  WN0104         S             25
     D  WN0105         S             25
     D  WN0106         S              1
     D  WN0107         S              1
     D  WN0108         S              1
     D  WN0109         S              1
     D  WN0110         S              6  0
     D  WN0111         S             10
     D  WN0112         S             10
     D  WN0113         S              7  0
     D  YARDC          S              1
     D  WQ0001         S             10
     D  WQ0002         S             63
     D  WQ0003         S             63
     D  WQ0004         S             63
     D  WQ0005         S             63
     D  WQ0006         S             63
     D  WQ0007         S              2
     D  WQ0008         S             20
     D  WQ0009         S              6
     D  WQ0010         S             63
     D  WQ0011         S             63
     D  WQ0012         S             63
     D  WQ0013         S             63
     D  WQ0014         S             63
     D  WQ0015         S              2
     D  WQ0016         S             20
     D  WQ0017         S              6
     D  WQ0018         S              3  0
     D  WQ0019         S              7  0
     D  WQ0020         S              1
     D  WQ0021         S              6
     D  WQ0022         S             15
     D  WQ0023         S             20
     D  WQ0024         S             63
     D  WQ0025         S             63
     D  WQ0026         S             63
     D  WQ0027         S             63
     D  WQ0028         S             63
     D  WQ0029         S              2
     D  WQ0030         S             20
     D  WQ0031         S              6
     D  WQ0032         S             63
     D  WQ0033         S             63
     D  WQ0034         S             63
     D  WQ0035         S             63
     D  WQ0036         S             63
     D  WQ0037         S              2
     D  WQ0038         S             20
     D  WQ0039         S              6
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: Export Doc Order Hdr
      * I : RST Company Number
     D  P1AIC3                 1      2P 0
      * I : RST Order Number
     D  P1C4NB                 3      6P 0
      * I : RST ED Export Document Type
     D  P1DGSX                 7      7
      * I : RST Country Code
     D  P1KXCD                 8     13
     D P2PARM          DS
      * I :  Edit Or Update Mode
     D  P2QXSC                 1      1
     D P3PARM          DS
      * I :  Print (Yes/No) USR
     D  P3DTSX                 1      1
     D                 DS
     D  ZAMSDA                 1    132
     I@MRREWT
      * Export Doc Order Hdr      Retrieval index
      * Renamed input format fields
     I              MRAIC3                      WAAIC3
     I              MRC4NB                      WAC4NB
     I              MRDGSX                      WADGSX
     I              MRKXCD                      WAKXCD
     I              MRZMCD                      WAZMCD
     I              MRPSTX                      WAPSTX
     I              MRPUTX                      WAPUTX
     I              MRPVTX                      WAPVTX
     I              MRPWTX                      WAPWTX
     I              MRRVTX                      WARVTX
     I              MRPPU1                      WAPPU1
     I              MRZ7AA                      WAZ7AA
     I              MRPDU1                      WAPDU1
     I              MRZ8AA                      WAZ8AA
     I              MRRHTX                      WARHTX
     I              MRRITX                      WARITX
     I              MRRJTX                      WARJTX
     I              MRSCTX                      WASCTX
     I              MRSDTX                      WASDTX
     I              MRAAAB                      WAAAAB
     I              MRPHU1                      WAPHU1
     I              MRABAB                      WAABAB
     I              MRPXTX                      WAPXTX
     I              MRZOCD                      WAZOCD
     I              MRZNCD                      WAZNCD
     I              MRCSSX                      WACSSX
     I              MRCTSX                      WACTSX
     I              MRCUSX                      WACUSX
     I              MRCVSX                      WACVSX
     I              MRPTTX                      WAPTTX
     I              MRORNA                      WAORNA
     I              MRRKTX                      WARKTX
     I              MRPZTX                      WAPZTX
     I              MRRLTX                      WARLTX
     I              MRP0TX                      WAP0TX
     I              MRP1TX                      WAP1TX
     I              MRP2TX                      WAP2TX
     I              MRP3TX                      WAP3TX
     I              MRP4TX                      WAP4TX
     I              MRP5TX                      WAP5TX
     I              MRP6TX                      WAP6TX
     I              MRYHTX                      WAYHTX
     I              MRYITX                      WAYITX
     I              MRCWSX                      WACWSX
     I              MROUNA                      WAOUNA
     I              MRP7TX                      WAP7TX
     I              MRP9TX                      WAP9TX
     I              MROVNA                      WAOVNA
     I              MRQATX                      WAQATX
     I              MRQBTX                      WAQBTX
     I              MRQCTX                      WAQCTX
     I              MROWNA                      WAOWNA
     I              MROXNA                      WAOXNA
     I              MRABNX                      WAABNX
     I              MRACNX                      WAACNX
     I              MRADNX                      WAADNX
     I              MRQDTX                      WAQDTX
     I              MRQETX                      WAQETX
     I              MROYNA                      WAOYNA
     I              MROZNA                      WAOZNA
     I              MRO0NA                      WAO0NA
     I              MRO1NA                      WAO1NA
     I              MRCXSX                      WACXSX
     I              MRCYSX                      WACYSX
     I              MRAGNX                      WAAGNX
     I              MRCZSX                      WACZSX
     I              MRC0SX                      WAC0SX
     I              MRC1SX                      WAC1SX
     I              MRQFTX                      WAQFTX
     I              MRAHNX                      WAAHNX
     I              MRQGTX                      WAQGTX
     I              MRQHTX                      WAQHTX
     I              MRQITX                      WAQITX
     I              MRQJTX                      WAQJTX
     I              MRQKTX                      WAQKTX
     I              MRQMTX                      WAQMTX
     I              MRQNTX                      WAQNTX
     I              MRQOTX                      WAQOTX
     I              MRQPTX                      WAQPTX
     I              MRQQTX                      WAQQTX
     I              MRQRTX                      WAQRTX
     I              MRQSTX                      WAQSTX
     I              MRQTTX                      WAQTTX
     I              MRQUTX                      WAQUTX
     I              MRQVTX                      WAQVTX
     I              MRQYTX                      WAQYTX
     I              MRQWTX                      WAQWTX
     I              MRQZTX                      WAQZTX
     I              MRAINX                      WAAINX
     I              MRQ1TX                      WAQ1TX
     I              MRQ2TX                      WAQ2TX
     I              MRQ3TX                      WAQ3TX
     I              MRQ4TX                      WAQ4TX
     I              MRQ5TX                      WAQ5TX
     I              MRQ6TX                      WAQ6TX
     I              MRQ7TX                      WAQ7TX
     I              MRQ8TX                      WAQ8TX
     I              MRQ9TX                      WAQ9TX
     I              MRSMTX                      WASMTX
     I              MRZQCD                      WAZQCD
     I              MRZRCD                      WAZRCD
     I              MRA7VL                      WAA7VL
     I              MRA8VL                      WAA8VL
     I              MRC2SX                      WAC2SX
     I              MRC8SX                      WAC8SX
     I              MRHRWG                      WAHRWG
     I              MRBIVL                      WABIVL
     I              MRK2QT                      WAK2QT
     I              MRO5NA                      WAO5NA
     I              MRHSWG                      WAHSWG
     I              MRBJVL                      WABJVL
     I              MRRATX                      WARATX
     I              MRRBTX                      WARBTX
     I              MRRCTX                      WARCTX
     I              MRRDTX                      WARDTX
     I              MRRETX                      WARETX
     I              MRC3SX                      WAC3SX
     I              MRC4SX                      WAC4SX
     I              MRC5SX                      WAC5SX
     I              MRC6SX                      WAC6SX
     I              MRC7SX                      WAC7SX
     I              MRMQDT                      WAMQDT
     I              MRMRDT                      WAMRDT
     I              MRMSDT                      WAMSDT
     I              MRAJNX                      WAAJNX
     I              MRYFTX                      WAYFTX
     I              MRX9TX                      WAX9TX
     I              MRYATX                      WAYATX
     I              MRYBTX                      WAYBTX
     I              MRB5AA                      WAB5AA
     I              MRYCTX                      WAYCTX
     I              MRYDTX                      WAYDTX
     I              MRYETX                      WAYETX
     I              MRB6AA                      WAB6AA
     I              MRPADT                      WAPADT
     I              MRPBDT                      WAPBDT
     I              MRPCDT                      WAPCDT
     I              MRPDDT                      WAPDDT
     I              MRPEDT                      WAPEDT
     I              MRO4SX                      WAO4SX
     I              MRO5SX                      WAO5SX
     I              MRC1T1                      WAC1T1
     I              MRC2T1                      WAC2T1
     I              MRLKSC                      WALKSC
     I              MRLLSC                      WALLSC
     I              MRPIU1                      WAPIU1
     I              MRPJU1                      WAPJU1
     I              MRFFNZ                      WAFFNZ
     I              MRBUDX                      WABUDX
     I              MRUVST                      WAUVST
     I              MRUWST                      WAUWST
     I              MRUXST                      WAUXST
     I              MRVSST                      WAVSST
     I              MRAATM                      WAAATM
     I              MRAYNA                      WAAYNA
     I              MRA0NA                      WAA0NA
     I              MRAXDT                      WAAXDT
      *
     I@A2REIO
      * Consignee Name Address    Name/Address
      * Renamed input format fields
     I              A2D3C7                      WBD3C7
     I              A2I8SX                      WBI8SX
     I              A2X0TX                      WBX0TX
     I              A2X1TX                      WBX1TX
     I              A2X2TX                      WBX2TX
     I              A2X3TX                      WBX3TX
     I              A2X8TX                      WBX8TX
     I              A2YHAA                      WBYHAA
     I              A2LUU1                      WBLUU1
     I              A2Z9AA                      WBZ9AA
     I              A2LVU1                      WBLVU1
     I              A2X5TX                      WBX5TX
     I              A2NJNX                      WBNJNX
     I              A2NKNX                      WBNKNX
     I              A2X7TX                      WBX7TX
     I              A2LQU1                      WBLQU1
     I              A2LRU1                      WBLRU1
     I              A2LSU1                      WBLSU1
     I              A2LTU1                      WBLTU1
     I              A2KXCD                      WBKXCD
     I              A2LISC                      WBLISC
     I              A2LJSC                      WBLJSC
     I              A2FENZ                      WBFENZ
     I              A2BTDX                      WBBTDX
     I              A2VSST                      WBVSST
     I              A2MJDT                      WBMJDT
     I              A2BETM                      WBBETM
     I              A2CCVN                      WBCCVN
     I              A2CDVN                      WBCDVN
     I              A2MKDT                      WBMKDT
     I              A2BFTM                      WBBFTM
     I              A2CEVN                      WBCEVN
     I              A2CFVN                      WBCFVN
      *
     I@MRREWS
      * Export Doc Order Hdr      Update index
      * Renamed input format fields
     I              MRAIC3                      WCAIC3
     I              MRC4NB                      WCC4NB
     I              MRDGSX                      WCDGSX
     I              MRKXCD                      WCKXCD
     I              MRZMCD                      WCZMCD
     I              MRPSTX                      WCPSTX
     I              MRPUTX                      WCPUTX
     I              MRPVTX                      WCPVTX
     I              MRPWTX                      WCPWTX
     I              MRRVTX                      WCRVTX
     I              MRPPU1                      WCPPU1
     I              MRZ7AA                      WCZ7AA
     I              MRPDU1                      WCPDU1
     I              MRZ8AA                      WCZ8AA
     I              MRRHTX                      WCRHTX
     I              MRRITX                      WCRITX
     I              MRRJTX                      WCRJTX
     I              MRSCTX                      WCSCTX
     I              MRSDTX                      WCSDTX
     I              MRAAAB                      WCAAAB
     I              MRPHU1                      WCPHU1
     I              MRABAB                      WCABAB
     I              MRPXTX                      WCPXTX
     I              MRZOCD                      WCZOCD
     I              MRZNCD                      WCZNCD
     I              MRCSSX                      WCCSSX
     I              MRCTSX                      WCCTSX
     I              MRCUSX                      WCCUSX
     I              MRCVSX                      WCCVSX
     I              MRPTTX                      WCPTTX
     I              MRORNA                      WCORNA
     I              MRRKTX                      WCRKTX
     I              MRPZTX                      WCPZTX
     I              MRRLTX                      WCRLTX
     I              MRP0TX                      WCP0TX
     I              MRP1TX                      WCP1TX
     I              MRP2TX                      WCP2TX
     I              MRP3TX                      WCP3TX
     I              MRP4TX                      WCP4TX
     I              MRP5TX                      WCP5TX
     I              MRP6TX                      WCP6TX
     I              MRYHTX                      WCYHTX
     I              MRYITX                      WCYITX
     I              MRCWSX                      WCCWSX
     I              MROUNA                      WCOUNA
     I              MRP7TX                      WCP7TX
     I              MRP9TX                      WCP9TX
     I              MROVNA                      WCOVNA
     I              MRQATX                      WCQATX
     I              MRQBTX                      WCQBTX
     I              MRQCTX                      WCQCTX
     I              MROWNA                      WCOWNA
     I              MROXNA                      WCOXNA
     I              MRABNX                      WCABNX
     I              MRACNX                      WCACNX
     I              MRADNX                      WCADNX
     I              MRQDTX                      WCQDTX
     I              MRQETX                      WCQETX
     I              MROYNA                      WCOYNA
     I              MROZNA                      WCOZNA
     I              MRO0NA                      WCO0NA
     I              MRO1NA                      WCO1NA
     I              MRCXSX                      WCCXSX
     I              MRCYSX                      WCCYSX
     I              MRAGNX                      WCAGNX
     I              MRCZSX                      WCCZSX
     I              MRC0SX                      WCC0SX
     I              MRC1SX                      WCC1SX
     I              MRQFTX                      WCQFTX
     I              MRAHNX                      WCAHNX
     I              MRQGTX                      WCQGTX
     I              MRQHTX                      WCQHTX
     I              MRQITX                      WCQITX
     I              MRQJTX                      WCQJTX
     I              MRQKTX                      WCQKTX
     I              MRQMTX                      WCQMTX
     I              MRQNTX                      WCQNTX
     I              MRQOTX                      WCQOTX
     I              MRQPTX                      WCQPTX
     I              MRQQTX                      WCQQTX
     I              MRQRTX                      WCQRTX
     I              MRQSTX                      WCQSTX
     I              MRQTTX                      WCQTTX
     I              MRQUTX                      WCQUTX
     I              MRQVTX                      WCQVTX
     I              MRQYTX                      WCQYTX
     I              MRQWTX                      WCQWTX
     I              MRQZTX                      WCQZTX
     I              MRAINX                      WCAINX
     I              MRQ1TX                      WCQ1TX
     I              MRQ2TX                      WCQ2TX
     I              MRQ3TX                      WCQ3TX
     I              MRQ4TX                      WCQ4TX
     I              MRQ5TX                      WCQ5TX
     I              MRQ6TX                      WCQ6TX
     I              MRQ7TX                      WCQ7TX
     I              MRQ8TX                      WCQ8TX
     I              MRQ9TX                      WCQ9TX
     I              MRSMTX                      WCSMTX
     I              MRZQCD                      WCZQCD
     I              MRZRCD                      WCZRCD
     I              MRA7VL                      WCA7VL
     I              MRA8VL                      WCA8VL
     I              MRC2SX                      WCC2SX
     I              MRC8SX                      WCC8SX
     I              MRHRWG                      WCHRWG
     I              MRBIVL                      WCBIVL
     I              MRK2QT                      WCK2QT
     I              MRO5NA                      WCO5NA
     I              MRHSWG                      WCHSWG
     I              MRBJVL                      WCBJVL
     I              MRRATX                      WCRATX
     I              MRRBTX                      WCRBTX
     I              MRRCTX                      WCRCTX
     I              MRRDTX                      WCRDTX
     I              MRRETX                      WCRETX
     I              MRC3SX                      WCC3SX
     I              MRC4SX                      WCC4SX
     I              MRC5SX                      WCC5SX
     I              MRC6SX                      WCC6SX
     I              MRC7SX                      WCC7SX
     I              MRMQDT                      WCMQDT
     I              MRMRDT                      WCMRDT
     I              MRMSDT                      WCMSDT
     I              MRAJNX                      WCAJNX
     I              MRYFTX                      WCYFTX
     I              MRX9TX                      WCX9TX
     I              MRYATX                      WCYATX
     I              MRYBTX                      WCYBTX
     I              MRB5AA                      WCB5AA
     I              MRYCTX                      WCYCTX
     I              MRYDTX                      WCYDTX
     I              MRYETX                      WCYETX
     I              MRB6AA                      WCB6AA
     I              MRPADT                      WCPADT
     I              MRPBDT                      WCPBDT
     I              MRPCDT                      WCPCDT
     I              MRPDDT                      WCPDDT
     I              MRPEDT                      WCPEDT
     I              MRO4SX                      WCO4SX
     I              MRO5SX                      WCO5SX
     I              MRC1T1                      WCC1T1
     I              MRC2T1                      WCC2T1
     I              MRLKSC                      WCLKSC
     I              MRLLSC                      WCLLSC
     I              MRPIU1                      WCPIU1
     I              MRPJU1                      WCPJU1
     I              MRFFNZ                      WCFFNZ
     I              MRBUDX                      WCBUDX
     I              MRUVST                      WCUVST
     I              MRUWST                      WCUWST
     I              MRUXST                      WCUXST
     I              MRVSST                      WCVSST
     I              MRAATM                      WCAATM
     I              MRAYNA                      WCAYNA
     I              MRA0NA                      WCA0NA
     I              MRAXDT                      WCAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1AIC3        PARM                    WP0001                         Company Number
     C     P1C4NB        PARM                    WP0002                         Order Number
     C     P1DGSX        PARM                    WP0003                         ED Export Docum
     C     P1KXCD        PARM                    WP0004                         Country Code
     C     P2QXSC        PARM                    WP0005                         Edit Or Update
     C     P3DTSX        PARM                    WP0006                         Print (Yes/No)
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Exc Fix Consignee Addr XF
      * Creation & Modification log
     C                   EXSR      UASUBR                                       Creation & Modi
      * Rtv/Chg Consignee Fix  RT - Export Doc Order Hdr  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Rtv/Chg Consignee Fix  RT - Export Doc Order Hdr  * 
      *================================================================
      *
     C                   EVAL      WN0001 = ' '                                 Consignee Addre
     C                   EVAL      WN0002 = ' '                                 Consignee Addre
      *
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WAAIC3                         Company Number
     C                   KFLD                    WAC4NB                         Order Number
     C                   KFLD                    WADGSX                         ED Export Docum
     C                   KFLD                    WAKXCD                         Country Code
      * Setup key
     C                   Z-ADD     P1AIC3        WAAIC3                         Company Number
     C                   Z-ADD     P1C4NB        WAC4NB                         Order Number
     C                   MOVEL     P1DGSX        WADGSX                         ED Export Docum
     C                   MOVEL     P1KXCD        WAKXCD                         Country Code
      * Establish starting position
     C     KRSSA         CHAIN     @MRREWT                            90        *
      * Data record not found
     C   90              MOVEL     'USR2743'     W0RTN
      * USER: Process Data record
     C                   IF        NOT *IN90
     C                   MOVEL     'N'           YL0001                         Consignee Chg Y
     C                   EVAL      WN0001 = ' '                                 Consignee Addre
     C                   EVAL      WN0002 = ' '                                 Consignee Addre
      * Rtv Consignee for Fix RT - Consignee Name Address  * 
     C                   EXSR      SBRVGN
      * CASE: PGM.*Return code is *Normal
      * Get Consignee address line 3
      * CASE: LCL.Consignee Address Line 3 NE DB1.ED Consignee Addr 3
     C                   IF        W0RTN = ' '
     C                   IF        YL0002 <> WASCTX
     C                   MOVEL     'Y'           YL0001                         Consignee Chg Y
     C                   MOVEL     YL0002        WN0001                         Consignee Addre
     C                   END                                                    *FI
      * Get Consignee address line 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Consignee Address Ln4City NE DB1.ED Consignee Ad
      *   |- c2    : LCL.Consignee Address Ln4City is Not Blank
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0003 <> WASDTX
     C                   IF        YL0003 <> ' '
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0001                         Consignee Chg Y
     C                   MOVEL     YL0003        WN0002                         Consignee Addre
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     WASDTX        WN0002                         Consignee Addre
     C                   END                                                    *FI
      * Update Consignee if applicable
      * CASE: LCL.Consignee Chg Y/N Usr is yes
      * Print report for first doc type only
      * CASE: PAR.Print (Yes/No) USR is Yes
     C                   IF        YL0001 = 'Y'
      * PRT Fix Consignee Addr XF - Export Doc Order Hdr  * 
     C                   IF        P3DTSX = 'Y'
     C                   CLEAR                   PARC
     C                   Z-ADD     WAAIC3        PAAIC3                         Company Number
     C                   Z-ADD     WAC4NB        PAC4NB                         Order Number
     C                   MOVEL(P)  WADGSX        PADGSX                         ED Export Docum
     C                   MOVEL(P)  WAKXCD        PAKXCD                         Country Code
     C                   MOVEL(P)  WN0001        PASCTX                         ED Consignee Ad
     C                   MOVEL(P)  WN0002        PASDTX                         ED Consignee Ad
      *
     C                   CALL      'PVJEPFR'                            90      PRT Fix Consign
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PARC                           RCD: Export Doc
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVJEPFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
      * CASE: PAR.Edit Or Update Mode is Update
      * Chg Exp Doc Consignee  CH - Export Doc Order Hdr  * 
     C                   IF        P2QXSC = 'U'
     C                   EXSR      SCCHRC
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Rtv Consignee for Fix RT - Consignee Name Address  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
      * PAR = CON By name
     C                   EVAL      YL0002 = ' '                                 Consignee Addre
     C                   EVAL      YL0003 = ' '                                 Consignee Addre
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WQSB01                         Consignee_Consi
     C                   KFLD                    WQSB02                         Consignee Name
     C                   KFLD                    WQSB03                         Consignee Addre
      * Setup key
     C                   MOVEL     'E'           WQSB01                         Consignee_Consi
     C                   MOVEL     WARHTX        WQSB02                         Consignee Name
     C                   MOVEL     WARITX        WQSB03                         Consignee Addre
      * Establish starting position
     C     KRSSB         SETLL     @A2REIO                                      *
     C     KRSSB         READE     @A2REIO                                90    *
      * Data record not found
     C   90              MOVEL     'USR3023'     W0RTN
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Consignee Postal EQ DB1.Consignee Postal
      *   |- c2    : PAR.Address Country Code EQ DB1.Address Country Code
      *   '-
     C                   DOW       NOT *IN90
     C                   IF        WAPHU1 = WBLUU1 OR
     C                             WAABAB = WBZ9AA
     C                   EVAL      W0RTN = ' '                                  *Return code
      * PAR = DB1 By name
     C                   MOVEL     WBX3TX        YL0002                         Consignee Addre
     C                   MOVEL     WBX8TX        YL0003                         Consignee Addre
     C                   GOTO      SBEXIT                                       *QUIT
     C                   END                                                    *FI
     C     KRSSB         READE     @A2REIO                                90    *
     C                   ENDDO
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCCHRC        BEGSR
      *================================================================
      * Chg Exp Doc Consignee  CH - Export Doc Order Hdr  * 
      *================================================================
      *
     C                   EVAL      WN0003 = ' '                                 ED Area Office
     C                   EVAL      WN0004 = ' '                                 ED Destination
     C                   EVAL      WN0005 = ' '                                 ED Plant Locati
     C                   EVAL      WN0006 = ' '                                 ED Plant Locati
     C                   EVAL      WN0007 = ' '                                 ED Plant Number
     C                   EVAL      WN0008 = ' '                                 ED Processing P
     C                   EVAL      WN0009 = ' '                                 ED Attachment S
     C                   EVAL      WN0010 = ' '                                 ED Attachment T
     C                   EVAL      WN0011 = ' '                                 ED Xlate Desc t
     C                   EVAL      WN0012 = ' '                                 ED Unmarked Txt
     C                   EVAL      WN0013 = ' '                                 ED Date of Slau
     C                   EVAL      WN0014 = ' '                                 ED Place of Sla
     C                   EVAL      WN0015 = ' '                                 ED Date of Proc
     C                   EVAL      WN0016 = ' '                                 ED Place of pro
     C                   EVAL      WN0017 = ' '                                 ED Continue Com
     C                   EVAL      WN0018 = ' '                                 ED Certify that
     C                   EVAL      WN0019 = ' '                                 ED Inspector Na
     C                   EVAL      WN0020 = ' '                                 ED Origin Count
     C                   EVAL      WN0021 = ' '                                 ED Port of Load
     C                   EVAL      WN0022 = ' '                                 ED Transportion
     C                   EVAL      WN0023 = ' '                                 ED Seal Number
     C                   EVAL      WN0024 = ' '                                 ED Seal Number
     C                   EVAL      WN0025 = ' '                                 ED Can_Import C
     C                   EVAL      WN0026 = ' '                                 ED Can_Import C
     C                   EVAL      WN0027 = ' '                                 ED Can_Import C
     C                   Z-ADD     *ZERO         WN0028                         ED Can_Import C
     C                   Z-ADD     *ZERO         WN0029                         ED Can_Import C
     C                   Z-ADD     *ZERO         WN0030                         ED Seaboard Pla
     C                   EVAL      WN0031 = ' '                                 ED USDA Cert Nb
     C                   EVAL      WN0032 = ' '                                 ED USDA Cert Nb
     C                   EVAL      WN0033 = ' '                                 ED Can_Port of
     C                   EVAL      WN0034 = ' '                                 ED Can_Reinsp E
     C                   EVAL      WN0035 = ' '                                 ED Can_Reinsp E
     C                   EVAL      WN0036 = ' '                                 ED Can_Reinsp E
     C                   EVAL      WN0037 = ' '                                 ED Herm Sealed
     C                   EVAL      WN0038 = ' '                                 ED Herm Sealed
     C                   EVAL      WN0039 = ' '                                 ED Herm Sealed
     C                   EVAL      WN0040 = ' '                                 ED Whole Bird S
     C                   EVAL      WN0041 = ' '                                 ED Marked Sts
     C                   EVAL      WN0042 = ' '                                 ED Tamper Evide
     C                   EVAL      WN0043 = ' '                                 ED Plant Contac
     C                   Z-ADD     *ZERO         WN0044                         ED Plant Contac
     C                   EVAL      WN0045 = ' '                                 ED Modified Tex
     C                   EVAL      WN0046 = ' '                                 ED Issued Crt f
     C                   EVAL      WN0047 = ' '                                 ED Species
     C                   EVAL      WN0048 = ' '                                 ED Slaughter Pl
     C                   EVAL      WN0049 = ' '                                 ED Slaughter Pl
     C                   EVAL      WN0050 = ' '                                 ED Slaughter Pl
     C                   EVAL      WN0051 = ' '                                 ED Packaging Pl
     C                   EVAL      WN0052 = ' '                                 ED Packaging Pl
     C                   EVAL      WN0053 = ' '                                 ED Packaging Pl
     C                   EVAL      WN0054 = ' '                                 ED Manufact Pla
     C                   EVAL      WN0055 = ' '                                 ED Manufact Pla
     C                   EVAL      WN0056 = ' '                                 ED Manufact Pla
     C                   EVAL      WN0057 = ' '                                 ED USDA Name 1
     C                   EVAL      WN0058 = ' '                                 ED USDA Name 2
     C                   EVAL      WN0059 = ' '                                 ED USDA Name 3
     C                   EVAL      WN0060 = ' '                                 ED Title of Off
     C                   EVAL      WN0061 = ' '                                 ED Letter of Cr
     C                   EVAL      WN0062 = ' '                                 ED Unused prd m
     C                   Z-ADD     *ZERO         WN0063                         ED Nbr of prods
     C                   EVAL      WN0064 = ' '                                 ED Importer Nam
     C                   EVAL      WN0065 = ' '                                 ED Importer Add
     C                   EVAL      WN0066 = ' '                                 ED Importer Add
     C                   EVAL      WN0067 = ' '                                 ED Purchaser Na
     C                   EVAL      WN0068 = ' '                                 ED Purchaser Ad
     C                   EVAL      WN0069 = ' '                                 ED Purchaser Ad
     C                   EVAL      WN0070 = ' '                                 ED Place Drct S
     C                   EVAL      WN0071 = ' '                                 ED Place Drct S
     C                   EVAL      WN0072 = ' '                                 ED Place Drct S
     C                   EVAL      WN0073 = ' '                                 ED Place Drct S
     C                   EVAL      WN0074 = ' '                                 ED Currency
     C                   EVAL      WN0075 = ' '                                 ED Conditions o
     C                   Z-ADD     *ZERO         WN0076                         ED Total Unit P
     C                   Z-ADD     *ZERO         WN0077                         ED Invoice Tota
     C                   EVAL      WN0078 = ' '                                 ED Live with PH
     C                   EVAL      WN0079 = ' '                                 ED Print Status
     C                   Z-ADD     *ZERO         WN0080                         ED Total Net We
     C                   Z-ADD     *ZERO         WN0081                         ED Total Net We
     C                   Z-ADD     *ZERO         WN0082                         ED Nbr of Packa
     C                   EVAL      WN0083 = ' '                                 ED Customer PO
     C                   Z-ADD     *ZERO         WN0084                         ED Total Gross
     C                   Z-ADD     *ZERO         WN0085                         ED Total Gross
     C                   EVAL      WN0086 = ' '                                 ED Plant Number
     C                   EVAL      WN0087 = ' '                                 ED Language Xla
     C                   EVAL      WN0088 = ' '                                 ED Slaughter Da
     C                   EVAL      WN0089 = ' '                                 ED Production m
     C                   EVAL      WN0090 = ' '                                 ED Allow Print
     C                   EVAL      WN0091 = ' '                                 ED Cert of Orig
     C                   EVAL      WN0092 = ' '                                 ED Use item lab
     C                   EVAL      WN0093 = ' '                                 ED Slg_Proc Dat
     C                   EVAL      WN0094 = ' '                                 ED Total Packag
     C                   Z-ADD     *ZERO         WN0095                         ED Export Certi
     C                   Z-ADD     *ZERO         WN0096                         ED Sail Date
     C                   Z-ADD     *ZERO         WN0097                         ED Sworn on Dat
     C                   Z-ADD     *ZERO         WN0098                         ED Document Dat
     C                   Z-ADD     *ZERO         WN0099                         ED Packing Date
     C                   Z-ADD     *ZERO         WN0100                         ED Expiration D
     C                   Z-ADD     *ZERO         WN0101                         ED Packing Date
     C                   Z-ADD     *ZERO         WN0102                         ED Unused Date
     C                   EVAL      WN0103 = ' '                                 ED Print Kilogr
     C                   EVAL      WN0104 = ' '                                 ED Container Nb
     C                   EVAL      WN0105 = ' '                                 ED Slaughter Da
     C                   EVAL      WN0106 = ' '                                 EDI Status 1
     C                   EVAL      WN0107 = ' '                                 EDI Status 2
     C                   EVAL      WN0108 = ' '                                 EDI Status 3
     C                   EVAL      WN0109 = ' '                                 Record Status
     C                   Z-ADD     *ZERO         WN0110                         Job Time
     C                   EVAL      WN0111 = ' '                                 User Id
     C                   EVAL      WN0112 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0113                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @MRREWS
     C                   Z-ADD     WAAIC3        WCAIC3                         Company Number
     C                   Z-ADD     WAC4NB        WCC4NB                         Order Number
     C                   MOVEL(P)  WADGSX        WCDGSX                         ED Export Docum
     C                   MOVEL(P)  WAKXCD        WCKXCD                         Country Code
      *
     C     KLCHSC        KLIST
     C                   KFLD                    WCAIC3                         Company Number
     C                   KFLD                    WCC4NB                         Order Number
     C                   KFLD                    WCDGSX                         ED Export Docum
     C                   KFLD                    WCKXCD                         Country Code
     C     KLCHSC        CHAIN     @MRREWS                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PDMRREL0'    MDACP
     C                   MOVEL     '@MRREWS'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPDMR1        YARDCS
      * USER: Processing after Data read
      * * E00994 Susan Mason
      * * these functions will execute the new routines
      * * that will create records to the comment file
      * * if the consignee or consignor changed
      * CASE: MPD = H OR E
      *  - c1 OR c2
      *   |- c1    : DB1.ED Export Document Type is MPD
      *   |- c2    : DB1.ED Export Document Type is 9290/9285/9295/9115/9
      *   '-
      * R16637 DN 09/11/20-Pass in New Consignor/Consignee Fields.
      * Rtv/Consignor/ConsigneXF - Export Doc Order Comment  * 
     C                   IF        WCDGSX = 'H' OR
     C                             WCDGSX = 'E'
     C                   CALL      'PNVIXFR'                            90      Rtv/Consignor/C
     C                   PARM      *BLANK        W0RTN
     C                   PARM      ##PGM         WQ0001                         *PROGRAM
     C                   PARM      WCPUTX        WQ0002                         ED Consignor Na
     C                   PARM      WCPVTX        WQ0003                         ED Consignor Ad
     C                   PARM      WCPWTX        WQ0004                         ED Consignor Ad
     C                   PARM      WCRVTX        WQ0005                         ED Consignor Ad
     C                   PARM      WCPPU1        WQ0006                         ED Consignor Ad
     C                   PARM      WCZ7AA        WQ0007                         ED Consignor St
     C                   PARM      WCPDU1        WQ0008                         ED Consignor Po
     C                   PARM      WCZ8AA        WQ0009                         ED Consignor Co
     C                   PARM      WCRHTX        WQ0010                         ED Consignee Na
     C                   PARM      WCRITX        WQ0011                         ED Consignee Ad
     C                   PARM      WCRJTX        WQ0012                         ED Consignee Ad
     C                   PARM      WCSCTX        WQ0013                         ED Consignee Ad
     C                   PARM      WCSDTX        WQ0014                         ED Consignee Ad
     C                   PARM      WCAAAB        WQ0015                         ED Consignee St
     C                   PARM      WCPHU1        WQ0016                         ED Consignee Po
     C                   PARM      WCABAB        WQ0017                         ED Consignee Co
     C                   PARM      WAAIC3        WQ0018                         Company Number
     C                   PARM      WAC4NB        WQ0019                         Order Number
     C                   PARM      WADGSX        WQ0020                         ED Export Docum
     C                   PARM      WAKXCD        WQ0021                         Country Code
     C                   PARM      WN0003        WQ0022                         ED Area Office
     C                   PARM      WN0004        WQ0023                         ED Destination
     C                   PARM      WAPUTX        WQ0024                         ED Consignor Na
     C                   PARM      WAPVTX        WQ0025                         ED Consignor Ad
     C                   PARM      WAPWTX        WQ0026                         ED Consignor Ad
     C                   PARM      WARVTX        WQ0027                         ED Consignor Ad
     C                   PARM      WAPPU1        WQ0028                         ED Consignor Ad
     C                   PARM      WAZ7AA        WQ0029                         ED Consignor St
     C                   PARM      WAPDU1        WQ0030                         ED Consignor Po
     C                   PARM      WAZ8AA        WQ0031                         ED Consignor Co
     C                   PARM      WARHTX        WQ0032                         ED Consignee Na
     C                   PARM      WARITX        WQ0033                         ED Consignee Ad
     C                   PARM      WARJTX        WQ0034                         ED Consignee Ad
     C                   PARM      WN0001        WQ0035                         ED Consignee Ad
     C                   PARM      WN0002        WQ0036                         ED Consignee Ad
     C                   PARM      WAAAAB        WQ0037                         ED Consignee St
     C                   PARM      WAPHU1        WQ0038                         ED Consignee Po
     C                   PARM      WAABAB        WQ0039                         ED Consignee Co
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNVIXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
      * Move non-key fields to @MRREWS
     C                   MOVEL(P)  WAPUTX        WCPUTX                         ED Consignor Na
     C                   MOVEL(P)  WAPVTX        WCPVTX                         ED Consignor Ad
     C                   MOVEL(P)  WAPWTX        WCPWTX                         ED Consignor Ad
     C                   MOVEL(P)  WARVTX        WCRVTX                         ED Consignor Ad
     C                   MOVEL(P)  WAPPU1        WCPPU1                         ED Consignor Ad
     C                   MOVEL(P)  WAZ7AA        WCZ7AA                         ED Consignor St
     C                   MOVEL(P)  WAPDU1        WCPDU1                         ED Consignor Po
     C                   MOVEL(P)  WAZ8AA        WCZ8AA                         ED Consignor Co
     C                   MOVEL(P)  WARHTX        WCRHTX                         ED Consignee Na
     C                   MOVEL(P)  WARITX        WCRITX                         ED Consignee Ad
     C                   MOVEL(P)  WARJTX        WCRJTX                         ED Consignee Ad
     C                   MOVEL(P)  WN0001        WCSCTX                         ED Consignee Ad
     C                   MOVEL(P)  WN0002        WCSDTX                         ED Consignee Ad
     C                   MOVEL(P)  WAAAAB        WCAAAB                         ED Consignee St
     C                   MOVEL(P)  WAPHU1        WCPHU1                         ED Consignee Po
     C                   MOVEL(P)  WAABAB        WCABAB                         ED Consignee Co
     C                   MOVEL(P)  WAORNA        WCORNA                         ED Shipping Mar
     C                   MOVEL(P)  WAP2TX        WCP2TX                         ED Remark Const
     C                   MOVEL(P)  WAP3TX        WCP3TX                         ED Remark Const
     C                   MOVEL(P)  WAP4TX        WCP4TX                         ED Remark Const
     C                   MOVEL(P)  WAP5TX        WCP5TX                         ED Remark Const
     C                   MOVEL(P)  WAP6TX        WCP6TX                         ED Remark Const
     C                   MOVEL(P)  WAYHTX        WCYHTX                         ED Remark Const
     C                   MOVEL(P)  WAYITX        WCYITX                         ED Remark Const
     C                   MOVEL(P)  WARETX        WCRETX                         ED Remark Const
     C                   Z-ADD     WAAJNX        WCAJNX                         ED Consignee Ad
     C                   MOVEL(P)  WAYFTX        WCYFTX                         ED Form Identif
     C                   MOVEL(P)  WAX9TX        WCX9TX                         ED Cold Storage
     C                   MOVEL(P)  WAYATX        WCYATX                         ED Cold Storage
     C                   MOVEL(P)  WAYBTX        WCYBTX                         ED Cold Storage
     C                   MOVEL(P)  WAB5AA        WCB5AA                         ED Cold Storage
     C                   MOVEL(P)  WAYCTX        WCYCTX                         ED Slaughter Da
     C                   MOVEL(P)  WAYDTX        WCYDTX                         ED Production m
     C                   MOVEL(P)  WAYETX        WCYETX                         ED Production m
     C                   MOVEL(P)  WAB6AA        WCB6AA                         ED Booking Nbr
     C                   MOVEL(P)  WAO5SX        WCO5SX                         ED MPR Canadian
     C                   MOVEL(P)  WALKSC        WCLKSC                         ED Submit Statu
     C                   MOVEL(P)  WALLSC        WCLLSC                         EDOH Unused Sts
     C                   MOVEL(P)  WAPIU1        WCPIU1                         EDOH Unused Tex
     C                   MOVEL(P)  WAPJU1        WCPJU1                         EDOH Unused Tex
     C                   Z-ADD     WAFFNZ        WCFFNZ                         EDOH Unused Num
     C                   Z-ADD     WABUDX        WCBUDX                         EDOH Unused Dat
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPDMR1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                   Z-ADD     ##JTM         WCAATM                         Job Time
     C                   MOVEL     ##USR         WCAYNA                         User Id
     C                   MOVEL     ##PGM         WCA0NA                         Job Name
     C                   Z-ADD     ##JDT         WCAXDT                         Job Date
      * Set PGM.*Record Data Changed flag
     C                   IF        QPDMR1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @MRREWS                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PDMRREL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   UASUBR        BEGSR
      *================================================================
      * Creation & Modification log
      *================================================================
      * S022945 JM 01/17/25-Update consignee address line 3 or 4.
      * This will fix export order for city/state swap.
      *================================================================
     CSR   UAEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Initialise indicators for re-entry
     C                   MOVE      '0'           *IN
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WAABNX                         ED Can_Import C
     C                   Z-ADD     *ZERO         WAACNX                         ED Can_Import C
     C                   Z-ADD     *ZERO         WAADNX                         ED Seaboard Pla
     C                   Z-ADD     *ZERO         WAAHNX                         ED Plant Contac
     C                   Z-ADD     *ZERO         WAAINX                         ED Nbr of prods
     C                   Z-ADD     *ZERO         WAA7VL                         ED Total Unit P
     C                   Z-ADD     *ZERO         WAA8VL                         ED Invoice Tota
     C                   Z-ADD     *ZERO         WAHRWG                         ED Total Net We
     C                   Z-ADD     *ZERO         WABIVL                         ED Total Net We
     C                   Z-ADD     *ZERO         WAK2QT                         ED Nbr of Packa
     C                   Z-ADD     *ZERO         WAHSWG                         ED Total Gross
     C                   Z-ADD     *ZERO         WABJVL                         ED Total Gross
     C                   Z-ADD     *ZERO         WAMQDT                         ED Export Certi
     C                   Z-ADD     *ZERO         WAMRDT                         ED Sail Date
     C                   Z-ADD     *ZERO         WAMSDT                         ED Sworn on Dat
     C                   Z-ADD     *ZERO         WAAJNX                         ED Consignee Ad
     C                   Z-ADD     *ZERO         WAPADT                         ED Document Dat
     C                   Z-ADD     *ZERO         WAPBDT                         ED Packing Date
     C                   Z-ADD     *ZERO         WAPCDT                         ED Expiration D
     C                   Z-ADD     *ZERO         WAPDDT                         ED Packing Date
     C                   Z-ADD     *ZERO         WAPEDT                         ED Unused Date
     C                   Z-ADD     *ZERO         WAFFNZ                         EDOH Unused Num
     C                   Z-ADD     *ZERO         WABUDX                         EDOH Unused Dat
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBD3C7                         Consignee Numbe
     C                   Z-ADD     *ZERO         WBNJNX                         Consignee Phone
     C                   Z-ADD     *ZERO         WBNKNX                         Consignee Unuse
     C                   Z-ADD     *ZERO         WBFENZ                         CNA Unused Nbr
     C                   Z-ADD     *ZERO         WBBTDX                         CNA Unused Date
     C                   Z-ADD     *ZERO         WBMJDT                         Create Date
     C                   Z-ADD     *ZERO         WBBETM                         Create Time
     C                   Z-ADD     *ZERO         WBMKDT                         Change Date
     C                   Z-ADD     *ZERO         WBBFTM                         Change Time
     C                   MOVEL     'N'           W0PMT
      * Define local work field Consignee Chg Y/N Usr
     C                   EVAL      YL0001 = ' '
      * Define local work field Consignee Address Line 3
     C                   EVAL      YL0002 = ' '
      * Define local work field Consignee Address Ln4City
     C                   EVAL      YL0003 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
