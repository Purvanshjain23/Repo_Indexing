     H/TITLE Exc Crt Load FC       XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 03/31/18  Time  : 12:41:05
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPOBCCPL1IF  E           K        DISK
      * RTV : Load Freight Charge       Retrieval index
      *
     FPMEYCPL1IF  E           K        DISK
      * RTV : Load Freight Charge Cmt   Retrieval index
      *
     FPMDKCPL1IF  E           K        DISK
      * RTV : Load Freight Charge Ref   Retrieval index
      *
     FPBCYCPL1IF  E           K        DISK
      * RTV : TMS Load Freight Charge   Retrieval index
      *
     FPBC1REL2IF  E           K        DISK
      * RSQ : Freight Charge XREF TMS   TMS EDI Code
      *
     FPOA9REL1IF  E           K        DISK
      * RTV : Freight Charge            Retrieval index
      *
     FPOBCCPL6IF  E           K        DISK
      * RSQ : Load Freight Charge       Ld/FCde/Seq(d)
      *
     FPMDJREL3IF  E           K        DISK
      * RSQ : Freight Charge Reference  FCde/RefTyp/RefCde
      *
     FPMDIREL1IF  E           K        DISK
      * RTV : Charge Reference          Retrieval index
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPMEYCPL2IF  E           K        DISK
      * RSQ : Load Freight Charge Cmt   Ld/FC/Sq/Sq(d)
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPOBCCPL0UF  E           K        DISK                      A
      * UPD : Load Freight Charge       Update index
      *
     FPMEYCPL0UF  E           K        DISK                      A
      * UPD : Load Freight Charge Cmt   Update index
      *
     FPMDKCPL0UF  E           K        DISK                      A
      * UPD : Load Freight Charge Ref   Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
      * Long constants
     E                    @CN#    1  11  6   @CN    25
     I@BCCPJ8
      * Load Freight Charge       Retrieval index
      * Renamed input format fields
     I              BCRMNB                          WARMNB
     I              BCCDAA                          WACDAA
     I              BCEPNY                          WAEPNY
     I              BCC5VL                          WAC5VL
     I              BCKBSX                          WAKBSX
     I              BCCFAA                          WACFAA
     I              BCKDSX                          WAKDSX
     I              BCKESX                          WAKESX
     I              BCKFSX                          WAKFSX
     I              BCKGSX                          WAKGSX
     I              BCKSSX                          WAKSSX
     I              BCKTSX                          WAKTSX
     I              BCKHSX                          WAKHSX
     I              BCKISX                          WAKISX
     I              BCKJSX                          WAKJSX
     I              BCEQNY                          WAEQNY
     I              BCVSST                          WAVSST
     I              BCMJDT                          WAMJDT
     I              BCBETM                          WABETM
     I              BCCCVN                          WACCVN
     I              BCCDVN                          WACDVN
     I              BCMKDT                          WAMKDT
     I              BCBFTM                          WABFTM
     I              BCCEVN                          WACEVN
     I              BCCFVN                          WACFVN
      *
     I@BCCPJ7
      * Load Freight Charge       Update index
      * Renamed input format fields
     I              BCRMNB                          WBRMNB
     I              BCCDAA                          WBCDAA
     I              BCEPNY                          WBEPNY
     I              BCC5VL                          WBC5VL
     I              BCKBSX                          WBKBSX
     I              BCCFAA                          WBCFAA
     I              BCKDSX                          WBKDSX
     I              BCKESX                          WBKESX
     I              BCKFSX                          WBKFSX
     I              BCKGSX                          WBKGSX
     I              BCKSSX                          WBKSSX
     I              BCKTSX                          WBKTSX
     I              BCKHSX                          WBKHSX
     I              BCKISX                          WBKISX
     I              BCKJSX                          WBKJSX
     I              BCEQNY                          WBEQNY
     I              BCVSST                          WBVSST
     I              BCMJDT                          WBMJDT
     I              BCBETM                          WBBETM
     I              BCCCVN                          WBCCVN
     I              BCCDVN                          WBCDVN
     I              BCMKDT                          WBMKDT
     I              BCBFTM                          WBBFTM
     I              BCCEVN                          WBCEVN
     I              BCCFVN                          WBCFVN
      *
     I@EYCPYK
      * Load Freight Charge Cmt   Retrieval index
      * Renamed input format fields
     I              EYRMNB                          WCRMNB
     I              EYCDAA                          WCCDAA
     I              EYEPNY                          WCEPNY
     I              EYNZNY                          WCNZNY
     I              EYS3NA                          WCS3NA
     I              EYVSST                          WCVSST
     I              EYMJDT                          WCMJDT
     I              EYBETM                          WCBETM
     I              EYCCVN                          WCCCVN
     I              EYCDVN                          WCCDVN
     I              EYMKDT                          WCMKDT
     I              EYBFTM                          WCBFTM
     I              EYCEVN                          WCCEVN
     I              EYCFVN                          WCCFVN
      *
     I@EYCPYJ
      * Load Freight Charge Cmt   Update index
      * Renamed input format fields
     I              EYRMNB                          WDRMNB
     I              EYCDAA                          WDCDAA
     I              EYEPNY                          WDEPNY
     I              EYNZNY                          WDNZNY
     I              EYS3NA                          WDS3NA
     I              EYVSST                          WDVSST
     I              EYMJDT                          WDMJDT
     I              EYBETM                          WDBETM
     I              EYCCVN                          WDCCVN
     I              EYCDVN                          WDCDVN
     I              EYMKDT                          WDMKDT
     I              EYBFTM                          WDBFTM
     I              EYCEVN                          WDCEVN
     I              EYCFVN                          WDCFVN
      *
     I@DKCPRF
      * Load Freight Charge Ref   Retrieval index
      * Renamed input format fields
     I              DKRMNB                          WERMNB
     I              DKCDAA                          WECDAA
     I              DKEPNY                          WEEPNY
     I              DKIYAA                          WEIYAA
     I              DKKFTX                          WEKFTX
     I              DKKBNY                          WEKBNY
     I              DKNET1                          WENET1
     I              DKAZST                          WEAZST
     I              DKVSST                          WEVSST
     I              DKMJDT                          WEMJDT
     I              DKBETM                          WEBETM
     I              DKCCVN                          WECCVN
     I              DKCDVN                          WECDVN
     I              DKMKDT                          WEMKDT
     I              DKBFTM                          WEBFTM
     I              DKCEVN                          WECEVN
     I              DKCFVN                          WECFVN
      *
     I@DKCPRE
      * Load Freight Charge Ref   Update index
      * Renamed input format fields
     I              DKRMNB                          WFRMNB
     I              DKCDAA                          WFCDAA
     I              DKEPNY                          WFEPNY
     I              DKIYAA                          WFIYAA
     I              DKKFTX                          WFKFTX
     I              DKKBNY                          WFKBNY
     I              DKNET1                          WFNET1
     I              DKAZST                          WFAZST
     I              DKVSST                          WFVSST
     I              DKMJDT                          WFMJDT
     I              DKBETM                          WFBETM
     I              DKCCVN                          WFCCVN
     I              DKCDVN                          WFCDVN
     I              DKMKDT                          WFMKDT
     I              DKBFTM                          WFBFTM
     I              DKCEVN                          WFCEVN
     I              DKCFVN                          WFCFVN
      *
     I@CYCPYC
      * TMS Load Freight Charge   Retrieval index
      * Renamed input format fields
     I              CYTMLD                          WGTMLD
     I              CYHHNB                          WGHHNB
     I              CYA5D8                          WGA5D8
     I              CYALTH                          WGALTH
     I              CYU5AA                          WGU5AA
     I              CYU6AA                          WGU6AA
     I              CYU7AA                          WGU7AA
     I              CYM0VL                          WGM0VL
     I              CYM1VL                          WGM1VL
     I              CYDRSC                          WGDRSC
     I              CYHENB                          WGHENB
     I              CYU8AA                          WGU8AA
     I              CYURAA                          WGURAA
     I              CYCFAA                          WGCFAA
     I              CYDLSC                          WGDLSC
     I              CYTPRC                          WGTPRC
     I              CYUYAA                          WGUYAA
     I              CYA0D8                          WGA0D8
     I              CYD9TM                          WGD9TM
      *
     I@C1REYY
      * Freight Charge XREF TMS   TMS EDI Code
      * Renamed input format fields
     I              C1CDAA                          WHCDAA
     I              C1U7AA                          WHU7AA
     I              C1VDAA                          WHVDAA
     I              C1D6SC                          WHD6SC
     I              C1VSST                          WHVSST
     I              C1MJDT                          WHMJDT
     I              C1BETM                          WHBETM
     I              C1CCVN                          WHCCVN
     I              C1CDVN                          WHCDVN
     I              C1MKDT                          WHMKDT
     I              C1BFTM                          WHBFTM
     I              C1CEVN                          WHCEVN
     I              C1CFVN                          WHCFVN
      *
     I@A9REJZ
      * Freight Charge            Retrieval index
      * Renamed input format fields
     I              A9CDAA                          WICDAA
     I              A9PNNA                          WIPNNA
     I              A9C3VL                          WIC3VL
     I              A9JUSX                          WIJUSX
     I              A9JZSX                          WIJZSX
     I              A9J5SX                          WIJ5SX
     I              A9JVSX                          WIJVSX
     I              A9JWSX                          WIJWSX
     I              A9JXSX                          WIJXSX
     I              A9JYSX                          WIJYSX
     I              A9KKSX                          WIKKSX
     I              A9J0SX                          WIJ0SX
     I              A9J1SX                          WIJ1SX
     I              A9KRSX                          WIKRSX
     I              A9KPSX                          WIKPSX
     I              A9KQSX                          WIKQSX
     I              A9J2SX                          WIJ2SX
     I              A9J3SX                          WIJ3SX
     I              A9J4SX                          WIJ4SX
     I              A9J6SX                          WIJ6SX
     I              A9J7SX                          WIJ7SX
     I              A9J8SX                          WIJ8SX
     I              A9J9SX                          WIJ9SX
     I              A9KASX                          WIKASX
     I              A9OPDT                          WIOPDT
     I              A9VSST                          WIVSST
     I              A9MJDT                          WIMJDT
     I              A9BETM                          WIBETM
     I              A9CCVN                          WICCVN
     I              A9CDVN                          WICDVN
     I              A9MKDT                          WIMKDT
     I              A9BFTM                          WIBFTM
     I              A9CEVN                          WICEVN
     I              A9CFVN                          WICFVN
      *
     I@BCCPRK
      * Load Freight Charge       Ld/FCde/Seq(d)
      * Renamed input format fields
     I              BCRMNB                          WJRMNB
     I              BCCDAA                          WJCDAA
     I              BCEPNY                          WJEPNY
     I              BCC5VL                          WJC5VL
     I              BCKBSX                          WJKBSX
     I              BCCFAA                          WJCFAA
     I              BCKDSX                          WJKDSX
     I              BCKESX                          WJKESX
     I              BCKFSX                          WJKFSX
     I              BCKGSX                          WJKGSX
     I              BCKSSX                          WJKSSX
     I              BCKTSX                          WJKTSX
     I              BCKHSX                          WJKHSX
     I              BCKISX                          WJKISX
     I              BCKJSX                          WJKJSX
     I              BCEQNY                          WJEQNY
     I              BCVSST                          WJVSST
     I              BCMJDT                          WJMJDT
     I              BCBETM                          WJBETM
     I              BCCCVN                          WJCCVN
     I              BCCDVN                          WJCDVN
     I              BCMKDT                          WJMKDT
     I              BCBFTM                          WJBFTM
     I              BCCEVN                          WJCEVN
     I              BCCFVN                          WJCFVN
      *
     I@DJREYA
      * Freight Charge Reference  FCde/RefTyp/RefCde
      * Renamed input format fields
     I              DJCDAA                          WKCDAA
     I              DJIYAA                          WKIYAA
     I              DJAYST                          WKAYST
     I              DJVSST                          WKVSST
     I              DJMJDT                          WKMJDT
     I              DJBETM                          WKBETM
     I              DJCCVN                          WKCCVN
     I              DJCDVN                          WKCDVN
     I              DJMKDT                          WKMKDT
     I              DJBFTM                          WKBFTM
     I              DJCEVN                          WKCEVN
     I              DJCFVN                          WKCFVN
      *
     I@DIREQ5
      * Charge Reference          Retrieval index
      * Renamed input format fields
     I              DIIYAA                          WLIYAA
     I              DIR8NA                          WLR8NA
     I              DIKCTX                          WLKCTX
     I              DIVSST                          WLVSST
     I              DIMJDT                          WLMJDT
     I              DIBETM                          WLBETM
     I              DICCVN                          WLCCVN
     I              DICDVN                          WLCDVN
     I              DIMKDT                          WLMKDT
     I              DIBFTM                          WLBFTM
     I              DICEVN                          WLCEVN
     I              DICFVN                          WLCFVN
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WMRMNB
     I              FLRUNB                          WMRUNB
     I              FLRVNB                          WMRVNB
     I              FLDQTX                          WMDQTX
     I              FLRWNB                          WMRWNB
     I              FLRXNB                          WMRXNB
     I              FLSQNB                          WMSQNB
     I              FLT0NB                          WMT0NB
     I              FLT1NB                          WMT1NB
     I              FLR1NB                          WMR1NB
     I              FLAIC3                          WMAIC3
     I              FLC4NB                          WMC4NB
     I              FLVCST                          WMVCST
     I              FLKEDT                          WMKEDT
     I              FLSXNB                          WMSXNB
     I              FLKFDT                          WMKFDT
     I              FLACTM                          WMACTM
     I              FLK5TX                          WMK5TX
     I              FLW5CD                          WMW5CD
     I              FLEJDT                          WMEJDT
     I              FLAGTM                          WMAGTM
     I              FLKJDT                          WMKJDT
     I              FLATTM                          WMATTM
     I              FLHDDT                          WMHDDT
     I              FLAUTM                          WMAUTM
     I              FLKKDT                          WMKKDT
     I              FLAVTM                          WMAVTM
     I              FLZ4NB                          WMZ4NB
     I              FLY7ST                          WMY7ST
     I              FLY2ST                          WMY2ST
     I              FLWHTX                          WMWHTX
     I              FLWITX                          WMWITX
     I              FLWJTX                          WMWJTX
     I              FLWKTX                          WMWKTX
     I              FLWLTX                          WMWLTX
     I              FLN7DT                          WMN7DT
     I              FLN8DT                          WMN8DT
     I              FLN9DT                          WMN9DT
     I              FLB3TM                          WMB3TM
     I              FLB4TM                          WMB4TM
     I              FLB5TM                          WMB5TM
     I              FLIASX                          WMIASX
     I              FLIBSX                          WMIBSX
     I              FLICSX                          WMICSX
     I              FLWVTX                          WMWVTX
     I              FLWWTX                          WMWWTX
     I              FLWXTX                          WMWXTX
     I              FLUVST                          WMUVST
     I              FLUWST                          WMUWST
     I              FLUXST                          WMUXST
     I              FLAATM                          WMAATM
     I              FLAYNA                          WMAYNA
     I              FLA0NA                          WMA0NA
     I              FLAXDT                          WMAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WORMNB
     I              FLRUNB                          WORUNB
     I              FLRVNB                          WORVNB
     I              FLDQTX                          WODQTX
     I              FLRWNB                          WORWNB
     I              FLRXNB                          WORXNB
     I              FLSQNB                          WOSQNB
     I              FLT0NB                          WOT0NB
     I              FLT1NB                          WOT1NB
     I              FLR1NB                          WOR1NB
     I              FLAIC3                          WOAIC3
     I              FLC4NB                          WOC4NB
     I              FLVCST                          WOVCST
     I              FLKEDT                          WOKEDT
     I              FLSXNB                          WOSXNB
     I              FLKFDT                          WOKFDT
     I              FLACTM                          WOACTM
     I              FLK5TX                          WOK5TX
     I              FLW5CD                          WOW5CD
     I              FLEJDT                          WOEJDT
     I              FLAGTM                          WOAGTM
     I              FLKJDT                          WOKJDT
     I              FLATTM                          WOATTM
     I              FLHDDT                          WOHDDT
     I              FLAUTM                          WOAUTM
     I              FLKKDT                          WOKKDT
     I              FLAVTM                          WOAVTM
     I              FLZ4NB                          WOZ4NB
     I              FLY7ST                          WOY7ST
     I              FLY2ST                          WOY2ST
     I              FLWHTX                          WOWHTX
     I              FLWITX                          WOWITX
     I              FLWJTX                          WOWJTX
     I              FLWKTX                          WOWKTX
     I              FLWLTX                          WOWLTX
     I              FLN7DT                          WON7DT
     I              FLN8DT                          WON8DT
     I              FLN9DT                          WON9DT
     I              FLB3TM                          WOB3TM
     I              FLB4TM                          WOB4TM
     I              FLB5TM                          WOB5TM
     I              FLIASX                          WOIASX
     I              FLIBSX                          WOIBSX
     I              FLICSX                          WOICSX
     I              FLWVTX                          WOWVTX
     I              FLWWTX                          WOWWTX
     I              FLWXTX                          WOWXTX
     I              FLUVST                          WOUVST
     I              FLUWST                          WOUWST
     I              FLUXST                          WOUXST
     I              FLAATM                          WOAATM
     I              FLAYNA                          WOAYNA
     I              FLA0NA                          WOA0NA
     I              FLAXDT                          WOAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WRAIC3
     I              BEC4NB                          WRC4NB
     I              BEJNCD                          WRJNCD
     I              BEANC7                          WRANC7
     I              BEBKC7                          WRBKC7
     I              BEBRTX                          WRBRTX
     I              BEHMNA                          WRHMNA
     I              BEHONA                          WRHONA
     I              BEHPNA                          WRHPNA
     I              BEHNNA                          WRHNNA
     I              BEDBCD                          WRDBCD
     I              BECKTX                          WRCKTX
     I              BEB0C7                          WRB0C7
     I              BEAETX                          WRAETX
     I              BEB1NA                          WRB1NA
     I              BEB3NA                          WRB3NA
     I              BEB4NA                          WRB4NA
     I              BEB2NA                          WRB2NA
     I              BEBHCD                          WRBHCD
     I              BEC8TX                          WRC8TX
     I              BEBCNA                          WRBCNA
     I              BEA0DT                          WRA0DT
     I              BEA5DT                          WRA5DT
     I              BEGNDT                          WRGNDT
     I              BEACDT                          WRACDT
     I              BEAQCD                          WRAQCD
     I              BEB6NA                          WRB6NA
     I              BEBYNA                          WRBYNA
     I              BEBZNA                          WRBZNA
     I              BEGTST                          WRGTST
     I              BEGVST                          WRGVST
     I              BEGUST                          WRGUST
     I              BEQFST                          WRQFST
     I              BECQCD                          WRCQCD
     I              BEGJST                          WRGJST
     I              BEGWST                          WRGWST
     I              BEGXST                          WRGXST
     I              BEGYST                          WRGYST
     I              BEAODT                          WRAODT
     I              BEAIVN                          WRAIVN
     I              BECXDT                          WRCXDT
     I              BEJZVA                          WRJZVA
     I              BEA1WG                          WRA1WG
     I              BEXIST                          WRXIST
     I              BEXJST                          WRXJST
     I              BEXKST                          WRXKST
     I              BEEIDT                          WREIDT
     I              BEAFTM                          WRAFTM
     I              BEE8CD                          WRE8CD
     I              BEE9CD                          WRE9CD
     I              BERMNB                          WRRMNB
     I              BETBNB                          WRTBNB
     I              BER1NB                          WRR1NB
     I              BEPJST                          WRPJST
     I              BEU0ST                          WRU0ST
     I              BEU1ST                          WRU1ST
     I              BEQ2CD                          WRQ2CD
     I              BEU2ST                          WRU2ST
     I              BEVEST                          WRVEST
     I              BEVFST                          WRVFST
     I              BEVGST                          WRVGST
     I              BERPCD                          WRRPCD
     I              BERNNB                          WRRNNB
     I              BEVDST                          WRVDST
     I              BEATIN                          WRATIN
     I              BEU4ST                          WRU4ST
     I              BEU5ST                          WRU5ST
     I              BERSRN                          WRRSRN
     I              BEMHNA                          WRMHNA
     I              BEMINA                          WRMINA
     I              BEWBST                          WRWBST
     I              BER4CD                          WRR4CD
     I              BEBFCD                          WRBFCD
     I              BEQ4CD                          WRQ4CD
     I              BET3NB                          WRT3NB
     I              BESICD                          WRSICD
     I              BECONB                          WRCONB
     I              BECEST                          WRCEST
     I              BEAWDT                          WRAWDT
     I              BEJPCD                          WRJPCD
     I              BEXUST                          WRXUST
     I              BEZ1ST                          WRZ1ST
     I              BEVRVA                          WRVRVA
     I              BEOBST                          WROBST
     I              BEBCST                          WRBCST
     I              BEBDST                          WRBDST
     I              BEB7VL                          WRB7VL
     I              BEGASX                          WRGASX
     I              BEGBSX                          WRGBSX
     I              BEGCSX                          WRGCSX
     I              BEGDSX                          WRGDSX
     I              BEFNSX                          WRFNSX
     I              BEFOSX                          WRFOSX
     I              BEFPSX                          WRFPSX
     I              BEFQSX                          WRFQSX
     I              BEFRSX                          WRFRSX
     I              BEFSSX                          WRFSSX
     I              BEFTSX                          WRFTSX
     I              BEFUSX                          WRFUSX
     I              BEFVSX                          WRFVSX
     I              BEFWSX                          WRFWSX
     I              BEFXSX                          WRFXSX
     I              BEFYSX                          WRFYSX
     I              BENODT                          WRNODT
     I              BENPDT                          WRNPDT
     I              BENQDT                          WRNQDT
     I              BENRDT                          WRNRDT
     I              BENSDT                          WRNSDT
     I              BEBPTM                          WRBPTM
     I              BEBQTM                          WRBQTM
     I              BEBRTM                          WRBRTM
     I              BEBSTM                          WRBSTM
     I              BEBTTM                          WRBTTM
     I              BEH0NX                          WRH0NX
     I              BEH1NX                          WRH1NX
     I              BEH2NX                          WRH2NX
     I              BEH3NX                          WRH3NX
     I              BEH4NX                          WRH4NX
     I              BEC0C7                          WRC0C7
     I              BEUVST                          WRUVST
     I              BEUWST                          WRUWST
     I              BEUXST                          WRUXST
     I              BEAATM                          WRAATM
     I              BEAYNA                          WRAYNA
     I              BEA0NA                          WRA0NA
     I              BEAXDT                          WRAXDT
      *
     I@EYCPYM
      * Load Freight Charge Cmt   Ld/FC/Sq/Sq(d)
      * Renamed input format fields
     I              EYRMNB                          WSRMNB
     I              EYCDAA                          WSCDAA
     I              EYEPNY                          WSEPNY
     I              EYNZNY                          WSNZNY
     I              EYS3NA                          WSS3NA
     I              EYVSST                          WSVSST
     I              EYMJDT                          WSMJDT
     I              EYBETM                          WSBETM
     I              EYCCVN                          WSCCVN
     I              EYCDVN                          WSCDVN
     I              EYMKDT                          WSMKDT
     I              EYBFTM                          WSBFTM
     I              EYCEVN                          WSCEVN
     I              EYCFVN                          WSCFVN
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WTRMNB
     I              FJAIC3                          WTAIC3
     I              FJAODT                          WTAODT
     I              FJPJST                          WTPJST
     I              FJPKST                          WTPKST
     I              FJRNNB                          WTRNNB
     I              FJDMTX                          WTDMTX
     I              FJDNTX                          WTDNTX
     I              FJDOTX                          WTDOTX
     I              FJWTTX                          WTWTTX
     I              FJWUTX                          WTWUTX
     I              FJRPNB                          WTRPNB
     I              FJFLAM                          WTFLAM
     I              FJXQST                          WTXQST
     I              FJRRNB                          WTRRNB
     I              FJDXTX                          WTDXTX
     I              FJDYTX                          WTDYTX
     I              FJSBNB                          WTSBNB
     I              FJBZNA                          WTBZNA
     I              FJRONB                          WTRONB
     I              FJSQNB                          WTSQNB
     I              FJR1NB                          WTR1NB
     I              FJVCST                          WTVCST
     I              FJVDST                          WTVDST
     I              FJSDNB                          WTSDNB
     I              FJPAOU                          WTPAOU
     I              FJDGWG                          WTDGWG
     I              FJSXNB                          WTSXNB
     I              FJHADT                          WTHADT
     I              FJAART                          WTAART
     I              FJDHWG                          WTDHWG
     I              FJDIWG                          WTDIWG
     I              FJAQDT                          WTAQDT
     I              FJS6NB                          WTS6NB
     I              FJT4NB                          WTT4NB
     I              FJPRTM                          WTPRTM
     I              FJNPSV                          WTNPSV
     I              FJJ8TX                          WTJ8TX
     I              FJTLMI                          WTTLMI
     I              FJJ9TX                          WTJ9TX
     I              FJQ2CD                          WTQ2CD
     I              FJVPCD                          WTVPCD
     I              FJDBCD                          WTDBCD
     I              FJGRWE                          WTGRWE
     I              FJXCCD                          WTXCCD
     I              FJU2ST                          WTU2ST
     I              FJF9DT                          WTF9DT
     I              FJONTM                          WTONTM
     I              FJJ4DT                          WTJ4DT
     I              FJTRTM                          WTTRTM
     I              FJJ5DT                          WTJ5DT
     I              FJSPTM                          WTSPTM
     I              FJJ6DT                          WTJ6DT
     I              FJLFTM                          WTLFTM
     I              FJJ7DT                          WTJ7DT
     I              FJBOTM                          WTBOTM
     I              FJJ8DT                          WTJ8DT
     I              FJBLTM                          WTBLTM
     I              FJKIDT                          WTKIDT
     I              FJASTM                          WTASTM
     I              FJKADT                          WTKADT
     I              FJAJCM                          WTAJCM
     I              FJXACD                          WTXACD
     I              FJOANA                          WTOANA
     I              FJK4TX                          WTK4TX
     I              FJVOAG                          WTVOAG
     I              FJKBDT                          WTKBDT
     I              FJNBBO                          WTNBBO
     I              FJW4CD                          WTW4CD
     I              FJEFDT                          WTEFDT
     I              FJCNTN                          WTCNTN
     I              FJKCDT                          WTKCDT
     I              FJTMIN                          WTTMIN
     I              FJKDDT                          WTKDDT
     I              FJVMNB                          WTVMNB
     I              FJOCFR                          WTOCFR
     I              FJKJDT                          WTKJDT
     I              FJATTM                          WTATTM
     I              FJOTRS                          WTOTRS
     I              FJRNST                          WTRNST
     I              FJBRBK                          WTBRBK
     I              FJEIDT                          WTEIDT
     I              FJRMST                          WTRMST
     I              FJAJCD                          WTAJCD
     I              FJKKDT                          WTKKDT
     I              FJAVTM                          WTAVTM
     I              FJKZDT                          WTKZDT
     I              FJAXTM                          WTAXTM
     I              FJLHOS                          WTLHOS
     I              FJLHOR                          WTLHOR
     I              FJWNTX                          WTWNTX
     I              FJOITX                          WTOITX
     I              FJOJTX                          WTOJTX
     I              FJLLDT                          WTLLDT
     I              FJLSHG                          WTLSHG
     I              FJYPST                          WTYPST
     I              FJK0DT                          WTK0DT
     I              FJAYTM                          WTAYTM
     I              FJKNNX                          WTKNNX
     I              FJICWG                          WTICWG
     I              FJIDWG                          WTIDWG
     I              FJH9SX                          WTH9SX
     I              FJWOTX                          WTWOTX
     I              FJK1DT                          WTK1DT
     I              FJAZTM                          WTAZTM
     I              FJK2DT                          WTK2DT
     I              FJA0TM                          WTA0TM
     I              FJROST                          WTROST
     I              FJRPST                          WTRPST
     I              FJRQST                          WTRQST
     I              FJRRST                          WTRRST
     I              FJZBVA                          WTZBVA
     I              FJWPTX                          WTWPTX
     I              FJWQTX                          WTWQTX
     I              FJWRTX                          WTWRTX
     I              FJWSTX                          WTWSTX
     I              FJRVSX                          WTRVSX
     I              FJRUSX                          WTRUSX
     I              FJRWSX                          WTRWSX
     I              FJRXSX                          WTRXSX
     I              FJRYSX                          WTRYSX
     I              FJRZSX                          WTRZSX
     I              FJR0SX                          WTR0SX
     I              FJR1SX                          WTR1SX
     I              FJR2SX                          WTR2SX
     I              FJR3SX                          WTR3SX
     I              FJR4SX                          WTR4SX
     I              FJPYDT                          WTPYDT
     I              FJCKTM                          WTCKTM
     I              FJPZDT                          WTPZDT
     I              FJCLTM                          WTCLTM
     I              FJP0DT                          WTP0DT
     I              FJCMTM                          WTCMTM
     I              FJP1DT                          WTP1DT
     I              FJCNTM                          WTCNTM
     I              FJP2DT                          WTP2DT
     I              FJCOTM                          WTCOTM
     I              FJP3DT                          WTP3DT
     I              FJCQTM                          WTCQTM
     I              FJUVST                          WTUVST
     I              FJUWST                          WTUWST
     I              FJUXST                          WTUXST
     I              FJAATM                          WTAATM
     I              FJAYNA                          WTAYNA
     I              FJA0NA                          WTA0NA
     I              FJAXDT                          WTAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WVRMNB
     I              FJAIC3                          WVAIC3
     I              FJAODT                          WVAODT
     I              FJPJST                          WVPJST
     I              FJPKST                          WVPKST
     I              FJRNNB                          WVRNNB
     I              FJDMTX                          WVDMTX
     I              FJDNTX                          WVDNTX
     I              FJDOTX                          WVDOTX
     I              FJWTTX                          WVWTTX
     I              FJWUTX                          WVWUTX
     I              FJRPNB                          WVRPNB
     I              FJFLAM                          WVFLAM
     I              FJXQST                          WVXQST
     I              FJRRNB                          WVRRNB
     I              FJDXTX                          WVDXTX
     I              FJDYTX                          WVDYTX
     I              FJSBNB                          WVSBNB
     I              FJBZNA                          WVBZNA
     I              FJRONB                          WVRONB
     I              FJSQNB                          WVSQNB
     I              FJR1NB                          WVR1NB
     I              FJVCST                          WVVCST
     I              FJVDST                          WVVDST
     I              FJSDNB                          WVSDNB
     I              FJPAOU                          WVPAOU
     I              FJDGWG                          WVDGWG
     I              FJSXNB                          WVSXNB
     I              FJHADT                          WVHADT
     I              FJAART                          WVAART
     I              FJDHWG                          WVDHWG
     I              FJDIWG                          WVDIWG
     I              FJAQDT                          WVAQDT
     I              FJS6NB                          WVS6NB
     I              FJT4NB                          WVT4NB
     I              FJPRTM                          WVPRTM
     I              FJNPSV                          WVNPSV
     I              FJJ8TX                          WVJ8TX
     I              FJTLMI                          WVTLMI
     I              FJJ9TX                          WVJ9TX
     I              FJQ2CD                          WVQ2CD
     I              FJVPCD                          WVVPCD
     I              FJDBCD                          WVDBCD
     I              FJGRWE                          WVGRWE
     I              FJXCCD                          WVXCCD
     I              FJU2ST                          WVU2ST
     I              FJF9DT                          WVF9DT
     I              FJONTM                          WVONTM
     I              FJJ4DT                          WVJ4DT
     I              FJTRTM                          WVTRTM
     I              FJJ5DT                          WVJ5DT
     I              FJSPTM                          WVSPTM
     I              FJJ6DT                          WVJ6DT
     I              FJLFTM                          WVLFTM
     I              FJJ7DT                          WVJ7DT
     I              FJBOTM                          WVBOTM
     I              FJJ8DT                          WVJ8DT
     I              FJBLTM                          WVBLTM
     I              FJKIDT                          WVKIDT
     I              FJASTM                          WVASTM
     I              FJKADT                          WVKADT
     I              FJAJCM                          WVAJCM
     I              FJXACD                          WVXACD
     I              FJOANA                          WVOANA
     I              FJK4TX                          WVK4TX
     I              FJVOAG                          WVVOAG
     I              FJKBDT                          WVKBDT
     I              FJNBBO                          WVNBBO
     I              FJW4CD                          WVW4CD
     I              FJEFDT                          WVEFDT
     I              FJCNTN                          WVCNTN
     I              FJKCDT                          WVKCDT
     I              FJTMIN                          WVTMIN
     I              FJKDDT                          WVKDDT
     I              FJVMNB                          WVVMNB
     I              FJOCFR                          WVOCFR
     I              FJKJDT                          WVKJDT
     I              FJATTM                          WVATTM
     I              FJOTRS                          WVOTRS
     I              FJRNST                          WVRNST
     I              FJBRBK                          WVBRBK
     I              FJEIDT                          WVEIDT
     I              FJRMST                          WVRMST
     I              FJAJCD                          WVAJCD
     I              FJKKDT                          WVKKDT
     I              FJAVTM                          WVAVTM
     I              FJKZDT                          WVKZDT
     I              FJAXTM                          WVAXTM
     I              FJLHOS                          WVLHOS
     I              FJLHOR                          WVLHOR
     I              FJWNTX                          WVWNTX
     I              FJOITX                          WVOITX
     I              FJOJTX                          WVOJTX
     I              FJLLDT                          WVLLDT
     I              FJLSHG                          WVLSHG
     I              FJYPST                          WVYPST
     I              FJK0DT                          WVK0DT
     I              FJAYTM                          WVAYTM
     I              FJKNNX                          WVKNNX
     I              FJICWG                          WVICWG
     I              FJIDWG                          WVIDWG
     I              FJH9SX                          WVH9SX
     I              FJWOTX                          WVWOTX
     I              FJK1DT                          WVK1DT
     I              FJAZTM                          WVAZTM
     I              FJK2DT                          WVK2DT
     I              FJA0TM                          WVA0TM
     I              FJROST                          WVROST
     I              FJRPST                          WVRPST
     I              FJRQST                          WVRQST
     I              FJRRST                          WVRRST
     I              FJZBVA                          WVZBVA
     I              FJWPTX                          WVWPTX
     I              FJWQTX                          WVWQTX
     I              FJWRTX                          WVWRTX
     I              FJWSTX                          WVWSTX
     I              FJRVSX                          WVRVSX
     I              FJRUSX                          WVRUSX
     I              FJRWSX                          WVRWSX
     I              FJRXSX                          WVRXSX
     I              FJRYSX                          WVRYSX
     I              FJRZSX                          WVRZSX
     I              FJR0SX                          WVR0SX
     I              FJR1SX                          WVR1SX
     I              FJR2SX                          WVR2SX
     I              FJR3SX                          WVR3SX
     I              FJR4SX                          WVR4SX
     I              FJPYDT                          WVPYDT
     I              FJCKTM                          WVCKTM
     I              FJPZDT                          WVPZDT
     I              FJCLTM                          WVCLTM
     I              FJP0DT                          WVP0DT
     I              FJCMTM                          WVCMTM
     I              FJP1DT                          WVP1DT
     I              FJCNTM                          WVCNTM
     I              FJP2DT                          WVP2DT
     I              FJCOTM                          WVCOTM
     I              FJP3DT                          WVP3DT
     I              FJCQTM                          WVCQTM
     I              FJUVST                          WVUVST
     I              FJUWST                          WVUWST
     I              FJUXST                          WVUXST
     I              FJAATM                          WVAATM
     I              FJAYNA                          WVAYNA
     I              FJA0NA                          WVA0NA
     I              FJAXDT                          WVAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPOBC1    E DSPOBCCPL0
      * UPD : Load Freight Charge       Update index
      * Renamed input format fields
     I              BCRMNB                          WBRMNB
     I              BCCDAA                          WBCDAA
     I              BCEPNY                          WBEPNY
     I              BCC5VL                          WBC5VL
     I              BCKBSX                          WBKBSX
     I              BCCFAA                          WBCFAA
     I              BCKDSX                          WBKDSX
     I              BCKESX                          WBKESX
     I              BCKFSX                          WBKFSX
     I              BCKGSX                          WBKGSX
     I              BCKSSX                          WBKSSX
     I              BCKTSX                          WBKTSX
     I              BCKHSX                          WBKHSX
     I              BCKISX                          WBKISX
     I              BCKJSX                          WBKJSX
     I              BCEQNY                          WBEQNY
     I              BCVSST                          WBVSST
     I              BCMJDT                          WBMJDT
     I              BCBETM                          WBBETM
     I              BCCCVN                          WBCCVN
     I              BCCDVN                          WBCDVN
     I              BCMKDT                          WBMKDT
     I              BCBFTM                          WBBFTM
     I              BCCEVN                          WBCEVN
     I              BCCFVN                          WBCFVN
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPMEY1    E DSPMEYCPL0
      * UPD : Load Freight Charge Cmt   Update index
      * Renamed input format fields
     I              EYRMNB                          WDRMNB
     I              EYCDAA                          WDCDAA
     I              EYEPNY                          WDEPNY
     I              EYNZNY                          WDNZNY
     I              EYS3NA                          WDS3NA
     I              EYVSST                          WDVSST
     I              EYMJDT                          WDMJDT
     I              EYBETM                          WDBETM
     I              EYCCVN                          WDCCVN
     I              EYCDVN                          WDCDVN
     I              EYMKDT                          WDMKDT
     I              EYBFTM                          WDBFTM
     I              EYCEVN                          WDCEVN
     I              EYCFVN                          WDCFVN
      *
     IQPMDK1    E DSPMDKCPL0
      * UPD : Load Freight Charge Ref   Update index
      * Renamed input format fields
     I              DKRMNB                          WFRMNB
     I              DKCDAA                          WFCDAA
     I              DKEPNY                          WFEPNY
     I              DKIYAA                          WFIYAA
     I              DKKFTX                          WFKFTX
     I              DKKBNY                          WFKBNY
     I              DKNET1                          WFNET1
     I              DKAZST                          WFAZST
     I              DKVSST                          WFVSST
     I              DKMJDT                          WFMJDT
     I              DKBETM                          WFBETM
     I              DKCCVN                          WFCCVN
     I              DKCDVN                          WFCDVN
     I              DKMKDT                          WFMKDT
     I              DKBFTM                          WFBFTM
     I              DKCEVN                          WFCEVN
     I              DKCFVN                          WFCFVN
      *
     IYARDCS      DS                            125
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WVRMNB
     I              FJAIC3                          WVAIC3
     I              FJAODT                          WVAODT
     I              FJPJST                          WVPJST
     I              FJPKST                          WVPKST
     I              FJRNNB                          WVRNNB
     I              FJDMTX                          WVDMTX
     I              FJDNTX                          WVDNTX
     I              FJDOTX                          WVDOTX
     I              FJWTTX                          WVWTTX
     I              FJWUTX                          WVWUTX
     I              FJRPNB                          WVRPNB
     I              FJFLAM                          WVFLAM
     I              FJXQST                          WVXQST
     I              FJRRNB                          WVRRNB
     I              FJDXTX                          WVDXTX
     I              FJDYTX                          WVDYTX
     I              FJSBNB                          WVSBNB
     I              FJBZNA                          WVBZNA
     I              FJRONB                          WVRONB
     I              FJSQNB                          WVSQNB
     I              FJR1NB                          WVR1NB
     I              FJVCST                          WVVCST
     I              FJVDST                          WVVDST
     I              FJSDNB                          WVSDNB
     I              FJPAOU                          WVPAOU
     I              FJDGWG                          WVDGWG
     I              FJSXNB                          WVSXNB
     I              FJHADT                          WVHADT
     I              FJAART                          WVAART
     I              FJDHWG                          WVDHWG
     I              FJDIWG                          WVDIWG
     I              FJAQDT                          WVAQDT
     I              FJS6NB                          WVS6NB
     I              FJT4NB                          WVT4NB
     I              FJPRTM                          WVPRTM
     I              FJNPSV                          WVNPSV
     I              FJJ8TX                          WVJ8TX
     I              FJTLMI                          WVTLMI
     I              FJJ9TX                          WVJ9TX
     I              FJQ2CD                          WVQ2CD
     I              FJVPCD                          WVVPCD
     I              FJDBCD                          WVDBCD
     I              FJGRWE                          WVGRWE
     I              FJXCCD                          WVXCCD
     I              FJU2ST                          WVU2ST
     I              FJF9DT                          WVF9DT
     I              FJONTM                          WVONTM
     I              FJJ4DT                          WVJ4DT
     I              FJTRTM                          WVTRTM
     I              FJJ5DT                          WVJ5DT
     I              FJSPTM                          WVSPTM
     I              FJJ6DT                          WVJ6DT
     I              FJLFTM                          WVLFTM
     I              FJJ7DT                          WVJ7DT
     I              FJBOTM                          WVBOTM
     I              FJJ8DT                          WVJ8DT
     I              FJBLTM                          WVBLTM
     I              FJKIDT                          WVKIDT
     I              FJASTM                          WVASTM
     I              FJKADT                          WVKADT
     I              FJAJCM                          WVAJCM
     I              FJXACD                          WVXACD
     I              FJOANA                          WVOANA
     I              FJK4TX                          WVK4TX
     I              FJVOAG                          WVVOAG
     I              FJKBDT                          WVKBDT
     I              FJNBBO                          WVNBBO
     I              FJW4CD                          WVW4CD
     I              FJEFDT                          WVEFDT
     I              FJCNTN                          WVCNTN
     I              FJKCDT                          WVKCDT
     I              FJTMIN                          WVTMIN
     I              FJKDDT                          WVKDDT
     I              FJVMNB                          WVVMNB
     I              FJOCFR                          WVOCFR
     I              FJKJDT                          WVKJDT
     I              FJATTM                          WVATTM
     I              FJOTRS                          WVOTRS
     I              FJRNST                          WVRNST
     I              FJBRBK                          WVBRBK
     I              FJEIDT                          WVEIDT
     I              FJRMST                          WVRMST
     I              FJAJCD                          WVAJCD
     I              FJKKDT                          WVKKDT
     I              FJAVTM                          WVAVTM
     I              FJKZDT                          WVKZDT
     I              FJAXTM                          WVAXTM
     I              FJLHOS                          WVLHOS
     I              FJLHOR                          WVLHOR
     I              FJWNTX                          WVWNTX
     I              FJOITX                          WVOITX
     I              FJOJTX                          WVOJTX
     I              FJLLDT                          WVLLDT
     I              FJLSHG                          WVLSHG
     I              FJYPST                          WVYPST
     I              FJK0DT                          WVK0DT
     I              FJAYTM                          WVAYTM
     I              FJKNNX                          WVKNNX
     I              FJICWG                          WVICWG
     I              FJIDWG                          WVIDWG
     I              FJH9SX                          WVH9SX
     I              FJWOTX                          WVWOTX
     I              FJK1DT                          WVK1DT
     I              FJAZTM                          WVAZTM
     I              FJK2DT                          WVK2DT
     I              FJA0TM                          WVA0TM
     I              FJROST                          WVROST
     I              FJRPST                          WVRPST
     I              FJRQST                          WVRQST
     I              FJRRST                          WVRRST
     I              FJZBVA                          WVZBVA
     I              FJWPTX                          WVWPTX
     I              FJWQTX                          WVWQTX
     I              FJWRTX                          WVWRTX
     I              FJWSTX                          WVWSTX
     I              FJRVSX                          WVRVSX
     I              FJRUSX                          WVRUSX
     I              FJRWSX                          WVRWSX
     I              FJRXSX                          WVRXSX
     I              FJRYSX                          WVRYSX
     I              FJRZSX                          WVRZSX
     I              FJR0SX                          WVR0SX
     I              FJR1SX                          WVR1SX
     I              FJR2SX                          WVR2SX
     I              FJR3SX                          WVR3SX
     I              FJR4SX                          WVR4SX
     I              FJPYDT                          WVPYDT
     I              FJCKTM                          WVCKTM
     I              FJPZDT                          WVPZDT
     I              FJCLTM                          WVCLTM
     I              FJP0DT                          WVP0DT
     I              FJCMTM                          WVCMTM
     I              FJP1DT                          WVP1DT
     I              FJCNTM                          WVCNTM
     I              FJP2DT                          WVP2DT
     I              FJCOTM                          WVCOTM
     I              FJP3DT                          WVP3DT
     I              FJCQTM                          WVCQTM
     I              FJUVST                          WVUVST
     I              FJUWST                          WVUWST
     I              FJUXST                          WVUXST
     I              FJAATM                          WVAATM
     I              FJAYNA                          WVAYNA
     I              FJA0NA                          WVA0NA
     I              FJAXDT                          WVAXDT
      *
     IYBRDCS      DS                            793
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: TMS Load Freight Charge
      * I :  TMS Load ID
     I                                    P   1   40P1TMLD
     IP2PARM      DS
      * I :  Date                  USR
     I                                    P   1   40P2MBDT
     IP3PARM      DS
      * I :  TMS Extract Time
     I                                    P   1   30P3AFTH
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1TMLD    PARM           WP0001  70       TMS Load ID
     C           P2MBDT    PARM           WP0002  70       Date
     C           P3AFTH    PARM           WP0003  40       TMS Extract Tim
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Crt Load FC       XF
      * RTV Ld Frt Chrg Delete RT - Load Freight Charge  * 
     C                     EXSR SARVGN
      * Rtv Del LFC Cmt       RT - Load Freight Charge Cmt  * 
     C                     EXSR SCRVGN
      * Rtv Del LFC Ref       RT - Load Freight Charge Ref  * 
     C                     EXSR SERVGN
     C           P3AFTH    MULT 100       YL0001           LH Carrier Paid
      * Rtv Load to Crt LFC    RT - TMS Load Freight Charge  * 
     C                     EXSR SGRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Ld Frt Chrg Delete RT - Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSA01           Load ID
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Load ID
      * Setup key
     C                     Z-ADDP1TMLD    WQSA01           Load ID
      * Establish starting position
     C           KRSSA     SETLL@BCCPJ8                    *
     C           KRSSA     READE@BCCPJ8                  90*
      * Data record not found
     C   90                MOVEL'USR3058' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Load Freight Chrg DL - Load Freight Charge  * 
     C                     EXSR SBDLRC
     C           KRSSA     READE@BCCPJ8                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * Del Load Freight Chrg DL - Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BCCPJ7
     C                     Z-ADDWARMNB    WBRMNB           Load ID
     C                     MOVELWACDAA    WBCDAA           FC Code
     C                     Z-ADDWAEPNY    WBEPNY           LFC Sequence Nu
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBRMNB           Load ID
     C                     KFLD           WBCDAA           FC Code
     C                     KFLD           WBEPNY           LFC Sequence Nu
     C           KLDLSB    CHAIN@BCCPJ7              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POBCCPL0'MDACP
     C                     MOVEL'@BCCPJ7' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BCCPJ7                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Del LFC Cmt       RT - Load Freight Charge Cmt  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSC01           Load ID
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Load ID
      * Setup key
     C                     Z-ADDP1TMLD    WQSC01           Load ID
      * Establish starting position
     C           KRSSC     SETLL@EYCPYK                    *
     C           KRSSC     READE@EYCPYK                  90*
      * Data record not found
     C   90                MOVEL'USR4086' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del LdFrtChrg Comment DL - Load Freight Charge Cmt  * 
     C                     EXSR SDDLRC
     C           KRSSC     READE@EYCPYK                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * Del LdFrtChrg Comment DL - Load Freight Charge Cmt  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EYCPYJ
     C                     Z-ADDWCRMNB    WDRMNB           Load ID
     C                     MOVELWCCDAA    WDCDAA           FC Code
     C                     Z-ADDWCEPNY    WDEPNY           LFC Sequence Nu
     C                     Z-ADDWCNZNY    WDNZNY           LFCC Sequence N
      *
     C           KLDLSD    KLIST
     C                     KFLD           WDRMNB           Load ID
     C                     KFLD           WDCDAA           FC Code
     C                     KFLD           WDEPNY           LFC Sequence Nu
     C                     KFLD           WDNZNY           LFCC Sequence N
     C           KLDLSD    CHAIN@EYCPYJ              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMEYCPL0'MDACP
     C                     MOVEL'@EYCPYJ' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EYCPYJ                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Del LFC Ref       RT - Load Freight Charge Ref  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSE01           Load ID
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Load ID
      * Setup key
     C                     Z-ADDP1TMLD    WQSE01           Load ID
      * Establish starting position
     C           KRSSE     SETLL@DKCPRF                    *
     C           KRSSE     READE@DKCPRF                  90*
      * Data record not found
     C   90                MOVEL'USR3893' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del LD Frt Chrg Ref   DL - Load Freight Charge Ref  * 
     C                     EXSR SFDLRC
     C           KRSSE     READE@DKCPRF                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * Del LD Frt Chrg Ref   DL - Load Freight Charge Ref  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @DKCPRE
     C                     Z-ADDWERMNB    WFRMNB           Load ID
     C                     MOVELWECDAA    WFCDAA           FC Code
     C                     Z-ADDWEEPNY    WFEPNY           LFC Sequence Nu
     C                     MOVELWEIYAA    WFIYAA           CR Reference Co
      *
     C           KLDLSF    KLIST
     C                     KFLD           WFRMNB           Load ID
     C                     KFLD           WFCDAA           FC Code
     C                     KFLD           WFEPNY           LFC Sequence Nu
     C                     KFLD           WFIYAA           CR Reference Co
     C           KLDLSF    CHAIN@DKCPRE              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMDKCPL0'MDACP
     C                     MOVEL'@DKCPRE' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@DKCPRE                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Load to Crt LFC    RT - TMS Load Freight Charge  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Record Created
     C                     MOVEL*BLANK    WN0002  3        Text 3 Length U
     C                     MOVEL*BLANK    WN0003  3        USR Uom
     C                     MOVEL*BLANK    WN0004  1        TMS Use FC Tabl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'tot'     WN0002           Text 3 Length U
     C                     MOVEL'Tot'     WN0003           USR Uom
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGTMLD    WQSG01           TMS Load ID
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           TMS Load ID
      * Setup key
     C                     Z-ADDP1TMLD    WQSG01           TMS Load ID
      * Establish starting position
     C           KRSSG     SETLL@CYCPYC                    *
     C           KRSSG     READE@CYCPYC                  90*
      * Data record not found
     C   90                MOVEL'USR4945' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * R12849 DN 03/27/18-Commented Out.
      * R12849 DN 03/27/18-Removed Check of EDI Code 'tot' & 'Tot'.
      * CASE: *OTHERWISE
     C                     MOVELWGU6AA    YL0002           TMS Charge Desc
      * If charge desc is 'Stop n:', then get the stop number from it.
      * CASE: LCL.TMS Charge Desc Parse Txt is *ALL values
     C           YL0002    IFEQ @CN,001                    *IF
     C           YL0002    OREQ @CN,002
     C           YL0002    OREQ @CN,003
     C           YL0002    OREQ @CN,004
     C           YL0002    OREQ @CN,005
     C           YL0002    OREQ @CN,006
     C           YL0002    OREQ @CN,007
     C           YL0002    OREQ @CN,008
     C           YL0002    OREQ @CN,009
     C                     Z-ADD1         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0002:ZQ YL0003    P  90  Text 1 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     YL0004           Stop Number
     C                     MOVE YL0003    YL0004           Stop Number
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         YL0004           Stop Number
     C                     END                             *FI
      * RTV FC Code from TMS  RT - Freight Charge XREF TMS  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWGU7AA    WL0002    P      TMS EDI Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0001    YL0005    P      FC Code
     C                     MOVELWL0003    WN0004    P      TMS Use FC Tabl
      * Rtv Frt Charge Info   RT - Freight Charge  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0005    WL0004    P      FC Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0006    P      FC Description
     C                     Z-ADDWL0006    YL0007           FC Rate Amount
     C                     MOVELWL0007    YL0008    P      FC Unit of Meas
     C                     MOVELWL0008    YL0009    P      FC Act Frt Incl
     C                     MOVELWL0009    YL0010    P      FC Frt Add/Dedu
     C                     MOVELWL0010    YL0011    P      FC Load Type Se
     C                     MOVELWL0011    YL0012    P      FC State Select
     C                     MOVELWL0012    YL0013    P      FC Export Selec
     C                     MOVELWL0013    YL0014    P      FC Shag/Wash Se
     C                     MOVELWL0014    YL0015    P      FC Auto Calc St
     C                     MOVELWL0015    YL0016    P      FC Charge Categ
     C                     MOVELWL0016    YL0017    P      FC Shag/Wash Co
     C                     MOVELWL0017    YL0018    P      FC Edit Sequenc
     C                     MOVELWL0018    YL0019    P      FC Tot Freight
     C                     MOVELWL0019    YL0020    P      FC Special Type
     C                     MOVELWL0020    YL0021    P      FC ExpInt FR/FZ
     C                     MOVELWL0021    YL0022    P      FC Reference Re
     C                     MOVELWL0022    YL0023    P      FC Trans Mode S
     C                     MOVELWL0023    YL0024    P      FC Freight Rate
     C                     MOVELWL0024    YL0025    P      FC Company Sele
     C                     MOVELWL0025    YL0026    P      FC Company/Carr
     C                     MOVELWL0026    YL0027    P      FC Shared Respo
     C                     MOVELWL0027    YL0028    P      FC Unused Sts 1
     C                     Z-ADDWL0028    YL0029           FC Auto Calc Ef
     C                     MOVELWL0029    YL0030    P      Record Status
      * CASE: PAR.TMS Use FC Table Settings is Yes
     C           WN0004    IFEQ 'Y'                        *IF
      * use freight charge table values for these
      * Crt Load Freight Chrg IF
      * Rtv Next Seq          RT - Load Freight Charge  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGTMLD    WL0030           Load ID
     C                     MOVELYL0005    WL0031    P      FC Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0032    YL0031           LFC Sequence Nu
      * Crt Load Freight Chrg CR - Load Freight Charge  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGTMLD    WL0033           Load ID
     C                     MOVELYL0005    WL0034    P      FC Code
     C                     Z-ADDYL0031    WL0035           LFC Sequence Nu
     C                     Z-ADDWGM0VL    WL0036           LFC Amount
     C                     MOVELYL0009    WL0037    P      LFC Act Frt Inc
     C                     MOVELWGCFAA    WL0038    P      LFC Carrier Cod
     C                     MOVELYL0032    WL0039    P      LFC Create Stat
     C                     MOVELYL0033    WL0040    P      LFC Unused Sts
     C                     MOVELYL0016    WL0041    P      LFC Charge Cate
     C                     MOVELYL0017    WL0042    P      LFC Shag/Wash C
     C                     MOVELYL0019    WL0043    P      LFC Tot Freight
     C                     MOVELYL0020    WL0044    P      LFC Special Typ
     C                     MOVELYL0034    WL0045    P      LFC TFP Process
     C                     MOVELYL0022    WL0046    P      LFC Reference R
     C                     MOVELYL0035    WL0047    P      LFC Unused Sts
     C                     Z-ADDYL0036    WL0048           LFC TFP Carrier
     C                     MOVEL'A'       WL0049    P      Record Status
     C                     Z-ADD0         WL0050           Create Date
     C                     Z-ADD0         WL0051           Create Time
     C                     MOVEL*BLANK    WL0052           Create User
     C                     MOVEL##PGM     WL0053    P      Create Program
     C                     Z-ADD0         WL0054           Change Date
     C                     Z-ADD0         WL0055           Change Time
     C                     MOVEL*BLANK    WL0056           Change User
     C                     MOVEL*BLANK    WL0057           Change Program
     C                     EXSR SKCRRC
      * Crt refs for shipto and others
      * Crt Ld Frt Chrg R TMS RT - Freight Charge Reference  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0005    WL0088    P      FC Code
     C                     Z-ADDWGTMLD    WL0089           Load ID
     C                     Z-ADDYL0031    WL0090           LFC Sequence Nu
     C                     Z-ADDYL0004    WL0091           Stop Number
     C                     EXSR SQRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0045           CR Reference Co
     C                     MOVELWUXKTX    YL0046           LFCR Reference
     C                     Z-ADD0         YL0047           LFCR Numeric Va
      * If Stop number is blank( not on the description)
      * CASE: LCL.Stop Number is EQ 0
     C           YL0004    IFEQ 0                          *IF
     C                     MOVEL'N'       YL0022           FC Reference Re
     C                     MOVEL'Y'       YL0009           FC Act Frt Incl
     C                     MOVEL'Y'       YL0019           FC Tot Freight
     C                     END                             *FI
      * If Stop number is 1 ( on the description)
      * CASE: LCL.Stop Number is One
     C           YL0004    IFEQ 1                          *IF
      * RTV 1st Company       RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGTMLD    WL0092           Load ID
     C                     Z-ADD0         WL0093           Stop/Drop
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0094    YL0048           Company Number
     C                     MOVEL'Y'       YL0022           FC Reference Re
     C                     MOVEL'N'       YL0009           FC Act Frt Incl
     C                     MOVEL'Y'       YL0019           FC Tot Freight
     C                     MOVEL'COMPNY'  YL0045           CR Reference Co
     C                     MOVEL'R'       YL0046           LFCR Reference
     C                     Z-ADDYL0048    YL0047           LFCR Numeric Va
     C                     END                             *FI
      * If Stop number is >1 ( on the description)
      * CASE: LCL.Stop Number is GT 1
     C           YL0004    IFGT 1                          *IF
     C                     MOVEL'Y'       YL0022           FC Reference Re
     C                     MOVEL'Y'       YL0019           FC Tot Freight
      * Val for Stop Frt Chrge RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGTMLD    WL0095           Load ID
     C                     Z-ADDYL0004    WL0096           Stop/Drop
     C                     MOVELYL0049    WL0098    P      Record Found US
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0097    YL0048           Company Number
     C                     MOVELWL0098    YL0049    P      Record Found US
      * Stop is for a DROP If LD exists
      * CASE: LCL.Record Found USR is Record Found
     C           YL0049    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0009           FC Act Frt Incl
     C                     MOVEL*BLANK    YL0045           CR Reference Co
     C                     MOVEL'DROP'    YL0045           CR Reference Co
     C                     Z-ADDYL0004    YL0047           LFCR Numeric Va
     C                     MOVEL'A'       YL0046           LFCR Reference
     C                     ELSE
      * CASE: *OTHERWISE
      * Stop is for a PICKUP since LD does not exist
     C                     MOVEL'N'       YL0009           FC Act Frt Incl
     C                     MOVEL'COMPNY'  YL0045           CR Reference Co
     C                     MOVEL'R'       YL0046           LFCR Reference
     C                     Z-ADDYL0048    YL0047           LFCR Numeric Va
     C                     END                             *FI
     C                     END                             *FI
      * Override Freight Charge table with these values:
     C                     MOVEL'A'       YL0032           LFC Create Stat
     C                     MOVEL'G'       YL0016           FC Charge Categ
     C                     MOVEL'N'       YL0017           FC Shag/Wash Co
     C                     MOVEL'N'       YL0020           FC Special Type
     C                     MOVEL*BLANK    YL0034           LFC TFP Process
     C                     Z-ADD0         YL0036           LFC TFP Carrier
      * Crt Load FreightCh TMS IF
      * Rtv Next Seq          RT - Load Freight Charge  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGTMLD    WL0030           Load ID
     C                     MOVELYL0005    WL0031    P      FC Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0032    YL0031           LFC Sequence Nu
      * Crt Load Freight TMS  CR - Load Freight Charge  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGTMLD    WL0099           Load ID
     C                     MOVELYL0005    WL0100    P      FC Code
     C                     Z-ADDYL0031    WL0101           LFC Sequence Nu
     C                     Z-ADDWGM0VL    WL0102           LFC Amount
     C                     MOVELYL0009    WL0103    P      LFC Act Frt Inc
     C                     MOVELWGCFAA    WL0104    P      LFC Carrier Cod
     C                     MOVELYL0032    WL0105    P      LFC Create Stat
     C                     MOVELYL0033    WL0106    P      LFC Unused Sts
     C                     MOVELYL0016    WL0107    P      LFC Charge Cate
     C                     MOVELYL0017    WL0108    P      LFC Shag/Wash C
     C                     MOVELYL0019    WL0109    P      LFC Tot Freight
     C                     MOVELYL0020    WL0110    P      LFC Special Typ
     C                     MOVELYL0034    WL0111    P      LFC TFP Process
     C                     MOVELYL0022    WL0112    P      LFC Reference R
     C                     MOVELYL0035    WL0113    P      LFC Unused Sts
     C                     Z-ADDYL0036    WL0114           LFC TFP Carrier
     C                     MOVEL'A'       WL0115    P      Record Status
     C                     Z-ADD0         WL0116           Create Date
     C                     Z-ADD0         WL0117           Create Time
     C                     MOVEL*BLANK    WL0118           Create User
     C                     MOVEL##PGM     WL0119    P      Create Program
     C                     Z-ADD0         WL0120           Change Date
     C                     Z-ADD0         WL0121           Change Time
     C                     MOVEL*BLANK    WL0122           Change User
     C                     MOVEL*BLANK    WL0123           Change Program
     C                     EXSR SXCRRC
      * CASE: LCL.CR Reference Code is Blanks
     C           YL0045    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Ld Frt Chrg Ref   RT - Load Freight Charge Ref  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGTMLD    WL0064           Load ID
     C                     MOVELYL0005    WL0065    P      FC Code
     C                     Z-ADD1         WL0066           LFC Sequence Nu
     C                     MOVELYL0045    WL0067    P      CR Reference Co
     C                     MOVEL'N'       WL0068    P      LFCR Value Type
     C                     Z-ADDYL0047    WL0069           LFCR Numeric Va
     C                     MOVELYL0046    WL0070    P      LFCR Reference
     C                     EXSR SORVGN
     C                     END                             *FI
     C                     END                             *FI
      * Crt LdFrtChrg Comment IF
      * Rtv Next Sequence     RT - Load Freight Charge Cmt  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGTMLD    WL0124           Load ID
     C                     MOVELYL0005    WL0125    P      FC Code
     C                     Z-ADDYL0031    WL0126           LFC Sequence Nu
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0127    YL0050           LFCC Sequence N
      * Crt LdFrtChrg Comment CR - Load Freight Charge Cmt  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGTMLD    WL0128           Load ID
     C                     MOVELYL0005    WL0129    P      FC Code
     C                     Z-ADDYL0031    WL0130           LFC Sequence Nu
     C                     Z-ADDYL0050    WL0131           LFCC Sequence N
     C                     MOVELWGU6AA    WL0132    P      LFCC Comment
     C                     MOVEL'A'       WL0133    P      Record Status
     C                     Z-ADD0         WL0134           Create Date
     C                     Z-ADD0         WL0135           Create Time
     C                     MOVEL*BLANK    WL0136           Create User
     C                     MOVEL*BLANK    WL0137           Create Program
     C                     Z-ADD0         WL0138           Change Date
     C                     Z-ADD0         WL0139           Change Time
     C                     MOVEL*BLANK    WL0140           Change User
     C                     MOVEL*BLANK    WL0141           Change Program
     C                     EXSR SZCRRC
     C                     MOVEL'Y'       WN0001           Record Created
     C           KRSSG     READE@CYCPYC                  90*
     C                     ENDDO
      * USER: Exit processing
      * RTV Rated Freight     RT - Load Header  * 
     C                     EXSR TARVGN
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Record Created        USR is Yes
      *   |- c2    : LCL.Rated Freight is Not Zero
      *   '-
     C           WN0001    IFEQ 'Y'                        *IF
     C           YL0051    ORNE 0                          *OR
      * Rtv Carrier Payment   RT - Load Freight Charge  * 
     C                     EXSR TBRVGN
      * Upd Ld ActFrt/TotFrt  RT - Load Header  * 
     C                     EXSR TCRVGN
      * rmc  added 1/121/7
      * CASE: LCL.Load Status is Invoiced
     C           YL0054    IFEQ 'I'                        *IF
      * UPD Alloc Frt to Hist  XF - Load Header  * 
     C                     CALL 'PLABXFR'              90  UPD Alloc Frt t
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1TMLD    WQ0001  70       Load ID
     C                     PARM YL0052    WQ0002 112       Flat Amount
     C                     PARM YL0053    WQ0003 112       Load Total Frei
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLABXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV FC Code from TMS  RT - Freight Charge XREF TMS  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHU7AA    WQSH01           TMS EDI Code
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           TMS EDI Code
      * Setup key
     C                     MOVELWL0002    WQSH01           TMS EDI Code
      * Establish starting position
     C           KRSSH     SETLL@C1REYY                    *
     C           KRSSH     READE@C1REYY                  90*
      * Data record not found
     C   90                MOVEL'USR4961' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHCDAA    WL0001           FC Code
     C                     MOVELWHD6SC    WL0003           TMS Use FC Tabl
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@C1REYY                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Frt Charge Info   RT - Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WICDAA           FC Code
      * Setup key
     C                     MOVELWL0004    WICDAA           FC Code
      * Establish starting position
     C           KRSSI     CHAIN@A9REJZ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3052' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           FC Description
     C                     Z-ADD*ZERO     WL0006           FC Rate Amount
     C                     MOVEL*BLANK    WL0007           FC Unit of Meas
     C                     MOVEL*BLANK    WL0008           FC Act Frt Incl
     C                     MOVEL*BLANK    WL0009           FC Frt Add/Dedu
     C                     MOVEL*BLANK    WL0010           FC Load Type Se
     C                     MOVEL*BLANK    WL0011           FC State Select
     C                     MOVEL*BLANK    WL0012           FC Export Selec
     C                     MOVEL*BLANK    WL0013           FC Shag/Wash Se
     C                     MOVEL*BLANK    WL0014           FC Auto Calc St
     C                     MOVEL*BLANK    WL0015           FC Charge Categ
     C                     MOVEL*BLANK    WL0016           FC Shag/Wash Co
     C                     MOVEL*BLANK    WL0017           FC Edit Sequenc
     C                     MOVEL*BLANK    WL0018           FC Tot Freight
     C                     MOVEL*BLANK    WL0019           FC Special Type
     C                     MOVEL*BLANK    WL0020           FC ExpInt FR/FZ
     C                     MOVEL*BLANK    WL0021           FC Reference Re
     C                     MOVEL*BLANK    WL0022           FC Trans Mode S
     C                     MOVEL*BLANK    WL0023           FC Freight Rate
     C                     MOVEL*BLANK    WL0024           FC Company Sele
     C                     MOVEL*BLANK    WL0025           FC Company/Carr
     C                     MOVEL*BLANK    WL0026           FC Shared Respo
     C                     MOVEL*BLANK    WL0027           FC Unused Sts 1
     C                     Z-ADD*ZERO     WL0028           FC Auto Calc Ef
     C                     MOVEL*BLANK    WL0029           Record Status
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIPNNA    WL0005           FC Description
     C                     Z-ADDWIC3VL    WL0006           FC Rate Amount
     C                     MOVELWIJUSX    WL0007           FC Unit of Meas
     C                     MOVELWIJZSX    WL0008           FC Act Frt Incl
     C                     MOVELWIJ5SX    WL0009           FC Frt Add/Dedu
     C                     MOVELWIJVSX    WL0010           FC Load Type Se
     C                     MOVELWIJWSX    WL0011           FC State Select
     C                     MOVELWIJXSX    WL0012           FC Export Selec
     C                     MOVELWIJYSX    WL0013           FC Shag/Wash Se
     C                     MOVELWIKKSX    WL0014           FC Auto Calc St
     C                     MOVELWIJ0SX    WL0015           FC Charge Categ
     C                     MOVELWIJ1SX    WL0016           FC Shag/Wash Co
     C                     MOVELWIKRSX    WL0017           FC Edit Sequenc
     C                     MOVELWIKPSX    WL0018           FC Tot Freight
     C                     MOVELWIKQSX    WL0019           FC Special Type
     C                     MOVELWIJ2SX    WL0020           FC ExpInt FR/FZ
     C                     MOVELWIJ3SX    WL0021           FC Reference Re
     C                     MOVELWIJ4SX    WL0022           FC Trans Mode S
     C                     MOVELWIJ6SX    WL0023           FC Freight Rate
     C                     MOVELWIJ7SX    WL0024           FC Company Sele
     C                     MOVELWIJ8SX    WL0025           FC Company/Carr
     C                     MOVELWIJ9SX    WL0026           FC Shared Respo
     C                     MOVELWIKASX    WL0027           FC Unused Sts 1
     C                     Z-ADDWIOPDT    WL0028           FC Auto Calc Ef
     C                     MOVELWIVSST    WL0029           Record Status
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Next Seq          RT - Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJRMNB    WQSJ01           Load ID
     C           *LIKE     DEFN WJCDAA    WQSJ02           FC Code
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Load ID
     C                     KFLD           WQSJ02           FC Code
      * Setup key
     C                     Z-ADDWL0030    WQSJ01           Load ID
     C                     MOVELWL0031    WQSJ02           FC Code
      * Establish starting position
     C           KRSSJ     SETLL@BCCPRK                    *
     C           KRSSJ     READE@BCCPRK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3058' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0032           LFC Sequence Nu
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WJEPNY    ADD  1         WL0032           LFC Sequence Nu
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@BCCPRK                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt Load Freight Chrg CR - Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BCCPJ7
     C                     Z-ADDWL0033    WBRMNB           Load ID
     C                     MOVELWL0034    WBCDAA           FC Code
     C                     Z-ADDWL0035    WBEPNY           LFC Sequence Nu
     C                     Z-ADDWL0036    WBC5VL           LFC Amount
     C                     MOVELWL0037    WBKBSX           LFC Act Frt Inc
     C                     MOVELWL0038    WBCFAA           LFC Carrier Cod
     C                     MOVELWL0039    WBKDSX           LFC Create Stat
     C                     MOVELWL0040    WBKESX           LFC Unused Sts
     C                     MOVELWL0041    WBKFSX           LFC Charge Cate
     C                     MOVELWL0042    WBKGSX           LFC Shag/Wash C
     C                     MOVELWL0043    WBKSSX           LFC Tot Freight
     C                     MOVELWL0044    WBKTSX           LFC Special Typ
     C                     MOVELWL0045    WBKHSX           LFC TFP Process
     C                     MOVELWL0046    WBKISX           LFC Reference R
     C                     MOVELWL0047    WBKJSX           LFC Unused Sts
     C                     Z-ADDWL0048    WBEQNY           LFC TFP Carrier
     C                     MOVELWL0049    WBVSST           Record Status
     C                     Z-ADDWL0050    WBMJDT           Create Date
     C                     Z-ADDWL0051    WBBETM           Create Time
     C                     MOVELWL0052    WBCCVN           Create User
     C                     MOVELWL0053    WBCDVN           Create Program
     C                     Z-ADDWL0054    WBMKDT           Change Date
     C                     Z-ADDWL0055    WBBFTM           Change Time
     C                     MOVELWL0056    WBCEVN           Change User
     C                     MOVELWL0057    WBCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WBVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WBMJDT           Create Date
     C                     Z-ADD##JTM     WBBETM           Create Time
     C                     MOVEL##USR     WBCCVN           Create User
     C                     MOVEL##PGM     WBCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD0         WBMKDT           Change Date
     C                     Z-ADD0         WBBFTM           Change Time
     C                     MOVEL*BLANK    WBCEVN           Change User
     C                     MOVEL*BLANK    WBCFVN           Change Program
     C           KLCRSK    KLIST
     C                     KFLD           WBRMNB           Load ID
     C                     KFLD           WBCDAA           FC Code
     C                     KFLD           WBEPNY           LFC Sequence Nu
      * Check for duplicate primary key
     C           KLCRSK    SETLL@BCCPJ7                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3059' W0RTN   7
      * Send message 'Load Freight Charge    EX'
     C                     MOVEL'USR3059' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@BCCPJ7                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: PAR.LFC Reference Required is Yes
     C           WL0046    IFEQ 'Y'                        *IF
      * Crt Ld Frt Chrg Ref   RT - Freight Charge Reference  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Crt Ld Frt Chrg Ref   RT - Freight Charge Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKCDAA    WQSL01           FC Code
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           FC Code
      * Setup key
     C                     MOVELWBCDAA    WQSL01           FC Code
      * Establish starting position
     C           KRSSL     SETLL@DJREYA                    *
     C           KRSSL     READE@DJREYA                  90*
      * Data record not found
     C   90                MOVEL'USR3891' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WKVSST    IFEQ 'A'                        *IF
      * Rtv Charge Info       RT - Charge Reference  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWKIYAA    WL0058    P      CR Reference Co
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0059    YN0001    P      CR Reference De
     C                     MOVELWL0060    YL0037    P      CR Value Type
     C                     Z-ADD0         YL0038           LFCR Numeric Va
      * CASE: DB1.CR Reference Code is Company
     C           WKIYAA    IFEQ @CN,010                    *IF
      * Rtv Frt Charge Info   RT - Freight Charge  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWKCDAA    WL0004    P      FC Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YN0002    P      FC Description
     C                     Z-ADDWL0006    YN0003           FC Rate Amount
     C                     MOVELWL0007    YN0004    P      FC Unit of Meas
     C                     MOVELWL0008    YN0005    P      FC Act Frt Incl
     C                     MOVELWL0009    YN0006    P      FC Frt Add/Dedu
     C                     MOVELWL0010    YN0007    P      FC Load Type Se
     C                     MOVELWL0011    YN0008    P      FC State Select
     C                     MOVELWL0012    YN0009    P      FC Export Selec
     C                     MOVELWL0013    YN0010    P      FC Shag/Wash Se
     C                     MOVELWL0014    YN0011    P      FC Auto Calc St
     C                     MOVELWL0015    YN0012    P      FC Charge Categ
     C                     MOVELWL0016    YN0013    P      FC Shag/Wash Co
     C                     MOVELWL0017    YN0014    P      FC Edit Sequenc
     C                     MOVELWL0018    YN0015    P      FC Tot Freight
     C                     MOVELWL0019    YN0016    P      FC Special Type
     C                     MOVELWL0020    YN0017    P      FC ExpInt FR/FZ
     C                     MOVELWL0021    YN0018    P      FC Reference Re
     C                     MOVELWL0022    YN0019    P      FC Trans Mode S
     C                     MOVELWL0023    YN0020    P      FC Freight Rate
     C                     MOVELWL0024    YN0021    P      FC Company Sele
     C                     MOVELWL0025    YN0022    P      FC Company/Carr
     C                     MOVELWL0026    YL0039    P      FC Shared Respo
     C                     MOVELWL0027    YN0023    P      FC Unused Sts 1
     C                     Z-ADDWL0028    YN0024           FC Auto Calc Ef
     C                     MOVELWL0029    YN0025    P      Record Status
      * CASE: LCL.FC Unused Sts 9 is Shared
     C           YL0039    IFEQ 'S'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Ld ShpCo/MultiCo  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBRMNB    WL0061           Load ID
     C                     Z-ADDYL0040    WL0062           Company Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0062    YL0040           Company Number
     C                     MOVELWL0063    YL0041    P      Multi Company L
      * CASE: LCL.Multi Company Load is no
     C           YL0041    IFEQ 'N'                        *IF
     C                     Z-ADDYL0040    YL0038           LFCR Numeric Va
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Crt Ld Frt Chrg Ref   RT - Load Freight Charge Ref  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBRMNB    WL0064           Load ID
     C                     MOVELWBCDAA    WL0065    P      FC Code
     C                     Z-ADDWBEPNY    WL0066           LFC Sequence Nu
     C                     MOVELWKIYAA    WL0067    P      CR Reference Co
     C                     MOVELYL0037    WL0068    P      LFCR Value Type
     C                     Z-ADDYL0038    WL0069           LFCR Numeric Va
     C                     MOVELWKAYST    WL0070    P      LFCR Reference
     C                     EXSR SORVGN
     C                     END                             *FI
     C           KRSSL     READE@DJREYA                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Charge Info       RT - Charge Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WLIYAA           CR Reference Co
      * Setup key
     C                     MOVELWL0058    WLIYAA           CR Reference Co
      * Establish starting position
     C           KRSSM     CHAIN@DIREQ5              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3889' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0059           CR Reference De
     C                     MOVEL*BLANK    WL0060           CR Value Type
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLR8NA    WL0059           CR Reference De
     C                     MOVELWLKCTX    WL0060           CR Value Type
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Ld ShpCo/MultiCo  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0063           Multi Company L
     C                     Z-ADD0         WL0062           Company Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMRMNB    WQSN01           Load ID
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Load ID
      * Setup key
     C                     Z-ADDWL0061    WQSN01           Load ID
      * Establish starting position
     C           KRSSN     SETLL@FLCPBW                    *
     C           KRSSN     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Company Number is Equal to zero
     C           WL0062    IFEQ 0                          *IF
     C                     Z-ADDWMAIC3    WL0062           Company Number
     C                     END                             *FI
      * CASE: PAR.Company Number NE DB1.Company Number
     C           WL0062    IFNE WMAIC3                     *IF
     C                     MOVEL'Y'       WL0063           Multi Company L
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSN     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Crt Ld Frt Chrg Ref   RT - Load Freight Charge Ref  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0005 40        LFCR Alpha Valu
     C                     MOVEL*BLANK    WN0006  1        Record Status
     C                     Z-ADD*ZERO     WN0007  70       Create Date
     C                     Z-ADD*ZERO     WN0008  60       Create Time
     C                     MOVEL*BLANK    WN0009 10        Create User
     C                     MOVEL*BLANK    WN0010 10        Create Program
     C                     Z-ADD*ZERO     WN0011  70       Change Date
     C                     Z-ADD*ZERO     WN0012  60       Change Time
     C                     MOVEL*BLANK    WN0013 10        Change User
     C                     MOVEL*BLANK    WN0014 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WERMNB           Load ID
     C                     KFLD           WECDAA           FC Code
     C                     KFLD           WEEPNY           LFC Sequence Nu
     C                     KFLD           WEIYAA           CR Reference Co
      * Setup key
     C                     Z-ADDWL0064    WERMNB           Load ID
     C                     MOVELWL0065    WECDAA           FC Code
     C                     Z-ADDWL0066    WEEPNY           LFC Sequence Nu
     C                     MOVELWL0067    WEIYAA           CR Reference Co
      * Establish starting position
     C           KRSSO     CHAIN@DKCPRF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3893' W0RTN   7
      * USER: Processing if Data record not found
      * Crt LD Frt Chrg Ref   CR - Load Freight Charge Ref  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0064    WL0071           Load ID
     C                     MOVELWL0065    WL0072    P      FC Code
     C                     Z-ADDWL0066    WL0073           LFC Sequence Nu
     C                     MOVELWL0067    WL0074    P      CR Reference Co
     C                     MOVELWL0068    WL0075    P      LFCR Value Type
     C                     Z-ADDWL0069    WL0076           LFCR Numeric Va
     C                     MOVELWN0005    WL0077    P      LFCR Alpha Valu
     C                     MOVELWL0070    WL0078    P      LFCR Reference
     C                     MOVELWN0006    WL0079    P      Record Status
     C                     Z-ADDWN0007    WL0080           Create Date
     C                     Z-ADDWN0008    WL0081           Create Time
     C                     MOVELWN0009    WL0082    P      Create User
     C                     MOVELWN0010    WL0083    P      Create Program
     C                     Z-ADDWN0011    WL0084           Change Date
     C                     Z-ADDWN0012    WL0085           Change Time
     C                     MOVELWN0013    WL0086    P      Change User
     C                     MOVELWN0014    WL0087    P      Change Program
     C                     EXSR SPCRRC
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * Crt LD Frt Chrg Ref   CR - Load Freight Charge Ref  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DKCPRE
     C                     Z-ADDWL0071    WFRMNB           Load ID
     C                     MOVELWL0072    WFCDAA           FC Code
     C                     Z-ADDWL0073    WFEPNY           LFC Sequence Nu
     C                     MOVELWL0074    WFIYAA           CR Reference Co
     C                     MOVELWL0075    WFKFTX           LFCR Value Type
     C                     Z-ADDWL0076    WFKBNY           LFCR Numeric Va
     C                     MOVELWL0077    WFNET1           LFCR Alpha Valu
     C                     MOVELWL0078    WFAZST           LFCR Reference
     C                     MOVELWL0079    WFVSST           Record Status
     C                     Z-ADDWL0080    WFMJDT           Create Date
     C                     Z-ADDWL0081    WFBETM           Create Time
     C                     MOVELWL0082    WFCCVN           Create User
     C                     MOVELWL0083    WFCDVN           Create Program
     C                     Z-ADDWL0084    WFMKDT           Change Date
     C                     Z-ADDWL0085    WFBFTM           Change Time
     C                     MOVELWL0086    WFCEVN           Change User
     C                     MOVELWL0087    WFCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WFVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WFMJDT           Create Date
     C                     Z-ADD##JTM     WFBETM           Create Time
     C                     MOVEL##USR     WFCCVN           Create User
     C                     MOVEL##PGM     WFCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD0         WFMKDT           Change Date
     C                     Z-ADD0         WFBFTM           Change Time
     C                     MOVEL*BLANK    WFCEVN           Change User
     C                     MOVEL*BLANK    WFCFVN           Change Program
     C           KLCRSP    KLIST
     C                     KFLD           WFRMNB           Load ID
     C                     KFLD           WFCDAA           FC Code
     C                     KFLD           WFEPNY           LFC Sequence Nu
     C                     KFLD           WFIYAA           CR Reference Co
      * Check for duplicate primary key
     C           KLCRSP    SETLL@DKCPRE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3894' W0RTN   7
      * Send message 'Load Freight Charge Re EX'
     C                     MOVEL'USR3894' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@DKCPRE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Crt Ld Frt Chrg R TMS RT - Freight Charge Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKCDAA    WQSQ01           FC Code
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           FC Code
      * Setup key
     C                     MOVELWL0088    WQSQ01           FC Code
      * Establish starting position
     C           KRSSQ     SETLL@DJREYA                    *
     C           KRSSQ     READE@DJREYA                  90*
      * Data record not found
     C   90                MOVEL'USR3891' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WKVSST    IFEQ 'A'                        *IF
      * Rtv Charge Info       RT - Charge Reference  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWKIYAA    WL0058    P      CR Reference Co
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0059    YN0026    P      CR Reference De
     C                     MOVELWL0060    YL0042    P      CR Value Type
     C                     Z-ADD0         YL0043           LFCR Numeric Va
      * CR Reference is Drop
      * CASE: DB1.CR Reference Code is Drop Number
     C           WKIYAA    IFEQ 'DROP'                     *IF
     C                     Z-ADDWL0091    YL0043           LFCR Numeric Va
     C                     END                             *FI
      * CR Reference is ShipTo
      * CASE: DB1.CR Reference Code is Ship To
     C           WKIYAA    IFEQ @CN,011                    *IF
      * RTV Stop Customer      RT - Load Detail  * 
     C                     EXSR SRRVGN
     C                     Z-ADDYL0044    YL0043           LFCR Numeric Va
     C                     END                             *FI
      * Crt Ld Frt Chrg/Upd   RT - Load Freight Charge Ref  * 
     C                     EXSR STRVGN
     C                     END                             *FI
     C           KRSSQ     READE@DJREYA                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Stop Customer      RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WORMNB    WQSR02           Load ID
     C           *LIKE     DEFN WORVNB    WQSR03           Stop/Drop
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR02           Load ID
     C                     KFLD           WQSR03           Stop/Drop
      * Setup key
     C                     Z-ADDWL0089    WQSR02           Load ID
     C                     Z-ADDWL0091    WQSR03           Stop/Drop
      * Establish starting position
     C           KRSSR     SETLL@FLCPEB                    *
     C           KRSSR     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD0         YL0044           Customer Number
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Customer Number    RT - Order Header TRG  * 
     C                     EXSR SSRVGN
     C           KRSSR     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Customer Number    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRC4NB           Order Number
      * Setup key
     C                     Z-ADDWOAIC3    WRAIC3           Company Number
     C                     Z-ADDWOC4NB    WRC4NB           Order Number
      * Establish starting position
     C           KRSSS     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0044           Ship To Custome
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRBKC7    YL0044           Ship To Custome
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Crt Ld Frt Chrg/Upd   RT - Load Freight Charge Ref  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0015 40        LFCR Alpha Valu
     C                     MOVEL*BLANK    WN0016  1        Record Status
     C                     Z-ADD*ZERO     WN0017  70       Create Date
     C                     Z-ADD*ZERO     WN0018  60       Create Time
     C                     MOVEL*BLANK    WN0019 10        Create User
     C                     MOVEL*BLANK    WN0020 10        Create Program
     C                     Z-ADD*ZERO     WN0021  70       Change Date
     C                     Z-ADD*ZERO     WN0022  60       Change Time
     C                     MOVEL*BLANK    WN0023 10        Change User
     C                     MOVEL*BLANK    WN0024 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WERMNB           Load ID
     C                     KFLD           WECDAA           FC Code
     C                     KFLD           WEEPNY           LFC Sequence Nu
     C                     KFLD           WEIYAA           CR Reference Co
      * Setup key
     C                     Z-ADDWL0089    WERMNB           Load ID
     C                     MOVELWL0088    WECDAA           FC Code
     C                     Z-ADDWL0090    WEEPNY           LFC Sequence Nu
     C                     MOVELWKIYAA    WEIYAA           CR Reference Co
      * Establish starting position
     C           KRSST     CHAIN@DKCPRF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3893' W0RTN   7
      * USER: Processing if Data record not found
      * Crt LD Frt Chrg Ref   CR - Load Freight Charge Ref  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0089    WL0071           Load ID
     C                     MOVELWL0088    WL0072    P      FC Code
     C                     Z-ADDWL0090    WL0073           LFC Sequence Nu
     C                     MOVELWKIYAA    WL0074    P      CR Reference Co
     C                     MOVELYL0042    WL0075    P      LFCR Value Type
     C                     Z-ADDYL0043    WL0076           LFCR Numeric Va
     C                     MOVELWN0015    WL0077    P      LFCR Alpha Valu
     C                     MOVELWKAYST    WL0078    P      LFCR Reference
     C                     MOVELWN0016    WL0079    P      Record Status
     C                     Z-ADDWN0017    WL0080           Create Date
     C                     Z-ADDWN0018    WL0081           Create Time
     C                     MOVELWN0019    WL0082    P      Create User
     C                     MOVELWN0020    WL0083    P      Create Program
     C                     Z-ADDWN0021    WL0084           Change Date
     C                     Z-ADDWN0022    WL0085           Change Time
     C                     MOVELWN0023    WL0086    P      Change User
     C                     MOVELWN0024    WL0087    P      Change Program
     C                     EXSR SPCRRC
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg LD Frt Chrg Ref   CH - Load Freight Charge Ref  * 
     C                     EXSR SUCHRC
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg LD Frt Chrg Ref   CH - Load Freight Charge Ref  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @DKCPRE
     C                     Z-ADDWERMNB    WFRMNB           Load ID
     C                     MOVELWECDAA    WFCDAA    P      FC Code
     C                     Z-ADDWEEPNY    WFEPNY           LFC Sequence Nu
     C                     MOVELWEIYAA    WFIYAA    P      CR Reference Co
      *
     C           KLCHSU    KLIST
     C                     KFLD           WFRMNB           Load ID
     C                     KFLD           WFCDAA           FC Code
     C                     KFLD           WFEPNY           LFC Sequence Nu
     C                     KFLD           WFIYAA           CR Reference Co
     C           KLCHSU    CHAIN@DKCPRE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMDKCPL0'MDACP
     C                     MOVEL'@DKCPRE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMDK1    YARDCS
      * Move non-key fields to @DKCPRE
     C                     MOVELYL0042    WFKFTX    P      LFCR Value Type
     C                     Z-ADDYL0043    WFKBNY           LFCR Numeric Va
     C                     MOVELWN0015    WFNET1    P      LFCR Alpha Valu
     C                     MOVELWKAYST    WFAZST    P      LFCR Reference
     C                     MOVELWN0016    WFVSST    P      Record Status
     C                     Z-ADDWN0017    WFMJDT           Create Date
     C                     Z-ADDWN0018    WFBETM           Create Time
     C                     MOVELWN0019    WFCCVN    P      Create User
     C                     MOVELWN0020    WFCDVN    P      Create Program
     C                     Z-ADDWN0021    WFMKDT           Change Date
     C                     Z-ADDWN0022    WFBFTM           Change Time
     C                     MOVELWN0023    WFCEVN    P      Change User
     C                     MOVELWN0024    WFCFVN    P      Change Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPMDK1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WFMKDT           Change Date
     C                     Z-ADD##JTM     WFBFTM           Change Time
     C                     MOVEL##USR     WFCEVN           Change User
     C                     MOVEL##PGM     WFCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPMDK1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@DKCPRE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMDKCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV 1st Company       RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WORMNB    WQSV02           Load ID
      * Define keylist
     C           KPSSV     KLIST
     C                     KFLD           WQSV02           Load ID
     C                     KFLD           WORVNB           Stop/Drop
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV02           Load ID
      * Setup key
     C                     Z-ADDWL0092    WQSV02           Load ID
     C                     Z-ADDWL0093    WORVNB           Stop/Drop
      * Establish starting position
     C           KPSSV     SETLL@FLCPEB                    *
     C           KRSSV     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWOAIC3    WL0094           Company Number
     C                     GOTO SVEXIT                     *QUIT
     C           KRSSV     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Val for Stop Frt Chrge RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WORMNB    WQSW02           Load ID
     C           *LIKE     DEFN WORVNB    WQSW03           Stop/Drop
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW02           Load ID
     C                     KFLD           WQSW03           Stop/Drop
      * Setup key
     C                     Z-ADDWL0095    WQSW02           Load ID
     C                     Z-ADDWL0096    WQSW03           Stop/Drop
      * Establish starting position
     C           KRSSW     SETLL@FLCPEB                    *
     C           KRSSW     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0098           Record Found US
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0098           Record Found US
     C           KRSSW     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCRRC    BEGSR
      *================================================================
      * Crt Load Freight TMS  CR - Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BCCPJ7
     C                     Z-ADDWL0099    WBRMNB           Load ID
     C                     MOVELWL0100    WBCDAA           FC Code
     C                     Z-ADDWL0101    WBEPNY           LFC Sequence Nu
     C                     Z-ADDWL0102    WBC5VL           LFC Amount
     C                     MOVELWL0103    WBKBSX           LFC Act Frt Inc
     C                     MOVELWL0104    WBCFAA           LFC Carrier Cod
     C                     MOVELWL0105    WBKDSX           LFC Create Stat
     C                     MOVELWL0106    WBKESX           LFC Unused Sts
     C                     MOVELWL0107    WBKFSX           LFC Charge Cate
     C                     MOVELWL0108    WBKGSX           LFC Shag/Wash C
     C                     MOVELWL0109    WBKSSX           LFC Tot Freight
     C                     MOVELWL0110    WBKTSX           LFC Special Typ
     C                     MOVELWL0111    WBKHSX           LFC TFP Process
     C                     MOVELWL0112    WBKISX           LFC Reference R
     C                     MOVELWL0113    WBKJSX           LFC Unused Sts
     C                     Z-ADDWL0114    WBEQNY           LFC TFP Carrier
     C                     MOVELWL0115    WBVSST           Record Status
     C                     Z-ADDWL0116    WBMJDT           Create Date
     C                     Z-ADDWL0117    WBBETM           Create Time
     C                     MOVELWL0118    WBCCVN           Create User
     C                     MOVELWL0119    WBCDVN           Create Program
     C                     Z-ADDWL0120    WBMKDT           Change Date
     C                     Z-ADDWL0121    WBBFTM           Change Time
     C                     MOVELWL0122    WBCEVN           Change User
     C                     MOVELWL0123    WBCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WBVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WBMJDT           Create Date
     C                     Z-ADD##JTM     WBBETM           Create Time
     C                     MOVEL##USR     WBCCVN           Create User
     C                     MOVEL##PGM     WBCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD0         WBMKDT           Change Date
     C                     Z-ADD0         WBBFTM           Change Time
     C                     MOVEL*BLANK    WBCEVN           Change User
     C                     MOVEL*BLANK    WBCFVN           Change Program
     C           KLCRSX    KLIST
     C                     KFLD           WBRMNB           Load ID
     C                     KFLD           WBCDAA           FC Code
     C                     KFLD           WBEPNY           LFC Sequence Nu
      * Check for duplicate primary key
     C           KLCRSX    SETLL@BCCPJ7                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3059' W0RTN   7
      * Send message 'Load Freight Charge    EX'
     C                     MOVEL'USR3059' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C                     WRITE@BCCPJ7                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Next Sequence     RT - Load Freight Charge Cmt  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSRMNB    WQSY01           Load ID
     C           *LIKE     DEFN WSCDAA    WQSY02           FC Code
     C           *LIKE     DEFN WSEPNY    WQSY03           LFC Sequence Nu
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Load ID
     C                     KFLD           WQSY02           FC Code
     C                     KFLD           WQSY03           LFC Sequence Nu
      * Setup key
     C                     Z-ADDWL0124    WQSY01           Load ID
     C                     MOVELWL0125    WQSY02           FC Code
     C                     Z-ADDWL0126    WQSY03           LFC Sequence Nu
      * Establish starting position
     C           KRSSY     SETLL@EYCPYM                    *
     C           KRSSY     READE@EYCPYM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4086' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0127           LFCC Sequence N
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WSNZNY    ADD  1         WL0127           LFCC Sequence N
     C                     GOTO SYEXIT                     *QUIT
     C           KRSSY     READE@EYCPYM                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCRRC    BEGSR
      *================================================================
      * Crt LdFrtChrg Comment CR - Load Freight Charge Cmt  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPYJ
     C                     Z-ADDWL0128    WDRMNB           Load ID
     C                     MOVELWL0129    WDCDAA           FC Code
     C                     Z-ADDWL0130    WDEPNY           LFC Sequence Nu
     C                     Z-ADDWL0131    WDNZNY           LFCC Sequence N
     C                     MOVELWL0132    WDS3NA           LFCC Comment
     C                     MOVELWL0133    WDVSST           Record Status
     C                     Z-ADDWL0134    WDMJDT           Create Date
     C                     Z-ADDWL0135    WDBETM           Create Time
     C                     MOVELWL0136    WDCCVN           Create User
     C                     MOVELWL0137    WDCDVN           Create Program
     C                     Z-ADDWL0138    WDMKDT           Change Date
     C                     Z-ADDWL0139    WDBFTM           Change Time
     C                     MOVELWL0140    WDCEVN           Change User
     C                     MOVELWL0141    WDCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WDVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WDMJDT           Create Date
     C                     Z-ADD##JTM     WDBETM           Create Time
     C                     MOVEL##USR     WDCCVN           Create User
     C                     MOVEL##PGM     WDCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD0         WDMKDT           Change Date
     C                     Z-ADD0         WDBFTM           Change Time
     C                     MOVEL*BLANK    WDCEVN           Change User
     C                     MOVEL*BLANK    WDCFVN           Change Program
     C           KLCRSZ    KLIST
     C                     KFLD           WDRMNB           Load ID
     C                     KFLD           WDCDAA           FC Code
     C                     KFLD           WDEPNY           LFC Sequence Nu
     C                     KFLD           WDNZNY           LFCC Sequence N
      * Check for duplicate primary key
     C           KLCRSZ    SETLL@EYCPYJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4087' W0RTN   7
      * Send message 'Load Freight Charge Cm EX'
     C                     MOVEL'USR4087' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPYJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Rated Freight     RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WTRMNB           Load ID
      * Setup key
     C                     Z-ADDP1TMLD    WTRMNB           Load ID
      * Establish starting position
     C           KRSTA     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0051           Rated Freight
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWTR1NB    YL0051           Rated Freight
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Carrier Payment   RT - Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0052           Total Freight 7
     C                     Z-ADD*ZERO     YL0053           Total Freight U
     C                     Z-ADDYL0051    YL0052           Total Freight 7
     C                     Z-ADDYL0051    YL0053           Total Freight U
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQTB01           Load ID
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Load ID
      * Setup key
     C                     Z-ADDP1TMLD    WQTB01           Load ID
      * Establish starting position
     C           KRSTB     SETLL@BCCPJ8                    *
     C           KRSTB     READE@BCCPJ8                  90*
      * Data record not found
     C   90                MOVEL'USR3058' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.LFC Act Frt Include Sts is Yes
     C           WAKBSX    IFEQ 'Y'                        *IF
     C                     ADD  WAC5VL    YL0052           Total Freight 7
     C                     END                             *FI
      * CASE: DB1.LFC Tot Freight Inc Sts is Yes
     C           WAKSSX    IFEQ 'Y'                        *IF
     C                     ADD  WAC5VL    YL0053           Total Freight U
     C                     END                             *FI
     C           KRSTB     READE@BCCPJ8                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Upd Ld ActFrt/TotFrt  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WTRMNB           Load ID
      * Setup key
     C                     Z-ADDP1TMLD    WTRMNB           Load ID
      * Establish starting position
     C           KRSTC     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Ld ActFrt/TotFrt  CH - Load Header  * 
     C                     EXSR TDCHRC
     C                     MOVELWTPKST    YL0054           Load Status
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDCHRC    BEGSR
      *================================================================
      * Chg Ld ActFrt/TotFrt  CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0025  30       Company Number
     C                     Z-ADD*ZERO     WN0026  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0027  1        LTL Flag
     C                     MOVEL*BLANK    WN0028  1        Load Status
     C                     Z-ADD*ZERO     WN0029  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0030 15        Seal 1
     C                     MOVEL*BLANK    WN0031 15        Seal 2
     C                     MOVEL*BLANK    WN0032 15        Seal 3
     C                     MOVEL*BLANK    WN0033 15        Seal 4
     C                     MOVEL*BLANK    WN0034 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0035  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0036 112       Flat Amount
     C                     MOVEL*BLANK    WN0037  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0038  50       Total Stops
     C                     MOVEL*BLANK    WN0039 20        Trailer Id
     C                     MOVEL*BLANK    WN0040  3        Transloader Car
     C                     Z-ADD*ZERO     WN0041  40       BOL Time
     C                     MOVEL*BLANK    WN0042  3        Carrier Code
     C                     MOVEL*BLANK    WN0043  7        Truck Size
     C                     Z-ADD*ZERO     WN0044  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0045 112       Rated Freight
     C                     MOVEL*BLANK    WN0046  1        Ship Status
     C                     MOVEL*BLANK    WN0047  1        Load Type
     C                     Z-ADD*ZERO     WN0048  50       Number Pallets
     C                     Z-ADD*ZERO     WN0049  50       Number Pallets
     C                     Z-ADD*ZERO     WN0050 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0051  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0052  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0053  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0054 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0055 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0056  70       Actual Departur
     C                     Z-ADD*ZERO     WN0057  40       Departure Time
     C                     Z-ADD*ZERO     WN0058  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0059  52       Product Tempera
     C                     Z-ADD*ZERO     WN0060  50       Number Spacers
     C                     MOVEL*BLANK    WN0061 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0062  70       Total Load Mile
     C                     MOVEL*BLANK    WN0063 12        Recorder ID
     C                     MOVEL*BLANK    WN0064  2        Shipping Method
     C                     MOVEL*BLANK    WN0065  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0066  2        Ship To State C
     C                     Z-ADD*ZERO     WN0067  70       Gross Weight
     C                     MOVEL*BLANK    WN0068  3        Carrier Broker
     C                     MOVEL*BLANK    WN0069  1        Export Status
     C                     Z-ADD*ZERO     WN0070  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0071  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0072  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0073  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0074  70       Spotted Date
     C                     Z-ADD*ZERO     WN0075  60       Spotted Time
     C                     Z-ADD*ZERO     WN0076  70       Load Finished D
     C                     Z-ADD*ZERO     WN0077  60       Load Finished T
     C                     Z-ADD*ZERO     WN0078  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0079  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0080  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0081  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0082  70       Truck Departure
     C                     Z-ADD*ZERO     WN0083  60       Truck Departure
     C                     Z-ADD*ZERO     WN0084  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0085  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0086  3        Shipping Line
     C                     MOVEL*BLANK    WN0087 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0088 30        Vessel Name
     C                     Z-ADD*ZERO     WN0089  50       Voyage
     C                     Z-ADD*ZERO     WN0090  70       Sail Date
     C                     MOVEL*BLANK    WN0091 12        Booking Number
     C                     MOVEL*BLANK    WN0092 20        Discharge Port
     C                     Z-ADD*ZERO     WN0093  70       Arrival Date
     C                     MOVEL*BLANK    WN0094 12        Container Numbe
     C                     Z-ADD*ZERO     WN0095  70       Date In
     C                     Z-ADD*ZERO     WN0096  60       Time In
     C                     Z-ADD*ZERO     WN0097  70       Date Out
     C                     Z-ADD*ZERO     WN0098  60       Time Out
     C                     Z-ADD*ZERO     WN0099  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0100  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0101  1        LH Unused Sts
     C                     Z-ADD*ZERO     WN0102  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0103  70       Requested Deliv
     C                     MOVEL*BLANK    WN0104  1        Load Acceptance
     C                     MOVEL*BLANK    WN0105  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0106  70       On Yard Date
     C                     Z-ADD*ZERO     WN0107  60       On Yard Time
     C                     Z-ADD*ZERO     WN0108  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0109  60       Deadline Depart
     C                     MOVEL*BLANK    WN0110  1        Load Held Over
     C                     MOVEL*BLANK    WN0111  1        Load Held Over
     C                     MOVEL*BLANK    WN0112 15        Load Held Over
     C                     MOVEL*BLANK    WN0113 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0114 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0115  70       Express Mail Da
     C                     MOVEL*BLANK    WN0116  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0117  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0118  70       Product Complet
     C                     Z-ADD*ZERO     WN0119  60       Product Complet
     C                     Z-ADD*ZERO     WN0120  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0121  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0122  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0123  1        Load Confirmed
     C                     MOVEL*BLANK    WN0124 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0125  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0126  60       Load Door 1
     C                     Z-ADD*ZERO     WN0127  70       Override Total
     C                     Z-ADD*ZERO     WN0128  60       Load Door 2
     C                     MOVEL*BLANK    WN0129  1        Partial Load
     C                     MOVEL*BLANK    WN0130  1        Load Confirmati
     C                     MOVEL*BLANK    WN0131  1        Export Load USD
     C                     MOVEL*BLANK    WN0132  1        Late Delivery E
     C                     MOVEL*BLANK    WN0133 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0134 15        Late Billing Em
     C                     MOVEL*BLANK    WN0135 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0136 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0137  1        Multi Company L
     C                     MOVEL*BLANK    WN0138  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0139  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0140  1        LH Power Only L
     C                     MOVEL*BLANK    WN0141  1        MG Created Load
     C                     MOVEL*BLANK    WN0142  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0143  2        Load U/M
     C                     MOVEL*BLANK    WN0144  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0145  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0146  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0147  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0148  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0149  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0150  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0151  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0152  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0153  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0154  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0155  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0156  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0157  60       LH Unused Time
     C                     MOVEL*BLANK    WN0158  1        EDI Status 1
     C                     MOVEL*BLANK    WN0159  1        EDI Status 2
     C                     MOVEL*BLANK    WN0160  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0161  60       Job Time
     C                     MOVEL*BLANK    WN0162 10        User Id
     C                     MOVEL*BLANK    WN0163 10        Job Name
     C                     Z-ADD*ZERO     WN0164  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWTRMNB    WVRMNB           Load ID
      *
     C           KLCHTD    KLIST
     C                     KFLD           WVRMNB           Load ID
     C           KLCHTD    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDYL0053    WVOCFR           Load Total Frei
     C                     MOVEL'P'       WVRNST    P      LH Carrier Paym
     C                     Z-ADDYL0052    WVZBVA           Load Actual Fre
     C                     Z-ADDP2MBDT    WVPYDT           LH Carrier Paid
     C                     Z-ADDYL0001    WVCKTM           LH Carrier Paid
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##JOB     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
      * CASE: PAR.LH Carrier Payment Sts is Paid
     C           'P'       IFEQ 'P'                        *IF
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAEPNY           LFC Sequence Nu
     C                     Z-ADD*ZERO     WAC5VL           LFC Amount
     C                     Z-ADD*ZERO     WAEQNY           LFC TFP Carrier
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCEPNY           LFC Sequence Nu
     C                     Z-ADD*ZERO     WCNZNY           LFCC Sequence N
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WEEPNY           LFC Sequence Nu
     C                     Z-ADD*ZERO     WEKBNY           LFCR Numeric Va
     C                     Z-ADD*ZERO     WEMJDT           Create Date
     C                     Z-ADD*ZERO     WEBETM           Create Time
     C                     Z-ADD*ZERO     WEMKDT           Change Date
     C                     Z-ADD*ZERO     WEBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGTMLD           TMS Load ID
     C                     Z-ADD*ZERO     WGHHNB           TMS Freight Cha
     C                     Z-ADD*ZERO     WGA5D8           TMS Invoice Dat
     C                     Z-ADD*ZERO     WGALTH           TMS Invoice Tim
     C                     Z-ADD*ZERO     WGM0VL           TMS Charge Amou
     C                     Z-ADD*ZERO     WGM1VL           TMS Charge Rate
     C                     Z-ADD*ZERO     WGHENB           TMS Charge Quan
     C                     Z-ADD*ZERO     WGTPRC           TMS Process Sta
     C                     Z-ADD*ZERO     WGA0D8           TMS Change Date
     C                     Z-ADD*ZERO     WGD9TM           TMS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHMJDT           Create Date
     C                     Z-ADD*ZERO     WHBETM           Create Time
     C                     Z-ADD*ZERO     WHMKDT           Change Date
     C                     Z-ADD*ZERO     WHBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIC3VL           FC Rate Amount
     C                     Z-ADD*ZERO     WIOPDT           FC Auto Calc Ef
     C                     Z-ADD*ZERO     WIMJDT           Create Date
     C                     Z-ADD*ZERO     WIBETM           Create Time
     C                     Z-ADD*ZERO     WIMKDT           Change Date
     C                     Z-ADD*ZERO     WIBFTM           Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKMJDT           Create Date
     C                     Z-ADD*ZERO     WKBETM           Create Time
     C                     Z-ADD*ZERO     WKMKDT           Change Date
     C                     Z-ADD*ZERO     WKBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLMJDT           Create Date
     C                     Z-ADD*ZERO     WLBETM           Create Time
     C                     Z-ADD*ZERO     WLMKDT           Change Date
     C                     Z-ADD*ZERO     WLBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMRMNB           Load ID
     C                     Z-ADD*ZERO     WMRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WMRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WMRWNB           Miles to next s
     C                     Z-ADD*ZERO     WMRXNB           Freight Charge
     C                     Z-ADD*ZERO     WMSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WMT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WMT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WMR1NB           Rated Freight
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMC4NB           Order Number
     C                     Z-ADD*ZERO     WMKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WMSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WMKFDT           Appointment Con
     C                     Z-ADD*ZERO     WMACTM           Appointment Con
     C                     Z-ADD*ZERO     WMEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WMAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WMKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WMATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WMHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WMAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WMKKDT           On Yard Date
     C                     Z-ADD*ZERO     WMAVTM           On Yard Time
     C                     Z-ADD*ZERO     WMZ4NB           MPC Number
     C                     Z-ADD*ZERO     WMN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WMN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WMN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WMB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WMB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WMB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRC4NB           Order Number
     C                     Z-ADD*ZERO     WRANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WRBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WRB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WRA0DT           Order Date
     C                     Z-ADD*ZERO     WRA5DT           Requested Ship
     C                     Z-ADD*ZERO     WRGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WRACDT           Cancel Date
     C                     Z-ADD*ZERO     WRAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WRCXDT           Date of Origina
     C                     Z-ADD*ZERO     WRJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WRA1WG           Order Weight To
     C                     Z-ADD*ZERO     WREIDT           Requested Deliv
     C                     Z-ADD*ZERO     WRAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WRRMNB           Load ID
     C                     Z-ADD*ZERO     WRTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WRR1NB           Rated Freight
     C                     Z-ADD*ZERO     WRRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WRATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WRRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WRT3NB           Attach to Order
     C                     Z-ADD*ZERO     WRCONB           Invoice Number
     C                     Z-ADD*ZERO     WRAWDT           Invoice Date
     C                     Z-ADD*ZERO     WRVRVA           A/R order Value
     C                     Z-ADD*ZERO     WRB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WRNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WRNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WRNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WRNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WRNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WRBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WRBQTM           Time of Origina
     C                     Z-ADD*ZERO     WRBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WRBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WRBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WRH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WRH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WRH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WRH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WRH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WRC0C7           Claim Number
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field Blank 6 USR
     C                     MOVEL*BLANK    WUXKTX  6
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTRMNB           Load ID
     C                     Z-ADD*ZERO     WTAIC3           Company Number
     C                     Z-ADD*ZERO     WTAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WTRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WTRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WTFLAM           Flat Amount
     C                     Z-ADD*ZERO     WTRRNB           Total Stops
     C                     Z-ADD*ZERO     WTSBNB           BOL Time
     C                     Z-ADD*ZERO     WTSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WTR1NB           Rated Freight
     C                     Z-ADD*ZERO     WTSDNB           Number Pallets
     C                     Z-ADD*ZERO     WTPAOU           Number Pallets
     C                     Z-ADD*ZERO     WTDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WTSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WTHADT           Actual Arrival
     C                     Z-ADD*ZERO     WTAART           Actual Arrival
     C                     Z-ADD*ZERO     WTDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WTDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WTAQDT           Actual Departur
     C                     Z-ADD*ZERO     WTS6NB           Departure Time
     C                     Z-ADD*ZERO     WTT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WTPRTM           Product Tempera
     C                     Z-ADD*ZERO     WTNPSV           Number Spacers
     C                     Z-ADD*ZERO     WTTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WTGRWE           Gross Weight
     C                     Z-ADD*ZERO     WTF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WTJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WTTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WTJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WTSPTM           Spotted Time
     C                     Z-ADD*ZERO     WTJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WTLFTM           Load Finished T
     C                     Z-ADD*ZERO     WTJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WTBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WTJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WTBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WTKIDT           Truck Departure
     C                     Z-ADD*ZERO     WTASTM           Truck Departure
     C                     Z-ADD*ZERO     WTKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WTAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WTVOAG           Voyage
     C                     Z-ADD*ZERO     WTKBDT           Sail Date
     C                     Z-ADD*ZERO     WTEFDT           Arrival Date
     C                     Z-ADD*ZERO     WTKCDT           Date In
     C                     Z-ADD*ZERO     WTTMIN           Time In
     C                     Z-ADD*ZERO     WTKDDT           Date Out
     C                     Z-ADD*ZERO     WTVMNB           Time Out
     C                     Z-ADD*ZERO     WTOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WTKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WTATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WTBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WTEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WTKKDT           On Yard Date
     C                     Z-ADD*ZERO     WTAVTM           On Yard Time
     C                     Z-ADD*ZERO     WTKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WTAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WTLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WTK0DT           Product Complet
     C                     Z-ADD*ZERO     WTAYTM           Product Complet
     C                     Z-ADD*ZERO     WTKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WTICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WTIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WTK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WTAZTM           Load Door 1
     C                     Z-ADD*ZERO     WTK2DT           Override Total
     C                     Z-ADD*ZERO     WTA0TM           Load Door 2
     C                     Z-ADD*ZERO     WTZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WTPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WTCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WTPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WTCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WTP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WTCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WTP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WTCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WTP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WTCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WTP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WTCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SHRVGN.
     C                     MOVEL*BLANK    WL0001  6
     C                     MOVEL*BLANK    WL0002  3
     C                     MOVEL*BLANK    WL0003  1
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0004  6
     C                     MOVEL*BLANK    WL0005 30
     C                     Z-ADD*ZERO     WL0006  72
     C                     MOVEL*BLANK    WL0007  2
     C                     MOVEL*BLANK    WL0008  1
     C                     MOVEL*BLANK    WL0009  1
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  1
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     MOVEL*BLANK    WL0015  1
     C                     MOVEL*BLANK    WL0016  1
     C                     MOVEL*BLANK    WL0017  1
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
     C                     MOVEL*BLANK    WL0021  1
     C                     MOVEL*BLANK    WL0022  1
     C                     MOVEL*BLANK    WL0023  1
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  1
     C                     Z-ADD*ZERO     WL0028  70
     C                     MOVEL*BLANK    WL0029  1
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0030  70
     C                     MOVEL*BLANK    WL0031  6
     C                     Z-ADD*ZERO     WL0032  30
      * Define local variables for subroutine SKCRRC.
     C                     Z-ADD*ZERO     WL0033  70
     C                     MOVEL*BLANK    WL0034  6
     C                     Z-ADD*ZERO     WL0035  30
     C                     Z-ADD*ZERO     WL0036  72
     C                     MOVEL*BLANK    WL0037  1
     C                     MOVEL*BLANK    WL0038  4
     C                     MOVEL*BLANK    WL0039  1
     C                     MOVEL*BLANK    WL0040  1
     C                     MOVEL*BLANK    WL0041  1
     C                     MOVEL*BLANK    WL0042  1
     C                     MOVEL*BLANK    WL0043  1
     C                     MOVEL*BLANK    WL0044  1
     C                     MOVEL*BLANK    WL0045  1
     C                     MOVEL*BLANK    WL0046  1
     C                     MOVEL*BLANK    WL0047  1
     C                     Z-ADD*ZERO     WL0048  70
     C                     MOVEL*BLANK    WL0049  1
     C                     Z-ADD*ZERO     WL0050  70
     C                     Z-ADD*ZERO     WL0051  60
     C                     MOVEL*BLANK    WL0052 10
     C                     MOVEL*BLANK    WL0053 10
     C                     Z-ADD*ZERO     WL0054  70
     C                     Z-ADD*ZERO     WL0055  60
     C                     MOVEL*BLANK    WL0056 10
     C                     MOVEL*BLANK    WL0057 10
      * Define local variables for subroutine SMRVGN.
     C                     MOVEL*BLANK    WL0058  6
     C                     MOVEL*BLANK    WL0059 30
     C                     MOVEL*BLANK    WL0060  1
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0061  70
     C                     Z-ADD*ZERO     WL0062  30
     C                     MOVEL*BLANK    WL0063  1
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0064  70
     C                     MOVEL*BLANK    WL0065  6
     C                     Z-ADD*ZERO     WL0066  30
     C                     MOVEL*BLANK    WL0067  6
     C                     MOVEL*BLANK    WL0068  1
     C                     Z-ADD*ZERO     WL0069 155
     C                     MOVEL*BLANK    WL0070  1
      * Define local variables for subroutine SPCRRC.
     C                     Z-ADD*ZERO     WL0071  70
     C                     MOVEL*BLANK    WL0072  6
     C                     Z-ADD*ZERO     WL0073  30
     C                     MOVEL*BLANK    WL0074  6
     C                     MOVEL*BLANK    WL0075  1
     C                     Z-ADD*ZERO     WL0076 155
     C                     MOVEL*BLANK    WL0077 40
     C                     MOVEL*BLANK    WL0078  1
     C                     MOVEL*BLANK    WL0079  1
     C                     Z-ADD*ZERO     WL0080  70
     C                     Z-ADD*ZERO     WL0081  60
     C                     MOVEL*BLANK    WL0082 10
     C                     MOVEL*BLANK    WL0083 10
     C                     Z-ADD*ZERO     WL0084  70
     C                     Z-ADD*ZERO     WL0085  60
     C                     MOVEL*BLANK    WL0086 10
     C                     MOVEL*BLANK    WL0087 10
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0088  6
     C                     Z-ADD*ZERO     WL0089  70
     C                     Z-ADD*ZERO     WL0090  30
     C                     Z-ADD*ZERO     WL0091  30
      * Define local variables for subroutine SVRVGN.
     C                     Z-ADD*ZERO     WL0092  70
     C                     Z-ADD*ZERO     WL0093  50
     C                     Z-ADD*ZERO     WL0094  30
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0095  70
     C                     Z-ADD*ZERO     WL0096  50
     C                     Z-ADD*ZERO     WL0097  30
     C                     MOVEL*BLANK    WL0098  1
      * Define local variables for subroutine SXCRRC.
     C                     Z-ADD*ZERO     WL0099  70
     C                     MOVEL*BLANK    WL0100  6
     C                     Z-ADD*ZERO     WL0101  30
     C                     Z-ADD*ZERO     WL0102  72
     C                     MOVEL*BLANK    WL0103  1
     C                     MOVEL*BLANK    WL0104  4
     C                     MOVEL*BLANK    WL0105  1
     C                     MOVEL*BLANK    WL0106  1
     C                     MOVEL*BLANK    WL0107  1
     C                     MOVEL*BLANK    WL0108  1
     C                     MOVEL*BLANK    WL0109  1
     C                     MOVEL*BLANK    WL0110  1
     C                     MOVEL*BLANK    WL0111  1
     C                     MOVEL*BLANK    WL0112  1
     C                     MOVEL*BLANK    WL0113  1
     C                     Z-ADD*ZERO     WL0114  70
     C                     MOVEL*BLANK    WL0115  1
     C                     Z-ADD*ZERO     WL0116  70
     C                     Z-ADD*ZERO     WL0117  60
     C                     MOVEL*BLANK    WL0118 10
     C                     MOVEL*BLANK    WL0119 10
     C                     Z-ADD*ZERO     WL0120  70
     C                     Z-ADD*ZERO     WL0121  60
     C                     MOVEL*BLANK    WL0122 10
     C                     MOVEL*BLANK    WL0123 10
      * Define local variables for subroutine SYRVGN.
     C                     Z-ADD*ZERO     WL0124  70
     C                     MOVEL*BLANK    WL0125  6
     C                     Z-ADD*ZERO     WL0126  30
     C                     Z-ADD*ZERO     WL0127  30
      * Define local variables for subroutine SZCRRC.
     C                     Z-ADD*ZERO     WL0128  70
     C                     MOVEL*BLANK    WL0129  6
     C                     Z-ADD*ZERO     WL0130  30
     C                     Z-ADD*ZERO     WL0131  30
     C                     MOVEL*BLANK    WL0132 60
     C                     MOVEL*BLANK    WL0133  1
     C                     Z-ADD*ZERO     WL0134  70
     C                     Z-ADD*ZERO     WL0135  60
     C                     MOVEL*BLANK    WL0136 10
     C                     MOVEL*BLANK    WL0137 10
     C                     Z-ADD*ZERO     WL0138  70
     C                     Z-ADD*ZERO     WL0139  60
     C                     MOVEL*BLANK    WL0140 10
     C                     MOVEL*BLANK    WL0141 10
      * Define local work field LH Carrier Paid Time
     C                     Z-ADD*ZERO     YL0001  60
      * Define local work field TMS Charge Desc Parse Txt
     C                     MOVEL*BLANK    YL0002  7
      * Define local work field Text 1 Length USR
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Stop Number
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field FC Code
     C                     MOVEL*BLANK    YL0005  6
      * Define local work field FC Description
     C                     MOVEL*BLANK    YL0006 30
      * Define local work field FC Rate Amount
     C                     Z-ADD*ZERO     YL0007  72
      * Define local work field FC Unit of Measure
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field FC Act Frt Include Sts
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field FC Frt Add/Deduct
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field FC Load Type Select
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field FC State Select
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field FC Export Select
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field FC Shag/Wash Select
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field FC Auto Calc Sts
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field FC Charge Category
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field FC Shag/Wash Comp
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field FC Edit Sequence
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field FC Tot Freight Inc Sts
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field FC Special Type
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field FC ExpInt FR/FZ Select
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field FC Reference Required
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field FC Trans Mode Select
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field FC Freight Rate Type Sel
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field FC Company Select
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field FC Company/Carrier Select
     C                     MOVEL*BLANK    YL0026  1
      * Define local work field FC Shared Responsibility
     C                     MOVEL*BLANK    YL0027  1
      * Define local work field FC Unused Sts 10
     C                     MOVEL*BLANK    YL0028  1
      * Define local work field FC Auto Calc Effective
     C                     Z-ADD*ZERO     YL0029  70
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0030  1
      * Define local work field LFC Sequence Number
     C                     Z-ADD*ZERO     YL0031  30
      * Define local work field LFC Create Status
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field LFC Unused Sts
     C                     MOVEL*BLANK    YL0033  1
      * Define local work field LFC TFP Processed
     C                     MOVEL*BLANK    YL0034  1
      * Define local work field LFC Unused Sts 5
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field LFC TFP Carrier Paid Date
     C                     Z-ADD*ZERO     YL0036  70
      * Define null work field CR Reference Desc
     C                     MOVEL*BLANK    YN0001 30
      * Define local work field CR Value Type
     C                     MOVEL*BLANK    YL0037  1
      * Define local work field LFCR Numeric Value
     C                     Z-ADD*ZERO     YL0038 155
      * Define null work field FC Description
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field FC Rate Amount
     C                     Z-ADD*ZERO     YN0003  72
      * Define null work field FC Unit of Measure
     C                     MOVEL*BLANK    YN0004  2
      * Define null work field FC Act Frt Include Sts
     C                     MOVEL*BLANK    YN0005  1
      * Define null work field FC Frt Add/Deduct
     C                     MOVEL*BLANK    YN0006  1
      * Define null work field FC Load Type Select
     C                     MOVEL*BLANK    YN0007  1
      * Define null work field FC State Select
     C                     MOVEL*BLANK    YN0008  1
      * Define null work field FC Export Select
     C                     MOVEL*BLANK    YN0009  1
      * Define null work field FC Shag/Wash Select
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field FC Auto Calc Sts
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field FC Charge Category
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field FC Shag/Wash Comp
     C                     MOVEL*BLANK    YN0013  1
      * Define null work field FC Edit Sequence
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field FC Tot Freight Inc Sts
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field FC Special Type
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field FC ExpInt FR/FZ Select
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field FC Reference Required
     C                     MOVEL*BLANK    YN0018  1
      * Define null work field FC Trans Mode Select
     C                     MOVEL*BLANK    YN0019  1
      * Define null work field FC Freight Rate Type Sel
     C                     MOVEL*BLANK    YN0020  1
      * Define null work field FC Company Select
     C                     MOVEL*BLANK    YN0021  1
      * Define null work field FC Company/Carrier Select
     C                     MOVEL*BLANK    YN0022  1
      * Define local work field FC Shared Responsibility
     C                     MOVEL*BLANK    YL0039  1
      * Define null work field FC Unused Sts 10
     C                     MOVEL*BLANK    YN0023  1
      * Define null work field FC Auto Calc Effective
     C                     Z-ADD*ZERO     YN0024  70
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0025  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0040  30
      * Define local work field Multi Company Load
     C                     MOVEL*BLANK    YL0041  1
      * Define null work field CR Reference Desc
     C                     MOVEL*BLANK    YN0026 30
      * Define local work field CR Value Type
     C                     MOVEL*BLANK    YL0042  1
      * Define local work field LFCR Numeric Value
     C                     Z-ADD*ZERO     YL0043 155
      * Define local work field Customer Number       NBR
     C                     Z-ADD*ZERO     YL0044  70
      * Define local work field CR Reference Code
     C                     MOVEL*BLANK    YL0045  6
      * Define local work field LFCR Reference Type
     C                     MOVEL*BLANK    YL0046  1
      * Define local work field LFCR Numeric Value
     C                     Z-ADD*ZERO     YL0047 155
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0048  30
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0049  1
      * Define local work field LFCC Sequence Number
     C                     Z-ADD*ZERO     YL0050  30
      * Define local work field Rated Freight
     C                     Z-ADD*ZERO     YL0051 112
      * Define local work field Total Freight 7.2 USR
     C                     Z-ADD*ZERO     YL0052  72
      * Define local work field Total Freight USR
     C                     Z-ADD*ZERO     YL0053  72
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0054  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Stop 1:
00002 Stop 2:
00003 Stop 3:
00004 Stop 4:
00005 Stop 5:
00006 Stop 6:
00007 Stop 7:
00008 Stop 8:
00009 Stop 9:
00010 COMPNY
00011 SHIPTO
