     H/TITLE WW OrdPrdSch Edit     DF  Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 07/13/21  Time  : 14:04:30
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPOQJDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW OrdPrdSch Edit     DF  Display file
      *
     FOPBGWKN3IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Detail              CItm/PrWhs/RSD/Itm/DD+
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDI8CPL4IF  E           K        DISK
      * RSQ : PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      *
     FPDI9CPL9IF  E           K        DISK
      * RSQ : PS Production Adjustment  Co/CItm/Whs/PDte/Itm
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FCAAFREL9IF  E           K        DISK
      * RTV : Calendar                  Co/Date KillDaySts=Y
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPDKNCPL1IF  E           K        DISK
      * RTV : Order Detail Schedule     Retrieval index
      *
     FPPBKCPL3IF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Load/Order Picked
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse                 ShipCo/Warehouse
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOPC0REL1IF  E           K        DISK
      * RTV : User Entry Control        Retrieval index       NV
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOPBFCPLJIF  E           K        DISK
      * RSQ : Order Header TRG          Load(Desc) not bl
      *
     FPMFDREL2IF  E           K        DISK
      * RSQ : Company Item Ext          RTV, select Active
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FCAAFREL8IF  E           K        DISK
      * RTV : Calendar                  Co/Date PrdDaySts=Y
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  18  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@AFREC2
      * Calendar                  Co/Date KillDaySts=Y
      * Renamed input format fields
     I              AFAIC3                          WAAIC3
     I              AFBCDT                          WABCDT
     I              AFCQNB                          WACQNB
     I              AFESNB                          WAESNB
     I              AFETNB                          WAETNB
     I              AFBZNB                          WABZNB
     I              AFA9ST                          WAA9ST
     I              AFEINB                          WAEINB
     I              AFC5ST                          WAC5ST
     I              AFAQNB                          WAAQNB
     I              AFCMST                          WACMST
     I              AFV9ST                          WAV9ST
     I              AFWAST                          WAWAST
     I              AFX2ST                          WAX2ST
     I              AFOJDT                          WAOJDT
     I              AFNQNX                          WANQNX
     I              AFNRNX                          WANRNX
     I              AFI9SX                          WAI9SX
     I              AFJASX                          WAJASX
     I              AFOKDT                          WAOKDT
     I              AFOLDT                          WAOLDT
     I              AFUVST                          WAUVST
     I              AFUWST                          WAUWST
     I              AFUXST                          WAUXST
     I              AFAATM                          WAAATM
     I              AFAYNA                          WAAYNA
     I              AFA0NA                          WAA0NA
     I              AFAXDT                          WAAXDT
      *
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          WBAIC3
     I              AFBCDT                          WBBCDT
     I              AFCQNB                          WBCQNB
     I              AFESNB                          WBESNB
     I              AFETNB                          WBETNB
     I              AFBZNB                          WBBZNB
     I              AFA9ST                          WBA9ST
     I              AFEINB                          WBEINB
     I              AFC5ST                          WBC5ST
     I              AFAQNB                          WBAQNB
     I              AFCMST                          WBCMST
     I              AFV9ST                          WBV9ST
     I              AFWAST                          WBWAST
     I              AFX2ST                          WBX2ST
     I              AFOJDT                          WBOJDT
     I              AFNQNX                          WBNQNX
     I              AFNRNX                          WBNRNX
     I              AFI9SX                          WBI9SX
     I              AFJASX                          WBJASX
     I              AFOKDT                          WBOKDT
     I              AFOLDT                          WBOLDT
     I              AFUVST                          WBUVST
     I              AFUWST                          WBUWST
     I              AFUXST                          WBUXST
     I              AFAATM                          WBAATM
     I              AFAYNA                          WBAYNA
     I              AFA0NA                          WBA0NA
     I              AFAXDT                          WBAXDT
      *
     I@AFREYY
      * Calendar                  Co/Date               NV
      * Renamed input format fields
     I              AFAIC3                          WCAIC3
     I              AFBCDT                          WCBCDT
     I              AFCQNB                          WCCQNB
     I              AFESNB                          WCESNB
     I              AFETNB                          WCETNB
     I              AFBZNB                          WCBZNB
     I              AFA9ST                          WCA9ST
     I              AFEINB                          WCEINB
     I              AFC5ST                          WCC5ST
     I              AFAQNB                          WCAQNB
     I              AFCMST                          WCCMST
     I              AFV9ST                          WCV9ST
     I              AFWAST                          WCWAST
     I              AFX2ST                          WCX2ST
     I              AFOJDT                          WCOJDT
     I              AFNQNX                          WCNQNX
     I              AFNRNX                          WCNRNX
     I              AFI9SX                          WCI9SX
     I              AFJASX                          WCJASX
     I              AFOKDT                          WCOKDT
     I              AFOLDT                          WCOLDT
     I              AFUVST                          WCUVST
     I              AFUWST                          WCUWST
     I              AFUXST                          WCUXST
     I              AFAATM                          WCAATM
     I              AFAYNA                          WCAYNA
     I              AFA0NA                          WCA0NA
     I              AFAXDT                          WCAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WEAIC3
     I              OMC4NB                          WEC4NB
     I              OMDPNB                          WEDPNB
     I              OMUENB                          WEUENB
     I              OMHGCD                          WEHGCD
     I              OMAJCD                          WEAJCD
     I              OMBKC7                          WEBKC7
     I              OMCFC7                          WECFC7
     I              OMGMST                          WEGMST
     I              OMGNST                          WEGNST
     I              OMMAVA                          WEMAVA
     I              OMKDVA                          WEKDVA
     I              OML8VA                          WEL8VA
     I              OML9VA                          WEL9VA
     I              OMGTST                          WEGTST
     I              OMGVST                          WEGVST
     I              OMGUST                          WEGUST
     I              OMQFST                          WEQFST
     I              OMAYVA                          WEAYVA
     I              OMEXDT                          WEEXDT
     I              OMLQCD                          WELQCD
     I              OMRDCD                          WERDCD
     I              OMQ7CD                          WEQ7CD
     I              OMBZPR                          WEBZPR
     I              OML6NB                          WEL6NB
     I              OMU1ST                          WEU1ST
     I              OMGIDT                          WEGIDT
     I              OMCRCD                          WECRCD
     I              OMAGCD                          WEAGCD
     I              OMRZST                          WERZST
     I              OMR0ST                          WER0ST
     I              OMR1ST                          WER1ST
     I              OMG7NA                          WEG7NA
     I              OMG8NA                          WEG8NA
     I              OMRPCD                          WERPCD
     I              OMVEST                          WEVEST
     I              OMVGST                          WEVGST
     I              OMAVST                          WEAVST
     I              OMU0ST                          WEU0ST
     I              OMRFCD                          WERFCD
     I              OMFZST                          WEFZST
     I              OMR1NB                          WER1NB
     I              OMAVQT                          WEAVQT
     I              OMD0WG                          WED0WG
     I              OMCCQT                          WECCQT
     I              OMAUWG                          WEAUWG
     I              OMCBQT                          WECBQT
     I              OMATWG                          WEATWG
     I              OMAQCS                          WEAQCS
     I              OMAGCS                          WEAGCS
     I              OMAKPR                          WEAKPR
     I              OMALPR                          WEALPR
     I              OMAUPR                          WEAUPR
     I              OMAVWG                          WEAVWG
     I              OMA4WG                          WEA4WG
     I              OMA5DT                          WEA5DT
     I              OMAODT                          WEAODT
     I              OMGNDT                          WEGNDT
     I              OMAMST                          WEAMST
     I              OMANST                          WEANST
     I              OMVAST                          WEVAST
     I              OMRGNB                          WERGNB
     I              OMRHNB                          WERHNB
     I              OMRINB                          WERINB
     I              OMRBCD                          WERBCD
     I              OMHICD                          WEHICD
     I              OMRNCD                          WERNCD
     I              OMROCD                          WEROCD
     I              OMCXDT                          WECXDT
     I              OMAJVN                          WEAJVN
     I              OMKXCD                          WEKXCD
     I              OMJPCD                          WEJPCD
     I              OMCQCD                          WECQCD
     I              OMR4CD                          WER4CD
     I              OMZ1ST                          WEZ1ST
     I              OMZ3ST                          WEZ3ST
     I              OMZ4ST                          WEZ4ST
     I              OMDUPR                          WEDUPR
     I              OMB6VL                          WEB6VL
     I              OMA1AA                          WEA1AA
     I              OMFZSX                          WEFZSX
     I              OMF0SX                          WEF0SX
     I              OMF1SX                          WEF1SX
     I              OMF2SX                          WEF2SX
     I              OMF3SX                          WEF3SX
     I              OMF4SX                          WEF4SX
     I              OMF5SX                          WEF5SX
     I              OMF6SX                          WEF6SX
     I              OMF7SX                          WEF7SX
     I              OMNTDT                          WENTDT
     I              OMNUDT                          WENUDT
     I              OMNVDT                          WENVDT
     I              OMNWDT                          WENWDT
     I              OMNXDT                          WENXDT
     I              OMBUTM                          WEBUTM
     I              OMBVTM                          WEBVTM
     I              OMBWTM                          WEBWTM
     I              OMBXTM                          WEBXTM
     I              OMBYTM                          WEBYTM
     I              OMH5NX                          WEH5NX
     I              OMH6NX                          WEH6NX
     I              OMH7NX                          WEH7NX
     I              OMH8NX                          WEH8NX
     I              OMH9NX                          WEH9NX
     I              OMDVPR                          WEDVPR
     I              OMDWPR                          WEDWPR
     I              OMDXPR                          WEDXPR
     I              OMDYPR                          WEDYPR
     I              OMDZPR                          WEDZPR
     I              OMGSPR                          WEGSPR
     I              OMGTPR                          WEGTPR
     I              OMGUPR                          WEGUPR
     I              OMHOST                          WEHOST
     I              OMHPST                          WEHPST
     I              OMIOST                          WEIOST
     I              OMPEWG                          WEPEWG
     I              OMRINY                          WERINY
     I              OMTIDT                          WETIDT
     I              OMTJDT                          WETJDT
     I              OMH2ST                          WEH2ST
     I              OMH0ST                          WEH0ST
     I              OMH1ST                          WEH1ST
     I              OMTKDT                          WETKDT
     I              OMTLDT                          WETLDT
     I              OMTMDT                          WETMDT
     I              OMUVST                          WEUVST
     I              OMUWST                          WEUWST
     I              OMUXST                          WEUXST
     I              OMAATM                          WEAATM
     I              OMAYNA                          WEAYNA
     I              OMA0NA                          WEA0NA
     I              OMAXDT                          WEAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@ADREWA
      * Warehouse                 ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WGAJCD
     I              ADF8NA                          WGF8NA
     I              ADACNA                          WGACNA
     I              ADADNA                          WGADNA
     I              ADAENA                          WGAENA
     I              ADAJNA                          WGAJNA
     I              ADBTTX                          WGBTTX
     I              ADAOCD                          WGAOCD
     I              ADBGCD                          WGBGCD
     I              ADVHST                          WGVHST
     I              ADMPNA                          WGMPNA
     I              ADWPST                          WGWPST
     I              ADXUST                          WGXUST
     I              ADT0ST                          WGT0ST
     I              ADT1ST                          WGT1ST
     I              ADDBNB                          WGDBNB
     I              ADT2ST                          WGT2ST
     I              ADT3ST                          WGT3ST
     I              ADT4ST                          WGT4ST
     I              ADT6ST                          WGT6ST
     I              ADBWC3                          WGBWC3
     I              ADBTC3                          WGBTC3
     I              ADBUC3                          WGBUC3
     I              ADBVC3                          WGBVC3
     I              ADFCAA                          WGFCAA
     I              ADRQSX                          WGRQSX
     I              ADRRSX                          WGRRSX
     I              ADRSSX                          WGRSSX
     I              ADRTSX                          WGRTSX
     I              ADT7ST                          WGT7ST
     I              ADT8ST                          WGT8ST
     I              ADRNSX                          WGRNSX
     I              ADROSX                          WGROSX
     I              ADRPSX                          WGRPSX
     I              ADUVST                          WGUVST
     I              ADUWST                          WGUWST
     I              ADUXST                          WGUXST
     I              ADVSST                          WGVSST
     I              ADAATM                          WGAATM
     I              ADAYNA                          WGAYNA
     I              ADA0NA                          WGA0NA
     I              ADAXDT                          WGAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WHRMNB
     I              FJAIC3                          WHAIC3
     I              FJAODT                          WHAODT
     I              FJPJST                          WHPJST
     I              FJPKST                          WHPKST
     I              FJRNNB                          WHRNNB
     I              FJDMTX                          WHDMTX
     I              FJDNTX                          WHDNTX
     I              FJDOTX                          WHDOTX
     I              FJWTTX                          WHWTTX
     I              FJWUTX                          WHWUTX
     I              FJRPNB                          WHRPNB
     I              FJFLAM                          WHFLAM
     I              FJXQST                          WHXQST
     I              FJRRNB                          WHRRNB
     I              FJDXTX                          WHDXTX
     I              FJDYTX                          WHDYTX
     I              FJSBNB                          WHSBNB
     I              FJBZNA                          WHBZNA
     I              FJRONB                          WHRONB
     I              FJSQNB                          WHSQNB
     I              FJR1NB                          WHR1NB
     I              FJVCST                          WHVCST
     I              FJVDST                          WHVDST
     I              FJSDNB                          WHSDNB
     I              FJPAOU                          WHPAOU
     I              FJDGWG                          WHDGWG
     I              FJSXNB                          WHSXNB
     I              FJHADT                          WHHADT
     I              FJAART                          WHAART
     I              FJDHWG                          WHDHWG
     I              FJDIWG                          WHDIWG
     I              FJAQDT                          WHAQDT
     I              FJS6NB                          WHS6NB
     I              FJT4NB                          WHT4NB
     I              FJPRTM                          WHPRTM
     I              FJNPSV                          WHNPSV
     I              FJJ8TX                          WHJ8TX
     I              FJTLMI                          WHTLMI
     I              FJJ9TX                          WHJ9TX
     I              FJQ2CD                          WHQ2CD
     I              FJVPCD                          WHVPCD
     I              FJDBCD                          WHDBCD
     I              FJGRWE                          WHGRWE
     I              FJXCCD                          WHXCCD
     I              FJU2ST                          WHU2ST
     I              FJF9DT                          WHF9DT
     I              FJONTM                          WHONTM
     I              FJJ4DT                          WHJ4DT
     I              FJTRTM                          WHTRTM
     I              FJJ5DT                          WHJ5DT
     I              FJSPTM                          WHSPTM
     I              FJJ6DT                          WHJ6DT
     I              FJLFTM                          WHLFTM
     I              FJJ7DT                          WHJ7DT
     I              FJBOTM                          WHBOTM
     I              FJJ8DT                          WHJ8DT
     I              FJBLTM                          WHBLTM
     I              FJKIDT                          WHKIDT
     I              FJASTM                          WHASTM
     I              FJKADT                          WHKADT
     I              FJAJCM                          WHAJCM
     I              FJXACD                          WHXACD
     I              FJOANA                          WHOANA
     I              FJK4TX                          WHK4TX
     I              FJVOAG                          WHVOAG
     I              FJKBDT                          WHKBDT
     I              FJNBBO                          WHNBBO
     I              FJW4CD                          WHW4CD
     I              FJEFDT                          WHEFDT
     I              FJCNTN                          WHCNTN
     I              FJKCDT                          WHKCDT
     I              FJTMIN                          WHTMIN
     I              FJKDDT                          WHKDDT
     I              FJVMNB                          WHVMNB
     I              FJOCFR                          WHOCFR
     I              FJKJDT                          WHKJDT
     I              FJATTM                          WHATTM
     I              FJOTRS                          WHOTRS
     I              FJRNST                          WHRNST
     I              FJBRBK                          WHBRBK
     I              FJEIDT                          WHEIDT
     I              FJRMST                          WHRMST
     I              FJAJCD                          WHAJCD
     I              FJKKDT                          WHKKDT
     I              FJAVTM                          WHAVTM
     I              FJKZDT                          WHKZDT
     I              FJAXTM                          WHAXTM
     I              FJLHOS                          WHLHOS
     I              FJLHOR                          WHLHOR
     I              FJWNTX                          WHWNTX
     I              FJOITX                          WHOITX
     I              FJOJTX                          WHOJTX
     I              FJLLDT                          WHLLDT
     I              FJLSHG                          WHLSHG
     I              FJYPST                          WHYPST
     I              FJK0DT                          WHK0DT
     I              FJAYTM                          WHAYTM
     I              FJKNNX                          WHKNNX
     I              FJICWG                          WHICWG
     I              FJIDWG                          WHIDWG
     I              FJH9SX                          WHH9SX
     I              FJWOTX                          WHWOTX
     I              FJK1DT                          WHK1DT
     I              FJAZTM                          WHAZTM
     I              FJK2DT                          WHK2DT
     I              FJA0TM                          WHA0TM
     I              FJROST                          WHROST
     I              FJRPST                          WHRPST
     I              FJRQST                          WHRQST
     I              FJRRST                          WHRRST
     I              FJZBVA                          WHZBVA
     I              FJWPTX                          WHWPTX
     I              FJWQTX                          WHWQTX
     I              FJWRTX                          WHWRTX
     I              FJWSTX                          WHWSTX
     I              FJRVSX                          WHRVSX
     I              FJRUSX                          WHRUSX
     I              FJRWSX                          WHRWSX
     I              FJRXSX                          WHRXSX
     I              FJRYSX                          WHRYSX
     I              FJRZSX                          WHRZSX
     I              FJR0SX                          WHR0SX
     I              FJR1SX                          WHR1SX
     I              FJR2SX                          WHR2SX
     I              FJR3SX                          WHR3SX
     I              FJR4SX                          WHR4SX
     I              FJPYDT                          WHPYDT
     I              FJCKTM                          WHCKTM
     I              FJPZDT                          WHPZDT
     I              FJCLTM                          WHCLTM
     I              FJP0DT                          WHP0DT
     I              FJCMTM                          WHCMTM
     I              FJP1DT                          WHP1DT
     I              FJCNTM                          WHCNTM
     I              FJP2DT                          WHP2DT
     I              FJCOTM                          WHCOTM
     I              FJP3DT                          WHP3DT
     I              FJCQTM                          WHCQTM
     I              FJUVST                          WHUVST
     I              FJUWST                          WHUWST
     I              FJUXST                          WHUXST
     I              FJAATM                          WHAATM
     I              FJAYNA                          WHAYNA
     I              FJA0NA                          WHA0NA
     I              FJAXDT                          WHAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WIRMNB
     I              FLRUNB                          WIRUNB
     I              FLRVNB                          WIRVNB
     I              FLDQTX                          WIDQTX
     I              FLRWNB                          WIRWNB
     I              FLRXNB                          WIRXNB
     I              FLSQNB                          WISQNB
     I              FLT0NB                          WIT0NB
     I              FLT1NB                          WIT1NB
     I              FLR1NB                          WIR1NB
     I              FLAIC3                          WIAIC3
     I              FLC4NB                          WIC4NB
     I              FLVCST                          WIVCST
     I              FLKEDT                          WIKEDT
     I              FLSXNB                          WISXNB
     I              FLKFDT                          WIKFDT
     I              FLACTM                          WIACTM
     I              FLK5TX                          WIK5TX
     I              FLW5CD                          WIW5CD
     I              FLEJDT                          WIEJDT
     I              FLAGTM                          WIAGTM
     I              FLKJDT                          WIKJDT
     I              FLATTM                          WIATTM
     I              FLHDDT                          WIHDDT
     I              FLAUTM                          WIAUTM
     I              FLKKDT                          WIKKDT
     I              FLAVTM                          WIAVTM
     I              FLZ4NB                          WIZ4NB
     I              FLY7ST                          WIY7ST
     I              FLY2ST                          WIY2ST
     I              FLWHTX                          WIWHTX
     I              FLWITX                          WIWITX
     I              FLWJTX                          WIWJTX
     I              FLWKTX                          WIWKTX
     I              FLWLTX                          WIWLTX
     I              FLN7DT                          WIN7DT
     I              FLN8DT                          WIN8DT
     I              FLN9DT                          WIN9DT
     I              FLB3TM                          WIB3TM
     I              FLB4TM                          WIB4TM
     I              FLB5TM                          WIB5TM
     I              FLIASX                          WIIASX
     I              FLIBSX                          WIIBSX
     I              FLICSX                          WIICSX
     I              FLWVTX                          WIWVTX
     I              FLWWTX                          WIWWTX
     I              FLWXTX                          WIWXTX
     I              FLUVST                          WIUVST
     I              FLUWST                          WIUWST
     I              FLUXST                          WIUXST
     I              FLAATM                          WIAATM
     I              FLAYNA                          WIAYNA
     I              FLA0NA                          WIA0NA
     I              FLAXDT                          WIAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WJRMNB
     I              FLRUNB                          WJRUNB
     I              FLRVNB                          WJRVNB
     I              FLDQTX                          WJDQTX
     I              FLRWNB                          WJRWNB
     I              FLRXNB                          WJRXNB
     I              FLSQNB                          WJSQNB
     I              FLT0NB                          WJT0NB
     I              FLT1NB                          WJT1NB
     I              FLR1NB                          WJR1NB
     I              FLAIC3                          WJAIC3
     I              FLC4NB                          WJC4NB
     I              FLVCST                          WJVCST
     I              FLKEDT                          WJKEDT
     I              FLSXNB                          WJSXNB
     I              FLKFDT                          WJKFDT
     I              FLACTM                          WJACTM
     I              FLK5TX                          WJK5TX
     I              FLW5CD                          WJW5CD
     I              FLEJDT                          WJEJDT
     I              FLAGTM                          WJAGTM
     I              FLKJDT                          WJKJDT
     I              FLATTM                          WJATTM
     I              FLHDDT                          WJHDDT
     I              FLAUTM                          WJAUTM
     I              FLKKDT                          WJKKDT
     I              FLAVTM                          WJAVTM
     I              FLZ4NB                          WJZ4NB
     I              FLY7ST                          WJY7ST
     I              FLY2ST                          WJY2ST
     I              FLWHTX                          WJWHTX
     I              FLWITX                          WJWITX
     I              FLWJTX                          WJWJTX
     I              FLWKTX                          WJWKTX
     I              FLWLTX                          WJWLTX
     I              FLN7DT                          WJN7DT
     I              FLN8DT                          WJN8DT
     I              FLN9DT                          WJN9DT
     I              FLB3TM                          WJB3TM
     I              FLB4TM                          WJB4TM
     I              FLB5TM                          WJB5TM
     I              FLIASX                          WJIASX
     I              FLIBSX                          WJIBSX
     I              FLICSX                          WJICSX
     I              FLWVTX                          WJWVTX
     I              FLWWTX                          WJWWTX
     I              FLWXTX                          WJWXTX
     I              FLUVST                          WJUVST
     I              FLUWST                          WJUWST
     I              FLUXST                          WJUXST
     I              FLAATM                          WJAATM
     I              FLAYNA                          WJAYNA
     I              FLA0NA                          WJA0NA
     I              FLAXDT                          WJAXDT
      *
     I@BFCPNQ
      * Order Header TRG          Load(Desc) not bl
      * Renamed input format fields
     I              BEAIC3                          WKAIC3
     I              BEC4NB                          WKC4NB
     I              BEJNCD                          WKJNCD
     I              BEANC7                          WKANC7
     I              BEBKC7                          WKBKC7
     I              BEBRTX                          WKBRTX
     I              BEHMNA                          WKHMNA
     I              BEHONA                          WKHONA
     I              BEHPNA                          WKHPNA
     I              BEHNNA                          WKHNNA
     I              BEDBCD                          WKDBCD
     I              BECKTX                          WKCKTX
     I              BEB0C7                          WKB0C7
     I              BEAETX                          WKAETX
     I              BEB1NA                          WKB1NA
     I              BEB3NA                          WKB3NA
     I              BEB4NA                          WKB4NA
     I              BEB2NA                          WKB2NA
     I              BEBHCD                          WKBHCD
     I              BEC8TX                          WKC8TX
     I              BEBCNA                          WKBCNA
     I              BEA0DT                          WKA0DT
     I              BEA5DT                          WKA5DT
     I              BEGNDT                          WKGNDT
     I              BEACDT                          WKACDT
     I              BEAQCD                          WKAQCD
     I              BEB6NA                          WKB6NA
     I              BEBYNA                          WKBYNA
     I              BEBZNA                          WKBZNA
     I              BEGTST                          WKGTST
     I              BEGVST                          WKGVST
     I              BEGUST                          WKGUST
     I              BEQFST                          WKQFST
     I              BECQCD                          WKCQCD
     I              BEGJST                          WKGJST
     I              BEGWST                          WKGWST
     I              BEGXST                          WKGXST
     I              BEGYST                          WKGYST
     I              BEAODT                          WKAODT
     I              BEAIVN                          WKAIVN
     I              BECXDT                          WKCXDT
     I              BEJZVA                          WKJZVA
     I              BEA1WG                          WKA1WG
     I              BEXIST                          WKXIST
     I              BEXJST                          WKXJST
     I              BEXKST                          WKXKST
     I              BEEIDT                          WKEIDT
     I              BEAFTM                          WKAFTM
     I              BEE8CD                          WKE8CD
     I              BEE9CD                          WKE9CD
     I              BERMNB                          WKRMNB
     I              BETBNB                          WKTBNB
     I              BER1NB                          WKR1NB
     I              BEPJST                          WKPJST
     I              BEU0ST                          WKU0ST
     I              BEU1ST                          WKU1ST
     I              BEQ2CD                          WKQ2CD
     I              BEU2ST                          WKU2ST
     I              BEVEST                          WKVEST
     I              BEVFST                          WKVFST
     I              BEVGST                          WKVGST
     I              BERPCD                          WKRPCD
     I              BERNNB                          WKRNNB
     I              BEVDST                          WKVDST
     I              BEATIN                          WKATIN
     I              BEU4ST                          WKU4ST
     I              BEU5ST                          WKU5ST
     I              BERSRN                          WKRSRN
     I              BEMHNA                          WKMHNA
     I              BEMINA                          WKMINA
     I              BEWBST                          WKWBST
     I              BER4CD                          WKR4CD
     I              BEBFCD                          WKBFCD
     I              BEQ4CD                          WKQ4CD
     I              BET3NB                          WKT3NB
     I              BESICD                          WKSICD
     I              BECONB                          WKCONB
     I              BECEST                          WKCEST
     I              BEAWDT                          WKAWDT
     I              BEJPCD                          WKJPCD
     I              BEXUST                          WKXUST
     I              BEZ1ST                          WKZ1ST
     I              BEVRVA                          WKVRVA
     I              BEOBST                          WKOBST
     I              BEBCST                          WKBCST
     I              BEBDST                          WKBDST
     I              BEB7VL                          WKB7VL
     I              BEGASX                          WKGASX
     I              BEGBSX                          WKGBSX
     I              BEGCSX                          WKGCSX
     I              BEGDSX                          WKGDSX
     I              BEFNSX                          WKFNSX
     I              BEFOSX                          WKFOSX
     I              BEFPSX                          WKFPSX
     I              BEFQSX                          WKFQSX
     I              BEFRSX                          WKFRSX
     I              BEFSSX                          WKFSSX
     I              BEFTSX                          WKFTSX
     I              BEFUSX                          WKFUSX
     I              BEFVSX                          WKFVSX
     I              BEFWSX                          WKFWSX
     I              BEFXSX                          WKFXSX
     I              BEFYSX                          WKFYSX
     I              BENODT                          WKNODT
     I              BENPDT                          WKNPDT
     I              BENQDT                          WKNQDT
     I              BENRDT                          WKNRDT
     I              BENSDT                          WKNSDT
     I              BEBPTM                          WKBPTM
     I              BEBQTM                          WKBQTM
     I              BEBRTM                          WKBRTM
     I              BEBSTM                          WKBSTM
     I              BEBTTM                          WKBTTM
     I              BEH0NX                          WKH0NX
     I              BEH1NX                          WKH1NX
     I              BEH2NX                          WKH2NX
     I              BEH3NX                          WKH3NX
     I              BEH4NX                          WKH4NX
     I              BEC0C7                          WKC0C7
     I              BEUVST                          WKUVST
     I              BEUWST                          WKUWST
     I              BEUXST                          WKUXST
     I              BEAATM                          WKAATM
     I              BEAYNA                          WKAYNA
     I              BEA0NA                          WKA0NA
     I              BEAXDT                          WKAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WLAIC3
     I              BEC4NB                          WLC4NB
     I              BEJNCD                          WLJNCD
     I              BEANC7                          WLANC7
     I              BEBKC7                          WLBKC7
     I              BEBRTX                          WLBRTX
     I              BEHMNA                          WLHMNA
     I              BEHONA                          WLHONA
     I              BEHPNA                          WLHPNA
     I              BEHNNA                          WLHNNA
     I              BEDBCD                          WLDBCD
     I              BECKTX                          WLCKTX
     I              BEB0C7                          WLB0C7
     I              BEAETX                          WLAETX
     I              BEB1NA                          WLB1NA
     I              BEB3NA                          WLB3NA
     I              BEB4NA                          WLB4NA
     I              BEB2NA                          WLB2NA
     I              BEBHCD                          WLBHCD
     I              BEC8TX                          WLC8TX
     I              BEBCNA                          WLBCNA
     I              BEA0DT                          WLA0DT
     I              BEA5DT                          WLA5DT
     I              BEGNDT                          WLGNDT
     I              BEACDT                          WLACDT
     I              BEAQCD                          WLAQCD
     I              BEB6NA                          WLB6NA
     I              BEBYNA                          WLBYNA
     I              BEBZNA                          WLBZNA
     I              BEGTST                          WLGTST
     I              BEGVST                          WLGVST
     I              BEGUST                          WLGUST
     I              BEQFST                          WLQFST
     I              BECQCD                          WLCQCD
     I              BEGJST                          WLGJST
     I              BEGWST                          WLGWST
     I              BEGXST                          WLGXST
     I              BEGYST                          WLGYST
     I              BEAODT                          WLAODT
     I              BEAIVN                          WLAIVN
     I              BECXDT                          WLCXDT
     I              BEJZVA                          WLJZVA
     I              BEA1WG                          WLA1WG
     I              BEXIST                          WLXIST
     I              BEXJST                          WLXJST
     I              BEXKST                          WLXKST
     I              BEEIDT                          WLEIDT
     I              BEAFTM                          WLAFTM
     I              BEE8CD                          WLE8CD
     I              BEE9CD                          WLE9CD
     I              BERMNB                          WLRMNB
     I              BETBNB                          WLTBNB
     I              BER1NB                          WLR1NB
     I              BEPJST                          WLPJST
     I              BEU0ST                          WLU0ST
     I              BEU1ST                          WLU1ST
     I              BEQ2CD                          WLQ2CD
     I              BEU2ST                          WLU2ST
     I              BEVEST                          WLVEST
     I              BEVFST                          WLVFST
     I              BEVGST                          WLVGST
     I              BERPCD                          WLRPCD
     I              BERNNB                          WLRNNB
     I              BEVDST                          WLVDST
     I              BEATIN                          WLATIN
     I              BEU4ST                          WLU4ST
     I              BEU5ST                          WLU5ST
     I              BERSRN                          WLRSRN
     I              BEMHNA                          WLMHNA
     I              BEMINA                          WLMINA
     I              BEWBST                          WLWBST
     I              BER4CD                          WLR4CD
     I              BEBFCD                          WLBFCD
     I              BEQ4CD                          WLQ4CD
     I              BET3NB                          WLT3NB
     I              BESICD                          WLSICD
     I              BECONB                          WLCONB
     I              BECEST                          WLCEST
     I              BEAWDT                          WLAWDT
     I              BEJPCD                          WLJPCD
     I              BEXUST                          WLXUST
     I              BEZ1ST                          WLZ1ST
     I              BEVRVA                          WLVRVA
     I              BEOBST                          WLOBST
     I              BEBCST                          WLBCST
     I              BEBDST                          WLBDST
     I              BEB7VL                          WLB7VL
     I              BEGASX                          WLGASX
     I              BEGBSX                          WLGBSX
     I              BEGCSX                          WLGCSX
     I              BEGDSX                          WLGDSX
     I              BEFNSX                          WLFNSX
     I              BEFOSX                          WLFOSX
     I              BEFPSX                          WLFPSX
     I              BEFQSX                          WLFQSX
     I              BEFRSX                          WLFRSX
     I              BEFSSX                          WLFSSX
     I              BEFTSX                          WLFTSX
     I              BEFUSX                          WLFUSX
     I              BEFVSX                          WLFVSX
     I              BEFWSX                          WLFWSX
     I              BEFXSX                          WLFXSX
     I              BEFYSX                          WLFYSX
     I              BENODT                          WLNODT
     I              BENPDT                          WLNPDT
     I              BENQDT                          WLNQDT
     I              BENRDT                          WLNRDT
     I              BENSDT                          WLNSDT
     I              BEBPTM                          WLBPTM
     I              BEBQTM                          WLBQTM
     I              BEBRTM                          WLBRTM
     I              BEBSTM                          WLBSTM
     I              BEBTTM                          WLBTTM
     I              BEH0NX                          WLH0NX
     I              BEH1NX                          WLH1NX
     I              BEH2NX                          WLH2NX
     I              BEH3NX                          WLH3NX
     I              BEH4NX                          WLH4NX
     I              BEC0C7                          WLC0C7
     I              BEUVST                          WLUVST
     I              BEUWST                          WLUWST
     I              BEUXST                          WLUXST
     I              BEAATM                          WLAATM
     I              BEAYNA                          WLAYNA
     I              BEA0NA                          WLA0NA
     I              BEAXDT                          WLAXDT
      *
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                          WMAIC3
     I              BEC4NB                          WMC4NB
     I              BEJNCD                          WMJNCD
     I              BEANC7                          WMANC7
     I              BEBKC7                          WMBKC7
     I              BEBRTX                          WMBRTX
     I              BEHMNA                          WMHMNA
     I              BEHONA                          WMHONA
     I              BEHPNA                          WMHPNA
     I              BEHNNA                          WMHNNA
     I              BEDBCD                          WMDBCD
     I              BECKTX                          WMCKTX
     I              BEB0C7                          WMB0C7
     I              BEAETX                          WMAETX
     I              BEB1NA                          WMB1NA
     I              BEB3NA                          WMB3NA
     I              BEB4NA                          WMB4NA
     I              BEB2NA                          WMB2NA
     I              BEBHCD                          WMBHCD
     I              BEC8TX                          WMC8TX
     I              BEBCNA                          WMBCNA
     I              BEA0DT                          WMA0DT
     I              BEA5DT                          WMA5DT
     I              BEGNDT                          WMGNDT
     I              BEACDT                          WMACDT
     I              BEAQCD                          WMAQCD
     I              BEB6NA                          WMB6NA
     I              BEBYNA                          WMBYNA
     I              BEBZNA                          WMBZNA
     I              BEGTST                          WMGTST
     I              BEGVST                          WMGVST
     I              BEGUST                          WMGUST
     I              BEQFST                          WMQFST
     I              BECQCD                          WMCQCD
     I              BEGJST                          WMGJST
     I              BEGWST                          WMGWST
     I              BEGXST                          WMGXST
     I              BEGYST                          WMGYST
     I              BEAODT                          WMAODT
     I              BEAIVN                          WMAIVN
     I              BECXDT                          WMCXDT
     I              BEJZVA                          WMJZVA
     I              BEA1WG                          WMA1WG
     I              BEXIST                          WMXIST
     I              BEXJST                          WMXJST
     I              BEXKST                          WMXKST
     I              BEEIDT                          WMEIDT
     I              BEAFTM                          WMAFTM
     I              BEE8CD                          WME8CD
     I              BEE9CD                          WME9CD
     I              BERMNB                          WMRMNB
     I              BETBNB                          WMTBNB
     I              BER1NB                          WMR1NB
     I              BEPJST                          WMPJST
     I              BEU0ST                          WMU0ST
     I              BEU1ST                          WMU1ST
     I              BEQ2CD                          WMQ2CD
     I              BEU2ST                          WMU2ST
     I              BEVEST                          WMVEST
     I              BEVFST                          WMVFST
     I              BEVGST                          WMVGST
     I              BERPCD                          WMRPCD
     I              BERNNB                          WMRNNB
     I              BEVDST                          WMVDST
     I              BEATIN                          WMATIN
     I              BEU4ST                          WMU4ST
     I              BEU5ST                          WMU5ST
     I              BERSRN                          WMRSRN
     I              BEMHNA                          WMMHNA
     I              BEMINA                          WMMINA
     I              BEWBST                          WMWBST
     I              BER4CD                          WMR4CD
     I              BEBFCD                          WMBFCD
     I              BEQ4CD                          WMQ4CD
     I              BET3NB                          WMT3NB
     I              BESICD                          WMSICD
     I              BECONB                          WMCONB
     I              BECEST                          WMCEST
     I              BEAWDT                          WMAWDT
     I              BEJPCD                          WMJPCD
     I              BEXUST                          WMXUST
     I              BEZ1ST                          WMZ1ST
     I              BEVRVA                          WMVRVA
     I              BEOBST                          WMOBST
     I              BEBCST                          WMBCST
     I              BEBDST                          WMBDST
     I              BEB7VL                          WMB7VL
     I              BEGASX                          WMGASX
     I              BEGBSX                          WMGBSX
     I              BEGCSX                          WMGCSX
     I              BEGDSX                          WMGDSX
     I              BEFNSX                          WMFNSX
     I              BEFOSX                          WMFOSX
     I              BEFPSX                          WMFPSX
     I              BEFQSX                          WMFQSX
     I              BEFRSX                          WMFRSX
     I              BEFSSX                          WMFSSX
     I              BEFTSX                          WMFTSX
     I              BEFUSX                          WMFUSX
     I              BEFVSX                          WMFVSX
     I              BEFWSX                          WMFWSX
     I              BEFXSX                          WMFXSX
     I              BEFYSX                          WMFYSX
     I              BENODT                          WMNODT
     I              BENPDT                          WMNPDT
     I              BENQDT                          WMNQDT
     I              BENRDT                          WMNRDT
     I              BENSDT                          WMNSDT
     I              BEBPTM                          WMBPTM
     I              BEBQTM                          WMBQTM
     I              BEBRTM                          WMBRTM
     I              BEBSTM                          WMBSTM
     I              BEBTTM                          WMBTTM
     I              BEH0NX                          WMH0NX
     I              BEH1NX                          WMH1NX
     I              BEH2NX                          WMH2NX
     I              BEH3NX                          WMH3NX
     I              BEH4NX                          WMH4NX
     I              BEC0C7                          WMC0C7
     I              BEUVST                          WMUVST
     I              BEUWST                          WMUWST
     I              BEUXST                          WMUXST
     I              BEAATM                          WMAATM
     I              BEAYNA                          WMAYNA
     I              BEA0NA                          WMA0NA
     I              BEAXDT                          WMAXDT
      *
     I@AFREY1
      * Calendar                  Co/Date PrdDaySts=Y
      * Renamed input format fields
     I              AFAIC3                          WOAIC3
     I              AFBCDT                          WOBCDT
     I              AFCQNB                          WOCQNB
     I              AFESNB                          WOESNB
     I              AFETNB                          WOETNB
     I              AFBZNB                          WOBZNB
     I              AFA9ST                          WOA9ST
     I              AFEINB                          WOEINB
     I              AFC5ST                          WOC5ST
     I              AFAQNB                          WOAQNB
     I              AFCMST                          WOCMST
     I              AFV9ST                          WOV9ST
     I              AFWAST                          WOWAST
     I              AFX2ST                          WOX2ST
     I              AFOJDT                          WOOJDT
     I              AFNQNX                          WONQNX
     I              AFNRNX                          WONRNX
     I              AFI9SX                          WOI9SX
     I              AFJASX                          WOJASX
     I              AFOKDT                          WOOKDT
     I              AFOLDT                          WOOLDT
     I              AFUVST                          WOUVST
     I              AFUWST                          WOUWST
     I              AFUXST                          WOUXST
     I              AFAATM                          WOAATM
     I              AFAYNA                          WOAYNA
     I              AFA0NA                          WOA0NA
     I              AFAXDT                          WOAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WRAIC3
     I              OMC4NB                          WRC4NB
     I              OMDPNB                          WRDPNB
     I              OMUENB                          WRUENB
     I              OMHGCD                          WRHGCD
     I              OMAJCD                          WRAJCD
     I              OMBKC7                          WRBKC7
     I              OMCFC7                          WRCFC7
     I              OMGMST                          WRGMST
     I              OMGNST                          WRGNST
     I              OMMAVA                          WRMAVA
     I              OMKDVA                          WRKDVA
     I              OML8VA                          WRL8VA
     I              OML9VA                          WRL9VA
     I              OMGTST                          WRGTST
     I              OMGVST                          WRGVST
     I              OMGUST                          WRGUST
     I              OMQFST                          WRQFST
     I              OMAYVA                          WRAYVA
     I              OMEXDT                          WREXDT
     I              OMLQCD                          WRLQCD
     I              OMRDCD                          WRRDCD
     I              OMQ7CD                          WRQ7CD
     I              OMBZPR                          WRBZPR
     I              OML6NB                          WRL6NB
     I              OMU1ST                          WRU1ST
     I              OMGIDT                          WRGIDT
     I              OMCRCD                          WRCRCD
     I              OMAGCD                          WRAGCD
     I              OMRZST                          WRRZST
     I              OMR0ST                          WRR0ST
     I              OMR1ST                          WRR1ST
     I              OMG7NA                          WRG7NA
     I              OMG8NA                          WRG8NA
     I              OMRPCD                          WRRPCD
     I              OMVEST                          WRVEST
     I              OMVGST                          WRVGST
     I              OMAVST                          WRAVST
     I              OMU0ST                          WRU0ST
     I              OMRFCD                          WRRFCD
     I              OMFZST                          WRFZST
     I              OMR1NB                          WRR1NB
     I              OMAVQT                          WRAVQT
     I              OMD0WG                          WRD0WG
     I              OMCCQT                          WRCCQT
     I              OMAUWG                          WRAUWG
     I              OMCBQT                          WRCBQT
     I              OMATWG                          WRATWG
     I              OMAQCS                          WRAQCS
     I              OMAGCS                          WRAGCS
     I              OMAKPR                          WRAKPR
     I              OMALPR                          WRALPR
     I              OMAUPR                          WRAUPR
     I              OMAVWG                          WRAVWG
     I              OMA4WG                          WRA4WG
     I              OMA5DT                          WRA5DT
     I              OMAODT                          WRAODT
     I              OMGNDT                          WRGNDT
     I              OMAMST                          WRAMST
     I              OMANST                          WRANST
     I              OMVAST                          WRVAST
     I              OMRGNB                          WRRGNB
     I              OMRHNB                          WRRHNB
     I              OMRINB                          WRRINB
     I              OMRBCD                          WRRBCD
     I              OMHICD                          WRHICD
     I              OMRNCD                          WRRNCD
     I              OMROCD                          WRROCD
     I              OMCXDT                          WRCXDT
     I              OMAJVN                          WRAJVN
     I              OMKXCD                          WRKXCD
     I              OMJPCD                          WRJPCD
     I              OMCQCD                          WRCQCD
     I              OMR4CD                          WRR4CD
     I              OMZ1ST                          WRZ1ST
     I              OMZ3ST                          WRZ3ST
     I              OMZ4ST                          WRZ4ST
     I              OMDUPR                          WRDUPR
     I              OMB6VL                          WRB6VL
     I              OMA1AA                          WRA1AA
     I              OMFZSX                          WRFZSX
     I              OMF0SX                          WRF0SX
     I              OMF1SX                          WRF1SX
     I              OMF2SX                          WRF2SX
     I              OMF3SX                          WRF3SX
     I              OMF4SX                          WRF4SX
     I              OMF5SX                          WRF5SX
     I              OMF6SX                          WRF6SX
     I              OMF7SX                          WRF7SX
     I              OMNTDT                          WRNTDT
     I              OMNUDT                          WRNUDT
     I              OMNVDT                          WRNVDT
     I              OMNWDT                          WRNWDT
     I              OMNXDT                          WRNXDT
     I              OMBUTM                          WRBUTM
     I              OMBVTM                          WRBVTM
     I              OMBWTM                          WRBWTM
     I              OMBXTM                          WRBXTM
     I              OMBYTM                          WRBYTM
     I              OMH5NX                          WRH5NX
     I              OMH6NX                          WRH6NX
     I              OMH7NX                          WRH7NX
     I              OMH8NX                          WRH8NX
     I              OMH9NX                          WRH9NX
     I              OMDVPR                          WRDVPR
     I              OMDWPR                          WRDWPR
     I              OMDXPR                          WRDXPR
     I              OMDYPR                          WRDYPR
     I              OMDZPR                          WRDZPR
     I              OMGSPR                          WRGSPR
     I              OMGTPR                          WRGTPR
     I              OMGUPR                          WRGUPR
     I              OMHOST                          WRHOST
     I              OMHPST                          WRHPST
     I              OMIOST                          WRIOST
     I              OMPEWG                          WRPEWG
     I              OMRINY                          WRRINY
     I              OMTIDT                          WRTIDT
     I              OMTJDT                          WRTJDT
     I              OMH2ST                          WRH2ST
     I              OMH0ST                          WRH0ST
     I              OMH1ST                          WRH1ST
     I              OMTKDT                          WRTKDT
     I              OMTLDT                          WRTLDT
     I              OMTMDT                          WRTMDT
     I              OMUVST                          WRUVST
     I              OMUWST                          WRUWST
     I              OMUXST                          WRUXST
     I              OMAATM                          WRAATM
     I              OMAYNA                          WRAYNA
     I              OMA0NA                          WRA0NA
     I              OMAXDT                          WRAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPARC        DS                             17
      * KEY : PS Production Adjustment  Co/CItm/Whs/Itm/PDte
      * I : RST Company Number
     I                                    P   1   20PAAIC3
      * I : RST PS Consumed Item Code
     I                                    P   3   60PAD8C7
      * I : RST Warehouse Code
     I                                        7   9 PAAJCD
      *
      * Outward parameters
     IPBRC        DS                              6
      * KEY : Company Item              Retrieval index       NV
      * I : RST Company Number
     I                                    P   1   20PBAIC3
      * I : RST Item Code
     I                                    P   3   60PBHGCD
      *
      * Outward parameters
     IPCRC        DS                             13
      * KEY : Order Detail Schedule     Co/Item/Whse/SchdDte
      * I : RST Company Number
     I                                    P   1   20PCAIC3
      * I : RST Item Code
     I                                    P   3   60PCHGCD
      * I : RST Warehouse Code
     I                                        7   9 PCAJCD
      *
      * Outward parameters
     IPDRC        DS                             17
      * KEY : PS Prod Item Schedule     Typ/Dte/Pwhs/Itm/Whs/Co
      * I : RST Production Type
     I                                        1   1 PDV5ST
      * I : RST Production Date
     I                                    P   2   50PDELDT
      * I : RST PS Production Warehouse
     I                                        6   8 PDB7ST
      *
      * Outward parameters
     IPERC        DS                             10
      * KEY : Order Detail              Retrieval index
      * I : RST Company Number
     I                                    P   1   20PEAIC3
      * I : RST Order Number
     I                                    P   3   60PEC4NB
      * I : RST Order Sequence Number
     I                                    P   7   80PEDPNB
      * I : RST Order Secondary Line Seq
     I                                    P   9  100PEUENB
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WEAIC3
     I              OMC4NB                          WEC4NB
     I              OMDPNB                          WEDPNB
     I              OMUENB                          WEUENB
     I              OMHGCD                          WEHGCD
     I              OMAJCD                          WEAJCD
     I              OMBKC7                          WEBKC7
     I              OMCFC7                          WECFC7
     I              OMGMST                          WEGMST
     I              OMGNST                          WEGNST
     I              OMMAVA                          WEMAVA
     I              OMKDVA                          WEKDVA
     I              OML8VA                          WEL8VA
     I              OML9VA                          WEL9VA
     I              OMGTST                          WEGTST
     I              OMGVST                          WEGVST
     I              OMGUST                          WEGUST
     I              OMQFST                          WEQFST
     I              OMAYVA                          WEAYVA
     I              OMEXDT                          WEEXDT
     I              OMLQCD                          WELQCD
     I              OMRDCD                          WERDCD
     I              OMQ7CD                          WEQ7CD
     I              OMBZPR                          WEBZPR
     I              OML6NB                          WEL6NB
     I              OMU1ST                          WEU1ST
     I              OMGIDT                          WEGIDT
     I              OMCRCD                          WECRCD
     I              OMAGCD                          WEAGCD
     I              OMRZST                          WERZST
     I              OMR0ST                          WER0ST
     I              OMR1ST                          WER1ST
     I              OMG7NA                          WEG7NA
     I              OMG8NA                          WEG8NA
     I              OMRPCD                          WERPCD
     I              OMVEST                          WEVEST
     I              OMVGST                          WEVGST
     I              OMAVST                          WEAVST
     I              OMU0ST                          WEU0ST
     I              OMRFCD                          WERFCD
     I              OMFZST                          WEFZST
     I              OMR1NB                          WER1NB
     I              OMAVQT                          WEAVQT
     I              OMD0WG                          WED0WG
     I              OMCCQT                          WECCQT
     I              OMAUWG                          WEAUWG
     I              OMCBQT                          WECBQT
     I              OMATWG                          WEATWG
     I              OMAQCS                          WEAQCS
     I              OMAGCS                          WEAGCS
     I              OMAKPR                          WEAKPR
     I              OMALPR                          WEALPR
     I              OMAUPR                          WEAUPR
     I              OMAVWG                          WEAVWG
     I              OMA4WG                          WEA4WG
     I              OMA5DT                          WEA5DT
     I              OMAODT                          WEAODT
     I              OMGNDT                          WEGNDT
     I              OMAMST                          WEAMST
     I              OMANST                          WEANST
     I              OMVAST                          WEVAST
     I              OMRGNB                          WERGNB
     I              OMRHNB                          WERHNB
     I              OMRINB                          WERINB
     I              OMRBCD                          WERBCD
     I              OMHICD                          WEHICD
     I              OMRNCD                          WERNCD
     I              OMROCD                          WEROCD
     I              OMCXDT                          WECXDT
     I              OMAJVN                          WEAJVN
     I              OMKXCD                          WEKXCD
     I              OMJPCD                          WEJPCD
     I              OMCQCD                          WECQCD
     I              OMR4CD                          WER4CD
     I              OMZ1ST                          WEZ1ST
     I              OMZ3ST                          WEZ3ST
     I              OMZ4ST                          WEZ4ST
     I              OMDUPR                          WEDUPR
     I              OMB6VL                          WEB6VL
     I              OMA1AA                          WEA1AA
     I              OMFZSX                          WEFZSX
     I              OMF0SX                          WEF0SX
     I              OMF1SX                          WEF1SX
     I              OMF2SX                          WEF2SX
     I              OMF3SX                          WEF3SX
     I              OMF4SX                          WEF4SX
     I              OMF5SX                          WEF5SX
     I              OMF6SX                          WEF6SX
     I              OMF7SX                          WEF7SX
     I              OMNTDT                          WENTDT
     I              OMNUDT                          WENUDT
     I              OMNVDT                          WENVDT
     I              OMNWDT                          WENWDT
     I              OMNXDT                          WENXDT
     I              OMBUTM                          WEBUTM
     I              OMBVTM                          WEBVTM
     I              OMBWTM                          WEBWTM
     I              OMBXTM                          WEBXTM
     I              OMBYTM                          WEBYTM
     I              OMH5NX                          WEH5NX
     I              OMH6NX                          WEH6NX
     I              OMH7NX                          WEH7NX
     I              OMH8NX                          WEH8NX
     I              OMH9NX                          WEH9NX
     I              OMDVPR                          WEDVPR
     I              OMDWPR                          WEDWPR
     I              OMDXPR                          WEDXPR
     I              OMDYPR                          WEDYPR
     I              OMDZPR                          WEDZPR
     I              OMGSPR                          WEGSPR
     I              OMGTPR                          WEGTPR
     I              OMGUPR                          WEGUPR
     I              OMHOST                          WEHOST
     I              OMHPST                          WEHPST
     I              OMIOST                          WEIOST
     I              OMPEWG                          WEPEWG
     I              OMRINY                          WERINY
     I              OMTIDT                          WETIDT
     I              OMTJDT                          WETJDT
     I              OMH2ST                          WEH2ST
     I              OMH0ST                          WEH0ST
     I              OMH1ST                          WEH1ST
     I              OMTKDT                          WETKDT
     I              OMTLDT                          WETLDT
     I              OMTMDT                          WETMDT
     I              OMUVST                          WEUVST
     I              OMUWST                          WEUWST
     I              OMUXST                          WEUXST
     I              OMAATM                          WEAATM
     I              OMAYNA                          WEAYNA
     I              OMA0NA                          WEA0NA
     I              OMAXDT                          WEAXDT
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WHRMNB
     I              FJAIC3                          WHAIC3
     I              FJAODT                          WHAODT
     I              FJPJST                          WHPJST
     I              FJPKST                          WHPKST
     I              FJRNNB                          WHRNNB
     I              FJDMTX                          WHDMTX
     I              FJDNTX                          WHDNTX
     I              FJDOTX                          WHDOTX
     I              FJWTTX                          WHWTTX
     I              FJWUTX                          WHWUTX
     I              FJRPNB                          WHRPNB
     I              FJFLAM                          WHFLAM
     I              FJXQST                          WHXQST
     I              FJRRNB                          WHRRNB
     I              FJDXTX                          WHDXTX
     I              FJDYTX                          WHDYTX
     I              FJSBNB                          WHSBNB
     I              FJBZNA                          WHBZNA
     I              FJRONB                          WHRONB
     I              FJSQNB                          WHSQNB
     I              FJR1NB                          WHR1NB
     I              FJVCST                          WHVCST
     I              FJVDST                          WHVDST
     I              FJSDNB                          WHSDNB
     I              FJPAOU                          WHPAOU
     I              FJDGWG                          WHDGWG
     I              FJSXNB                          WHSXNB
     I              FJHADT                          WHHADT
     I              FJAART                          WHAART
     I              FJDHWG                          WHDHWG
     I              FJDIWG                          WHDIWG
     I              FJAQDT                          WHAQDT
     I              FJS6NB                          WHS6NB
     I              FJT4NB                          WHT4NB
     I              FJPRTM                          WHPRTM
     I              FJNPSV                          WHNPSV
     I              FJJ8TX                          WHJ8TX
     I              FJTLMI                          WHTLMI
     I              FJJ9TX                          WHJ9TX
     I              FJQ2CD                          WHQ2CD
     I              FJVPCD                          WHVPCD
     I              FJDBCD                          WHDBCD
     I              FJGRWE                          WHGRWE
     I              FJXCCD                          WHXCCD
     I              FJU2ST                          WHU2ST
     I              FJF9DT                          WHF9DT
     I              FJONTM                          WHONTM
     I              FJJ4DT                          WHJ4DT
     I              FJTRTM                          WHTRTM
     I              FJJ5DT                          WHJ5DT
     I              FJSPTM                          WHSPTM
     I              FJJ6DT                          WHJ6DT
     I              FJLFTM                          WHLFTM
     I              FJJ7DT                          WHJ7DT
     I              FJBOTM                          WHBOTM
     I              FJJ8DT                          WHJ8DT
     I              FJBLTM                          WHBLTM
     I              FJKIDT                          WHKIDT
     I              FJASTM                          WHASTM
     I              FJKADT                          WHKADT
     I              FJAJCM                          WHAJCM
     I              FJXACD                          WHXACD
     I              FJOANA                          WHOANA
     I              FJK4TX                          WHK4TX
     I              FJVOAG                          WHVOAG
     I              FJKBDT                          WHKBDT
     I              FJNBBO                          WHNBBO
     I              FJW4CD                          WHW4CD
     I              FJEFDT                          WHEFDT
     I              FJCNTN                          WHCNTN
     I              FJKCDT                          WHKCDT
     I              FJTMIN                          WHTMIN
     I              FJKDDT                          WHKDDT
     I              FJVMNB                          WHVMNB
     I              FJOCFR                          WHOCFR
     I              FJKJDT                          WHKJDT
     I              FJATTM                          WHATTM
     I              FJOTRS                          WHOTRS
     I              FJRNST                          WHRNST
     I              FJBRBK                          WHBRBK
     I              FJEIDT                          WHEIDT
     I              FJRMST                          WHRMST
     I              FJAJCD                          WHAJCD
     I              FJKKDT                          WHKKDT
     I              FJAVTM                          WHAVTM
     I              FJKZDT                          WHKZDT
     I              FJAXTM                          WHAXTM
     I              FJLHOS                          WHLHOS
     I              FJLHOR                          WHLHOR
     I              FJWNTX                          WHWNTX
     I              FJOITX                          WHOITX
     I              FJOJTX                          WHOJTX
     I              FJLLDT                          WHLLDT
     I              FJLSHG                          WHLSHG
     I              FJYPST                          WHYPST
     I              FJK0DT                          WHK0DT
     I              FJAYTM                          WHAYTM
     I              FJKNNX                          WHKNNX
     I              FJICWG                          WHICWG
     I              FJIDWG                          WHIDWG
     I              FJH9SX                          WHH9SX
     I              FJWOTX                          WHWOTX
     I              FJK1DT                          WHK1DT
     I              FJAZTM                          WHAZTM
     I              FJK2DT                          WHK2DT
     I              FJA0TM                          WHA0TM
     I              FJROST                          WHROST
     I              FJRPST                          WHRPST
     I              FJRQST                          WHRQST
     I              FJRRST                          WHRRST
     I              FJZBVA                          WHZBVA
     I              FJWPTX                          WHWPTX
     I              FJWQTX                          WHWQTX
     I              FJWRTX                          WHWRTX
     I              FJWSTX                          WHWSTX
     I              FJRVSX                          WHRVSX
     I              FJRUSX                          WHRUSX
     I              FJRWSX                          WHRWSX
     I              FJRXSX                          WHRXSX
     I              FJRYSX                          WHRYSX
     I              FJRZSX                          WHRZSX
     I              FJR0SX                          WHR0SX
     I              FJR1SX                          WHR1SX
     I              FJR2SX                          WHR2SX
     I              FJR3SX                          WHR3SX
     I              FJR4SX                          WHR4SX
     I              FJPYDT                          WHPYDT
     I              FJCKTM                          WHCKTM
     I              FJPZDT                          WHPZDT
     I              FJCLTM                          WHCLTM
     I              FJP0DT                          WHP0DT
     I              FJCMTM                          WHCMTM
     I              FJP1DT                          WHP1DT
     I              FJCNTM                          WHCNTM
     I              FJP2DT                          WHP2DT
     I              FJCOTM                          WHCOTM
     I              FJP3DT                          WHP3DT
     I              FJCQTM                          WHCQTM
     I              FJUVST                          WHUVST
     I              FJUWST                          WHUWST
     I              FJUXST                          WHUXST
     I              FJAATM                          WHAATM
     I              FJAYNA                          WHAYNA
     I              FJA0NA                          WHA0NA
     I              FJAXDT                          WHAXDT
      *
     IYBRDCS      DS                            793
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WJRMNB
     I              FLRUNB                          WJRUNB
     I              FLRVNB                          WJRVNB
     I              FLDQTX                          WJDQTX
     I              FLRWNB                          WJRWNB
     I              FLRXNB                          WJRXNB
     I              FLSQNB                          WJSQNB
     I              FLT0NB                          WJT0NB
     I              FLT1NB                          WJT1NB
     I              FLR1NB                          WJR1NB
     I              FLAIC3                          WJAIC3
     I              FLC4NB                          WJC4NB
     I              FLVCST                          WJVCST
     I              FLKEDT                          WJKEDT
     I              FLSXNB                          WJSXNB
     I              FLKFDT                          WJKFDT
     I              FLACTM                          WJACTM
     I              FLK5TX                          WJK5TX
     I              FLW5CD                          WJW5CD
     I              FLEJDT                          WJEJDT
     I              FLAGTM                          WJAGTM
     I              FLKJDT                          WJKJDT
     I              FLATTM                          WJATTM
     I              FLHDDT                          WJHDDT
     I              FLAUTM                          WJAUTM
     I              FLKKDT                          WJKKDT
     I              FLAVTM                          WJAVTM
     I              FLZ4NB                          WJZ4NB
     I              FLY7ST                          WJY7ST
     I              FLY2ST                          WJY2ST
     I              FLWHTX                          WJWHTX
     I              FLWITX                          WJWITX
     I              FLWJTX                          WJWJTX
     I              FLWKTX                          WJWKTX
     I              FLWLTX                          WJWLTX
     I              FLN7DT                          WJN7DT
     I              FLN8DT                          WJN8DT
     I              FLN9DT                          WJN9DT
     I              FLB3TM                          WJB3TM
     I              FLB4TM                          WJB4TM
     I              FLB5TM                          WJB5TM
     I              FLIASX                          WJIASX
     I              FLIBSX                          WJIBSX
     I              FLICSX                          WJICSX
     I              FLWVTX                          WJWVTX
     I              FLWWTX                          WJWWTX
     I              FLWXTX                          WJWXTX
     I              FLUVST                          WJUVST
     I              FLUWST                          WJUWST
     I              FLUXST                          WJUXST
     I              FLAATM                          WJAATM
     I              FLAYNA                          WJAYNA
     I              FLA0NA                          WJA0NA
     I              FLAXDT                          WJAXDT
      *
     IYCRDCS      DS                            367
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WLAIC3
     I              BEC4NB                          WLC4NB
     I              BEJNCD                          WLJNCD
     I              BEANC7                          WLANC7
     I              BEBKC7                          WLBKC7
     I              BEBRTX                          WLBRTX
     I              BEHMNA                          WLHMNA
     I              BEHONA                          WLHONA
     I              BEHPNA                          WLHPNA
     I              BEHNNA                          WLHNNA
     I              BEDBCD                          WLDBCD
     I              BECKTX                          WLCKTX
     I              BEB0C7                          WLB0C7
     I              BEAETX                          WLAETX
     I              BEB1NA                          WLB1NA
     I              BEB3NA                          WLB3NA
     I              BEB4NA                          WLB4NA
     I              BEB2NA                          WLB2NA
     I              BEBHCD                          WLBHCD
     I              BEC8TX                          WLC8TX
     I              BEBCNA                          WLBCNA
     I              BEA0DT                          WLA0DT
     I              BEA5DT                          WLA5DT
     I              BEGNDT                          WLGNDT
     I              BEACDT                          WLACDT
     I              BEAQCD                          WLAQCD
     I              BEB6NA                          WLB6NA
     I              BEBYNA                          WLBYNA
     I              BEBZNA                          WLBZNA
     I              BEGTST                          WLGTST
     I              BEGVST                          WLGVST
     I              BEGUST                          WLGUST
     I              BEQFST                          WLQFST
     I              BECQCD                          WLCQCD
     I              BEGJST                          WLGJST
     I              BEGWST                          WLGWST
     I              BEGXST                          WLGXST
     I              BEGYST                          WLGYST
     I              BEAODT                          WLAODT
     I              BEAIVN                          WLAIVN
     I              BECXDT                          WLCXDT
     I              BEJZVA                          WLJZVA
     I              BEA1WG                          WLA1WG
     I              BEXIST                          WLXIST
     I              BEXJST                          WLXJST
     I              BEXKST                          WLXKST
     I              BEEIDT                          WLEIDT
     I              BEAFTM                          WLAFTM
     I              BEE8CD                          WLE8CD
     I              BEE9CD                          WLE9CD
     I              BERMNB                          WLRMNB
     I              BETBNB                          WLTBNB
     I              BER1NB                          WLR1NB
     I              BEPJST                          WLPJST
     I              BEU0ST                          WLU0ST
     I              BEU1ST                          WLU1ST
     I              BEQ2CD                          WLQ2CD
     I              BEU2ST                          WLU2ST
     I              BEVEST                          WLVEST
     I              BEVFST                          WLVFST
     I              BEVGST                          WLVGST
     I              BERPCD                          WLRPCD
     I              BERNNB                          WLRNNB
     I              BEVDST                          WLVDST
     I              BEATIN                          WLATIN
     I              BEU4ST                          WLU4ST
     I              BEU5ST                          WLU5ST
     I              BERSRN                          WLRSRN
     I              BEMHNA                          WLMHNA
     I              BEMINA                          WLMINA
     I              BEWBST                          WLWBST
     I              BER4CD                          WLR4CD
     I              BEBFCD                          WLBFCD
     I              BEQ4CD                          WLQ4CD
     I              BET3NB                          WLT3NB
     I              BESICD                          WLSICD
     I              BECONB                          WLCONB
     I              BECEST                          WLCEST
     I              BEAWDT                          WLAWDT
     I              BEJPCD                          WLJPCD
     I              BEXUST                          WLXUST
     I              BEZ1ST                          WLZ1ST
     I              BEVRVA                          WLVRVA
     I              BEOBST                          WLOBST
     I              BEBCST                          WLBCST
     I              BEBDST                          WLBDST
     I              BEB7VL                          WLB7VL
     I              BEGASX                          WLGASX
     I              BEGBSX                          WLGBSX
     I              BEGCSX                          WLGCSX
     I              BEGDSX                          WLGDSX
     I              BEFNSX                          WLFNSX
     I              BEFOSX                          WLFOSX
     I              BEFPSX                          WLFPSX
     I              BEFQSX                          WLFQSX
     I              BEFRSX                          WLFRSX
     I              BEFSSX                          WLFSSX
     I              BEFTSX                          WLFTSX
     I              BEFUSX                          WLFUSX
     I              BEFVSX                          WLFVSX
     I              BEFWSX                          WLFWSX
     I              BEFXSX                          WLFXSX
     I              BEFYSX                          WLFYSX
     I              BENODT                          WLNODT
     I              BENPDT                          WLNPDT
     I              BENQDT                          WLNQDT
     I              BENRDT                          WLNRDT
     I              BENSDT                          WLNSDT
     I              BEBPTM                          WLBPTM
     I              BEBQTM                          WLBQTM
     I              BEBRTM                          WLBRTM
     I              BEBSTM                          WLBSTM
     I              BEBTTM                          WLBTTM
     I              BEH0NX                          WLH0NX
     I              BEH1NX                          WLH1NX
     I              BEH2NX                          WLH2NX
     I              BEH3NX                          WLH3NX
     I              BEH4NX                          WLH4NX
     I              BEC0C7                          WLC0C7
     I              BEUVST                          WLUVST
     I              BEUWST                          WLUWST
     I              BEUXST                          WLUXST
     I              BEAATM                          WLAATM
     I              BEAYNA                          WLAYNA
     I              BEA0NA                          WLA0NA
     I              BEAXDT                          WLAXDT
      *
     IYDRDCS      DS                            779
      * Outward parameters
     IPFRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PFAIC3
      * I :  Order Number
     I                                    P   3   60PFC4NB
      * I :  Order Type - Sales
     I                                        7   8 PFJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PFANC7
      * I :  Ship To Customer
     I                                    P  13  160PFBKC7
      * I :  Ship To Name
     I                                       17  46 PFBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PFHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PFHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PFHPNA
      * I :  Ship To City
     I                                      137 156 PFHNNA
      * I :  Ship To State Code
     I                                      157 158 PFDBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PFCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PFB0C7
      * I :  Bill to Name
     I                                      174 203 PFAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PFB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PFB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PFB4NA
      * I :  Bill to City
     I                                      294 313 PFB2NA
      * I :  Bill to State Code
     I                                      314 315 PFBHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PFC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PFBCNA
      * I :  Order Date
     I                                    P 342 3450PFA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PFA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PFGNDT
      * I :  Cancel Date
     I                                    P 354 3570PFACDT
      * I :  Terms Code
     I                                      358 359 PFAQCD
      * I :  Special Instructions
     I                                      360 399 PFB6NA
      * I :  Special Instructions 2
     I                                      400 439 PFBYNA
      * I :  Carrier Code
     I                                      440 442 PFBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PFGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PFGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PFGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PFQFST
      * I :  Reason Code
     I                                      447 449 PFCQCD
      * I :  Order in Use
     I                                      450 450 PFGJST
      * I :  Header Status
     I                                      451 451 PFGWST
      * I :  Header Status Last
     I                                      452 452 PFGXST
      * I :  Order Type Print Status
     I                                      453 453 PFGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PFAODT
      * I :  User Original Entry
     I                                      458 467 PFAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PFCXDT
      * I :  Order Value Total
     I                                    P 472 4772PFJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PFA1WG
      * I :  Credit Hold
     I                                      484 484 PFXIST
      * I :  Production Hold
     I                                      485 485 PFXJST
      * I :  New Customer Hold
     I                                      486 486 PFXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PFEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PFAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PFE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PFE9CD
      * I :  Load ID
     I                                    P 510 5130PFRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PFTBNB
      * I :  Rated Freight
     I                                    P 517 5222PFR1NB
      * I :  LTL Flag
     I                                      523 523 PFPJST
      * I :  Price Audit
     I                                      524 524 PFU0ST
      * I :  Price Status
     I                                      525 525 PFU1ST
      * I :  Shipping Method
     I                                      526 527 PFQ2CD
      * I :  Export Status
     I                                      528 528 PFU2ST
      * I :  Palletize
     I                                      529 529 PFVEST
      * I :  Shrink Wrap
     I                                      530 530 PFVFST
      * I :  Slip Sheet
     I                                      531 531 PFVGST
      * I :  Age Code
     I                                      532 532 PFRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PFRNNB
      * I :  Load Type
     I                                      536 536 PFVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PFATIN
      * I :  Load Plan Order
     I                                      541 541 PFU4ST
      * I :  Print Pick Slip
     I                                      542 542 PFU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PFRSRN
      * I :  Special Comment 1
     I                                      547 576 PFMHNA
      * I :  Special Comment 2
     I                                      577 606 PFMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PFWBST
      * I :  Sales Route Code
     I                                      608 610 PFR4CD
      * I :  Manager Level Code
     I                                      611 612 PFBFCD
      * I :  VP Level Code
     I                                      613 615 PFQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PFT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PFSICD
      * I :  Invoice Number
     I                                    P 623 6260PFCONB
      * I :  Invoice Suffix
     I                                      627 628 PFCEST
      * I :  Invoice Date
     I                                    P 629 6320PFAWDT
      * I :  Event Code
     I                                      633 634 PFJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PFXUST
      * I :  Modified Flag
     I                                      636 636 PFZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PFVRVA
      * I :  Billing Activity Type
     I                                      643 643 PFOBST
      * I :  Block Order Flag
     I                                      644 644 PFBCST
      * I :  Order Certification Flag
     I                                      645 645 PFBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PFB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PFGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PFGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PFGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PFGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PFFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PFFOSX
      * I :  Order Emailed
     I                                      658 658 PFFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PFFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PFFRSX
      * I :  Broker Order Status
     I                                      661 661 PFFSSX
      * I :  Air Freight Order
     I                                      662 662 PFFTSX
      * I :  Order Requires Review
     I                                      663 664 PFFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PFFVSX
      * I :  Export USDA Approved
     I                                      667 668 PFFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PFFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PFFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PFNODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PFNPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PFNQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PFNRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PFNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PFBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PFBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PFBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PFBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PFBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PFH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PFH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PFH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PFH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PFH4NX
      * I :  Claim Number
     I                                    P 745 7480PFC0C7
      * I :  EDI Status 1
     I                                      749 749 PFUVST
      * I :  EDI Status 2
     I                                      750 750 PFUWST
      * I :  EDI Status 3
     I                                      751 751 PFUXST
      * I :  Job Time
     I                                    P 752 7550PFAATM
      * I :  User Id
     I                                      756 765 PFAYNA
      * I :  Job Name
     I                                      766 775 PFA0NA
      * I :  Job Date
     I                                    P 776 7790PFAXDT
      *
     IYERDCS      DS                            525
      * Outward parameters
     IPGRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PGDXNB
      * I :  Load ID
     I                                    P  11  140PGRMNB
      * I :  Stop/Drop
     I                                    P  15  170PGRVNB
      * I :  Load Change Type
     I                                       18  23 PGRVST
      * I :  Department Control Code
     I                                       24  26 PGUJST
      * I :  Change Log Prior Value
     I                                       27  38 PGMNTX
      * I :  Change Log New Value
     I                                       39  50 PGMOTX
      * I :  User Id
     I                                       51  60 PGAYNA
      * I :  Job Name
     I                                       61  70 PGA0NA
      * I :  Carrier Code
     I                                       71  73 PGBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PGXMCD
      * I :  Company Number
     I                                    P  77  780PGAIC3
      * I :  Order Number
     I                                    P  79  820PGC4NB
      *
     IYFRDCS      DS                            779
     IYGRDCS      DS                            525
     IYHRDCS      DS                            525
     IYIRDCS      DS                            525
     IYJRDCS      DS                            525
     IYKRDCS      DS                            779
     IYLRDCS      DS                            525
      * Outward parameters
     IPHRC        DS                             10
      * KEY : Order Detail              Retrieval index
      * I : RST Company Number
     I                                    P   1   20PHAIC3
      * I : RST Order Number
     I                                    P   3   60PHC4NB
      * I : RST Order Sequence Number
     I                                    P   7   80PHDPNB
      * I : RST Order Secondary Line Seq
     I                                    P   9  100PHUENB
      *
     IYMRDCS      DS                            779
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             27
      * KEY: Order Detail              CItm/PrWhs/RSD/Itm/DD+
      * I : RST Consumed Item Code
     I                                    P   1   40P1NUDT
      * I : RST Production Warehouse
     I                                        5   7 P1F6SX
     IP2PARM      DS
      * FLD: Order Detail
      * I :  Item Code
     I                                    P   1   40P2HGCD
      * N :  OD Schedule Override Sts
     I                                        5   5 P2Z4ST
     IP3PARM      DS
      * FLD: *Arrays
      * N :  Enterprise Code 1
     I                                        1   4 P3DQCD
      * N :  Enterprise Code 2
     I                                        5  16 P3DRCD
      * N :  Salesperson Code
     I                                       17  19 P3BCCD
      * N :  System Date Format
     I                                       20  22 P3B8NA
      * N :  User Profile Name
     I                                       23  32 P3AJVN
      * N :  Allow Multi-Company
     I                                       33  33 P3I6ST
      * N :  Allow Multi Warehouse
     I                                       34  34 P3I8ST
      * N :  Default Printer
     I                                       35  44 P3MPNA
      * N :  First Time Flag
     I                                       45  45 P3TAST
      * N :  Name
     I                                       46  75 P3ADTX
      * N :  System Value Alpha
     I                                       76 115 P3BXTX
      * N :  Access Denied (Y/N)
     I                                      116 116 P3WVST
      * N :  Requested Delivery Date
     I                                    P 117 1200P3EIDT
      * N :  *Initial call
     I                                      121 121 P3ICL
      * N :  Access Limited Sts USR
     I                                      122 122 P3HHST
      * N :  Live with TPM
     I                                      123 123 P3O1ST
     IP4PARM      DS
      * FLD: *Arrays
      * N :  PRT Description
     I                                        1  25 P4G3TX
      * N :  PRT Printer Device
     I                                       26  35 P4WRST
      * N :  PRT Hold Output Sts
     I                                       36  39 P4WSST
      * N :  PRT Save Output Sts
     I                                       40  43 P4WTST
      * N :  PRT Number of Copies
     I                                       44  450P4DYNB
      * N :  PRT Night Queue Run Sts
     I                                       46  46 P4WUST
      * N :  PRT Night Queue
     I                                       47  56 P4BVVN
      * N :  Hold On Jobq
     I                                       57  60 P4BDSX
      * N :  Job Log Create
     I                                       61  64 P4BESX
      * N :  Hold
     I                                       65  69 P4BCSX
      * N :  Log
     I                                       70  86 P4Y8CD
      * N :  Program name USR
     I                                       87  96 P4BMVN
      * N :  Program Name$ USR
     I                                       97 106 P4BWVN
      * N :  Application Code
     I                                      107 112 P4DNCD
      * N :  Display Prt Opt Pmt USR
     I                                      113 116 P4XFST
      * N :  Warehouse Code PASS   USR
     I                                      117 119 P4T3CD
     IP5PARM      DS
      * I :  Message USR
     I                                        1 132 P5CZT1
     IP6PARM      DS
      * FLD: *Arrays
      * N :  Kill Date
     I                                    P   1   40P6GGDT
      * N :  Kill Date CUR USR
     I                                    P   5   80P6JRDT
      * N :  Kill Date PRV USR
     I                                    P   9  120P6JQDT
      * N :  Kill Date 360 RGF
     I                                    P  13  160P6WIDT
      * N :  Kill Date 360 RGT
     I                                    P  17  200P6WJDT
      * N :  Date                  USR
     I                                    P  21  240P6MBDT
      * N :  Kill Date 440 RGF
     I                                    P  25  280P6WKDT
      * N :  Kill Date 440 RGT
     I                                    P  29  320P6WLDT
      * N :  Kill Date 960 RGF
     I                                    P  33  360P6WMDT
      * N :  Kill Date 960 RGT
     I                                    P  37  400P6WNDT
      * N :  Production Date
     I                                    P  41  440P6ELDT
      * N :  Production Date 360 RGF
     I                                    P  45  480P6WCDT
      * N :  Production Date 360 RGT
     I                                    P  49  520P6WDDT
      * N :  Production Date 440 RGF
     I                                    P  53  560P6WEDT
      * N :  Production Date 440 RGT
     I                                    P  57  600P6WFDT
      * N :  Production Date 960 RGF
     I                                    P  61  640P6WGDT
      * N :  Production Date 960 RGT
     I                                    P  65  680P6WHDT
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0001
      * Message data for 'Order has chgd since dspl'
      * *SFLSEL
     I                                        1   1 ZA0002
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0003
      * Order Number
     I                                        2   8 ZA0004
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0005
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0006
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0007
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0008
      * Load ID
     I                                    P   2   50ZA0009
      * Message data for 'Load Shipped Can't Unlock'
      * Load Status
     I                                        1   1 ZA0010
      * Message data for 'Load Picked, Unlock Inval'
      * Load Status
     I                                        1   1 ZA0011
      * Message data for 'Unlock Inval, close exist'
      * *SFLSEL
     I                                        1   1 ZA0012
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0013
      * Order Number
     I                                        2   8 ZA0014
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0015
      * Message data for 'Order Not on Prod Hold'
      * Order Number
     I                                        1   7 ZA0016
      * *SFLSEL
     I                                        8   8 ZA0017
      * Message data for 'Sch Ship Dt > Last Alc Dt'
      * Option 2 Usr
     I                                        1   2 ZA0018
      * Order Number
     I                                        3   9 ZA0019
      * Scheduled Ship Date Fmt
     I                                       10  17 ZA0020
      * Last Allocation Date Fmt
     I                                       18  25 ZA0021
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0022
      * Order Number
     I                                        2   8 ZA0023
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0024
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0025
      * Message data for 'Sch Ship Dt > Last Alc Dt'
      * Option 2 Usr
     I                                        1   2 ZA0026
      * Order Number
     I                                        3   9 ZA0027
      * Scheduled Ship Date Fmt
     I                                       10  17 ZA0028
      * Last Allocation Date Fmt
     I                                       18  25 ZA0029
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0030
      * Order Number
     I                                        2   8 ZA0031
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0032
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0033
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0034
      * Load ID
     I                                    P   2   50ZA0035
      * Message data for 'Load Shipped Can't Unlock'
      * Load Status
     I                                        1   1 ZA0036
      * Message data for 'Load Picked, Unlock Inval'
      * Load Status
     I                                        1   1 ZA0037
      * Message data for 'Unlock Inval, close exist'
      * *SFLSEL
     I                                        1   1 ZA0038
      * Message data for 'Order has chgd since dspl'
      * *SFLSEL
     I                                        1   1 ZA0039
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0040
      * Order Number
     I                                        2   8 ZA0041
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0042
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0043
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0044
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0045
      * Load ID
     I                                    P   2   50ZA0046
      * Message data for 'Load Shipped Can't Unlock'
      * Load Status
     I                                        1   1 ZA0047
      * Message data for 'Load Picked, Unlock Inval'
      * Load Status
     I                                        1   1 ZA0048
      * Message data for 'Unlock Inval, close exist'
      * *SFLSEL
     I                                        1   1 ZA0049
      * Message data for 'Sch Ship Dt > Last Alc Dt'
      * Option 2 Usr
     I                                        1   2 ZA0050
      * Order Number
     I                                        3   9 ZA0051
      * Scheduled Ship Date Fmt
     I                                       10  17 ZA0052
      * Last Allocation Date Fmt
     I                                       18  25 ZA0053
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0054
      * Order Number
     I                                        2   8 ZA0055
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0056
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0057
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0058
      * Message data for 'Order has chgd since dspl'
      * *SFLSEL
     I                                        1   1 ZA0059
      * Message data for 'Generic Message 80 ERR'
      * Generic Message 80 USR
     I                                        1  80 ZA0060
      * Message data for 'Sch Ship Dt > Last Alc Dt'
      * Option 2 Usr
     I                                        1   2 ZA0061
      * Order Number
     I                                        3   9 ZA0062
      * Scheduled Ship Date Fmt
     I                                       10  17 ZA0063
      * Last Allocation Date Fmt
     I                                       18  25 ZA0064
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0065
      * Order Number
     I                                        2   8 ZA0066
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0067
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0068
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0069
      * Production Date RGF
     I                                    P   5   80ZA0070
      * Production Date RGT
     I                                    P   9  120ZA0071
      * Quantity Ordered USR
     I                                    P  13  161ZA0072
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0073
      * Production Date RGF
     I                                    P   5   80ZA0074
      * Production Date RGT
     I                                    P   9  120ZA0075
      * Quantity Ordered USR
     I                                    P  13  161ZA0076
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0077
      * Production Date RGF
     I                                    P   5   80ZA0078
      * Production Date RGT
     I                                    P   9  120ZA0079
      * Quantity Ordered USR
     I                                    P  13  161ZA0080
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0081
      * Production Date RGF
     I                                    P   5   80ZA0082
      * Production Date RGT
     I                                    P   9  120ZA0083
      * Quantity Ordered USR
     I                                    P  13  161ZA0084
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0085
      * Production Date RGF
     I                                    P   5   80ZA0086
      * Production Date RGT
     I                                    P   9  120ZA0087
      * Quantity Ordered USR
     I                                    P  13  161ZA0088
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0089
      * Production Date RGF
     I                                    P   5   80ZA0090
      * Production Date RGT
     I                                    P   9  120ZA0091
      * Quantity Ordered USR
     I                                    P  13  161ZA0092
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0093
      * Production Date RGF
     I                                    P   5   80ZA0094
      * Production Date RGT
     I                                    P   9  120ZA0095
      * Quantity Ordered USR
     I                                    P  13  161ZA0096
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0097
      * Production Date RGF
     I                                    P   5   80ZA0098
      * Production Date RGT
     I                                    P   9  120ZA0099
      * Quantity Ordered USR
     I                                    P  13  161ZA0100
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0101
      * Production Date RGF
     I                                    P   5   80ZA0102
      * Production Date RGT
     I                                    P   9  120ZA0103
      * Quantity Ordered USR
     I                                    P  13  161ZA0104
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0105
      * Production Date RGF
     I                                    P   5   80ZA0106
      * Production Date RGT
     I                                    P   9  120ZA0107
      * Quantity Ordered USR
     I                                    P  13  161ZA0108
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0109
      * Production Date RGF
     I                                    P   5   80ZA0110
      * Production Date RGT
     I                                    P   9  120ZA0111
      * Quantity Ordered USR
     I                                    P  13  161ZA0112
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0113
      * Production Date RGF
     I                                    P   5   80ZA0114
      * Production Date RGT
     I                                    P   9  120ZA0115
      * Quantity Ordered USR
     I                                    P  13  161ZA0116
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0117
      * Message data for 'Generic Message 80 ERR'
      * Generic Message 80 USR
     I                                        1  80 ZA0118
      * Message data for 'No Order Lines-Edit Hdr'
      * *SFLSEL
     I                                        1   1 ZA0119
      * Message data for 'Order Partially Confirmed'
      * Order Number
     I                                        1   7 ZA0120
      * *SFLSEL
     I                                        8   8 ZA0121
      * Message data for 'Order in use'
      * Order Number
     I                                        1   7 ZA0122
      * Message data for 'Order can't be chgd load'
      * *SFLSEL
     I                                        1   1 ZA0123
      * Order Number
     I                                        2   8 ZA0124
      * Message data for 'Order can't be chgd load'
      * *SFLSEL
     I                                        1   1 ZA0125
      * Order Number
     I                                        2   8 ZA0126
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0127
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0128
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0129
      * Order Number
     I                                        2   8 ZA0130
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0131
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0132
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0133
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0134
      * Order Number
     I                                        2   8 ZA0135
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0136
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0137
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0138
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0139
      * Order Number
     I                                        2   8 ZA0140
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0141
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0142
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0143
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0144
      * Order Number
     I                                        2   8 ZA0145
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0146
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0147
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0148
      * Production Date RGF
     I                                    P   5   80ZA0149
      * Production Date RGT
     I                                    P   9  120ZA0150
      * Quantity Ordered USR
     I                                    P  13  161ZA0151
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0152
      * Production Date RGF
     I                                    P   5   80ZA0153
      * Production Date RGT
     I                                    P   9  120ZA0154
      * Quantity Ordered USR
     I                                    P  13  161ZA0155
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0156
      * Production Date RGF
     I                                    P   5   80ZA0157
      * Production Date RGT
     I                                    P   9  120ZA0158
      * Quantity Ordered USR
     I                                    P  13  161ZA0159
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0160
      * Production Date RGF
     I                                    P   5   80ZA0161
      * Production Date RGT
     I                                    P   9  120ZA0162
      * Quantity Ordered USR
     I                                    P  13  161ZA0163
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0164
      * Production Date RGF
     I                                    P   5   80ZA0165
      * Production Date RGT
     I                                    P   9  120ZA0166
      * Quantity Ordered USR
     I                                    P  13  161ZA0167
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0168
      * Production Date RGF
     I                                    P   5   80ZA0169
      * Production Date RGT
     I                                    P   9  120ZA0170
      * Quantity Ordered USR
     I                                    P  13  161ZA0171
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0172
      * Production Date RGF
     I                                    P   5   80ZA0173
      * Production Date RGT
     I                                    P   9  120ZA0174
      * Quantity Ordered USR
     I                                    P  13  161ZA0175
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0176
      * Production Date RGF
     I                                    P   5   80ZA0177
      * Production Date RGT
     I                                    P   9  120ZA0178
      * Quantity Ordered USR
     I                                    P  13  161ZA0179
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0180
      * Production Date RGF
     I                                    P   5   80ZA0181
      * Production Date RGT
     I                                    P   9  120ZA0182
      * Quantity Ordered USR
     I                                    P  13  161ZA0183
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0184
      * Production Date RGF
     I                                    P   5   80ZA0185
      * Production Date RGT
     I                                    P   9  120ZA0186
      * Quantity Ordered USR
     I                                    P  13  161ZA0187
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0188
      * Production Date RGF
     I                                    P   5   80ZA0189
      * Production Date RGT
     I                                    P   9  120ZA0190
      * Quantity Ordered USR
     I                                    P  13  161ZA0191
      * Message data for 'Prod Date Not In Range'
      * Production Date
     I                                    P   1   40ZA0192
      * Production Date RGF
     I                                    P   5   80ZA0193
      * Production Date RGT
     I                                    P   9  120ZA0194
      * Quantity Ordered USR
     I                                    P  13  161ZA0195
      * Message data for 'Opts invalid for plan=N'
      * *SFLSEL
     I                                        1   1 ZA0196
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0197
      * Application Code
     I                                       11  16 ZA0198
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0199
      * Application Code
     I                                       11  16 ZA0200
      * Message data for 'RTV WW Ord Prd Sch cmd 1'
      * Message data for 'RTV WW Ord Prd Sch cmd 2'
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Order Deta
     C           P2HGCD    PARM           WP0001  70       Item Code
     C           P5CZT1    PARM           WP0002132        Message USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * FP1054
      * Rtv Acct Co          RT - Warehouse  * 
     C                     EXSR SARVGN
      * Production Date
     C                     EXSR UASUBR                     Production Date
      * First Time
      * CASE: LCL.First Time Flag is Yes
     C           YL0002    IFEQ 'Y'                        *IF
     C                     Z-ADDP2HGCD    #2HGCD           Item Code
     C                     MOVEL*BLANK    #COONA           Item Desc DRV
      * Item Desc DRV
      * Rtv Item Descriptions  RT - OM Item  * 
     C                     EXSR SCRVGN
      * Rtv Base Values PA    RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0001           Company Number
     C                     Z-ADD#2NUDT    WL0002           Item Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    WUAWNA    P      Description Lin
     C                     MOVELWL0005    WUADCD    P      U/M - Primary
     C                     Z-ADDWL0006    WUAWPC           Conversion Fact
     C                     MOVELWL0007    WULXST    P      Operation Facto
     C                     MOVELWL0008    WUAECD    P      U/M - Second
     C                     Z-ADDWL0009    WUAXPC           Conversion Fact
     C                     MOVELWL0010    WULYST    P      Operation Facto
     C                     MOVELWL0011    WUAFCD    P      U/M - Third
     C                     MOVELWL0012    WUAICD    P      U/M - Pricing
     C                     Z-ADDWL0013    YL0003           Unit Weight
     C                     MOVELWL0014    WUFZST    P      Production Date
     C                     MOVELWL0015    WUAVST    P      Catch Weight St
     C                     Z-ADDWL0016    WUCHTM           Fresh Chilling
     C                     MOVELWL0017    WUQZCD    P      Base/Conv/Loss
     C                     MOVELWL0018    YL0004    P      Piece Count Ite
     C                     Z-ADDWL0019    YL0005           Pieces Per Bag
     C                     Z-ADDWL0020    YL0006           Bags Per Unit
     C                     MOVELWL0021    WUVSST    P      Record Status
     C                     MOVEL'N'       YL0002           First Time Flag
      * * Used for F9=All/Converted
     C                     MOVEL'1'       YL0007           Select 1 or 2
      * * Used for F10=All/Hold
     C                     MOVEL'N'       YL0008           Hold Order
     C                     MOVEL'Y'       YL0009           USR Display 1
     C                     END                             *FI
      * *Set Cursor: CTL.Item Code  (*Override=*NO)
     C                     Z-ADD*ZERO     W0RR0
     C                     Z-ADD014       W0ROW0
     C                     Z-ADD005       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
      * FP1054 Init to zero
     C                     Z-ADD*ZERO     #CN2QT           Qty Std Prod 1
     C                     Z-ADD*ZERO     #CN3QT           Qty Std Prod 2
     C                     Z-ADD*ZERO     #CN4QT           Qty Std Prod 3
     C                     Z-ADD*ZERO     #CN5QT           Qty Std Prod 4
     C                     Z-ADD*ZERO     #CN6QT           Qty Std Prod 5
     C                     Z-ADD*ZERO     #CN7QT           Qty Std Prod 6
      * FP1054 Rtv base avail from production warehouse
      * Rtv Base Availability RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0022           Company Number
     C                     Z-ADD#2NUDT    WL0023           Item Code
     C                     MOVEL#2F6SX    WL0024    P      Warehouse Code
     C                     Z-ADD#CFFDT    WL0025           Production Date
     C                     Z-ADD#CFFDT    WL0026           USR Day 1
     C                     Z-ADD#CE1DT    WL0027           USR Day 2
     C                     Z-ADD#CE2DT    WL0028           USR Day 3
     C                     Z-ADD#CE3DT    WL0029           USR Day 4
     C                     Z-ADD#CE4DT    WL0030           USR Day 5
     C                     Z-ADD#CE5DT    WL0031           USR Day 6
     C                     Z-ADDYL0003    WL0069           Unit Weight
     C                     MOVELYL0004    WL0070    P      Piece Count Ite
     C                     Z-ADDYL0005    WL0071           Pieces Per Bag
     C                     Z-ADDYL0006    WL0072           Bags Per Unit
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0032    #CLIQT           Qty Sched Prod
     C                     Z-ADDWL0033    #CLJQT           Qty Sched Prod
     C                     Z-ADDWL0034    #CLWQT           Qty Sched Prod
     C                     Z-ADDWL0035    #CM9QT           Qty Sched Prod
     C                     Z-ADDWL0036    #CNAQT           Qty Sched Prod
     C                     Z-ADDWL0037    #CNOQT           Qty Sched Prod
     C                     Z-ADDWL0038    #CNTQT           Qty Converted 1
     C                     Z-ADDWL0039    #CNUQT           Qty Converted 2
     C                     Z-ADDWL0040    #CNVQT           Qty Converted 3
     C                     Z-ADDWL0041    #CNWQT           Qty Converted 4
     C                     Z-ADDWL0042    #CNXQT           Qty Converted 5
     C                     Z-ADDWL0043    #CNYQT           Qty Converted 6
     C                     Z-ADDWL0044    #CLKQT           Qty Sched Ord 1
     C                     Z-ADDWL0045    #CLLQT           Qty Sched Ord 2
     C                     Z-ADDWL0046    #CLVQT           Qty Sched Ord 3
     C                     Z-ADDWL0047    #CMOQT           Qty Sched Ord 4
     C                     Z-ADDWL0048    #CMPQT           Qty Sched Ord 5
     C                     Z-ADDWL0049    #CMQQT           Qty Sched Ord 6
     C                     Z-ADDWL0050    #CMGQT           Quantity Avail
     C                     Z-ADDWL0051    #CMHQT           Quantity Avail
     C                     Z-ADDWL0052    #CMIQT           Quantity Avail
     C                     Z-ADDWL0053    #CMJQT           Quantity Avail
     C                     Z-ADDWL0054    #CMKQT           Quantity Avail
     C                     Z-ADDWL0055    #CMLQT           Quantity Avail
     C                     Z-ADDWL0056    #CN2QT           Qty Std Prod 1
     C                     Z-ADDWL0057    #CN3QT           Qty Std Prod 2
     C                     Z-ADDWL0058    #CN4QT           Qty Std Prod 3
     C                     Z-ADDWL0059    #CN5QT           Qty Std Prod 4
     C                     Z-ADDWL0060    #CN6QT           Qty Std Prod 5
     C                     Z-ADDWL0061    #CN7QT           Qty Std Prod 6
     C                     Z-ADDWL0062    #CKONB           Day 1 Inventory
     C                     Z-ADDWL0063    #CP4QT           Qty Sched Whs T
     C                     Z-ADDWL0064    #CP5QT           Qty Sched Whs T
     C                     Z-ADDWL0065    #CP6QT           Qty Sched Whs T
     C                     Z-ADDWL0066    #CP7QT           Qty Sched Whs T
     C                     Z-ADDWL0067    #CP8QT           Qty Sched Whs T
     C                     Z-ADDWL0068    #CP9QT           Qty Sched Whs T
      * Rtv Base Availability
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CTL.Item Code is Entered
      *   |- c2    : CTL.Warehouse Code is Warehouse Code not Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2HGCD    IFNE *ZERO                      *IF
     C           #2AJCD    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Base Availability RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0022           Company Number
     C                     Z-ADD#2HGCD    WL0023           Item Code
     C                     MOVEL#2AJCD    WL0024    P      Warehouse Code
     C                     Z-ADD#CFFDT    WL0025           Production Date
     C                     Z-ADD#CFFDT    WL0026           USR Day 1
     C                     Z-ADD#CE1DT    WL0027           USR Day 2
     C                     Z-ADD#CE2DT    WL0028           USR Day 3
     C                     Z-ADD#CE3DT    WL0029           USR Day 4
     C                     Z-ADD#CE4DT    WL0030           USR Day 5
     C                     Z-ADD#CE5DT    WL0031           USR Day 6
     C                     Z-ADD*ZERO     WL0069           Unit Weight
     C                     MOVELYL0023    WL0070    P      Piece Count Ite
     C                     Z-ADD*ZERO     WL0071           Pieces Per Bag
     C                     Z-ADD*ZERO     WL0072           Bags Per Unit
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0032    YL0022           Qty Sched Prod
     C                     Z-ADDWL0033    YL0022           Qty Sched Prod
     C                     Z-ADDWL0034    YL0022           Qty Sched Prod
     C                     Z-ADDWL0035    YL0022           Qty Sched Prod
     C                     Z-ADDWL0036    YL0022           Qty Sched Prod
     C                     Z-ADDWL0037    YL0022           Qty Sched Prod
     C                     Z-ADDWL0038    YL0022           Qty Converted 1
     C                     Z-ADDWL0039    YL0022           Qty Converted 2
     C                     Z-ADDWL0040    YL0022           Qty Converted 3
     C                     Z-ADDWL0041    YL0022           Qty Converted 4
     C                     Z-ADDWL0042    YL0022           Qty Converted 5
     C                     Z-ADDWL0043    YL0022           Qty Converted 6
     C                     Z-ADDWL0044    YL0022           Qty Sched Ord 1
     C                     Z-ADDWL0045    YL0022           Qty Sched Ord 2
     C                     Z-ADDWL0046    YL0022           Qty Sched Ord 3
     C                     Z-ADDWL0047    YL0022           Qty Sched Ord 4
     C                     Z-ADDWL0048    YL0022           Qty Sched Ord 5
     C                     Z-ADDWL0049    YL0022           Qty Sched Ord 6
     C                     Z-ADDWL0050    YL0022           Quantity Avail
     C                     Z-ADDWL0051    YL0022           Quantity Avail
     C                     Z-ADDWL0052    YL0022           Quantity Avail
     C                     Z-ADDWL0053    YL0022           Quantity Avail
     C                     Z-ADDWL0054    YL0022           Quantity Avail
     C                     Z-ADDWL0055    YL0022           Quantity Avail
     C                     Z-ADDWL0056    #CN2QT           Qty Std Prod 1
     C                     Z-ADDWL0057    #CN3QT           Qty Std Prod 2
     C                     Z-ADDWL0058    #CN4QT           Qty Std Prod 3
     C                     Z-ADDWL0059    #CN5QT           Qty Std Prod 4
     C                     Z-ADDWL0060    #CN6QT           Qty Std Prod 5
     C                     Z-ADDWL0061    #CN7QT           Qty Std Prod 6
     C                     Z-ADDWL0062    #CKONB           Day 1 Inventory
     C                     Z-ADDWL0063    #CP4QT           Qty Sched Whs T
     C                     Z-ADDWL0064    #CP5QT           Qty Sched Whs T
     C                     Z-ADDWL0065    #CP6QT           Qty Sched Whs T
     C                     Z-ADDWL0066    #CP7QT           Qty Sched Whs T
     C                     Z-ADDWL0067    #CP8QT           Qty Sched Whs T
     C                     Z-ADDWL0068    #CP9QT           Qty Sched Whs T
     C                     END                             *FI
      * ------------------------------------------------------
      * FP1054   Get Avail ship dates per warehouse -- 7/16/09
      * Get Avail ship dates per warehouse
      * CASE: CTL.Warehouse Code is Blanks
     C           #2AJCD    IFEQ *BLANK                     *IF
      * RTV Type/Std Chil/Chil RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#2F6SX    WL0073    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0074    YL0024    P      Warehouse Type
     C                     MOVELWL0075    YL0025    P      Warehouse Std C
     C                     Z-ADDWL0076    YL0026           Warehouse Chill
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Type/Std Chil/Chil RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#2AJCD    WL0073    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0074    YL0024    P      Warehouse Type
     C                     MOVELWL0075    YL0025    P      Warehouse Std C
     C                     Z-ADDWL0076    YL0026           Warehouse Chill
     C                     END                             *FI
      * Rtv Chill Time        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0077           Company Number
     C                     Z-ADD#2NUDT    WL0078           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0079    YL0027           Fresh Chilling
      * Chilling Time
      * CASE: LCL.Warehouse Std Chill Time is yes
     C           YL0025    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0026    YL0028           Chilling Time U
     C                     SUB  1         YL0028           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0027    YL0028           Chilling Time U
     C                     END                             *FI
      * Clc PA Avail Shp Dts  XF - Calendar  * 
     C                     CALL 'PNKRXFR'              90  Clc PA Avail Sh
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CBTC3    WQ0001  30       Accounting Comp
     C                     PARM YL0028    WQ0002  52       Warehouse Chill
     C                     PARM #CFFDT    WQ0003  70       USR Day 1
     C                     PARM #CE1DT    WQ0004  70       USR Day 2
     C                     PARM #CE2DT    WQ0005  70       USR Day 3
     C                     PARM #CE3DT    WQ0006  70       USR Day 4
     C                     PARM #CE4DT    WQ0007  70       USR Day 5
     C                     PARM #CE5DT    WQ0008  70       USR Day 6
     C           #CH6DT    PARM *ZERO     WQ0009  70       Avail Ship Date
     C           #CH7DT    PARM *ZERO     WQ0010  70       Avail Ship Date
     C           #CH8DT    PARM *ZERO     WQ0011  70       Avail Ship Date
     C           #CH9DT    PARM *ZERO     WQ0012  70       Avail Ship Date
     C           #CIADT    PARM *ZERO     WQ0013  70       Avail Ship Date
     C           #CIBDT    PARM *ZERO     WQ0014  70       Avail Ship Date
     C                     PARM YL0029    WQ0015  70       USR Day 7
     C                     PARM YL0030    WQ0016  70       USR Day 8
     C           YL0031    PARM *ZERO     WQ0017  70       Avail Ship Date
     C           YL0032    PARM *ZERO     WQ0018  70       Avail Ship Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ------------------------------------------------------
      * Check if Adjustments exists for the Base Item
     C                     EXSR UBSUBR                     Check if Adjust
     C                     Z-ADD#CRMNB    YL0033           Load ID
      * 11/13/17 DN R11918-Change Block Order Flag to input capable.
     C                     MOVEL#CBCST    YL0034           Block Order Fla
     C                     MOVEL#CPKST    YL0035           Load Status
     C                     MOVEL#CEXSX    YL0036           Sel Value 1 USR
     C                     MOVEL#CE0SX    YL0037           Sel Value 2 USR
     C                     MOVEL#CE1SX    YL0038           Sel Value 3 USR
     C                     MOVEL#CLGSX    YL0039           Sel Value 4 USR
     C                     MOVEL#CLHSX    YL0040           Sel Value 5 USR
     C                     MOVEL#CMJSX    YL0041           Sel Value 6 USR
      * All/Converted Text
      * CASE: LCL.Select 1 or 2 is Two
     C           YL0007    IFEQ '2'                        *IF
     C                     MOVEL@CN,001   #CS4TX           Text 9
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #CS4TX           Text 9
     C                     END                             *FI
      * All/Hold Text
      * CASE: LCL.Hold Order is yes
     C           YL0008    IFEQ 'Y'                        *IF
     C                     MOVEL'HOLD'    #CZ7TX           Text USR 4
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #CZ7TX           Text USR 4
     C                     END                             *FI
      * Status Flag 17 Y/N
      * CASE: LCL.Status Flag 17 Y/N is Yes
     C           YL0042    IFEQ 'Y'                        *IF
      * SFL Maintain Subfil PosUS - /UT User Source  * 
     C*   MAINTAIN SUBFILE POSITION WHERE POSSIBLE
     C           W1SFRC    IFGT *ZERO
     C                     Z-ADDW1SFRC    ##SFRC
     C                     Z-ADD##SFRC    @#SFRC
     C                     Z-ADD##SFRC    W0RR0
     C                     END
     C                     MOVEL'N'       YL0042           Status Flag 17
     C                     END                             *FI
      * E14728 - Determine Last Allocation Date
      * Same logic used in the PS Prod Schedule - UPS Bld Sched/Plan PV
      * PDRRPVR function.
      * Set Up Kill & Production Date / Kill & Production Date Ranges
     C                     EXSR UCSUBR                     Set Up Kill & P
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           OMNUDT           Consumed Item C
     C                     KFLD           OMF6SX           Production Ware
     C                     KFLD           OMA5DT           Requested Ship
     C                     KFLD           OMHGCD           Item Code
     C                     KFLD           OMNVDT           Deadline Depart
     C                     KFLD           OMBUTM           Deadline Depart
     C                     KFLD           OMC4NB           Order Number
      * Setup key
     C                     Z-ADD#2NUDT    OMNUDT
     C                     MOVEL#2F6SX    OMF6SX
     C                     Z-ADD#2A5DT    OMA5DT
     C                     Z-ADD#2HGCD    OMHGCD
     C                     Z-ADD#2NVDT    OMNVDT
     C                     Z-ADD#2BUTM    OMBUTM
     C                     Z-ADD#2C4NB    OMC4NB
     C           KPOS      SETLL@BGWKZN
     C           KRST      KLIST
     C                     KFLD           OMNUDT           Consumed Item C
     C                     KFLD           OMF6SX           Production Ware
      * Setup key
     C                     Z-ADD#2NUDT    OMNUDT
     C                     MOVEL#2F6SX    OMF6SX
     C           KRST      READE@BGWKZN                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #CSQTX    WZSQTX
     C                     MOVEL#CSQTX    WZSQTX           Company Name DR
     C           *LIKE     DEFN #CO6NA    WZO6NA
     C                     MOVEL#CO6NA    WZO6NA           Warehouse Desc
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2BUTM    WZBUTM
     C                     MOVEL#2BUTM    WZBUTM           Deadline Depart
     C           *LIKE     DEFN #2NVDT    WZNVDT
     C                     MOVEL#2NVDT    WZNVDT           Deadline Depart
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
     C           *LIKE     DEFN #2GMST    WZGMST
     C                     MOVEL#2GMST    WZGMST           Detail Line Sta
     C           *LIKE     DEFN #2RPCD    WZRPCD
     C                     MOVEL#2RPCD    WZRPCD           Age Code
     C           *LIKE     DEFN #2F6SX    WZF6SX
     C                     MOVEL#2F6SX    WZF6SX           Production Ware
     C           *LIKE     DEFN #2NUDT    WZNUDT
     C                     MOVEL#2NUDT    WZNUDT           Consumed Item C
     C           *LIKE     DEFN #COONA    WZOONA
     C                     MOVEL#COONA    WZOONA           Item Desc DRV
     C           *LIKE     DEFN #2HGCD    WZHGCD
     C                     MOVEL#2HGCD    WZHGCD           Item Code
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2AJCD    WZAJCD
     C                     MOVEL#2AJCD    WZAJCD           Warehouse Code
     C           *LIKE     DEFN #2A5DT    WZA5DT
     C                     MOVEL#2A5DT    WZA5DT           Requested Ship
     C           *LIKE     DEFN #2RINY    WZRINY
     C                     MOVEL#2RINY    WZRINY           Item Age Days
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BGWKZN                  90*
     C  N82                READ @BGWKZN                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  7
     C                     MOVEAWKIND0    *IN,43
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2AODT    IFNE *ZERO                      Scheduled Ship
     C           OMAODT    CABNE#2AODT    BB020            Scheduled Ship
     C                     END
     C           #2A5DT    IFEQ *ZERO                      Requested Ship
     C           #2HGCD    OREQ *ZERO                      Item Code
     C           #2NVDT    OREQ *ZERO                      Deadline Depart
     C           #2BUTM    IFNE *ZERO                      Deadline Depart
     C           OMBUTM    CABNE#2BUTM    BB020            Deadline Depart
     C                     END
     C                     END
     C           #2A5DT    IFEQ *ZERO                      Requested Ship
     C           #2HGCD    OREQ *ZERO                      Item Code
     C           #2NVDT    IFNE *ZERO                      Deadline Depart
     C           OMNVDT    CABNE#2NVDT    BB020            Deadline Depart
     C                     END
     C                     END
     C           #2BKC7    IFNE *ZERO                      Ship To Custome
     C           OMBKC7    CABNE#2BKC7    BB020            Ship To Custome
     C                     END
     C           #2GMST    IFNE *BLANK                     Detail Line Sta
     C           OMGMST    CABNE#2GMST    BB020            Detail Line Sta
     C                     END
     C           #2A5DT    IFEQ *ZERO                      Requested Ship
     C           #2HGCD    IFNE *ZERO                      Item Code
     C           OMHGCD    CABNE#2HGCD    BB020            Item Code
     C                     END
     C                     END
     C           #2A5DT    IFEQ *ZERO                      Requested Ship
     C           #2HGCD    OREQ *ZERO                      Item Code
     C           #2NVDT    OREQ *ZERO                      Deadline Depart
     C           #2BUTM    OREQ *ZERO                      Deadline Depart
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           OMC4NB    CABNE#2C4NB    BB020            Order Number
     C                     END
     C                     END
     C           #2AJCD    IFNE *BLANK                     Warehouse Code
     C           OMAJCD    CABNE#2AJCD    BB020            Warehouse Code
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
     C                     Z-ADD#1AVQT    #RNQQT           Quantity Ordere
     C                     Z-ADD#1CCQT    #RNRQT           Quantity Sched
     C                     MOVEL#1RPCD    #RFWST           USR Age Code
      * Rtv Load/LdSts        IF
      * ** 05/19/16   RMC E4119  remove live with tpm check
      * RTV LdId/OrdDt/ShpDt  RT - Order Header TRG  * 
     C                     EXSR SKRVGN
     C                     Z-ADDYL0046    #RRMNB           Load ID
      * CASE: LCL.Load ID is NE Blank
     C           YL0046    IFNE 0                          *IF
      * RTV LoadSts/Carrier    RT - Load Header  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
      * RTV Sales Route/OE Dt  RT - Order Header TRG  * 
     C                     EXSR SMRVGN
      * ddd/t
      * CASE: RCD.Deadline Depart Date LH is not entered
     C           #1NVDT    IFEQ *ZERO                      *IF
     C                     Z-ADDYL0047    #1NVDT           Deadline Depart
     C                     Z-ADDYL0045    #1BUTM           Deadline Depart
     C                     END                             *FI
      * * Load ID is hidden on both .ctl and .rcd
      * SEL:  Load ID
      * CASE: CTL.Load ID is NE Blank
     C           #CRMNB    IFNE *ZERO                      *IF
      * CASE: RCD.Load ID NE CTL.Load ID
     C           #RRMNB    IFNE #CRMNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Block Order Flag - 11/13/17 DN R11918-Chg to input capable.
      * CASE: CTL.Block Order Flag is *Blank
     C           #CBCST    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.Block Order Flag NE CTL.Block Order Flag
     C           #RBCST    IFNE #CBCST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Load Status
      * CASE: CTL.Load Status is *Blank
     C           #CPKST    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.Load Status NE CTL.Load Status
     C           #RPKST    IFNE #CPKST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Order Type - Sales    - only sel "OR" FP1054
      * CASE: RCD.Order Type - Sales is Regular Order
     C           #RJNCD    IFEQ 'OR'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : RCD.Order Type - Sales is Transfer Order
      *   |- c2    : RCD.OD Production Plan Sts is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RJNCD    IFEQ 'TR'                       *IF
     C           #1R1ST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  All/Converted Item Toggle
      * CASE: LCL.Select 1 or 2 is One
     C           YL0007    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: LCL.Select 1 or 2 is Two
     C           YL0007    IFEQ '2'                        *IF
      * CASE: DB1.Item Code EQ DB1.Consumed Item Code
     C           OMHGCD    IFEQ OMNUDT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Record Selected
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Rtv Order Prod Sched  RT - Order Detail Schedule  * 
     C                     EXSR SNRVGN
      * Hide Normal processing
      * CASE: RCD.OD Production Plan Sts is Yes
     C           #1R1ST    IFEQ *BLANK                     *IF
      * LCL.Date From             USR = JOB.*Job date + CON.-3 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0048
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0048
     C                     END
      * REQ   Ship Date display in YLW if order older than 3 days 8/23/19
      * CASE: RCD.Requested Ship Date LT LCL.Date From             USR
     C           #1A5DT    IFLT YL0048                     *IF
     C                     MOVEL'N'       #RYIST           Record Found -O
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       #RYIST           Record Found -O
     C                     END                             *FI
      * 4/15/09 was passing in ctl.warehouse code
      * fp1309
      *
     C                     Z-ADD*ZERO     WN0001 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
     C                     EXSR SORVGN
      * BPS Rtv Whs Info      RT - Warehouse  * 
     C                     EXSR SPRVGN
      * RTV Warehous Inv ChillRT - Warehouse  * 
     C                     EXSR SQRVGN
      * CASE: RCD.Warehouse Std Chill Time is yes
     C           #RT1ST    IFEQ 'Y'                        *IF
      * RMC 10/2/19 added S15557
     C                     Z-ADD#RBVC3    YL0049           Chill Time USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#RCHTM    YL0028           Chilling Time U
     C                     END                             *FI
      * RMC 8/23/19  use req ship date instead of scheduled ship date
      * CLC PA Age FrmToDates XF - Calendar  * 
     C                     CALL 'PNO7XFR'              90  CLC PA Age FrmT
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0019  30       Company Number
     C                     PARM YL0028    WQ0020  52       Chilling Time U
     C                     PARM #1A5DT    WQ0021  70       Scheduled Ship
     C                     PARM #REIDT    WQ0022  70       Requested Deliv
     C                     PARM #1RINY    WQ0023  40       Item Age Days
     C                     PARM #1TIDT    WQ0024  70       Production Ovr
     C                     PARM #1TJDT    WQ0025  70       Production Ovr
     C           #RGVDT    PARM #RGVDT    WQ0026  70       Production AgeD
     C           #RGWDT    PARM #RGWDT    WQ0027  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADD#RLKQT    #RLIQT           Qty Sched Prod
     C                     Z-ADD#RLLQT    #RLJQT           Qty Sched Prod
     C                     Z-ADD#RLVQT    #RLWQT           Qty Sched Prod
     C                     Z-ADD#RMOQT    #RM9QT           Qty Sched Prod
     C                     Z-ADD#RMPQT    #RNAQT           Qty Sched Prod
     C                     Z-ADD#RMQQT    #RNOQT           Qty Sched Prod
     C                     Z-ADD#RKGNX    #RL1QT           Qty 5.0 USR
     C                     Z-ADD#RN1QT    #RN0QT           Qty Prod Adj Ho
     C                     Z-ADD#RLNQT    #RLQQT           Qty Prod Adj Ho
     C                     Z-ADD#RLTQT    #RLSQT           Qty Prod Adj Ho
     C                     Z-ADD#RNDQT    #RNFQT           Qty Prod Adj Ho
     C                     Z-ADD#RNEQT    #RNGQT           Qty Prod Adj Ho
     C                     Z-ADD#RNNQT    #RNPQT           Qty Prod Adj Ho
      * Quantity Variance
      * RCD.ODS Quantity Short =
      *    *COMPUTE ((x1 + x2) - x3)
      * x1    : RCD.Production            USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : RCD.Inv Total             USR
      * -     : PGM.*Synon (15,0) work field
      * x3    : RCD.Quantity Ordered
     C           #RJ8NX    ADD  #RKGNX    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  #1AVQT    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    #RNSQT           ODS Quantity Sh
      * CASE: RCD.Record Found -OrdDtlUSR is Record Found
     C           #RYIST    IFEQ 'Y'                        *IF
      * RI:  Order Number
      * CASE: RCD.ODS Quantity Short is NE Zero
     C           #RNSQT    IFNE *ZERO                      *IF
      * CASE: RCD.Released by User Sts Y/N is yes
     C           #1F3SX    IFEQ 'Y'                        *IF
      * if user has released the line, dont show short qty or change to R
     C                     MOVEL'N'       #RHLSX           Reverse Image F
     C                     Z-ADD*ZERO     #RNSQT           ODS Quantity Sh
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       #RHLSX           Reverse Image F
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RHLSX           Reverse Image F
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Short  and Prod Hold (RED)
      * CASE:
      *  - c1ANDc2
      *   |- c1    : RCD.ODS Quantity Short is NE Zero
      *   |- c2    : RCD.Production Hold is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RNSQT    IFNE *ZERO                      *IF
     C           #RXJST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       #RHLSX           Reverse Image F
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RHLSX           Reverse Image F
     C                     Z-ADD*ZERO     #RNSQT           ODS Quantity Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDOMCCQT    #RJ8NX           Production
     C                     END                             *FI
      * CLR:  Item Code
      * CASE: LCL.Item Code NE RCD.Item Code
     C           YL0050    IFNE #1HGCD                     *IF
      * CASE: LCL.USR Display 1 is Yes
     C           YL0009    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       #RTIST           USR Display 1
     C                     MOVEL'N'       YL0009           USR Display 1
     C                     ELSE
      * CASE: LCL.USR Display 1 is No
     C           YL0009    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       #RTIST           USR Display 1
     C                     MOVEL'Y'       YL0009           USR Display 1
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD#1HGCD    YL0050           Item Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0009    #RTIST           USR Display 1
     C                     END                             *FI
      * Load ID
      * CASE: RCD.Load ID is Blank
     C           #RRMNB    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       #RZMST           Pick Status USR
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0086           PFS Load ID
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0087    #RZMST    P      Pick Status USR
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Production Date
      * CASE: CTL.Sel Value 1 USR is Select
     C           #CEXSX    IFEQ 'X'                        *IF
      * CASE: RCD.Qty Sched Ord 1 USR is EQ Zero
     C           #RLKQT    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: CTL.Sel Value 2 USR is Select
     C           #CE0SX    IFEQ 'X'                        *IF
      * CASE: RCD.Qty Sched Ord 2 USR is EQ Zero
     C           #RLLQT    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: CTL.Sel Value 3 USR is Select
     C           #CE1SX    IFEQ 'X'                        *IF
      * CASE: RCD.Qty Sched Ord 3 USR is EQ Zero
     C           #RLVQT    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: CTL.Sel Value 4 USR is Select
     C           #CLGSX    IFEQ 'X'                        *IF
      * CASE: RCD.Qty Sched Ord 4 USR is EQ Zero
     C           #RMOQT    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: CTL.Sel Value 5 USR is Select
     C           #CLHSX    IFEQ 'X'                        *IF
      * CASE: RCD.Qty Sched Ord 5 USR is EQ Zero
     C           #RMPQT    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: CTL.Sel Value 6 USR is Select
     C           #CMJSX    IFEQ 'X'                        *IF
      * CASE: RCD.Qty Sched Ord 6 USR is EQ Zero
     C           #RMQQT    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 - output for all now
      * usr update flag
      * CASE: RCD.USR Update Flag is Yes
     C           #RR4ST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #RR4ST           USR Update Flag
     C                     MOVEL'Y'       #RLISX           Output Only 1 U
      * *Set Cursor: CTL.Item Code  (*Override=*NO)
     C                     Z-ADD*ZERO     W0RR0
     C                     Z-ADD014       W0ROW0
     C                     Z-ADD005       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
     C                     MOVEL'Y'       #RLJSX           Output Only 2 U
      * OUTPUT:  Sched Qty & Adj Qty (User Model Code = Blank)
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.User Code Model is equal to blank
      *   |- c2    : LCL.User Approval USR is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0051    IFEQ *BLANK                     *IF
     C           YL0052    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Scheduled Quantity
     C                     MOVEL'Y'       #RLISX           Output Only 1 U
      * Adjustment Quantity
     C                     MOVEL'Y'       #RLJSX           Output Only 2 U
     C                     END                             *FI
      * OUTPUT:  Sched Qty (Load Status = Shipped or Invoiced)
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 ORc5
      *   |- c1    : RCD.Load Status is Shipped or Invoiced
      *   |- c2    : RCD.Pick Status USR is Picked
      *   |- c3    : RCD.Order in Use is yes
      *   |- c4    : RCD.Event Code is Picked Thru History
      *   |- c5    : RCD.OD Production Plan Sts is No
      *   '-
     C           #RPKST    IFEQ 'I'                        *IF
     C           #RPKST    OREQ 'S'
     C           #RZMST    OREQ 'Y'                        *OR
     C           #RGJST    OREQ 'Y'                        *OR
     C           #1JPCD    ORGE '03'                       *OR
     C           #1JPCD    ANDLE'07'
     C           #1R1ST    OREQ 'N'                        *OR
      * Scheduled Quantity
     C                     MOVEL'Y'       #RLISX           Output Only 1 U
      * Age code - it was on output only 1 usr - now on output only 3 usr
     C                     MOVEL'Y'       #RLKSX           Output Only 3 U
     C                     END                             *FI
      * qty sched vs. qty ord
      * CASE: RCD.Quantity Scheduled GT RCD.Quantity Ordered
     C           #1CCQT    IFGT #1AVQT                     *IF
     C                     MOVEL'Y'       #RSNST           Extra Status 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #RSNST           Extra Status 1
     C                     END                             *FI
      * highlight age days  if there is a override production dates
      * CASE: DB1.Production Ovr AgeDte Fr is not equal zero
     C           OMTIDT    IFNE *ZERO                      *IF
     C                     MOVEL'O'       #RI0ST           Override Age Da
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #RI0ST           Override Age Da
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C           KRST      READE@BGWKZN                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
      * Set SFLFOLD/SFLDROP from JOB.*Subfile mode
     C                     MOVE ZZSFM     *IN02
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Sel Value 1 USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CEXSX'  IFEQ YPMTFD
      * Sel Value 1 USR
     C                     MOVEL#CEXSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFEXSX
     C                     SELEC
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD1         ZFEXSX
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD2         ZFEXSX
     C           W0INVL    WHEQ '5'                        5
     C                     Z-ADD3         ZFEXSX
     C                     ENDSL
     C                     EXFMTZEEXSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFEXSX    WHEQ 1
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZFEXSX    WHEQ 2
     C                     MOVEL'X'       W0INVL           X
     C           ZFEXSX    WHEQ 3
     C                     MOVEL'5'       W0INVL           5
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CEXSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Sel Value 2 USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CE0SX'  IFEQ YPMTFD
      * Sel Value 2 USR
     C                     MOVEL#CE0SX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFE0SX
     C                     SELEC
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD1         ZFE0SX
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD2         ZFE0SX
     C           W0INVL    WHEQ '5'                        5
     C                     Z-ADD3         ZFE0SX
     C                     ENDSL
     C                     EXFMTZEE0SX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFE0SX    WHEQ 1
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZFE0SX    WHEQ 2
     C                     MOVEL'X'       W0INVL           X
     C           ZFE0SX    WHEQ 3
     C                     MOVEL'5'       W0INVL           5
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CE0SX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Sel Value 3 USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CE1SX'  IFEQ YPMTFD
      * Sel Value 3 USR
     C                     MOVEL#CE1SX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFE1SX
     C                     SELEC
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD1         ZFE1SX
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD2         ZFE1SX
     C           W0INVL    WHEQ '5'                        5
     C                     Z-ADD3         ZFE1SX
     C                     ENDSL
     C                     EXFMTZEE1SX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFE1SX    WHEQ 1
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZFE1SX    WHEQ 2
     C                     MOVEL'X'       W0INVL           X
     C           ZFE1SX    WHEQ 3
     C                     MOVEL'5'       W0INVL           5
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CE1SX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Sel Value 4 USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CLGSX'  IFEQ YPMTFD
      * Sel Value 4 USR
     C                     MOVEL#CLGSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFLGSX
     C                     SELEC
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD1         ZFLGSX
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD2         ZFLGSX
     C           W0INVL    WHEQ '5'                        5
     C                     Z-ADD3         ZFLGSX
     C                     ENDSL
     C                     EXFMTZELGSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFLGSX    WHEQ 1
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZFLGSX    WHEQ 2
     C                     MOVEL'X'       W0INVL           X
     C           ZFLGSX    WHEQ 3
     C                     MOVEL'5'       W0INVL           5
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CLGSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Sel Value 5 USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CLHSX'  IFEQ YPMTFD
      * Sel Value 5 USR
     C                     MOVEL#CLHSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFLHSX
     C                     SELEC
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD1         ZFLHSX
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD2         ZFLHSX
     C           W0INVL    WHEQ '5'                        5
     C                     Z-ADD3         ZFLHSX
     C                     ENDSL
     C                     EXFMTZELHSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFLHSX    WHEQ 1
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZFLHSX    WHEQ 2
     C                     MOVEL'X'       W0INVL           X
     C           ZFLHSX    WHEQ 3
     C                     MOVEL'5'       W0INVL           5
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CLHSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Sel Value 6 USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CMJSX'  IFEQ YPMTFD
      * Sel Value 6 USR
     C                     MOVEL#CMJSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFMJSX
     C                     SELEC
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD1         ZFMJSX
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD2         ZFMJSX
     C           W0INVL    WHEQ '5'                        5
     C                     Z-ADD3         ZFMJSX
     C                     ENDSL
     C                     EXFMTZEMJSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFMJSX    WHEQ 1
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZFMJSX    WHEQ 2
     C                     MOVEL'X'       W0INVL           X
     C           ZFMJSX    WHEQ 3
     C                     MOVEL'5'       W0INVL           5
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CMJSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Item Code and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2HGCD    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2HGCD           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2HGCD           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Block Order Flag
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CBCST'  IFEQ YPMTFD
      * Block Order Flag
     C                     MOVEL#CBCST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFBCST
     C                     SELEC
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD1         ZFBCST
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD2         ZFBCST
     C                     ENDSL
     C                     EXFMTZEBCST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFBCST    WHEQ 1
     C                     MOVEL'B'       W0INVL           B
     C           ZFBCST    WHEQ 2
     C                     MOVEL'F'       W0INVL           F
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CBCST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Requested Ship Date
      * External date
     C                     Z-ADDV2A5DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9942  *
     C                     END
     C                     Z-ADDXDINDT    #2A5DT
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZHGCD    CASNE#2HGCD    FBRQRL
     C           WZC4NB    CASNE#2C4NB    FBRQRL
     C           WZAJCD    CASNE#2AJCD    FBRQRL
     C           WZA5DT    CASNE#2A5DT    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
     C                     MOVEL'N'       YL0042           Status Flag 17
     C                     MOVEL'N'       YL0053           Error Status
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * F5=Refresh
      * CASE: CTL.*CMD key is *Refresh
     C           *IN05     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * F6=Create Adjustments
      * CASE: CTL.*CMD key is *Create
     C           *IN06     IFEQ '1'                        *IF
      * CASE: LCL.User Code Model is equal to blank
     C           YL0051    IFEQ *BLANK                     *IF
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Edt Prod Adjustments  DF - PS Production Adjustment  * 
     C                     CLEARPARC
     C                     Z-ADD#CBTC3    PAAIC3           Company Number
     C                     Z-ADD#2NUDT    PAD8C7           PS Consumed Ite
     C                     MOVEL#2AJCD    PAAJCD    P      Warehouse Code
      *
     C                     CALL 'PORWDFR'              90  Edt Prod Adjust
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: PS Product
     C                     PARM #2HGCD    WQ0028  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PORWDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993937*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * F7=Previous
      * CASE: CTL.*CMD key is CF07
     C           *IN07     IFEQ '1'                        *IF
      * CLC Inc/Dec Date PrdDt IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -6        IFLT 0                          *IF
     C           -6        MULT -1        WUDUF            *Duration (fact
      * CLC Date (desc) PrdDte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0088           Company Number
     C                     Z-ADD#CFFDT    WL0089           Post to G/L Dat
     C                     Z-ADD#CFFDT    WL0091           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0092           *Duration (fact
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0090    YL0001           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -6        IFGT 0                          *IF
      * CLC Date (asce) PrdDte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0093           Company Number
     C                     Z-ADD#CFFDT    WL0094           Post to G/L Dat
     C                     Z-ADD#CFFDT    WL0096           *Date2 (beginni
     C                     Z-ADD-6        WL0097           *Duration (fact
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0095    YL0001           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -6        IFEQ 0                          *IF
     C                     Z-ADD#CFFDT    YL0001           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       YL0042           Status Flag 17
      * SFL Save subfile pos   US - /UT User Source  * 
     C*   MAINTAIN SUBFILE POSITION WHERE POSSIBLE
     C           ##SFRC    IFGT *ZERO
     C                     Z-ADD##SFRC    W1SFRC  40
     C                     Z-ADD##SFRC    W0RR0
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * F8=Next
      * CASE: CTL.*CMD key is CF08
     C           *IN08     IFEQ '1'                        *IF
      * CLC Inc/Dec Date PrdDt IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           6         IFLT 0                          *IF
     C           6         MULT -1        WUDUF            *Duration (fact
      * CLC Date (desc) PrdDte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0088           Company Number
     C                     Z-ADD#CFFDT    WL0089           Post to G/L Dat
     C                     Z-ADD#CFFDT    WL0091           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0092           *Duration (fact
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0090    YL0001           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           6         IFGT 0                          *IF
      * CLC Date (asce) PrdDte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0093           Company Number
     C                     Z-ADD#CFFDT    WL0094           Post to G/L Dat
     C                     Z-ADD#CFFDT    WL0096           *Date2 (beginni
     C                     Z-ADD6         WL0097           *Duration (fact
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0095    YL0001           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           6         IFEQ 0                          *IF
     C                     Z-ADD#CFFDT    YL0001           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       YL0042           Status Flag 17
      * SFL Save subfile pos   US - /UT User Source  * 
     C*   MAINTAIN SUBFILE POSITION WHERE POSSIBLE
     C           ##SFRC    IFGT *ZERO
     C                     Z-ADD##SFRC    W1SFRC  40
     C                     Z-ADD##SFRC    W0RR0
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * F9=All/Converted Toggle
      * CASE: CTL.*CMD key is CF09
     C           *IN09     IFEQ '1'                        *IF
      * CASE: LCL.Select 1 or 2 is One
     C           YL0007    IFEQ '1'                        *IF
     C                     MOVEL'2'       YL0007           Select 1 or 2
     C                     ELSE
      * CASE: LCL.Select 1 or 2 is Two
     C           YL0007    IFEQ '2'                        *IF
     C                     MOVEL'1'       YL0007           Select 1 or 2
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * F10=All/Hold
      * CASE: CTL.*CMD key is CF10
     C           *IN10     IFEQ '1'                        *IF
      * CASE: LCL.Hold Order is blank
     C           YL0008    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       YL0008           Hold Order
     C                     ELSE
      * CASE: LCL.Hold Order is yes
     C           YL0008    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    YL0008           Hold Order
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * F11=Clear
      * CASE: CTL.*CMD key is CF11
     C           *IN11     IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     #2HGCD           Item Code
      * RMC 8/23/19  use req ship date instead of scheduled ship date
     C                     Z-ADD*ZERO     #2A5DT           Requested Ship
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
     C                     Z-ADD*ZERO     #2NVDT           Deadline Depart
     C                     Z-ADD*ZERO     #2C4NB           Order Number
     C                     Z-ADD*ZERO     #CRMNB           Load ID
     C                     MOVEL*BLANK    #CBCST           Block Order Fla
     C                     MOVEL*BLANK    #CPKST           Load Status
     C                     MOVEL*BLANK    #CEXSX           Sel Value 1 USR
     C                     MOVEL*BLANK    #CE0SX           Sel Value 2 USR
     C                     MOVEL*BLANK    #CE1SX           Sel Value 3 USR
     C                     MOVEL*BLANK    #CLGSX           Sel Value 4 USR
     C                     MOVEL*BLANK    #CLHSX           Sel Value 5 USR
     C                     MOVEL*BLANK    #CMJSX           Sel Value 6 USR
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * F15=Display Item Specifications
      * CASE: CTL.*CMD key is CF15
     C           *IN15     IFEQ '1'                        *IF
      * Dsp Item Specs        DR - Company Item  * 
     C                     CLEARPBRC
     C                     Z-ADD#CBTC3    PBAIC3           Company Number
     C                     Z-ADD#2NUDT    PBHGCD           Item Code
      *
     C                     CALL 'POQMD1R'              90  Dsp Item Specs
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Company It
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQMD1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * F16=Work With PA    Disable if Live with TPM          E004019
      * CASE: CTL.*CMD key is CF16
     C           *IN16     IFEQ '1'                        *IF
      * ** 05/19/16 RMC E4119 remove live with tpm check
      * WW Product Availablty DF - Company Item Avail Group  * 
     C                     CALL 'PDFPDFR'              90  WW Product Avai
     C                     PARM *BLANK    W0RTN   7
     C           #CBTC3    PARM #CBTC3    WQ0029  30       Company Number
     C                     PARM #2F6SX    WQ0030  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFPDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * F18=Dsp WIP Inv
      * CASE: CTL.*CMD key is CF18
     C           *IN18     IFEQ '1'                        *IF
      * CASE: CTL.WIP Item Code is Entered
     C           #CCNNB    IFNE *ZERO                      *IF
      * WW Inv Allocation     DF - Order Detail Schedule  * 
     C                     CLEARPCRC
     C                     Z-ADD#CBTC3    PCAIC3           Company Number
     C                     Z-ADD#CCNNB    PCHGCD           Item Code
     C                     MOVEL#2F6SX    PCAJCD    P      Warehouse Code
      *
     C                     CALL 'POP5DFR'              90  WW Inv Allocati
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Order Deta
     C                     PARM *ZERO     WQ0031  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POP5DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Function not available'
     C                     MOVEL'USR1942' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Day 1-Option 5
      * CASE: CTL.Sel Value 1 USR is Option 5
     C           #CEXSX    IFEQ '5'                        *IF
      * CASE: CTL.USR Day 1 EQ JOB.*Job date
     C           #CFFDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       YL0054           Production Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'P'       YL0054           Production Type
     C                     END                             *FI
      * 02/12/2009 slm FP1054 pass in production  warehouse
      * WW Production Items   DF - PS Prod Item Schedule  * 
     C                     CLEARPDRC
     C                     MOVELYL0054    PDV5ST    P      Production Type
     C                     Z-ADD#CFFDT    PDELDT           Production Date
     C                     MOVEL#2F6SX    PDB7ST    P      PS Production W
      *
     C                     CALL 'PDCWDFR'              90  WW Production I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: PS Prod It
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCWDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    #CEXSX           Sel Value 1 USR
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * Day 2-Option 5
      * CASE: CTL.Sel Value 2 USR is Option 5
     C           #CE0SX    IFEQ '5'                        *IF
      * CASE: CTL.USR Day 2 EQ JOB.*Job date
     C           #CE1DT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       YL0054           Production Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'P'       YL0054           Production Type
     C                     END                             *FI
      * WW Production Items   DF - PS Prod Item Schedule  * 
     C                     CLEARPDRC
     C                     MOVELYL0054    PDV5ST    P      Production Type
     C                     Z-ADD#CE1DT    PDELDT           Production Date
     C                     MOVEL#2F6SX    PDB7ST    P      PS Production W
      *
     C                     CALL 'PDCWDFR'              90  WW Production I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: PS Prod It
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCWDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    #CE0SX           Sel Value 2 USR
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * Day 3-Option 5
      * CASE: CTL.Sel Value 3 USR is Option 5
     C           #CE1SX    IFEQ '5'                        *IF
      * CASE: CTL.USR Day 3 EQ JOB.*Job date
     C           #CE2DT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       YL0054           Production Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'P'       YL0054           Production Type
     C                     END                             *FI
      * WW Production Items   DF - PS Prod Item Schedule  * 
     C                     CLEARPDRC
     C                     MOVELYL0054    PDV5ST    P      Production Type
     C                     Z-ADD#CE2DT    PDELDT           Production Date
     C                     MOVEL#2F6SX    PDB7ST    P      PS Production W
      *
     C                     CALL 'PDCWDFR'              90  WW Production I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: PS Prod It
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCWDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    #CE1SX           Sel Value 3 USR
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * Day 4-Option 5
      * CASE: CTL.Sel Value 4 USR is Option 5
     C           #CLGSX    IFEQ '5'                        *IF
      * CASE: CTL.USR Day 4 EQ JOB.*Job date
     C           #CE3DT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       YL0054           Production Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'P'       YL0054           Production Type
     C                     END                             *FI
      * WW Production Items   DF - PS Prod Item Schedule  * 
     C                     CLEARPDRC
     C                     MOVELYL0054    PDV5ST    P      Production Type
     C                     Z-ADD#CE3DT    PDELDT           Production Date
     C                     MOVEL#2F6SX    PDB7ST    P      PS Production W
      *
     C                     CALL 'PDCWDFR'              90  WW Production I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: PS Prod It
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCWDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    #CLGSX           Sel Value 4 USR
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * Day 5-Option 5
      * CASE: CTL.Sel Value 5 USR is Option 5
     C           #CLHSX    IFEQ '5'                        *IF
      * CASE: CTL.USR Day 5 EQ JOB.*Job date
     C           #CE4DT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       YL0054           Production Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'P'       YL0054           Production Type
     C                     END                             *FI
      * WW Production Items   DF - PS Prod Item Schedule  * 
     C                     CLEARPDRC
     C                     MOVELYL0054    PDV5ST    P      Production Type
     C                     Z-ADD#CE4DT    PDELDT           Production Date
     C                     MOVEL#2F6SX    PDB7ST    P      PS Production W
      *
     C                     CALL 'PDCWDFR'              90  WW Production I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: PS Prod It
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCWDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    #CLHSX           Sel Value 5 USR
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * Day 6-Option 5
      * CASE: CTL.Sel Value 6 USR is Option 5
     C           #CMJSX    IFEQ '5'                        *IF
      * CASE: CTL.USR Day 6 EQ JOB.*Job date
     C           #CE5DT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       YL0054           Production Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'P'       YL0054           Production Type
     C                     END                             *FI
      * WW Production Items   DF - PS Prod Item Schedule  * 
     C                     CLEARPDRC
     C                     MOVELYL0054    PDV5ST    P      Production Type
     C                     Z-ADD#CE5DT    PDELDT           Production Date
     C                     MOVEL#2F6SX    PDB7ST    P      PS Production W
      *
     C                     CALL 'PDCWDFR'              90  WW Production I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: PS Prod It
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCWDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    #CMJSX           Sel Value 6 USR
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * CHG:  CTL.Load ID -- Refresh
      * CASE: CTL.Load ID NE LCL.Load ID
     C           #CRMNB    IFNE YL0033                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * CHG:  CTL.Block Order Flag - 11/13/17 DN R11918-Chg to input capa
      * CASE: LCL.Block Order Flag NE CTL.Block Order Flag
     C           YL0034    IFNE #CBCST                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * CHG:  CTL.Load Status -- Refresh
      * CASE: LCL.Load Status NE CTL.Load Status
     C           YL0035    IFNE #CPKST                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * CHG:  CTL.Select 1
      * CASE: LCL.Sel Value 1 USR NE CTL.Sel Value 1 USR
     C           YL0036    IFNE #CEXSX                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * CHG:  CTL.Select 2
      * CASE: LCL.Sel Value 2 USR NE CTL.Sel Value 2 USR
     C           YL0037    IFNE #CE0SX                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * CHG:  CTL.Select 3
      * CASE: LCL.Sel Value 3 USR NE CTL.Sel Value 3 USR
     C           YL0038    IFNE #CE1SX                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * CHG:  CTL.Select 4
      * CASE: LCL.Sel Value 4 USR NE CTL.Sel Value 4 USR
     C           YL0039    IFNE #CLGSX                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * CHG:  CTL.Select 5
      * CASE: LCL.Sel Value 5 USR NE CTL.Sel Value 5 USR
     C           YL0040    IFNE #CLHSX                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * CHG:  CTL.Select 6
      * CASE: LCL.Sel Value 6 USR NE CTL.Sel Value 6 USR
     C           YL0041    IFNE #CMJSX                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
      * CASE: LCL.Error Status is yes
     C           YL0053    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     MOVEL'*YES'    P4XFST           Display Prt Opt
      * FP1054 chg to use CTL.production Warehouse Code
      * Rtv Base Availability RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0022           Company Number
     C                     Z-ADD#2NUDT    WL0023           Item Code
     C                     MOVEL#2F6SX    WL0024    P      Warehouse Code
     C                     Z-ADD#CFFDT    WL0025           Production Date
     C                     Z-ADD#CFFDT    WL0026           USR Day 1
     C                     Z-ADD#CE1DT    WL0027           USR Day 2
     C                     Z-ADD#CE2DT    WL0028           USR Day 3
     C                     Z-ADD#CE3DT    WL0029           USR Day 4
     C                     Z-ADD#CE4DT    WL0030           USR Day 5
     C                     Z-ADD#CE5DT    WL0031           USR Day 6
     C                     Z-ADDYL0003    WL0069           Unit Weight
     C                     MOVELYL0004    WL0070    P      Piece Count Ite
     C                     Z-ADDYL0005    WL0071           Pieces Per Bag
     C                     Z-ADDYL0006    WL0072           Bags Per Unit
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0032    #CLIQT           Qty Sched Prod
     C                     Z-ADDWL0033    #CLJQT           Qty Sched Prod
     C                     Z-ADDWL0034    #CLWQT           Qty Sched Prod
     C                     Z-ADDWL0035    #CM9QT           Qty Sched Prod
     C                     Z-ADDWL0036    #CNAQT           Qty Sched Prod
     C                     Z-ADDWL0037    #CNOQT           Qty Sched Prod
     C                     Z-ADDWL0038    #CNTQT           Qty Converted 1
     C                     Z-ADDWL0039    #CNUQT           Qty Converted 2
     C                     Z-ADDWL0040    #CNVQT           Qty Converted 3
     C                     Z-ADDWL0041    #CNWQT           Qty Converted 4
     C                     Z-ADDWL0042    #CNXQT           Qty Converted 5
     C                     Z-ADDWL0043    #CNYQT           Qty Converted 6
     C                     Z-ADDWL0044    #CLKQT           Qty Sched Ord 1
     C                     Z-ADDWL0045    #CLLQT           Qty Sched Ord 2
     C                     Z-ADDWL0046    #CLVQT           Qty Sched Ord 3
     C                     Z-ADDWL0047    #CMOQT           Qty Sched Ord 4
     C                     Z-ADDWL0048    #CMPQT           Qty Sched Ord 5
     C                     Z-ADDWL0049    #CMQQT           Qty Sched Ord 6
     C                     Z-ADDWL0050    #CMGQT           Quantity Avail
     C                     Z-ADDWL0051    #CMHQT           Quantity Avail
     C                     Z-ADDWL0052    #CMIQT           Quantity Avail
     C                     Z-ADDWL0053    #CMJQT           Quantity Avail
     C                     Z-ADDWL0054    #CMKQT           Quantity Avail
     C                     Z-ADDWL0055    #CMLQT           Quantity Avail
     C                     Z-ADDWL0056    #CN2QT           Qty Std Prod 1
     C                     Z-ADDWL0057    #CN3QT           Qty Std Prod 2
     C                     Z-ADDWL0058    #CN4QT           Qty Std Prod 3
     C                     Z-ADDWL0059    #CN5QT           Qty Std Prod 4
     C                     Z-ADDWL0060    #CN6QT           Qty Std Prod 5
     C                     Z-ADDWL0061    #CN7QT           Qty Std Prod 6
     C                     Z-ADDWL0062    #CKONB           Day 1 Inventory
     C                     Z-ADDWL0063    #CP4QT           Qty Sched Whs T
     C                     Z-ADDWL0064    #CP5QT           Qty Sched Whs T
     C                     Z-ADDWL0065    #CP6QT           Qty Sched Whs T
     C                     Z-ADDWL0066    #CP7QT           Qty Sched Whs T
     C                     Z-ADDWL0067    #CP8QT           Qty Sched Whs T
     C                     Z-ADDWL0068    #CP9QT           Qty Sched Whs T
      * Rtv Base Availability RT
      * CASE: CTL.Item Code is Entered
     C           #2HGCD    IFNE *ZERO                      *IF
      * Rtv Base Availability RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0022           Company Number
     C                     Z-ADD#2HGCD    WL0023           Item Code
     C                     MOVEL#2AJCD    WL0024    P      Warehouse Code
     C                     Z-ADD#CFFDT    WL0025           Production Date
     C                     Z-ADD#CFFDT    WL0026           USR Day 1
     C                     Z-ADD#CE1DT    WL0027           USR Day 2
     C                     Z-ADD#CE2DT    WL0028           USR Day 3
     C                     Z-ADD#CE3DT    WL0029           USR Day 4
     C                     Z-ADD#CE4DT    WL0030           USR Day 5
     C                     Z-ADD#CE5DT    WL0031           USR Day 6
     C                     Z-ADD*ZERO     WL0069           Unit Weight
     C                     MOVELYL0023    WL0070    P      Piece Count Ite
     C                     Z-ADD*ZERO     WL0071           Pieces Per Bag
     C                     Z-ADD*ZERO     WL0072           Bags Per Unit
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0032    YL0022           Qty Sched Prod
     C                     Z-ADDWL0033    YL0022           Qty Sched Prod
     C                     Z-ADDWL0034    YL0022           Qty Sched Prod
     C                     Z-ADDWL0035    YL0022           Qty Sched Prod
     C                     Z-ADDWL0036    YL0022           Qty Sched Prod
     C                     Z-ADDWL0037    YL0022           Qty Sched Prod
     C                     Z-ADDWL0038    YL0022           Qty Converted 1
     C                     Z-ADDWL0039    YL0022           Qty Converted 2
     C                     Z-ADDWL0040    YL0022           Qty Converted 3
     C                     Z-ADDWL0041    YL0022           Qty Converted 4
     C                     Z-ADDWL0042    YL0022           Qty Converted 5
     C                     Z-ADDWL0043    YL0022           Qty Converted 6
     C                     Z-ADDWL0044    YL0022           Qty Sched Ord 1
     C                     Z-ADDWL0045    YL0022           Qty Sched Ord 2
     C                     Z-ADDWL0046    YL0022           Qty Sched Ord 3
     C                     Z-ADDWL0047    YL0022           Qty Sched Ord 4
     C                     Z-ADDWL0048    YL0022           Qty Sched Ord 5
     C                     Z-ADDWL0049    YL0022           Qty Sched Ord 6
     C                     Z-ADDWL0050    YL0022           Quantity Avail
     C                     Z-ADDWL0051    YL0022           Quantity Avail
     C                     Z-ADDWL0052    YL0022           Quantity Avail
     C                     Z-ADDWL0053    YL0022           Quantity Avail
     C                     Z-ADDWL0054    YL0022           Quantity Avail
     C                     Z-ADDWL0055    YL0022           Quantity Avail
     C                     Z-ADDWL0056    #CN2QT           Qty Std Prod 1
     C                     Z-ADDWL0057    #CN3QT           Qty Std Prod 2
     C                     Z-ADDWL0058    #CN4QT           Qty Std Prod 3
     C                     Z-ADDWL0059    #CN5QT           Qty Std Prod 4
     C                     Z-ADDWL0060    #CN6QT           Qty Std Prod 5
     C                     Z-ADDWL0061    #CN7QT           Qty Std Prod 6
     C                     Z-ADDWL0062    #CKONB           Day 1 Inventory
     C                     Z-ADDWL0063    #CP4QT           Qty Sched Whs T
     C                     Z-ADDWL0064    #CP5QT           Qty Sched Whs T
     C                     Z-ADDWL0065    #CP6QT           Qty Sched Whs T
     C                     Z-ADDWL0066    #CP7QT           Qty Sched Whs T
     C                     Z-ADDWL0067    #CP8QT           Qty Sched Whs T
     C                     Z-ADDWL0068    #CP9QT           Qty Sched Whs T
     C                     END                             *FI
      * Check if Adjustments exists for the Base Item
     C                     EXSR UDSUBR                     Check if Adjust
      * ------------------------------------------------------
      * FP1054   Get Avail ship dates per warehouse -- 7/16/09
      * Get Avail ship dates per warehouse
      * CASE: CTL.Warehouse Code is Blanks
     C           #2AJCD    IFEQ *BLANK                     *IF
      * RTV Type/Std Chil/Chil RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#2F6SX    WL0073    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0074    YL0024    P      Warehouse Type
     C                     MOVELWL0075    YL0025    P      Warehouse Std C
     C                     Z-ADDWL0076    YL0026           Warehouse Chill
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Type/Std Chil/Chil RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#2AJCD    WL0073    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0074    YL0024    P      Warehouse Type
     C                     MOVELWL0075    YL0025    P      Warehouse Std C
     C                     Z-ADDWL0076    YL0026           Warehouse Chill
     C                     END                             *FI
      * Rtv Chill Time        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0077           Company Number
     C                     Z-ADD#2NUDT    WL0078           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0079    YL0027           Fresh Chilling
      * Chilling Time
      * CASE: LCL.Warehouse Std Chill Time is yes
     C           YL0025    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0026    YL0028           Chilling Time U
     C                     SUB  1         YL0028           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0027    YL0028           Chilling Time U
     C                     END                             *FI
      * Clc PA Avail Shp Dts  XF - Calendar  * 
     C                     CALL 'PNKRXFR'              90  Clc PA Avail Sh
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CBTC3    WQ0032  30       Accounting Comp
     C                     PARM YL0028    WQ0033  52       Warehouse Chill
     C                     PARM #CFFDT    WQ0034  70       USR Day 1
     C                     PARM #CE1DT    WQ0035  70       USR Day 2
     C                     PARM #CE2DT    WQ0036  70       USR Day 3
     C                     PARM #CE3DT    WQ0037  70       USR Day 4
     C                     PARM #CE4DT    WQ0038  70       USR Day 5
     C                     PARM #CE5DT    WQ0039  70       USR Day 6
     C           #CH6DT    PARM *ZERO     WQ0040  70       Avail Ship Date
     C           #CH7DT    PARM *ZERO     WQ0041  70       Avail Ship Date
     C           #CH8DT    PARM *ZERO     WQ0042  70       Avail Ship Date
     C           #CH9DT    PARM *ZERO     WQ0043  70       Avail Ship Date
     C           #CIADT    PARM *ZERO     WQ0044  70       Avail Ship Date
     C           #CIBDT    PARM *ZERO     WQ0045  70       Avail Ship Date
     C                     PARM YL0029    WQ0046  70       USR Day 7
     C                     PARM YL0030    WQ0047  70       USR Day 8
     C           YL0031    PARM *ZERO     WQ0048  70       Avail Ship Date
     C           YL0032    PARM *ZERO     WQ0049  70       Avail Ship Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,43
     C                     SETOF                     98    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
     C                     MOVEL'N'       YL0055           Post Flag USR
     C                     MOVEL'N'       YL0056           *Reload subfile
      * 5=Display Order
      * CASE: RCD.*SFLSEL is Option 5
     C           #1SEL     IFEQ ' 5'                       *IF
     C           #1SEL     OREQ '5'
      * DSP Ord Inquiry Detail DF - Order Detail  * 
     C                     CALL 'PDPZDFR'              90  DSP Ord Inquiry
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0050  30       Company Number
     C                     PARM #1C4NB    WQ0051  70       Order Number
     C           YL0057    PARM *ZERO     WQ0052  30       Order Sequence
     C           YL0058    PARM *ZERO     WQ0053  30       Order Secondary
     C           YL0059    PARM YL0059    WQ0054  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPZDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 7=Dsp Consmd Itm
      * CASE: RCD.*SFLSEL is Option 7
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * WW OrdDtl Sch-Consmd  DF - Order Detail Sched-Consmd  * 
     C                     CALL 'POQGDFR'              90  WW OrdDtl Sch-C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CBTC3    WQ0055  30       Company Number
     C                     PARM #1C4NB    WQ0056  70       Order Number
     C                     PARM #1AJCD    WQ0057  3        Warehouse Code
     C                     PARM #1HGCD    WQ0058  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQGDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 8=Item Warehouse Inquiry Detail
      * CASE: RCD.*SFLSEL is Option 8
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
     C                     MOVEL'Y'       YL0060           *Initial call
      * Rtv Lot Tracking Flag RT - Warehouse  * 
     C                     EXSR SURVGN
      * CASE: LCL.Lot Tracking Flag is yes
     C           YL0061    IFEQ 'Y'                        *IF
      * Dsp Item Lot Locs     DF - Item Lot Location  * 
     C                     CALL 'PDH2DFR'              90  Dsp Item Lot Lo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0059  30       Company Number
     C                     PARM #1HGCD    WQ0060  70       Item Code
     C                     PARM #1AJCD    WQ0061  3        Warehouse Code
     C                     PARM *ZERO     WQ0062  70       Production Date
     C           YL0060    PARM YL0060    WQ0063  1        *Initial call
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDH2DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Dsp Item/Whse Inqy Dtl DF - Item Balance Detail  * 
     C                     CALL 'ICQ9DFR'              90  Dsp Item/Whse I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0064  30       Company Number
     C                     PARM #1HGCD    WQ0065  70       Item Code
     C                     PARM #1G7NA    WQ0066 30        Description Lin
     C                     PARM #RADCD    WQ0067  2        U/M - Primary
     C                     PARM YL0062    WQ0068  94       Conversion Fact
     C                     PARM YL0063    WQ0069  1        Operation Facto
     C                     PARM YL0064    WQ0070  2        U/M - Second
     C                     PARM YL0065    WQ0071  94       Conversion Fact
     C                     PARM YL0066    WQ0072  1        Operation Facto
     C                     PARM YL0067    WQ0073  2        U/M - Third
     C                     PARM #RAIWG    WQ0074 112       Unit Weight
     C                     PARM #1FZST    WQ0075  1        Production Date
     C                     PARM #1AVST    WQ0076  1        Catch Weight St
     C                     PARM #1AJCD    WQ0077  3        Warehouse Code
     C                     PARM YL0068    WQ0078 30        Warehouse Descr
     C                     PARM YL0069    WQ0079 30        Name
     C           YL0060    PARM YL0060    WQ0080  1        *Initial call
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ICQ9DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 9=Dsp Prod Sched
      * CASE: RCD.*SFLSEL is Option 9
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
      * Dsp Order Sched Pdctn DF - Order Detail Schedule  * 
     C                     CALL 'PDFMDFR'              90  Dsp Order Sched
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0081  30       Company Number
     C                     PARM #1C4NB    WQ0082  70       Order Number
     C                     PARM #1DPNB    WQ0083  30       Order Sequence
     C                     PARM #1UENB    WQ0084  30       Order Secondary
     C                     PARM #1AJCD    WQ0085  3        Warehouse Code
     C                     PARM #1HGCD    WQ0086  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFMDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 24=Dsp Age Days
      * CASE: RCD.*SFLSEL is Option 24
     C           #1SEL     IFEQ '24'                       *IF
      * Dsp Age Information   DR - Order Detail  * 
     C                     CLEARPERC
     C                     Z-ADD#1AIC3    PEAIC3           Company Number
     C                     Z-ADD#1C4NB    PEC4NB           Order Number
     C                     Z-ADD#1DPNB    PEDPNB           Order Sequence
     C                     Z-ADD#1UENB    PEUENB           Order Secondary
      *
     C                     CALL 'PNQ0D1R'              90  Dsp Age Informa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             KEY: Order Deta
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQ0D1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 10=Work With Inventory Allocation
      * CASE: RCD.*SFLSEL is Option 10
     C           #1SEL     IFEQ '10'                       *IF
      * WW Inv Allocation     DF - Order Detail Schedule  * 
     C                     CLEARPCRC
     C                     Z-ADD#1AIC3    PCAIC3           Company Number
     C                     Z-ADD#1HGCD    PCHGCD           Item Code
     C                     MOVEL#1AJCD    PCAJCD    P      Warehouse Code
      *
     C                     CALL 'POP5DFR'              90  WW Inv Allocati
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Order Deta
     C                     PARM #1C4NB    WQ0087  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POP5DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 13=Display Load
      * CASE: RCD.*SFLSEL is Option 13
     C           #1SEL     IFEQ '13'                       *IF
      * ** 05/19/16 RMC E4119 remove live with tpm check
      * WW Orders on Load      DF - Load Detail  * 
     C                     CALL 'PDODDFR'              90  WW Orders on Lo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0088  70       Load ID
     C           YL0070    PARM YL0070    WQ0089 112       USR Weight Accu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDODDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 15=Display Item Specifications
      * CASE: RCD.*SFLSEL is Option 15
     C           #1SEL     IFEQ '15'                       *IF
      * Dsp Item Specs        DR - Company Item  * 
     C                     CLEARPBRC
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1HGCD    PBHGCD           Item Code
      *
     C                     CALL 'POQMD1R'              90  Dsp Item Specs
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Company It
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQMD1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * F90  ONLY for people that know about it
     C                     EXSR UESUBR                     F90  ONLY for p
     C                     MOVEL'N'       P3WVST           Access Denied (
      * OD Production Plan Sts (All additional options)
      * CASE: RCD.OD Production Plan Sts is Yes
     C           #1R1ST    IFEQ *BLANK                     *IF
      * Upd Options - (12,14,17,18,19)
      * CASE: Update allowed options
      *  - c1 AND c2
      *   |- c1    : PAR.Access Denied (Y/N) is yes
      *   |- c2    : RCD.*SFLSEL is PPS Update 2
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3WVST    IFEQ 'Y'                        *IF
     C           #1SEL     IFEQ '14'                       *IF
     C           #1SEL     OREQ '17'
     C           #1SEL     OREQ '19'
     C           #1SEL     OREQ '12'
     C           #1SEL     OREQ '18'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0001           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.*SFLSEL is PPS Update 2
     C           #1SEL     IFEQ '14'                       *IF
     C           #1SEL     OREQ '17'
     C           #1SEL     OREQ '19'
     C           #1SEL     OREQ '12'
     C           #1SEL     OREQ '18'
      * RTV for PA update val2RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0098           Company Number
     C                     Z-ADD#1C4NB    WL0099           Order Number
     C                     Z-ADD#1DPNB    WL0100           Order Sequence
     C                     Z-ADD#1UENB    WL0101           Order Secondary
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0102    YL0071    P      Warehouse Code
     C                     MOVELWL0103    YL0072    P      OD Production P
     C                     Z-ADDWL0104    YL0073           Quantity Schedu
     C                     Z-ADDWL0105    YL0074           Weight Schedule
     C                     MOVELWL0106    YL0075    P      OD Schedule Ove
     C                     MOVELWL0107    YL0076    P      OD Adj Type Ove
     C                     Z-ADDWL0108    YL0077           Item Age Days
     C                     Z-ADDWL0109    YL0078           Production Ovr
     C                     Z-ADDWL0110    YL0079           Production Ovr
      * If something has changed, dont allow option
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8
      *   |- c1    : RCD.Warehouse Code NE LCL.Warehouse Code SavUsr
      *   |- c2    : RCD.Weight Scheduled NE LCL.Weight Scheduled USR
      *   |- c3    : RCD.Quantity Scheduled NE LCL.Quantity Scheduled 1 U
      *   |- c4    : RCD.OD Schedule Override Sts NE LCL.OD Schedule Over
      *   |- c5    : RCD.OD Adj Type Override NE LCL.OD Adj Type Override
      *   |- c6    : RCD.Item Age Days NE LCL.Item Age Days
      *   |- c7    : RCD.Production Ovr AgeDte Fr NE LCL.Production Ovr A
      *   |- c8    : RCD.Production Ovr AgeDte To NE LCL.Production Ovr A
      *   '-
     C           #1AJCD    IFNE YL0071                     *IF
     C           #1AUWG    ORNE YL0074                     *OR
     C           #1CCQT    ORNE YL0073                     *OR
     C           #1Z4ST    ORNE YL0075                     *OR
     C           #1FZSX    ORNE YL0076                     *OR
     C           #1RINY    ORNE YL0077                     *OR
     C           #1TIDT    ORNE YL0078                     *OR
     C           #1TJDT    ORNE YL0079                     *OR
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0002           *SFLSEL
      * Send message 'Order has chgd since dspl'
     C                     MOVEL'USR4173' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * 12=Chg ship date                      W288 changes
      * CASE: RCD.*SFLSEL is Option 12
     C           #1SEL     IFEQ '12'                       *IF
      * ** 05/19/16 RMC E4119 remove live with tpm check
      * RTV Order in Use       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0111           Company Number
     C                     Z-ADD#1C4NB    WL0112           Order Number
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0113    YL0080    P      Order in Use
     C                     MOVELWL0114    YL0081    P      Header Status
     C                     Z-ADDWL0115    #RRMNB           Load ID
      * LCL.Job Date Usr = JOB.*Job date + CON.7 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD7         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0082
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0082
     C                     END
      * val order stuff
      * CASE: LCL.Order in Use is yes
     C           YL0080    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0003           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0004           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0004           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: LCL.Header Status is Cancelled
     C           YL0081    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0005           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * val load stuff
      * CASE: RCD.Load ID is GT Zero
     C           #RRMNB    IFGT *ZERO                      *IF
      * Validate
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #RPKST    IFEQ 'I'                        *IF
     C           #RPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0006           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : RCD.Load Status is Lock
      *   |- c2    : RCD.Requested Ship Date LE LCL.Job Date Usr
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RPKST    IFEQ 'L'                        *IF
     C           #1A5DT    IFLE YL0082                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 8/23/19 compare to REQ instead of Scheduled ship date
      * if ship date is within 7 days, then dont allow
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0007           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: RCD.Load Status is Lock
     C           #RPKST    IFEQ 'L'                        *IF
      *
     C                     MOVEL*BLANK    WN0128  1        Load Status
     C                     MOVEL*BLANK    WN0129  1        Block Order Fla
      *
      * EDT Unlock Load Edit   IF
      * RTV Load Status        RT - OM Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0116           Load ID
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0117    WN0128    P      Load Status
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0118           Load ID
     C                     MOVELWN0129    WL0120    P      Block Order Fla
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0119    WUJDST    P      USR Check Y/N S
     C                     MOVELWL0120    WN0129    P      Block Order Fla
      * RMC PFS017 6/5/6 new par.allow unlock if picked = N
      *
     C                     MOVEL*BLANK    WN0130  1        Access Denied (
      *
      * EDT Unlock Load Edits  IF
      * assume will have error
     C                     MOVEL'Y'       YL0053           Error Status
      *
     C                     MOVEL*BLANK    WN0131 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0131           User Profile Na
      *
     C                     MOVEL*BLANK    WN0132 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0131    WL0121    P      User Profile Na
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0122    WUG0TX    P      Allow Multi-Com
     C                     MOVELWL0123    WUG0TX    P      Default Printer
     C                     MOVELWL0124    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0125    YL0083           Company Number
     C                     MOVELWL0126    WN0132    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,004                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0132    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0131    WL0127    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0128    P      Application Cod
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0129    WUAIC3           Company Number
     C                     MOVELWL0130    YL0084    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0132    WL0127    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0128    P      Application Cod
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0129    WUAIC3           Company Number
     C                     MOVELWL0130    YL0084    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0084    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0083    IFGT 0                          *IF
     C                     Z-ADDYL0083    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0084    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0085    WL0132           Shipping Compan
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0131    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0130           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0133           Company Number
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0134    WUG0TX    P      Name
     C                     END                             *FI
      * check the entry control field too.  4/28/05 so christa can do.
      * Rtv Unlock Load Authr RT - Entry Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0135    P      User Profile Na
     C                     MOVEL'O/P'     WL0136    P      Application Cod
     C                     Z-ADD#1AIC3    WL0137           Company Number
     C                     EXSR TFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0138    WUHTST    P      Unlock Load Aut
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Access Denied (Y/N) is yes
      *   |- c2    : WRK.Unlock Load Authority is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0130    IFEQ 'Y'                        *IF
     C           WUHTST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'User Cant Lock/Unlock Ld'
     C                     MOVEL'USR2468' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If load has been shipped, can't unlock. RMC Chg for picked 5/31/0
      * CASE: PAR.Block Order Flag is Block Order
     C           WN0129    IFEQ 'B'                        *IF
      *   (load contains a block order)
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0008           *SFLSEL
     C                     Z-ADD#RRMNB    ZA0009           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           WN0128    IFEQ 'I'                        *IF
     C           WN0128    OREQ 'S'
      * Setup message data for message
     C                     MOVELWN0128    ZA0010           Load Status
      * Send message 'Load Shipped Can't Unlock'
     C                     MOVEL'USR1272' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * **** Determine if Load has been picked, if yes do not allow unloc
      * **** This function checks OP Order Events & AS Picked Acknowledgm
      * CASE: PAR.Allow Unlock if Picked St is No
     C           'N'       IFEQ 'N'                        *IF
      * Do this one if par is NO. We dont want an UNLOCK if there are XOx
      *   and it isnt shipping doing it.
      * RTV Load Order Picked  XF - AS Order Header  * 
     C                     CALL 'PDQVXFR'              90  RTV Load Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0098  70       Load ID
     C                     PARM #1AIC3    WQ0099  30       Company Number
     C           WUZMST    PARM WUZMST    WQ0100  1        Pick Status USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0086           PFS Load ID
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0087    WUZMST    P      Pick Status USR
     C                     END                             *FI
      * Allow if picked but not Close Order or Close Truck  5/31/06
      * CASE: WRK.Pick Status USR is Picked
     C           WUZMST    IFEQ 'Y'                        *IF
      * CASE: PAR.Allow Unlock if Picked St is No
     C           'N'       IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVELWN0128    ZA0011           Load Status
      * Send message 'Load Picked, Unlock Inval'
     C                     MOVEL'USR1999' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Close Ord/Trk XF - PFS Ship Load/Order Sts  * 
     C                     CALL 'PPYIXFR'              90  PFS Val Close O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0101  70       Load ID
     C           WUB8ST    PARM *BLANK    WQ0102  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0012           *SFLSEL
      * Send message 'Unlock Inval, close exist'
     C                     MOVEL'USR3629' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       YL0053           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       YL0053           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Clr Program Message Q  US - /UT User Source  * 
      * CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
      * RESET FIRST MESSAGE ONLY FLAG.
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Error Status is no
     C           YL0053    IFEQ 'N'                        *IF
      * Auto Unlock after validations are passed
      * CASE: RCD.Load Status is Lock
     C           #RPKST    IFEQ 'L'                        *IF
      *
     C                     MOVEL*BLANK    WN0133  3        Shipping Line
     C                     MOVEL*BLANK    WN0134 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0135  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0136  1        USR Status (Y/N
      *
      * UPD Unlock Load Update IF
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0139           Load ID
     C                     MOVEL'U'       WL0140    P      Load Status
     C                     Z-ADD*ZERO     WL0141           Rated Freight
     C                     EXSR TGCHRC
      *
     C                     MOVEL*BLANK    WN0280  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0281  1        USR Status (Y/N
     C                     Z-ADD*ZERO     WN0282  90       GAF Customer Nu
     C                     MOVEL*BLANK    WN0283  3        GAF Function
      *
      * EDT Unlock Load        IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0142           Load ID
     C                     EXSR THRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0143    WN0280    P      Trans Contol AS
      * RTV System Value Alpha RT - System Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL@CN,005   WL0144    P      System Value Co
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0145    YL0086    P      System Value Al
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0146           PFS Company Num
     C                     MOVEL'LDORDD'  WL0147    P      PFS Interface C
     C                     EXSR TMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0148    YL0087    P      PFS AccuSort Ac
     C                     MOVELWL0149    YL0088    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0087    IFEQ 'Y'                        *IF
      * Notify Accusort if locked load
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0280    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0103  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * DEL AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQ0XFR'              90  DEL AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0104  70       Load ID
     C                     PARM #1AIC3    WQ0105  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQ0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0106  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0088    IFEQ 'Y'                        *IF
      * PFS Unlock Load/Order XF - PFS Load Header  * 
     C                     CALL 'PPNQXFR'              90  PFS Unlock Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0107  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0108  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** 09/23/2011 RMC E1607  if load had a whs with edi wso interchan
      *    delete it if Unproc, else change it to "D"elete/and reprocess
      * Exc ChgDel EDI f/UnlckXF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PBAEXFR'              90  Exc ChgDel EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0109  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBAEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Clear Rated Frt    RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0150           Load ID
     C                     Z-ADD*ZERO     WL0151           Stop/Drop Seque
     C                     EXSR TNRVGN
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     MOVEL'UNLOCK'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPGRC
     C                     Z-ADD#RRMNB    PGRMNB           Load ID
     C                     Z-ADD*ZERO     PGRVNB           Stop/Drop
     C                     MOVELWURVST    PGRVST    P      Load Change Typ
     C                     MOVELWUUJST    PGUJST    P      Department Cont
     C                     MOVEL#RPKST    PGMNTX    P      Change Log Prio
     C                     MOVEL'U'       PGMOTX    P      Change Log New
     C                     MOVEL##USR     PGAYNA    P      User Id
     C                     MOVEL##PGM     PGA0NA    P      Job Name
     C                     MOVEL#RBZNA    PGBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PGAIC3           Company Number
     C                     Z-ADD*ZERO     PGC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** Add order number to pass to the Edit Load/Orders   E00438
      * ** Add Access Limited flag                           W288
      * Edt Load/Orders        DF - Order Header TRG  * 
     C                     CALL 'PDLTDFR'              90  Edt Load/Orders
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1C4NB    WQ0110  70       Order Number
     C                     PARM #RRMNB    WQ0111  70       Load ID
     C                     PARM #1AODT    WQ0112  70       Scheduled Ship
     C                     PARM WUADTX    WQ0113 30        Name
     C                     PARM P3HHST    WQ0114  1        Access Limited
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLTDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * reload subfile because order can have more than 1 item on this sc
      *  and we want the date/whse to show as changed for them all
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Add Access Limited flag                           W288
      * EDT Schd Shp Dte/Whse  E1 - Order Header TRG  * 
     C                     CALL 'PDLQE1R'              90  EDT Schd Shp Dt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0115  30       Company Number
     C                     PARM #1C4NB    WQ0116  70       Order Number
     C                     PARM P3HHST    WQ0117  1        Access Limited
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLQE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * reload subfile because order can have more than 1 item on this sc
      *  and we want the date/whse to show as changed for them all
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 14=Release Order
      * CASE: RCD.*SFLSEL is Option 14
     C           #1SEL     IFEQ '14'                       *IF
      * RTV Order in Use       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0111           Company Number
     C                     Z-ADD#1C4NB    WL0112           Order Number
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0113    YL0080    P      Order in Use
     C                     MOVELWL0114    YL0081    P      Header Status
     C                     Z-ADDWL0115    #RRMNB           Load ID
      * CASE: LCL.Order in Use is yes
     C           YL0080    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0013           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0014           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0014           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: LCL.Header Status is Cancelled
     C           YL0081    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0015           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: RCD.Production Hold is No
     C           #RXJST    IFEQ 'N'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0016           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0016           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1SEL     ZA0017           *SFLSEL
      * Send message 'Order Not on Prod Hold'
     C                     MOVEL'USR1922' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RXJST           Production Hold
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     MOVEL'N'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * E14784 - Disallow 17 if Orders Scheduled Ship Date GT Last Alloc
      * 17=Reallocate  - with lock check-> 10/14/13 dont do lock check
      * CASE: RCD.*SFLSEL is Option 17
     C           #1SEL     IFEQ '17'                       *IF
      * CASE:
      *  - (c1 AND c2) OR (c3 AND c4) OR (c5 AND c6)
      *   |- c1    : RCD.Company Number is Guymon
      *   |- c2    : RCD.Requested Ship Date GT PAR.Kill Date 360 RGT
      *   |- c3    : RCD.Company Number is Seaboard Triumph Foods
      *   |- c4    : RCD.Requested Ship Date GT PAR.Kill Date 440 RGT
      *   |- c5    : RCD.Company Number is St. Joseph
      *   |- c6    : RCD.Requested Ship Date GT PAR.Kill Date 960 RGT
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AIC3    IFEQ 360                        *IF
     C           #1A5DT    IFGT P6WJDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1AIC3    IFEQ 440                        *IF
     C           #1A5DT    IFGT P6WLDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1AIC3    IFEQ 960                        *IF
     C           #1A5DT    IFGT P6WNDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ABOVE: Compare to REQUESTED Ship Date instead of scheduled
      * Format REQUESTED Ship Date
     C                     MOVEL*BLANK    YL0089           Scheduled Ship
     C                     MOVEL#1A5DT    YL0089           Scheduled Ship
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0089:ZQ YL0090    P  90  Scheduled Ship
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD4         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0089:ZQ YL0091    P  90  Scheduled Ship
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0091    CAT  YL0090:ZQ YL0092    P      Scheduled Ship
      *
     C                     MOVEL*BLANK    WN0587  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0092:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0587    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0092:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0587    CAT  WUNATX:ZQ WN0587    P      Generic Heading
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0587    CAT  '/':ZQ    WN0587    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0092:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0587    CAT  WUNATX:ZQ WN0587    P      Generic Heading
     C                     MOVELWN0587    YL0092           Generic Heading
      * Format Last Allocation Date
      * CASE: RCD.Company Number is Guymon
     C           #1AIC3    IFEQ 360                        *IF
     C                     Z-ADDP6WJDT    YL0093           Last Allocation
     C                     ELSE
      * CASE: RCD.Company Number is Sioux City
     C           #1AIC3    IFEQ 440                        *IF
     C                     Z-ADDP6WLDT    YL0093           Last Allocation
     C                     ELSE
      * CASE: RCD.Company Number is St. Joseph
     C           #1AIC3    IFEQ 960                        *IF
     C                     Z-ADDP6WNDT    YL0093           Last Allocation
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0094           Last Allocation
     C                     MOVELYL0093    YL0094           Last Allocation
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0094:ZQ YL0095    P  90  Last Allocation
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD4         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0094:ZQ YL0096    P  90  Last Allocation
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0096    CAT  YL0095:ZQ YL0097    P      Last Allocation
      *
     C                     MOVEL*BLANK    WN0588  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0097:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0588    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0097:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0588    CAT  WUNATX:ZQ WN0588    P      Generic Heading
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0588    CAT  '/':ZQ    WN0588    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0097:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0588    CAT  WUNATX:ZQ WN0588    P      Generic Heading
     C                     MOVELWN0588    YL0097           Generic Heading
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * Setup message data for message
     C                     MOVEL'17'      ZA0018           Option 2 Usr
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0019           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0019           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVELYL0092    ZA0020           Scheduled Ship
     C                     MOVELYL0097    ZA0021           Last Allocation
      * Send message 'Sch Ship Dt > Last Alc Dt'
     C                     MOVEL'USR5118' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Order in Use       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0111           Company Number
     C                     Z-ADD#1C4NB    WL0112           Order Number
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0113    YL0080    P      Order in Use
     C                     MOVELWL0114    YL0081    P      Header Status
     C                     Z-ADDWL0115    #RRMNB           Load ID
      * LCL.Job Date Usr = JOB.*Job date + CON.7 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD7         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0082
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0082
     C                     END
      * val order stuff and load stuff
      * CASE: LCL.Order in Use is yes
     C           YL0080    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0022           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0023           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0023           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: LCL.Header Status is Cancelled
     C           YL0081    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0024           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * val load stuff
      * CASE: RCD.Load ID is GT Zero
     C           #RRMNB    IFGT *ZERO                      *IF
      * Validate
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #RPKST    IFEQ 'I'                        *IF
     C           #RPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0025           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
      * E2824 RMC 10/14/13 allow changes if locked - dont unlock/lock per
     C                     END                             *FI
      * E2824 RMC 10/14/13 allow changes if locked - dont unlock/lock per
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Reallocate if ERROR sts = No
      * CASE: LCL.Error Status is no
     C           YL0053    IFEQ 'N'                        *IF
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'Y'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * Deallocate
     C                     Z-ADD*ZERO     YL0098           Quantity Ordere
     C                     Z-ADD*ZERO     YL0099           Weight Ordered
     C                     Z-ADD#1CCQT    YL0100           Quantity Schedu
     C                     Z-ADD#1AUWG    YL0101           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0118  30       Company Number
     C                     PARM #1C4NB    WQ0119  70       Order Number
     C                     PARM #1DPNB    WQ0120  30       Order Sequence
     C                     PARM #1UENB    WQ0121  30       Order Secondary
     C                     PARM #1HGCD    WQ0122  70       Item Code
     C                     PARM #1AJCD    WQ0123  3        Warehouse Code
     C                     PARM #1A5DT    WQ0124  70       Ship Date USR
     C                     PARM YL0098    WQ0125 112       Quantity Ordere
     C                     PARM YL0099    WQ0126 112       Weight Ordered
     C           YL0100    PARM YL0100    WQ0127 112       Quantity Schedu
     C           YL0101    PARM YL0101    WQ0128 112       Weight Schedule
     C                     PARM 'OD'      WQ0129  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0130 10        PSAA Program Na
     C                     PARM #1RINY    WQ0131  40       Item Age Days
     C                     PARM #1TIDT    WQ0132  70       Production Ovr
     C                     PARM #1TJDT    WQ0133  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0160           Company Number
     C                     Z-ADD#1C4NB    WL0161           Order Number
     C                     Z-ADD#1DPNB    WL0162           Order Sequence
     C                     Z-ADD#1UENB    WL0163           Order Secondary
     C                     Z-ADDYL0100    WL0164           Quantity Schedu
     C                     Z-ADDYL0101    WL0165           Weight Schedule
     C                     EXSR TUCHRC
      * CHG Released by User  CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0166           Company Number
     C                     Z-ADD#1C4NB    WL0167           Order Number
     C                     Z-ADD#1DPNB    WL0168           Order Sequence
     C                     Z-ADD#1UENB    WL0169           Order Secondary
     C                     MOVEL'N'       WL0170    P      Released by Use
     C                     EXSR TVCHRC
      * Chg Schedule Override CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0171           Company Number
     C                     Z-ADD#1C4NB    WL0172           Order Number
     C                     Z-ADD#1DPNB    WL0173           Order Sequence
     C                     Z-ADD#1UENB    WL0174           Order Secondary
     C                     MOVEL*BLANK    WL0175           OD Schedule Ove
     C                     EXSR TWCHRC
      * Chg Adj Type Override CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0176           Company Number
     C                     Z-ADD#1C4NB    WL0177           Order Number
     C                     Z-ADD#1DPNB    WL0178           Order Sequence
     C                     Z-ADD#1UENB    WL0179           Order Secondary
     C                     MOVEL*BLANK    WL0180           OD Adj Type Ove
     C                     EXSR TXCHRC
      * Allocate
     C                     Z-ADD#1AVQT    YL0098           Quantity Ordere
     C                     Z-ADD#1D0WG    YL0099           Weight Ordered
     C                     Z-ADD*ZERO     YL0100           Quantity Schedu
     C                     Z-ADD*ZERO     YL0101           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0134  30       Company Number
     C                     PARM #1C4NB    WQ0135  70       Order Number
     C                     PARM #1DPNB    WQ0136  30       Order Sequence
     C                     PARM #1UENB    WQ0137  30       Order Secondary
     C                     PARM #1HGCD    WQ0138  70       Item Code
     C                     PARM #1AJCD    WQ0139  3        Warehouse Code
     C                     PARM #1A5DT    WQ0140  70       Ship Date USR
     C                     PARM YL0098    WQ0141 112       Quantity Ordere
     C                     PARM YL0099    WQ0142 112       Weight Ordered
     C           YL0100    PARM YL0100    WQ0143 112       Quantity Schedu
     C           YL0101    PARM YL0101    WQ0144 112       Weight Schedule
     C                     PARM 'OA'      WQ0145  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0146 10        PSAA Program Na
     C                     PARM #1RINY    WQ0147  40       Item Age Days
     C                     PARM #1TIDT    WQ0148  70       Production Ovr
     C                     PARM #1TJDT    WQ0149  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0160           Company Number
     C                     Z-ADD#1C4NB    WL0161           Order Number
     C                     Z-ADD#1DPNB    WL0162           Order Sequence
     C                     Z-ADD#1UENB    WL0163           Order Secondary
     C                     Z-ADDYL0100    WL0164           Quantity Schedu
     C                     Z-ADDYL0101    WL0165           Weight Schedule
     C                     EXSR TUCHRC
      * * Clear the Upload error flags                        C001956
      * CHG Ord Req Revw- flg CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0181           Company Number
     C                     Z-ADD#1C4NB    WL0182           Order Number
     C                     MOVEL*BLANK    WL0183           Order Requires
     C                     EXSR TYCHRC
     C                     MOVEL*BLANK    #1H1ST           Order Line Erro
      * CHG Ord Line Error Typ CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0184           Company Number
     C                     Z-ADD#1C4NB    WL0185           Order Number
     C                     Z-ADD#1DPNB    WL0186           Order Sequence
     C                     Z-ADD#1UENB    WL0187           Order Secondary
     C                     MOVEL#1H1ST    WL0188    P      Order Line Erro
     C                     EXSR TZCHRC
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'N'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
      * * FP1054 Create rcd * RLCORD
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPGRC
     C                     Z-ADD#RRMNB    PGRMNB           Load ID
     C                     Z-ADD*ZERO     PGRVNB           Stop/Drop
     C                     MOVEL'RLCORD'  PGRVST    P      Load Change Typ
     C                     MOVEL'SLS'     PGUJST    P      Department Cont
     C                     MOVEL*BLANK    PGMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PGMOTX    P      Change Log New
     C                     MOVEL##USR     PGAYNA    P      User Id
     C                     MOVEL##PGM     PGA0NA    P      Job Name
     C                     MOVEL#RBZNA    PGBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PGAIC3           Company Number
     C                     Z-ADD#1C4NB    PGC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * *
     C                     MOVEL'Y'       YL0056           *Reload subfile
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 18=Edit Age   with lock check ->10/14/13 still do lock chk here
      * CASE: RCD.*SFLSEL is Option 18
     C           #1SEL     IFEQ '18'                       *IF
      * CASE:
      *  - (c1 AND c2) OR (c3 AND c4) OR (c5 AND c6)
      *   |- c1    : RCD.Company Number is Guymon
      *   |- c2    : RCD.Requested Ship Date GT PAR.Kill Date 360 RGT
      *   |- c3    : RCD.Company Number is Seaboard Triumph Foods
      *   |- c4    : RCD.Requested Ship Date GT PAR.Kill Date 440 RGT
      *   |- c5    : RCD.Company Number is St. Joseph
      *   |- c6    : RCD.Requested Ship Date GT PAR.Kill Date 960 RGT
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AIC3    IFEQ 360                        *IF
     C           #1A5DT    IFGT P6WJDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1AIC3    IFEQ 440                        *IF
     C           #1A5DT    IFGT P6WLDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1AIC3    IFEQ 960                        *IF
     C           #1A5DT    IFGT P6WNDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ABOVE: Compare to REQUESTED Ship Date     8/23/19
      * Format Requested Ship Date     8/23/19
     C                     MOVEL*BLANK    YL0089           Scheduled Ship
     C                     MOVEL#1A5DT    YL0089           Scheduled Ship
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0089:ZQ YL0090    P  90  Scheduled Ship
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD4         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0089:ZQ YL0091    P  90  Scheduled Ship
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0091    CAT  YL0090:ZQ YL0092    P      Scheduled Ship
      *
     C                     MOVEL*BLANK    WN1469  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0092:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN1469    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0092:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1469    CAT  WUNATX:ZQ WN1469    P      Generic Heading
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1469    CAT  '/':ZQ    WN1469    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0092:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1469    CAT  WUNATX:ZQ WN1469    P      Generic Heading
     C                     MOVELWN1469    YL0092           Generic Heading
      * Format Last Allocation Date
      * CASE: RCD.Company Number is Guymon
     C           #1AIC3    IFEQ 360                        *IF
     C                     Z-ADDP6WJDT    YL0093           Last Allocation
     C                     ELSE
      * CASE: RCD.Company Number is Sioux City
     C           #1AIC3    IFEQ 440                        *IF
     C                     Z-ADDP6WLDT    YL0093           Last Allocation
     C                     ELSE
      * CASE: RCD.Company Number is St. Joseph
     C           #1AIC3    IFEQ 960                        *IF
     C                     Z-ADDP6WNDT    YL0093           Last Allocation
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0094           Last Allocation
     C                     MOVELYL0093    YL0094           Last Allocation
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0094:ZQ YL0095    P  90  Last Allocation
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD4         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0094:ZQ YL0096    P  90  Last Allocation
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0096    CAT  YL0095:ZQ YL0097    P      Last Allocation
      *
     C                     MOVEL*BLANK    WN1470  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0097:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN1470    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0097:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1470    CAT  WUNATX:ZQ WN1470    P      Generic Heading
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1470    CAT  '/':ZQ    WN1470    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0097:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1470    CAT  WUNATX:ZQ WN1470    P      Generic Heading
     C                     MOVELWN1470    YL0097           Generic Heading
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * Setup message data for message
     C                     MOVEL'17'      ZA0026           Option 2 Usr
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0027           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0027           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVELYL0092    ZA0028           Scheduled Ship
     C                     MOVELYL0097    ZA0029           Last Allocation
      * Send message 'Sch Ship Dt > Last Alc Dt'
     C                     MOVEL'USR5118' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Order in Use       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0111           Company Number
     C                     Z-ADD#1C4NB    WL0112           Order Number
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0113    YL0080    P      Order in Use
     C                     MOVELWL0114    YL0081    P      Header Status
     C                     Z-ADDWL0115    #RRMNB           Load ID
      * LCL.Job Date Usr = JOB.*Job date + CON.7 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD7         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0082
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0082
     C                     END
      * val order stuff and load stuff
      * CASE: LCL.Order in Use is yes
     C           YL0080    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0030           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0031           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0031           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: LCL.Header Status is Cancelled
     C           YL0081    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0032           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * val load stuff
      * CASE: RCD.Load ID is GT Zero
     C           #RRMNB    IFGT *ZERO                      *IF
      * Validate
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #RPKST    IFEQ 'I'                        *IF
     C           #RPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0033           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: RCD.Load Status is Lock
     C           #RPKST    IFEQ 'L'                        *IF
      *
     C                     MOVEL*BLANK    WN1471  1        Load Status
     C                     MOVEL*BLANK    WN1472  1        Block Order Fla
      *
      * EDT Unlock Load Edit   IF
      * RTV Load Status        RT - OM Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0116           Load ID
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0117    WN1471    P      Load Status
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0118           Load ID
     C                     MOVELWN1472    WL0120    P      Block Order Fla
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0119    WUJDST    P      USR Check Y/N S
     C                     MOVELWL0120    WN1472    P      Block Order Fla
      * RMC PFS017 6/5/6 new par.allow unlock if picked = N
      *
     C                     MOVEL*BLANK    WN1473  1        Access Denied (
      *
      * EDT Unlock Load Edits  IF
      * assume will have error
     C                     MOVEL'Y'       YL0053           Error Status
      *
     C                     MOVEL*BLANK    WN1474 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN1474           User Profile Na
      *
     C                     MOVEL*BLANK    WN1475 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1474    WL0121    P      User Profile Na
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0122    WUG0TX    P      Allow Multi-Com
     C                     MOVELWL0123    WUG0TX    P      Default Printer
     C                     MOVELWL0124    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0125    YL0083           Company Number
     C                     MOVELWL0126    WN1475    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,004                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN1475    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1474    WL0127    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0128    P      Application Cod
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0129    WUAIC3           Company Number
     C                     MOVELWL0130    YL0084    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1475    WL0127    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0128    P      Application Cod
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0129    WUAIC3           Company Number
     C                     MOVELWL0130    YL0084    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0084    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0083    IFGT 0                          *IF
     C                     Z-ADDYL0083    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0084    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0085    WL0132           Shipping Compan
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0131    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN1473           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0133           Company Number
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0134    WUG0TX    P      Name
     C                     END                             *FI
      * check the entry control field too.  4/28/05 so christa can do.
      * Rtv Unlock Load Authr RT - Entry Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0135    P      User Profile Na
     C                     MOVEL'O/P'     WL0136    P      Application Cod
     C                     Z-ADD#1AIC3    WL0137           Company Number
     C                     EXSR TFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0138    WUHTST    P      Unlock Load Aut
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Access Denied (Y/N) is yes
      *   |- c2    : WRK.Unlock Load Authority is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN1473    IFEQ 'Y'                        *IF
     C           WUHTST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'User Cant Lock/Unlock Ld'
     C                     MOVEL'USR2468' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If load has been shipped, can't unlock. RMC Chg for picked 5/31/0
      * CASE: PAR.Block Order Flag is Block Order
     C           WN1472    IFEQ 'B'                        *IF
      *   (load contains a block order)
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0034           *SFLSEL
     C                     Z-ADD#RRMNB    ZA0035           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           WN1471    IFEQ 'I'                        *IF
     C           WN1471    OREQ 'S'
      * Setup message data for message
     C                     MOVELWN1471    ZA0036           Load Status
      * Send message 'Load Shipped Can't Unlock'
     C                     MOVEL'USR1272' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * **** Determine if Load has been picked, if yes do not allow unloc
      * **** This function checks OP Order Events & AS Picked Acknowledgm
      * CASE: PAR.Allow Unlock if Picked St is No
     C           'N'       IFEQ 'N'                        *IF
      * Do this one if par is NO. We dont want an UNLOCK if there are XOx
      *   and it isnt shipping doing it.
      * RTV Load Order Picked  XF - AS Order Header  * 
     C                     CALL 'PDQVXFR'              90  RTV Load Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0150  70       Load ID
     C                     PARM #1AIC3    WQ0151  30       Company Number
     C           WUZMST    PARM WUZMST    WQ0152  1        Pick Status USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0086           PFS Load ID
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0087    WUZMST    P      Pick Status USR
     C                     END                             *FI
      * Allow if picked but not Close Order or Close Truck  5/31/06
      * CASE: WRK.Pick Status USR is Picked
     C           WUZMST    IFEQ 'Y'                        *IF
      * CASE: PAR.Allow Unlock if Picked St is No
     C           'N'       IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVELWN1471    ZA0037           Load Status
      * Send message 'Load Picked, Unlock Inval'
     C                     MOVEL'USR1999' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Close Ord/Trk XF - PFS Ship Load/Order Sts  * 
     C                     CALL 'PPYIXFR'              90  PFS Val Close O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0153  70       Load ID
     C           WUB8ST    PARM *BLANK    WQ0154  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0038           *SFLSEL
      * Send message 'Unlock Inval, close exist'
     C                     MOVEL'USR3629' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       YL0053           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       YL0053           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Error Status is no
     C           YL0053    IFEQ 'N'                        *IF
      * Auto Unlock after validations are passed
      * CASE: RCD.Load Status is Lock
     C           #RPKST    IFEQ 'L'                        *IF
      *
     C                     MOVEL*BLANK    WN1476  3        Shipping Line
     C                     MOVEL*BLANK    WN1477 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1478  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1479  1        USR Status (Y/N
      *
      * UPD Unlock Load Update IF
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0139           Load ID
     C                     MOVEL'U'       WL0140    P      Load Status
     C                     Z-ADD*ZERO     WL0141           Rated Freight
     C                     EXSR TGCHRC
      *
     C                     MOVEL*BLANK    WN1480  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1481  1        USR Status (Y/N
     C                     Z-ADD*ZERO     WN1482  90       GAF Customer Nu
     C                     MOVEL*BLANK    WN1483  3        GAF Function
      *
      * EDT Unlock Load        IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0142           Load ID
     C                     EXSR THRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0143    WN1480    P      Trans Contol AS
      * RTV System Value Alpha RT - System Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL@CN,005   WL0144    P      System Value Co
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0145    YL0086    P      System Value Al
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0146           PFS Company Num
     C                     MOVEL'LDORDD'  WL0147    P      PFS Interface C
     C                     EXSR TMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0148    YL0087    P      PFS AccuSort Ac
     C                     MOVELWL0149    YL0088    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0087    IFEQ 'Y'                        *IF
      * Notify Accusort if locked load
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN1480    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0155  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * DEL AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQ0XFR'              90  DEL AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0156  70       Load ID
     C                     PARM #1AIC3    WQ0157  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQ0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0158  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0088    IFEQ 'Y'                        *IF
      * PFS Unlock Load/Order XF - PFS Load Header  * 
     C                     CALL 'PPNQXFR'              90  PFS Unlock Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0159  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0160  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** 09/23/2011 RMC E1607  if load had a whs with edi wso interchan
      *    delete it if Unproc, else change it to "D"elete/and reprocess
      * Exc ChgDel EDI f/UnlckXF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PBAEXFR'              90  Exc ChgDel EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0161  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBAEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Clear Rated Frt    RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0150           Load ID
     C                     Z-ADD*ZERO     WL0151           Stop/Drop Seque
     C                     EXSR TNRVGN
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     MOVEL'UNLOCK'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPGRC
     C                     Z-ADD#RRMNB    PGRMNB           Load ID
     C                     Z-ADD*ZERO     PGRVNB           Stop/Drop
     C                     MOVELWURVST    PGRVST    P      Load Change Typ
     C                     MOVELWUUJST    PGUJST    P      Department Cont
     C                     MOVEL#RPKST    PGMNTX    P      Change Log Prio
     C                     MOVEL'U'       PGMOTX    P      Change Log New
     C                     MOVEL##USR     PGAYNA    P      User Id
     C                     MOVEL##PGM     PGA0NA    P      Job Name
     C                     MOVEL#RBZNA    PGBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PGAIC3           Company Number
     C                     Z-ADD*ZERO     PGC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       P3WVST           Access Denied (
      * Update Function
     C                     EXSR UFSUBR                     Update Function
     C                     END                             *FI
     C                     END                             *FI
      * E14784 - Disallow 17 if Orders Scheduled Ship Date GT Last Alloc
      * 19=Deallocate  FP1054 new option, with lock check->10/14 dont do
      * CASE: RCD.*SFLSEL is Option 19
     C           #1SEL     IFEQ '19'                       *IF
      * CASE:
      *  - (c1 AND c2) OR (c3 AND c4) OR (c5 AND c6)
      *   |- c1    : RCD.Company Number is Guymon
      *   |- c2    : RCD.Requested Ship Date GT PAR.Kill Date 360 RGT
      *   |- c3    : RCD.Company Number is Seaboard Triumph Foods
      *   |- c4    : RCD.Requested Ship Date GT PAR.Kill Date 440 RGT
      *   |- c5    : RCD.Company Number is St. Joseph
      *   |- c6    : RCD.Requested Ship Date GT PAR.Kill Date 960 RGT
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AIC3    IFEQ 360                        *IF
     C           #1A5DT    IFGT P6WJDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1AIC3    IFEQ 440                        *IF
     C           #1A5DT    IFGT P6WLDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1AIC3    IFEQ 960                        *IF
     C           #1A5DT    IFGT P6WNDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ABOVE: Compare to requested ship date 8/23/19
      * Format requested Ship Date
     C                     MOVEL*BLANK    YL0089           Scheduled Ship
     C                     MOVEL#1A5DT    YL0089           Scheduled Ship
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0089:ZQ YL0090    P  90  Scheduled Ship
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD4         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0089:ZQ YL0091    P  90  Scheduled Ship
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0091    CAT  YL0090:ZQ YL0092    P      Scheduled Ship
      *
     C                     MOVEL*BLANK    WN1497  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0092:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN1497    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0092:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1497    CAT  WUNATX:ZQ WN1497    P      Generic Heading
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1497    CAT  '/':ZQ    WN1497    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0092:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1497    CAT  WUNATX:ZQ WN1497    P      Generic Heading
     C                     MOVELWN1497    YL0092           Generic Heading
      * Format Last Allocation Date
      * CASE: RCD.Company Number is Guymon
     C           #1AIC3    IFEQ 360                        *IF
     C                     Z-ADDP6WJDT    YL0093           Last Allocation
     C                     ELSE
      * CASE: RCD.Company Number is Sioux City
     C           #1AIC3    IFEQ 440                        *IF
     C                     Z-ADDP6WLDT    YL0093           Last Allocation
     C                     ELSE
      * CASE: RCD.Company Number is St. Joseph
     C           #1AIC3    IFEQ 960                        *IF
     C                     Z-ADDP6WNDT    YL0093           Last Allocation
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0094           Last Allocation
     C                     MOVELYL0093    YL0094           Last Allocation
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0094:ZQ YL0095    P  90  Last Allocation
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD4         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0094:ZQ YL0096    P  90  Last Allocation
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0096    CAT  YL0095:ZQ YL0097    P      Last Allocation
      *
     C                     MOVEL*BLANK    WN1498  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0097:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN1498    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0097:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1498    CAT  WUNATX:ZQ WN1498    P      Generic Heading
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1498    CAT  '/':ZQ    WN1498    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0097:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1498    CAT  WUNATX:ZQ WN1498    P      Generic Heading
     C                     MOVELWN1498    YL0097           Generic Heading
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * Setup message data for message
     C                     MOVEL'19'      ZA0050           Option 2 Usr
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0051           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0051           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVELYL0092    ZA0052           Scheduled Ship
     C                     MOVELYL0097    ZA0053           Last Allocation
      * Send message 'Sch Ship Dt > Last Alc Dt'
     C                     MOVEL'USR5118' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Order in Use       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0111           Company Number
     C                     Z-ADD#1C4NB    WL0112           Order Number
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0113    YL0080    P      Order in Use
     C                     MOVELWL0114    YL0081    P      Header Status
     C                     Z-ADDWL0115    #RRMNB           Load ID
      * LCL.Job Date Usr = JOB.*Job date + CON.7 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD7         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0082
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0082
     C                     END
      * val order stuff and load stuff
      * CASE: LCL.Order in Use is yes
     C           YL0080    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0054           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0055           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0055           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: LCL.Header Status is Cancelled
     C           YL0081    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0056           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * val load stuff
      * CASE: RCD.Load ID is GT Zero
     C           #RRMNB    IFGT *ZERO                      *IF
      * Validate
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #RPKST    IFEQ 'I'                        *IF
     C           #RPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0057           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
      * E2824 RMC 10/14/13 allow changes if locked - dont unlock/lock per
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Deallocate if ERROR Sts = No
      * CASE: LCL.Error Status is no
     C           YL0053    IFEQ 'N'                        *IF
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'Y'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * Deallocate
     C                     Z-ADD*ZERO     YL0098           Quantity Ordere
     C                     Z-ADD*ZERO     YL0099           Weight Ordered
     C                     Z-ADD#1CCQT    YL0100           Quantity Schedu
     C                     Z-ADD#1AUWG    YL0101           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0175  30       Company Number
     C                     PARM #1C4NB    WQ0176  70       Order Number
     C                     PARM #1DPNB    WQ0177  30       Order Sequence
     C                     PARM #1UENB    WQ0178  30       Order Secondary
     C                     PARM #1HGCD    WQ0179  70       Item Code
     C                     PARM #1AJCD    WQ0180  3        Warehouse Code
     C                     PARM #1A5DT    WQ0181  70       Ship Date USR
     C                     PARM YL0098    WQ0182 112       Quantity Ordere
     C                     PARM YL0099    WQ0183 112       Weight Ordered
     C           YL0100    PARM YL0100    WQ0184 112       Quantity Schedu
     C           YL0101    PARM YL0101    WQ0185 112       Weight Schedule
     C                     PARM 'OD'      WQ0186  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0187 10        PSAA Program Na
     C                     PARM #1RINY    WQ0188  40       Item Age Days
     C                     PARM #1TIDT    WQ0189  70       Production Ovr
     C                     PARM #1TJDT    WQ0190  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0160           Company Number
     C                     Z-ADD#1C4NB    WL0161           Order Number
     C                     Z-ADD#1DPNB    WL0162           Order Sequence
     C                     Z-ADD#1UENB    WL0163           Order Secondary
     C                     Z-ADDYL0100    WL0164           Quantity Schedu
     C                     Z-ADDYL0101    WL0165           Weight Schedule
     C                     EXSR TUCHRC
      * CHG Released by User  CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0166           Company Number
     C                     Z-ADD#1C4NB    WL0167           Order Number
     C                     Z-ADD#1DPNB    WL0168           Order Sequence
     C                     Z-ADD#1UENB    WL0169           Order Secondary
     C                     MOVEL'N'       WL0170    P      Released by Use
     C                     EXSR TVCHRC
      * Chg Schedule Override CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0171           Company Number
     C                     Z-ADD#1C4NB    WL0172           Order Number
     C                     Z-ADD#1DPNB    WL0173           Order Sequence
     C                     Z-ADD#1UENB    WL0174           Order Secondary
     C                     MOVEL*BLANK    WL0175           OD Schedule Ove
     C                     EXSR TWCHRC
      * Chg Adj Type Override CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0176           Company Number
     C                     Z-ADD#1C4NB    WL0177           Order Number
     C                     Z-ADD#1DPNB    WL0178           Order Sequence
     C                     Z-ADD#1UENB    WL0179           Order Secondary
     C                     MOVEL*BLANK    WL0180           OD Adj Type Ove
     C                     EXSR TXCHRC
      * * FP1054 Create rcd * DLCORD
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPGRC
     C                     Z-ADD#RRMNB    PGRMNB           Load ID
     C                     Z-ADD*ZERO     PGRVNB           Stop/Drop
     C                     MOVEL'DLCORD'  PGRVST    P      Load Change Typ
     C                     MOVEL'SLS'     PGUJST    P      Department Cont
     C                     MOVEL*BLANK    PGMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PGMOTX    P      Change Log New
     C                     MOVEL##USR     PGAYNA    P      User Id
     C                     MOVEL##PGM     PGA0NA    P      Job Name
     C                     MOVEL#RBZNA    PGBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PGAIC3           Company Number
     C                     Z-ADD#1C4NB    PGC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * * FP1054 Hold order * HLDORD
      * RMC 10/18/13 dont hold order for prod hold
     C                     MOVEL#RGWST    YL0105           Header Status L
     C                     MOVEL#RXJST    YL0106           USR Production
      * CHG Prd Hld, Sts,Rsn   CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0189           Company Number
     C                     Z-ADD#1C4NB    WL0190           Order Number
     C                     MOVEL#1CQCD    WL0191    P      Reason Code
     C                     MOVEL#RGWST    WL0192    P      Header Status
     C                     MOVELYL0105    WL0193    P      Header Status L
     C                     MOVEL'Y'       WL0194    P      Production Hold
     C                     EXSR NACHRC
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'N'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
      * FP1054 Create HLDORD
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPGRC
     C                     Z-ADD#RRMNB    PGRMNB           Load ID
     C                     Z-ADD*ZERO     PGRVNB           Stop/Drop
     C                     MOVEL'HLDORD'  PGRVST    P      Load Change Typ
     C                     MOVEL'SLS'     PGUJST    P      Department Cont
     C                     MOVEL'N'       PGMNTX    P      Change Log Prio
     C                     MOVEL'Y'       PGMOTX    P      Change Log New
     C                     MOVEL##USR     PGAYNA    P      User Id
     C                     MOVEL##PGM     PGA0NA    P      Job Name
     C                     MOVEL#RBZNA    PGBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PGAIC3           Company Number
     C                     Z-ADD#1C4NB    PGC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * *
     C                     Z-ADD*ZERO     YL0100           Quantity Schedu
     C                     MOVEL'Y'       YL0056           *Reload subfile
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * W78830 DN 07/13/21-Added option 6 to PPS Update condition value l
      * Updates for Sched   (Options 2,6,16,21,22,23)
      * CASE:
      *  - (c1ANDc3)ANDc2
      *   |- c1    : LCL.User Code Model is equal to blank
      *   |- c3    : LCL.User Approval USR is No
      *   |- c2    : RCD.*SFLSEL is PPS Update
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0051    IFEQ *BLANK                     *IF
     C           YL0052    IFEQ 'N'                        *IF
     C           #1SEL     IFEQ '16'                       *IF
     C           #1SEL     OREQ '21'
     C           #1SEL     OREQ '22'
     C           #1SEL     OREQ '2'
     C           #1SEL     OREQ ' 2'
     C           #1SEL     OREQ '23'
     C           #1SEL     OREQ '6'
     C           #1SEL     OREQ ' 6'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC S11387 added chk lcl.User Approval USR  to allow option 2
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0058           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * (Options 2,6,16,21,22,23)
      * CASE: RCD.*SFLSEL is PPS Update
     C           #1SEL     IFEQ '16'                       *IF
     C           #1SEL     OREQ '21'
     C           #1SEL     OREQ '22'
     C           #1SEL     OREQ '2'
     C           #1SEL     OREQ ' 2'
     C           #1SEL     OREQ '23'
     C           #1SEL     OREQ '6'
     C           #1SEL     OREQ ' 6'
      * RTV for PA update val2RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0098           Company Number
     C                     Z-ADD#1C4NB    WL0099           Order Number
     C                     Z-ADD#1DPNB    WL0100           Order Sequence
     C                     Z-ADD#1UENB    WL0101           Order Secondary
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0102    YL0071    P      Warehouse Code
     C                     MOVELWL0103    YL0072    P      OD Production P
     C                     Z-ADDWL0104    YL0073           Quantity Schedu
     C                     Z-ADDWL0105    YL0074           Weight Schedule
     C                     MOVELWL0106    YL0075    P      OD Schedule Ove
     C                     MOVELWL0107    YL0076    P      OD Adj Type Ove
     C                     Z-ADDWL0108    YL0077           Item Age Days
     C                     Z-ADDWL0109    YL0078           Production Ovr
     C                     Z-ADDWL0110    YL0079           Production Ovr
      * If something has changed, dont allow option else do it
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8
      *   |- c1    : RCD.Warehouse Code NE LCL.Warehouse Code SavUsr
      *   |- c2    : RCD.Weight Scheduled NE LCL.Weight Scheduled USR
      *   |- c3    : RCD.Quantity Scheduled NE LCL.Quantity Scheduled 1 U
      *   |- c4    : RCD.OD Schedule Override Sts NE LCL.OD Schedule Over
      *   |- c5    : RCD.OD Adj Type Override NE LCL.OD Adj Type Override
      *   |- c6    : RCD.Item Age Days NE LCL.Item Age Days
      *   |- c7    : RCD.Production Ovr AgeDte Fr NE LCL.Production Ovr A
      *   |- c8    : RCD.Production Ovr AgeDte To NE LCL.Production Ovr A
      *   '-
     C           #1AJCD    IFNE YL0071                     *IF
     C           #1AUWG    ORNE YL0074                     *OR
     C           #1CCQT    ORNE YL0073                     *OR
     C           #1Z4ST    ORNE YL0075                     *OR
     C           #1FZSX    ORNE YL0076                     *OR
     C           #1RINY    ORNE YL0077                     *OR
     C           #1TIDT    ORNE YL0078                     *OR
     C           #1TJDT    ORNE YL0079                     *OR
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0059           *SFLSEL
      * Send message 'Order has chgd since dspl'
     C                     MOVEL'USR4173' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * R11918 DN 10/20/17-Get Allocation Method.
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
     C                     EXSR NBRVGN
      * R13899 RMC 10/11/18-If OD is price type= DST/TNK force to suspend
      * CASE:
      *  - c1ORc2
      *   |- c1    : RCD.OD Price Type is Distressed
      *   |- c2    : RCD.OD Price Type is Tanked
      *   '-
     C           #1F7SX    IFEQ 'DST'                      *IF
     C           #1F7SX    OREQ 'TNK'                      *OR
     C                     MOVEL'I'       YL0107           Allocation Meth
     C                     END                             *FI
      * CASE: LCL.User Code Model is equal to blank
     C           YL0051    IFEQ *BLANK                     *IF
      * Opt 2 also allow if user has user authority "SO"
      * CASE: LCL.User Approval USR is Yes
     C           YL0052    IFEQ 'Y'                        *IF
      * R11918 DN 10/20/17-Do Not Allow Option 2 if 'I=Suspended Inventor
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.*SFLSEL is Option 2
      *   |- c2    : LCL.Allocation Method is Suspended-Inventory Only
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1SEL     IFEQ '2'                        *IF
     C           #1SEL     OREQ ' 2'
     C           YL0107    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,006   CAT  @CN,007:ZQYL0110    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0110    ZA0060           Generic Message
      * Send message 'Generic Message 80 ERR'
     C                     MOVEL'USR4977' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * E14784 - Disallow 17 if Orders Scheduled Ship Date GT Last Alloc
      * 2=Edit Schedule Production
      * CASE: RCD.*SFLSEL is Option 2
     C           #1SEL     IFEQ '2'                        *IF
     C           #1SEL     OREQ ' 2'
      * CASE:
      *  - (c1 AND c2) OR (c3 AND c4) OR (c5 AND c6)
      *   |- c1    : RCD.Company Number is Guymon
      *   |- c2    : RCD.Requested Ship Date GT PAR.Kill Date 360 RGT
      *   |- c3    : RCD.Company Number is Seaboard Triumph Foods
      *   |- c4    : RCD.Requested Ship Date GT PAR.Kill Date 440 RGT
      *   |- c5    : RCD.Company Number is St. Joseph
      *   |- c6    : RCD.Requested Ship Date GT PAR.Kill Date 960 RGT
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AIC3    IFEQ 360                        *IF
     C           #1A5DT    IFGT P6WJDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1AIC3    IFEQ 440                        *IF
     C           #1A5DT    IFGT P6WLDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1AIC3    IFEQ 960                        *IF
     C           #1A5DT    IFGT P6WNDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ABOVE: compare to requested ship date  8/23/19
      * Format requested Ship Date    8/23/19
     C                     MOVEL*BLANK    YL0089           Scheduled Ship
     C                     MOVEL#1A5DT    YL0089           Scheduled Ship
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0089:ZQ YL0090    P  90  Scheduled Ship
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD4         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0089:ZQ YL0091    P  90  Scheduled Ship
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0091    CAT  YL0090:ZQ YL0092    P      Scheduled Ship
      *
     C                     MOVEL*BLANK    WN1619  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0092:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN1619    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0092:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1619    CAT  WUNATX:ZQ WN1619    P      Generic Heading
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1619    CAT  '/':ZQ    WN1619    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0092:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1619    CAT  WUNATX:ZQ WN1619    P      Generic Heading
     C                     MOVELWN1619    YL0092           Generic Heading
      * Format Last Allocation Date
      * CASE: RCD.Company Number is Guymon
     C           #1AIC3    IFEQ 360                        *IF
     C                     Z-ADDP6WJDT    YL0093           Last Allocation
     C                     ELSE
      * CASE: RCD.Company Number is Sioux City
     C           #1AIC3    IFEQ 440                        *IF
     C                     Z-ADDP6WLDT    YL0093           Last Allocation
     C                     ELSE
      * CASE: RCD.Company Number is St. Joseph
     C           #1AIC3    IFEQ 960                        *IF
     C                     Z-ADDP6WNDT    YL0093           Last Allocation
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0094           Last Allocation
     C                     MOVELYL0093    YL0094           Last Allocation
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0094:ZQ YL0095    P  90  Last Allocation
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD4         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0094:ZQ YL0096    P  90  Last Allocation
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0096    CAT  YL0095:ZQ YL0097    P      Last Allocation
      *
     C                     MOVEL*BLANK    WN1620  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0097:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN1620    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0097:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1620    CAT  WUNATX:ZQ WN1620    P      Generic Heading
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1620    CAT  '/':ZQ    WN1620    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0097:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN1620    CAT  WUNATX:ZQ WN1620    P      Generic Heading
     C                     MOVELWN1620    YL0097           Generic Heading
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * Setup message data for message
     C                     MOVEL'2'       ZA0061           Option 2 Usr
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0062           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0062           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVELYL0092    ZA0063           Scheduled Ship
     C                     MOVELYL0097    ZA0064           Last Allocation
      * Send message 'Sch Ship Dt > Last Alc Dt'
     C                     MOVEL'USR5118' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       #RR4ST           USR Update Flag
      * RTV Order in Use       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0111           Company Number
     C                     Z-ADD#1C4NB    WL0112           Order Number
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0113    YL0080    P      Order in Use
     C                     MOVELWL0114    YL0081    P      Header Status
     C                     Z-ADDWL0115    #RRMNB           Load ID
      * LCL.Job Date Usr = JOB.*Job date + CON.7 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD7         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0082
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0082
     C                     END
      * val order stuff and load stuff
      * CASE: LCL.Order in Use is yes
     C           YL0080    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0065           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0066           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0066           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: LCL.Header Status is Cancelled
     C           YL0081    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0067           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * val load stuff
      * CASE: RCD.Load ID is GT Zero
     C           #RRMNB    IFGT *ZERO                      *IF
      * Validate
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #RPKST    IFEQ 'I'                        *IF
     C           #RPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0068           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
      * E2824 RMC 10/14/13 allow changes if locked - dont unlock/lock per
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Deallocate if ERROR Sts = No and Process entries
      * CASE: LCL.Error Status is no
     C           YL0053    IFEQ 'N'                        *IF
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * ************
     C                     MOVEL*BLANK    P2Z4ST           OD Schedule Ove
      * Deallocate if any qty sched ord was changed
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6
      *   |- c1    : RCD.Qty Sched Ord 1 USR NE RCD.Qty Sched Prod 1 USR
      *   |- c2    : RCD.Qty Sched Ord 2 USR NE RCD.Qty Sched Prod 2 USR
      *   |- c3    : RCD.Qty Sched Ord 3 USR NE RCD.Qty Sched Prod 3 USR
      *   |- c4    : RCD.Qty Sched Ord 4 USR NE RCD.Qty Sched Prod 4 USR
      *   |- c5    : RCD.Qty Sched Ord 5 USR NE RCD.Qty Sched Prod 5 USR
      *   |- c6    : RCD.Qty Sched Ord 6 USR NE RCD.Qty Sched Prod 6 USR
      *   '-
     C           #RLKQT    IFNE #RLIQT                     *IF
     C           #RLLQT    ORNE #RLJQT                     *OR
     C           #RLVQT    ORNE #RLWQT                     *OR
     C           #RMOQT    ORNE #RM9QT                     *OR
     C           #RMPQT    ORNE #RNAQT                     *OR
     C           #RMQQT    ORNE #RNOQT                     *OR
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'Y'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
     C                     Z-ADD*ZERO     YL0098           Quantity Ordere
     C                     Z-ADD*ZERO     YL0099           Weight Ordered
     C                     Z-ADD#1CCQT    YL0100           Quantity Schedu
     C                     Z-ADD#1AUWG    YL0101           Weight Schedule
      * 1/04/2013 RMC Dont Deallocate inventory -- just sched production
     C           #1CCQT    SUB  #RKGNX    YL0100           Quantity Schedu
      * 06/07/17 DN T10731-Per RC, commented out codes not in PROD.
      * 06/07/17 DN T10731-Reinstate PROD code.
     C           #1AUWG    SUB  YL0099    YL0101           Weight Schedule
      * ************
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0191  30       Company Number
     C                     PARM #1C4NB    WQ0192  70       Order Number
     C                     PARM #1DPNB    WQ0193  30       Order Sequence
     C                     PARM #1UENB    WQ0194  30       Order Secondary
     C                     PARM #1HGCD    WQ0195  70       Item Code
     C                     PARM #1AJCD    WQ0196  3        Warehouse Code
     C                     PARM #1A5DT    WQ0197  70       Ship Date USR
     C                     PARM YL0098    WQ0198 112       Quantity Ordere
     C                     PARM YL0099    WQ0199 112       Weight Ordered
     C           YL0100    PARM YL0100    WQ0200 112       Quantity Schedu
     C           YL0101    PARM YL0101    WQ0201 112       Weight Schedule
     C                     PARM 'OD'      WQ0202  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0203 10        PSAA Program Na
     C                     PARM #1RINY    WQ0204  40       Item Age Days
     C                     PARM #1TIDT    WQ0205  70       Production Ovr
     C                     PARM #1TJDT    WQ0206  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * ************
      * 1/04/13 leave inv in sched - moved here from under the chgobjs be
     C                     Z-ADD#RKGNX    #1CCQT           Quantity Schedu
     C           #RAIWG    MULT #RKGNX    #1AUWG           Weight Schedule
     C                     Z-ADD#RKGNX    YL0100           Quantity Schedu
     C                     Z-ADD#1AUWG    YL0101           Weight Schedule
      * ************
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0160           Company Number
     C                     Z-ADD#1C4NB    WL0161           Order Number
     C                     Z-ADD#1DPNB    WL0162           Order Sequence
     C                     Z-ADD#1UENB    WL0163           Order Secondary
     C                     Z-ADDYL0100    WL0164           Quantity Schedu
     C                     Z-ADDYL0101    WL0165           Weight Schedule
     C                     EXSR TUCHRC
      * CHG Released by User  CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0166           Company Number
     C                     Z-ADD#1C4NB    WL0167           Order Number
     C                     Z-ADD#1DPNB    WL0168           Order Sequence
     C                     Z-ADD#1UENB    WL0169           Order Secondary
     C                     MOVEL'N'       WL0170    P      Released by Use
     C                     EXSR TVCHRC
      * Chg Schedule Override CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0171           Company Number
     C                     Z-ADD#1C4NB    WL0172           Order Number
     C                     Z-ADD#1DPNB    WL0173           Order Sequence
     C                     Z-ADD#1UENB    WL0174           Order Secondary
     C                     MOVEL'Y'       WL0175    P      OD Schedule Ove
     C                     EXSR TWCHRC
     C                     MOVEL'Y'       P2Z4ST           OD Schedule Ove
     C                     Z-ADD*ZERO     #RJ8NX           Production
     C                     Z-ADD#RKGNX    #RNRQT           Quantity Sched
     C                     MOVEL'Y'       YL0055           Post Flag USR
      * *
     C                     END                             *FI
      * Show fields as input
     C                     MOVEL'N'       #RLISX           Output Only 1 U
      * *Set Cursor: RCD.Qty Sched Ord 1 USR  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ZZSFM     IFEQ '1'
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C                     ELSE
     C           ##SFPG    DIV  003       ##RRN   50
     C           ##RR      DIV  ##RRN     ##RRC   50
     C                     MVR            ##RRC
     C           ##RRC     IFEQ 0
     C                     Z-ADD##RRN     ##RRC
     C                     ENDIF
     C           ##RRC     DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C                     ENDIF
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C           ZZSFM     IFEQ '0'
     C                     MULT 003       W0ROW0
     C                     ENDIF
     C                     ADD  015       W0ROW0
     C                     Z-ADD081       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
      * ******** OPTION 2 **********
      * CHG: Process Scheduled Production days 1 - 6 entries
      * CASE: PAR.OD Schedule Override Sts is Yes
     C           P2Z4ST    IFEQ 'Y'                        *IF
      * C0476 - look at next day as in the case of hold overs
      * RMC look at requested isntead of scheduled      8/23/19
      * LCL.Scheduled Ship Date USR = RCD.Requested Ship Date + CON.1 *DA
     C           #1A5DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0111
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0111
     C                     END
      * Scheduled Production 1
      * CASE: RCD.Qty Sched Ord 1 USR is GT Zero
     C           #RLKQT    IFGT *ZERO                      *IF
      * VAL:  Production Date
      * CASE: CTL.USR Day 1 LT RCD.Production Date RGF
     C           #CFFDT    IFLT #RGVDT                     *IF
      * Setup message data for message
      * Convert USR Day 1 to display format
      * Convert date
     C           1000000   ADD  #CFFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0069
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0070
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0071
     C                     Z-ADD#RLKQT    ZA0072           Qty Sched Ord 1
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9844  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: CTL.USR Day 1 GT LCL.Scheduled Ship Date USR
     C           #CFFDT    IFGT YL0111                     *IF
      * Setup message data for message
      * Convert USR Day 1 to display format
      * Convert date
     C           1000000   ADD  #CFFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0073
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0074
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0075
     C                     Z-ADD#RLKQT    ZA0076           Qty Sched Ord 1
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9844  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     #RLIQT           Qty Sched Prod
      * E3796 JJH 02/18/15 - On call to "WW OrdPrdSch Upd Prod XF" change
      *  "I  Scheduled Ship Date   FLD   RCD Scheduled Ship Date" to
      *  "I  Scheduled Ship Date   FLD   RCD Requested Ship Date"
      * WW OrdPrdSch Upd Prod XF - Order Detail  * 
     C                     CALL 'POUEXFR'              90  WW OrdPrdSch Up
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0207  30       Company Number
     C                     PARM #1C4NB    WQ0208  70       Order Number
     C                     PARM #1DPNB    WQ0209  30       Order Sequence
     C                     PARM #1UENB    WQ0210  30       Order Secondary
     C                     PARM #1HGCD    WQ0211  70       Item Code
     C                     PARM #1AJCD    WQ0212  3        Warehouse Code
     C                     PARM #RFWST    WQ0213  1        Age Code
     C                     PARM #1AVQT    WQ0214 112       Quantity Ordere
     C                     PARM #1A5DT    WQ0215  70       Scheduled Ship
     C                     PARM #1FZSX    WQ0216  1        OD Adj Type Ove
     C                     PARM #1RINY    WQ0217  40       Item Age Days
     C                     PARM #1TIDT    WQ0218  70       Production Ovr
     C                     PARM #1TJDT    WQ0219  70       Production Ovr
     C                     PARM #CFFDT    WQ0220  70       Production Date
     C                     PARM #RGVDT    WQ0221  70       Production Date
     C                     PARM #1AODT    WQ0222  70       Production Date
     C           #RNRQT    PARM #RNRQT    WQ0223  50       Quantity Sched
     C           #1CCQT    PARM #1CCQT    WQ0224 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0225 112       Weight Schedule
     C           #RLKQT    PARM #RLKQT    WQ0226  50       Qty Sched Ord U
     C           #RLIQT    PARM #RLIQT    WQ0227  50       Qty Sched Prod
     C           #RJ8NX    PARM #RJ8NX    WQ0228  50       Production
     C           #RKGNX    PARM #RKGNX    WQ0229  50       Inv Total
     C           #RNSQT    PARM #RNSQT    WQ0230  50       ODS Quantity Sh
     C           #RHLSX    PARM *BLANK    WQ0231  1        Reverse Image F
     C                     PARM #RADCD    WQ0232  2        U/M - Primary
     C                     PARM #RAIWG    WQ0233 112       Unit Weight
     C                     PARM *ZERO     WQ0234  52       Fresh Chilling
     C                     PARM #RQZCD    WQ0235  2        Base/Conv/Loss
     C                     PARM #RR3CD    WQ0236  6        Department Code
     C                     PARM #RPCCT    WQ0237  1        Piece Count Ite
     C                     PARM #RBDNB    WQ0238  70       Pieces Per Bag
     C                     PARM #RBJNB    WQ0239  70       Bags Per Unit
     C                     PARM #RSUST    WQ0240  1        Export/Domestic
     C                     PARM #RSVST    WQ0241  1        Print On Schedu
     C                     PARM #RSYST    WQ0242  1        Fresh Inv Alloc
     C                     PARM #RSZST    WQ0243  1        Fresh Sched As
     C                     PARM #RS1ST    WQ0244  1        Frozen Inv Allo
     C                     PARM #RXRCD    WQ0245  6        Primal Group Co
     C                     PARM #RWPST    WQ0246  2        Warehouse Type
     C                     PARM #RT1ST    WQ0247  1        Warehouse Std C
     C                     PARM #RDBNB    WQ0248  52       Warehouse Chill
     C                     PARM #RBVC3    WQ0249  30       WHS Inventory C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POUEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9844  *
     C                     END
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
      * Scheduled Production 2
      * CASE: RCD.Qty Sched Ord 2 USR is GT Zero
     C           #RLLQT    IFGT *ZERO                      *IF
      * VAL:  Production Date
      * CASE: CTL.USR Day 2 LT RCD.Production Date RGF
     C           #CE1DT    IFLT #RGVDT                     *IF
      * Setup message data for message
      * Convert USR Day 2 to display format
      * Convert date
     C           1000000   ADD  #CE1DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0077
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0078
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0079
     C                     Z-ADD#RLLQT    ZA0080           Qty Sched Ord 2
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: CTL.USR Day 2 GT LCL.Scheduled Ship Date USR
     C           #CE1DT    IFGT YL0111                     *IF
      * Setup message data for message
      * Convert USR Day 2 to display format
      * Convert date
     C           1000000   ADD  #CE1DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0081
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0082
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0083
     C                     Z-ADD#RLLQT    ZA0084           Qty Sched Ord 2
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     #RLJQT           Qty Sched Prod
      * E3796 JJH 02/18/15 - On call to "WW OrdPrdSch Upd Prod XF" change
      *  "I  Scheduled Ship Date   FLD   RCD Scheduled Ship Date" to
      *  "I  Scheduled Ship Date   FLD   RCD Requested Ship Date"
      * WW OrdPrdSch Upd Prod XF - Order Detail  * 
     C                     CALL 'POUEXFR'              90  WW OrdPrdSch Up
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0250  30       Company Number
     C                     PARM #1C4NB    WQ0251  70       Order Number
     C                     PARM #1DPNB    WQ0252  30       Order Sequence
     C                     PARM #1UENB    WQ0253  30       Order Secondary
     C                     PARM #1HGCD    WQ0254  70       Item Code
     C                     PARM #1AJCD    WQ0255  3        Warehouse Code
     C                     PARM #RFWST    WQ0256  1        Age Code
     C                     PARM #1AVQT    WQ0257 112       Quantity Ordere
     C                     PARM #1A5DT    WQ0258  70       Scheduled Ship
     C                     PARM #1FZSX    WQ0259  1        OD Adj Type Ove
     C                     PARM #1RINY    WQ0260  40       Item Age Days
     C                     PARM #1TIDT    WQ0261  70       Production Ovr
     C                     PARM #1TJDT    WQ0262  70       Production Ovr
     C                     PARM #CE1DT    WQ0263  70       Production Date
     C                     PARM #RGVDT    WQ0264  70       Production Date
     C                     PARM #1AODT    WQ0265  70       Production Date
     C           #RNRQT    PARM #RNRQT    WQ0266  50       Quantity Sched
     C           #1CCQT    PARM #1CCQT    WQ0267 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0268 112       Weight Schedule
     C           #RLLQT    PARM #RLLQT    WQ0269  50       Qty Sched Ord U
     C           #RLJQT    PARM #RLJQT    WQ0270  50       Qty Sched Prod
     C           #RJ8NX    PARM #RJ8NX    WQ0271  50       Production
     C           #RKGNX    PARM #RKGNX    WQ0272  50       Inv Total
     C           #RNSQT    PARM #RNSQT    WQ0273  50       ODS Quantity Sh
     C           #RHLSX    PARM *BLANK    WQ0274  1        Reverse Image F
     C                     PARM #RADCD    WQ0275  2        U/M - Primary
     C                     PARM #RAIWG    WQ0276 112       Unit Weight
     C                     PARM *ZERO     WQ0277  52       Fresh Chilling
     C                     PARM #RQZCD    WQ0278  2        Base/Conv/Loss
     C                     PARM #RR3CD    WQ0279  6        Department Code
     C                     PARM #RPCCT    WQ0280  1        Piece Count Ite
     C                     PARM #RBDNB    WQ0281  70       Pieces Per Bag
     C                     PARM #RBJNB    WQ0282  70       Bags Per Unit
     C                     PARM #RSUST    WQ0283  1        Export/Domestic
     C                     PARM #RSVST    WQ0284  1        Print On Schedu
     C                     PARM #RSYST    WQ0285  1        Fresh Inv Alloc
     C                     PARM #RSZST    WQ0286  1        Fresh Sched As
     C                     PARM #RS1ST    WQ0287  1        Frozen Inv Allo
     C                     PARM #RXRCD    WQ0288  6        Primal Group Co
     C                     PARM #RWPST    WQ0289  2        Warehouse Type
     C                     PARM #RT1ST    WQ0290  1        Warehouse Std C
     C                     PARM #RDBNB    WQ0291  52       Warehouse Chill
     C                     PARM #RBVC3    WQ0292  30       WHS Inventory C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POUEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9845  *
     C                     END
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
      * Scheduled Production 3
      * CASE: RCD.Qty Sched Ord 3 USR is GT Zero
     C           #RLVQT    IFGT *ZERO                      *IF
      * VAL:  Production Date
      * CASE: CTL.USR Day 3 LT RCD.Production Date RGF
     C           #CE2DT    IFLT #RGVDT                     *IF
      * Setup message data for message
      * Convert USR Day 3 to display format
      * Convert date
     C           1000000   ADD  #CE2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0085
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0086
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0087
     C                     Z-ADD#RLVQT    ZA0088           Qty Sched Ord 3
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9846  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: CTL.USR Day 3 GT LCL.Scheduled Ship Date USR
     C           #CE2DT    IFGT YL0111                     *IF
      * Setup message data for message
      * Convert USR Day 3 to display format
      * Convert date
     C           1000000   ADD  #CE2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0089
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0090
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0091
     C                     Z-ADD#RLVQT    ZA0092           Qty Sched Ord 3
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9846  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     #RLWQT           Qty Sched Prod
      * E3796 JJH 02/18/15 - On call to "WW OrdPrdSch Upd Prod XF" change
      *  "I  Scheduled Ship Date   FLD   RCD Scheduled Ship Date" to
      *  "I  Scheduled Ship Date   FLD   RCD Requested Ship Date"
      * WW OrdPrdSch Upd Prod XF - Order Detail  * 
     C                     CALL 'POUEXFR'              90  WW OrdPrdSch Up
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0293  30       Company Number
     C                     PARM #1C4NB    WQ0294  70       Order Number
     C                     PARM #1DPNB    WQ0295  30       Order Sequence
     C                     PARM #1UENB    WQ0296  30       Order Secondary
     C                     PARM #1HGCD    WQ0297  70       Item Code
     C                     PARM #1AJCD    WQ0298  3        Warehouse Code
     C                     PARM #RFWST    WQ0299  1        Age Code
     C                     PARM #1AVQT    WQ0300 112       Quantity Ordere
     C                     PARM #1A5DT    WQ0301  70       Scheduled Ship
     C                     PARM #1FZSX    WQ0302  1        OD Adj Type Ove
     C                     PARM #1RINY    WQ0303  40       Item Age Days
     C                     PARM #1TIDT    WQ0304  70       Production Ovr
     C                     PARM #1TJDT    WQ0305  70       Production Ovr
     C                     PARM #CE2DT    WQ0306  70       Production Date
     C                     PARM #RGVDT    WQ0307  70       Production Date
     C                     PARM #1AODT    WQ0308  70       Production Date
     C           #RNRQT    PARM #RNRQT    WQ0309  50       Quantity Sched
     C           #1CCQT    PARM #1CCQT    WQ0310 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0311 112       Weight Schedule
     C           #RLVQT    PARM #RLVQT    WQ0312  50       Qty Sched Ord U
     C           #RLWQT    PARM #RLWQT    WQ0313  50       Qty Sched Prod
     C           #RJ8NX    PARM #RJ8NX    WQ0314  50       Production
     C           #RKGNX    PARM #RKGNX    WQ0315  50       Inv Total
     C           #RNSQT    PARM #RNSQT    WQ0316  50       ODS Quantity Sh
     C           #RHLSX    PARM *BLANK    WQ0317  1        Reverse Image F
     C                     PARM #RADCD    WQ0318  2        U/M - Primary
     C                     PARM #RAIWG    WQ0319 112       Unit Weight
     C                     PARM *ZERO     WQ0320  52       Fresh Chilling
     C                     PARM #RQZCD    WQ0321  2        Base/Conv/Loss
     C                     PARM #RR3CD    WQ0322  6        Department Code
     C                     PARM #RPCCT    WQ0323  1        Piece Count Ite
     C                     PARM #RBDNB    WQ0324  70       Pieces Per Bag
     C                     PARM #RBJNB    WQ0325  70       Bags Per Unit
     C                     PARM #RSUST    WQ0326  1        Export/Domestic
     C                     PARM #RSVST    WQ0327  1        Print On Schedu
     C                     PARM #RSYST    WQ0328  1        Fresh Inv Alloc
     C                     PARM #RSZST    WQ0329  1        Fresh Sched As
     C                     PARM #RS1ST    WQ0330  1        Frozen Inv Allo
     C                     PARM #RXRCD    WQ0331  6        Primal Group Co
     C                     PARM #RWPST    WQ0332  2        Warehouse Type
     C                     PARM #RT1ST    WQ0333  1        Warehouse Std C
     C                     PARM #RDBNB    WQ0334  52       Warehouse Chill
     C                     PARM #RBVC3    WQ0335  30       WHS Inventory C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POUEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9846  *
     C                     END
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
      * Scheduled Production 4
      * CASE: RCD.Qty Sched Ord 4 USR is GT 0
     C           #RMOQT    IFGT 0                          *IF
      * VAL:  Production Date
      * CASE: CTL.USR Day 4 LT RCD.Production Date RGF
     C           #CE3DT    IFLT #RGVDT                     *IF
      * Setup message data for message
      * Convert USR Day 4 to display format
      * Convert date
     C           1000000   ADD  #CE3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0093
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0094
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0095
     C                     Z-ADD#RMOQT    ZA0096           Qty Sched Ord 4
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9847  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: CTL.USR Day 4 GT LCL.Scheduled Ship Date USR
     C           #CE3DT    IFGT YL0111                     *IF
      * Setup message data for message
      * Convert USR Day 4 to display format
      * Convert date
     C           1000000   ADD  #CE3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0097
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0098
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0099
     C                     Z-ADD#RMOQT    ZA0100           Qty Sched Ord 4
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9847  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     #RM9QT           Qty Sched Prod
      * E3796 JJH 02/18/15 - On call to "WW OrdPrdSch Upd Prod XF" change
      *  "I  Scheduled Ship Date   FLD   RCD Scheduled Ship Date" to
      *  "I  Scheduled Ship Date   FLD   RCD Requested Ship Date"
      * WW OrdPrdSch Upd Prod XF - Order Detail  * 
     C                     CALL 'POUEXFR'              90  WW OrdPrdSch Up
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0336  30       Company Number
     C                     PARM #1C4NB    WQ0337  70       Order Number
     C                     PARM #1DPNB    WQ0338  30       Order Sequence
     C                     PARM #1UENB    WQ0339  30       Order Secondary
     C                     PARM #1HGCD    WQ0340  70       Item Code
     C                     PARM #1AJCD    WQ0341  3        Warehouse Code
     C                     PARM #RFWST    WQ0342  1        Age Code
     C                     PARM #1AVQT    WQ0343 112       Quantity Ordere
     C                     PARM #1A5DT    WQ0344  70       Scheduled Ship
     C                     PARM #1FZSX    WQ0345  1        OD Adj Type Ove
     C                     PARM #1RINY    WQ0346  40       Item Age Days
     C                     PARM #1TIDT    WQ0347  70       Production Ovr
     C                     PARM #1TJDT    WQ0348  70       Production Ovr
     C                     PARM #CE3DT    WQ0349  70       Production Date
     C                     PARM #RGVDT    WQ0350  70       Production Date
     C                     PARM #1AODT    WQ0351  70       Production Date
     C           #RNRQT    PARM #RNRQT    WQ0352  50       Quantity Sched
     C           #1CCQT    PARM #1CCQT    WQ0353 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0354 112       Weight Schedule
     C           #RMOQT    PARM #RMOQT    WQ0355  50       Qty Sched Ord U
     C           #RM9QT    PARM #RM9QT    WQ0356  50       Qty Sched Prod
     C           #RJ8NX    PARM #RJ8NX    WQ0357  50       Production
     C           #RKGNX    PARM #RKGNX    WQ0358  50       Inv Total
     C           #RNSQT    PARM #RNSQT    WQ0359  50       ODS Quantity Sh
     C           #RHLSX    PARM *BLANK    WQ0360  1        Reverse Image F
     C                     PARM #RADCD    WQ0361  2        U/M - Primary
     C                     PARM #RAIWG    WQ0362 112       Unit Weight
     C                     PARM *ZERO     WQ0363  52       Fresh Chilling
     C                     PARM #RQZCD    WQ0364  2        Base/Conv/Loss
     C                     PARM #RR3CD    WQ0365  6        Department Code
     C                     PARM #RPCCT    WQ0366  1        Piece Count Ite
     C                     PARM #RBDNB    WQ0367  70       Pieces Per Bag
     C                     PARM #RBJNB    WQ0368  70       Bags Per Unit
     C                     PARM #RSUST    WQ0369  1        Export/Domestic
     C                     PARM #RSVST    WQ0370  1        Print On Schedu
     C                     PARM #RSYST    WQ0371  1        Fresh Inv Alloc
     C                     PARM #RSZST    WQ0372  1        Fresh Sched As
     C                     PARM #RS1ST    WQ0373  1        Frozen Inv Allo
     C                     PARM #RXRCD    WQ0374  6        Primal Group Co
     C                     PARM #RWPST    WQ0375  2        Warehouse Type
     C                     PARM #RT1ST    WQ0376  1        Warehouse Std C
     C                     PARM #RDBNB    WQ0377  52       Warehouse Chill
     C                     PARM #RBVC3    WQ0378  30       WHS Inventory C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POUEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9847  *
     C                     END
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
      * Scheduled Production 5
      * CASE: RCD.Qty Sched Ord 5 USR is GT 0
     C           #RMPQT    IFGT *ZERO                      *IF
      * VAL:  Production Date
      * CASE: CTL.USR Day 5 LT RCD.Production Date RGF
     C           #CE4DT    IFLT #RGVDT                     *IF
      * Setup message data for message
      * Convert USR Day 5 to display format
      * Convert date
     C           1000000   ADD  #CE4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0101
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0102
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0103
     C                     Z-ADD#RMPQT    ZA0104           Qty Sched Ord 5
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9848  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: CTL.USR Day 5 GT LCL.Scheduled Ship Date USR
     C           #CE4DT    IFGT YL0111                     *IF
      * Setup message data for message
      * Convert USR Day 5 to display format
      * Convert date
     C           1000000   ADD  #CE4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0105
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0106
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0107
     C                     Z-ADD#RMPQT    ZA0108           Qty Sched Ord 5
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9848  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     #RNAQT           Qty Sched Prod
      * E3796 JJH 02/18/15 - On call to "WW OrdPrdSch Upd Prod XF" change
      *  "I  Scheduled Ship Date   FLD   RCD Scheduled Ship Date" to
      *  "I  Scheduled Ship Date   FLD   RCD Requested Ship Date"
      * WW OrdPrdSch Upd Prod XF - Order Detail  * 
     C                     CALL 'POUEXFR'              90  WW OrdPrdSch Up
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0379  30       Company Number
     C                     PARM #1C4NB    WQ0380  70       Order Number
     C                     PARM #1DPNB    WQ0381  30       Order Sequence
     C                     PARM #1UENB    WQ0382  30       Order Secondary
     C                     PARM #1HGCD    WQ0383  70       Item Code
     C                     PARM #1AJCD    WQ0384  3        Warehouse Code
     C                     PARM #RFWST    WQ0385  1        Age Code
     C                     PARM #1AVQT    WQ0386 112       Quantity Ordere
     C                     PARM #1A5DT    WQ0387  70       Scheduled Ship
     C                     PARM #1FZSX    WQ0388  1        OD Adj Type Ove
     C                     PARM #1RINY    WQ0389  40       Item Age Days
     C                     PARM #1TIDT    WQ0390  70       Production Ovr
     C                     PARM #1TJDT    WQ0391  70       Production Ovr
     C                     PARM #CE4DT    WQ0392  70       Production Date
     C                     PARM #RGVDT    WQ0393  70       Production Date
     C                     PARM #1AODT    WQ0394  70       Production Date
     C           #RNRQT    PARM #RNRQT    WQ0395  50       Quantity Sched
     C           #1CCQT    PARM #1CCQT    WQ0396 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0397 112       Weight Schedule
     C           #RMPQT    PARM #RMPQT    WQ0398  50       Qty Sched Ord U
     C           #RNAQT    PARM #RNAQT    WQ0399  50       Qty Sched Prod
     C           #RJ8NX    PARM #RJ8NX    WQ0400  50       Production
     C           #RKGNX    PARM #RKGNX    WQ0401  50       Inv Total
     C           #RNSQT    PARM #RNSQT    WQ0402  50       ODS Quantity Sh
     C           #RHLSX    PARM *BLANK    WQ0403  1        Reverse Image F
     C                     PARM #RADCD    WQ0404  2        U/M - Primary
     C                     PARM #RAIWG    WQ0405 112       Unit Weight
     C                     PARM *ZERO     WQ0406  52       Fresh Chilling
     C                     PARM #RQZCD    WQ0407  2        Base/Conv/Loss
     C                     PARM #RR3CD    WQ0408  6        Department Code
     C                     PARM #RPCCT    WQ0409  1        Piece Count Ite
     C                     PARM #RBDNB    WQ0410  70       Pieces Per Bag
     C                     PARM #RBJNB    WQ0411  70       Bags Per Unit
     C                     PARM #RSUST    WQ0412  1        Export/Domestic
     C                     PARM #RSVST    WQ0413  1        Print On Schedu
     C                     PARM #RSYST    WQ0414  1        Fresh Inv Alloc
     C                     PARM #RSZST    WQ0415  1        Fresh Sched As
     C                     PARM #RS1ST    WQ0416  1        Frozen Inv Allo
     C                     PARM #RXRCD    WQ0417  6        Primal Group Co
     C                     PARM #RWPST    WQ0418  2        Warehouse Type
     C                     PARM #RT1ST    WQ0419  1        Warehouse Std C
     C                     PARM #RDBNB    WQ0420  52       Warehouse Chill
     C                     PARM #RBVC3    WQ0421  30       WHS Inventory C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POUEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9848  *
     C                     END
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
      * Scheduled Production 6
      * CASE: RCD.Qty Sched Ord 6 USR is GT 0
     C           #RMQQT    IFGT 0                          *IF
      * VAL:  Production Date
      * CASE: CTL.USR Day 6 LT RCD.Production Date RGF
     C           #CE5DT    IFLT #RGVDT                     *IF
      * Setup message data for message
      * Convert USR Day 6 to display format
      * Convert date
     C           1000000   ADD  #CE5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0109
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0110
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0111
     C                     Z-ADD#RMQQT    ZA0112           Qty Sched Ord 6
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9849  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: CTL.USR Day 6 GT LCL.Scheduled Ship Date USR
     C           #CE5DT    IFGT YL0111                     *IF
      * Setup message data for message
      * Convert USR Day 6 to display format
      * Convert date
     C           1000000   ADD  #CE5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0113
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0114
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0115
     C                     Z-ADD#RMQQT    ZA0116           Qty Sched Ord 6
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9849  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     #RNOQT           Qty Sched Prod
      * E3796 JJH 02/18/15 - On call to "WW OrdPrdSch Upd Prod XF" change
      *  "I  Scheduled Ship Date   FLD   RCD Scheduled Ship Date" to
      *  "I  Scheduled Ship Date   FLD   RCD Requested Ship Date"
      * WW OrdPrdSch Upd Prod XF - Order Detail  * 
     C                     CALL 'POUEXFR'              90  WW OrdPrdSch Up
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0422  30       Company Number
     C                     PARM #1C4NB    WQ0423  70       Order Number
     C                     PARM #1DPNB    WQ0424  30       Order Sequence
     C                     PARM #1UENB    WQ0425  30       Order Secondary
     C                     PARM #1HGCD    WQ0426  70       Item Code
     C                     PARM #1AJCD    WQ0427  3        Warehouse Code
     C                     PARM #RFWST    WQ0428  1        Age Code
     C                     PARM #1AVQT    WQ0429 112       Quantity Ordere
     C                     PARM #1A5DT    WQ0430  70       Scheduled Ship
     C                     PARM #1FZSX    WQ0431  1        OD Adj Type Ove
     C                     PARM #1RINY    WQ0432  40       Item Age Days
     C                     PARM #1TIDT    WQ0433  70       Production Ovr
     C                     PARM #1TJDT    WQ0434  70       Production Ovr
     C                     PARM #CE5DT    WQ0435  70       Production Date
     C                     PARM #RGVDT    WQ0436  70       Production Date
     C                     PARM #1AODT    WQ0437  70       Production Date
     C           #RNRQT    PARM #RNRQT    WQ0438  50       Quantity Sched
     C           #1CCQT    PARM #1CCQT    WQ0439 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0440 112       Weight Schedule
     C           #RMQQT    PARM #RMQQT    WQ0441  50       Qty Sched Ord U
     C           #RNOQT    PARM #RNOQT    WQ0442  50       Qty Sched Prod
     C           #RJ8NX    PARM #RJ8NX    WQ0443  50       Production
     C           #RKGNX    PARM #RKGNX    WQ0444  50       Inv Total
     C           #RNSQT    PARM #RNSQT    WQ0445  50       ODS Quantity Sh
     C           #RHLSX    PARM *BLANK    WQ0446  1        Reverse Image F
     C                     PARM #RADCD    WQ0447  2        U/M - Primary
     C                     PARM #RAIWG    WQ0448 112       Unit Weight
     C                     PARM *ZERO     WQ0449  52       Fresh Chilling
     C                     PARM #RQZCD    WQ0450  2        Base/Conv/Loss
     C                     PARM #RR3CD    WQ0451  6        Department Code
     C                     PARM #RPCCT    WQ0452  1        Piece Count Ite
     C                     PARM #RBDNB    WQ0453  70       Pieces Per Bag
     C                     PARM #RBJNB    WQ0454  70       Bags Per Unit
     C                     PARM #RSUST    WQ0455  1        Export/Domestic
     C                     PARM #RSVST    WQ0456  1        Print On Schedu
     C                     PARM #RSYST    WQ0457  1        Fresh Inv Alloc
     C                     PARM #RSZST    WQ0458  1        Fresh Sched As
     C                     PARM #RS1ST    WQ0459  1        Frozen Inv Allo
     C                     PARM #RXRCD    WQ0460  6        Primal Group Co
     C                     PARM #RWPST    WQ0461  2        Warehouse Type
     C                     PARM #RT1ST    WQ0462  1        Warehouse Std C
     C                     PARM #RDBNB    WQ0463  52       Warehouse Chill
     C                     PARM #RBVC3    WQ0464  30       WHS Inventory C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POUEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9849  *
     C                     END
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
      * added 6/15/09
      * CASE: LCL.Post Flag USR is Yes
     C           YL0055    IFEQ 'Y'                        *IF
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'N'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
     C                     Z-ADD#1CCQT    #RNRQT           Quantity Sched
     C                     Z-ADD#1CCQT    YL0100           Quantity Schedu
     C                     Z-ADD#1AUWG    YL0101           Weight Schedule
     C                     MOVEL'Y'       YL0056           *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0117           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * R11918 DN 10/20/17-Do Not Allow Opt 2, 16 if 'I=Suspended Invento
      * CASE:
      *  - c1 AND (c2 OR c3)
      *   |- c1    : LCL.Allocation Method is Suspended-Inventory Only
      *   |- c2    : RCD.*SFLSEL is Option 2
      *   |- c3    : RCD.*SFLSEL is Option 16
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0107    IFEQ 'I'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #1SEL     IFEQ '2'                        *IF
     C           #1SEL     OREQ ' 2'
     C           #1SEL     OREQ '16'                       *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,006   CAT  @CN,007:ZQYL0110    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0110    ZA0118           Generic Message
      * Send message 'Generic Message 80 ERR'
     C                     MOVEL'USR4977' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * 6=Chg Ord Qty              W78830 DN 07/13/21-Added Opt 6.
      * CASE: RCD.*SFLSEL is Option 6
     C           #1SEL     IFEQ '6'                        *IF
     C           #1SEL     OREQ ' 6'
      * Codes below was copied from Opt 2 in PORYDFR function.
      * RTV Chk Detail Exists  RT - Order Detail  * 
     C                     EXSR NERVGN
      * Edit existing order details, etc. or issue error message
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,004                    *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0119           *SFLSEL
      * Send message 'No Order Lines-Edit Hdr'
     C                     MOVEL'USR2064' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: RCD.Event Code is 04 Shipped
     C           #1JPCD    IFEQ '04'                       *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0120           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0120           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1SEL     ZA0121           *SFLSEL
      * Send message 'Order Partially Confirmed'
     C                     MOVEL'USR1334' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: RCD.Order in Use is yes
     C           #RGJST    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0122           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0122           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use'
     C                     MOVEL'USR0508' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: RCD.Load Status is Lock
     C           #RPKST    IFEQ 'L'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0123           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0124           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0124           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order can't be chgd load'
     C                     MOVEL'USR1891' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: RCD.Pick Status USR is Picked
     C           #RZMST    IFEQ 'Y'                        *IF
      * RMC PFS017 6/6/6 added this condition
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0125           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0126           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0126           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order can't be chgd load'
     C                     MOVEL'USR1891' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       WUPRCT           Process Control
      * EDT Order Entry Home   XF - Order Header TRG  * 
     C                     CALL 'PDSQXFR'              90  EDT Order Entry
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0465  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0466  70       Order Number
     C           #1BKC7    PARM #1BKC7    WQ0467  70       Ship To Custome
     C           WUPRCT    PARM WUPRCT    WQ0468  1        Process Control
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 16=Ship Off Cut     FP1054 - reinstate to get cur day's orders sh
      * CASE: RCD.*SFLSEL is Option 16
     C           #1SEL     IFEQ '16'                       *IF
      * RTV Next Prod Date     RT - Calendar  * 
     C                     EXSR NFRVGN
      * CASE: RCD.Requested Ship Date GT LCL.Production Date
     C           #1A5DT    IFGT YL0112                     *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0127           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * only porksche can do this
      * CASE: LCL.User Code Model is equal to blank
     C           YL0051    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0128           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C           #RJ8NX    ADD  #RKGNX    YL0100           Quantity Schedu
     C           YL0100    MULT #RAIWG    YL0101    H      Weight Schedule
      * In theory, ship off cut is primarily used for boxed product and
      * Scheduled Ship Date and Requested Ship Date should be the same.
      * If they are trying to Ship off Cut for Combo, then they need
      * to change the Requested Ship Date to be the same as Scheduled Shi
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0469  30       Company Number
     C                     PARM #1C4NB    WQ0470  70       Order Number
     C                     PARM #1DPNB    WQ0471  30       Order Sequence
     C                     PARM #1UENB    WQ0472  30       Order Secondary
     C                     PARM #1HGCD    WQ0473  70       Item Code
     C                     PARM #1AJCD    WQ0474  3        Warehouse Code
     C                     PARM #1A5DT    WQ0475  70       Ship Date USR
     C                     PARM #1AVQT    WQ0476 112       Quantity Ordere
     C                     PARM #1D0WG    WQ0477 112       Weight Ordered
     C           YL0100    PARM YL0100    WQ0478 112       Quantity Schedu
     C           YL0101    PARM YL0101    WQ0479 112       Weight Schedule
     C                     PARM 'SC'      WQ0480  2        ATS Adj Type US
     C                     PARM @CN,008   WQ0481 10        PSAA Program Na
     C                     PARM #1RINY    WQ0482  40       Item Age Days
     C                     PARM #1TIDT    WQ0483  70       Production Ovr
     C                     PARM #1TJDT    WQ0484  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0160           Company Number
     C                     Z-ADD#1C4NB    WL0161           Order Number
     C                     Z-ADD#1DPNB    WL0162           Order Sequence
     C                     Z-ADD#1UENB    WL0163           Order Secondary
     C                     Z-ADDYL0100    WL0164           Quantity Schedu
     C                     Z-ADDYL0101    WL0165           Weight Schedule
     C                     EXSR TUCHRC
      * * Clear the Upload error flags                        C001956
      * CHG Ord Req Revw- flg CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0181           Company Number
     C                     Z-ADD#1C4NB    WL0182           Order Number
     C                     MOVEL*BLANK    WL0183           Order Requires
     C                     EXSR TYCHRC
     C                     MOVEL*BLANK    #1H1ST           Order Line Erro
      * CHG Ord Line Error Typ CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0184           Company Number
     C                     Z-ADD#1C4NB    WL0185           Order Number
     C                     Z-ADD#1DPNB    WL0186           Order Sequence
     C                     Z-ADD#1UENB    WL0187           Order Secondary
     C                     MOVEL#1H1ST    WL0188    P      Order Line Erro
     C                     EXSR TZCHRC
     C                     MOVEL'Y'       YL0056           *Reload subfile
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 21=Reallocate  with override freeze time
      * CASE: RCD.*SFLSEL is Option 21
     C           #1SEL     IFEQ '21'                       *IF
      * CASE: RCD.Warehouse Type is Frozen
     C           #RWPST    IFEQ 'FZ'                       *IF
      * RTV Order in Use       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0111           Company Number
     C                     Z-ADD#1C4NB    WL0112           Order Number
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0113    YL0080    P      Order in Use
     C                     MOVELWL0114    YL0081    P      Header Status
     C                     Z-ADDWL0115    #RRMNB           Load ID
      * LCL.Job Date Usr = JOB.*Job date + CON.7 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD7         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0082
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0082
     C                     END
      * val order stuff and load stuff
      * CASE: LCL.Order in Use is yes
     C           YL0080    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0129           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0130           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0130           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: LCL.Header Status is Cancelled
     C           YL0081    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0131           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * val load stuff
      * CASE: RCD.Load ID is GT Zero
     C           #RRMNB    IFGT *ZERO                      *IF
      * Validate
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #RPKST    IFEQ 'I'                        *IF
     C           #RPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0132           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
      * E2824 RMC 10/14/13 allow changes if locked - dont unlock/lock per
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Reallocate if ERROR sts = No,with Alloc-ovrde FZ type "OF"
      * CASE: LCL.Error Status is no
     C           YL0053    IFEQ 'N'                        *IF
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'Y'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * Deallocate
     C                     Z-ADD*ZERO     YL0098           Quantity Ordere
     C                     Z-ADD*ZERO     YL0099           Weight Ordered
     C                     Z-ADD#1CCQT    YL0100           Quantity Schedu
     C                     Z-ADD#1AUWG    YL0101           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0485  30       Company Number
     C                     PARM #1C4NB    WQ0486  70       Order Number
     C                     PARM #1DPNB    WQ0487  30       Order Sequence
     C                     PARM #1UENB    WQ0488  30       Order Secondary
     C                     PARM #1HGCD    WQ0489  70       Item Code
     C                     PARM #1AJCD    WQ0490  3        Warehouse Code
     C                     PARM #1A5DT    WQ0491  70       Ship Date USR
     C                     PARM YL0098    WQ0492 112       Quantity Ordere
     C                     PARM YL0099    WQ0493 112       Weight Ordered
     C           YL0100    PARM YL0100    WQ0494 112       Quantity Schedu
     C           YL0101    PARM YL0101    WQ0495 112       Weight Schedule
     C                     PARM 'OD'      WQ0496  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0497 10        PSAA Program Na
     C                     PARM #1RINY    WQ0498  40       Item Age Days
     C                     PARM #1TIDT    WQ0499  70       Production Ovr
     C                     PARM #1TJDT    WQ0500  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0160           Company Number
     C                     Z-ADD#1C4NB    WL0161           Order Number
     C                     Z-ADD#1DPNB    WL0162           Order Sequence
     C                     Z-ADD#1UENB    WL0163           Order Secondary
     C                     Z-ADDYL0100    WL0164           Quantity Schedu
     C                     Z-ADDYL0101    WL0165           Weight Schedule
     C                     EXSR TUCHRC
      * CHG Released by User  CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0166           Company Number
     C                     Z-ADD#1C4NB    WL0167           Order Number
     C                     Z-ADD#1DPNB    WL0168           Order Sequence
     C                     Z-ADD#1UENB    WL0169           Order Secondary
     C                     MOVEL'N'       WL0170    P      Released by Use
     C                     EXSR TVCHRC
      * Allocate
     C                     Z-ADD#1AVQT    YL0098           Quantity Ordere
     C                     Z-ADD#1D0WG    YL0099           Weight Ordered
     C                     Z-ADD*ZERO     YL0100           Quantity Schedu
     C                     Z-ADD*ZERO     YL0101           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0501  30       Company Number
     C                     PARM #1C4NB    WQ0502  70       Order Number
     C                     PARM #1DPNB    WQ0503  30       Order Sequence
     C                     PARM #1UENB    WQ0504  30       Order Secondary
     C                     PARM #1HGCD    WQ0505  70       Item Code
     C                     PARM #1AJCD    WQ0506  3        Warehouse Code
     C                     PARM #1A5DT    WQ0507  70       Ship Date USR
     C                     PARM YL0098    WQ0508 112       Quantity Ordere
     C                     PARM YL0099    WQ0509 112       Weight Ordered
     C           YL0100    PARM YL0100    WQ0510 112       Quantity Schedu
     C           YL0101    PARM YL0101    WQ0511 112       Weight Schedule
     C                     PARM 'OF'      WQ0512  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0513 10        PSAA Program Na
     C                     PARM #1RINY    WQ0514  40       Item Age Days
     C                     PARM #1TIDT    WQ0515  70       Production Ovr
     C                     PARM #1TJDT    WQ0516  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0160           Company Number
     C                     Z-ADD#1C4NB    WL0161           Order Number
     C                     Z-ADD#1DPNB    WL0162           Order Sequence
     C                     Z-ADD#1UENB    WL0163           Order Secondary
     C                     Z-ADDYL0100    WL0164           Quantity Schedu
     C                     Z-ADDYL0101    WL0165           Weight Schedule
     C                     EXSR TUCHRC
      * * FP1054 update Freeze Time override sts 5/26/09
      * Chg Schedule Shortage CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0176           Company Number
     C                     Z-ADD#1C4NB    WL0177           Order Number
     C                     Z-ADD#1DPNB    WL0178           Order Sequence
     C                     Z-ADD#1UENB    WL0179           Order Secondary
     C                     MOVEL'Z'       WL0180    P      OD Adj Type Ove
     C                     EXSR TXCHRC
      * * Clear the Upload error flags                        C001956
      * CHG Ord Req Revw- flg CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0181           Company Number
     C                     Z-ADD#1C4NB    WL0182           Order Number
     C                     MOVEL*BLANK    WL0183           Order Requires
     C                     EXSR TYCHRC
     C                     MOVEL*BLANK    #1H1ST           Order Line Erro
      * CHG Ord Line Error Typ CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0184           Company Number
     C                     Z-ADD#1C4NB    WL0185           Order Number
     C                     Z-ADD#1DPNB    WL0186           Order Sequence
     C                     Z-ADD#1UENB    WL0187           Order Secondary
     C                     MOVEL#1H1ST    WL0188    P      Order Line Erro
     C                     EXSR TZCHRC
      * * FP1054 Create rcd * RLCORD
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPGRC
     C                     Z-ADD#RRMNB    PGRMNB           Load ID
     C                     Z-ADD*ZERO     PGRVNB           Stop/Drop
     C                     MOVEL'RLCORD'  PGRVST    P      Load Change Typ
     C                     MOVEL'SLS'     PGUJST    P      Department Cont
     C                     MOVEL*BLANK    PGMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PGMOTX    P      Change Log New
     C                     MOVEL##USR     PGAYNA    P      User Id
     C                     MOVEL##PGM     PGA0NA    P      Job Name
     C                     MOVEL#RBZNA    PGBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PGAIC3           Company Number
     C                     Z-ADD#1C4NB    PGC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'N'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
      * *
     C                     MOVEL'Y'       YL0056           *Reload subfile
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0133           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 22=Allocate Inv First or Last-- FP1054 new option, with lock chec
      * CASE: RCD.*SFLSEL is Option 22
     C           #1SEL     IFEQ '22'                       *IF
      * Valid for FREEZER CONVERTED Items and FRESH BASE items
      *         Valid for any BASE order now  6/10/09
      * Validations:
      * CASE:
      *  - ((c1ANDc2) ORc4) ANDc5
      *   |- c1    : RCD.Warehouse Type is Frozen
      *   |- c2    : RCD.Base/Conv/Loss Item is Converted
      *   |- c4    : RCD.Base/Conv/Loss Item is Base
      *   |- c5    : RCD.Requested Ship Date GE JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #RWPST    IFEQ 'FZ'                       *IF
     C           #RQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX02    IFNE '1'                        *IF
     C           #RQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #1A5DT    IFGE ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ABOCE: compare to requested instead of scheduled  8/23/19
      * RTV Order in Use       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0111           Company Number
     C                     Z-ADD#1C4NB    WL0112           Order Number
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0113    YL0080    P      Order in Use
     C                     MOVELWL0114    YL0081    P      Header Status
     C                     Z-ADDWL0115    #RRMNB           Load ID
      * LCL.Job Date Usr = JOB.*Job date + CON.7 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD7         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0082
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0082
     C                     END
      * val order stuff and load stuff
      * CASE: LCL.Order in Use is yes
     C           YL0080    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0134           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0135           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0135           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: LCL.Header Status is Cancelled
     C           YL0081    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0136           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * val load stuff
      * CASE: RCD.Load ID is GT Zero
     C           #RRMNB    IFGT *ZERO                      *IF
      * Validate
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #RPKST    IFEQ 'I'                        *IF
     C           #RPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0137           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
      * E2824 RMC 10/14/13 allow changes if locked - dont unlock/lock per
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0053           Error Status
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0138           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     END                             *FI
      * De/Reallocate if ERROR sts = No
      * CASE: LCL.Error Status is no
     C           YL0053    IFEQ 'N'                        *IF
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'Y'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * Deallocate
     C                     MOVEL#1FZSX    YL0076           OD Adj Type Ove
     C                     Z-ADD*ZERO     YL0098           Quantity Ordere
     C                     Z-ADD*ZERO     YL0099           Weight Ordered
     C                     Z-ADD#1CCQT    YL0100           Quantity Schedu
     C                     Z-ADD#1AUWG    YL0101           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0517  30       Company Number
     C                     PARM #1C4NB    WQ0518  70       Order Number
     C                     PARM #1DPNB    WQ0519  30       Order Sequence
     C                     PARM #1UENB    WQ0520  30       Order Secondary
     C                     PARM #1HGCD    WQ0521  70       Item Code
     C                     PARM #1AJCD    WQ0522  3        Warehouse Code
     C                     PARM #1A5DT    WQ0523  70       Ship Date USR
     C                     PARM YL0098    WQ0524 112       Quantity Ordere
     C                     PARM YL0099    WQ0525 112       Weight Ordered
     C           YL0100    PARM YL0100    WQ0526 112       Quantity Schedu
     C           YL0101    PARM YL0101    WQ0527 112       Weight Schedule
     C                     PARM 'OD'      WQ0528  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0529 10        PSAA Program Na
     C                     PARM #1RINY    WQ0530  40       Item Age Days
     C                     PARM #1TIDT    WQ0531  70       Production Ovr
     C                     PARM #1TJDT    WQ0532  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0160           Company Number
     C                     Z-ADD#1C4NB    WL0161           Order Number
     C                     Z-ADD#1DPNB    WL0162           Order Sequence
     C                     Z-ADD#1UENB    WL0163           Order Secondary
     C                     Z-ADDYL0100    WL0164           Quantity Schedu
     C                     Z-ADDYL0101    WL0165           Weight Schedule
     C                     EXSR TUCHRC
      * CHG Released by User  CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0166           Company Number
     C                     Z-ADD#1C4NB    WL0167           Order Number
     C                     Z-ADD#1DPNB    WL0168           Order Sequence
     C                     Z-ADD#1UENB    WL0169           Order Secondary
     C                     MOVEL'N'       WL0170    P      Released by Use
     C                     EXSR TVCHRC
      * Chg Schedule Override CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0171           Company Number
     C                     Z-ADD#1C4NB    WL0172           Order Number
     C                     Z-ADD#1DPNB    WL0173           Order Sequence
     C                     Z-ADD#1UENB    WL0174           Order Secondary
     C                     MOVEL*BLANK    WL0175           OD Schedule Ove
     C                     EXSR TWCHRC
      * Chg Adj Type Override CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0176           Company Number
     C                     Z-ADD#1C4NB    WL0177           Order Number
     C                     Z-ADD#1DPNB    WL0178           Order Sequence
     C                     Z-ADD#1UENB    WL0179           Order Secondary
     C                     MOVEL*BLANK    WL0180           OD Adj Type Ove
     C                     EXSR TXCHRC
      * Allocate
      * Freezer
      * CASE: RCD.Warehouse Type is Frozen
     C           #RWPST    IFEQ 'FZ'                       *IF
      * CASE:
      *  - c1OR(c2ANDc3)
      *   |- c1    : LCL.OD Adj Type Override is Alloc Inventory First
      *   |- c2    : RCD.Frozen Inv Allocation Seq is First
      *   |- c3    : LCL.OD Adj Type Override is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0076    IFEQ 'F'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #RS1ST    IFEQ 'F'                        *IF
     C           YL0076    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * do other alloc -- which is inventory Last
     C                     MOVEL'L'       #1FZSX           OD Adj Type Ove
     C                     MOVEL'OL'      YL0113           ATS Adj Type US
     C                     ELSE
      * CASE:
      *  - c1OR(c2ANDc3)
      *   |- c1    : LCL.OD Adj Type Override is Alloc Inventory Last
      *   |- c2    : LCL.OD Adj Type Override is Blank
      *   |- c3    : RCD.Frozen Inv Allocation Seq is Last
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0076    IFEQ 'L'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           YL0076    IFEQ *BLANK                     *IF
     C           #RS1ST    IFEQ 'L'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *  do normal alloc -- which is inventory First
     C                     MOVEL'F'       #1FZSX           OD Adj Type Ove
     C                     MOVEL'OI'      YL0113           ATS Adj Type US
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Fresh
      * CASE: RCD.Warehouse Type is Fresh
     C           #RWPST    IFEQ 'FR'                       *IF
      * CASE:
      *  - c1OR(c2ANDc3)
      *   |- c1    : LCL.OD Adj Type Override is Alloc Inventory First
      *   |- c2    : LCL.OD Adj Type Override is Blank
      *   |- c3    : RCD.Fresh Inv Allocation Seq is First
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0076    IFEQ 'F'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           YL0076    IFEQ *BLANK                     *IF
     C           #RSYST    IFEQ 'F'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * do other alloc -- which is inventory Last
     C                     MOVEL'L'       #1FZSX           OD Adj Type Ove
     C                     MOVEL'OL'      YL0113           ATS Adj Type US
     C                     ELSE
      * CASE:
      *  - c1OR(c2ANDc3)
      *   |- c1    : LCL.OD Adj Type Override is Alloc Inventory Last
      *   |- c2    : LCL.OD Adj Type Override is Blank
      *   |- c3    : RCD.Fresh Inv Allocation Seq is Last
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0076    IFEQ 'L'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           YL0076    IFEQ *BLANK                     *IF
     C           #RSYST    IFEQ 'L'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * do normal alloc -- which is inventory First
     C                     MOVEL'F'       #1FZSX           OD Adj Type Ove
     C                     MOVEL'OI'      YL0113           ATS Adj Type US
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD#1AVQT    YL0098           Quantity Ordere
     C                     Z-ADD#1D0WG    YL0099           Weight Ordered
     C                     Z-ADD*ZERO     YL0100           Quantity Schedu
     C                     Z-ADD*ZERO     YL0101           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0533  30       Company Number
     C                     PARM #1C4NB    WQ0534  70       Order Number
     C                     PARM #1DPNB    WQ0535  30       Order Sequence
     C                     PARM #1UENB    WQ0536  30       Order Secondary
     C                     PARM #1HGCD    WQ0537  70       Item Code
     C                     PARM #1AJCD    WQ0538  3        Warehouse Code
     C                     PARM #1A5DT    WQ0539  70       Ship Date USR
     C                     PARM YL0098    WQ0540 112       Quantity Ordere
     C                     PARM YL0099    WQ0541 112       Weight Ordered
     C           YL0100    PARM YL0100    WQ0542 112       Quantity Schedu
     C           YL0101    PARM YL0101    WQ0543 112       Weight Schedule
     C                     PARM YL0113    WQ0544  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0545 10        PSAA Program Na
     C                     PARM #1RINY    WQ0546  40       Item Age Days
     C                     PARM #1TIDT    WQ0547  70       Production Ovr
     C                     PARM #1TJDT    WQ0548  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0160           Company Number
     C                     Z-ADD#1C4NB    WL0161           Order Number
     C                     Z-ADD#1DPNB    WL0162           Order Sequence
     C                     Z-ADD#1UENB    WL0163           Order Secondary
     C                     Z-ADDYL0100    WL0164           Quantity Schedu
     C                     Z-ADDYL0101    WL0165           Weight Schedule
     C                     EXSR TUCHRC
      * Chg Adj Type Override CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0176           Company Number
     C                     Z-ADD#1C4NB    WL0177           Order Number
     C                     Z-ADD#1DPNB    WL0178           Order Sequence
     C                     Z-ADD#1UENB    WL0179           Order Secondary
     C                     MOVEL#1FZSX    WL0180    P      OD Adj Type Ove
     C                     EXSR TXCHRC
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'N'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
      * * FP1054 Create rcd * RLCORD
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPGRC
     C                     Z-ADD#RRMNB    PGRMNB           Load ID
     C                     Z-ADD*ZERO     PGRVNB           Stop/Drop
     C                     MOVEL'RLCORD'  PGRVST    P      Load Change Typ
     C                     MOVEL'SLS'     PGUJST    P      Department Cont
     C                     MOVEL*BLANK    PGMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PGMOTX    P      Change Log New
     C                     MOVEL##USR     PGAYNA    P      User Id
     C                     MOVEL##PGM     PGA0NA    P      Job Name
     C                     MOVEL#RBZNA    PGBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PGAIC3           Company Number
     C                     Z-ADD#1C4NB    PGC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * *
     C                     MOVEL'Y'       YL0056           *Reload subfile
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
     C                     END                             *FI
      * 23=Reallocate  with override freeze time to allow older than 2 yr
      * CASE: RCD.*SFLSEL is Option 23
     C           #1SEL     IFEQ '23'                       *IF
      * CASE: RCD.Warehouse Type is Frozen
     C           #RWPST    IFEQ 'FZ'                       *IF
      * RTV Order in Use       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0111           Company Number
     C                     Z-ADD#1C4NB    WL0112           Order Number
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0113    YL0080    P      Order in Use
     C                     MOVELWL0114    YL0081    P      Header Status
     C                     Z-ADDWL0115    #RRMNB           Load ID
      * LCL.Job Date Usr = JOB.*Job date + CON.7 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD7         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0082
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0082
     C                     END
      * val order stuff and load stuff
      * CASE: LCL.Order in Use is yes
     C           YL0080    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0139           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0140           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0140           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: LCL.Header Status is Cancelled
     C           YL0081    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0141           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * val load stuff
      * CASE: RCD.Load ID is GT Zero
     C           #RRMNB    IFGT *ZERO                      *IF
      * Validate
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #RPKST    IFEQ 'I'                        *IF
     C           #RPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0142           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
      * E2824 RMC 10/14/13 allow changes if locked - dont unlock/lock per
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Reallocate if ERROR sts = No,with Alloc-ovrde FZ type "FO"
      * CASE: LCL.Error Status is no
     C           YL0053    IFEQ 'N'                        *IF
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'Y'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * Deallocate
     C                     Z-ADD*ZERO     YL0098           Quantity Ordere
     C                     Z-ADD*ZERO     YL0099           Weight Ordered
     C                     Z-ADD#1CCQT    YL0100           Quantity Schedu
     C                     Z-ADD#1AUWG    YL0101           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0549  30       Company Number
     C                     PARM #1C4NB    WQ0550  70       Order Number
     C                     PARM #1DPNB    WQ0551  30       Order Sequence
     C                     PARM #1UENB    WQ0552  30       Order Secondary
     C                     PARM #1HGCD    WQ0553  70       Item Code
     C                     PARM #1AJCD    WQ0554  3        Warehouse Code
     C                     PARM #1A5DT    WQ0555  70       Ship Date USR
     C                     PARM YL0098    WQ0556 112       Quantity Ordere
     C                     PARM YL0099    WQ0557 112       Weight Ordered
     C           YL0100    PARM YL0100    WQ0558 112       Quantity Schedu
     C           YL0101    PARM YL0101    WQ0559 112       Weight Schedule
     C                     PARM 'OD'      WQ0560  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0561 10        PSAA Program Na
     C                     PARM #1RINY    WQ0562  40       Item Age Days
     C                     PARM #1TIDT    WQ0563  70       Production Ovr
     C                     PARM #1TJDT    WQ0564  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0160           Company Number
     C                     Z-ADD#1C4NB    WL0161           Order Number
     C                     Z-ADD#1DPNB    WL0162           Order Sequence
     C                     Z-ADD#1UENB    WL0163           Order Secondary
     C                     Z-ADDYL0100    WL0164           Quantity Schedu
     C                     Z-ADDYL0101    WL0165           Weight Schedule
     C                     EXSR TUCHRC
      * CHG Released by User  CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0166           Company Number
     C                     Z-ADD#1C4NB    WL0167           Order Number
     C                     Z-ADD#1DPNB    WL0168           Order Sequence
     C                     Z-ADD#1UENB    WL0169           Order Secondary
     C                     MOVEL'N'       WL0170    P      Released by Use
     C                     EXSR TVCHRC
      * Allocate
     C                     Z-ADD#1AVQT    YL0098           Quantity Ordere
     C                     Z-ADD#1D0WG    YL0099           Weight Ordered
     C                     Z-ADD*ZERO     YL0100           Quantity Schedu
     C                     Z-ADD*ZERO     YL0101           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0565  30       Company Number
     C                     PARM #1C4NB    WQ0566  70       Order Number
     C                     PARM #1DPNB    WQ0567  30       Order Sequence
     C                     PARM #1UENB    WQ0568  30       Order Secondary
     C                     PARM #1HGCD    WQ0569  70       Item Code
     C                     PARM #1AJCD    WQ0570  3        Warehouse Code
     C                     PARM #1A5DT    WQ0571  70       Ship Date USR
     C                     PARM YL0098    WQ0572 112       Quantity Ordere
     C                     PARM YL0099    WQ0573 112       Weight Ordered
     C           YL0100    PARM YL0100    WQ0574 112       Quantity Schedu
     C           YL0101    PARM YL0101    WQ0575 112       Weight Schedule
     C                     PARM 'FO'      WQ0576  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0577 10        PSAA Program Na
     C                     PARM #1RINY    WQ0578  40       Item Age Days
     C                     PARM #1TIDT    WQ0579  70       Production Ovr
     C                     PARM #1TJDT    WQ0580  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0160           Company Number
     C                     Z-ADD#1C4NB    WL0161           Order Number
     C                     Z-ADD#1DPNB    WL0162           Order Sequence
     C                     Z-ADD#1UENB    WL0163           Order Secondary
     C                     Z-ADDYL0100    WL0164           Quantity Schedu
     C                     Z-ADDYL0101    WL0165           Weight Schedule
     C                     EXSR TUCHRC
      * * FP1054 update Freeze Time override sts 5/26/09
      * Chg Adj Type Override CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0176           Company Number
     C                     Z-ADD#1C4NB    WL0177           Order Number
     C                     Z-ADD#1DPNB    WL0178           Order Sequence
     C                     Z-ADD#1UENB    WL0179           Order Secondary
     C                     MOVEL'O'       WL0180    P      OD Adj Type Ove
     C                     EXSR TXCHRC
      * * Clear the Upload error flags                        C001956
      * CHG Ord Req Revw- flg CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0181           Company Number
     C                     Z-ADD#1C4NB    WL0182           Order Number
     C                     MOVEL*BLANK    WL0183           Order Requires
     C                     EXSR TYCHRC
     C                     MOVEL*BLANK    #1H1ST           Order Line Erro
      * CHG Ord Line Error Typ CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0184           Company Number
     C                     Z-ADD#1C4NB    WL0185           Order Number
     C                     Z-ADD#1DPNB    WL0186           Order Sequence
     C                     Z-ADD#1UENB    WL0187           Order Secondary
     C                     MOVEL#1H1ST    WL0188    P      Order Line Erro
     C                     EXSR TZCHRC
      * * FP1054 Create rcd * RLCORD
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPGRC
     C                     Z-ADD#RRMNB    PGRMNB           Load ID
     C                     Z-ADD*ZERO     PGRVNB           Stop/Drop
     C                     MOVEL'RLCORD'  PGRVST    P      Load Change Typ
     C                     MOVEL'SLS'     PGUJST    P      Department Cont
     C                     MOVEL*BLANK    PGMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PGMOTX    P      Change Log New
     C                     MOVEL##USR     PGAYNA    P      User Id
     C                     MOVEL##PGM     PGA0NA    P      Job Name
     C                     MOVEL#RBZNA    PGBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PGAIC3           Company Number
     C                     Z-ADD#1C4NB    PGC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'N'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
      * *
     C                     MOVEL'Y'       YL0056           *Reload subfile
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0143           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 2=Edit Schedule Production
      * CASE: RCD.*SFLSEL is Option 2
     C           #1SEL     IFEQ '2'                        *IF
     C           #1SEL     OREQ ' 2'
     C                     MOVEL'Y'       #RR4ST           USR Update Flag
      * RTV Order in Use       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0111           Company Number
     C                     Z-ADD#1C4NB    WL0112           Order Number
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0113    YL0080    P      Order in Use
     C                     MOVELWL0114    YL0081    P      Header Status
     C                     Z-ADDWL0115    #RRMNB           Load ID
      * LCL.Job Date Usr = JOB.*Job date + CON.7 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD7         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0082
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0082
     C                     END
      * val order stuff and load stuff
      * CASE: LCL.Order in Use is yes
     C           YL0080    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0144           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0145           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0145           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: LCL.Header Status is Cancelled
     C           YL0081    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0146           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * val load stuff
      * CASE: RCD.Load ID is GT Zero
     C           #RRMNB    IFGT *ZERO                      *IF
      * Validate
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #RPKST    IFEQ 'I'                        *IF
     C           #RPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0147           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
      * E2824 RMC 10/14/13 allow changes if locked - dont unlock/lock per
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Deallocate if ERROR Sts = No and Process entries
      * CASE: LCL.Error Status is no
     C           YL0053    IFEQ 'N'                        *IF
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * ************
     C                     MOVEL*BLANK    P2Z4ST           OD Schedule Ove
      * Deallocate if any qty sched ord was changed
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6
      *   |- c1    : RCD.Qty Sched Ord 1 USR NE RCD.Qty Sched Prod 1 USR
      *   |- c2    : RCD.Qty Sched Ord 2 USR NE RCD.Qty Sched Prod 2 USR
      *   |- c3    : RCD.Qty Sched Ord 3 USR NE RCD.Qty Sched Prod 3 USR
      *   |- c4    : RCD.Qty Sched Ord 4 USR NE RCD.Qty Sched Prod 4 USR
      *   |- c5    : RCD.Qty Sched Ord 5 USR NE RCD.Qty Sched Prod 5 USR
      *   |- c6    : RCD.Qty Sched Ord 6 USR NE RCD.Qty Sched Prod 6 USR
      *   '-
     C           #RLKQT    IFNE #RLIQT                     *IF
     C           #RLLQT    ORNE #RLJQT                     *OR
     C           #RLVQT    ORNE #RLWQT                     *OR
     C           #RMOQT    ORNE #RM9QT                     *OR
     C           #RMPQT    ORNE #RNAQT                     *OR
     C           #RMQQT    ORNE #RNOQT                     *OR
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'Y'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
     C                     Z-ADD*ZERO     YL0098           Quantity Ordere
     C                     Z-ADD*ZERO     YL0099           Weight Ordered
     C                     Z-ADD#1CCQT    YL0100           Quantity Schedu
     C                     Z-ADD#1AUWG    YL0101           Weight Schedule
      * 1/04/2013 RMC Dont Deallocate inventory -- just sched production
     C           #1CCQT    SUB  #RKGNX    YL0100           Quantity Schedu
      * 06/07/17 DN T10731-Per RC, commented out codes not in PROD.
      * 06/07/17 DN T10731-Reinstate PROD code.
     C           #1AUWG    SUB  YL0099    YL0101           Weight Schedule
      * ************
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0581  30       Company Number
     C                     PARM #1C4NB    WQ0582  70       Order Number
     C                     PARM #1DPNB    WQ0583  30       Order Sequence
     C                     PARM #1UENB    WQ0584  30       Order Secondary
     C                     PARM #1HGCD    WQ0585  70       Item Code
     C                     PARM #1AJCD    WQ0586  3        Warehouse Code
     C                     PARM #1A5DT    WQ0587  70       Ship Date USR
     C                     PARM YL0098    WQ0588 112       Quantity Ordere
     C                     PARM YL0099    WQ0589 112       Weight Ordered
     C           YL0100    PARM YL0100    WQ0590 112       Quantity Schedu
     C           YL0101    PARM YL0101    WQ0591 112       Weight Schedule
     C                     PARM 'OD'      WQ0592  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0593 10        PSAA Program Na
     C                     PARM #1RINY    WQ0594  40       Item Age Days
     C                     PARM #1TIDT    WQ0595  70       Production Ovr
     C                     PARM #1TJDT    WQ0596  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * ************
      * 1/04/13 leave inv in sched - moved here from under the chgobjs be
     C                     Z-ADD#RKGNX    #1CCQT           Quantity Schedu
     C           #RAIWG    MULT #RKGNX    #1AUWG           Weight Schedule
     C                     Z-ADD#RKGNX    YL0100           Quantity Schedu
     C                     Z-ADD#1AUWG    YL0101           Weight Schedule
      * ************
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0160           Company Number
     C                     Z-ADD#1C4NB    WL0161           Order Number
     C                     Z-ADD#1DPNB    WL0162           Order Sequence
     C                     Z-ADD#1UENB    WL0163           Order Secondary
     C                     Z-ADDYL0100    WL0164           Quantity Schedu
     C                     Z-ADDYL0101    WL0165           Weight Schedule
     C                     EXSR TUCHRC
      * CHG Released by User  CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0166           Company Number
     C                     Z-ADD#1C4NB    WL0167           Order Number
     C                     Z-ADD#1DPNB    WL0168           Order Sequence
     C                     Z-ADD#1UENB    WL0169           Order Secondary
     C                     MOVEL'N'       WL0170    P      Released by Use
     C                     EXSR TVCHRC
      * Chg Schedule Override CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0171           Company Number
     C                     Z-ADD#1C4NB    WL0172           Order Number
     C                     Z-ADD#1DPNB    WL0173           Order Sequence
     C                     Z-ADD#1UENB    WL0174           Order Secondary
     C                     MOVEL'Y'       WL0175    P      OD Schedule Ove
     C                     EXSR TWCHRC
     C                     MOVEL'Y'       P2Z4ST           OD Schedule Ove
     C                     Z-ADD*ZERO     #RJ8NX           Production
     C                     Z-ADD#RKGNX    #RNRQT           Quantity Sched
     C                     MOVEL'Y'       YL0055           Post Flag USR
      * *
     C                     END                             *FI
      * Show fields as input
     C                     MOVEL'N'       #RLISX           Output Only 1 U
      * *Set Cursor: RCD.Qty Sched Ord 1 USR  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ZZSFM     IFEQ '1'
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C                     ELSE
     C           ##SFPG    DIV  003       ##RRN   50
     C           ##RR      DIV  ##RRN     ##RRC   50
     C                     MVR            ##RRC
     C           ##RRC     IFEQ 0
     C                     Z-ADD##RRN     ##RRC
     C                     ENDIF
     C           ##RRC     DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C                     ENDIF
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C           ZZSFM     IFEQ '0'
     C                     MULT 003       W0ROW0
     C                     ENDIF
     C                     ADD  015       W0ROW0
     C                     Z-ADD081       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
      * ******** OPTION 2 **********
      * CHG: Process Scheduled Production days 1 - 6 entries
      * CASE: PAR.OD Schedule Override Sts is Yes
     C           P2Z4ST    IFEQ 'Y'                        *IF
      * C0476 - look at next day as in the case of hold overs
      * RMC 8/23/19- look at requested instead of scheduled
      * LCL.Scheduled Ship Date USR = RCD.Requested Ship Date + CON.1 *DA
     C           #1A5DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0111
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0111
     C                     END
      * Scheduled Production 1
      * CASE: RCD.Qty Sched Ord 1 USR is GT Zero
     C           #RLKQT    IFGT *ZERO                      *IF
      * VAL:  Production Date
      * CASE: CTL.USR Day 1 LT RCD.Production Date RGF
     C           #CFFDT    IFLT #RGVDT                     *IF
      * Setup message data for message
      * Convert USR Day 1 to display format
      * Convert date
     C           1000000   ADD  #CFFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0148
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0149
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0150
     C                     Z-ADD#RLKQT    ZA0151           Qty Sched Ord 1
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9844  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: CTL.USR Day 1 GT LCL.Scheduled Ship Date USR
     C           #CFFDT    IFGT YL0111                     *IF
      * Setup message data for message
      * Convert USR Day 1 to display format
      * Convert date
     C           1000000   ADD  #CFFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0152
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0153
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0154
     C                     Z-ADD#RLKQT    ZA0155           Qty Sched Ord 1
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9844  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     #RLIQT           Qty Sched Prod
      * E3796 JJH 02/18/15 - On call to "WW OrdPrdSch Upd Prod XF" change
      *  "I  Scheduled Ship Date   FLD   RCD Scheduled Ship Date" to
      *  "I  Scheduled Ship Date   FLD   RCD Requested Ship Date"
      * WW OrdPrdSch Upd Prod XF - Order Detail  * 
     C                     CALL 'POUEXFR'              90  WW OrdPrdSch Up
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0597  30       Company Number
     C                     PARM #1C4NB    WQ0598  70       Order Number
     C                     PARM #1DPNB    WQ0599  30       Order Sequence
     C                     PARM #1UENB    WQ0600  30       Order Secondary
     C                     PARM #1HGCD    WQ0601  70       Item Code
     C                     PARM #1AJCD    WQ0602  3        Warehouse Code
     C                     PARM #RFWST    WQ0603  1        Age Code
     C                     PARM #1AVQT    WQ0604 112       Quantity Ordere
     C                     PARM #1A5DT    WQ0605  70       Scheduled Ship
     C                     PARM #1FZSX    WQ0606  1        OD Adj Type Ove
     C                     PARM #1RINY    WQ0607  40       Item Age Days
     C                     PARM #1TIDT    WQ0608  70       Production Ovr
     C                     PARM #1TJDT    WQ0609  70       Production Ovr
     C                     PARM #CFFDT    WQ0610  70       Production Date
     C                     PARM #RGVDT    WQ0611  70       Production Date
     C                     PARM #1AODT    WQ0612  70       Production Date
     C           #RNRQT    PARM #RNRQT    WQ0613  50       Quantity Sched
     C           #1CCQT    PARM #1CCQT    WQ0614 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0615 112       Weight Schedule
     C           #RLKQT    PARM #RLKQT    WQ0616  50       Qty Sched Ord U
     C           #RLIQT    PARM #RLIQT    WQ0617  50       Qty Sched Prod
     C           #RJ8NX    PARM #RJ8NX    WQ0618  50       Production
     C           #RKGNX    PARM #RKGNX    WQ0619  50       Inv Total
     C           #RNSQT    PARM #RNSQT    WQ0620  50       ODS Quantity Sh
     C           #RHLSX    PARM *BLANK    WQ0621  1        Reverse Image F
     C                     PARM #RADCD    WQ0622  2        U/M - Primary
     C                     PARM #RAIWG    WQ0623 112       Unit Weight
     C                     PARM *ZERO     WQ0624  52       Fresh Chilling
     C                     PARM #RQZCD    WQ0625  2        Base/Conv/Loss
     C                     PARM #RR3CD    WQ0626  6        Department Code
     C                     PARM #RPCCT    WQ0627  1        Piece Count Ite
     C                     PARM #RBDNB    WQ0628  70       Pieces Per Bag
     C                     PARM #RBJNB    WQ0629  70       Bags Per Unit
     C                     PARM #RSUST    WQ0630  1        Export/Domestic
     C                     PARM #RSVST    WQ0631  1        Print On Schedu
     C                     PARM #RSYST    WQ0632  1        Fresh Inv Alloc
     C                     PARM #RSZST    WQ0633  1        Fresh Sched As
     C                     PARM #RS1ST    WQ0634  1        Frozen Inv Allo
     C                     PARM #RXRCD    WQ0635  6        Primal Group Co
     C                     PARM #RWPST    WQ0636  2        Warehouse Type
     C                     PARM #RT1ST    WQ0637  1        Warehouse Std C
     C                     PARM #RDBNB    WQ0638  52       Warehouse Chill
     C                     PARM #RBVC3    WQ0639  30       WHS Inventory C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POUEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9844  *
     C                     END
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
      * Scheduled Production 2
      * CASE: RCD.Qty Sched Ord 2 USR is GT Zero
     C           #RLLQT    IFGT *ZERO                      *IF
      * VAL:  Production Date
      * CASE: CTL.USR Day 2 LT RCD.Production Date RGF
     C           #CE1DT    IFLT #RGVDT                     *IF
      * Setup message data for message
      * Convert USR Day 2 to display format
      * Convert date
     C           1000000   ADD  #CE1DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0156
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0157
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0158
     C                     Z-ADD#RLLQT    ZA0159           Qty Sched Ord 2
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: CTL.USR Day 2 GT LCL.Scheduled Ship Date USR
     C           #CE1DT    IFGT YL0111                     *IF
      * Setup message data for message
      * Convert USR Day 2 to display format
      * Convert date
     C           1000000   ADD  #CE1DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0160
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0161
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0162
     C                     Z-ADD#RLLQT    ZA0163           Qty Sched Ord 2
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     #RLJQT           Qty Sched Prod
      * E3796 JJH 02/18/15 - On call to "WW OrdPrdSch Upd Prod XF" change
      *  "I  Scheduled Ship Date   FLD   RCD Scheduled Ship Date" to
      *  "I  Scheduled Ship Date   FLD   RCD Requested Ship Date"
      * WW OrdPrdSch Upd Prod XF - Order Detail  * 
     C                     CALL 'POUEXFR'              90  WW OrdPrdSch Up
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0640  30       Company Number
     C                     PARM #1C4NB    WQ0641  70       Order Number
     C                     PARM #1DPNB    WQ0642  30       Order Sequence
     C                     PARM #1UENB    WQ0643  30       Order Secondary
     C                     PARM #1HGCD    WQ0644  70       Item Code
     C                     PARM #1AJCD    WQ0645  3        Warehouse Code
     C                     PARM #RFWST    WQ0646  1        Age Code
     C                     PARM #1AVQT    WQ0647 112       Quantity Ordere
     C                     PARM #1A5DT    WQ0648  70       Scheduled Ship
     C                     PARM #1FZSX    WQ0649  1        OD Adj Type Ove
     C                     PARM #1RINY    WQ0650  40       Item Age Days
     C                     PARM #1TIDT    WQ0651  70       Production Ovr
     C                     PARM #1TJDT    WQ0652  70       Production Ovr
     C                     PARM #CE1DT    WQ0653  70       Production Date
     C                     PARM #RGVDT    WQ0654  70       Production Date
     C                     PARM #1AODT    WQ0655  70       Production Date
     C           #RNRQT    PARM #RNRQT    WQ0656  50       Quantity Sched
     C           #1CCQT    PARM #1CCQT    WQ0657 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0658 112       Weight Schedule
     C           #RLLQT    PARM #RLLQT    WQ0659  50       Qty Sched Ord U
     C           #RLJQT    PARM #RLJQT    WQ0660  50       Qty Sched Prod
     C           #RJ8NX    PARM #RJ8NX    WQ0661  50       Production
     C           #RKGNX    PARM #RKGNX    WQ0662  50       Inv Total
     C           #RNSQT    PARM #RNSQT    WQ0663  50       ODS Quantity Sh
     C           #RHLSX    PARM *BLANK    WQ0664  1        Reverse Image F
     C                     PARM #RADCD    WQ0665  2        U/M - Primary
     C                     PARM #RAIWG    WQ0666 112       Unit Weight
     C                     PARM *ZERO     WQ0667  52       Fresh Chilling
     C                     PARM #RQZCD    WQ0668  2        Base/Conv/Loss
     C                     PARM #RR3CD    WQ0669  6        Department Code
     C                     PARM #RPCCT    WQ0670  1        Piece Count Ite
     C                     PARM #RBDNB    WQ0671  70       Pieces Per Bag
     C                     PARM #RBJNB    WQ0672  70       Bags Per Unit
     C                     PARM #RSUST    WQ0673  1        Export/Domestic
     C                     PARM #RSVST    WQ0674  1        Print On Schedu
     C                     PARM #RSYST    WQ0675  1        Fresh Inv Alloc
     C                     PARM #RSZST    WQ0676  1        Fresh Sched As
     C                     PARM #RS1ST    WQ0677  1        Frozen Inv Allo
     C                     PARM #RXRCD    WQ0678  6        Primal Group Co
     C                     PARM #RWPST    WQ0679  2        Warehouse Type
     C                     PARM #RT1ST    WQ0680  1        Warehouse Std C
     C                     PARM #RDBNB    WQ0681  52       Warehouse Chill
     C                     PARM #RBVC3    WQ0682  30       WHS Inventory C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POUEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9845  *
     C                     END
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
      * Scheduled Production 3
      * CASE: RCD.Qty Sched Ord 3 USR is GT Zero
     C           #RLVQT    IFGT *ZERO                      *IF
      * VAL:  Production Date
      * CASE: CTL.USR Day 3 LT RCD.Production Date RGF
     C           #CE2DT    IFLT #RGVDT                     *IF
      * Setup message data for message
      * Convert USR Day 3 to display format
      * Convert date
     C           1000000   ADD  #CE2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0164
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0165
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0166
     C                     Z-ADD#RLVQT    ZA0167           Qty Sched Ord 3
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9846  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: CTL.USR Day 3 GT LCL.Scheduled Ship Date USR
     C           #CE2DT    IFGT YL0111                     *IF
      * Setup message data for message
      * Convert USR Day 3 to display format
      * Convert date
     C           1000000   ADD  #CE2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0168
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0169
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0170
     C                     Z-ADD#RLVQT    ZA0171           Qty Sched Ord 3
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9846  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     #RLWQT           Qty Sched Prod
      * E3796 JJH 02/18/15 - On call to "WW OrdPrdSch Upd Prod XF" change
      *  "I  Scheduled Ship Date   FLD   RCD Scheduled Ship Date" to
      *  "I  Scheduled Ship Date   FLD   RCD Requested Ship Date"
      * WW OrdPrdSch Upd Prod XF - Order Detail  * 
     C                     CALL 'POUEXFR'              90  WW OrdPrdSch Up
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0683  30       Company Number
     C                     PARM #1C4NB    WQ0684  70       Order Number
     C                     PARM #1DPNB    WQ0685  30       Order Sequence
     C                     PARM #1UENB    WQ0686  30       Order Secondary
     C                     PARM #1HGCD    WQ0687  70       Item Code
     C                     PARM #1AJCD    WQ0688  3        Warehouse Code
     C                     PARM #RFWST    WQ0689  1        Age Code
     C                     PARM #1AVQT    WQ0690 112       Quantity Ordere
     C                     PARM #1A5DT    WQ0691  70       Scheduled Ship
     C                     PARM #1FZSX    WQ0692  1        OD Adj Type Ove
     C                     PARM #1RINY    WQ0693  40       Item Age Days
     C                     PARM #1TIDT    WQ0694  70       Production Ovr
     C                     PARM #1TJDT    WQ0695  70       Production Ovr
     C                     PARM #CE2DT    WQ0696  70       Production Date
     C                     PARM #RGVDT    WQ0697  70       Production Date
     C                     PARM #1AODT    WQ0698  70       Production Date
     C           #RNRQT    PARM #RNRQT    WQ0699  50       Quantity Sched
     C           #1CCQT    PARM #1CCQT    WQ0700 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0701 112       Weight Schedule
     C           #RLVQT    PARM #RLVQT    WQ0702  50       Qty Sched Ord U
     C           #RLWQT    PARM #RLWQT    WQ0703  50       Qty Sched Prod
     C           #RJ8NX    PARM #RJ8NX    WQ0704  50       Production
     C           #RKGNX    PARM #RKGNX    WQ0705  50       Inv Total
     C           #RNSQT    PARM #RNSQT    WQ0706  50       ODS Quantity Sh
     C           #RHLSX    PARM *BLANK    WQ0707  1        Reverse Image F
     C                     PARM #RADCD    WQ0708  2        U/M - Primary
     C                     PARM #RAIWG    WQ0709 112       Unit Weight
     C                     PARM *ZERO     WQ0710  52       Fresh Chilling
     C                     PARM #RQZCD    WQ0711  2        Base/Conv/Loss
     C                     PARM #RR3CD    WQ0712  6        Department Code
     C                     PARM #RPCCT    WQ0713  1        Piece Count Ite
     C                     PARM #RBDNB    WQ0714  70       Pieces Per Bag
     C                     PARM #RBJNB    WQ0715  70       Bags Per Unit
     C                     PARM #RSUST    WQ0716  1        Export/Domestic
     C                     PARM #RSVST    WQ0717  1        Print On Schedu
     C                     PARM #RSYST    WQ0718  1        Fresh Inv Alloc
     C                     PARM #RSZST    WQ0719  1        Fresh Sched As
     C                     PARM #RS1ST    WQ0720  1        Frozen Inv Allo
     C                     PARM #RXRCD    WQ0721  6        Primal Group Co
     C                     PARM #RWPST    WQ0722  2        Warehouse Type
     C                     PARM #RT1ST    WQ0723  1        Warehouse Std C
     C                     PARM #RDBNB    WQ0724  52       Warehouse Chill
     C                     PARM #RBVC3    WQ0725  30       WHS Inventory C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POUEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9846  *
     C                     END
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
      * Scheduled Production 4
      * CASE: RCD.Qty Sched Ord 4 USR is GT 0
     C           #RMOQT    IFGT 0                          *IF
      * VAL:  Production Date
      * CASE: CTL.USR Day 4 LT RCD.Production Date RGF
     C           #CE3DT    IFLT #RGVDT                     *IF
      * Setup message data for message
      * Convert USR Day 4 to display format
      * Convert date
     C           1000000   ADD  #CE3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0172
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0173
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0174
     C                     Z-ADD#RMOQT    ZA0175           Qty Sched Ord 4
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9847  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: CTL.USR Day 4 GT LCL.Scheduled Ship Date USR
     C           #CE3DT    IFGT YL0111                     *IF
      * Setup message data for message
      * Convert USR Day 4 to display format
      * Convert date
     C           1000000   ADD  #CE3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0176
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0177
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0178
     C                     Z-ADD#RMOQT    ZA0179           Qty Sched Ord 4
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9847  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     #RM9QT           Qty Sched Prod
      * E3796 JJH 02/18/15 - On call to "WW OrdPrdSch Upd Prod XF" change
      *  "I  Scheduled Ship Date   FLD   RCD Scheduled Ship Date" to
      *  "I  Scheduled Ship Date   FLD   RCD Requested Ship Date"
      * WW OrdPrdSch Upd Prod XF - Order Detail  * 
     C                     CALL 'POUEXFR'              90  WW OrdPrdSch Up
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0726  30       Company Number
     C                     PARM #1C4NB    WQ0727  70       Order Number
     C                     PARM #1DPNB    WQ0728  30       Order Sequence
     C                     PARM #1UENB    WQ0729  30       Order Secondary
     C                     PARM #1HGCD    WQ0730  70       Item Code
     C                     PARM #1AJCD    WQ0731  3        Warehouse Code
     C                     PARM #RFWST    WQ0732  1        Age Code
     C                     PARM #1AVQT    WQ0733 112       Quantity Ordere
     C                     PARM #1A5DT    WQ0734  70       Scheduled Ship
     C                     PARM #1FZSX    WQ0735  1        OD Adj Type Ove
     C                     PARM #1RINY    WQ0736  40       Item Age Days
     C                     PARM #1TIDT    WQ0737  70       Production Ovr
     C                     PARM #1TJDT    WQ0738  70       Production Ovr
     C                     PARM #CE3DT    WQ0739  70       Production Date
     C                     PARM #RGVDT    WQ0740  70       Production Date
     C                     PARM #1AODT    WQ0741  70       Production Date
     C           #RNRQT    PARM #RNRQT    WQ0742  50       Quantity Sched
     C           #1CCQT    PARM #1CCQT    WQ0743 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0744 112       Weight Schedule
     C           #RMOQT    PARM #RMOQT    WQ0745  50       Qty Sched Ord U
     C           #RM9QT    PARM #RM9QT    WQ0746  50       Qty Sched Prod
     C           #RJ8NX    PARM #RJ8NX    WQ0747  50       Production
     C           #RKGNX    PARM #RKGNX    WQ0748  50       Inv Total
     C           #RNSQT    PARM #RNSQT    WQ0749  50       ODS Quantity Sh
     C           #RHLSX    PARM *BLANK    WQ0750  1        Reverse Image F
     C                     PARM #RADCD    WQ0751  2        U/M - Primary
     C                     PARM #RAIWG    WQ0752 112       Unit Weight
     C                     PARM *ZERO     WQ0753  52       Fresh Chilling
     C                     PARM #RQZCD    WQ0754  2        Base/Conv/Loss
     C                     PARM #RR3CD    WQ0755  6        Department Code
     C                     PARM #RPCCT    WQ0756  1        Piece Count Ite
     C                     PARM #RBDNB    WQ0757  70       Pieces Per Bag
     C                     PARM #RBJNB    WQ0758  70       Bags Per Unit
     C                     PARM #RSUST    WQ0759  1        Export/Domestic
     C                     PARM #RSVST    WQ0760  1        Print On Schedu
     C                     PARM #RSYST    WQ0761  1        Fresh Inv Alloc
     C                     PARM #RSZST    WQ0762  1        Fresh Sched As
     C                     PARM #RS1ST    WQ0763  1        Frozen Inv Allo
     C                     PARM #RXRCD    WQ0764  6        Primal Group Co
     C                     PARM #RWPST    WQ0765  2        Warehouse Type
     C                     PARM #RT1ST    WQ0766  1        Warehouse Std C
     C                     PARM #RDBNB    WQ0767  52       Warehouse Chill
     C                     PARM #RBVC3    WQ0768  30       WHS Inventory C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POUEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9847  *
     C                     END
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
      * Scheduled Production 5
      * CASE: RCD.Qty Sched Ord 5 USR is GT 0
     C           #RMPQT    IFGT *ZERO                      *IF
      * VAL:  Production Date
      * CASE: CTL.USR Day 5 LT RCD.Production Date RGF
     C           #CE4DT    IFLT #RGVDT                     *IF
      * Setup message data for message
      * Convert USR Day 5 to display format
      * Convert date
     C           1000000   ADD  #CE4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0180
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0181
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0182
     C                     Z-ADD#RMPQT    ZA0183           Qty Sched Ord 5
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9848  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: CTL.USR Day 5 GT LCL.Scheduled Ship Date USR
     C           #CE4DT    IFGT YL0111                     *IF
      * Setup message data for message
      * Convert USR Day 5 to display format
      * Convert date
     C           1000000   ADD  #CE4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0184
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0185
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0186
     C                     Z-ADD#RMPQT    ZA0187           Qty Sched Ord 5
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9848  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     #RNAQT           Qty Sched Prod
      * E3796 JJH 02/18/15 - On call to "WW OrdPrdSch Upd Prod XF" change
      *  "I  Scheduled Ship Date   FLD   RCD Scheduled Ship Date" to
      *  "I  Scheduled Ship Date   FLD   RCD Requested Ship Date"
      * WW OrdPrdSch Upd Prod XF - Order Detail  * 
     C                     CALL 'POUEXFR'              90  WW OrdPrdSch Up
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0769  30       Company Number
     C                     PARM #1C4NB    WQ0770  70       Order Number
     C                     PARM #1DPNB    WQ0771  30       Order Sequence
     C                     PARM #1UENB    WQ0772  30       Order Secondary
     C                     PARM #1HGCD    WQ0773  70       Item Code
     C                     PARM #1AJCD    WQ0774  3        Warehouse Code
     C                     PARM #RFWST    WQ0775  1        Age Code
     C                     PARM #1AVQT    WQ0776 112       Quantity Ordere
     C                     PARM #1A5DT    WQ0777  70       Scheduled Ship
     C                     PARM #1FZSX    WQ0778  1        OD Adj Type Ove
     C                     PARM #1RINY    WQ0779  40       Item Age Days
     C                     PARM #1TIDT    WQ0780  70       Production Ovr
     C                     PARM #1TJDT    WQ0781  70       Production Ovr
     C                     PARM #CE4DT    WQ0782  70       Production Date
     C                     PARM #RGVDT    WQ0783  70       Production Date
     C                     PARM #1AODT    WQ0784  70       Production Date
     C           #RNRQT    PARM #RNRQT    WQ0785  50       Quantity Sched
     C           #1CCQT    PARM #1CCQT    WQ0786 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0787 112       Weight Schedule
     C           #RMPQT    PARM #RMPQT    WQ0788  50       Qty Sched Ord U
     C           #RNAQT    PARM #RNAQT    WQ0789  50       Qty Sched Prod
     C           #RJ8NX    PARM #RJ8NX    WQ0790  50       Production
     C           #RKGNX    PARM #RKGNX    WQ0791  50       Inv Total
     C           #RNSQT    PARM #RNSQT    WQ0792  50       ODS Quantity Sh
     C           #RHLSX    PARM *BLANK    WQ0793  1        Reverse Image F
     C                     PARM #RADCD    WQ0794  2        U/M - Primary
     C                     PARM #RAIWG    WQ0795 112       Unit Weight
     C                     PARM *ZERO     WQ0796  52       Fresh Chilling
     C                     PARM #RQZCD    WQ0797  2        Base/Conv/Loss
     C                     PARM #RR3CD    WQ0798  6        Department Code
     C                     PARM #RPCCT    WQ0799  1        Piece Count Ite
     C                     PARM #RBDNB    WQ0800  70       Pieces Per Bag
     C                     PARM #RBJNB    WQ0801  70       Bags Per Unit
     C                     PARM #RSUST    WQ0802  1        Export/Domestic
     C                     PARM #RSVST    WQ0803  1        Print On Schedu
     C                     PARM #RSYST    WQ0804  1        Fresh Inv Alloc
     C                     PARM #RSZST    WQ0805  1        Fresh Sched As
     C                     PARM #RS1ST    WQ0806  1        Frozen Inv Allo
     C                     PARM #RXRCD    WQ0807  6        Primal Group Co
     C                     PARM #RWPST    WQ0808  2        Warehouse Type
     C                     PARM #RT1ST    WQ0809  1        Warehouse Std C
     C                     PARM #RDBNB    WQ0810  52       Warehouse Chill
     C                     PARM #RBVC3    WQ0811  30       WHS Inventory C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POUEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9848  *
     C                     END
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
      * Scheduled Production 6
      * CASE: RCD.Qty Sched Ord 6 USR is GT 0
     C           #RMQQT    IFGT 0                          *IF
      * VAL:  Production Date
      * CASE: CTL.USR Day 6 LT RCD.Production Date RGF
     C           #CE5DT    IFLT #RGVDT                     *IF
      * Setup message data for message
      * Convert USR Day 6 to display format
      * Convert date
     C           1000000   ADD  #CE5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0188
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0189
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0190
     C                     Z-ADD#RMQQT    ZA0191           Qty Sched Ord 6
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9849  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: CTL.USR Day 6 GT LCL.Scheduled Ship Date USR
     C           #CE5DT    IFGT YL0111                     *IF
      * Setup message data for message
      * Convert USR Day 6 to display format
      * Convert date
     C           1000000   ADD  #CE5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0192
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0193
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0194
     C                     Z-ADD#RMQQT    ZA0195           Qty Sched Ord 6
      * Send message 'Prod Date Not In Range'
     C                     MOVEL'USR2461' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9849  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     #RNOQT           Qty Sched Prod
      * E3796 JJH 02/18/15 - On call to "WW OrdPrdSch Upd Prod XF" change
      *  "I  Scheduled Ship Date   FLD   RCD Scheduled Ship Date" to
      *  "I  Scheduled Ship Date   FLD   RCD Requested Ship Date"
      * WW OrdPrdSch Upd Prod XF - Order Detail  * 
     C                     CALL 'POUEXFR'              90  WW OrdPrdSch Up
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0812  30       Company Number
     C                     PARM #1C4NB    WQ0813  70       Order Number
     C                     PARM #1DPNB    WQ0814  30       Order Sequence
     C                     PARM #1UENB    WQ0815  30       Order Secondary
     C                     PARM #1HGCD    WQ0816  70       Item Code
     C                     PARM #1AJCD    WQ0817  3        Warehouse Code
     C                     PARM #RFWST    WQ0818  1        Age Code
     C                     PARM #1AVQT    WQ0819 112       Quantity Ordere
     C                     PARM #1A5DT    WQ0820  70       Scheduled Ship
     C                     PARM #1FZSX    WQ0821  1        OD Adj Type Ove
     C                     PARM #1RINY    WQ0822  40       Item Age Days
     C                     PARM #1TIDT    WQ0823  70       Production Ovr
     C                     PARM #1TJDT    WQ0824  70       Production Ovr
     C                     PARM #CE5DT    WQ0825  70       Production Date
     C                     PARM #RGVDT    WQ0826  70       Production Date
     C                     PARM #1AODT    WQ0827  70       Production Date
     C           #RNRQT    PARM #RNRQT    WQ0828  50       Quantity Sched
     C           #1CCQT    PARM #1CCQT    WQ0829 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0830 112       Weight Schedule
     C           #RMQQT    PARM #RMQQT    WQ0831  50       Qty Sched Ord U
     C           #RNOQT    PARM #RNOQT    WQ0832  50       Qty Sched Prod
     C           #RJ8NX    PARM #RJ8NX    WQ0833  50       Production
     C           #RKGNX    PARM #RKGNX    WQ0834  50       Inv Total
     C           #RNSQT    PARM #RNSQT    WQ0835  50       ODS Quantity Sh
     C           #RHLSX    PARM *BLANK    WQ0836  1        Reverse Image F
     C                     PARM #RADCD    WQ0837  2        U/M - Primary
     C                     PARM #RAIWG    WQ0838 112       Unit Weight
     C                     PARM *ZERO     WQ0839  52       Fresh Chilling
     C                     PARM #RQZCD    WQ0840  2        Base/Conv/Loss
     C                     PARM #RR3CD    WQ0841  6        Department Code
     C                     PARM #RPCCT    WQ0842  1        Piece Count Ite
     C                     PARM #RBDNB    WQ0843  70       Pieces Per Bag
     C                     PARM #RBJNB    WQ0844  70       Bags Per Unit
     C                     PARM #RSUST    WQ0845  1        Export/Domestic
     C                     PARM #RSVST    WQ0846  1        Print On Schedu
     C                     PARM #RSYST    WQ0847  1        Fresh Inv Alloc
     C                     PARM #RSZST    WQ0848  1        Fresh Sched As
     C                     PARM #RS1ST    WQ0849  1        Frozen Inv Allo
     C                     PARM #RXRCD    WQ0850  6        Primal Group Co
     C                     PARM #RWPST    WQ0851  2        Warehouse Type
     C                     PARM #RT1ST    WQ0852  1        Warehouse Std C
     C                     PARM #RDBNB    WQ0853  52       Warehouse Chill
     C                     PARM #RBVC3    WQ0854  30       WHS Inventory C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POUEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9849  *
     C                     END
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
      * added 6/15/09
      * CASE: LCL.Post Flag USR is Yes
     C           YL0055    IFEQ 'Y'                        *IF
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'N'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
     C                     Z-ADD#1CCQT    #RNRQT           Quantity Sched
     C                     Z-ADD#1CCQT    YL0100           Quantity Schedu
     C                     Z-ADD#1AUWG    YL0101           Weight Schedule
     C                     MOVEL'Y'       YL0056           *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Post Order & Refresh order's status'- refresh status is new for F
      * CASE: LCL.Post Flag USR is Yes
     C           YL0055    IFEQ 'Y'                        *IF
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0855  30       Company Number
     C                     PARM #1C4NB    WQ0856  70       Order Number
     C                     PARM #1BKC7    WQ0857  70       Ship To Custome
     C           WUB5VL    PARM WUB5VL    WQ0858 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0859 112       Order Weight To
     C                     PARM 'PS'      WQ0860  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Refresh Record
     C                     Z-ADDYL0100    #RNRQT           Quantity Sched
     C                     Z-ADDYL0100    #1CCQT           Quantity Schedu
     C                     Z-ADDYL0101    #1AUWG           Weight Schedule
     C                     MOVEL#RFWST    #1RPCD           Age Code
      * RMC 8/23/19  also get requested
      * WW OrdPrdSch Refresh  XF - Order Detail  * 
     C                     CALL 'POUFXFR'              90  WW OrdPrdSch Re
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0861  30       Company Number
     C                     PARM #1C4NB    WQ0862  70       Order Number
     C                     PARM #1DPNB    WQ0863  30       Order Sequence
     C                     PARM #1UENB    WQ0864  30       Order Secondary
     C           #1AJCD    PARM #1AJCD    WQ0865  3        Warehouse Code
     C           #1R1ST    PARM #1R1ST    WQ0866  1        OD Production P
     C                     PARM #1AVQT    WQ0867 112       Quantity Ordere
     C           #1A5DT    PARM #1A5DT    WQ0868  70       Requested Ship
     C           #1AODT    PARM #1AODT    WQ0869  70       Scheduled Ship
     C           #1Z4ST    PARM #1Z4ST    WQ0870  1        OD Schedule Ove
     C           #1FZSX    PARM #1FZSX    WQ0871  1        OD Adj Type Ove
     C                     PARM #CFFDT    WQ0872  70       USR Day 1
     C                     PARM #CE1DT    WQ0873  70       USR Day 2
     C                     PARM #CE2DT    WQ0874  70       USR Day 3
     C                     PARM #CE3DT    WQ0875  70       USR Day 4
     C                     PARM #CE4DT    WQ0876  70       USR Day 5
     C                     PARM #CE5DT    WQ0877  70       USR Day 6
     C           #RLIQT    PARM #RLIQT    WQ0878  50       Qty Sched Prod
     C           #RLJQT    PARM #RLJQT    WQ0879  50       Qty Sched Prod
     C           #RLWQT    PARM #RLWQT    WQ0880  50       Qty Sched Prod
     C           #RM9QT    PARM #RM9QT    WQ0881  50       Qty Sched Prod
     C           #RNAQT    PARM #RNAQT    WQ0882  50       Qty Sched Prod
     C           #RNOQT    PARM #RNOQT    WQ0883  50       Qty Sched Prod
     C           #RLKQT    PARM #RLKQT    WQ0884  50       Qty Sched Ord 1
     C           #RLLQT    PARM #RLLQT    WQ0885  50       Qty Sched Ord 2
     C           #RLVQT    PARM #RLVQT    WQ0886  50       Qty Sched Ord 3
     C           #RMOQT    PARM #RMOQT    WQ0887  50       Qty Sched Ord 4
     C           #RMPQT    PARM #RMPQT    WQ0888  50       Qty Sched Ord 5
     C           #RMQQT    PARM #RMQQT    WQ0889  50       Qty Sched Ord 6
     C           #RP7ST    PARM #RP7ST    WQ0890  1        OD Added to Sch
     C           #RL1QT    PARM #RL1QT    WQ0891  50       Qty 5.0 USR
     C           #RJ8NX    PARM #RJ8NX    WQ0892  50       Production
     C           #RKGNX    PARM #RKGNX    WQ0893  50       Inv Total
     C           #RNSQT    PARM #RNSQT    WQ0894  50       ODS Quantity Sh
     C           YL0055    PARM *BLANK    WQ0895  1        Post Flag USR
     C           #RHLSX    PARM *BLANK    WQ0896  1        Reverse Image F
     C           #RXIST    PARM *BLANK    WQ0897  1        Credit Hold
     C           #RXJST    PARM #RXJST    WQ0898  1        Production Hold
     C                     PARM #RRMNB    WQ0899  70       Load ID
     C           #RYIST    PARM #RYIST    WQ0900  1        Record Found -O
     C           #RPKST    PARM *BLANK    WQ0901  1        Load Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POUFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     984445*
     C                     SETON                     464748*
     C                     SETON                     49    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       #RLISX           Output Only 1 U
     C                     MOVEL*BLANK    #RR4ST           USR Update Flag
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'N'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
      * *Set Cursor: CTL.Item Code  (*Override=*NO)
     C                     Z-ADD*ZERO     W0RR0
     C                     Z-ADD014       W0ROW0
     C                     Z-ADD005       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Invalid option for user  message
      * CASE:
      *  - c1ORc2
      *   |- c1    : RCD.*SFLSEL is PPS Update
      *   |- c2    : RCD.*SFLSEL is PPS Update 2
      *   '-
     C           #1SEL     IFEQ '16'                       *IF
     C           #1SEL     OREQ '21'
     C           #1SEL     OREQ '22'
     C           #1SEL     OREQ '2'
     C           #1SEL     OREQ ' 2'
     C           #1SEL     OREQ '23'
     C           #1SEL     OREQ '6'
     C           #1SEL     OREQ ' 6'
     C           #1SEL     OREQ '14'                       *OR
     C           #1SEL     OREQ '17'
     C           #1SEL     OREQ '19'
     C           #1SEL     OREQ '12'
     C           #1SEL     OREQ '18'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0196           *SFLSEL
      * Send message 'Opts invalid for plan=N'
     C                     MOVEL'USR4169' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
      * Set SFLFOLD/SFLDROP from JOB.*Subfile mode
     C                     MOVE ZZSFM     *IN02
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,43
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * 14=Release Order is now Release Line item-FP1054
      * CASE: RCD.*SFLSEL is Option 14
     C           #1SEL     IFEQ '14'                       *IF
      * CASE: RCD.Released by User Sts Y/N is Not Yes
     C           #1F3SX    IFEQ *BLANK                     *IF
     C           #1F3SX    OREQ 'N'
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'Y'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
      *  Let the order ship short.
      * CHG Released by User  CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0166           Company Number
     C                     Z-ADD#1C4NB    WL0167           Order Number
     C                     Z-ADD#1DPNB    WL0168           Order Sequence
     C                     Z-ADD#1UENB    WL0169           Order Secondary
     C                     MOVEL'Y'       WL0170    P      Released by Use
     C                     EXSR TVCHRC
      * FP1054 chg prod hold status if orders line pass test
      * RTV Chg Sts/Prd Sts   RT - Order Header TRG  * 
     C                     EXSR NGRVGN
      * * Clear the Upload error flags                        C001956
      * CHG Ord Req Revw- flg CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0181           Company Number
     C                     Z-ADD#1C4NB    WL0182           Order Number
     C                     MOVEL*BLANK    WL0183           Order Requires
     C                     EXSR TYCHRC
      * CHG Ord Line Error Typ CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0184           Company Number
     C                     Z-ADD#1C4NB    WL0185           Order Number
     C                     Z-ADD#1DPNB    WL0186           Order Sequence
     C                     Z-ADD#1UENB    WL0187           Order Secondary
     C                     MOVEL*BLANK    WL0188           Order Line Erro
     C                     EXSR TZCHRC
      * * FP1054 Create rcd * RLSLIN
     C                     MOVEL*BLANK    WUFYTX           Item Code Txt
     C                     MOVEL#1HGCD    WUFYTX           Item Code Txt
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'N'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPGRC
     C                     Z-ADD#RRMNB    PGRMNB           Load ID
     C                     Z-ADD*ZERO     PGRVNB           Stop/Drop
     C                     MOVEL'RLSLIN'  PGRVST    P      Load Change Typ
     C                     MOVEL'SLS'     PGUJST    P      Department Cont
     C                     MOVELWUFYTX    PGMNTX    P      Change Log Prio
     C                     MOVEL@CN,009   PGMOTX    P      Change Log New
     C                     MOVEL##USR     PGAYNA    P      User Id
     C                     MOVEL##PGM     PGA0NA    P      Job Name
     C                     MOVEL#RBZNA    PGBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PGAIC3           Company Number
     C                     Z-ADD#1C4NB    PGC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * *
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN70
     C           #RTIST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
     C                     MOVEL'0'       *IN69
     C           #RHLSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN69
     C                     END                             *FI
     C                     MOVEL'0'       *IN68
     C           #RYIST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN68
     C                     END                             *FI
     C                     MOVEL'0'       *IN67
     C           #1Z4ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN67
     C                     END                             *FI
     C                     MOVEL'0'       *IN66
     C           #RSNST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN66
     C                     END                             *FI
     C                     MOVEL'0'       *IN65
     C           #RI0ST    IFEQ 'O'                        *IF
     C                     MOVEL'1'       *IN65
     C                     END                             *FI
     C                     MOVEL'0'       *IN64
     C           #RLISX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN64
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           YL0117    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUO1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           P3O1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           #CMGQT    IFLT *ZERO                      *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           #CMHQT    IFLT *ZERO                      *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           #CMIQT    IFLT *ZERO                      *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           #CMJQT    IFLT *ZERO                      *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           #CMKQT    IFLT *ZERO                      *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           #CMLQT    IFLT *ZERO                      *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BGWKZN fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDOMAIC3    #1AIC3           Company Number
     C                     Z-ADDOMNUDT    #1NUDT           Consumed Item C
     C                     Z-ADDOMAODT    #1AODT           Scheduled Ship
     C                     Z-ADDOMDPNB    #1DPNB           Order Sequence
     C                     Z-ADDOMUENB    #1UENB           Order Secondary
     C                     Z-ADDOMCFC7    #1CFC7           Order Group Cod
     C                     MOVELOMRPCD    #1RPCD           Age Code
     C                     MOVELOMGNST    #1GNST           Detail Line Sta
     C                     Z-ADDOMMAVA    #1MAVA           Billing Detail
     C                     Z-ADDOMKDVA    #1KDVA           Billing Detail
     C                     Z-ADDOML8VA    #1L8VA           Billing Detail
     C                     Z-ADDOML9VA    #1L9VA           Quantity to Sub
     C                     MOVELOMGTST    #1GTST           Comment Print A
     C                     MOVELOMGVST    #1GVST           Comment Print I
     C                     MOVELOMGUST    #1GUST           Comment Print P
     C                     MOVELOMQFST    #1QFST           Comment Print S
     C                     Z-ADDOMAYVA    #1AYVA           Extended Amount
     C                     Z-ADDOMEXDT    #1EXDT           Market Pricing
     C                     MOVELOMLQCD    #1LQCD           Commodity Marke
     C                     MOVELOMRDCD    #1RDCD           Date Method Cod
     C                     MOVELOMQ7CD    #1Q7CD           Price Method Co
     C                     Z-ADDOMBZPR    #1BZPR           Price Overage O
     C                     Z-ADDOML6NB    #1L6NB           Contract Number
     C                     MOVELOMU1ST    #1U1ST           Price Status
     C                     Z-ADDOMGIDT    #1GIDT           Pricing Date Us
     C                     MOVELOMCRCD    #1CRCD           U/M - Base Pric
     C                     MOVELOMAGCD    #1AGCD           U/M - Ordered
     C                     MOVELOMRZST    #1RZST           Work Confirm St
     C                     MOVELOMR0ST    #1R0ST           Work Over/Short
     C                     MOVELOMR1ST    #1R1ST           OD Production P
     C                     MOVELOMG7NA    #1G7NA           Order Desc. Lin
     C                     MOVELOMG8NA    #1G8NA           Order Desc. Lin
     C                     MOVELOMVEST    #1VEST           Palletize
     C                     MOVELOMVGST    #1VGST           Slip Sheet
     C                     MOVELOMAVST    #1AVST           Catch Weight St
     C                     MOVELOMU0ST    #1U0ST           Price Audit
     C                     MOVELOMRFCD    #1RFCD           Price Audit Rea
     C                     MOVELOMFZST    #1FZST           Production Date
     C                     Z-ADDOMR1NB    #1R1NB           Rated Freight
     C                     Z-ADDOMAVQT    #1AVQT           Quantity Ordere
     C                     Z-ADDOMD0WG    #1D0WG           Weight Ordered
     C                     Z-ADDOMCCQT    #1CCQT           Quantity Schedu
     C                     Z-ADDOMAUWG    #1AUWG           Weight Schedule
     C                     Z-ADDOMCBQT    #1CBQT           Quantity Shippe
     C                     Z-ADDOMATWG    #1ATWG           Weight Shipped
     C                     Z-ADDOMAQCS    #1AQCS           Unit Cost Prici
     C                     Z-ADDOMAGCS    #1AGCS           Unit Cost Per P
     C                     Z-ADDOMAKPR    #1AKPR           Unit Price
     C                     Z-ADDOMALPR    #1ALPR           Unit Price - Cr
     C                     Z-ADDOMAUPR    #1AUPR           Unit Price Orde
     C                     Z-ADDOMAVWG    #1AVWG           Unit Weight Ord
     C                     Z-ADDOMA4WG    #1A4WG           Tare Weight Tot
     C                     Z-ADDOMGNDT    #1GNDT           Actual Shipped
     C                     MOVELOMAMST    #1AMST           Affect Inventor
     C                     MOVELOMANST    #1ANST           Affect Sales Do
     C                     MOVELOMVAST    #1VAST           Affect Sales Pn
     C                     Z-ADDOMRGNB    #1RGNB           Item Structure
     C                     Z-ADDOMRHNB    #1RHNB           Item Structure
     C                     Z-ADDOMRINB    #1RINB           Item Structure
     C                     MOVELOMRBCD    #1RBCD           Item Level
     C                     MOVELOMHICD    #1HICD           Quality Level
     C                     MOVELOMRNCD    #1RNCD           Pricing Product
     C                     MOVELOMROCD    #1ROCD           Season Product
     C                     MOVELOMAJVN    #1AJVN           User Profile Na
     C                     MOVELOMKXCD    #1KXCD           Country Code
     C                     MOVELOMJPCD    #1JPCD           Event Code
     C                     MOVELOMCQCD    #1CQCD           Reason Code
     C                     MOVELOMZ1ST    #1Z1ST           Modified Flag
     C                     MOVELOMZ3ST    #1Z3ST           Substituted Fla
     C                     Z-ADDOMDUPR    #1DUPR           Invoice Unit Pr
     C                     Z-ADDOMB6VL    #1B6VL           Invoice Extende
     C                     Z-ADDOMA1AA    #1A1AA           Ham Group Numbe
     C                     MOVELOMF0SX    #1F0SX           Affect Trade Fu
     C                     MOVELOMF1SX    #1F1SX           Affect Commissi
     C                     MOVELOMF2SX    #1F2SX           Affect Pricing
     C                     MOVELOMF4SX    #1F4SX           Ord TF Exempt C
     C                     MOVELOMF5SX    #1F5SX           OD Pallet Type
     C                     MOVELOMF6SX    #1F6SX           Production Ware
     C                     MOVELOMF7SX    #1F7SX           OD Price Type
     C                     Z-ADDOMNTDT    #1NTDT           Warehouse Palle
     C                     Z-ADDOMNWDT    #1NWDT           OD Price Type R
     C                     Z-ADDOMNXDT    #1NXDT           OD Firm Date
     C                     MOVELOMGMST    #1GMST           Detail Line Sta
     C                     Z-ADDOMBVTM    #1BVTM           Price Code
     C                     Z-ADDOMBWTM    #1BWTM           Maximum Net Wei
     C                     Z-ADDOMBXTM    #1BXTM           Substitution Li
     C                     Z-ADDOMBYTM    #1BYTM           Max Qty to sche
     C                     Z-ADDOMH5NX    #1H5NX           Warehouse Palle
     C                     Z-ADDOMH6NX    #1H6NX           Warehouse Avg P
     C                     Z-ADDOMH7NX    #1H7NX           OD Item Target
     C                     Z-ADDOMH8NX    #1H8NX           OD Estimated Gr
     C                     Z-ADDOMH9NX    #1H9NX           OD Maximum Unit
     C                     Z-ADDOMDVPR    #1DVPR           Order Gate/Fina
     C                     Z-ADDOMDWPR    #1DWPR           OD Ceiling Pric
     C                     Z-ADDOMDXPR    #1DXPR           OD Gate/Final P
     C                     Z-ADDOMDYPR    #1DYPR           OD Weighted Avg
     C                     Z-ADDOMDZPR    #1DZPR           OD Original Ord
     C                     Z-ADDOMGSPR    #1GSPR           OD Cancel Date
     C                     Z-ADDOMGTPR    #1GTPR           OD Unused Prc 7
     C                     Z-ADDOMGUPR    #1GUPR           OD Unused Prc 8
     C                     MOVELOMHOST    #1HOST           OD MPR Sent to
     C                     MOVELOMHPST    #1HPST           OD MPR Prc Read
     C                     MOVELOMIOST    #1IOST           OD UnUsed Price
     C                     Z-ADDOMPEWG    #1PEWG           Weight Amount E
     C                     Z-ADDOMTIDT    #1TIDT           Production Ovr
     C                     Z-ADDOMTJDT    #1TJDT           Production Ovr
     C                     MOVELOMH2ST    #1H2ST           OD Spot Buy
     C                     MOVELOMH0ST    #1H0ST           OD Clm Full Ret
     C                     MOVELOMH1ST    #1H1ST           Order Line Erro
     C                     Z-ADDOMTKDT    #1TKDT           OD Market Begin
     C                     Z-ADDOMTLDT    #1TLDT           OD Market Endin
     C                     Z-ADDOMTMDT    #1TMDT           OD Atch to Ord
     C                     MOVELOMUVST    #1UVST           EDI Status 1
     C                     MOVELOMUWST    #1UWST           EDI Status 2
     C                     MOVELOMUXST    #1UXST           EDI Status 3
     C                     Z-ADDOMAATM    #1AATM           Job Time
     C                     MOVELOMAYNA    #1AYNA           User Id
     C                     MOVELOMA0NA    #1A0NA           Job Name
     C                     Z-ADDOMAXDT    #1AXDT           Job Date
     C                     Z-ADDOMHGCD    #1HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1HGCD
     C                     Z-ADDOMC4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     MOVELOMAJCD    #1AJCD           Warehouse Code
     C                     Z-ADDOMA5DT    #1A5DT           Requested Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1A5DT
     C                     Z-ADDOMRINY    #1RINY           Item Age Days
     C                     Z-ADDOMNVDT    #1NVDT           Deadline Depart
      * Clear external version also
     C                     Z-ADD*ZERO     V1NVDT
     C                     Z-ADDOMBUTM    #1BUTM           Deadline Depart
     C                     Z-ADDOMBKC7    #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     Z-ADDOMCXDT    #1CXDT           Date of Origina
      * Clear external version also
     C                     Z-ADD*ZERO     V1CXDT
     C                     MOVELOMR4CD    #1R4CD           Sales Route Cod
     C                     MOVELOMF3SX    #1F3SX           Released by Use
     C                     MOVELOMZ4ST    #1Z4ST           OD Schedule Ove
     C                     MOVELOMFZSX    #1FZSX           OD Adj Type Ove
     C                     MOVEL*BLANK    #RI0ST           Override Age Da
     C                     MOVEL*BLANK    #RR4ST           USR Update Flag
     C                     MOVEL*BLANK    #RTIST           USR Display 1
     C                     MOVEL*BLANK    #RGWST           Header Status
     C                     Z-ADD*ZERO     #RA0DT           Order Date
     C                     Z-ADD*ZERO     #RF9DT           Actual Ship Dat
     C                     MOVEL*BLANK    #RGJST           Order in Use
     C                     MOVEL*BLANK    #ROBST           Billing Activit
     C                     MOVEL*BLANK    #RYIST           Record Found -O
     C                     MOVEL*BLANK    #RBZNA           Carrier Code
     C                     MOVEL*BLANK    #RHLSX           Reverse Image F
     C                     MOVEL*BLANK    #RHNNA           Ship To City
     C                     MOVEL*BLANK    #RDBCD           Ship To State C
     C                     Z-ADD*ZERO     #RAFTM           Requested Deliv
     C                     MOVEL*BLANK    #RWPST           Warehouse Type
     C                     MOVEL*BLANK    #RT1ST           Warehouse Std C
     C                     Z-ADD*ZERO     #RDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     #RCHTM           Fresh Chilling
     C                     MOVEL*BLANK    #RADCD           U/M - Primary
     C                     MOVEL*BLANK    #RPCCT           Piece Count Ite
     C                     MOVEL*BLANK    #RQZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    #RXRCD           Primal Group Co
     C                     MOVEL*BLANK    #RS1ST           Frozen Inv Allo
     C                     MOVEL*BLANK    #RSZST           Fresh Sched As
     C                     MOVEL*BLANK    #RSYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    #RSVST           Print On Schedu
     C                     MOVEL*BLANK    #RSUST           Export/Domestic
     C                     MOVEL*BLANK    #RR3CD           Department Code
     C                     MOVEL*BLANK    #RSNST           Extra Status 1
     C                     Z-ADD*ZERO     #RL1QT           Qty 5.0 USR
     C                     MOVEL*BLANK    #RFWST           USR Age Code
     C                     MOVEL*BLANK    #RLKSX           Output Only 3 U
     C                     MOVEL*BLANK    #RLISX           Output Only 1 U
     C                     Z-ADD*ZERO     #RLIQT           Qty Sched Prod
     C                     MOVEL*BLANK    #RP7ST           OD Added to Sch
     C                     Z-ADD*ZERO     #RLJQT           Qty Sched Prod
     C                     Z-ADD*ZERO     #RLWQT           Qty Sched Prod
     C                     Z-ADD*ZERO     #RM9QT           Qty Sched Prod
     C                     Z-ADD*ZERO     #RNAQT           Qty Sched Prod
     C                     Z-ADD*ZERO     #RNOQT           Qty Sched Prod
     C                     MOVEL*BLANK    #RU2ST           Export Status
     C                     Z-ADD*ZERO     #RBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     #RRMNB           Load ID
     C                     MOVEL*BLANK    #RLJSX           Output Only 2 U
     C                     Z-ADD*ZERO     #RN1QT           Qty Prod Adjust
     C                     Z-ADD*ZERO     #RN0QT           Qty Prod Adj Ho
     C                     Z-ADD*ZERO     #RLNQT           Qty Prod Adjust
     C                     Z-ADD*ZERO     #RLQQT           Qty Prod Adj Ho
     C                     Z-ADD*ZERO     #RLTQT           Qty Prod Adjust
     C                     Z-ADD*ZERO     #RLSQT           Qty Prod Adj Ho
     C                     Z-ADD*ZERO     #RNDQT           Qty Prod Adjust
     C                     Z-ADD*ZERO     #RNFQT           Qty Prod Adj Ho
     C                     Z-ADD*ZERO     #RNEQT           Qty Prod Adjust
     C                     Z-ADD*ZERO     #RNGQT           Qty Prod Adj Ho
     C                     Z-ADD*ZERO     #RNNQT           Qty Prod Adjust
     C                     Z-ADD*ZERO     #RNPQT           Qty Prod Adj Ho
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL*BLANK    #RJNCD           Order Type - Sa
     C                     MOVEL*BLANK    #RBCST           Block Order Fla
     C                     MOVEL*BLANK    #RPKST           Load Status
     C                     Z-ADD*ZERO     #REIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     VREIDT
     C                     Z-ADD*ZERO     #RNQQT           Quantity Ordere
     C                     Z-ADD*ZERO     #RJ8NX           Production
     C                     Z-ADD*ZERO     #RKGNX           Inv Total
     C                     Z-ADD*ZERO     #RNSQT           ODS Quantity Sh
     C                     Z-ADD*ZERO     #RLKQT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     #RLLQT           Qty Sched Ord 2
     C                     Z-ADD*ZERO     #RLVQT           Qty Sched Ord 3
     C                     Z-ADD*ZERO     #RMOQT           Qty Sched Ord 4
     C                     Z-ADD*ZERO     #RMPQT           Qty Sched Ord 5
     C                     Z-ADD*ZERO     #RMQQT           Qty Sched Ord 6
     C                     MOVEL*BLANK    #RZMST           Pick Status USR
     C                     MOVEL*BLANK    #RRMST           Load Acceptance
     C                     MOVEL*BLANK    #RXIST           Credit Hold
     C                     MOVEL*BLANK    #RXJST           Production Hold
     C                     Z-ADD*ZERO     #RNRQT           Quantity Sched
     C                     Z-ADD*ZERO     #RAIWG           Unit Weight
     C                     Z-ADD*ZERO     #RBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     #RBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     #RGVDT           Production Date
      * Clear external version also
     C                     Z-ADD*ZERO     VRGVDT
     C                     Z-ADD*ZERO     #RGWDT           Production Date
      * Clear external version also
     C                     Z-ADD*ZERO     VRGWDT
     C                     MOVEL*BLANK    #RBRTX           Ship To Name
     C                     Z-ADD*ZERO     #RBQTM           Time of Origina
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVEL*BLANK    #CCZT1           Message USR
     C                     MOVEL*BLANK    #CSQTX           Company Name DR
     C                     Z-ADD*ZERO     #CCNNB           WIP Item Code
     C                     MOVEL*BLANK    #CO6NA           Warehouse Desc
     C                     MOVEL*BLANK    #CHPSX           USR Display 6
     C                     Z-ADD*ZERO     #CKONB           Day 1 Inventory
     C                     MOVEL*BLANK    #CNTSX           Base Adj Sts 6
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
     C                     Z-ADD*ZERO     #2BUTM           Deadline Depart
     C                     Z-ADD*ZERO     #2NVDT           Deadline Depart
     C                     Z-ADD*ZERO     #CRMNB           Load ID
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
     C                     MOVEL*BLANK    #2GMST           Detail Line Sta
     C                     MOVEL*BLANK    #2RPCD           Age Code
     C                     Z-ADD*ZERO     #CJ8NX           Production
     C                     MOVEL*BLANK    #CS4TX           Text 9
     C                     MOVEL*BLANK    #CZ7TX           Text USR 4
     C                     MOVEL*BLANK    #CEXSX           Sel Value 1 USR
     C                     MOVEL*BLANK    #CE0SX           Sel Value 2 USR
     C                     MOVEL*BLANK    #CE1SX           Sel Value 3 USR
     C                     MOVEL*BLANK    #CLGSX           Sel Value 4 USR
     C                     MOVEL*BLANK    #CLHSX           Sel Value 5 USR
     C                     MOVEL*BLANK    #CMJSX           Sel Value 6 USR
     C                     Z-ADD*ZERO     #CBTC3           Accounting Comp
      * Clear external version also
     C                     MOVEL*BLANK    VCBTC3
     C                     MOVELP1F6SX    #2F6SX           Production Ware
     C                     Z-ADD*ZERO     #CFFDT           USR Day 1
      * Clear external version also
     C                     Z-ADD*ZERO     VCFFDT
     C                     Z-ADD*ZERO     #CE1DT           USR Day 2
      * Clear external version also
     C                     Z-ADD*ZERO     VCE1DT
     C                     Z-ADD*ZERO     #CE2DT           USR Day 3
      * Clear external version also
     C                     Z-ADD*ZERO     VCE2DT
     C                     Z-ADD*ZERO     #CE3DT           USR Day 4
      * Clear external version also
     C                     Z-ADD*ZERO     VCE3DT
     C                     Z-ADD*ZERO     #CE4DT           USR Day 5
      * Clear external version also
     C                     Z-ADD*ZERO     VCE4DT
     C                     Z-ADD*ZERO     #CE5DT           USR Day 6
      * Clear external version also
     C                     Z-ADD*ZERO     VCE5DT
     C                     Z-ADDP1NUDT    #2NUDT           Consumed Item C
      * Clear external version also
     C                     MOVEL*BLANK    V2NUDT
     C                     MOVEL*BLANK    #COONA           Item Desc DRV
     C                     Z-ADD*ZERO     #CLIQT           Qty Sched Prod
     C                     Z-ADD*ZERO     #CLJQT           Qty Sched Prod
     C                     Z-ADD*ZERO     #CLWQT           Qty Sched Prod
     C                     Z-ADD*ZERO     #CM9QT           Qty Sched Prod
     C                     Z-ADD*ZERO     #CNAQT           Qty Sched Prod
     C                     Z-ADD*ZERO     #CNOQT           Qty Sched Prod
     C                     Z-ADD*ZERO     #CLKQT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     #CLLQT           Qty Sched Ord 2
     C                     Z-ADD*ZERO     #CLVQT           Qty Sched Ord 3
     C                     Z-ADD*ZERO     #CMOQT           Qty Sched Ord 4
     C                     Z-ADD*ZERO     #CMPQT           Qty Sched Ord 5
     C                     Z-ADD*ZERO     #CMQQT           Qty Sched Ord 6
     C                     Z-ADD*ZERO     #CP4QT           Qty Sched Whs T
     C                     Z-ADD*ZERO     #CP5QT           Qty Sched Whs T
     C                     Z-ADD*ZERO     #CP6QT           Qty Sched Whs T
     C                     Z-ADD*ZERO     #CP7QT           Qty Sched Whs T
     C                     Z-ADD*ZERO     #CP8QT           Qty Sched Whs T
     C                     Z-ADD*ZERO     #CP9QT           Qty Sched Whs T
     C                     Z-ADD*ZERO     #CNTQT           Qty Converted 1
     C                     MOVEL*BLANK    #CTIST           USR Display 1
     C                     Z-ADD*ZERO     #CNUQT           Qty Converted 2
     C                     MOVEL*BLANK    #CTJST           USR Display 2
     C                     Z-ADD*ZERO     #CNVQT           Qty Converted 3
     C                     MOVEL*BLANK    #CASTS           USR Display 3
     C                     Z-ADD*ZERO     #CNWQT           Qty Converted 4
     C                     MOVEL*BLANK    #CBSTS           USR Display 4
     C                     Z-ADD*ZERO     #CNXQT           Qty Converted 5
     C                     MOVEL*BLANK    #CGFSX           USR Display 5
     C                     Z-ADD*ZERO     #CNYQT           Qty Converted 6
     C                     Z-ADD*ZERO     #CMGQT           Quantity Avail
     C                     Z-ADD*ZERO     #CMHQT           Quantity Avail
     C                     Z-ADD*ZERO     #CMIQT           Quantity Avail
     C                     Z-ADD*ZERO     #CMJQT           Quantity Avail
     C                     Z-ADD*ZERO     #CMKQT           Quantity Avail
     C                     Z-ADD*ZERO     #CMLQT           Quantity Avail
     C                     Z-ADD*ZERO     #CH6DT           Avail Ship Date
      * Clear external version also
     C                     Z-ADD*ZERO     VCH6DT
     C                     Z-ADD*ZERO     #CH7DT           Avail Ship Date
      * Clear external version also
     C                     Z-ADD*ZERO     VCH7DT
     C                     Z-ADD*ZERO     #CH8DT           Avail Ship Date
      * Clear external version also
     C                     Z-ADD*ZERO     VCH8DT
     C                     Z-ADD*ZERO     #CH9DT           Avail Ship Date
      * Clear external version also
     C                     Z-ADD*ZERO     VCH9DT
     C                     Z-ADD*ZERO     #CIADT           Avail Ship Date
      * Clear external version also
     C                     Z-ADD*ZERO     VCIADT
     C                     Z-ADD*ZERO     #CIBDT           Avail Ship Date
      * Clear external version also
     C                     Z-ADD*ZERO     VCIBDT
     C                     Z-ADD*ZERO     #CN2QT           Qty Std Prod 1
     C                     MOVEL*BLANK    #CNOSX           Base Adj Sts 1
     C                     Z-ADD*ZERO     #CN3QT           Qty Std Prod 2
     C                     MOVEL*BLANK    #CNPSX           Base Adj Sts 2
     C                     Z-ADD*ZERO     #CN4QT           Qty Std Prod 3
     C                     MOVEL*BLANK    #CNQSX           Base Adj Sts 3
     C                     Z-ADD*ZERO     #CN5QT           Qty Std Prod 4
     C                     MOVEL*BLANK    #CNRSX           Base Adj Sts 4
     C                     Z-ADD*ZERO     #CN6QT           Qty Std Prod 5
     C                     MOVEL*BLANK    #CNSSX           Base Adj Sts 5
     C                     Z-ADD*ZERO     #CN7QT           Qty Std Prod 6
     C                     Z-ADD*ZERO     #2HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V2HGCD
     C                     Z-ADD*ZERO     #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     MOVEL*BLANK    #CJNCD           Order Type - Sa
     C                     MOVEL*BLANK    #2AJCD           Warehouse Code
     C                     MOVEL*BLANK    #CBCST           Block Order Fla
     C                     MOVEL*BLANK    #CPKST           Load Status
     C                     Z-ADD*ZERO     #2A5DT           Requested Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2A5DT
     C                     Z-ADD*ZERO     #CEIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     VCEIDT
     C                     Z-ADD*ZERO     #CNQQT           Quantity Ordere
     C                     Z-ADD*ZERO     #CNRQT           Quantity Sched
     C                     Z-ADD*ZERO     #CKGNX           Inv Total
     C                     Z-ADD*ZERO     #CNSQT           ODS Quantity Sh
     C                     Z-ADD*ZERO     #2RINY           Item Age Days
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #1A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1A5DT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #REIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VREIDT
      * Convert Deadline Depart Date LH to display format
      * Convert date
     C           1000000   ADD  #1NVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1NVDT
      * Convert Production Date RGF to display format
      * Convert date
     C           1000000   ADD  #RGVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VRGVDT
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #RGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VRGWDT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Date of Original Entry to display format
      * Convert date
     C           1000000   ADD  #1CXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1CXDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Accounting Company to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #CBTC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#CBTC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VCBTC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCBTC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert USR Day 1 to display format
      * Convert date
     C           1000000   ADD  #CFFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCFFDT
      * Convert USR Day 2 to display format
      * Convert date
     C           1000000   ADD  #CE1DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCE1DT
      * Convert USR Day 3 to display format
      * Convert date
     C           1000000   ADD  #CE2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCE2DT
      * Convert USR Day 4 to display format
      * Convert date
     C           1000000   ADD  #CE3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCE3DT
      * Convert USR Day 5 to display format
      * Convert date
     C           1000000   ADD  #CE4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCE4DT
      * Convert USR Day 6 to display format
      * Convert date
     C           1000000   ADD  #CE5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCE5DT
      * Convert Consumed Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2NUDT    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2NUDT    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2NUDT           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2NUDT           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Avail Ship Date 1 USR to display format
      * Convert date
     C           1000000   ADD  #CH6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCH6DT
      * Convert Avail Ship Date 2 USR to display format
      * Convert date
     C           1000000   ADD  #CH7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCH7DT
      * Convert Avail Ship Date 3 USR to display format
      * Convert date
     C           1000000   ADD  #CH8DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCH8DT
      * Convert Avail Ship Date 4 USR to display format
      * Convert date
     C           1000000   ADD  #CH9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCH9DT
      * Convert Avail Ship Date 5 USR to display format
      * Convert date
     C           1000000   ADD  #CIADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCIADT
      * Convert Avail Ship Date 6 USR to display format
      * Convert date
     C           1000000   ADD  #CIBDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCIBDT
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2HGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #2A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2A5DT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #CEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCEIDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NACHRC    BEGSR
      *================================================================
      * CHG Prd Hld, Sts,Rsn   CH - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN1499  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN1500  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN1501  70       Ship To Custome
     C                     MOVEL*BLANK    WN1502 30        Ship To Name
     C                     MOVEL*BLANK    WN1503 30        Ship To Address
     C                     MOVEL*BLANK    WN1504 30        Ship To Address
     C                     MOVEL*BLANK    WN1505 30        Ship To Address
     C                     MOVEL*BLANK    WN1506 20        Ship To City
     C                     MOVEL*BLANK    WN1507  2        Ship To State C
     C                     MOVEL*BLANK    WN1508 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN1509  70       Bill to Custome
     C                     MOVEL*BLANK    WN1510 30        Bill to Name
     C                     MOVEL*BLANK    WN1511 30        Bill to Address
     C                     MOVEL*BLANK    WN1512 30        Bill to Address
     C                     MOVEL*BLANK    WN1513 30        Bill to Address
     C                     MOVEL*BLANK    WN1514 20        Bill to City
     C                     MOVEL*BLANK    WN1515  2        Bill to State C
     C                     MOVEL*BLANK    WN1516 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN1517 15        Customer Purcha
     C                     Z-ADD*ZERO     WN1518  70       Order Date
     C                     Z-ADD*ZERO     WN1519  70       Requested Ship
     C                     Z-ADD*ZERO     WN1520  70       Actual Shipped
     C                     Z-ADD*ZERO     WN1521  70       Cancel Date
     C                     MOVEL*BLANK    WN1522  2        Terms Code
     C                     MOVEL*BLANK    WN1523 40        Special Instruc
     C                     MOVEL*BLANK    WN1524 40        Special Instruc
     C                     MOVEL*BLANK    WN1525  3        Carrier Code
     C                     MOVEL*BLANK    WN1526  1        Comment Print A
     C                     MOVEL*BLANK    WN1527  1        Comment Print I
     C                     MOVEL*BLANK    WN1528  1        Comment Print P
     C                     MOVEL*BLANK    WN1529  1        Comment Print S
     C                     MOVEL*BLANK    WN1530  1        Order in Use
     C                     MOVEL*BLANK    WN1531  1        Order Type Prin
     C                     Z-ADD*ZERO     WN1532  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1533 10        User Original E
     C                     Z-ADD*ZERO     WN1534  70       Date of Origina
     C                     Z-ADD*ZERO     WN1535 112       Order Value Tot
     C                     Z-ADD*ZERO     WN1536 112       Order Weight To
     C                     MOVEL*BLANK    WN1537  1        Credit Hold
     C                     MOVEL*BLANK    WN1538  1        New Customer Ho
     C                     Z-ADD*ZERO     WN1539  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1540  40       Requested Deliv
     C                     MOVEL*BLANK    WN1541  4        Accounts Receiv
     C                     MOVEL*BLANK    WN1542 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN1543  70       Load ID
     C                     Z-ADD*ZERO     WN1544  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN1545 112       Rated Freight
     C                     MOVEL*BLANK    WN1546  1        LTL Flag
     C                     MOVEL*BLANK    WN1547  1        Price Audit
     C                     MOVEL*BLANK    WN1548  1        Price Status
     C                     MOVEL*BLANK    WN1549  2        Shipping Method
     C                     MOVEL*BLANK    WN1550  1        Export Status
     C                     MOVEL*BLANK    WN1551  1        Palletize
     C                     MOVEL*BLANK    WN1552  1        Shrink Wrap
     C                     MOVEL*BLANK    WN1553  1        Slip Sheet
     C                     MOVEL*BLANK    WN1554  1        Age Code
     C                     Z-ADD*ZERO     WN1555  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1556  1        Load Type
     C                     Z-ADD*ZERO     WN1557  70       Attach to Invoi
     C                     MOVEL*BLANK    WN1558  1        Load Plan Order
     C                     MOVEL*BLANK    WN1559  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN1560  70       Resell Referenc
     C                     MOVEL*BLANK    WN1561 30        Special Comment
     C                     MOVEL*BLANK    WN1562 30        Special Comment
     C                     MOVEL*BLANK    WN1563  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN1564  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1565  2        Manager Level C
     C                     MOVEL*BLANK    WN1566  3        VP Level Code
     C                     Z-ADD*ZERO     WN1567  70       Attach to Order
     C                     MOVEL*BLANK    WN1568  3        Reason for Pric
     C                     Z-ADD*ZERO     WN1569  70       Invoice Number
     C                     MOVEL*BLANK    WN1570  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN1571  70       Invoice Date
     C                     MOVEL*BLANK    WN1572  2        Event Code
     C                     MOVEL*BLANK    WN1573  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1574  1        Modified Flag
     C                     Z-ADD*ZERO     WN1575 112       A/R order Value
     C                     MOVEL*BLANK    WN1576  1        Billing Activit
     C                     MOVEL*BLANK    WN1577  1        Block Order Fla
     C                     MOVEL*BLANK    WN1578  1        Order Certifica
     C                     Z-ADD*ZERO     WN1579 112       Invoice Order V
     C                     MOVEL*BLANK    WN1580  1        Process Sts for
     C                     MOVEL*BLANK    WN1581  1        Order Conf Fax
     C                     MOVEL*BLANK    WN1582  1        Manifest Fax St
     C                     MOVEL*BLANK    WN1583  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN1584  1        Transfer in Sto
     C                     MOVEL*BLANK    WN1585  1        Email Cust On O
     C                     MOVEL*BLANK    WN1586  1        Order Emailed
     C                     MOVEL*BLANK    WN1587  1        Export Docs Go
     C                     MOVEL*BLANK    WN1588  1        Shipping Temp C
     C                     MOVEL*BLANK    WN1589  1        Broker Order St
     C                     MOVEL*BLANK    WN1590  1        Air Freight Ord
     C                     MOVEL*BLANK    WN1591  2        Order Requires
     C                     MOVEL*BLANK    WN1592  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN1593  2        Export USDA App
     C                     MOVEL*BLANK    WN1594  3        HPB Ship to War
     C                     MOVEL*BLANK    WN1595  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN1596  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1597  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN1598  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN1599  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN1600  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN1601  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN1602  60       Time of Origina
     C                     Z-ADD*ZERO     WN1603  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1604  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN1605  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN1606 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN1607 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN1608 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN1609 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN1610 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN1611  70       Claim Number
     C                     MOVEL*BLANK    WN1612  1        EDI Status 1
     C                     MOVEL*BLANK    WN1613  1        EDI Status 2
     C                     MOVEL*BLANK    WN1614  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1615  60       Job Time
     C                     MOVEL*BLANK    WN1616 10        User Id
     C                     MOVEL*BLANK    WN1617 10        Job Name
     C                     Z-ADD*ZERO     WN1618  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YMRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0189    WLAIC3           Company Number
     C                     Z-ADDWL0190    WLC4NB           Order Number
      *
     C           KLCHNA    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
     C           KLCHNA    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YMRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWL0191    WLCQCD    P      Reason Code
     C                     MOVELWL0192    WLGWST    P      Header Status
     C                     MOVELWL0193    WLGXST    P      Header Status L
     C                     MOVELWL0194    WLXJST    P      Production Hold
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##PGM     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPFRC
     C                     Z-ADDWLAIC3    PFAIC3           Company Number
     C                     Z-ADDWLC4NB    PFC4NB           Order Number
     C                     MOVELWLJNCD    PFJNCD    P      Order Type - Sa
     C                     Z-ADDWLANC7    PFANC7           A/R Customer Nu
     C                     Z-ADDWLBKC7    PFBKC7           Ship To Custome
     C                     MOVELWLBRTX    PFBRTX    P      Ship To Name
     C                     MOVELWLHMNA    PFHMNA    P      Ship To Address
     C                     MOVELWLHONA    PFHONA    P      Ship To Address
     C                     MOVELWLHPNA    PFHPNA    P      Ship To Address
     C                     MOVELWLHNNA    PFHNNA    P      Ship To City
     C                     MOVELWLDBCD    PFDBCD    P      Ship To State C
     C                     MOVELWLCKTX    PFCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWLB0C7    PFB0C7           Bill to Custome
     C                     MOVELWLAETX    PFAETX    P      Bill to Name
     C                     MOVELWLB1NA    PFB1NA    P      Bill to Address
     C                     MOVELWLB3NA    PFB3NA    P      Bill to Address
     C                     MOVELWLB4NA    PFB4NA    P      Bill to Address
     C                     MOVELWLB2NA    PFB2NA    P      Bill to City
     C                     MOVELWLBHCD    PFBHCD    P      Bill to State C
     C                     MOVELWLC8TX    PFC8TX    P      Bill to Zip/Pos
     C                     MOVELWLBCNA    PFBCNA    P      Customer Purcha
     C                     Z-ADDWLA0DT    PFA0DT           Order Date
     C                     Z-ADDWLA5DT    PFA5DT           Requested Ship
     C                     Z-ADDWLGNDT    PFGNDT           Actual Shipped
     C                     Z-ADDWLACDT    PFACDT           Cancel Date
     C                     MOVELWLAQCD    PFAQCD    P      Terms Code
     C                     MOVELWLB6NA    PFB6NA    P      Special Instruc
     C                     MOVELWLBYNA    PFBYNA    P      Special Instruc
     C                     MOVELWLBZNA    PFBZNA    P      Carrier Code
     C                     MOVELWLGTST    PFGTST    P      Comment Print A
     C                     MOVELWLGVST    PFGVST    P      Comment Print I
     C                     MOVELWLGUST    PFGUST    P      Comment Print P
     C                     MOVELWLQFST    PFQFST    P      Comment Print S
     C                     MOVELWLCQCD    PFCQCD    P      Reason Code
     C                     MOVELWLGJST    PFGJST    P      Order in Use
     C                     MOVELWLGWST    PFGWST    P      Header Status
     C                     MOVELWLGXST    PFGXST    P      Header Status L
     C                     MOVELWLGYST    PFGYST    P      Order Type Prin
     C                     Z-ADDWLAODT    PFAODT           Scheduled Ship
     C                     MOVELWLAIVN    PFAIVN    P      User Original E
     C                     Z-ADDWLCXDT    PFCXDT           Date of Origina
     C                     Z-ADDWLJZVA    PFJZVA           Order Value Tot
     C                     Z-ADDWLA1WG    PFA1WG           Order Weight To
     C                     MOVELWLXIST    PFXIST    P      Credit Hold
     C                     MOVELWLXJST    PFXJST    P      Production Hold
     C                     MOVELWLXKST    PFXKST    P      New Customer Ho
     C                     Z-ADDWLEIDT    PFEIDT           Requested Deliv
     C                     Z-ADDWLAFTM    PFAFTM           Requested Deliv
     C                     MOVELWLE8CD    PFE8CD    P      Accounts Receiv
     C                     MOVELWLE9CD    PFE9CD    P      Accounts Receiv
     C                     Z-ADDWLRMNB    PFRMNB           Load ID
     C                     Z-ADDWLTBNB    PFTBNB           Absorbed Freigh
     C                     Z-ADDWLR1NB    PFR1NB           Rated Freight
     C                     MOVELWLPJST    PFPJST    P      LTL Flag
     C                     MOVELWLU0ST    PFU0ST    P      Price Audit
     C                     MOVELWLU1ST    PFU1ST    P      Price Status
     C                     MOVELWLQ2CD    PFQ2CD    P      Shipping Method
     C                     MOVELWLU2ST    PFU2ST    P      Export Status
     C                     MOVELWLVEST    PFVEST    P      Palletize
     C                     MOVELWLVFST    PFVFST    P      Shrink Wrap
     C                     MOVELWLVGST    PFVGST    P      Slip Sheet
     C                     MOVELWLRPCD    PFRPCD    P      Age Code
     C                     Z-ADDWLRNNB    PFRNNB           Reefer Temperat
     C                     MOVELWLVDST    PFVDST    P      Load Type
     C                     Z-ADDWLATIN    PFATIN           Attach to Invoi
     C                     MOVELWLU4ST    PFU4ST    P      Load Plan Order
     C                     MOVELWLU5ST    PFU5ST    P      Print Pick Slip
     C                     Z-ADDWLRSRN    PFRSRN           Resell Referenc
     C                     MOVELWLMHNA    PFMHNA    P      Special Comment
     C                     MOVELWLMINA    PFMINA    P      Special Comment
     C                     MOVELWLWBST    PFWBST    P      Affect Auto Acc
     C                     MOVELWLR4CD    PFR4CD    P      Sales Route Cod
     C                     MOVELWLBFCD    PFBFCD    P      Manager Level C
     C                     MOVELWLQ4CD    PFQ4CD    P      VP Level Code
     C                     Z-ADDWLT3NB    PFT3NB           Attach to Order
     C                     MOVELWLSICD    PFSICD    P      Reason for Pric
     C                     Z-ADDWLCONB    PFCONB           Invoice Number
     C                     MOVELWLCEST    PFCEST    P      Invoice Suffix
     C                     Z-ADDWLAWDT    PFAWDT           Invoice Date
     C                     MOVELWLJPCD    PFJPCD    P      Event Code
     C                     MOVELWLXUST    PFXUST    P      Trans Contol AS
     C                     MOVELWLZ1ST    PFZ1ST    P      Modified Flag
     C                     Z-ADDWLVRVA    PFVRVA           A/R order Value
     C                     MOVELWLOBST    PFOBST    P      Billing Activit
     C                     MOVELWLBCST    PFBCST    P      Block Order Fla
     C                     MOVELWLBDST    PFBDST    P      Order Certifica
     C                     Z-ADDWLB7VL    PFB7VL           Invoice Order V
     C                     MOVELWLGASX    PFGASX    P      Process Sts for
     C                     MOVELWLGBSX    PFGBSX    P      Order Conf Fax
     C                     MOVELWLGCSX    PFGCSX    P      Manifest Fax St
     C                     MOVELWLGDSX    PFGDSX    P      Invoice Fax Sts
     C                     MOVELWLFNSX    PFFNSX    P      Transfer in Sto
     C                     MOVELWLFOSX    PFFOSX    P      Email Cust On O
     C                     MOVELWLFPSX    PFFPSX    P      Order Emailed
     C                     MOVELWLFQSX    PFFQSX    P      Export Docs Go
     C                     MOVELWLFRSX    PFFRSX    P      Shipping Temp C
     C                     MOVELWLFSSX    PFFSSX    P      Broker Order St
     C                     MOVELWLFTSX    PFFTSX    P      Air Freight Ord
     C                     MOVELWLFUSX    PFFUSX    P      Order Requires
     C                     MOVELWLFVSX    PFFVSX    P      OH Load Plan Re
     C                     MOVELWLFWSX    PFFWSX    P      Export USDA App
     C                     MOVELWLFXSX    PFFXSX    P      HPB Ship to War
     C                     MOVELWLFYSX    PFFYSX    P      OH TF Exempt Co
     C                     Z-ADDWLNODT    PFNODT           OH Appt Confirm
     C                     Z-ADDWLNPDT    PFNPDT           JPN Invoice Iss
     C                     Z-ADDWLNQDT    PFNQDT           Load Actual Shi
     C                     Z-ADDWLNRDT    PFNRDT           Load BOL Comple
     C                     Z-ADDWLNSDT    PFNSDT           Load Truck Depa
     C                     Z-ADDWLBPTM    PFBPTM           Maximum Gross W
     C                     Z-ADDWLBQTM    PFBQTM           Time of Origina
     C                     Z-ADDWLBRTM    PFBRTM           OH Appt Confirm
     C                     Z-ADDWLBSTM    PFBSTM           Load BOL Comple
     C                     Z-ADDWLBTTM    PFBTTM           Load Truck Depa
     C                     Z-ADDWLH0NX    PFH0NX           Act Frt Referen
     C                     Z-ADDWLH1NX    PFH1NX           Act Non-Ref Frt
     C                     Z-ADDWLH2NX    PFH2NX           OH Fuel Surchar
     C                     Z-ADDWLH3NX    PFH3NX           OH Total Non-Re
     C                     Z-ADDWLH4NX    PFH4NX           OH Total Ref Fr
     C                     Z-ADDWLC0C7    PFC0C7           Claim Number
     C                     MOVELWLUVST    PFUVST    P      EDI Status 1
     C                     MOVELWLUWST    PFUWST    P      EDI Status 2
     C                     MOVELWLUXST    PFUXST    P      EDI Status 3
     C                     Z-ADDWLAATM    PFAATM           Job Time
     C                     MOVELWLAYNA    PFAYNA    P      User Id
     C                     MOVELWLA0NA    PFA0NA    P      Job Name
     C                     Z-ADDWLAXDT    PFAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YMRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2885 RMC 12/4/13 new alloc method="S"tandard -- if shipping with
      *   3 days, force Alloc Method to F-ASAP, else use B-JIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN FDAIC3    WQNB01           Company Number
     C           *LIKE     DEFN FDHGCD    WQNB02           Item Code
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           WQNB01           Company Number
     C                     KFLD           WQNB02           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    WQNB01           Company Number
     C                     Z-ADD#1HGCD    WQNB02           Item Code
      * Establish starting position
     C           KRSNB     SETLL@FDREAW                    *
     C           KRSNB     READE@FDREAW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0107           Allocation Meth
     C                     GOTO NBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv SchShpDte         RT - Order Header TRG  * 
     C                     EXSR NCRVGN
      * CASE: DB1.Allocation Method is Standard or Blank
     C           FDENST    IFEQ *BLANK                     *IF
     C           FDENST    OREQ 'S'
      * Rtv PrdDay Dte -Durtn RT - Calendar  * 
     C                     EXSR NDRVGN
      * CASE: LCL.Scheduled Ship Date LE LCL.Date                  USR
     C           YL0108    IFLE YL0109                     *IF
     C                     MOVEL'F'       YL0107           Allocation Meth
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'B'       YL0107           Allocation Meth
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELFDENST    YL0107           Allocation Meth
     C                     END                             *FI
     C           KRSNB     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * Rtv SchShpDte         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMC4NB    WQNC01           Order Number
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           WQNC01           Order Number
      * Setup key
     C                     Z-ADD#1C4NB    WQNC01           Order Number
      * Establish starting position
     C           KRSNC     SETLL@BFCPY2                    *
     C           KRSNC     READE@BFCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0108           Scheduled Ship
     C                     GOTO NCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWMAODT    YL0108           Scheduled Ship
     C           KRSNC     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * Rtv PrdDay Dte -Durtn RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQND01           Company Number
      * Define keylist
     C           KPSND     KLIST
     C                     KFLD           WQND01           Company Number
     C                     KFLD           WOBCDT           Post to G/L Dat
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           WQND01           Company Number
      * Setup key
     C                     Z-ADDFDAIC3    WQND01           Company Number
     C                     Z-ADD##JDT     WOBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSND     SETLL@AFREY1                    *
     C           KRSND     READE@AFREY1                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ 3                          *IF
     C                     Z-ADDWOBCDT    YL0109           *DATE
     C                     GOTO NDEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSND     READE@AFREY1                  90*
     C                     ENDDO
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * RTV Chk Detail Exists  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRAIC3    WQNE01           Company Number
     C           *LIKE     DEFN WRC4NB    WQNE02           Order Number
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           WQNE01           Company Number
     C                     KFLD           WQNE02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQNE01           Company Number
     C                     Z-ADD#1C4NB    WQNE02           Order Number
      * Establish starting position
     C           KRSNE     SETLL@BGWKAE                    *
     C           KRSNE     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSNE     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * RTV Next Prod Date     RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQNF01           Company Number
      * Define keylist
     C           KPSNF     KLIST
     C                     KFLD           WQNF01           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           WQNF01           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WQNF01           Company Number
     C                     Z-ADD##JDT     AFBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSNF     SETLL@AFREBE                    *
     C           KRSNF     READE@AFREBE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0112           Production Date
     C                     GOTO NFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Orde
     C           AFBCDT    IFEQ ##JDT                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Production Day Status is yes
     C           AFWAST    IFEQ 'Y'                        *IF
     C                     Z-ADDAFBCDT    YL0112           Production Date
     C                     GOTO NFEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNF     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGRVGN    BEGSR
      *================================================================
      * RTV Chg Sts/Prd Sts   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNG     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSNG     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Check Sch/not Rlsd RT - Order Detail  * 
     C                     EXSR NHRVGN
     C                     MOVELBEGXST    YL0115           Header Status L
     C                     MOVELBEGWST    YL0116           Header Status
      * CASE: DB1.Credit Hold is Yes
     C           BEXIST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.USR Production is No
     C           YL0114    IFEQ 'N'                        *IF
     C                     MOVELBEGWST    YL0115           Header Status L
     C                     MOVEL'A'       YL0116           Header Status
     C                     END                             *FI
     C                     END                             *FI
      * CHG Prd Hld, Sts,Rsn   CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0189           Company Number
     C                     Z-ADDBEC4NB    WL0190           Order Number
     C                     MOVELBECQCD    WL0191    P      Reason Code
     C                     MOVELYL0116    WL0192    P      Header Status
     C                     MOVELYL0115    WL0193    P      Header Status L
     C                     MOVELYL0114    WL0194    P      Production Hold
     C                     EXSR NACHRC
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHRVGN    BEGSR
      *================================================================
      * RTV Check Sch/not Rlsd RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0114           USR Production
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQNH01           Company Number
     C           *LIKE     DEFN WDC4NB    WQNH02           Order Number
      * Define keylist
     C           KPSNH     KLIST
     C                     KFLD           WQNH01           Company Number
     C                     KFLD           WQNH02           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
      * Define keylist
     C           KRSNH     KLIST
     C                     KFLD           WQNH01           Company Number
     C                     KFLD           WQNH02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQNH01           Company Number
     C                     Z-ADDBEC4NB    WQNH02           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
      * Establish starting position
     C           KPSNH     SETLL@BGWKL1                    *
     C           KRSNH     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : DB1.Quantity Ordered EQ DB1.Quantity Scheduled
      *   |- c2    : DB1.Released by User Sts Y/N is yes
      *   |- c3    : DB1.Detail Line Status is Cancelled
      *   '-
     C           WDAVQT    IFEQ WDCCQT                     *IF
     C           WDF3SX    OREQ 'Y'                        *OR
     C           WDGMST    OREQ 'X'                        *OR
      * if all line items are either sched or released by user or cncled,
      * then order is not to be on prod hold
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0114           USR Production
     C                     END                             *FI
     C           KRSNH     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NIRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQNI01           Application Cod
      * Define keylist
     C           KRSNI     KLIST
     C                     KFLD           WQNI01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQNI01           Application Cod
     C                     MOVEL'OMS'     WQNI01           Application Cod
      * Establish starting position
     C           KRSNI     SETLL@DNRESF                    *
     C           KRSNI     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR NJRVGN
     C                     END                             *FI
     C           KRSNI     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQNJ01           Application Cod
      * Define keylist
     C           KRSNJ     KLIST
     C                     KFLD           WQNJ01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQNJ01           Application Cod
      * Establish starting position
     C           KRSNJ     SETLL@DNRESF                    *
     C           KRSNJ     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSNJ     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKRVGN    BEGSR
      *================================================================
      * Rtv Profile Model     RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNK     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSNK     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0051           User Code Model
     C                     GOTO NKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRBUVN    YL0051           User Code Model
     C                     ENDIF
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Acct Co          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#2F6SX    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSA     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #CBTC3           Accounting Comp
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBTC3    #CBTC3           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv ProdDte-6         RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQSB01           Company Number
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
      * Setup key
     C                     Z-ADD#CBTC3    WQSB01           Company Number
     C                     Z-ADDYL0001    AFBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSB     SETLL@AFREBE                    *
     C           KRSSB     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR is GT 6
     C           WUCNTU    IFGT 6                          *IF
     C                     GOTO SBEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Production Day Status is yes
     C           AFWAST    IFEQ 'Y'                        *IF
      * Move Date & Day of Week
      * CASE: WRK.Count USR is One
     C           WUCNTU    IFEQ 1                          *IF
     C                     Z-ADDAFBCDT    #CFFDT           USR Day 1
     C                     ELSE
      * CASE: WRK.Count USR is Two
     C           WUCNTU    IFEQ 2                          *IF
     C                     Z-ADDAFBCDT    #CE1DT           USR Day 2
     C                     ELSE
      * CASE: WRK.Count USR is Three
     C           WUCNTU    IFEQ 3                          *IF
     C                     Z-ADDAFBCDT    #CE2DT           USR Day 3
     C                     ELSE
      * CASE: WRK.Count USR is Four
     C           WUCNTU    IFEQ 4                          *IF
     C                     Z-ADDAFBCDT    #CE3DT           USR Day 4
     C                     ELSE
      * CASE: WRK.Count USR is Five
     C           WUCNTU    IFEQ 5                          *IF
     C                     Z-ADDAFBCDT    #CE4DT           USR Day 5
     C                     ELSE
      * CASE: WRK.Count USR is Six
     C           WUCNTU    IFEQ 6                          *IF
     C                     Z-ADDAFBCDT    #CE5DT           USR Day 6
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Item Descriptions  RT - OM Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           BYHGCD           Item Code
      * Setup key
     C                     Z-ADD#2NUDT    BYHGCD           Item Code
      * Establish starting position
     C           KRSSC     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #COONA           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBYAVNA    #COONA           Description Lin
     C                     MOVELBYAWNA    WUAWNA           Description Lin
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Base Values PA    RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0001    BZAIC3           Company Number
     C                     Z-ADDWL0002    BZHGCD           Item Code
      * Establish starting position
     C           KRSSD     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Description Lin
     C                     MOVEL*BLANK    WL0004           Description Lin
     C                     MOVEL*BLANK    WL0005           U/M - Primary
     C                     Z-ADD*ZERO     WL0006           Conversion Fact
     C                     MOVEL*BLANK    WL0007           Operation Facto
     C                     MOVEL*BLANK    WL0008           U/M - Second
     C                     Z-ADD*ZERO     WL0009           Conversion Fact
     C                     MOVEL*BLANK    WL0010           Operation Facto
     C                     MOVEL*BLANK    WL0011           U/M - Third
     C                     MOVEL*BLANK    WL0012           U/M - Pricing
     C                     Z-ADD*ZERO     WL0013           Unit Weight
     C                     MOVEL*BLANK    WL0014           Production Date
     C                     MOVEL*BLANK    WL0015           Catch Weight St
     C                     Z-ADD*ZERO     WL0016           Fresh Chilling
     C                     MOVEL*BLANK    WL0017           Base/Conv/Loss
     C                     MOVEL*BLANK    WL0018           Piece Count Ite
     C                     Z-ADD*ZERO     WL0019           Pieces Per Bag
     C                     Z-ADD*ZERO     WL0020           Bags Per Unit
     C                     MOVEL*BLANK    WL0021           Record Status
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WL0003           Description Lin
     C                     MOVELBZAWNA    WL0004           Description Lin
     C                     MOVELBZADCD    WL0005           U/M - Primary
     C                     Z-ADDBZAWPC    WL0006           Conversion Fact
     C                     MOVELBZLXST    WL0007           Operation Facto
     C                     MOVELBZAECD    WL0008           U/M - Second
     C                     Z-ADDBZAXPC    WL0009           Conversion Fact
     C                     MOVELBZLYST    WL0010           Operation Facto
     C                     MOVELBZAFCD    WL0011           U/M - Third
     C                     MOVELBZAICD    WL0012           U/M - Pricing
     C                     Z-ADDBZAIWG    WL0013           Unit Weight
     C                     MOVELBZFZST    WL0014           Production Date
     C                     MOVELBZAVST    WL0015           Catch Weight St
     C                     Z-ADDBZCHTM    WL0016           Fresh Chilling
     C                     MOVELBZQZCD    WL0017           Base/Conv/Loss
     C                     MOVELBZPCCT    WL0018           Piece Count Ite
     C                     Z-ADDBZBDNB    WL0019           Pieces Per Bag
     C                     Z-ADDBZBJNB    WL0020           Bags Per Unit
     C                     MOVELBZVSST    WL0021           Record Status
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Base Availability RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * CASE: PAR.Unit Weight is Equal to zero
     C           WL0069    IFEQ 0                          *IF
      * Rtv Base Values PA    RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0022    WL0001           Company Number
     C                     Z-ADDWL0023    WL0002           Item Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUGSTX    P      Description Lin
     C                     MOVELWL0004    WUGSTX    P      Description Lin
     C                     MOVELWL0005    WUGSTX    P      U/M - Primary
     C                     Z-ADDWL0006    WUW0NB           Conversion Fact
     C                     MOVELWL0007    WUGSTX    P      Operation Facto
     C                     MOVELWL0008    WUGSTX    P      U/M - Second
     C                     Z-ADDWL0009    WUW0NB           Conversion Fact
     C                     MOVELWL0010    WUGSTX    P      Operation Facto
     C                     MOVELWL0011    WUGSTX    P      U/M - Third
     C                     MOVELWL0012    WUGSTX    P      U/M - Pricing
     C                     Z-ADDWL0013    YL0010           Unit Weight
     C                     MOVELWL0014    WUGSTX    P      Production Date
     C                     MOVELWL0015    WUGSTX    P      Catch Weight St
     C                     Z-ADDWL0016    WUW0NB           Fresh Chilling
     C                     MOVELWL0017    WUGSTX    P      Base/Conv/Loss
     C                     MOVELWL0018    YL0011    P      Piece Count Ite
     C                     Z-ADDWL0019    YL0012           Pieces Per Bag
     C                     Z-ADDWL0020    YL0013           Bags Per Unit
     C                     MOVELWL0021    WUGSTX    P      Record Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWL0069    YL0010           Unit Weight
     C                     MOVELWL0070    YL0011           Piece Count Ite
     C                     Z-ADDWL0071    YL0012           Pieces Per Bag
     C                     Z-ADDWL0072    YL0013           Bags Per Unit
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN I8AIC3    WQSE01           Company Number
     C           *LIKE     DEFN I8HGCD    WQSE02           Item Code
     C           *LIKE     DEFN I8AJCD    WQSE03           Warehouse Code
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Item Code
     C                     KFLD           WQSE03           Warehouse Code
     C                     KFLD           I8ELDT           Production Date
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Item Code
     C                     KFLD           WQSE03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0022    WQSE01           Company Number
     C                     Z-ADDWL0023    WQSE02           Item Code
     C                     MOVELWL0024    WQSE03           Warehouse Code
     C                     Z-ADDWL0025    I8ELDT           Production Date
      * Establish starting position
     C           KPSSE     SETLL@I8CPXP                    *
     C           KRSSE     READE@I8CPXP                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * QUIT:  Production Date > Usr Day 6
      * CASE: DB1.Production Date GT PAR.USR Day 6
     C           I8ELDT    IFGT WL0031                     *IF
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
      * SEL:  Schedule for Job Date
      * CASE: DB1.Production Date EQ JOB.*Job date
     C           I8ELDT    IFEQ ##JDT                      *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Production Type is Plan
      *   |- c2    : DB1.Production Type is Schedule Saved in the am
      *   '-
     C           I8V5ST    IFEQ 'P'                        *IF
     C           I8V5ST    OREQ 'X'                        *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Process Record
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CLC:  Quantity Standard, Converted, Scheduled Orders
      * CASE: LCL.Piece Count Item is yes
     C           YL0011    IFEQ 'Y'                        *IF
      * CASE: PAR.Production Date EQ PAR.USR Day 1
     C           WL0025    IFEQ WL0026                     *IF
      * Quantity Inventory
      * LCL.Day 1 Inventory 5,0   USR =
      *    *COMPUTE ((x1 + x4 - x5) / (x2 * x3))
      * x1    : DB1.PS Pieces Inv On-Hand
      * +     : PGM.*Synon (15,0) work field
      * x4    : DB1.PS Pieces Inv Adj
      * -     : PGM.*Synon (15,0) work field
      * x5    : DB1.PS Pieces Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : LCL.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : LCL.Bags Per Unit
     C           I8D5NB    ADD  I8CCNB    W0WJ02           *Synon (15,0) w
     C           W0WJ02    SUB  I8CENB    W0WJ01           *Synon (15,0) w
     C           YL0012    MULT YL0013    W0WJ03           *Synon (15,0) w
     C           W0WJ01    DIV  W0WJ03    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0014           Day 1 Inventory
     C                     END                             *FI
      * Quantity Standard
      * LCL.Quantity Standard USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : DB1.PS Pieces Standard
      * /     : PGM.*Synon (15,0) work field *
      * x2    : LCL.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : LCL.Bags Per Unit
     C           YL0012    MULT YL0013    W0WJ01           *Synon (15,0) w
     C           I8B2NB    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0015           Quantity Standa
      * Quantity Planned:fp1054
      * LCL.Quantity Planned USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : DB1.PS Pieces Planned Prod
      * /     : PGM.*Synon (15,0) work field *
      * x2    : LCL.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : LCL.Bags Per Unit
     C           YL0012    MULT YL0013    W0WJ01           *Synon (15,0) w
     C           I8QTSP    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0016           Quantity Planne
      * FP1054 add these together for display on the screen
     C                     ADD  YL0016    YL0015           Quantity Standa
      * Quantity Sched whse txfr
      * LCL.Quantity Sched Whs Tx USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : DB1.PS Pieces Whse Tfr Adj
      * /     : PGM.*Synon (15,0) work field *
      * x2    : LCL.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : LCL.Bags Per Unit
     C           YL0012    MULT YL0013    W0WJ01           *Synon (15,0) w
     C           I8BPNB    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0017           Quantity Sched
      * Quantity Converted
      * LCL.Quantity Converted USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : DB1.PS Pieces Converted
      * /     : PGM.*Synon (15,0) work field *
      * x2    : LCL.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : LCL.Bags Per Unit
     C           YL0012    MULT YL0013    W0WJ01           *Synon (15,0) w
     C           I8PSCV    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0018           Quantity Conver
      * Quantity Scheduled Orders
      * LCL.Qty Ordered USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : DB1.PS Pieces Prod Allocated
      * /     : PGM.*Synon (15,0) work field *
      * x2    : LCL.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : LCL.Bags Per Unit
     C           YL0012    MULT YL0013    W0WJ01           *Synon (15,0) w
     C           I8CDNB    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0019           Qty Ordered USR
      * FP1054 also add ps pieces planned prod
      * Quantity Production
      * LCL.Quantity Production USR =
      *    *COMPUTE ((x1 + x4 - x5+x6) / (x2 * x3))
      * x1    : DB1.PS Pieces Standard
      * +     : PGM.*Synon (15,0) work field
      * x4    : DB1.PS Pieces Prod Adj
      * -     : PGM.*Synon (15,0) work field
      * x5    : DB1.PS Pieces Converted
      * +     : PGM.*Synon (17,7) work field
      * x6    : DB1.PS Pieces Planned Prod
      * /     : PGM.*Synon (15,0) work field *
      * x2    : LCL.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : LCL.Bags Per Unit
     C           I8B2NB    ADD  I8CBNB    W0WJ03           *Synon (15,0) w
     C           W0WJ03    SUB  I8PSCV    W0WJ02           *Synon (15,0) w
     C           W0WJ02    ADD  I8QTSP    W0WD01           *Synon (17,7) w
     C           YL0012    MULT YL0013    W0WJ04           *Synon (15,0) w
     C           W0WD01    DIV  W0WJ04    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0020           Quantity Produc
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Production Date EQ PAR.USR Day 1
     C           I8ELDT    IFEQ WL0026                     *IF
      * Quantity Inventory
      * LCL.Day 1 Inventory 5,0   USR =
      *    *COMPUTE ((x1 + x3 - x4) / x2)
      * x1    : DB1.PS Weight Inv On-Hand
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Inv Adj
      * -     : PGM.*Synon (15,2) work field
      * x4    : DB1.PS Weight Inv Allocated
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : LCL.Unit Weight
     C           I8WTIN    ADD  I8EZWG    W0WA02           *Synon (15,2) w
     C           W0WA02    SUB  I8UNW2    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  YL0010    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0014           Day 1 Inventory
     C                     END                             *FI
      * Quantity Standard
      * LCL.Quantity Standard USR =
      *    *COMPUTE (x1 / x2)
      * x1    : DB1.PS Weight Standard
      * /     : PGM.*Synon (15,0) work field *
      * x2    : LCL.Unit Weight
     C           I8DXWG    DIV  YL0010    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0015           Quantity Standa
      * Quantity Planned-fp1054
      * LCL.Quantity Planned USR =
      *    *COMPUTE (x1 / x2)
      * x1    : DB1.PS Weight Planned Prod
      * /     : PGM.*Synon (15,0) work field *
      * x2    : LCL.Unit Weight
     C           I8WTSP    DIV  YL0010    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0016           Quantity Planne
      * FP1054 add these together for display on the screen
     C                     ADD  YL0016    YL0015           Quantity Standa
      * Quantity Sched Whse Txfr
      * LCL.Quantity Sched Whs Tx USR =
      *    *COMPUTE (x1 / x2)
      * x1    : DB1.PS Weight Whse Tfr Adj
      * /     : PGM.*Synon (15,0) work field *
      * x2    : LCL.Unit Weight
     C           I8GAWG    DIV  YL0010    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0017           Quantity Sched
      * Quantity Converted
      * LCL.Quantity Converted USR =
      *    *COMPUTE (x1 / x2)
      * x1    : DB1.PS Weight Converted
      * /     : PGM.*Synon (15,0) work field *
      * x2    : LCL.Unit Weight
     C           I8WTCN    DIV  YL0010    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0018           Quantity Conver
      * Quantity Scheduled Orders
      * LCL.Qty Ordered USR =
      *    *COMPUTE (x1 / x2)
      * x1    : DB1.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,0) work field *
      * x2    : LCL.Unit Weight
     C           I8OAWT    DIV  YL0010    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0019           Qty Ordered USR
      * FP1054 also add ps weight planned prod
      * Quantity production
      * LCL.Quantity Production USR =
      *    *COMPUTE ((x1 + x3 - x4+x5) / x2)
      * x1    : DB1.PS Weight Standard
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Prod Adj
      * -     : PGM.*Synon (15,2) work field
      * x4    : DB1.PS Weight Converted
      * +     : PGM.*Synon (17,7) work field
      * x5    : DB1.PS Weight Planned Prod
      * /     : PGM.*Synon (15,0) work field *
      * x2    : LCL.Unit Weight
     C           I8DXWG    ADD  I8D1WG    W0WA03           *Synon (15,2) w
     C           W0WA03    SUB  I8WTCN    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  I8WTSP    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  YL0010    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0020           Quantity Produc
     C                     END                             *FI
      * Quantity Available
      * LCL.Quantity Avail  7.0  USR =
      *    *COMPUTE (x1 - x2 - x3 - x4)
      * x1    : LCL.Quantity Standard USR
      * -     : PGM.*Synon (15,0) work field
      * x2    : LCL.Quantity Converted USR
      * -     : PGM.*Synon (15,0) work field
      * x3    : LCL.Qty Ordered USR
      * -     : PGM.*Synon (15,0) work field
      * x4    : LCL.Quantity Sched Whs Tx USR
     C           YL0015    SUB  YL0018    W0WJ02           *Synon (15,0) w
     C           W0WJ02    SUB  YL0019    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  YL0017    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0021           Quantity Avail
      * Move to appropriate day
      * CASE: DB1.Production Date EQ PAR.USR Day 1
     C           I8ELDT    IFEQ WL0026                     *IF
     C                     Z-ADDYL0015    WL0032           Qty Sched Prod
     C                     Z-ADDYL0018    WL0038           Qty Converted 1
     C                     Z-ADDYL0019    WL0044           Qty Sched Ord 1
     C                     Z-ADDYL0021    WL0050           Quantity Avail
     C                     Z-ADDYL0020    WL0056           Qty Std Prod 1
     C                     Z-ADDYL0017    WL0063           Qty Sched Whs T
     C                     ELSE
      * CASE: DB1.Production Date EQ PAR.USR Day 2
     C           I8ELDT    IFEQ WL0027                     *IF
     C                     Z-ADDYL0015    WL0033           Qty Sched Prod
     C                     Z-ADDYL0018    WL0039           Qty Converted 2
     C                     Z-ADDYL0019    WL0045           Qty Sched Ord 2
     C                     Z-ADDYL0021    WL0051           Quantity Avail
     C                     Z-ADDYL0020    WL0057           Qty Std Prod 2
     C                     Z-ADDYL0017    WL0064           Qty Sched Whs T
     C                     ELSE
      * CASE: DB1.Production Date EQ PAR.USR Day 3
     C           I8ELDT    IFEQ WL0028                     *IF
     C                     Z-ADDYL0015    WL0034           Qty Sched Prod
     C                     Z-ADDYL0018    WL0040           Qty Converted 3
     C                     Z-ADDYL0019    WL0046           Qty Sched Ord 3
     C                     Z-ADDYL0021    WL0052           Quantity Avail
     C                     Z-ADDYL0020    WL0058           Qty Std Prod 3
     C                     Z-ADDYL0017    WL0065           Qty Sched Whs T
     C                     ELSE
      * CASE: DB1.Production Date EQ PAR.USR Day 4
     C           I8ELDT    IFEQ WL0029                     *IF
     C                     Z-ADDYL0015    WL0035           Qty Sched Prod
     C                     Z-ADDYL0018    WL0041           Qty Converted 4
     C                     Z-ADDYL0019    WL0047           Qty Sched Ord 4
     C                     Z-ADDYL0021    WL0053           Quantity Avail
     C                     Z-ADDYL0020    WL0059           Qty Std Prod 4
     C                     Z-ADDYL0017    WL0066           Qty Sched Whs T
     C                     ELSE
      * CASE: DB1.Production Date EQ PAR.USR Day 5
     C           I8ELDT    IFEQ WL0030                     *IF
     C                     Z-ADDYL0015    WL0036           Qty Sched Prod
     C                     Z-ADDYL0018    WL0042           Qty Converted 5
     C                     Z-ADDYL0019    WL0048           Qty Sched Ord 5
     C                     Z-ADDYL0021    WL0054           Quantity Avail
     C                     Z-ADDYL0020    WL0060           Qty Std Prod 5
     C                     Z-ADDYL0017    WL0067           Qty Sched Whs T
     C                     ELSE
      * CASE: DB1.Production Date EQ PAR.USR Day 6
     C           I8ELDT    IFEQ WL0031                     *IF
     C                     Z-ADDYL0015    WL0037           Qty Sched Prod
     C                     Z-ADDYL0018    WL0043           Qty Converted 6
     C                     Z-ADDYL0019    WL0049           Qty Sched Ord 6
     C                     Z-ADDYL0021    WL0055           Quantity Avail
     C                     Z-ADDYL0020    WL0061           Qty Std Prod 6
     C                     Z-ADDYL0017    WL0068           Qty Sched Whs T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@I8CPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Type/Std Chil/Chil RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0073    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0074           Warehouse Type
     C                     MOVEL*BLANK    WL0075           Warehouse Std C
     C                     Z-ADD*ZERO     WL0076           Warehouse Chill
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    WL0074           Warehouse Type
     C                     MOVELADT1ST    WL0075           Warehouse Std C
     C                     Z-ADDADDBNB    WL0076           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Chill Time        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0077    BZAIC3           Company Number
     C                     Z-ADDWL0078    BZHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0079           Fresh Chilling
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZCHTM    WL0079           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Adjustment Sts    RT - PS Production Adjustment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WL0084           USR Display fie
     C                     MOVEL*BLANK    WL0085           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN I9AIC3    WQSH01           Company Number
     C           *LIKE     DEFN I9D8C7    WQSH02           PS Consumed Ite
     C           *LIKE     DEFN I9AJCD    WQSH03           Warehouse Code
     C           *LIKE     DEFN I9ELDT    WQSH04           Production Date
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           PS Consumed Ite
     C                     KFLD           WQSH03           Warehouse Code
     C                     KFLD           WQSH04           Production Date
      * Setup key
     C                     Z-ADDWL0080    WQSH01           Company Number
     C                     Z-ADDWL0081    WQSH02           PS Consumed Ite
     C                     MOVELWL0082    WQSH03           Warehouse Code
     C                     Z-ADDWL0083    WQSH04           Production Date
      * Establish starting position
     C           KRSSH     SETLL@I9CPOC                    *
     C           KRSSH     READE@I9CPOC                  90*
      * Data record not found
     C   90                MOVEL'USR1765' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Item Code NE DB1.PS Consumed Item Code
     C           I9HGCD    IFNE I9D8C7                     *IF
     C                     MOVEL'Y'       WL0084           USR Display fie
     C                     ELSE
      * CASE: DB1.Item Code EQ DB1.PS Consumed Item Code
     C           I9HGCD    IFEQ I9D8C7                     *IF
     C                     MOVEL'Y'       WL0085           Status - Y or N
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSH     READE@I9CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           DPDOCD           System Value Co
      * Setup key
     C                     MOVEL@CN,002   DPDOCD           System Value Co
      * Establish starting position
     C           KRSSI     CHAIN@DPRETD              90    *
      * Data record not found
     C   90                MOVEL'USR0759' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDDPM8NB    YL0043           System Value Nu
     C                     GOTO SIEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV KillDay Dte-Durtn  RT - Calendar  * Kill Date 360 RGT
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSJ01           Company Number
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WABCDT           Post to G/L Dat
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
      * Setup key
     C                     Z-ADD#CBTC3    WQSJ01           Company Number
     C                     Z-ADDP6WIDT    WABCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSJ     SETLL@AFREC2                    *
     C           KRSSJ     READE@AFREC2                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ YL0043                     *IF
     C                     Z-ADDWABCDT    P6WJDT           *DATE
     C                     GOTO SJEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSSJ     READE@AFREC2                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV LdId/OrdDt/ShpDt  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSK     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RJNCD           Order Type - Sa
     C                     MOVEL*BLANK    #RBRTX           Ship To Name
     C                     MOVEL*BLANK    #RHNNA           Ship To City
     C                     MOVEL*BLANK    #RDBCD           Ship To State C
     C                     Z-ADD*ZERO     #RA0DT           Order Date
     C                     Z-ADD*ZERO     #1GNDT           Actual Shipped
     C                     MOVEL*BLANK    #RBZNA           Carrier Code
     C                     MOVEL*BLANK    #RGJST           Order in Use
     C                     MOVEL*BLANK    #RGWST           Header Status
     C                     MOVEL*BLANK    #RXIST           Credit Hold
     C                     MOVEL*BLANK    #RXJST           Production Hold
     C                     Z-ADD*ZERO     #REIDT           Requested Deliv
     C                     Z-ADD*ZERO     #RAFTM           Requested Deliv
     C                     Z-ADD*ZERO     YL0046           Load ID
     C                     MOVEL*BLANK    #RU2ST           Export Status
     C                     MOVEL*BLANK    #ROBST           Billing Activit
     C                     MOVEL*BLANK    #RBCST           Block Order Fla
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEJNCD    #RJNCD           Order Type - Sa
     C                     MOVELBEBRTX    #RBRTX           Ship To Name
     C                     MOVELBEHNNA    #RHNNA           Ship To City
     C                     MOVELBEDBCD    #RDBCD           Ship To State C
     C                     Z-ADDBEA0DT    #RA0DT           Order Date
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
     C                     MOVELBEBZNA    #RBZNA           Carrier Code
     C                     MOVELBEGJST    #RGJST           Order in Use
     C                     MOVELBEGWST    #RGWST           Header Status
     C                     MOVELBEXIST    #RXIST           Credit Hold
     C                     MOVELBEXJST    #RXJST           Production Hold
     C                     Z-ADDBEEIDT    #REIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #RAFTM           Requested Deliv
     C                     Z-ADDBERMNB    YL0046           Load ID
     C                     MOVELBEU2ST    #RU2ST           Export Status
     C                     MOVELBEOBST    #ROBST           Billing Activit
     C                     MOVELBEBCST    #RBCST           Block Order Fla
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV LoadSts/Carrier    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDYL0046    FJRMNB           Load ID
      * Establish starting position
     C           KRSSL     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RPKST           Load Status
     C                     MOVEL*BLANK    #RBZNA           Carrier Code
     C                     MOVEL*BLANK    #RU2ST           Export Status
     C                     MOVEL*BLANK    #RRMST           Load Acceptance
     C                     Z-ADD*ZERO     YL0044           Deadline Depart
     C                     Z-ADD*ZERO     YL0045           Deadline Depart
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELFJPKST    #RPKST           Load Status
     C                     MOVELFJBZNA    #RBZNA           Carrier Code
     C                     MOVELFJU2ST    #RU2ST           Export Status
     C                     MOVELFJRMST    #RRMST           Load Acceptance
     C                     Z-ADDFJKZDT    YL0044           Deadline Depart
     C                     Z-ADDFJAXTM    YL0045           Deadline Depart
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Sales Route/OE Dt  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSM     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     Z-ADDBEBQTM    #RBQTM           Time of Origina
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Order Prod Sched  RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     #RLKQT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     #RLLQT           Qty Sched Ord 2
     C                     Z-ADD*ZERO     #RLVQT           Qty Sched Ord 3
     C                     Z-ADD*ZERO     #RMOQT           Qty Sched Ord 4
     C                     Z-ADD*ZERO     #RMPQT           Qty Sched Ord 5
     C                     Z-ADD*ZERO     #RMQQT           Qty Sched Ord 6
     C                     MOVEL*BLANK    #RP7ST           OD Added to Sch
     C                     Z-ADD*ZERO     #RJ8NX           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     #RKGNX           OD Quantity Inv
      * Declare restrictor key work fields
     C           *LIKE     DEFN KNAIC3    WQSN01           Company Number
     C           *LIKE     DEFN KNC4NB    WQSN02           Order Number
     C           *LIKE     DEFN KNDPNB    WQSN03           Order Sequence
     C           *LIKE     DEFN KNUENB    WQSN04           Order Secondary
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
     C                     KFLD           WQSN03           Order Sequence
     C                     KFLD           WQSN04           Order Secondary
      * Setup key
     C                     Z-ADD#1AIC3    WQSN01           Company Number
     C                     Z-ADD#1C4NB    WQSN02           Order Number
     C                     Z-ADD#1DPNB    WQSN03           Order Sequence
     C                     Z-ADD#1UENB    WQSN04           Order Secondary
      * Establish starting position
     C           KRSSN     SETLL@KNCPHO                    *
     C           KRSSN     READE@KNCPHO                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Production
      * CASE: DB1.OD Production Date EQ PAR.USR Day 1
     C           KNJGDT    IFEQ #CFFDT                     *IF
     C                     Z-ADDKNIGQT    #RLKQT           Qty Sched Ord 1
     C                     ELSE
      * CASE: DB1.OD Production Date EQ PAR.USR Day 2
     C           KNJGDT    IFEQ #CE1DT                     *IF
     C                     Z-ADDKNIGQT    #RLLQT           Qty Sched Ord 2
     C                     ELSE
      * CASE: DB1.OD Production Date EQ PAR.USR Day 3
     C           KNJGDT    IFEQ #CE2DT                     *IF
     C                     Z-ADDKNIGQT    #RLVQT           Qty Sched Ord 3
     C                     ELSE
      * CASE: DB1.OD Production Date EQ PAR.USR Day 4
     C           KNJGDT    IFEQ #CE3DT                     *IF
     C                     Z-ADDKNIGQT    #RMOQT           Qty Sched Ord 4
     C                     ELSE
      * CASE: DB1.OD Production Date EQ PAR.USR Day 5
     C           KNJGDT    IFEQ #CE4DT                     *IF
     C                     Z-ADDKNIGQT    #RMPQT           Qty Sched Ord 5
     C                     ELSE
      * CASE: DB1.OD Production Date EQ PAR.USR Day 6
     C           KNJGDT    IFEQ #CE5DT                     *IF
     C                     Z-ADDKNIGQT    #RMQQT           Qty Sched Ord 6
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  KNIGQT    #RJ8NX           OD Qty/Cnsmd Pi
     C                     ADD  KNIUQT    #RKGNX           OD Quantity Inv
     C           KRSSN     READE@KNCPHO                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    BZAIC3           Company Number
     C                     Z-ADD#1HGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSO     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    #RADCD           U/M - Primary
     C                     Z-ADD*ZERO     #RAIWG           Unit Weight
     C                     Z-ADD*ZERO     WURINB           Item Structure
     C                     Z-ADD*ZERO     WURHNB           Item Structure
     C                     Z-ADD*ZERO     WURGNB           Item Structure
     C                     MOVEL*BLANK    WUN0CD           Item Type Code
     C                     MOVEL*BLANK    WUQ1CD           Default Warehou
     C                     Z-ADD*ZERO     #RCHTM           Fresh Chilling
     C                     MOVEL*BLANK    #RQZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    WUXWST           Variety/Rendere
     C                     MOVEL*BLANK    WUVMST           Credit Item Sta
     C                     Z-ADD*ZERO     WUSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WUPPHE           Pieces Per Head
     C                     MOVEL*BLANK    #RR3CD           Department Code
     C                     MOVEL*BLANK    WUSDCD           Group for Packa
     C                     MOVEL*BLANK    WUX5ST           Seconds Item
     C                     MOVEL*BLANK    #RPCCT           Piece Count Ite
     C                     Z-ADD*ZERO     #RBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     #RBJNB           Bags Per Unit
     C                     MOVEL*BLANK    #RSUST           Export/Domestic
     C                     MOVEL*BLANK    #RSVST           Print On Schedu
     C                     MOVEL*BLANK    #RSYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    #RSZST           Fresh Sched As
     C                     MOVEL*BLANK    #RS1ST           Frozen Inv Allo
     C                     MOVEL*BLANK    #RXRCD           Primal Group Co
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WUAVNA           Description Lin
     C                     MOVELBZADCD    #RADCD           U/M - Primary
     C                     Z-ADDBZAIWG    #RAIWG           Unit Weight
     C                     Z-ADDBZRINB    WURINB           Item Structure
     C                     Z-ADDBZRHNB    WURHNB           Item Structure
     C                     Z-ADDBZRGNB    WURGNB           Item Structure
     C                     MOVELBZN0CD    WUN0CD           Item Type Code
     C                     MOVELBZQ1CD    WUQ1CD           Default Warehou
     C                     Z-ADDBZCHTM    #RCHTM           Fresh Chilling
     C                     MOVELBZQZCD    #RQZCD           Base/Conv/Loss
     C                     MOVELBZXWST    WUXWST           Variety/Rendere
     C                     MOVELBZVMST    WUVMST           Credit Item Sta
     C                     Z-ADDBZSWGH    WUSWGH           Std Weight/Head
     C                     Z-ADDBZPPHE    WUPPHE           Pieces Per Head
     C                     MOVELBZR3CD    #RR3CD           Department Code
     C                     MOVELBZSDCD    WUSDCD           Group for Packa
     C                     MOVELBZX5ST    WUX5ST           Seconds Item
     C                     MOVELBZPCCT    #RPCCT           Piece Count Ite
     C                     Z-ADDBZBDNB    #RBDNB           Pieces Per Bag
     C                     Z-ADDBZBJNB    #RBJNB           Bags Per Unit
     C                     MOVELBZSUST    #RSUST           Export/Domestic
     C                     MOVELBZSVST    #RSVST           Print On Schedu
     C                     MOVELBZSYST    #RSYST           Fresh Inv Alloc
     C                     MOVELBZSZST    #RSZST           Fresh Sched As
     C                     MOVELBZS1ST    #RS1ST           Frozen Inv Allo
     C                     MOVELBZXRCD    #RXRCD           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSP     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RWPST           Warehouse Type
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     MOVEL*BLANK    WUT0ST           Warehouse Locat
     C                     MOVEL*BLANK    #RT1ST           Warehouse Std C
     C                     Z-ADD*ZERO     #RDBNB           Warehouse Chill
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    #RWPST           Warehouse Type
     C                     MOVELADXUST    WUXUST           Trans Contol AS
     C                     MOVELADT0ST    WUT0ST           Warehouse Locat
     C                     MOVELADT1ST    #RT1ST           Warehouse Std C
     C                     Z-ADDADDBNB    #RDBNB           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Warehous Inv ChillRT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSQ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #RBVC3           WHS Inventory C
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBVC3    #RBVC3           WHS Inventory C
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BKZGNX    WQSR01           PFS Load ID
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           PFS Load ID
      * Setup key
     C                     Z-ADDWL0086    WQSR01           PFS Load ID
      * Establish starting position
     C           KRSSR     SETLL@BKCPEK                    *
     C           KRSSR     READE@BKCPEK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3504' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0087           Pick Status USR
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0087           Pick Status USR
     C                     GOTO SREXIT                     *QUIT
     C           KRSSR     READE@BKCPEK                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * CLC Date (desc) PrdDte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSS01           Company Number
      * Define keylist
     C           KPSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WBBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
      * Setup key
     C                     Z-ADDWL0088    WQSS01           Company Number
     C                     Z-ADDWL0089    WBBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSS     SETLL@AFREPU                    *
     C           KRSSS     READE@AFREPU                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Post to G/L Date EQ DB1.Post to G/L Date
      *   |- c2    : DB1.Production Day Status is no
      *   '-
     C           WL0089    IFEQ WBBCDT                     *IF
     C           WBWAST    OREQ 'N'                        *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WL0092                     *IF
     C                     Z-ADDWBBCDT    WL0090           *Date1 (ending)
     C                     GOTO SSEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSS     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * CLC Date (asce) PrdDte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQST01           Company Number
      * Define keylist
     C           KPSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WCBCDT           Post to G/L Dat
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Company Number
      * Setup key
     C                     Z-ADDWL0093    WQST01           Company Number
     C                     Z-ADDWL0094    WCBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSST     SETLL@AFREYY                    *
     C           KRSST     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Post to G/L Date EQ DB1.Post to G/L Date
      *   |- c2    : DB1.Production Day Status is no
      *   '-
     C           WL0094    IFEQ WCBCDT                     *IF
     C           WCWAST    OREQ 'N'                        *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WL0097                     *IF
     C                     Z-ADDWCBCDT    WL0095           *Date1 (ending)
     C                     GOTO STEXIT                     *QUIT
     C                     END                             *FI
     C           KRSST     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSU     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0061           Lot Tracking Fl
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADVHST    YL0061           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSV01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSV02           Order Number
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Company Number
     C                     KFLD           WQSV02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSV01           Company Number
     C                     Z-ADD#1C4NB    WQSV02           Order Number
      * Establish starting position
     C           KRSSV     SETLL@BGWKL1                    *
     C           KRSSV     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
     C                     EXSR SWCHRC
     C           KRSSV     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  70       Item Code
     C                     MOVEL*BLANK    WN0003  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0004  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0005  70       Order Group Cod
     C                     MOVEL*BLANK    WN0006  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0007  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0008 112       Billing Detail
     C                     Z-ADD*ZERO     WN0009 112       Billing Detail
     C                     Z-ADD*ZERO     WN0010 112       Billing Detail
     C                     Z-ADD*ZERO     WN0011 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0012  1        Comment Print A
     C                     MOVEL*BLANK    WN0013  1        Comment Print I
     C                     MOVEL*BLANK    WN0014  1        Comment Print P
     C                     MOVEL*BLANK    WN0015  1        Comment Print S
     C                     Z-ADD*ZERO     WN0016 112       Extended Amount
     C                     Z-ADD*ZERO     WN0017  70       Market Pricing
     C                     MOVEL*BLANK    WN0018  3        Commodity Marke
     C                     MOVEL*BLANK    WN0019  3        Date Method Cod
     C                     MOVEL*BLANK    WN0020  3        Price Method Co
     C                     Z-ADD*ZERO     WN0021 114       Price Overage O
     C                     Z-ADD*ZERO     WN0022  70       Contract Number
     C                     MOVEL*BLANK    WN0023  1        Price Status
     C                     Z-ADD*ZERO     WN0024  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0025  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0026  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0027  1        Work Confirm St
     C                     MOVEL*BLANK    WN0028  1        Work Over/Short
     C                     MOVEL*BLANK    WN0029  1        OD Production P
     C                     MOVEL*BLANK    WN0030 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0031 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0032  1        Age Code
     C                     MOVEL*BLANK    WN0033  1        Palletize
     C                     MOVEL*BLANK    WN0034  1        Slip Sheet
     C                     MOVEL*BLANK    WN0035  1        Catch Weight St
     C                     MOVEL*BLANK    WN0036  1        Price Audit
     C                     MOVEL*BLANK    WN0037  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0038  1        Production Date
     C                     Z-ADD*ZERO     WN0039 112       Rated Freight
     C                     Z-ADD*ZERO     WN0040 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0041 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0042 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0043 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0044 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0045 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0046 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0047 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0048 114       Unit Price
     C                     Z-ADD*ZERO     WN0049 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0050 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0051 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0052 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0053  70       Requested Ship
     C                     Z-ADD*ZERO     WN0054  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0055  70       Actual Shipped
     C                     MOVEL*BLANK    WN0056  1        Affect Inventor
     C                     MOVEL*BLANK    WN0057  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0058  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0059  30       Item Structure
     C                     Z-ADD*ZERO     WN0060  30       Item Structure
     C                     Z-ADD*ZERO     WN0061  30       Item Structure
     C                     MOVEL*BLANK    WN0062  2        Item Level
     C                     MOVEL*BLANK    WN0063  2        Quality Level
     C                     MOVEL*BLANK    WN0064  2        Pricing Product
     C                     MOVEL*BLANK    WN0065  2        Season Product
     C                     Z-ADD*ZERO     WN0066  70       Date of Origina
     C                     MOVEL*BLANK    WN0067 10        User Profile Na
     C                     MOVEL*BLANK    WN0068  6        Country Code
     C                     MOVEL*BLANK    WN0069  2        Event Code
     C                     MOVEL*BLANK    WN0070  3        Reason Code
     C                     MOVEL*BLANK    WN0071  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0072  1        Modified Flag
     C                     MOVEL*BLANK    WN0073  1        Substituted Fla
     C                     MOVEL*BLANK    WN0074  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0075 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0076 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0077  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0078  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0079  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0080  1        Affect Commissi
     C                     MOVEL*BLANK    WN0081  1        Affect Pricing
     C                     MOVEL*BLANK    WN0082  1        Released by Use
     C                     MOVEL*BLANK    WN0083  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0084  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0085  3        Production Ware
     C                     MOVEL*BLANK    WN0086  3        OD Price Type
     C                     Z-ADD*ZERO     WN0087  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0088  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0089  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0090  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0091  60       Price Code
     C                     Z-ADD*ZERO     WN0092  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0093  60       Substitution Li
     C                     Z-ADD*ZERO     WN0094  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0095 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0096 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0097 112       OD Item Target
     C                     Z-ADD*ZERO     WN0098 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0099 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0100 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0101 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0102 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0103 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0104 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0105 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0106 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0107 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0108  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0109  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0110  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0111 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0112  40       Item Age Days
     C                     Z-ADD*ZERO     WN0113  70       Production Ovr
     C                     Z-ADD*ZERO     WN0114  70       Production Ovr
     C                     MOVEL*BLANK    WN0115  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0116  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0117  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0118  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0119  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0120  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0121  1        EDI Status 1
     C                     MOVEL*BLANK    WN0122  1        EDI Status 2
     C                     MOVEL*BLANK    WN0123  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0124  60       Job Time
     C                     MOVEL*BLANK    WN0125 10        User Id
     C                     MOVEL*BLANK    WN0126 10        Job Name
     C                     Z-ADD*ZERO     WN0127  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWDAIC3    WEAIC3           Company Number
     C                     Z-ADDWDC4NB    WEC4NB           Order Number
     C                     Z-ADDWDDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWDUENB    WEUENB           Order Secondary
      *
     C           KLCHSW    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C           KLCHSW    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADD#1NVDT    WENVDT           Deadline Depart
     C                     Z-ADD#1BUTM    WEBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV for PA update val2RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
      * Setup key
     C                     Z-ADDWL0098    WDAIC3           Company Number
     C                     Z-ADDWL0099    WDC4NB           Order Number
     C                     Z-ADDWL0100    WDDPNB           Order Sequence
     C                     Z-ADDWL0101    WDUENB           Order Secondary
      * Establish starting position
     C           KRSSX     CHAIN@BGWKL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0102           Warehouse Code
     C                     MOVEL*BLANK    WL0103           OD Production P
     C                     Z-ADD*ZERO     WL0104           Quantity Schedu
     C                     Z-ADD*ZERO     WL0105           Weight Schedule
     C                     MOVEL*BLANK    WL0106           OD Schedule Ove
     C                     MOVEL*BLANK    WL0107           OD Adj Type Ove
     C                     Z-ADD*ZERO     WL0108           Item Age Days
     C                     Z-ADD*ZERO     WL0109           Production Ovr
     C                     Z-ADD*ZERO     WL0110           Production Ovr
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDAJCD    WL0102           Warehouse Code
     C                     MOVELWDR1ST    WL0103           OD Production P
     C                     Z-ADDWDCCQT    WL0104           Quantity Schedu
     C                     Z-ADDWDAUWG    WL0105           Weight Schedule
     C                     MOVELWDZ4ST    WL0106           OD Schedule Ove
     C                     MOVELWDFZSX    WL0107           OD Adj Type Ove
     C                     Z-ADDWDRINY    WL0108           Item Age Days
     C                     Z-ADDWDTIDT    WL0109           Production Ovr
     C                     Z-ADDWDTJDT    WL0110           Production Ovr
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Order in Use       RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0111    BEAIC3           Company Number
     C                     Z-ADDWL0112    BEC4NB           Order Number
      * Establish starting position
     C           KRSSY     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEGJST    WL0113           Order in Use
     C                     MOVELBEGWST    WL0114           Header Status
     C                     Z-ADDBERMNB    WL0115           Load ID
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Load Status        RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0116    FJRMNB           Load ID
      * Establish starting position
     C           KRSSZ     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0117           Load Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELFJPKST    WL0117           Load Status
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    WL0119           USR Check Y/N S
      * OMS203:  need to know if there are any Block orders on load
     C                     MOVEL'F'       WL0120           Block Order Fla
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQTA02           Load ID
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA02           Load ID
      * Setup key
     C                     Z-ADDWL0118    WQTA02           Load ID
      * Establish starting position
     C           KRSTA     SETLL@BFCPD9                    *
     C           KRSTA     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0119           USR Check Y/N S
      * CASE: DB1.Block Order Flag is Block Order
     C           WFBCST    IFEQ 'B'                        *IF
     C                     MOVELWFBCST    WL0120           Block Order Fla
     C                     GOTO TAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTA     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWL0121    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTB     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    WL0122           Allow Multi-Com
     C                     MOVELDRMPNA    WL0123           Default Printer
     C                     MOVELDRBCCD    WL0124           Salesperson Cod
     C                     Z-ADDDRAIC3    WL0125           Company Number
     C                     MOVELDRBUVN    WL0126           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0127    DTAJVN           User Profile Na
     C                     MOVELWL0128    DTDNCD           Application Cod
      * Establish starting position
     C           KRSTC     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0129           Company Number
     C                     MOVELDTAJCD    WL0130           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Prod Whse for Co  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGBWC3    WQTD01           Shipping Compan
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Shipping Compan
      * Setup key
     C                     Z-ADDWL0132    WQTD01           Shipping Compan
      * Establish starting position
     C           KRSTD     SETLL@ADREWA                    *
     C           KRSTD     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0131           Warehouse Code
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WGVSST    IFEQ 'A'                        *IF
      * CASE: DB1.Production Warehouse Code is Warehouse Code not Blank
     C           WGAOCD    IFNE *BLANK                     *IF
     C                     MOVELWGAOCD    WL0131           Warehouse Code
     C                     GOTO TDEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTD     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0133    ABAIC3           Company Number
      * Establish starting position
     C           KRSTE     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0134           Name
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0134           Name
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Unlock Load Authr RT - Entry Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           C0AJVN           User Profile Na
     C                     KFLD           C0DNCD           Application Cod
     C                     KFLD           C0AIC3           Company Number
      * Setup key
     C                     MOVELWL0135    C0AJVN           User Profile Na
     C                     MOVELWL0136    C0DNCD           Application Cod
     C                     Z-ADDWL0137    C0AIC3           Company Number
      * Establish starting position
     C           KRSTF     CHAIN@C0REO4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0527' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0138           Unlock Load Aut
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELC0HTST    WL0138           Unlock Load Aut
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCHRC    BEGSR
      *================================================================
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0137  30       Company Number
     C                     Z-ADD*ZERO     WN0138  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0139  1        LTL Flag
     C                     Z-ADD*ZERO     WN0140  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0141 15        Seal 1
     C                     MOVEL*BLANK    WN0142 15        Seal 2
     C                     MOVEL*BLANK    WN0143 15        Seal 3
     C                     MOVEL*BLANK    WN0144 15        Seal 4
     C                     MOVEL*BLANK    WN0145 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0146  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0147 112       Flat Amount
     C                     MOVEL*BLANK    WN0148  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0149  50       Total Stops
     C                     MOVEL*BLANK    WN0150 20        Trailer Id
     C                     MOVEL*BLANK    WN0151  3        Transloader Car
     C                     Z-ADD*ZERO     WN0152  40       BOL Time
     C                     MOVEL*BLANK    WN0153  3        Carrier Code
     C                     MOVEL*BLANK    WN0154  7        Truck Size
     C                     Z-ADD*ZERO     WN0155  70       Ld Hdr/Ld Dtl U
     C                     MOVEL*BLANK    WN0156  1        Ship Status
     C                     MOVEL*BLANK    WN0157  1        Load Type
     C                     Z-ADD*ZERO     WN0158  50       Number Pallets
     C                     Z-ADD*ZERO     WN0159  50       Number Pallets
     C                     Z-ADD*ZERO     WN0160 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0161  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0162  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0163  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0164 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0165 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0166  70       Actual Departur
     C                     Z-ADD*ZERO     WN0167  40       Departure Time
     C                     Z-ADD*ZERO     WN0168  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0169  52       Product Tempera
     C                     Z-ADD*ZERO     WN0170  50       Number Spacers
     C                     MOVEL*BLANK    WN0171 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0172  70       Total Load Mile
     C                     MOVEL*BLANK    WN0173 12        Recorder ID
     C                     MOVEL*BLANK    WN0174  2        Shipping Method
     C                     MOVEL*BLANK    WN0175  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0176  2        Ship To State C
     C                     Z-ADD*ZERO     WN0177  70       Gross Weight
     C                     MOVEL*BLANK    WN0178  3        Carrier Broker
     C                     MOVEL*BLANK    WN0179  1        Export Status
     C                     Z-ADD*ZERO     WN0180  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0181  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0182  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0183  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0184  70       Spotted Date
     C                     Z-ADD*ZERO     WN0185  60       Spotted Time
     C                     Z-ADD*ZERO     WN0186  70       Load Finished D
     C                     Z-ADD*ZERO     WN0187  60       Load Finished T
     C                     Z-ADD*ZERO     WN0188  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0189  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0190  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0191  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0192  70       Truck Departure
     C                     Z-ADD*ZERO     WN0193  60       Truck Departure
     C                     Z-ADD*ZERO     WN0194  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0195  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0196  3        Shipping Line
     C                     MOVEL*BLANK    WN0197 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0198 30        Vessel Name
     C                     Z-ADD*ZERO     WN0199  50       Voyage
     C                     Z-ADD*ZERO     WN0200  70       Sail Date
     C                     MOVEL*BLANK    WN0201 12        Booking Number
     C                     MOVEL*BLANK    WN0202 20        Discharge Port
     C                     Z-ADD*ZERO     WN0203  70       Arrival Date
     C                     MOVEL*BLANK    WN0204 12        Container Numbe
     C                     Z-ADD*ZERO     WN0205  70       Date In
     C                     Z-ADD*ZERO     WN0206  60       Time In
     C                     Z-ADD*ZERO     WN0207  70       Date Out
     C                     Z-ADD*ZERO     WN0208  60       Time Out
     C                     Z-ADD*ZERO     WN0209 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0210  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0211  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0212  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0213  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0214  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0215  70       Requested Deliv
     C                     MOVEL*BLANK    WN0216  1        Load Acceptance
     C                     MOVEL*BLANK    WN0217  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0218  70       On Yard Date
     C                     Z-ADD*ZERO     WN0219  60       On Yard Time
     C                     Z-ADD*ZERO     WN0220  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0221  60       Deadline Depart
     C                     MOVEL*BLANK    WN0222  1        Load Held Over
     C                     MOVEL*BLANK    WN0223  1        Load Held Over
     C                     MOVEL*BLANK    WN0224 15        Load Held Over
     C                     MOVEL*BLANK    WN0225 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0226 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0227  70       Express Mail Da
     C                     MOVEL*BLANK    WN0228  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0229  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0230  70       Product Complet
     C                     Z-ADD*ZERO     WN0231  60       Product Complet
     C                     Z-ADD*ZERO     WN0232  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0233  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0234  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0235  1        Load Confirmed
     C                     MOVEL*BLANK    WN0236 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0237  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0238  60       Load Door 1
     C                     Z-ADD*ZERO     WN0239  70       Override Total
     C                     Z-ADD*ZERO     WN0240  60       Load Door 2
     C                     MOVEL*BLANK    WN0241  1        Partial Load
     C                     MOVEL*BLANK    WN0242  1        Load Confirmati
     C                     MOVEL*BLANK    WN0243  1        Export Load USD
     C                     MOVEL*BLANK    WN0244  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0245 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0246 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0247 15        Late Billing Em
     C                     MOVEL*BLANK    WN0248 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0249 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0250  1        Multi Company L
     C                     MOVEL*BLANK    WN0251  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0252  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0253  1        LH Power Only L
     C                     MOVEL*BLANK    WN0254  1        MG Created Load
     C                     MOVEL*BLANK    WN0255  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0256  2        Load U/M
     C                     MOVEL*BLANK    WN0257  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0258  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0259  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0260  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0261  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0262  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0263  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0264  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0265  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0266  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0267  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0268  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0269  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0270  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0271  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0272  60       LH Unused Time
     C                     MOVEL*BLANK    WN0273  1        EDI Status 1
     C                     MOVEL*BLANK    WN0274  1        EDI Status 2
     C                     MOVEL*BLANK    WN0275  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0276  60       Job Time
     C                     MOVEL*BLANK    WN0277 10        User Id
     C                     MOVEL*BLANK    WN0278 10        Job Name
     C                     Z-ADD*ZERO     WN0279  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0139    WHRMNB           Load ID
      *
     C           KLCHTG    KLIST
     C                     KFLD           WHRMNB           Load ID
     C           KLCHTG    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVELWL0140    WHPKST    P      Load Status
     C                     Z-ADDWL0141    WHR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * zzV for Accusort Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQTH01           Load ID
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           Load ID
      * Setup key
     C                     Z-ADDWL0142    WQTH01           Load ID
      * Establish starting position
     C           KRSTH     SETLL@FLCPBW                    *
     C           KRSTH     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Header      TRG  * 
     C                     EXSR TIRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WL0143           Trans Contol AS
     C                     GOTO THEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTH     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    BEAIC3           Company Number
     C                     Z-ADDFLC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSTI     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Detail  * 
     C                     EXSR TJRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WUXUST           Trans Contol AS
     C                     GOTO TIEXIT                     *QUIT
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQTJ01           Company Number
     C           *LIKE     DEFN WDC4NB    WQTJ02           Order Number
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           Company Number
     C                     KFLD           WQTJ02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQTJ01           Company Number
     C                     Z-ADDBEC4NB    WQTJ02           Order Number
      * Establish starting position
     C           KRSTJ     SETLL@BGWKL1                    *
     C           KRSTJ     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WDGMST    IFEQ 'L'                        *IF
     C           WDGMST    OREQ 'A'
     C           WDGMST    OREQ 'C'
     C           WDGMST    OREQ 'R'
     C           WDGMST    OREQ 'E'
     C           WDGMST    OREQ 'H'
     C           WDGMST    OREQ 'I'
      * Rtv Desc/Trans Control RT - Warehouse  * 
     C                     EXSR TKRVGN
     C                     GOTO TJEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTJ     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Rtv Desc/Trans Control RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWDAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSTK     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUF8NA           Warehouse Descr
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADF8NA    WUF8NA           Warehouse Descr
     C                     MOVELADXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * RTV System Value Alpha RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           DPDOCD           System Value Co
      * Setup key
     C                     MOVELWL0144    DPDOCD           System Value Co
      * Establish starting position
     C           KRSTL     CHAIN@DPRETD              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0759' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0145           System Value Al
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDPBXTX    WL0145           System Value Al
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           BUY1NX           PFS Company Num
     C                     KFLD           BUGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDWL0146    BUY1NX           PFS Company Num
     C                     MOVELWL0147    BUGYAA           PFS Interface C
      * Establish starting position
     C           KRSTM     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0148           PFS AccuSort Ac
     C                     MOVEL*BLANK    WL0149           PFS Carlisle Ac
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBUWSSX    WL0148           PFS AccuSort Ac
     C                     MOVELBUWUSX    WL0149           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIRMNB    WQTN02           Load ID
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN02           Load ID
      * Setup key
     C                     Z-ADDWL0150    WQTN02           Load ID
      * Establish starting position
     C           KRSTN     SETLL@FLCPEB                    *
     C           KRSTN     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Recovery Freight   CH - Load Detail  * 
     C                     EXSR TOCHRC
      * CHG Clear Rated Frt    RT - PD Order Header  * 
     C                     EXSR TPRVGN
     C           KRSTN     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TOCHRC    BEGSR
      *================================================================
      * CHG Recovery Freight   CH - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0284  50       Stop/Drop
     C                     MOVEL*BLANK    WN0285 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0286  72       Freight Charge
     C                     Z-ADD*ZERO     WN0287  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0288  30       Company Number
     C                     Z-ADD*ZERO     WN0289  70       Order Number
     C                     MOVEL*BLANK    WN0290  1        Ship Status
     C                     Z-ADD*ZERO     WN0291  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0292  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0293  70       Appointment Con
     C                     Z-ADD*ZERO     WN0294  60       Appointment Con
     C                     MOVEL*BLANK    WN0295 30        Confirmation Ma
     C                     MOVEL*BLANK    WN0296 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN0297  70       Actual Delivery
     C                     Z-ADD*ZERO     WN0298  60       Actual Delivery
     C                     Z-ADD*ZERO     WN0299  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0300  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0301  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0302  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0303  70       On Yard Date
     C                     Z-ADD*ZERO     WN0304  60       On Yard Time
     C                     Z-ADD*ZERO     WN0305  70       MPC Number
     C                     MOVEL*BLANK    WN0306  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN0307  1        On Time Add'l R
     C                     MOVEL*BLANK    WN0308 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0309 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0310 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0311 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0312 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0313  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0314  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0315  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0316  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0317  60       LD Unused Time
     C                     Z-ADD*ZERO     WN0318  60       LD Unused Time
     C                     MOVEL*BLANK    WN0319  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0320  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0321  2        HPB Transload S
     C                     MOVEL*BLANK    WN0322 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN0323 25        Carrier Ref PRO
     C                     MOVEL*BLANK    WN0324 25        Cust Assigned A
     C                     MOVEL*BLANK    WN0325  1        EDI Status 1
     C                     MOVEL*BLANK    WN0326  1        EDI Status 2
     C                     MOVEL*BLANK    WN0327  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0328  60       Job Time
     C                     MOVEL*BLANK    WN0329 10        User Id
     C                     MOVEL*BLANK    WN0330 10        Job Name
     C                     Z-ADD*ZERO     WN0331  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWIRMNB    WJRMNB           Load ID
     C                     Z-ADDWIRUNB    WJRUNB           Stop/Drop Seque
      *
     C           KLCHTO    KLIST
     C                     KFLD           WJRMNB           Load ID
     C                     KFLD           WJRUNB           Stop/Drop Seque
     C           KLCHTO    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YCRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWIRWNB    WJRWNB           Miles to next s
     C                     Z-ADD*ZERO     WJT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WJT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WJR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WJAATM' defaulted for 'Job Time'.
      * Field '(DB1) WJAYNA' defaulted for 'User Id'.
      * Field '(DB1) WJA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WJAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKRMNB    WQTP02           Load ID
     C           *LIKE     DEFN WKC4NB    WQTP03           Order Number
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP02           Load ID
     C                     KFLD           WQTP03           Order Number
      * Setup key
     C                     Z-ADDWIRMNB    WQTP02           Load ID
     C                     Z-ADDWIC4NB    WQTP03           Order Number
      * Establish starting position
     C           KRSTP     SETLL@BFCPNQ                    *
     C           KRSTP     READE@BFCPNQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Rated Freight      CH - PD Order Header  * 
     C                     EXSR TQCHRC
      * 05/13/04 slm Multi-Company - Order Header lv remove co must use d
      *                               was using the par replace with db1
      * UPD Rated Freight      RT - Order Detail  * 
     C                     EXSR TRRVGN
     C           KRSTP     READE@BFCPNQ                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0332  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0333  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0334  70       Ship To Custome
     C                     MOVEL*BLANK    WN0335 30        Ship To Name
     C                     MOVEL*BLANK    WN0336 30        Ship To Address
     C                     MOVEL*BLANK    WN0337 30        Ship To Address
     C                     MOVEL*BLANK    WN0338 30        Ship To Address
     C                     MOVEL*BLANK    WN0339 20        Ship To City
     C                     MOVEL*BLANK    WN0340  2        Ship To State C
     C                     MOVEL*BLANK    WN0341 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0342  70       Bill to Custome
     C                     MOVEL*BLANK    WN0343 30        Bill to Name
     C                     MOVEL*BLANK    WN0344 30        Bill to Address
     C                     MOVEL*BLANK    WN0345 30        Bill to Address
     C                     MOVEL*BLANK    WN0346 30        Bill to Address
     C                     MOVEL*BLANK    WN0347 20        Bill to City
     C                     MOVEL*BLANK    WN0348  2        Bill to State C
     C                     MOVEL*BLANK    WN0349 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0350 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0351  70       Order Date
     C                     Z-ADD*ZERO     WN0352  70       Requested Ship
     C                     Z-ADD*ZERO     WN0353  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0354  70       Cancel Date
     C                     MOVEL*BLANK    WN0355  2        Terms Code
     C                     MOVEL*BLANK    WN0356 40        Special Instruc
     C                     MOVEL*BLANK    WN0357 40        Special Instruc
     C                     MOVEL*BLANK    WN0358  3        Carrier Code
     C                     MOVEL*BLANK    WN0359  1        Comment Print A
     C                     MOVEL*BLANK    WN0360  1        Comment Print I
     C                     MOVEL*BLANK    WN0361  1        Comment Print P
     C                     MOVEL*BLANK    WN0362  1        Comment Print S
     C                     MOVEL*BLANK    WN0363  3        Reason Code
     C                     MOVEL*BLANK    WN0364  1        Order in Use
     C                     MOVEL*BLANK    WN0365  1        Header Status
     C                     MOVEL*BLANK    WN0366  1        Header Status L
     C                     MOVEL*BLANK    WN0367  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0368  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0369 10        User Original E
     C                     Z-ADD*ZERO     WN0370  70       Date of Origina
     C                     Z-ADD*ZERO     WN0371 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0372 112       Order Weight To
     C                     MOVEL*BLANK    WN0373  1        Credit Hold
     C                     MOVEL*BLANK    WN0374  1        Production Hold
     C                     MOVEL*BLANK    WN0375  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0376  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0377  40       Requested Deliv
     C                     MOVEL*BLANK    WN0378  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0379 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0380  70       Load ID
     C                     Z-ADD*ZERO     WN0381  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0382  1        LTL Flag
     C                     MOVEL*BLANK    WN0383  1        Price Audit
     C                     MOVEL*BLANK    WN0384  1        Price Status
     C                     MOVEL*BLANK    WN0385  2        Shipping Method
     C                     MOVEL*BLANK    WN0386  1        Export Status
     C                     MOVEL*BLANK    WN0387  1        Palletize
     C                     MOVEL*BLANK    WN0388  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0389  1        Slip Sheet
     C                     MOVEL*BLANK    WN0390  1        Age Code
     C                     Z-ADD*ZERO     WN0391  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0392  1        Load Type
     C                     Z-ADD*ZERO     WN0393  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0394  1        Load Plan Order
     C                     MOVEL*BLANK    WN0395  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0396  70       Resell Referenc
     C                     MOVEL*BLANK    WN0397 30        Special Comment
     C                     MOVEL*BLANK    WN0398 30        Special Comment
     C                     MOVEL*BLANK    WN0399  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0400  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0401  2        Manager Level C
     C                     MOVEL*BLANK    WN0402  3        VP Level Code
     C                     Z-ADD*ZERO     WN0403  70       Attach to Order
     C                     MOVEL*BLANK    WN0404  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0405  70       Invoice Number
     C                     MOVEL*BLANK    WN0406  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0407  70       Invoice Date
     C                     MOVEL*BLANK    WN0408  2        Event Code
     C                     MOVEL*BLANK    WN0409  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0410  1        Modified Flag
     C                     Z-ADD*ZERO     WN0411 112       A/R order Value
     C                     MOVEL*BLANK    WN0412  1        Billing Activit
     C                     MOVEL*BLANK    WN0413  1        Block Order Fla
     C                     MOVEL*BLANK    WN0414  1        Order Certifica
     C                     Z-ADD*ZERO     WN0415 112       Invoice Order V
     C                     MOVEL*BLANK    WN0416  1        Process Sts for
     C                     MOVEL*BLANK    WN0417  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0418  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0419  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0420  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0421  1        Email Cust On O
     C                     MOVEL*BLANK    WN0422  1        Order Emailed
     C                     MOVEL*BLANK    WN0423  1        Export Docs Go
     C                     MOVEL*BLANK    WN0424  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0425  1        Broker Order St
     C                     MOVEL*BLANK    WN0426  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0427  2        Order Requires
     C                     MOVEL*BLANK    WN0428  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0429  2        Export USDA App
     C                     MOVEL*BLANK    WN0430  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0431  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0432  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0433  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0434  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0435  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0436  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0437  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0438  60       Time of Origina
     C                     Z-ADD*ZERO     WN0439  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0440  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0441  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0442 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0443 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0444 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0445 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0446 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0447  70       Claim Number
     C                     MOVEL*BLANK    WN0448  1        EDI Status 1
     C                     MOVEL*BLANK    WN0449  1        EDI Status 2
     C                     MOVEL*BLANK    WN0450  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0451  60       Job Time
     C                     MOVEL*BLANK    WN0452 10        User Id
     C                     MOVEL*BLANK    WN0453 10        Job Name
     C                     Z-ADD*ZERO     WN0454  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWKAIC3    WLAIC3           Company Number
     C                     Z-ADDWKC4NB    WLC4NB           Order Number
      *
     C           KLCHTQ    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
     C           KLCHTQ    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YDRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD*ZERO     WLR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##PGM     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPFRC
     C                     Z-ADDWLAIC3    PFAIC3           Company Number
     C                     Z-ADDWLC4NB    PFC4NB           Order Number
     C                     MOVELWLJNCD    PFJNCD    P      Order Type - Sa
     C                     Z-ADDWLANC7    PFANC7           A/R Customer Nu
     C                     Z-ADDWLBKC7    PFBKC7           Ship To Custome
     C                     MOVELWLBRTX    PFBRTX    P      Ship To Name
     C                     MOVELWLHMNA    PFHMNA    P      Ship To Address
     C                     MOVELWLHONA    PFHONA    P      Ship To Address
     C                     MOVELWLHPNA    PFHPNA    P      Ship To Address
     C                     MOVELWLHNNA    PFHNNA    P      Ship To City
     C                     MOVELWLDBCD    PFDBCD    P      Ship To State C
     C                     MOVELWLCKTX    PFCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWLB0C7    PFB0C7           Bill to Custome
     C                     MOVELWLAETX    PFAETX    P      Bill to Name
     C                     MOVELWLB1NA    PFB1NA    P      Bill to Address
     C                     MOVELWLB3NA    PFB3NA    P      Bill to Address
     C                     MOVELWLB4NA    PFB4NA    P      Bill to Address
     C                     MOVELWLB2NA    PFB2NA    P      Bill to City
     C                     MOVELWLBHCD    PFBHCD    P      Bill to State C
     C                     MOVELWLC8TX    PFC8TX    P      Bill to Zip/Pos
     C                     MOVELWLBCNA    PFBCNA    P      Customer Purcha
     C                     Z-ADDWLA0DT    PFA0DT           Order Date
     C                     Z-ADDWLA5DT    PFA5DT           Requested Ship
     C                     Z-ADDWLGNDT    PFGNDT           Actual Shipped
     C                     Z-ADDWLACDT    PFACDT           Cancel Date
     C                     MOVELWLAQCD    PFAQCD    P      Terms Code
     C                     MOVELWLB6NA    PFB6NA    P      Special Instruc
     C                     MOVELWLBYNA    PFBYNA    P      Special Instruc
     C                     MOVELWLBZNA    PFBZNA    P      Carrier Code
     C                     MOVELWLGTST    PFGTST    P      Comment Print A
     C                     MOVELWLGVST    PFGVST    P      Comment Print I
     C                     MOVELWLGUST    PFGUST    P      Comment Print P
     C                     MOVELWLQFST    PFQFST    P      Comment Print S
     C                     MOVELWLCQCD    PFCQCD    P      Reason Code
     C                     MOVELWLGJST    PFGJST    P      Order in Use
     C                     MOVELWLGWST    PFGWST    P      Header Status
     C                     MOVELWLGXST    PFGXST    P      Header Status L
     C                     MOVELWLGYST    PFGYST    P      Order Type Prin
     C                     Z-ADDWLAODT    PFAODT           Scheduled Ship
     C                     MOVELWLAIVN    PFAIVN    P      User Original E
     C                     Z-ADDWLCXDT    PFCXDT           Date of Origina
     C                     Z-ADDWLJZVA    PFJZVA           Order Value Tot
     C                     Z-ADDWLA1WG    PFA1WG           Order Weight To
     C                     MOVELWLXIST    PFXIST    P      Credit Hold
     C                     MOVELWLXJST    PFXJST    P      Production Hold
     C                     MOVELWLXKST    PFXKST    P      New Customer Ho
     C                     Z-ADDWLEIDT    PFEIDT           Requested Deliv
     C                     Z-ADDWLAFTM    PFAFTM           Requested Deliv
     C                     MOVELWLE8CD    PFE8CD    P      Accounts Receiv
     C                     MOVELWLE9CD    PFE9CD    P      Accounts Receiv
     C                     Z-ADDWLRMNB    PFRMNB           Load ID
     C                     Z-ADDWLTBNB    PFTBNB           Absorbed Freigh
     C                     Z-ADDWLR1NB    PFR1NB           Rated Freight
     C                     MOVELWLPJST    PFPJST    P      LTL Flag
     C                     MOVELWLU0ST    PFU0ST    P      Price Audit
     C                     MOVELWLU1ST    PFU1ST    P      Price Status
     C                     MOVELWLQ2CD    PFQ2CD    P      Shipping Method
     C                     MOVELWLU2ST    PFU2ST    P      Export Status
     C                     MOVELWLVEST    PFVEST    P      Palletize
     C                     MOVELWLVFST    PFVFST    P      Shrink Wrap
     C                     MOVELWLVGST    PFVGST    P      Slip Sheet
     C                     MOVELWLRPCD    PFRPCD    P      Age Code
     C                     Z-ADDWLRNNB    PFRNNB           Reefer Temperat
     C                     MOVELWLVDST    PFVDST    P      Load Type
     C                     Z-ADDWLATIN    PFATIN           Attach to Invoi
     C                     MOVELWLU4ST    PFU4ST    P      Load Plan Order
     C                     MOVELWLU5ST    PFU5ST    P      Print Pick Slip
     C                     Z-ADDWLRSRN    PFRSRN           Resell Referenc
     C                     MOVELWLMHNA    PFMHNA    P      Special Comment
     C                     MOVELWLMINA    PFMINA    P      Special Comment
     C                     MOVELWLWBST    PFWBST    P      Affect Auto Acc
     C                     MOVELWLR4CD    PFR4CD    P      Sales Route Cod
     C                     MOVELWLBFCD    PFBFCD    P      Manager Level C
     C                     MOVELWLQ4CD    PFQ4CD    P      VP Level Code
     C                     Z-ADDWLT3NB    PFT3NB           Attach to Order
     C                     MOVELWLSICD    PFSICD    P      Reason for Pric
     C                     Z-ADDWLCONB    PFCONB           Invoice Number
     C                     MOVELWLCEST    PFCEST    P      Invoice Suffix
     C                     Z-ADDWLAWDT    PFAWDT           Invoice Date
     C                     MOVELWLJPCD    PFJPCD    P      Event Code
     C                     MOVELWLXUST    PFXUST    P      Trans Contol AS
     C                     MOVELWLZ1ST    PFZ1ST    P      Modified Flag
     C                     Z-ADDWLVRVA    PFVRVA           A/R order Value
     C                     MOVELWLOBST    PFOBST    P      Billing Activit
     C                     MOVELWLBCST    PFBCST    P      Block Order Fla
     C                     MOVELWLBDST    PFBDST    P      Order Certifica
     C                     Z-ADDWLB7VL    PFB7VL           Invoice Order V
     C                     MOVELWLGASX    PFGASX    P      Process Sts for
     C                     MOVELWLGBSX    PFGBSX    P      Order Conf Fax
     C                     MOVELWLGCSX    PFGCSX    P      Manifest Fax St
     C                     MOVELWLGDSX    PFGDSX    P      Invoice Fax Sts
     C                     MOVELWLFNSX    PFFNSX    P      Transfer in Sto
     C                     MOVELWLFOSX    PFFOSX    P      Email Cust On O
     C                     MOVELWLFPSX    PFFPSX    P      Order Emailed
     C                     MOVELWLFQSX    PFFQSX    P      Export Docs Go
     C                     MOVELWLFRSX    PFFRSX    P      Shipping Temp C
     C                     MOVELWLFSSX    PFFSSX    P      Broker Order St
     C                     MOVELWLFTSX    PFFTSX    P      Air Freight Ord
     C                     MOVELWLFUSX    PFFUSX    P      Order Requires
     C                     MOVELWLFVSX    PFFVSX    P      OH Load Plan Re
     C                     MOVELWLFWSX    PFFWSX    P      Export USDA App
     C                     MOVELWLFXSX    PFFXSX    P      HPB Ship to War
     C                     MOVELWLFYSX    PFFYSX    P      OH TF Exempt Co
     C                     Z-ADDWLNODT    PFNODT           OH Appt Confirm
     C                     Z-ADDWLNPDT    PFNPDT           JPN Invoice Iss
     C                     Z-ADDWLNQDT    PFNQDT           Load Actual Shi
     C                     Z-ADDWLNRDT    PFNRDT           Load BOL Comple
     C                     Z-ADDWLNSDT    PFNSDT           Load Truck Depa
     C                     Z-ADDWLBPTM    PFBPTM           Maximum Gross W
     C                     Z-ADDWLBQTM    PFBQTM           Time of Origina
     C                     Z-ADDWLBRTM    PFBRTM           OH Appt Confirm
     C                     Z-ADDWLBSTM    PFBSTM           Load BOL Comple
     C                     Z-ADDWLBTTM    PFBTTM           Load Truck Depa
     C                     Z-ADDWLH0NX    PFH0NX           Act Frt Referen
     C                     Z-ADDWLH1NX    PFH1NX           Act Non-Ref Frt
     C                     Z-ADDWLH2NX    PFH2NX           OH Fuel Surchar
     C                     Z-ADDWLH3NX    PFH3NX           OH Total Non-Re
     C                     Z-ADDWLH4NX    PFH4NX           OH Total Ref Fr
     C                     Z-ADDWLC0C7    PFC0C7           Claim Number
     C                     MOVELWLUVST    PFUVST    P      EDI Status 1
     C                     MOVELWLUWST    PFUWST    P      EDI Status 2
     C                     MOVELWLUXST    PFUXST    P      EDI Status 3
     C                     Z-ADDWLAATM    PFAATM           Job Time
     C                     MOVELWLAYNA    PFAYNA    P      User Id
     C                     MOVELWLA0NA    PFA0NA    P      Job Name
     C                     Z-ADDWLAXDT    PFAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * UPD Rated Freight      RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0455  30       Order Sequence
     C                     Z-ADD*ZERO     WN0456  30       Order Secondary
     C                     Z-ADD*ZERO     WN0457 112       Rated Freight
     C                     Z-ADD*ZERO     WN0458 112       @Rated Freight
     C                     MOVEL*BLANK    WN0459  1        USR Process sta
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * par.@rated freight is the sum of all the detail rated frt, for ad
     C                     Z-ADD*ZERO     WN0458           @Rated Freight
      * par.usr process status is used to indicate if there are detail pr
     C                     MOVEL'N'       WN0459           USR Process sta
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQTR01           Company Number
     C           *LIKE     DEFN WDC4NB    WQTR02           Order Number
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR01           Company Number
     C                     KFLD           WQTR02           Order Number
      * Setup key
     C                     Z-ADDWKAIC3    WQTR01           Company Number
     C                     Z-ADDWKC4NB    WQTR02           Order Number
      * Establish starting position
     C           KRSTR     SETLL@BGWKL1                    *
     C           KRSTR     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WDGMST    IFEQ 'X'                        *IF
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0152           Company Number
     C                     Z-ADDWDC4NB    WL0153           Order Number
     C                     Z-ADDWDDPNB    WL0154           Order Sequence
     C                     Z-ADDWDUENB    WL0155           Order Secondary
     C                     Z-ADD*ZERO     WL0156           Rated Freight
     C                     EXSR TSCHRC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0459           USR Process sta
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Order Weight Total is Equal to zero
      *   |- c2    : PAR.Total Rated Freight is Zero
      *   '-
     C           WKA1WG    IFEQ 0                          *IF
     C           *ZERO     OREQ 0                          *OR
     C                     Z-ADD*ZERO     WN0457           Rated Freight
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Detail Line Status is Confirmed & Complete
     C           WDGMST    IFEQ 'C'                        *IF
     C           WDGMST    OREQ 'R'
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE (x1 / x3 * x4)
      * x1    : DB1.Weight Shipped Total
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           WDATWG    DIV  WKA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT *ZERO     W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE ((x1 * x2) / x3 * x4)
      * x1    : DB1.Quantity Ordered
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : DB1.Unit Weight Ordered U/M
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           WDAVQT    MULT WDAVWG    W0WD02           *Synon (17,7) w
     C           W0WD02    DIV  WKA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT *ZERO     W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     END                             *FI
     C           W0WE      MULT 1         WN0457    H      Rated Freight
     C                     END                             *FI
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0152           Company Number
     C                     Z-ADDWDC4NB    WL0153           Order Number
     C                     Z-ADDWDDPNB    WL0154           Order Sequence
     C                     Z-ADDWDUENB    WL0155           Order Secondary
     C                     Z-ADDWN0457    WL0156           Rated Freight
     C                     EXSR TSCHRC
     C                     ADD  WN0457    WN0458           @Rated Freight
     C                     Z-ADDWDDPNB    WN0455           Order Sequence
     C                     Z-ADDWDUENB    WN0456           Order Secondary
     C                     END                             *FI
     C           KRSTR     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * Adjust totals
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Rated Freight NE PAR.Total Rated Freight
      *   |- c2    : PAR.USR Process status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0458    IFNE *ZERO                      *IF
     C           WN0459    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           *ZERO     SUB  WN0458    WUICVA           USR Adjustment
     C                     ADD  WUICVA    WN0457           Rated Freight
      * Update last detail line processed
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0152           Company Number
     C                     Z-ADDWKC4NB    WL0153           Order Number
     C                     Z-ADDWN0455    WL0154           Order Sequence
     C                     Z-ADDWN0456    WL0155           Order Secondary
     C                     Z-ADDWN0457    WL0156           Rated Freight
     C                     EXSR TSCHRC
     C                     END                             *FI
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0460  70       Item Code
     C                     MOVEL*BLANK    WN0461  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0462  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0463  70       Order Group Cod
     C                     MOVEL*BLANK    WN0464  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0465  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0466 112       Billing Detail
     C                     Z-ADD*ZERO     WN0467 112       Billing Detail
     C                     Z-ADD*ZERO     WN0468 112       Billing Detail
     C                     Z-ADD*ZERO     WN0469 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0470  1        Comment Print A
     C                     MOVEL*BLANK    WN0471  1        Comment Print I
     C                     MOVEL*BLANK    WN0472  1        Comment Print P
     C                     MOVEL*BLANK    WN0473  1        Comment Print S
     C                     Z-ADD*ZERO     WN0474 112       Extended Amount
     C                     Z-ADD*ZERO     WN0475  70       Market Pricing
     C                     MOVEL*BLANK    WN0476  3        Commodity Marke
     C                     MOVEL*BLANK    WN0477  3        Date Method Cod
     C                     MOVEL*BLANK    WN0478  3        Price Method Co
     C                     Z-ADD*ZERO     WN0479 114       Price Overage O
     C                     Z-ADD*ZERO     WN0480  70       Contract Number
     C                     MOVEL*BLANK    WN0481  1        Price Status
     C                     Z-ADD*ZERO     WN0482  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0483  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0484  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0485  1        Work Confirm St
     C                     MOVEL*BLANK    WN0486  1        Work Over/Short
     C                     MOVEL*BLANK    WN0487  1        OD Production P
     C                     MOVEL*BLANK    WN0488 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0489 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0490  1        Age Code
     C                     MOVEL*BLANK    WN0491  1        Palletize
     C                     MOVEL*BLANK    WN0492  1        Slip Sheet
     C                     MOVEL*BLANK    WN0493  1        Catch Weight St
     C                     MOVEL*BLANK    WN0494  1        Price Audit
     C                     MOVEL*BLANK    WN0495  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0496  1        Production Date
     C                     Z-ADD*ZERO     WN0497 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0498 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0499 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0500 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0501 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0502 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0503 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0504 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0505 114       Unit Price
     C                     Z-ADD*ZERO     WN0506 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0507 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0508 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0509 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0510  70       Requested Ship
     C                     Z-ADD*ZERO     WN0511  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0512  70       Actual Shipped
     C                     MOVEL*BLANK    WN0513  1        Affect Inventor
     C                     MOVEL*BLANK    WN0514  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0515  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0516  30       Item Structure
     C                     Z-ADD*ZERO     WN0517  30       Item Structure
     C                     Z-ADD*ZERO     WN0518  30       Item Structure
     C                     MOVEL*BLANK    WN0519  2        Item Level
     C                     MOVEL*BLANK    WN0520  2        Quality Level
     C                     MOVEL*BLANK    WN0521  2        Pricing Product
     C                     MOVEL*BLANK    WN0522  2        Season Product
     C                     Z-ADD*ZERO     WN0523  70       Date of Origina
     C                     MOVEL*BLANK    WN0524 10        User Profile Na
     C                     MOVEL*BLANK    WN0525  6        Country Code
     C                     MOVEL*BLANK    WN0526  2        Event Code
     C                     MOVEL*BLANK    WN0527  3        Reason Code
     C                     MOVEL*BLANK    WN0528  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0529  1        Modified Flag
     C                     MOVEL*BLANK    WN0530  1        Substituted Fla
     C                     MOVEL*BLANK    WN0531  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0532 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0533 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0534  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0535  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0536  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0537  1        Affect Commissi
     C                     MOVEL*BLANK    WN0538  1        Affect Pricing
     C                     MOVEL*BLANK    WN0539  1        Released by Use
     C                     MOVEL*BLANK    WN0540  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0541  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0542  3        Production Ware
     C                     MOVEL*BLANK    WN0543  3        OD Price Type
     C                     Z-ADD*ZERO     WN0544  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0545  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0546  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0547  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0548  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0549  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0550  60       Price Code
     C                     Z-ADD*ZERO     WN0551  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0552  60       Substitution Li
     C                     Z-ADD*ZERO     WN0553  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0554 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0555 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0556 112       OD Item Target
     C                     Z-ADD*ZERO     WN0557 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0558 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0559 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0560 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0561 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0562 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0563 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0564 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0565 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0566 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0567  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0568  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0569  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0570 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0571  40       Item Age Days
     C                     Z-ADD*ZERO     WN0572  70       Production Ovr
     C                     Z-ADD*ZERO     WN0573  70       Production Ovr
     C                     MOVEL*BLANK    WN0574  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0575  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0576  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0577  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0578  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0579  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0580  1        EDI Status 1
     C                     MOVEL*BLANK    WN0581  1        EDI Status 2
     C                     MOVEL*BLANK    WN0582  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0583  60       Job Time
     C                     MOVEL*BLANK    WN0584 10        User Id
     C                     MOVEL*BLANK    WN0585 10        Job Name
     C                     Z-ADD*ZERO     WN0586  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0152    WEAIC3           Company Number
     C                     Z-ADDWL0153    WEC4NB           Order Number
     C                     Z-ADDWL0154    WEDPNB           Order Sequence
     C                     Z-ADDWL0155    WEUENB           Order Secondary
      *
     C           KLCHTS    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C           KLCHTS    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YERDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0156    WER1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTCHRC    BEGSR
      *================================================================
      * CHG Order in Use       CH - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0589  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0590  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0591  70       Ship To Custome
     C                     MOVEL*BLANK    WN0592 30        Ship To Name
     C                     MOVEL*BLANK    WN0593 30        Ship To Address
     C                     MOVEL*BLANK    WN0594 30        Ship To Address
     C                     MOVEL*BLANK    WN0595 30        Ship To Address
     C                     MOVEL*BLANK    WN0596 20        Ship To City
     C                     MOVEL*BLANK    WN0597  2        Ship To State C
     C                     MOVEL*BLANK    WN0598 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0599  70       Bill to Custome
     C                     MOVEL*BLANK    WN0600 30        Bill to Name
     C                     MOVEL*BLANK    WN0601 30        Bill to Address
     C                     MOVEL*BLANK    WN0602 30        Bill to Address
     C                     MOVEL*BLANK    WN0603 30        Bill to Address
     C                     MOVEL*BLANK    WN0604 20        Bill to City
     C                     MOVEL*BLANK    WN0605  2        Bill to State C
     C                     MOVEL*BLANK    WN0606 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0607 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0608  70       Order Date
     C                     Z-ADD*ZERO     WN0609  70       Requested Ship
     C                     Z-ADD*ZERO     WN0610  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0611  70       Cancel Date
     C                     MOVEL*BLANK    WN0612  2        Terms Code
     C                     MOVEL*BLANK    WN0613 40        Special Instruc
     C                     MOVEL*BLANK    WN0614 40        Special Instruc
     C                     MOVEL*BLANK    WN0615  3        Carrier Code
     C                     MOVEL*BLANK    WN0616  1        Comment Print A
     C                     MOVEL*BLANK    WN0617  1        Comment Print I
     C                     MOVEL*BLANK    WN0618  1        Comment Print P
     C                     MOVEL*BLANK    WN0619  1        Comment Print S
     C                     MOVEL*BLANK    WN0620  3        Reason Code
     C                     MOVEL*BLANK    WN0621  1        Header Status
     C                     MOVEL*BLANK    WN0622  1        Header Status L
     C                     MOVEL*BLANK    WN0623  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0624  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0625 10        User Original E
     C                     Z-ADD*ZERO     WN0626  70       Date of Origina
     C                     Z-ADD*ZERO     WN0627 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0628 112       Order Weight To
     C                     MOVEL*BLANK    WN0629  1        Credit Hold
     C                     MOVEL*BLANK    WN0630  1        Production Hold
     C                     MOVEL*BLANK    WN0631  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0632  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0633  40       Requested Deliv
     C                     MOVEL*BLANK    WN0634  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0635 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0636  70       Load ID
     C                     Z-ADD*ZERO     WN0637  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0638 112       Rated Freight
     C                     MOVEL*BLANK    WN0639  1        LTL Flag
     C                     MOVEL*BLANK    WN0640  1        Price Audit
     C                     MOVEL*BLANK    WN0641  1        Price Status
     C                     MOVEL*BLANK    WN0642  2        Shipping Method
     C                     MOVEL*BLANK    WN0643  1        Export Status
     C                     MOVEL*BLANK    WN0644  1        Palletize
     C                     MOVEL*BLANK    WN0645  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0646  1        Slip Sheet
     C                     MOVEL*BLANK    WN0647  1        Age Code
     C                     Z-ADD*ZERO     WN0648  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0649  1        Load Type
     C                     Z-ADD*ZERO     WN0650  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0651  1        Load Plan Order
     C                     MOVEL*BLANK    WN0652  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0653  70       Resell Referenc
     C                     MOVEL*BLANK    WN0654 30        Special Comment
     C                     MOVEL*BLANK    WN0655 30        Special Comment
     C                     MOVEL*BLANK    WN0656  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0657  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0658  2        Manager Level C
     C                     MOVEL*BLANK    WN0659  3        VP Level Code
     C                     Z-ADD*ZERO     WN0660  70       Attach to Order
     C                     MOVEL*BLANK    WN0661  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0662  70       Invoice Number
     C                     MOVEL*BLANK    WN0663  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0664  70       Invoice Date
     C                     MOVEL*BLANK    WN0665  2        Event Code
     C                     MOVEL*BLANK    WN0666  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0667  1        Modified Flag
     C                     Z-ADD*ZERO     WN0668 112       A/R order Value
     C                     MOVEL*BLANK    WN0669  1        Billing Activit
     C                     MOVEL*BLANK    WN0670  1        Block Order Fla
     C                     MOVEL*BLANK    WN0671  1        Order Certifica
     C                     Z-ADD*ZERO     WN0672 112       Invoice Order V
     C                     MOVEL*BLANK    WN0673  1        Process Sts for
     C                     MOVEL*BLANK    WN0674  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0675  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0676  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0677  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0678  1        Email Cust On O
     C                     MOVEL*BLANK    WN0679  1        Order Emailed
     C                     MOVEL*BLANK    WN0680  1        Export Docs Go
     C                     MOVEL*BLANK    WN0681  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0682  1        Broker Order St
     C                     MOVEL*BLANK    WN0683  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0684  2        Order Requires
     C                     MOVEL*BLANK    WN0685  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0686  2        Export USDA App
     C                     MOVEL*BLANK    WN0687  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0688  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0689  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0690  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0691  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0692  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0693  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0694  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0695  60       Time of Origina
     C                     Z-ADD*ZERO     WN0696  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0697  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0698  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0699 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0700 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0701 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0702 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0703 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0704  70       Claim Number
     C                     MOVEL*BLANK    WN0705  1        EDI Status 1
     C                     MOVEL*BLANK    WN0706  1        EDI Status 2
     C                     MOVEL*BLANK    WN0707  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0708  60       Job Time
     C                     MOVEL*BLANK    WN0709 10        User Id
     C                     MOVEL*BLANK    WN0710 10        Job Name
     C                     Z-ADD*ZERO     WN0711  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0157    WLAIC3           Company Number
     C                     Z-ADDWL0158    WLC4NB           Order Number
      *
     C           KLCHTT    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
     C           KLCHTT    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TTEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YFRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWL0159    WLGJST    P      Order in Use
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##PGM     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPFRC
     C                     Z-ADDWLAIC3    PFAIC3           Company Number
     C                     Z-ADDWLC4NB    PFC4NB           Order Number
     C                     MOVELWLJNCD    PFJNCD    P      Order Type - Sa
     C                     Z-ADDWLANC7    PFANC7           A/R Customer Nu
     C                     Z-ADDWLBKC7    PFBKC7           Ship To Custome
     C                     MOVELWLBRTX    PFBRTX    P      Ship To Name
     C                     MOVELWLHMNA    PFHMNA    P      Ship To Address
     C                     MOVELWLHONA    PFHONA    P      Ship To Address
     C                     MOVELWLHPNA    PFHPNA    P      Ship To Address
     C                     MOVELWLHNNA    PFHNNA    P      Ship To City
     C                     MOVELWLDBCD    PFDBCD    P      Ship To State C
     C                     MOVELWLCKTX    PFCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWLB0C7    PFB0C7           Bill to Custome
     C                     MOVELWLAETX    PFAETX    P      Bill to Name
     C                     MOVELWLB1NA    PFB1NA    P      Bill to Address
     C                     MOVELWLB3NA    PFB3NA    P      Bill to Address
     C                     MOVELWLB4NA    PFB4NA    P      Bill to Address
     C                     MOVELWLB2NA    PFB2NA    P      Bill to City
     C                     MOVELWLBHCD    PFBHCD    P      Bill to State C
     C                     MOVELWLC8TX    PFC8TX    P      Bill to Zip/Pos
     C                     MOVELWLBCNA    PFBCNA    P      Customer Purcha
     C                     Z-ADDWLA0DT    PFA0DT           Order Date
     C                     Z-ADDWLA5DT    PFA5DT           Requested Ship
     C                     Z-ADDWLGNDT    PFGNDT           Actual Shipped
     C                     Z-ADDWLACDT    PFACDT           Cancel Date
     C                     MOVELWLAQCD    PFAQCD    P      Terms Code
     C                     MOVELWLB6NA    PFB6NA    P      Special Instruc
     C                     MOVELWLBYNA    PFBYNA    P      Special Instruc
     C                     MOVELWLBZNA    PFBZNA    P      Carrier Code
     C                     MOVELWLGTST    PFGTST    P      Comment Print A
     C                     MOVELWLGVST    PFGVST    P      Comment Print I
     C                     MOVELWLGUST    PFGUST    P      Comment Print P
     C                     MOVELWLQFST    PFQFST    P      Comment Print S
     C                     MOVELWLCQCD    PFCQCD    P      Reason Code
     C                     MOVELWLGJST    PFGJST    P      Order in Use
     C                     MOVELWLGWST    PFGWST    P      Header Status
     C                     MOVELWLGXST    PFGXST    P      Header Status L
     C                     MOVELWLGYST    PFGYST    P      Order Type Prin
     C                     Z-ADDWLAODT    PFAODT           Scheduled Ship
     C                     MOVELWLAIVN    PFAIVN    P      User Original E
     C                     Z-ADDWLCXDT    PFCXDT           Date of Origina
     C                     Z-ADDWLJZVA    PFJZVA           Order Value Tot
     C                     Z-ADDWLA1WG    PFA1WG           Order Weight To
     C                     MOVELWLXIST    PFXIST    P      Credit Hold
     C                     MOVELWLXJST    PFXJST    P      Production Hold
     C                     MOVELWLXKST    PFXKST    P      New Customer Ho
     C                     Z-ADDWLEIDT    PFEIDT           Requested Deliv
     C                     Z-ADDWLAFTM    PFAFTM           Requested Deliv
     C                     MOVELWLE8CD    PFE8CD    P      Accounts Receiv
     C                     MOVELWLE9CD    PFE9CD    P      Accounts Receiv
     C                     Z-ADDWLRMNB    PFRMNB           Load ID
     C                     Z-ADDWLTBNB    PFTBNB           Absorbed Freigh
     C                     Z-ADDWLR1NB    PFR1NB           Rated Freight
     C                     MOVELWLPJST    PFPJST    P      LTL Flag
     C                     MOVELWLU0ST    PFU0ST    P      Price Audit
     C                     MOVELWLU1ST    PFU1ST    P      Price Status
     C                     MOVELWLQ2CD    PFQ2CD    P      Shipping Method
     C                     MOVELWLU2ST    PFU2ST    P      Export Status
     C                     MOVELWLVEST    PFVEST    P      Palletize
     C                     MOVELWLVFST    PFVFST    P      Shrink Wrap
     C                     MOVELWLVGST    PFVGST    P      Slip Sheet
     C                     MOVELWLRPCD    PFRPCD    P      Age Code
     C                     Z-ADDWLRNNB    PFRNNB           Reefer Temperat
     C                     MOVELWLVDST    PFVDST    P      Load Type
     C                     Z-ADDWLATIN    PFATIN           Attach to Invoi
     C                     MOVELWLU4ST    PFU4ST    P      Load Plan Order
     C                     MOVELWLU5ST    PFU5ST    P      Print Pick Slip
     C                     Z-ADDWLRSRN    PFRSRN           Resell Referenc
     C                     MOVELWLMHNA    PFMHNA    P      Special Comment
     C                     MOVELWLMINA    PFMINA    P      Special Comment
     C                     MOVELWLWBST    PFWBST    P      Affect Auto Acc
     C                     MOVELWLR4CD    PFR4CD    P      Sales Route Cod
     C                     MOVELWLBFCD    PFBFCD    P      Manager Level C
     C                     MOVELWLQ4CD    PFQ4CD    P      VP Level Code
     C                     Z-ADDWLT3NB    PFT3NB           Attach to Order
     C                     MOVELWLSICD    PFSICD    P      Reason for Pric
     C                     Z-ADDWLCONB    PFCONB           Invoice Number
     C                     MOVELWLCEST    PFCEST    P      Invoice Suffix
     C                     Z-ADDWLAWDT    PFAWDT           Invoice Date
     C                     MOVELWLJPCD    PFJPCD    P      Event Code
     C                     MOVELWLXUST    PFXUST    P      Trans Contol AS
     C                     MOVELWLZ1ST    PFZ1ST    P      Modified Flag
     C                     Z-ADDWLVRVA    PFVRVA           A/R order Value
     C                     MOVELWLOBST    PFOBST    P      Billing Activit
     C                     MOVELWLBCST    PFBCST    P      Block Order Fla
     C                     MOVELWLBDST    PFBDST    P      Order Certifica
     C                     Z-ADDWLB7VL    PFB7VL           Invoice Order V
     C                     MOVELWLGASX    PFGASX    P      Process Sts for
     C                     MOVELWLGBSX    PFGBSX    P      Order Conf Fax
     C                     MOVELWLGCSX    PFGCSX    P      Manifest Fax St
     C                     MOVELWLGDSX    PFGDSX    P      Invoice Fax Sts
     C                     MOVELWLFNSX    PFFNSX    P      Transfer in Sto
     C                     MOVELWLFOSX    PFFOSX    P      Email Cust On O
     C                     MOVELWLFPSX    PFFPSX    P      Order Emailed
     C                     MOVELWLFQSX    PFFQSX    P      Export Docs Go
     C                     MOVELWLFRSX    PFFRSX    P      Shipping Temp C
     C                     MOVELWLFSSX    PFFSSX    P      Broker Order St
     C                     MOVELWLFTSX    PFFTSX    P      Air Freight Ord
     C                     MOVELWLFUSX    PFFUSX    P      Order Requires
     C                     MOVELWLFVSX    PFFVSX    P      OH Load Plan Re
     C                     MOVELWLFWSX    PFFWSX    P      Export USDA App
     C                     MOVELWLFXSX    PFFXSX    P      HPB Ship to War
     C                     MOVELWLFYSX    PFFYSX    P      OH TF Exempt Co
     C                     Z-ADDWLNODT    PFNODT           OH Appt Confirm
     C                     Z-ADDWLNPDT    PFNPDT           JPN Invoice Iss
     C                     Z-ADDWLNQDT    PFNQDT           Load Actual Shi
     C                     Z-ADDWLNRDT    PFNRDT           Load BOL Comple
     C                     Z-ADDWLNSDT    PFNSDT           Load Truck Depa
     C                     Z-ADDWLBPTM    PFBPTM           Maximum Gross W
     C                     Z-ADDWLBQTM    PFBQTM           Time of Origina
     C                     Z-ADDWLBRTM    PFBRTM           OH Appt Confirm
     C                     Z-ADDWLBSTM    PFBSTM           Load BOL Comple
     C                     Z-ADDWLBTTM    PFBTTM           Load Truck Depa
     C                     Z-ADDWLH0NX    PFH0NX           Act Frt Referen
     C                     Z-ADDWLH1NX    PFH1NX           Act Non-Ref Frt
     C                     Z-ADDWLH2NX    PFH2NX           OH Fuel Surchar
     C                     Z-ADDWLH3NX    PFH3NX           OH Total Non-Re
     C                     Z-ADDWLH4NX    PFH4NX           OH Total Ref Fr
     C                     Z-ADDWLC0C7    PFC0C7           Claim Number
     C                     MOVELWLUVST    PFUVST    P      EDI Status 1
     C                     MOVELWLUWST    PFUWST    P      EDI Status 2
     C                     MOVELWLUXST    PFUXST    P      EDI Status 3
     C                     Z-ADDWLAATM    PFAATM           Job Time
     C                     MOVELWLAYNA    PFAYNA    P      User Id
     C                     MOVELWLA0NA    PFA0NA    P      Job Name
     C                     Z-ADDWLAXDT    PFAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TUCHRC    BEGSR
      *================================================================
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0712  70       Item Code
     C                     MOVEL*BLANK    WN0713  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0714  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0715  70       Order Group Cod
     C                     MOVEL*BLANK    WN0716  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0717  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0718 112       Billing Detail
     C                     Z-ADD*ZERO     WN0719 112       Billing Detail
     C                     Z-ADD*ZERO     WN0720 112       Billing Detail
     C                     Z-ADD*ZERO     WN0721 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0722  1        Comment Print A
     C                     MOVEL*BLANK    WN0723  1        Comment Print I
     C                     MOVEL*BLANK    WN0724  1        Comment Print P
     C                     MOVEL*BLANK    WN0725  1        Comment Print S
     C                     Z-ADD*ZERO     WN0726 112       Extended Amount
     C                     Z-ADD*ZERO     WN0727  70       Market Pricing
     C                     MOVEL*BLANK    WN0728  3        Commodity Marke
     C                     MOVEL*BLANK    WN0729  3        Date Method Cod
     C                     MOVEL*BLANK    WN0730  3        Price Method Co
     C                     Z-ADD*ZERO     WN0731 114       Price Overage O
     C                     Z-ADD*ZERO     WN0732  70       Contract Number
     C                     MOVEL*BLANK    WN0733  1        Price Status
     C                     Z-ADD*ZERO     WN0734  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0735  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0736  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0737  1        Work Confirm St
     C                     MOVEL*BLANK    WN0738  1        Work Over/Short
     C                     MOVEL*BLANK    WN0739  1        OD Production P
     C                     MOVEL*BLANK    WN0740 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0741 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0742  1        Age Code
     C                     MOVEL*BLANK    WN0743  1        Palletize
     C                     MOVEL*BLANK    WN0744  1        Slip Sheet
     C                     MOVEL*BLANK    WN0745  1        Catch Weight St
     C                     MOVEL*BLANK    WN0746  1        Price Audit
     C                     MOVEL*BLANK    WN0747  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0748  1        Production Date
     C                     Z-ADD*ZERO     WN0749 112       Rated Freight
     C                     Z-ADD*ZERO     WN0750 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0751 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0752 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0753 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0754 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0755 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0756 114       Unit Price
     C                     Z-ADD*ZERO     WN0757 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0758 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0759 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0760 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0761  70       Requested Ship
     C                     Z-ADD*ZERO     WN0762  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0763  70       Actual Shipped
     C                     MOVEL*BLANK    WN0764  1        Affect Inventor
     C                     MOVEL*BLANK    WN0765  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0766  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0767  30       Item Structure
     C                     Z-ADD*ZERO     WN0768  30       Item Structure
     C                     Z-ADD*ZERO     WN0769  30       Item Structure
     C                     MOVEL*BLANK    WN0770  2        Item Level
     C                     MOVEL*BLANK    WN0771  2        Quality Level
     C                     MOVEL*BLANK    WN0772  2        Pricing Product
     C                     MOVEL*BLANK    WN0773  2        Season Product
     C                     Z-ADD*ZERO     WN0774  70       Date of Origina
     C                     MOVEL*BLANK    WN0775 10        User Profile Na
     C                     MOVEL*BLANK    WN0776  6        Country Code
     C                     MOVEL*BLANK    WN0777  2        Event Code
     C                     MOVEL*BLANK    WN0778  3        Reason Code
     C                     MOVEL*BLANK    WN0779  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0780  1        Modified Flag
     C                     MOVEL*BLANK    WN0781  1        Substituted Fla
     C                     MOVEL*BLANK    WN0782  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0783 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0784 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0785  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0786  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0787  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0788  1        Affect Commissi
     C                     MOVEL*BLANK    WN0789  1        Affect Pricing
     C                     MOVEL*BLANK    WN0790  1        Released by Use
     C                     MOVEL*BLANK    WN0791  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0792  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0793  3        Production Ware
     C                     MOVEL*BLANK    WN0794  3        OD Price Type
     C                     Z-ADD*ZERO     WN0795  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0796  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0797  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0798  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0799  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0800  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0801  60       Price Code
     C                     Z-ADD*ZERO     WN0802  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0803  60       Substitution Li
     C                     Z-ADD*ZERO     WN0804  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0805 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0806 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0807 112       OD Item Target
     C                     Z-ADD*ZERO     WN0808 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0809 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0810 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0811 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0812 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0813 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0814 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0815 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0816 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0817 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0818  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0819  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0820  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0821 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0822  40       Item Age Days
     C                     Z-ADD*ZERO     WN0823  70       Production Ovr
     C                     Z-ADD*ZERO     WN0824  70       Production Ovr
     C                     MOVEL*BLANK    WN0825  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0826  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0827  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0828  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0829  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0830  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0831  1        EDI Status 1
     C                     MOVEL*BLANK    WN0832  1        EDI Status 2
     C                     MOVEL*BLANK    WN0833  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0834  60       Job Time
     C                     MOVEL*BLANK    WN0835 10        User Id
     C                     MOVEL*BLANK    WN0836 10        Job Name
     C                     Z-ADD*ZERO     WN0837  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0160    WEAIC3           Company Number
     C                     Z-ADDWL0161    WEC4NB           Order Number
     C                     Z-ADDWL0162    WEDPNB           Order Sequence
     C                     Z-ADDWL0163    WEUENB           Order Secondary
      *
     C           KLCHTU    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C           KLCHTU    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YGRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0164    WECCQT           Quantity Schedu
     C                     Z-ADDWL0165    WEAUWG           Weight Schedule
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVCHRC    BEGSR
      *================================================================
      * CHG Released by User  CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0838  70       Item Code
     C                     MOVEL*BLANK    WN0839  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0840  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0841  70       Order Group Cod
     C                     MOVEL*BLANK    WN0842  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0843  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0844 112       Billing Detail
     C                     Z-ADD*ZERO     WN0845 112       Billing Detail
     C                     Z-ADD*ZERO     WN0846 112       Billing Detail
     C                     Z-ADD*ZERO     WN0847 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0848  1        Comment Print A
     C                     MOVEL*BLANK    WN0849  1        Comment Print I
     C                     MOVEL*BLANK    WN0850  1        Comment Print P
     C                     MOVEL*BLANK    WN0851  1        Comment Print S
     C                     Z-ADD*ZERO     WN0852 112       Extended Amount
     C                     Z-ADD*ZERO     WN0853  70       Market Pricing
     C                     MOVEL*BLANK    WN0854  3        Commodity Marke
     C                     MOVEL*BLANK    WN0855  3        Date Method Cod
     C                     MOVEL*BLANK    WN0856  3        Price Method Co
     C                     Z-ADD*ZERO     WN0857 114       Price Overage O
     C                     Z-ADD*ZERO     WN0858  70       Contract Number
     C                     MOVEL*BLANK    WN0859  1        Price Status
     C                     Z-ADD*ZERO     WN0860  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0861  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0862  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0863  1        Work Confirm St
     C                     MOVEL*BLANK    WN0864  1        Work Over/Short
     C                     MOVEL*BLANK    WN0865  1        OD Production P
     C                     MOVEL*BLANK    WN0866 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0867 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0868  1        Age Code
     C                     MOVEL*BLANK    WN0869  1        Palletize
     C                     MOVEL*BLANK    WN0870  1        Slip Sheet
     C                     MOVEL*BLANK    WN0871  1        Catch Weight St
     C                     MOVEL*BLANK    WN0872  1        Price Audit
     C                     MOVEL*BLANK    WN0873  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0874  1        Production Date
     C                     Z-ADD*ZERO     WN0875 112       Rated Freight
     C                     Z-ADD*ZERO     WN0876 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0877 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0878 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0879 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0880 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0881 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0882 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0883 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0884 114       Unit Price
     C                     Z-ADD*ZERO     WN0885 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0886 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0887 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0888 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0889  70       Requested Ship
     C                     Z-ADD*ZERO     WN0890  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0891  70       Actual Shipped
     C                     MOVEL*BLANK    WN0892  1        Affect Inventor
     C                     MOVEL*BLANK    WN0893  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0894  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0895  30       Item Structure
     C                     Z-ADD*ZERO     WN0896  30       Item Structure
     C                     Z-ADD*ZERO     WN0897  30       Item Structure
     C                     MOVEL*BLANK    WN0898  2        Item Level
     C                     MOVEL*BLANK    WN0899  2        Quality Level
     C                     MOVEL*BLANK    WN0900  2        Pricing Product
     C                     MOVEL*BLANK    WN0901  2        Season Product
     C                     Z-ADD*ZERO     WN0902  70       Date of Origina
     C                     MOVEL*BLANK    WN0903 10        User Profile Na
     C                     MOVEL*BLANK    WN0904  6        Country Code
     C                     MOVEL*BLANK    WN0905  2        Event Code
     C                     MOVEL*BLANK    WN0906  3        Reason Code
     C                     MOVEL*BLANK    WN0907  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0908  1        Modified Flag
     C                     MOVEL*BLANK    WN0909  1        Substituted Fla
     C                     MOVEL*BLANK    WN0910  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0911 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0912 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0913  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0914  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0915  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0916  1        Affect Commissi
     C                     MOVEL*BLANK    WN0917  1        Affect Pricing
     C                     MOVEL*BLANK    WN0918  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0919  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0920  3        Production Ware
     C                     MOVEL*BLANK    WN0921  3        OD Price Type
     C                     Z-ADD*ZERO     WN0922  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0923  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0924  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0925  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0926  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0927  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0928  60       Price Code
     C                     Z-ADD*ZERO     WN0929  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0930  60       Substitution Li
     C                     Z-ADD*ZERO     WN0931  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0932 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0933 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0934 112       OD Item Target
     C                     Z-ADD*ZERO     WN0935 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0936 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0937 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0938 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0939 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0940 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0941 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0942 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0943 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0944 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0945  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0946  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0947  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0948 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0949  40       Item Age Days
     C                     Z-ADD*ZERO     WN0950  70       Production Ovr
     C                     Z-ADD*ZERO     WN0951  70       Production Ovr
     C                     MOVEL*BLANK    WN0952  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0953  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0954  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0955  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0956  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0957  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0958  1        EDI Status 1
     C                     MOVEL*BLANK    WN0959  1        EDI Status 2
     C                     MOVEL*BLANK    WN0960  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0961  60       Job Time
     C                     MOVEL*BLANK    WN0962 10        User Id
     C                     MOVEL*BLANK    WN0963 10        Job Name
     C                     Z-ADD*ZERO     WN0964  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0166    WEAIC3           Company Number
     C                     Z-ADDWL0167    WEC4NB           Order Number
     C                     Z-ADDWL0168    WEDPNB           Order Sequence
     C                     Z-ADDWL0169    WEUENB           Order Secondary
      *
     C           KLCHTV    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C           KLCHTV    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YHRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0170    WEF3SX    P      Released by Use
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWCHRC    BEGSR
      *================================================================
      * Chg Schedule Override CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0965  70       Item Code
     C                     MOVEL*BLANK    WN0966  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0967  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0968  70       Order Group Cod
     C                     MOVEL*BLANK    WN0969  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0970  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0971 112       Billing Detail
     C                     Z-ADD*ZERO     WN0972 112       Billing Detail
     C                     Z-ADD*ZERO     WN0973 112       Billing Detail
     C                     Z-ADD*ZERO     WN0974 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0975  1        Comment Print A
     C                     MOVEL*BLANK    WN0976  1        Comment Print I
     C                     MOVEL*BLANK    WN0977  1        Comment Print P
     C                     MOVEL*BLANK    WN0978  1        Comment Print S
     C                     Z-ADD*ZERO     WN0979 112       Extended Amount
     C                     Z-ADD*ZERO     WN0980  70       Market Pricing
     C                     MOVEL*BLANK    WN0981  3        Commodity Marke
     C                     MOVEL*BLANK    WN0982  3        Date Method Cod
     C                     MOVEL*BLANK    WN0983  3        Price Method Co
     C                     Z-ADD*ZERO     WN0984 114       Price Overage O
     C                     Z-ADD*ZERO     WN0985  70       Contract Number
     C                     MOVEL*BLANK    WN0986  1        Price Status
     C                     Z-ADD*ZERO     WN0987  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0988  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0989  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0990  1        Work Confirm St
     C                     MOVEL*BLANK    WN0991  1        Work Over/Short
     C                     MOVEL*BLANK    WN0992  1        OD Production P
     C                     MOVEL*BLANK    WN0993 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0994 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0995  1        Age Code
     C                     MOVEL*BLANK    WN0996  1        Palletize
     C                     MOVEL*BLANK    WN0997  1        Slip Sheet
     C                     MOVEL*BLANK    WN0998  1        Catch Weight St
     C                     MOVEL*BLANK    WN0999  1        Price Audit
     C                     MOVEL*BLANK    WN1000  3        Price Audit Rea
     C                     MOVEL*BLANK    WN1001  1        Production Date
     C                     Z-ADD*ZERO     WN1002 112       Rated Freight
     C                     Z-ADD*ZERO     WN1003 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN1004 112       Weight Ordered
     C                     Z-ADD*ZERO     WN1005 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN1006 112       Weight Schedule
     C                     Z-ADD*ZERO     WN1007 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN1008 112       Weight Shipped
     C                     Z-ADD*ZERO     WN1009 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN1010 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN1011 114       Unit Price
     C                     Z-ADD*ZERO     WN1012 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN1013 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN1014 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN1015 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN1016  70       Requested Ship
     C                     Z-ADD*ZERO     WN1017  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN1018  70       Actual Shipped
     C                     MOVEL*BLANK    WN1019  1        Affect Inventor
     C                     MOVEL*BLANK    WN1020  1        Affect Sales Do
     C                     MOVEL*BLANK    WN1021  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN1022  30       Item Structure
     C                     Z-ADD*ZERO     WN1023  30       Item Structure
     C                     Z-ADD*ZERO     WN1024  30       Item Structure
     C                     MOVEL*BLANK    WN1025  2        Item Level
     C                     MOVEL*BLANK    WN1026  2        Quality Level
     C                     MOVEL*BLANK    WN1027  2        Pricing Product
     C                     MOVEL*BLANK    WN1028  2        Season Product
     C                     Z-ADD*ZERO     WN1029  70       Date of Origina
     C                     MOVEL*BLANK    WN1030 10        User Profile Na
     C                     MOVEL*BLANK    WN1031  6        Country Code
     C                     MOVEL*BLANK    WN1032  2        Event Code
     C                     MOVEL*BLANK    WN1033  3        Reason Code
     C                     MOVEL*BLANK    WN1034  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1035  1        Modified Flag
     C                     MOVEL*BLANK    WN1036  1        Substituted Fla
     C                     Z-ADD*ZERO     WN1037 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN1038 112       Invoice Extende
     C                     Z-ADD*ZERO     WN1039  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN1040  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN1041  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN1042  1        Affect Commissi
     C                     MOVEL*BLANK    WN1043  1        Affect Pricing
     C                     MOVEL*BLANK    WN1044  1        Released by Use
     C                     MOVEL*BLANK    WN1045  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN1046  2        OD Pallet Type
     C                     MOVEL*BLANK    WN1047  3        Production Ware
     C                     MOVEL*BLANK    WN1048  3        OD Price Type
     C                     Z-ADD*ZERO     WN1049  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN1050  70       Consumed Item C
     C                     Z-ADD*ZERO     WN1051  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1052  70       OD Price Type R
     C                     Z-ADD*ZERO     WN1053  70       OD Firm Date
     C                     Z-ADD*ZERO     WN1054  60       Deadline Depart
     C                     Z-ADD*ZERO     WN1055  60       Price Code
     C                     Z-ADD*ZERO     WN1056  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN1057  60       Substitution Li
     C                     Z-ADD*ZERO     WN1058  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN1059 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN1060 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN1061 112       OD Item Target
     C                     Z-ADD*ZERO     WN1062 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN1063 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN1064 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN1065 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN1066 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN1067 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN1068 114       OD Original Ord
     C                     Z-ADD*ZERO     WN1069 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN1070 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN1071 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN1072  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN1073  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN1074  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN1075 112       Weight Amount E
     C                     Z-ADD*ZERO     WN1076  40       Item Age Days
     C                     Z-ADD*ZERO     WN1077  70       Production Ovr
     C                     Z-ADD*ZERO     WN1078  70       Production Ovr
     C                     MOVEL*BLANK    WN1079  1        OD Spot Buy
     C                     MOVEL*BLANK    WN1080  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN1081  3        Order Line Erro
     C                     Z-ADD*ZERO     WN1082  70       OD Market Begin
     C                     Z-ADD*ZERO     WN1083  70       OD Market Endin
     C                     Z-ADD*ZERO     WN1084  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN1085  1        EDI Status 1
     C                     MOVEL*BLANK    WN1086  1        EDI Status 2
     C                     MOVEL*BLANK    WN1087  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1088  60       Job Time
     C                     MOVEL*BLANK    WN1089 10        User Id
     C                     MOVEL*BLANK    WN1090 10        Job Name
     C                     Z-ADD*ZERO     WN1091  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0171    WEAIC3           Company Number
     C                     Z-ADDWL0172    WEC4NB           Order Number
     C                     Z-ADDWL0173    WEDPNB           Order Sequence
     C                     Z-ADDWL0174    WEUENB           Order Secondary
      *
     C           KLCHTW    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C           KLCHTW    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YIRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0175    WEZ4ST    P      OD Schedule Ove
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXCHRC    BEGSR
      *================================================================
      * Chg Adj Type Override CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1092  70       Item Code
     C                     MOVEL*BLANK    WN1093  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1094  70       Ship To Custome
     C                     Z-ADD*ZERO     WN1095  70       Order Group Cod
     C                     MOVEL*BLANK    WN1096  1        Detail Line Sta
     C                     MOVEL*BLANK    WN1097  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN1098 112       Billing Detail
     C                     Z-ADD*ZERO     WN1099 112       Billing Detail
     C                     Z-ADD*ZERO     WN1100 112       Billing Detail
     C                     Z-ADD*ZERO     WN1101 112       Quantity to Sub
     C                     MOVEL*BLANK    WN1102  1        Comment Print A
     C                     MOVEL*BLANK    WN1103  1        Comment Print I
     C                     MOVEL*BLANK    WN1104  1        Comment Print P
     C                     MOVEL*BLANK    WN1105  1        Comment Print S
     C                     Z-ADD*ZERO     WN1106 112       Extended Amount
     C                     Z-ADD*ZERO     WN1107  70       Market Pricing
     C                     MOVEL*BLANK    WN1108  3        Commodity Marke
     C                     MOVEL*BLANK    WN1109  3        Date Method Cod
     C                     MOVEL*BLANK    WN1110  3        Price Method Co
     C                     Z-ADD*ZERO     WN1111 114       Price Overage O
     C                     Z-ADD*ZERO     WN1112  70       Contract Number
     C                     MOVEL*BLANK    WN1113  1        Price Status
     C                     Z-ADD*ZERO     WN1114  70       Pricing Date Us
     C                     MOVEL*BLANK    WN1115  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN1116  2        U/M - Ordered
     C                     MOVEL*BLANK    WN1117  1        Work Confirm St
     C                     MOVEL*BLANK    WN1118  1        Work Over/Short
     C                     MOVEL*BLANK    WN1119  1        OD Production P
     C                     MOVEL*BLANK    WN1120 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1121 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1122  1        Age Code
     C                     MOVEL*BLANK    WN1123  1        Palletize
     C                     MOVEL*BLANK    WN1124  1        Slip Sheet
     C                     MOVEL*BLANK    WN1125  1        Catch Weight St
     C                     MOVEL*BLANK    WN1126  1        Price Audit
     C                     MOVEL*BLANK    WN1127  3        Price Audit Rea
     C                     MOVEL*BLANK    WN1128  1        Production Date
     C                     Z-ADD*ZERO     WN1129 112       Rated Freight
     C                     Z-ADD*ZERO     WN1130 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN1131 112       Weight Ordered
     C                     Z-ADD*ZERO     WN1132 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN1133 112       Weight Schedule
     C                     Z-ADD*ZERO     WN1134 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN1135 112       Weight Shipped
     C                     Z-ADD*ZERO     WN1136 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN1137 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN1138 114       Unit Price
     C                     Z-ADD*ZERO     WN1139 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN1140 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN1141 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN1142 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN1143  70       Requested Ship
     C                     Z-ADD*ZERO     WN1144  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN1145  70       Actual Shipped
     C                     MOVEL*BLANK    WN1146  1        Affect Inventor
     C                     MOVEL*BLANK    WN1147  1        Affect Sales Do
     C                     MOVEL*BLANK    WN1148  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN1149  30       Item Structure
     C                     Z-ADD*ZERO     WN1150  30       Item Structure
     C                     Z-ADD*ZERO     WN1151  30       Item Structure
     C                     MOVEL*BLANK    WN1152  2        Item Level
     C                     MOVEL*BLANK    WN1153  2        Quality Level
     C                     MOVEL*BLANK    WN1154  2        Pricing Product
     C                     MOVEL*BLANK    WN1155  2        Season Product
     C                     Z-ADD*ZERO     WN1156  70       Date of Origina
     C                     MOVEL*BLANK    WN1157 10        User Profile Na
     C                     MOVEL*BLANK    WN1158  6        Country Code
     C                     MOVEL*BLANK    WN1159  2        Event Code
     C                     MOVEL*BLANK    WN1160  3        Reason Code
     C                     MOVEL*BLANK    WN1161  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1162  1        Modified Flag
     C                     MOVEL*BLANK    WN1163  1        Substituted Fla
     C                     MOVEL*BLANK    WN1164  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN1165 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN1166 112       Invoice Extende
     C                     Z-ADD*ZERO     WN1167  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN1168  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN1169  1        Affect Commissi
     C                     MOVEL*BLANK    WN1170  1        Affect Pricing
     C                     MOVEL*BLANK    WN1171  1        Released by Use
     C                     MOVEL*BLANK    WN1172  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN1173  2        OD Pallet Type
     C                     MOVEL*BLANK    WN1174  3        Production Ware
     C                     MOVEL*BLANK    WN1175  3        OD Price Type
     C                     Z-ADD*ZERO     WN1176  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN1177  70       Consumed Item C
     C                     Z-ADD*ZERO     WN1178  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1179  70       OD Price Type R
     C                     Z-ADD*ZERO     WN1180  70       OD Firm Date
     C                     Z-ADD*ZERO     WN1181  60       Deadline Depart
     C                     Z-ADD*ZERO     WN1182  60       Price Code
     C                     Z-ADD*ZERO     WN1183  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN1184  60       Substitution Li
     C                     Z-ADD*ZERO     WN1185  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN1186 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN1187 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN1188 112       OD Item Target
     C                     Z-ADD*ZERO     WN1189 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN1190 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN1191 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN1192 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN1193 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN1194 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN1195 114       OD Original Ord
     C                     Z-ADD*ZERO     WN1196 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN1197 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN1198 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN1199  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN1200  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN1201  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN1202 112       Weight Amount E
     C                     Z-ADD*ZERO     WN1203  40       Item Age Days
     C                     Z-ADD*ZERO     WN1204  70       Production Ovr
     C                     Z-ADD*ZERO     WN1205  70       Production Ovr
     C                     MOVEL*BLANK    WN1206  1        OD Spot Buy
     C                     MOVEL*BLANK    WN1207  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN1208  3        Order Line Erro
     C                     Z-ADD*ZERO     WN1209  70       OD Market Begin
     C                     Z-ADD*ZERO     WN1210  70       OD Market Endin
     C                     Z-ADD*ZERO     WN1211  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN1212  1        EDI Status 1
     C                     MOVEL*BLANK    WN1213  1        EDI Status 2
     C                     MOVEL*BLANK    WN1214  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1215  60       Job Time
     C                     MOVEL*BLANK    WN1216 10        User Id
     C                     MOVEL*BLANK    WN1217 10        Job Name
     C                     Z-ADD*ZERO     WN1218  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0176    WEAIC3           Company Number
     C                     Z-ADDWL0177    WEC4NB           Order Number
     C                     Z-ADDWL0178    WEDPNB           Order Sequence
     C                     Z-ADDWL0179    WEUENB           Order Secondary
      *
     C           KLCHTX    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C           KLCHTX    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YJRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0180    WEFZSX    P      OD Adj Type Ove
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYCHRC    BEGSR
      *================================================================
      * CHG Ord Req Revw- flg CH - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN1219  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN1220  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN1221  70       Ship To Custome
     C                     MOVEL*BLANK    WN1222 30        Ship To Name
     C                     MOVEL*BLANK    WN1223 30        Ship To Address
     C                     MOVEL*BLANK    WN1224 30        Ship To Address
     C                     MOVEL*BLANK    WN1225 30        Ship To Address
     C                     MOVEL*BLANK    WN1226 20        Ship To City
     C                     MOVEL*BLANK    WN1227  2        Ship To State C
     C                     MOVEL*BLANK    WN1228 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN1229  70       Bill to Custome
     C                     MOVEL*BLANK    WN1230 30        Bill to Name
     C                     MOVEL*BLANK    WN1231 30        Bill to Address
     C                     MOVEL*BLANK    WN1232 30        Bill to Address
     C                     MOVEL*BLANK    WN1233 30        Bill to Address
     C                     MOVEL*BLANK    WN1234 20        Bill to City
     C                     MOVEL*BLANK    WN1235  2        Bill to State C
     C                     MOVEL*BLANK    WN1236 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN1237 15        Customer Purcha
     C                     Z-ADD*ZERO     WN1238  70       Order Date
     C                     Z-ADD*ZERO     WN1239  70       Requested Ship
     C                     Z-ADD*ZERO     WN1240  70       Actual Shipped
     C                     Z-ADD*ZERO     WN1241  70       Cancel Date
     C                     MOVEL*BLANK    WN1242  2        Terms Code
     C                     MOVEL*BLANK    WN1243 40        Special Instruc
     C                     MOVEL*BLANK    WN1244 40        Special Instruc
     C                     MOVEL*BLANK    WN1245  3        Carrier Code
     C                     MOVEL*BLANK    WN1246  1        Comment Print A
     C                     MOVEL*BLANK    WN1247  1        Comment Print I
     C                     MOVEL*BLANK    WN1248  1        Comment Print P
     C                     MOVEL*BLANK    WN1249  1        Comment Print S
     C                     MOVEL*BLANK    WN1250  3        Reason Code
     C                     MOVEL*BLANK    WN1251  1        Order in Use
     C                     MOVEL*BLANK    WN1252  1        Header Status
     C                     MOVEL*BLANK    WN1253  1        Header Status L
     C                     MOVEL*BLANK    WN1254  1        Order Type Prin
     C                     Z-ADD*ZERO     WN1255  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1256 10        User Original E
     C                     Z-ADD*ZERO     WN1257  70       Date of Origina
     C                     Z-ADD*ZERO     WN1258 112       Order Value Tot
     C                     Z-ADD*ZERO     WN1259 112       Order Weight To
     C                     MOVEL*BLANK    WN1260  1        Credit Hold
     C                     MOVEL*BLANK    WN1261  1        Production Hold
     C                     MOVEL*BLANK    WN1262  1        New Customer Ho
     C                     Z-ADD*ZERO     WN1263  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1264  40       Requested Deliv
     C                     MOVEL*BLANK    WN1265  4        Accounts Receiv
     C                     MOVEL*BLANK    WN1266 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN1267  70       Load ID
     C                     Z-ADD*ZERO     WN1268  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN1269 112       Rated Freight
     C                     MOVEL*BLANK    WN1270  1        LTL Flag
     C                     MOVEL*BLANK    WN1271  1        Price Audit
     C                     MOVEL*BLANK    WN1272  1        Price Status
     C                     MOVEL*BLANK    WN1273  2        Shipping Method
     C                     MOVEL*BLANK    WN1274  1        Export Status
     C                     MOVEL*BLANK    WN1275  1        Palletize
     C                     MOVEL*BLANK    WN1276  1        Shrink Wrap
     C                     MOVEL*BLANK    WN1277  1        Slip Sheet
     C                     MOVEL*BLANK    WN1278  1        Age Code
     C                     Z-ADD*ZERO     WN1279  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1280  1        Load Type
     C                     Z-ADD*ZERO     WN1281  70       Attach to Invoi
     C                     MOVEL*BLANK    WN1282  1        Load Plan Order
     C                     MOVEL*BLANK    WN1283  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN1284  70       Resell Referenc
     C                     MOVEL*BLANK    WN1285 30        Special Comment
     C                     MOVEL*BLANK    WN1286 30        Special Comment
     C                     MOVEL*BLANK    WN1287  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN1288  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1289  2        Manager Level C
     C                     MOVEL*BLANK    WN1290  3        VP Level Code
     C                     Z-ADD*ZERO     WN1291  70       Attach to Order
     C                     MOVEL*BLANK    WN1292  3        Reason for Pric
     C                     Z-ADD*ZERO     WN1293  70       Invoice Number
     C                     MOVEL*BLANK    WN1294  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN1295  70       Invoice Date
     C                     MOVEL*BLANK    WN1296  2        Event Code
     C                     MOVEL*BLANK    WN1297  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1298  1        Modified Flag
     C                     Z-ADD*ZERO     WN1299 112       A/R order Value
     C                     MOVEL*BLANK    WN1300  1        Billing Activit
     C                     MOVEL*BLANK    WN1301  1        Block Order Fla
     C                     MOVEL*BLANK    WN1302  1        Order Certifica
     C                     Z-ADD*ZERO     WN1303 112       Invoice Order V
     C                     MOVEL*BLANK    WN1304  1        Process Sts for
     C                     MOVEL*BLANK    WN1305  1        Order Conf Fax
     C                     MOVEL*BLANK    WN1306  1        Manifest Fax St
     C                     MOVEL*BLANK    WN1307  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN1308  1        Transfer in Sto
     C                     MOVEL*BLANK    WN1309  1        Email Cust On O
     C                     MOVEL*BLANK    WN1310  1        Order Emailed
     C                     MOVEL*BLANK    WN1311  1        Export Docs Go
     C                     MOVEL*BLANK    WN1312  1        Shipping Temp C
     C                     MOVEL*BLANK    WN1313  1        Broker Order St
     C                     MOVEL*BLANK    WN1314  1        Air Freight Ord
     C                     MOVEL*BLANK    WN1315  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN1316  2        Export USDA App
     C                     MOVEL*BLANK    WN1317  3        HPB Ship to War
     C                     MOVEL*BLANK    WN1318  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN1319  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1320  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN1321  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN1322  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN1323  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN1324  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN1325  60       Time of Origina
     C                     Z-ADD*ZERO     WN1326  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1327  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN1328  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN1329 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN1330 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN1331 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN1332 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN1333 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN1334  70       Claim Number
     C                     MOVEL*BLANK    WN1335  1        EDI Status 1
     C                     MOVEL*BLANK    WN1336  1        EDI Status 2
     C                     MOVEL*BLANK    WN1337  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1338  60       Job Time
     C                     MOVEL*BLANK    WN1339 10        User Id
     C                     MOVEL*BLANK    WN1340 10        Job Name
     C                     Z-ADD*ZERO     WN1341  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0181    WLAIC3           Company Number
     C                     Z-ADDWL0182    WLC4NB           Order Number
      *
     C           KLCHTY    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
     C           KLCHTY    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YKRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWL0183    WLFUSX    P      Order Requires
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Does not update the record stamp fields
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZCHRC    BEGSR
      *================================================================
      * CHG Ord Line Error Typ CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1342  70       Item Code
     C                     MOVEL*BLANK    WN1343  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1344  70       Ship To Custome
     C                     Z-ADD*ZERO     WN1345  70       Order Group Cod
     C                     MOVEL*BLANK    WN1346  1        Detail Line Sta
     C                     MOVEL*BLANK    WN1347  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN1348 112       Billing Detail
     C                     Z-ADD*ZERO     WN1349 112       Billing Detail
     C                     Z-ADD*ZERO     WN1350 112       Billing Detail
     C                     Z-ADD*ZERO     WN1351 112       Quantity to Sub
     C                     MOVEL*BLANK    WN1352  1        Comment Print A
     C                     MOVEL*BLANK    WN1353  1        Comment Print I
     C                     MOVEL*BLANK    WN1354  1        Comment Print P
     C                     MOVEL*BLANK    WN1355  1        Comment Print S
     C                     Z-ADD*ZERO     WN1356 112       Extended Amount
     C                     Z-ADD*ZERO     WN1357  70       Market Pricing
     C                     MOVEL*BLANK    WN1358  3        Commodity Marke
     C                     MOVEL*BLANK    WN1359  3        Date Method Cod
     C                     MOVEL*BLANK    WN1360  3        Price Method Co
     C                     Z-ADD*ZERO     WN1361 114       Price Overage O
     C                     Z-ADD*ZERO     WN1362  70       Contract Number
     C                     MOVEL*BLANK    WN1363  1        Price Status
     C                     Z-ADD*ZERO     WN1364  70       Pricing Date Us
     C                     MOVEL*BLANK    WN1365  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN1366  2        U/M - Ordered
     C                     MOVEL*BLANK    WN1367  1        Work Confirm St
     C                     MOVEL*BLANK    WN1368  1        Work Over/Short
     C                     MOVEL*BLANK    WN1369  1        OD Production P
     C                     MOVEL*BLANK    WN1370 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1371 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1372  1        Age Code
     C                     MOVEL*BLANK    WN1373  1        Palletize
     C                     MOVEL*BLANK    WN1374  1        Slip Sheet
     C                     MOVEL*BLANK    WN1375  1        Catch Weight St
     C                     MOVEL*BLANK    WN1376  1        Price Audit
     C                     MOVEL*BLANK    WN1377  3        Price Audit Rea
     C                     MOVEL*BLANK    WN1378  1        Production Date
     C                     Z-ADD*ZERO     WN1379 112       Rated Freight
     C                     Z-ADD*ZERO     WN1380 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN1381 112       Weight Ordered
     C                     Z-ADD*ZERO     WN1382 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN1383 112       Weight Schedule
     C                     Z-ADD*ZERO     WN1384 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN1385 112       Weight Shipped
     C                     Z-ADD*ZERO     WN1386 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN1387 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN1388 114       Unit Price
     C                     Z-ADD*ZERO     WN1389 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN1390 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN1391 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN1392 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN1393  70       Requested Ship
     C                     Z-ADD*ZERO     WN1394  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN1395  70       Actual Shipped
     C                     MOVEL*BLANK    WN1396  1        Affect Inventor
     C                     MOVEL*BLANK    WN1397  1        Affect Sales Do
     C                     MOVEL*BLANK    WN1398  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN1399  30       Item Structure
     C                     Z-ADD*ZERO     WN1400  30       Item Structure
     C                     Z-ADD*ZERO     WN1401  30       Item Structure
     C                     MOVEL*BLANK    WN1402  2        Item Level
     C                     MOVEL*BLANK    WN1403  2        Quality Level
     C                     MOVEL*BLANK    WN1404  2        Pricing Product
     C                     MOVEL*BLANK    WN1405  2        Season Product
     C                     Z-ADD*ZERO     WN1406  70       Date of Origina
     C                     MOVEL*BLANK    WN1407 10        User Profile Na
     C                     MOVEL*BLANK    WN1408  6        Country Code
     C                     MOVEL*BLANK    WN1409  2        Event Code
     C                     MOVEL*BLANK    WN1410  3        Reason Code
     C                     MOVEL*BLANK    WN1411  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1412  1        Modified Flag
     C                     MOVEL*BLANK    WN1413  1        Substituted Fla
     C                     MOVEL*BLANK    WN1414  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN1415 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN1416 112       Invoice Extende
     C                     Z-ADD*ZERO     WN1417  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN1418  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN1419  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN1420  1        Affect Commissi
     C                     MOVEL*BLANK    WN1421  1        Affect Pricing
     C                     MOVEL*BLANK    WN1422  1        Released by Use
     C                     MOVEL*BLANK    WN1423  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN1424  2        OD Pallet Type
     C                     MOVEL*BLANK    WN1425  3        Production Ware
     C                     MOVEL*BLANK    WN1426  3        OD Price Type
     C                     Z-ADD*ZERO     WN1427  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN1428  70       Consumed Item C
     C                     Z-ADD*ZERO     WN1429  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1430  70       OD Price Type R
     C                     Z-ADD*ZERO     WN1431  70       OD Firm Date
     C                     Z-ADD*ZERO     WN1432  60       Deadline Depart
     C                     Z-ADD*ZERO     WN1433  60       Price Code
     C                     Z-ADD*ZERO     WN1434  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN1435  60       Substitution Li
     C                     Z-ADD*ZERO     WN1436  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN1437 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN1438 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN1439 112       OD Item Target
     C                     Z-ADD*ZERO     WN1440 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN1441 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN1442 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN1443 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN1444 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN1445 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN1446 114       OD Original Ord
     C                     Z-ADD*ZERO     WN1447 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN1448 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN1449 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN1450  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN1451  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN1452  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN1453 112       Weight Amount E
     C                     Z-ADD*ZERO     WN1454  40       Item Age Days
     C                     Z-ADD*ZERO     WN1455  70       Production Ovr
     C                     Z-ADD*ZERO     WN1456  70       Production Ovr
     C                     MOVEL*BLANK    WN1457  1        OD Spot Buy
     C                     MOVEL*BLANK    WN1458  2        OD Clm Full Ret
     C                     Z-ADD*ZERO     WN1459  70       OD Market Begin
     C                     Z-ADD*ZERO     WN1460  70       OD Market Endin
     C                     Z-ADD*ZERO     WN1461  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN1462  1        EDI Status 1
     C                     MOVEL*BLANK    WN1463  1        EDI Status 2
     C                     MOVEL*BLANK    WN1464  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1465  60       Job Time
     C                     MOVEL*BLANK    WN1466 10        User Id
     C                     MOVEL*BLANK    WN1467 10        Job Name
     C                     Z-ADD*ZERO     WN1468  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * ** This routine does NOT update the change audit fields  P001251
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0184    WEAIC3           Company Number
     C                     Z-ADDWL0185    WEC4NB           Order Number
     C                     Z-ADDWL0186    WEDPNB           Order Sequence
     C                     Z-ADDWL0187    WEUENB           Order Secondary
      *
     C           KLCHTZ    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C           KLCHTZ    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YLRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0188    WEH1ST    P      Order Line Erro
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Production Date
      *================================================================
      * CASE: LCL.Production Date USR LT JOB.*Job date
     C           YL0001    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0001           Production Date
     C                     END                             *FI
      * Rtv ProdDte-6         RT - Calendar  * 
     C                     EXSR SBRVGN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Check if Adjustments exists for the Base Item
      *================================================================
      * FP1054 use ctl.prod warehouse instead of  ctl.warehouse code
      * Rtv Adjustment Sts    RT - PS Production Adjustment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0080           Company Number
     C                     Z-ADD#2NUDT    WL0081           PS Consumed Ite
     C                     MOVEL#2F6SX    WL0082    P      Warehouse Code
     C                     Z-ADD#CFFDT    WL0083           Production Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    #CTIST    P      USR Display fie
     C                     MOVELWL0085    #CNOSX    P      Status - Y or N
      * Rtv Adjustment Sts    RT - PS Production Adjustment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0080           Company Number
     C                     Z-ADD#2NUDT    WL0081           PS Consumed Ite
     C                     MOVEL#2F6SX    WL0082    P      Warehouse Code
     C                     Z-ADD#CE1DT    WL0083           Production Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    #CTJST    P      USR Display fie
     C                     MOVELWL0085    #CNPSX    P      Status - Y or N
      * Rtv Adjustment Sts    RT - PS Production Adjustment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0080           Company Number
     C                     Z-ADD#2NUDT    WL0081           PS Consumed Ite
     C                     MOVEL#2F6SX    WL0082    P      Warehouse Code
     C                     Z-ADD#CE2DT    WL0083           Production Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    #CASTS    P      USR Display fie
     C                     MOVELWL0085    #CNQSX    P      Status - Y or N
      * Rtv Adjustment Sts    RT - PS Production Adjustment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0080           Company Number
     C                     Z-ADD#2NUDT    WL0081           PS Consumed Ite
     C                     MOVEL#2F6SX    WL0082    P      Warehouse Code
     C                     Z-ADD#CE3DT    WL0083           Production Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    #CBSTS    P      USR Display fie
     C                     MOVELWL0085    #CNRSX    P      Status - Y or N
      * Rtv Adjustment Sts    RT - PS Production Adjustment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0080           Company Number
     C                     Z-ADD#2NUDT    WL0081           PS Consumed Ite
     C                     MOVEL#2F6SX    WL0082    P      Warehouse Code
     C                     Z-ADD#CE4DT    WL0083           Production Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    #CGFSX    P      USR Display fie
     C                     MOVELWL0085    #CNSSX    P      Status - Y or N
      * Rtv Adjustment Sts    RT - PS Production Adjustment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0080           Company Number
     C                     Z-ADD#2NUDT    WL0081           PS Consumed Ite
     C                     MOVEL#2F6SX    WL0082    P      Warehouse Code
     C                     Z-ADD#CE5DT    WL0083           Production Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    #CHPSX    P      USR Display fie
     C                     MOVELWL0085    #CNTSX    P      Status - Y or N
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Set Up Kill & Production Date / Kill & Production Date Ranges
      *================================================================
      * Calculate From and To Kill Dates
      * CASE: *OTHERWISE
     C                     Z-ADD##JDT     P6JRDT           Kill Date CUR U
      * PAR.Kill Date PRV USR = PAR.Kill Date CUR USR + CON.-1 *DAYS
     C           P6JRDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P6JQDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P6JQDT
     C                     END
     C                     Z-ADDP6JQDT    P6GGDT           Kill Date
      * PAR.Kill Date 360 RGF = PAR.Kill Date + CON.1 *DAYS
     C           P6GGDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P6WIDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P6WIDT
     C                     END
      * S14774 JJH 04/03/19 - Get alloc nbr days in system values-ALLOCDA
      * RTV Numeric Value      RT - System Values  * 
     C                     EXSR SIRVGN
      * CASE: LCL.*Duration (factor) is EQ Zero
     C           YL0043    IFEQ *ZERO                      *IF
     C                     Z-ADD40        YL0043           *Duration (fact
     C                     END                             *FI
      * RTV KillDay Dte-Durtn  RT - Calendar  * Kill Date 360 RGT
     C                     EXSR SJRVGN
     C                     Z-ADDP6GGDT    P6MBDT           Date
     C                     Z-ADDP6WIDT    P6WKDT           Kill Date 440 R
     C                     Z-ADDP6WJDT    P6WLDT           Kill Date 440 R
     C                     Z-ADDP6WIDT    P6WMDT           Kill Date 960 R
     C                     Z-ADDP6WJDT    P6WNDT           Kill Date 960 R
      * Calculate From and To Production Dates
      * CASE: *OTHERWISE
     C                     Z-ADDP6GGDT    P6ELDT           Production Date
     C                     Z-ADDP6WIDT    P6WCDT           Production Date
     C                     Z-ADDP6WJDT    P6WDDT           Production Date
     C                     Z-ADDP6WCDT    P6WEDT           Production Date
     C                     Z-ADDP6WDDT    P6WFDT           Production Date
     C                     Z-ADDP6WCDT    P6WGDT           Production Date
     C                     Z-ADDP6WDDT    P6WHDT           Production Date
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Check if Adjustments exists for the Base Item
      *================================================================
      * FP1054 chg to use CTL.production Warehouse Code
      * Rtv Adjustment Sts    RT - PS Production Adjustment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0080           Company Number
     C                     Z-ADD#2NUDT    WL0081           PS Consumed Ite
     C                     MOVEL#2F6SX    WL0082    P      Warehouse Code
     C                     Z-ADD#CFFDT    WL0083           Production Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    #CTIST    P      USR Display fie
     C                     MOVELWL0085    #CNOSX    P      Status - Y or N
      * Rtv Adjustment Sts    RT - PS Production Adjustment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0080           Company Number
     C                     Z-ADD#2NUDT    WL0081           PS Consumed Ite
     C                     MOVEL#2F6SX    WL0082    P      Warehouse Code
     C                     Z-ADD#CE1DT    WL0083           Production Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    #CTJST    P      USR Display fie
     C                     MOVELWL0085    #CNPSX    P      Status - Y or N
      * Rtv Adjustment Sts    RT - PS Production Adjustment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0080           Company Number
     C                     Z-ADD#2NUDT    WL0081           PS Consumed Ite
     C                     MOVEL#2F6SX    WL0082    P      Warehouse Code
     C                     Z-ADD#CE2DT    WL0083           Production Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    #CASTS    P      USR Display fie
     C                     MOVELWL0085    #CNQSX    P      Status - Y or N
      * Rtv Adjustment Sts    RT - PS Production Adjustment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0080           Company Number
     C                     Z-ADD#2NUDT    WL0081           PS Consumed Ite
     C                     MOVEL#2F6SX    WL0082    P      Warehouse Code
     C                     Z-ADD#CE3DT    WL0083           Production Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    #CBSTS    P      USR Display fie
     C                     MOVELWL0085    #CNRSX    P      Status - Y or N
      * Rtv Adjustment Sts    RT - PS Production Adjustment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0080           Company Number
     C                     Z-ADD#2NUDT    WL0081           PS Consumed Ite
     C                     MOVEL#2F6SX    WL0082    P      Warehouse Code
     C                     Z-ADD#CE4DT    WL0083           Production Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    #CGFSX    P      USR Display fie
     C                     MOVELWL0085    #CNSSX    P      Status - Y or N
      * Rtv Adjustment Sts    RT - PS Production Adjustment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CBTC3    WL0080           Company Number
     C                     Z-ADD#2NUDT    WL0081           PS Consumed Ite
     C                     MOVEL#2F6SX    WL0082    P      Warehouse Code
     C                     Z-ADD#CE5DT    WL0083           Production Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    #CHPSX    P      USR Display fie
     C                     MOVELWL0085    #CNTSX    P      Status - Y or N
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * F90  ONLY for people that know about it
      *================================================================
      * F90 & F91 are for IS personnel only (Not PORKSCHE)
      * ** 11/19/2007 LJB FP1251 This routine resets the DDD/T fields to
      * ** zeros if there is no Miles To Next Stop or Miles Between Citie
      * 90=Calculate Deadline Departure Date/Time (Testing only)
      * CASE: RCD.*SFLSEL is Option 90
     C           #1SEL     IFEQ '90'                       *IF
      * E01523 5/02 RMC Use req delv dt/time always
      * CLC Deadln Depart Dt  XF - Order Header TRG  * 
     C                     CALL 'POSCXFR'              90  CLC Deadln Depa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0090  30       Company Number
     C                     PARM #1C4NB    WQ0091  70       Order Number
     C                     PARM #RHNNA    WQ0092 20        City
     C                     PARM #RDBCD    WQ0093  2        State Code
     C                     PARM #REIDT    WQ0094  70       Requested Deliv
     C                     PARM #RAFTM    WQ0095  40       Requested Deliv
     C           #1NVDT    PARM *ZERO     WQ0096  70       Deadline Depart
     C           #1BUTM    PARM *ZERO     WQ0097  60       Deadline Depart
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POSCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
     C                     EXSR SVRVGN
      * CASE: RCD.Deadline Depart Date LH is not entered
     C           #1NVDT    IFEQ *ZERO                      *IF
      * Send message 'Mileages not found.'
     C                     MOVEL'USR2818' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Update Function
      *================================================================
      * FP1309 add the aging fields
      * RTV for PA update val2RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0098           Company Number
     C                     Z-ADD#1C4NB    WL0099           Order Number
     C                     Z-ADD#1DPNB    WL0100           Order Sequence
     C                     Z-ADD#1UENB    WL0101           Order Secondary
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0102    YL0071    P      Warehouse Code
     C                     MOVELWL0103    YL0072    P      OD Production P
     C                     Z-ADDWL0104    YL0073           Quantity Schedu
     C                     Z-ADDWL0105    YL0074           Weight Schedule
     C                     MOVELWL0106    YL0075    P      OD Schedule Ove
     C                     MOVELWL0107    YL0076    P      OD Adj Type Ove
     C                     Z-ADDWL0108    YL0102           Item Age Days
     C                     Z-ADDWL0109    YL0103           Production Ovr
     C                     Z-ADDWL0110    YL0104           Production Ovr
      * If something has changed, dont allow option
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8
      *   |- c1    : RCD.Warehouse Code NE LCL.Warehouse Code SavUsr
      *   |- c2    : RCD.Weight Scheduled NE LCL.Weight Scheduled USR
      *   |- c3    : RCD.Quantity Scheduled NE LCL.Quantity Scheduled 1 U
      *   |- c4    : RCD.OD Schedule Override Sts NE LCL.OD Schedule Over
      *   |- c5    : RCD.OD Adj Type Override NE LCL.OD Adj Type Override
      *   |- c6    : RCD.Item Age Days NE LCL.Item age days usr
      *   |- c7    : RCD.Production Ovr AgeDte Fr NE LCL.Prod Ovr AgeDte
      *   |- c8    : RCD.Production Ovr AgeDte To NE LCL.Prod Ovr AgeDte
      *   '-
     C           #1AJCD    IFNE YL0071                     *IF
     C           #1AUWG    ORNE YL0074                     *OR
     C           #1CCQT    ORNE YL0073                     *OR
     C           #1Z4ST    ORNE YL0075                     *OR
     C           #1FZSX    ORNE YL0076                     *OR
     C           #1RINY    ORNE YL0102                     *OR
     C           #1TIDT    ORNE YL0103                     *OR
     C           #1TJDT    ORNE YL0104                     *OR
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0039           *SFLSEL
      * Send message 'Order has chgd since dspl'
     C                     MOVEL'USR4173' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Order in Use       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0111           Company Number
     C                     Z-ADD#1C4NB    WL0112           Order Number
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0113    YL0080    P      Order in Use
     C                     MOVELWL0114    YL0081    P      Header Status
     C                     Z-ADDWL0115    #RRMNB           Load ID
      * LCL.Job Date Usr = JOB.*Job date + CON.7 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD7         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0082
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0082
     C                     END
      * val order stuff and load stuff
      * CASE: LCL.Order in Use is yes
     C           YL0080    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0040           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0041           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0041           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: LCL.Header Status is Cancelled
     C           YL0081    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0042           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * val load stuff
      * CASE: RCD.Load ID is GT Zero
     C           #RRMNB    IFGT *ZERO                      *IF
      * Validate
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #RPKST    IFEQ 'I'                        *IF
     C           #RPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0043           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
      * E2824 RMC 10/14/13 dont changes if locked here - code not changed
     C                     ELSE
      * CASE: E2824 RMC 10/14/13 allow changes if locked
      *  - c1ANDc2
      *   |- c1    : RCD.Load Status is Lock
      *   |- c2    : RCD.Scheduled Ship Date LE LCL.Job Date Usr
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RPKST    IFEQ 'L'                        *IF
     C           #1AODT    IFLE YL0082                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * if ship date is within 7 days, then dont allow
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0044           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       YL0053           Error Status
     C                     ELSE
      * CASE: RCD.Load Status is Lock
     C           #RPKST    IFEQ 'L'                        *IF
      *
     C                     MOVEL*BLANK    WN1484  1        Load Status
     C                     MOVEL*BLANK    WN1485  1        Block Order Fla
      *
      * EDT Unlock Load Edit   IF
      * RTV Load Status        RT - OM Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0116           Load ID
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0117    WN1484    P      Load Status
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0118           Load ID
     C                     MOVELWN1485    WL0120    P      Block Order Fla
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0119    WUJDST    P      USR Check Y/N S
     C                     MOVELWL0120    WN1485    P      Block Order Fla
      * RMC PFS017 6/5/6 new par.allow unlock if picked = N
      *
     C                     MOVEL*BLANK    WN1486  1        Access Denied (
      *
      * EDT Unlock Load Edits  IF
      * assume will have error
     C                     MOVEL'Y'       YL0053           Error Status
      *
     C                     MOVEL*BLANK    WN1487 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN1487           User Profile Na
      *
     C                     MOVEL*BLANK    WN1488 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1487    WL0121    P      User Profile Na
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0122    WUG0TX    P      Allow Multi-Com
     C                     MOVELWL0123    WUG0TX    P      Default Printer
     C                     MOVELWL0124    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0125    YL0083           Company Number
     C                     MOVELWL0126    WN1488    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,004                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN1488    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1487    WL0127    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0128    P      Application Cod
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0129    WUAIC3           Company Number
     C                     MOVELWL0130    YL0084    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1488    WL0127    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0128    P      Application Cod
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0129    WUAIC3           Company Number
     C                     MOVELWL0130    YL0084    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0084    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0083    IFGT 0                          *IF
     C                     Z-ADDYL0083    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0084    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0085    WL0132           Shipping Compan
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0131    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN1486           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0133           Company Number
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0134    WUG0TX    P      Name
     C                     END                             *FI
      * check the entry control field too.  4/28/05 so christa can do.
      * Rtv Unlock Load Authr RT - Entry Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0135    P      User Profile Na
     C                     MOVEL'O/P'     WL0136    P      Application Cod
     C                     Z-ADD#1AIC3    WL0137           Company Number
     C                     EXSR TFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0138    WUHTST    P      Unlock Load Aut
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Access Denied (Y/N) is yes
      *   |- c2    : WRK.Unlock Load Authority is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN1486    IFEQ 'Y'                        *IF
     C           WUHTST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'User Cant Lock/Unlock Ld'
     C                     MOVEL'USR2468' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If load has been shipped, can't unlock. RMC Chg for picked 5/31/0
      * CASE: PAR.Block Order Flag is Block Order
     C           WN1485    IFEQ 'B'                        *IF
      *   (load contains a block order)
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0045           *SFLSEL
     C                     Z-ADD#RRMNB    ZA0046           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           WN1484    IFEQ 'I'                        *IF
     C           WN1484    OREQ 'S'
      * Setup message data for message
     C                     MOVELWN1484    ZA0047           Load Status
      * Send message 'Load Shipped Can't Unlock'
     C                     MOVEL'USR1272' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * **** Determine if Load has been picked, if yes do not allow unloc
      * **** This function checks OP Order Events & AS Picked Acknowledgm
      * CASE: PAR.Allow Unlock if Picked St is No
     C           'N'       IFEQ 'N'                        *IF
      * Do this one if par is NO. We dont want an UNLOCK if there are XOx
      *   and it isnt shipping doing it.
      * RTV Load Order Picked  XF - AS Order Header  * 
     C                     CALL 'PDQVXFR'              90  RTV Load Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0162  70       Load ID
     C                     PARM #1AIC3    WQ0163  30       Company Number
     C           WUZMST    PARM WUZMST    WQ0164  1        Pick Status USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0086           PFS Load ID
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0087    WUZMST    P      Pick Status USR
     C                     END                             *FI
      * Allow if picked but not Close Order or Close Truck  5/31/06
      * CASE: WRK.Pick Status USR is Picked
     C           WUZMST    IFEQ 'Y'                        *IF
      * CASE: PAR.Allow Unlock if Picked St is No
     C           'N'       IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVELWN1484    ZA0048           Load Status
      * Send message 'Load Picked, Unlock Inval'
     C                     MOVEL'USR1999' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Close Ord/Trk XF - PFS Ship Load/Order Sts  * 
     C                     CALL 'PPYIXFR'              90  PFS Val Close O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0165  70       Load ID
     C           WUB8ST    PARM *BLANK    WQ0166  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0049           *SFLSEL
      * Send message 'Unlock Inval, close exist'
     C                     MOVEL'USR3629' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       YL0053           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       YL0053           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Error Status is no
     C           YL0053    IFEQ 'N'                        *IF
      * Auto Unlock after validations are passed
      * CASE: RCD.Load Status is Lock
     C           #RPKST    IFEQ 'L'                        *IF
      *
     C                     MOVEL*BLANK    WN1489  3        Shipping Line
     C                     MOVEL*BLANK    WN1490 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1491  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1492  1        USR Status (Y/N
      *
      * UPD Unlock Load Update IF
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0139           Load ID
     C                     MOVEL'U'       WL0140    P      Load Status
     C                     Z-ADD*ZERO     WL0141           Rated Freight
     C                     EXSR TGCHRC
      *
     C                     MOVEL*BLANK    WN1493  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1494  1        USR Status (Y/N
     C                     Z-ADD*ZERO     WN1495  90       GAF Customer Nu
     C                     MOVEL*BLANK    WN1496  3        GAF Function
      *
      * EDT Unlock Load        IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0142           Load ID
     C                     EXSR THRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0143    WN1493    P      Trans Contol AS
      * RTV System Value Alpha RT - System Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL@CN,005   WL0144    P      System Value Co
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0145    YL0086    P      System Value Al
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0146           PFS Company Num
     C                     MOVEL'LDORDD'  WL0147    P      PFS Interface C
     C                     EXSR TMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0148    YL0087    P      PFS AccuSort Ac
     C                     MOVELWL0149    YL0088    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0087    IFEQ 'Y'                        *IF
      * Notify Accusort if locked load
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN1493    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0167  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * DEL AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQ0XFR'              90  DEL AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0168  70       Load ID
     C                     PARM #1AIC3    WQ0169  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQ0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0170  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0088    IFEQ 'Y'                        *IF
      * PFS Unlock Load/Order XF - PFS Load Header  * 
     C                     CALL 'PPNQXFR'              90  PFS Unlock Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0171  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0172  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** 09/23/2011 RMC E1607  if load had a whs with edi wso interchan
      *    delete it if Unproc, else change it to "D"elete/and reprocess
      * Exc ChgDel EDI f/UnlckXF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PBAEXFR'              90  Exc ChgDel EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RRMNB    WQ0173  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBAEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Clear Rated Frt    RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RRMNB    WL0150           Load ID
     C                     Z-ADD*ZERO     WL0151           Stop/Drop Seque
     C                     EXSR TNRVGN
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     MOVEL'UNLOCK'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPGRC
     C                     Z-ADD#RRMNB    PGRMNB           Load ID
     C                     Z-ADD*ZERO     PGRVNB           Stop/Drop
     C                     MOVELWURVST    PGRVST    P      Load Change Typ
     C                     MOVELWUUJST    PGUJST    P      Department Cont
     C                     MOVEL#RPKST    PGMNTX    P      Change Log Prio
     C                     MOVEL'U'       PGMOTX    P      Change Log New
     C                     MOVEL##USR     PGAYNA    P      User Id
     C                     MOVEL##PGM     PGA0NA    P      Job Name
     C                     MOVEL#RBZNA    PGBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PGAIC3           Company Number
     C                     Z-ADD*ZERO     PGC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * allow edit Age Information if Error Sts = N
      * CASE: LCL.Error Status is no
     C           YL0053    IFEQ 'N'                        *IF
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'Y'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
      * Edt Age Information   E1 - Order Detail  * 
     C                     CLEARPHRC
     C                     Z-ADD#1AIC3    PHAIC3           Company Number
     C                     Z-ADD#1C4NB    PHC4NB           Order Number
     C                     Z-ADD#1DPNB    PHDPNB           Order Sequence
     C                     Z-ADD#1UENB    PHUENB           Order Secondary
      *
     C                     CALL 'PNO3E1R'              90  Edt Age Informa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PHRC             KEY: Order Deta
     C                     PARM 'Y'       WQ0174  1        Dealloc/Alloc U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO3E1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0157           Company Number
     C                     Z-ADD#1C4NB    WL0158           Order Number
     C                     MOVEL'N'       WL0159    P      Order in Use
     C                     EXSR TTCHRC
      * *
     C                     MOVEL'Y'       YL0056           *Reload subfile
     C                     MOVEL'Y'       YL0055           Post Flag USR
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * W78830 DN  07/13/21 - Added option 6=Chg Ord Qty.
      * - Added value '6' to 'PPS Update' condition value list.
      * - Copied opt 6 logic from opt 2 in PORYDFR function.
      * R15115 RMC 08/23/19 - Chg OPBGWKN3 TO HAVE KEY 3 OF REQ SHIP DATE
      *  OF SCHEDULED SHIP DATE. CHANGE SCREEN & change places using sche
      *   use REQ -- that werent already using REQ
      * S14774 JJH 04/03/19 - Get alloc nbr days in system values-ALLOCDA
      * E14728 JJH 03/27/19 - Last Allocation Date
      * - Do not allow Option 2=Edit Sched, 17=Re-alc, and 19=De-alc if
      *   the Order's Scheduled Ship Date is GT the Last Allocation Date.
      * - Last Allocation Date is the Last Date in which the Inventory Bu
      *   process will perform allocation.  We are using the same logic
      *  to calculate the Last Allocation Date used on the Build Producti
      *   Schedule (PDRRPVR) function.
      * *****
      * R13899 RMC 10.11.18  if od price type is DST/TNK force allocation
      * ** to suspended so it can only take inventory
      * *****
      * ** 10/20/17 DN  R11918 - Do NOT allow opt '2=Edit Sched' & opt
      *    '16=Ship off Cut' if Allocation Method='I' (Suspended Inventor
      * - Change 'Block Order Flag' to be input capable.
      * *****
      * R11387 RMC 9/2217 add spmodsche for scheduling functs
      * ** 08/03/17 DN  T10731 - Inventory Visibility Enhancement-Intake
      * - Undo OPBGWKN3 access path SELECT criteria.
      * *****
      * R11387 RMC 8/2/17 allow opt 2 if user has user authority "SO" sch
      * *****
      * ** 06/07/17 DN  T10731 - Inventory Visibility Enhancement-Intake
      * - Recompile due to OPBGWKN3 access path was changed to Select
      *   Detail Line Status=R (Confirmed). No logic change.
      * - Per RC, commented out codes that was done for E4119 project but
      *   was never promoted to PROD.
      * *****
      * ** 05/19/16 RMC E4119 remove live with tpm check
      * *****
      * ** 03/01/16 RMC WHD 9935  new PORKSCHE5 for Nicki - also will do
      * *****
      * 04/03/2015 LJB E004019   Disable Display Load (option 13)
      *     if Live w/TPM = Yes
      * *****
      * ** 01/19/15   RMC E3852  allow TFMODSCHE same updates as PORKSCHE
      * *****
      * ** 01/13/14   RMC E2885  allow PORKTRAF3 same updates as PORKSCHE
      *    YLW qty ordered if sched override=Y
      * *****
      * E2824 RMC 10/14/13 allow changes if locked - dont unlock/lock per
      *    Still check locked sts for Sched ship date and Age Day changes
      * *****
      * ** E2625 08/19/13 RMC if load locked, but no PDKNCPP, set prod pl
      *      NO so it wont show up in the RED
      * ** E2625 08/05/13 RMC Chg sched ship dt to Sched Load dt
      * ** 02/22/2012 LJB C001956   Clear the upload error flags in order
      *     header and order detail for release line item
      *  09/23/2011 RMC E1607  if load had a whs with edi wso interchange
      * ** 05/02/2011   RMC E01523 Use req delv dt/time always for ddt ca
      * FP1309 Inventory Age  IF
      * FP1309 Inventory Age Code Description
      * Replace Age Code with the age days
      * also replaced the calculate pa age with the new routine
      * ** 04/15/2010   RMC C0679 - the below isnt working, so comment fo
      * ** 04/08/2010   RMC C0679 - make ship off cut stick over 2-days
      * ** 01/21/2010 RMC C476 option 2=Edit Schd - validate prod date ag
      *           sched ship date+1  so h/overs can be scheduled
      * ** 01/04/2010 LJB W288    For Seaboard Only:
      *     Add Access Limited flag to control the deadline departure
      *     date/time tests against warehouse control. This is used
      *     in Edit Load/Orders and Edit Scheduled Ship Date
      * ** 11/16/2009 LJB #193  Display order type-sales (OR or TR)
      * ** 09/30/2009 LJB E00495  Use Carr appt dt/tm to calc DDD/T, if e
      * ** 07/16/2009 RMC FP1054 display avail ship dates for each prod d
      * ** 06/09/2009 RMC FP1054 allow updates only if OD Plan Prod sts =
      * ** 05/26/2009 RMC FP1054 opt 22=Alloc first/last: for freezer CON
      * items only -- allow user to pick if inventory is to be alloc
      * first or last (after production). The Freezer default is FIRST,s/
      * ** 04/29/2009 RMC FP1054 removed message usr from screen line 1;
      *         added Non ProdWhse line in ctl section
      * ** 04/14/2009 RMC FP1054 opt 21=Override Freeze time
      * ** 04/09/2009 RMC FP1054 auto unlock load if 7 days from ship dat
      *   when doing an update option
      * ** 04/07/2009 RMC FP1054 use header/footer with 130 long cmd key
      * ** 01/20/2009 RMC FP1054 use production whse for righthand box of
      *   For Sched as Ord option: chk user profile field before allowing
      * Remove from screen: 16=Ship Off Cut  AND  18=Sched As Ord
      * Added to screen:   19=Deallocate
      * Added to subfile: If ord dtl sch rcd doesnt exist, sched ship dat
      *         production numbers are now output for all. they cant chg
      *         Chg Age Code to be cond on Output Only 3 usr. Sales can c
      *         And create load order change log rcd AGECDE
      *         If Release ord:  Crt load order change log rlsord
      *         If Dealloc ord:  Crt load order change log dlcord
      *         If Realloc ord:  Crt load order change log rlcord
      * Chg 14=Release to 14=Release Ln item option-- user can release li
      *  which will let them ship short.  the reallc process wont try to
      * *****
      * *****
      * ** 11/19/2008 RMC S00562 allow PORKSCHE2 to update
      * *****
      * ** 10/29/2008 RMC FP1054 display oe date/time and sales route in
      * *****
      * ** 11/19/2007 LJB FP1251 The DDD/T routine resets the DDD/T field
      * ** zeros if there is no Miles To Next Stop or Miles Between Citie
      * ** record
      * ** F90 & F91 are for IS personnel only (Not PORKSCHE)
      * *****
      * ** Just a note - The PFS Load Header for Carlisle gets the export
      * ** info from OHE not the Load Header
      * *****
      * ** 09/01/2006 LJB L60831A  Pass Co# & Whse code from the CTL
      * ** record to the Product Availability program
      * *****
      * 05/12/04 SLM PKTR01 Multi-Company - Order Header TRG Remove Co
      *                                     from Logical View
      * *****
      * E3796 JJH 02/18/15 - On call to "WW OrdPrdSch Upd Prod XF" change
      *  "I  Scheduled Ship Date   FLD   RCD Scheduled Ship Date" to
      *  "I  Scheduled Ship Date   FLD   RCD Requested Ship Date"
      * *****
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD15        ZHSTRW  40
     C                     Z-ADD23        ZHNDRW  40
     C           ZZSFM     IFEQ '0'
     C                     Z-ADD3         ZHRLEN  40
     C                     ELSE
     C                     Z-ADD1         ZHRLEN
     C                     ENDIF
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 003
     C           ZHCSCL    ANDEQ081
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CEXSX'  YPMTFD           Sel Value 1 USR
     C                     END
      *
     C           ZHCSRW    IFEQ 003
     C           ZHCSCL    ANDEQ090
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CE0SX'  YPMTFD           Sel Value 2 USR
     C                     END
      *
     C           ZHCSRW    IFEQ 003
     C           ZHCSCL    ANDEQ099
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CE1SX'  YPMTFD           Sel Value 3 USR
     C                     END
      *
     C           ZHCSRW    IFEQ 003
     C           ZHCSCL    ANDEQ108
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CLGSX'  YPMTFD           Sel Value 4 USR
     C                     END
      *
     C           ZHCSRW    IFEQ 003
     C           ZHCSCL    ANDEQ117
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CLHSX'  YPMTFD           Sel Value 5 USR
     C                     END
      *
     C           ZHCSRW    IFEQ 003
     C           ZHCSCL    ANDEQ126
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CMJSX'  YPMTFD           Sel Value 6 USR
     C                     END
      *
     C           ZHCSRW    IFEQ 014
     C           ZHCSCL    ANDEQ028
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CBCST'  YPMTFD           Block Order Fla
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2Z4ST           OD Schedule Ove
     C                     MOVEL*BLANK    P3DQCD           Enterprise Code
     C                     MOVEL*BLANK    P3DRCD           Enterprise Code
     C                     MOVEL*BLANK    P3BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P3B8NA           System Date For
     C                     MOVEL*BLANK    P3AJVN           User Profile Na
     C                     MOVEL*BLANK    P3I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P3I8ST           Allow Multi War
     C                     MOVEL*BLANK    P3MPNA           Default Printer
     C                     MOVEL*BLANK    P3TAST           First Time Flag
     C                     MOVEL*BLANK    P3ADTX           Name
     C                     MOVEL*BLANK    P3BXTX           System Value Al
     C                     MOVEL*BLANK    P3WVST           Access Denied (
     C                     Z-ADD*ZERO     P3EIDT           Requested Deliv
     C                     MOVEL*BLANK    P3ICL            *Initial call
     C                     MOVEL*BLANK    P3HHST           Access Limited
     C                     MOVEL*BLANK    P3O1ST           Live with TPM
     C                     MOVEL*BLANK    P4G3TX           PRT Description
     C                     MOVEL*BLANK    P4WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P4WSST           PRT Hold Output
     C                     MOVEL*BLANK    P4WTST           PRT Save Output
     C                     Z-ADD*ZERO     P4DYNB           PRT Number of C
     C                     MOVEL*BLANK    P4WUST           PRT Night Queue
     C                     MOVEL*BLANK    P4BVVN           PRT Night Queue
     C                     MOVEL*BLANK    P4BDSX           Hold On Jobq
     C                     MOVEL*BLANK    P4BESX           Job Log Create
     C                     MOVEL*BLANK    P4BCSX           Hold
     C                     MOVEL*BLANK    P4Y8CD           Log
     C                     MOVEL*BLANK    P4BMVN           Program name US
     C                     MOVEL*BLANK    P4BWVN           Program Name$ U
     C                     MOVEL*BLANK    P4DNCD           Application Cod
     C                     MOVEL*BLANK    P4XFST           Display Prt Opt
     C                     MOVEL*BLANK    P4T3CD           Warehouse Code
     C                     Z-ADD*ZERO     P6GGDT           Kill Date
     C                     Z-ADD*ZERO     P6JRDT           Kill Date CUR U
     C                     Z-ADD*ZERO     P6JQDT           Kill Date PRV U
     C                     Z-ADD*ZERO     P6WIDT           Kill Date 360 R
     C                     Z-ADD*ZERO     P6WJDT           Kill Date 360 R
     C                     Z-ADD*ZERO     P6MBDT           Date
     C                     Z-ADD*ZERO     P6WKDT           Kill Date 440 R
     C                     Z-ADD*ZERO     P6WLDT           Kill Date 440 R
     C                     Z-ADD*ZERO     P6WMDT           Kill Date 960 R
     C                     Z-ADD*ZERO     P6WNDT           Kill Date 960 R
     C                     Z-ADD*ZERO     P6ELDT           Production Date
     C                     Z-ADD*ZERO     P6WCDT           Production Date
     C                     Z-ADD*ZERO     P6WDDT           Production Date
     C                     Z-ADD*ZERO     P6WEDT           Production Date
     C                     Z-ADD*ZERO     P6WFDT           Production Date
     C                     Z-ADD*ZERO     P6WGDT           Production Date
     C                     Z-ADD*ZERO     P6WHDT           Production Date
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Conversion Factor 1
     C                     Z-ADD*ZERO     WUAWPC  94
      * Define work field Operation Factor 1
     C                     MOVEL*BLANK    WULXST  1
      * Define work field U/M - Second
     C                     MOVEL*BLANK    WUAECD  2
      * Define work field Conversion Factor 2
     C                     Z-ADD*ZERO     WUAXPC  94
      * Define work field Operation Factor 2
     C                     MOVEL*BLANK    WULYST  1
      * Define work field U/M - Third
     C                     MOVEL*BLANK    WUAFCD  2
      * Define work field U/M - Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Define work field Production Date Control
     C                     MOVEL*BLANK    WUFZST  1
      * Define work field Catch Weight Status
     C                     MOVEL*BLANK    WUAVST  1
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WACQNB           Julian Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEINB           Week Number
     C                     Z-ADD*ZERO     WAAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WAOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WANQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WANRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WAOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WAOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field *Duration (factor)
     C                     Z-ADD*ZERO     WUDUF   80
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDL8VA           Billing Detail
     C                     Z-ADD*ZERO     WDL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WDATWG           Weight Shipped
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WDNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WDNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WDNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WDNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WDBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WDBVTM           Price Code
     C                     Z-ADD*ZERO     WDBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WDBXTM           Substitution Li
     C                     Z-ADD*ZERO     WDBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WDH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WDH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WDH7NX           OD Item Target
     C                     Z-ADD*ZERO     WDH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WDH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WDDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WDDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WDDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WDDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WDDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WDGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WDGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WDGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WDPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WDRINY           Item Age Days
     C                     Z-ADD*ZERO     WDTIDT           Production Ovr
     C                     Z-ADD*ZERO     WDTJDT           Production Ovr
     C                     Z-ADD*ZERO     WDTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WDTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WDTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field USR Check Y/N Status
     C                     MOVEL*BLANK    WUJDST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WFA0DT           Order Date
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFACDT           Cancel Date
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WFA1WG           Order Weight To
     C                     Z-ADD*ZERO     WFEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WFAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WFATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WFRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WFT3NB           Attach to Order
     C                     Z-ADD*ZERO     WFCONB           Invoice Number
     C                     Z-ADD*ZERO     WFAWDT           Invoice Date
     C                     Z-ADD*ZERO     WFVRVA           A/R order Value
     C                     Z-ADD*ZERO     WFB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WFNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WFNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WFNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WFNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WFNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WFBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WFBQTM           Time of Origina
     C                     Z-ADD*ZERO     WFBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WFBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WFBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WFH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WFH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WFH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WFH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WFH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WFC0C7           Claim Number
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WGBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WGBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WGBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WGBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Unlock Load Authority
     C                     MOVEL*BLANK    WUHTST  1
      * Define work field Pick Status USR
     C                     MOVEL*BLANK    WUZMST  1
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHRMNB           Load ID
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WHRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WHRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WHFLAM           Flat Amount
     C                     Z-ADD*ZERO     WHRRNB           Total Stops
     C                     Z-ADD*ZERO     WHSBNB           BOL Time
     C                     Z-ADD*ZERO     WHSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WHR1NB           Rated Freight
     C                     Z-ADD*ZERO     WHSDNB           Number Pallets
     C                     Z-ADD*ZERO     WHPAOU           Number Pallets
     C                     Z-ADD*ZERO     WHDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WHSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WHHADT           Actual Arrival
     C                     Z-ADD*ZERO     WHAART           Actual Arrival
     C                     Z-ADD*ZERO     WHDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WHDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WHAQDT           Actual Departur
     C                     Z-ADD*ZERO     WHS6NB           Departure Time
     C                     Z-ADD*ZERO     WHT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WHPRTM           Product Tempera
     C                     Z-ADD*ZERO     WHNPSV           Number Spacers
     C                     Z-ADD*ZERO     WHTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WHGRWE           Gross Weight
     C                     Z-ADD*ZERO     WHF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WHJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WHTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WHJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WHSPTM           Spotted Time
     C                     Z-ADD*ZERO     WHJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WHLFTM           Load Finished T
     C                     Z-ADD*ZERO     WHJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WHBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WHJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WHBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WHKIDT           Truck Departure
     C                     Z-ADD*ZERO     WHASTM           Truck Departure
     C                     Z-ADD*ZERO     WHKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WHAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WHVOAG           Voyage
     C                     Z-ADD*ZERO     WHKBDT           Sail Date
     C                     Z-ADD*ZERO     WHEFDT           Arrival Date
     C                     Z-ADD*ZERO     WHKCDT           Date In
     C                     Z-ADD*ZERO     WHTMIN           Time In
     C                     Z-ADD*ZERO     WHKDDT           Date Out
     C                     Z-ADD*ZERO     WHVMNB           Time Out
     C                     Z-ADD*ZERO     WHOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WHKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WHATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WHBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WHEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WHKKDT           On Yard Date
     C                     Z-ADD*ZERO     WHAVTM           On Yard Time
     C                     Z-ADD*ZERO     WHKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WHAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WHLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WHK0DT           Product Complet
     C                     Z-ADD*ZERO     WHAYTM           Product Complet
     C                     Z-ADD*ZERO     WHKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WHICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WHIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WHK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WHAZTM           Load Door 1
     C                     Z-ADD*ZERO     WHK2DT           Override Total
     C                     Z-ADD*ZERO     WHA0TM           Load Door 2
     C                     Z-ADD*ZERO     WHZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WHPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WHCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WHPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WHCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WHP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WHCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WHP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WHCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WHP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WHCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WHP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WHCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Warehouse Description
     C                     MOVEL*BLANK    WUF8NA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIRMNB           Load ID
     C                     Z-ADD*ZERO     WIRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WIRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WIRWNB           Miles to next s
     C                     Z-ADD*ZERO     WIRXNB           Freight Charge
     C                     Z-ADD*ZERO     WISQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WIT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WIT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WIR1NB           Rated Freight
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WISXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WIKFDT           Appointment Con
     C                     Z-ADD*ZERO     WIACTM           Appointment Con
     C                     Z-ADD*ZERO     WIEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WIAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WIKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WIATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WIHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WIAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WIKKDT           On Yard Date
     C                     Z-ADD*ZERO     WIAVTM           On Yard Time
     C                     Z-ADD*ZERO     WIZ4NB           MPC Number
     C                     Z-ADD*ZERO     WIN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WIN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WIN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WIB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WIB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WIB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field USR Adjustment Amount 1
     C                     Z-ADD*ZERO     WUICVA 112
      * Define work field Load Change Type
     C                     MOVEL*BLANK    WURVST  6
      * Define work field Department Control Code
     C                     MOVEL*BLANK    WUUJST  3
      * Define work field Name
     C                     MOVEL*BLANK    WUADTX 30
      * Define work field Generic Heading
     C                     MOVEL*BLANK    WUNATX  8
      * Define work field Process Control
     C                     MOVEL*BLANK    WUPRCT  1
      * Define work field Unused Parm - Value   USR
     C                     Z-ADD*ZERO     WUB5VL 112
      * Define work field Order Weight Total
     C                     Z-ADD*ZERO     WUA1WG 112
      * Define work field Item Code Txt
     C                     MOVEL*BLANK    WUFYTX  7
      * Define work field Live with TPM
     C                     MOVEL*BLANK    WUO1ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field User Code Model
     C                     MOVEL*BLANK    WUBUVN 10
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WJ02 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ03 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WJ04 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA03 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WE   179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004 30
     C                     MOVEL*BLANK    WL0005  2
     C                     Z-ADD*ZERO     WL0006  94
     C                     MOVEL*BLANK    WL0007  1
     C                     MOVEL*BLANK    WL0008  2
     C                     Z-ADD*ZERO     WL0009  94
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  2
     C                     MOVEL*BLANK    WL0012  2
     C                     Z-ADD*ZERO     WL0013 112
     C                     MOVEL*BLANK    WL0014  1
     C                     MOVEL*BLANK    WL0015  1
     C                     Z-ADD*ZERO     WL0016  52
     C                     MOVEL*BLANK    WL0017  2
     C                     MOVEL*BLANK    WL0018  1
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  70
     C                     MOVEL*BLANK    WL0021  1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0022  30
     C                     Z-ADD*ZERO     WL0023  70
     C                     MOVEL*BLANK    WL0024  3
     C                     Z-ADD*ZERO     WL0025  70
     C                     Z-ADD*ZERO     WL0026  70
     C                     Z-ADD*ZERO     WL0027  70
     C                     Z-ADD*ZERO     WL0028  70
     C                     Z-ADD*ZERO     WL0029  70
     C                     Z-ADD*ZERO     WL0030  70
     C                     Z-ADD*ZERO     WL0031  70
     C                     Z-ADD*ZERO     WL0032  50
     C                     Z-ADD*ZERO     WL0033  50
     C                     Z-ADD*ZERO     WL0034  50
     C                     Z-ADD*ZERO     WL0035  50
     C                     Z-ADD*ZERO     WL0036  50
     C                     Z-ADD*ZERO     WL0037  50
     C                     Z-ADD*ZERO     WL0038  50
     C                     Z-ADD*ZERO     WL0039  50
     C                     Z-ADD*ZERO     WL0040  50
     C                     Z-ADD*ZERO     WL0041  50
     C                     Z-ADD*ZERO     WL0042  50
     C                     Z-ADD*ZERO     WL0043  50
     C                     Z-ADD*ZERO     WL0044  50
     C                     Z-ADD*ZERO     WL0045  50
     C                     Z-ADD*ZERO     WL0046  50
     C                     Z-ADD*ZERO     WL0047  50
     C                     Z-ADD*ZERO     WL0048  50
     C                     Z-ADD*ZERO     WL0049  50
     C                     Z-ADD*ZERO     WL0050  50
     C                     Z-ADD*ZERO     WL0051  50
     C                     Z-ADD*ZERO     WL0052  50
     C                     Z-ADD*ZERO     WL0053  50
     C                     Z-ADD*ZERO     WL0054  50
     C                     Z-ADD*ZERO     WL0055  50
     C                     Z-ADD*ZERO     WL0056  50
     C                     Z-ADD*ZERO     WL0057  50
     C                     Z-ADD*ZERO     WL0058  50
     C                     Z-ADD*ZERO     WL0059  50
     C                     Z-ADD*ZERO     WL0060  50
     C                     Z-ADD*ZERO     WL0061  50
     C                     Z-ADD*ZERO     WL0062  50
     C                     Z-ADD*ZERO     WL0063  50
     C                     Z-ADD*ZERO     WL0064  50
     C                     Z-ADD*ZERO     WL0065  50
     C                     Z-ADD*ZERO     WL0066  50
     C                     Z-ADD*ZERO     WL0067  50
     C                     Z-ADD*ZERO     WL0068  50
     C                     Z-ADD*ZERO     WL0069 112
     C                     MOVEL*BLANK    WL0070  1
     C                     Z-ADD*ZERO     WL0071  70
     C                     Z-ADD*ZERO     WL0072  70
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0073  3
     C                     MOVEL*BLANK    WL0074  2
     C                     MOVEL*BLANK    WL0075  1
     C                     Z-ADD*ZERO     WL0076  52
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0077  30
     C                     Z-ADD*ZERO     WL0078  70
     C                     Z-ADD*ZERO     WL0079  52
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0080  30
     C                     Z-ADD*ZERO     WL0081  70
     C                     MOVEL*BLANK    WL0082  3
     C                     Z-ADD*ZERO     WL0083  70
     C                     MOVEL*BLANK    WL0084  1
     C                     MOVEL*BLANK    WL0085  1
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0086  70
     C                     MOVEL*BLANK    WL0087  1
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0088  30
     C                     Z-ADD*ZERO     WL0089  70
     C                     Z-ADD*ZERO     WL0090  70
     C                     Z-ADD*ZERO     WL0091  70
     C                     Z-ADD*ZERO     WL0092  80
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0093  30
     C                     Z-ADD*ZERO     WL0094  70
     C                     Z-ADD*ZERO     WL0095  70
     C                     Z-ADD*ZERO     WL0096  70
     C                     Z-ADD*ZERO     WL0097  80
      * Define local variables for subroutine SXRVGN.
     C                     Z-ADD*ZERO     WL0098  30
     C                     Z-ADD*ZERO     WL0099  70
     C                     Z-ADD*ZERO     WL0100  30
     C                     Z-ADD*ZERO     WL0101  30
     C                     MOVEL*BLANK    WL0102  3
     C                     MOVEL*BLANK    WL0103  1
     C                     Z-ADD*ZERO     WL0104 112
     C                     Z-ADD*ZERO     WL0105 112
     C                     MOVEL*BLANK    WL0106  1
     C                     MOVEL*BLANK    WL0107  1
     C                     Z-ADD*ZERO     WL0108  40
     C                     Z-ADD*ZERO     WL0109  70
     C                     Z-ADD*ZERO     WL0110  70
      * Define local variables for subroutine SYRVGN.
     C                     Z-ADD*ZERO     WL0111  30
     C                     Z-ADD*ZERO     WL0112  70
     C                     MOVEL*BLANK    WL0113  1
     C                     MOVEL*BLANK    WL0114  1
     C                     Z-ADD*ZERO     WL0115  70
      * Define local variables for subroutine SZRVGN.
     C                     Z-ADD*ZERO     WL0116  70
     C                     MOVEL*BLANK    WL0117  1
      * Define local variables for subroutine TARVGN.
     C                     Z-ADD*ZERO     WL0118  70
     C                     MOVEL*BLANK    WL0119  1
     C                     MOVEL*BLANK    WL0120  1
      * Define local variables for subroutine TBRVGN.
     C                     MOVEL*BLANK    WL0121 10
     C                     MOVEL*BLANK    WL0122  1
     C                     MOVEL*BLANK    WL0123 10
     C                     MOVEL*BLANK    WL0124  3
     C                     Z-ADD*ZERO     WL0125  30
     C                     MOVEL*BLANK    WL0126 10
      * Define local variables for subroutine TCRVGN.
     C                     MOVEL*BLANK    WL0127 10
     C                     MOVEL*BLANK    WL0128  6
     C                     Z-ADD*ZERO     WL0129  30
     C                     MOVEL*BLANK    WL0130  3
      * Define local variables for subroutine TDRVGN.
     C                     MOVEL*BLANK    WL0131  3
     C                     Z-ADD*ZERO     WL0132  30
      * Define local variables for subroutine TERVGN.
     C                     Z-ADD*ZERO     WL0133  30
     C                     MOVEL*BLANK    WL0134 30
      * Define local variables for subroutine TFRVGN.
     C                     MOVEL*BLANK    WL0135 10
     C                     MOVEL*BLANK    WL0136  6
     C                     Z-ADD*ZERO     WL0137  30
     C                     MOVEL*BLANK    WL0138  1
      * Define local variables for subroutine TGCHRC.
     C                     Z-ADD*ZERO     WL0139  70
     C                     MOVEL*BLANK    WL0140  1
     C                     Z-ADD*ZERO     WL0141 112
      * Define local variables for subroutine THRVGN.
     C                     Z-ADD*ZERO     WL0142  70
     C                     MOVEL*BLANK    WL0143  1
      * Define local variables for subroutine TLRVGN.
     C                     MOVEL*BLANK    WL0144 10
     C                     MOVEL*BLANK    WL0145 40
      * Define local variables for subroutine TMRVGN.
     C                     Z-ADD*ZERO     WL0146  30
     C                     MOVEL*BLANK    WL0147  6
     C                     MOVEL*BLANK    WL0148  1
     C                     MOVEL*BLANK    WL0149  1
      * Define local variables for subroutine TNRVGN.
     C                     Z-ADD*ZERO     WL0150  70
     C                     Z-ADD*ZERO     WL0151  50
      * Define local variables for subroutine TSCHRC.
     C                     Z-ADD*ZERO     WL0152  30
     C                     Z-ADD*ZERO     WL0153  70
     C                     Z-ADD*ZERO     WL0154  30
     C                     Z-ADD*ZERO     WL0155  30
     C                     Z-ADD*ZERO     WL0156 112
      * Define local variables for subroutine TTCHRC.
     C                     Z-ADD*ZERO     WL0157  30
     C                     Z-ADD*ZERO     WL0158  70
     C                     MOVEL*BLANK    WL0159  1
      * Define local variables for subroutine TUCHRC.
     C                     Z-ADD*ZERO     WL0160  30
     C                     Z-ADD*ZERO     WL0161  70
     C                     Z-ADD*ZERO     WL0162  30
     C                     Z-ADD*ZERO     WL0163  30
     C                     Z-ADD*ZERO     WL0164 112
     C                     Z-ADD*ZERO     WL0165 112
      * Define local variables for subroutine TVCHRC.
     C                     Z-ADD*ZERO     WL0166  30
     C                     Z-ADD*ZERO     WL0167  70
     C                     Z-ADD*ZERO     WL0168  30
     C                     Z-ADD*ZERO     WL0169  30
     C                     MOVEL*BLANK    WL0170  1
      * Define local variables for subroutine TWCHRC.
     C                     Z-ADD*ZERO     WL0171  30
     C                     Z-ADD*ZERO     WL0172  70
     C                     Z-ADD*ZERO     WL0173  30
     C                     Z-ADD*ZERO     WL0174  30
     C                     MOVEL*BLANK    WL0175  1
      * Define local variables for subroutine TXCHRC.
     C                     Z-ADD*ZERO     WL0176  30
     C                     Z-ADD*ZERO     WL0177  70
     C                     Z-ADD*ZERO     WL0178  30
     C                     Z-ADD*ZERO     WL0179  30
     C                     MOVEL*BLANK    WL0180  1
      * Define local variables for subroutine TYCHRC.
     C                     Z-ADD*ZERO     WL0181  30
     C                     Z-ADD*ZERO     WL0182  70
     C                     MOVEL*BLANK    WL0183  2
      * Define local variables for subroutine TZCHRC.
     C                     Z-ADD*ZERO     WL0184  30
     C                     Z-ADD*ZERO     WL0185  70
     C                     Z-ADD*ZERO     WL0186  30
     C                     Z-ADD*ZERO     WL0187  30
     C                     MOVEL*BLANK    WL0188  3
      * Define local variables for subroutine NACHRC.
     C                     Z-ADD*ZERO     WL0189  30
     C                     Z-ADD*ZERO     WL0190  70
     C                     MOVEL*BLANK    WL0191  3
     C                     MOVEL*BLANK    WL0192  1
     C                     MOVEL*BLANK    WL0193  1
     C                     MOVEL*BLANK    WL0194  1
      * Define local work field Production Date USR
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0003 112
      * Define local work field Piece Count Item
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Pieces Per Bag
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Bags Per Unit
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Select 1 or 2
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Hold Order
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field USR Display 1
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0010 112
      * Define local work field Piece Count Item
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Pieces Per Bag
     C                     Z-ADD*ZERO     YL0012  70
      * Define local work field Bags Per Unit
     C                     Z-ADD*ZERO     YL0013  70
      * Define local work field Day 1 Inventory 5,0   USR
     C                     Z-ADD*ZERO     YL0014  50
      * Define local work field Quantity Standard USR
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Quantity Planned USR
     C                     Z-ADD*ZERO     YL0016  70
      * Define local work field Quantity Sched Whs Tx USR
     C                     Z-ADD*ZERO     YL0017  70
      * Define local work field Quantity Converted USR
     C                     Z-ADD*ZERO     YL0018  70
      * Define local work field Qty Ordered USR
     C                     Z-ADD*ZERO     YL0019  70
      * Define local work field Quantity Production USR
     C                     Z-ADD*ZERO     YL0020  61
      * Define local work field Quantity Avail  7.0  USR
     C                     Z-ADD*ZERO     YL0021  70
      * Define local work field ZERO
     C                     Z-ADD*ZERO     YL0022 305
      * Define local work field BLANK
     C                     MOVEL*BLANK    YL0023256
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0024  2
      * Define local work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YL0026  52
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0027  52
      * Define local work field Chilling Time USR
     C                     Z-ADD*ZERO     YL0028  52
      * Define local work field USR Day 7
     C                     Z-ADD*ZERO     YL0029  70
      * Define local work field USR Day 8
     C                     Z-ADD*ZERO     YL0030  70
      * Define local work field Avail Ship Date 7 USR
     C                     Z-ADD*ZERO     YL0031  70
      * Define local work field Avail Ship Date 8 USR
     C                     Z-ADD*ZERO     YL0032  70
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0033  70
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0034  1
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field Sel Value 1 USR
     C                     MOVEL*BLANK    YL0036  1
      * Define local work field Sel Value 2 USR
     C                     MOVEL*BLANK    YL0037  1
      * Define local work field Sel Value 3 USR
     C                     MOVEL*BLANK    YL0038  1
      * Define local work field Sel Value 4 USR
     C                     MOVEL*BLANK    YL0039  1
      * Define local work field Sel Value 5 USR
     C                     MOVEL*BLANK    YL0040  1
      * Define local work field Sel Value 6 USR
     C                     MOVEL*BLANK    YL0041  1
      * Define local work field Status Flag 17 Y/N
     C                     MOVEL*BLANK    YL0042  1
      * Define local work field *Duration (factor)
     C                     Z-ADD*ZERO     YL0043  80
      * Define null work field Ship To Customer
     C                     Z-ADD*ZERO     YN0001  70
      * Define local work field Deadline Departure Date
     C                     Z-ADD*ZERO     YL0044  70
      * Define local work field Deadline Departure Time
     C                     Z-ADD*ZERO     YL0045  60
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0046  70
      * Define local work field Deadline Depart Date
     C                     Z-ADD*ZERO     YL0047  70
      * Define local work field Date From             USR
     C                     Z-ADD*ZERO     YL0048  70
      * Define local work field Chill Time USR
     C                     Z-ADD*ZERO     YL0049  30
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0050  70
      * Define local work field User Code Model
     C                     MOVEL*BLANK    YL0051 10
      * Define local work field User Approval USR
     C                     MOVEL*BLANK    YL0052  1
      * Define local work field Error Status
     C                     MOVEL*BLANK    YL0053  1
      * Define local work field Production Type
     C                     MOVEL*BLANK    YL0054  1
      * Define local work field Post Flag USR
     C                     MOVEL*BLANK    YL0055  1
      * Define local work field *Reload subfile
     C                     MOVEL*BLANK    YL0056  1
      * Define local work field Order Sequence Number
     C                     Z-ADD*ZERO     YL0057  30
      * Define local work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     YL0058  30
      * Define local work field Application Code
     C                     MOVEL*BLANK    YL0059  6
      * Define local work field *Initial call
     C                     MOVEL*BLANK    YL0060  1
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0061  1
      * Define local work field Conversion Factor 1
     C                     Z-ADD*ZERO     YL0062  94
      * Define local work field Operation Factor 1
     C                     MOVEL*BLANK    YL0063  1
      * Define local work field U/M - Second
     C                     MOVEL*BLANK    YL0064  2
      * Define local work field Conversion Factor 2
     C                     Z-ADD*ZERO     YL0065  94
      * Define local work field Operation Factor 2
     C                     MOVEL*BLANK    YL0066  1
      * Define local work field U/M - Third
     C                     MOVEL*BLANK    YL0067  2
      * Define local work field Warehouse Description
     C                     MOVEL*BLANK    YL0068 30
      * Define local work field Company Name
     C                     MOVEL*BLANK    YL0069 30
      * Define local work field USR Weight Accumulated
     C                     Z-ADD*ZERO     YL0070 112
      * Define local work field Warehouse Code SavUsr
     C                     MOVEL*BLANK    YL0071  3
      * Define local work field OD Production Plan Sts
     C                     MOVEL*BLANK    YL0072  1
      * Define local work field Quantity Scheduled 1 USR
     C                     Z-ADD*ZERO     YL0073  70
      * Define local work field Weight Scheduled USR
     C                     Z-ADD*ZERO     YL0074 112
      * Define local work field OD Schedule Override Sts
     C                     MOVEL*BLANK    YL0075  1
      * Define local work field OD Adj Type Override
     C                     MOVEL*BLANK    YL0076  1
      * Define local work field Item Age Days
     C                     Z-ADD*ZERO     YL0077  40
      * Define local work field Production Ovr AgeDte Fr
     C                     Z-ADD*ZERO     YL0078  70
      * Define local work field Production Ovr AgeDte To
     C                     Z-ADD*ZERO     YL0079  70
      * Define local work field Order in Use
     C                     MOVEL*BLANK    YL0080  1
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0081  1
      * Define local work field Job Date Usr
     C                     Z-ADD*ZERO     YL0082  70
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0083  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0084  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0085  30
      * Define local work field Plant Floor System USR
     C                     MOVEL*BLANK    YL0086  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0087  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0088  1
      * Define local work field Scheduled Ship Date Alpha
     C                     MOVEL*BLANK    YL0089  7
      * Define local work field Scheduled Ship Date YY
     C                     MOVEL*BLANK    YL0090  2
      * Define local work field Scheduled Ship Date MMDD
     C                     MOVEL*BLANK    YL0091  4
      * Define local work field Scheduled Ship Date Fmt
     C                     MOVEL*BLANK    YL0092  8
      * Define local work field Last Allocation Date
     C                     Z-ADD*ZERO     YL0093  70
      * Define local work field Last Allocation DateAlpha
     C                     MOVEL*BLANK    YL0094  7
      * Define local work field Last Allocation Date YY
     C                     MOVEL*BLANK    YL0095  2
      * Define local work field Last Allocation Date MMDD
     C                     MOVEL*BLANK    YL0096  4
      * Define local work field Last Allocation Date Fmt
     C                     MOVEL*BLANK    YL0097  8
      * Define local work field Quantity Ordered
     C                     Z-ADD*ZERO     YL0098 112
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0099 112
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0100 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0101 112
      * Define local work field Item age days usr
     C                     Z-ADD*ZERO     YL0102  40
      * Define local work field Prod Ovr AgeDte Fr Usr
     C                     Z-ADD*ZERO     YL0103  70
      * Define local work field Prod Ovr AgeDte To Usr
     C                     Z-ADD*ZERO     YL0104  70
      * Define local work field Header Status Last
     C                     MOVEL*BLANK    YL0105  1
      * Define local work field USR Production Hold
     C                     MOVEL*BLANK    YL0106  1
      * Define local work field Allocation Method
     C                     MOVEL*BLANK    YL0107  1
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0108  70
      * Define local work field Date                  USR
     C                     Z-ADD*ZERO     YL0109  70
      * Define local work field Generic Message 80 USR
     C                     MOVEL*BLANK    YL0110 80
      * Define local work field Scheduled Ship Date USR
     C                     Z-ADD*ZERO     YL0111  70
      * Define local work field Production Date
     C                     Z-ADD*ZERO     YL0112  70
      * Define local work field ATS Adj Type USR
     C                     MOVEL*BLANK    YL0113  2
      * Define local work field USR Production
     C                     MOVEL*BLANK    YL0114  1
      * Define local work field Header Status Last
     C                     MOVEL*BLANK    YL0115  1
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0116  1
      * Define local work field Display Flag
     C                     MOVEL*BLANK    YL0117  1
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0118  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0119  30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0120  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0121  3
      * Define local work field User Profile Code
     C                     MOVEL*BLANK    YL0122 10
      * Define local work field CMDKEY Line 1 130 Char
     C                     MOVEL*BLANK    YL0123130
      * Define local work field CMDKEY Line 2 130 Char
     C                     MOVEL*BLANK    YL0124130
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD09        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * ***** PA PROCESS - USE REQUESTED SHIP DATE FOR Ship Date USR ****
      * ***** Change Log and Comments
     C                     EXSR UGSUBR                     ***** Change Lo
     C                     MOVEL'Y'       YL0002           First Time Flag
      *
     C                     MOVEL*BLANK    WN1621 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN1621           User Profile Na
      *
     C                     MOVEL*BLANK    WN1622 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1621    WL0121    P      User Profile Na
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0122    P3I6ST    P      Allow Multi-Com
     C                     MOVELWL0123    P3MPNA    P      Default Printer
     C                     MOVELWL0124    P3BCCD    P      Salesperson Cod
     C                     Z-ADDWL0125    YL0120           Company Number
     C                     MOVELWL0126    WN1622    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,004                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN1621    ZA0197           User Profile Na
     C                     MOVEL'OMS'     ZA0198           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN1622    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1621    WL0127    P      User Profile Na
     C                     MOVEL'OMS'     WL0128    P      Application Cod
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0129    YL0119           Company Number
     C                     MOVELWL0130    YL0121    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1622    WL0127    P      User Profile Na
     C                     MOVEL'OMS'     WL0128    P      Application Cod
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0129    YL0119           Company Number
     C                     MOVELWL0130    YL0121    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0121    YL0118           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN1621    ZA0199           User Profile Na
     C                     MOVEL'OMS'     ZA0200           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0120    IFNE 0                          *IF
     C                     Z-ADDYL0120    YL0119           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0121    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           YL0118    PARM *BLANK    WQ0902  3        Warehouse Code
     C                     PARM YL0120    WQ0903  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR NIRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Rtv Profile Model     RT - User Profile Control  * 
     C                     EXSR NKRVGN
     C                     MOVEL##USR     YL0122           User Profile Co
      * 11/02/09 PKD Allow Sched as Order -renamed to App WHS Restrict
     C                     MOVEL'N'       YL0117           Display Flag
     C                     MOVELYL0051    WUBUVN           User Code Model
      * User Code Model
      * CASE:
      *  - c1ORc2
      *   |- c1    : JOB.*USER is Rose - God
      *   |- c2    : JOB.*USER is Purva Droge
      *   '-
     C           ##USR     IFEQ @CN,010                    *IF
     C           ##USR     OREQ @CN,011                    *OR
     C                     MOVEL*BLANK    YL0051           User Code Model
     C                     MOVEL'PORKSCHE'YL0051           User Code Model
     C                     END                             *FI
      * User Code Model
      * CASE:
      *  - c1 OR c3 OR c2 OR c4 OR c5 OR c6 ORc7
      *   |- c1    : LCL.User Code Model is Production Scheduling
      *   |- c3    : LCL.User Code Model is Production Sched 2
      *   |- c2    : LCL.User Code Model is IS
      *   |- c4    : LCL.User Code Model is Transportation 3
      *   |- c5    : LCL.User Code Model is TF Prod Scheduling
      *   |- c6    : LCL.User Code Model is Production Sched 5
      *   |- c7    : LCL.User Code Model is STF Prod Scheduling
      *   '-
     C           YL0051    IFEQ @CN,012                    *IF
     C           YL0051    OREQ @CN,013                    *OR
     C           YL0051    OREQ @CN,014                    *OR
     C           YL0051    OREQ @CN,015                    *OR
     C           YL0051    OREQ @CN,016                    *OR
     C           YL0051    OREQ @CN,017                    *OR
     C           YL0051    OREQ @CN,018                    *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0051           User Code Model
     C                     END                             *FI
      * CASE: LCL.User Code Model is equal to blank
     C           YL0051    IFEQ *BLANK                     *IF
      * Ext Verify User Auth  XF - User Authority  * 
     C                     CALL 'PUAYXFR'              90  Ext Verify User
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0122    WQ0904 10        User Profile Na
     C                     PARM 'SO'      WQ0905  2        Approval Type
     C           YL0052    PARM *BLANK    WQ0906  1        User Approval U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUAYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0117           Display Flag
     C                     END                             *FI
      * CASE: LCL.User Approval USR is Yes
     C           YL0052    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0117           Display Flag
     C                     END                             *FI
     C                     MOVEL'*YES'    P4XFST           Display Prt Opt
      * ** Set Access Limited for Edit Load/Orders & Edit SSD/Whse  W288
     C                     MOVEL'Y'       P3HHST           Access Limited
     C                     Z-ADD*ZERO     YL0050           Item Code
     C                     Z-ADD##JDT     YL0112           Production Date
     C                     MOVEL'1'       ZZSFM            *Subfile mode
      * Format Command Key Text
      * Setup message data for message
      * Retrieve message RTV WW Ord Prd Sch cmd 1
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR4138' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0123    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message
      * Retrieve message RTV WW Ord Prd Sch cmd 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR4139' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0124    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Screen 132 Wide 2 CMDLN - *Standard header/footer  * 
     C                     MOVELYL0123    ##VIT1
     C                     MOVELYL0124    ##VJT1
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** @CN
00001 CONVERTED
00002 ALLOCDAYS
00003 USR0752
00004 Y2U0005
00005 PLTFLRSYS
00006 Opt not allowed. Item is
00007 in Suspended Inventory.
00008 SHPOFFCUT
00009 Released
00010 ISROSEM
00011 ISPURVAP
00012 PORKSCHE
00013 PORKSCHE2
00014 ISBGUTI
00015 PORKTRAF3
00016 TFMODSCHE
00017 PORKSCHE5
00018 SPMODSCHE
