     H/TITLE Exc Post Whse Prices  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 04/17/24  Time  : 12:00:59
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FPPBSCPL1IF  E           K        DISK
      * RTV : Inventory Stock Closing   Retrieval index
      *
     FOMHSTPN9IF  E           K        DISK
      * RSQ : Sales History             ActShipDt/ShipItem/Whse
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FPPBSCPL2IF  E           K        DISK
      * RSQ : Inventory Stock Closing   Grp/WEDt/WhsCo/Whs/I S F
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse Codes           ShipCo/Warehouse
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPPBSCPL0UF  E           K        DISK                      A
      * UPD : Inventory Stock Closing   Update index
      *
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          WAAIC3
     I              AFBCDT                          WABCDT
     I              AFCQNB                          WACQNB
     I              AFESNB                          WAESNB
     I              AFETNB                          WAETNB
     I              AFBZNB                          WABZNB
     I              AFA9ST                          WAA9ST
     I              AFEINB                          WAEINB
     I              AFC5ST                          WAC5ST
     I              AFAQNB                          WAAQNB
     I              AFCMST                          WACMST
     I              AFV9ST                          WAV9ST
     I              AFWAST                          WAWAST
     I              AFX2ST                          WAX2ST
     I              AFOJDT                          WAOJDT
     I              AFNQNX                          WANQNX
     I              AFNRNX                          WANRNX
     I              AFI9SX                          WAI9SX
     I              AFJASX                          WAJASX
     I              AFOKDT                          WAOKDT
     I              AFOLDT                          WAOLDT
     I              AFUVST                          WAUVST
     I              AFUWST                          WAUWST
     I              AFUXST                          WAUXST
     I              AFAATM                          WAAATM
     I              AFAYNA                          WAAYNA
     I              AFA0NA                          WAA0NA
     I              AFAXDT                          WAAXDT
      *
     I@BSCPA6
      * Inventory Stock Closing   Retrieval index
      * Renamed input format fields
     I              BSAIDX                          WBAIDX
     I              BSB2C3                          WBB2C3
     I              BSGRAA                          WBGRAA
     I              BSEJC7                          WBEJC7
     I              BSV8SX                          WBV8SX
     I              BSGPAA                          WBGPAA
     I              BSGQAA                          WBGQAA
     I              BSW1SX                          WBW1SX
     I              BSF3PR                          WBF3PR
     I              BSBSNY                          WBBSNY
     I              BSBTNY                          WBBTNY
     I              BSBUNY                          WBBUNY
     I              BSGSAA                          WBGSAA
     I              BSGTAA                          WBGTAA
     I              BSOEQT                          WBOEQT
     I              BSMQWG                          WBMQWG
     I              BSOFQT                          WBOFQT
     I              BSMRWG                          WBMRWG
     I              BSOGQT                          WBOGQT
     I              BSMXWG                          WBMXWG
     I              BSOHQT                          WBOHQT
     I              BSMSWG                          WBMSWG
     I              BSOWQT                          WBOWQT
     I              BSNAWG                          WBNAWG
     I              BSOIQT                          WBOIQT
     I              BSMTWG                          WBMTWG
     I              BSOJQT                          WBOJQT
     I              BSMUWG                          WBMUWG
     I              BSOKQT                          WBOKQT
     I              BSMVWG                          WBMVWG
     I              BSOLQT                          WBOLQT
     I              BSMWWG                          WBMWWG
     I              BSFQVL                          WBFQVL
     I              BSOMQT                          WBOMQT
     I              BSMYWG                          WBMYWG
     I              BSONQT                          WBONQT
     I              BSMZWG                          WBMZWG
     I              BSOOQT                          WBOOQT
     I              BSM0WG                          WBM0WG
     I              BSDGVN                          WBDGVN
     I              BSP9DT                          WBP9DT
     I              BSCTTM                          WBCTTM
     I              BSOPQT                          WBOPQT
     I              BSM1WG                          WBM1WG
     I              BSOQQT                          WBOQQT
     I              BSM2WG                          WBM2WG
     I              BSORQT                          WBORQT
     I              BSM3WG                          WBM3WG
     I              BSOSQT                          WBOSQT
     I              BSM4WG                          WBM4WG
     I              BSRCNA                          WBRCNA
     I              BSDFVN                          WBDFVN
     I              BSP8DT                          WBP8DT
     I              BSCSTM                          WBCSTM
     I              BSOTQT                          WBOTQT
     I              BSM5WG                          WBM5WG
     I              BSF4PR                          WBF4PR
     I              BSWBSX                          WBWBSX
     I              BSWNSX                          WBWNSX
     I              BSWOSX                          WBWOSX
     I              BSOUQT                          WBOUQT
     I              BSM6WG                          WBM6WG
     I              BSOVQT                          WBOVQT
     I              BSM7WG                          WBM7WG
     I              BSWCSX                          WBWCSX
     I              BSQADT                          WBQADT
     I              BSWDSX                          WBWDSX
     I              BSVSST                          WBVSST
     I              BSMJDT                          WBMJDT
     I              BSBETM                          WBBETM
     I              BSCCVN                          WBCCVN
     I              BSCDVN                          WBCDVN
     I              BSMKDT                          WBMKDT
     I              BSBFTM                          WBBFTM
     I              BSCEVN                          WBCEVN
     I              BSCFVN                          WBCFVN
      *
     I@BSCPA5
      * Inventory Stock Closing   Update index
      * Renamed input format fields
     I              BSAIDX                          WCAIDX
     I              BSB2C3                          WCB2C3
     I              BSGRAA                          WCGRAA
     I              BSEJC7                          WCEJC7
     I              BSV8SX                          WCV8SX
     I              BSGPAA                          WCGPAA
     I              BSGQAA                          WCGQAA
     I              BSW1SX                          WCW1SX
     I              BSF3PR                          WCF3PR
     I              BSBSNY                          WCBSNY
     I              BSBTNY                          WCBTNY
     I              BSBUNY                          WCBUNY
     I              BSGSAA                          WCGSAA
     I              BSGTAA                          WCGTAA
     I              BSOEQT                          WCOEQT
     I              BSMQWG                          WCMQWG
     I              BSOFQT                          WCOFQT
     I              BSMRWG                          WCMRWG
     I              BSOGQT                          WCOGQT
     I              BSMXWG                          WCMXWG
     I              BSOHQT                          WCOHQT
     I              BSMSWG                          WCMSWG
     I              BSOWQT                          WCOWQT
     I              BSNAWG                          WCNAWG
     I              BSOIQT                          WCOIQT
     I              BSMTWG                          WCMTWG
     I              BSOJQT                          WCOJQT
     I              BSMUWG                          WCMUWG
     I              BSOKQT                          WCOKQT
     I              BSMVWG                          WCMVWG
     I              BSOLQT                          WCOLQT
     I              BSMWWG                          WCMWWG
     I              BSFQVL                          WCFQVL
     I              BSOMQT                          WCOMQT
     I              BSMYWG                          WCMYWG
     I              BSONQT                          WCONQT
     I              BSMZWG                          WCMZWG
     I              BSOOQT                          WCOOQT
     I              BSM0WG                          WCM0WG
     I              BSDGVN                          WCDGVN
     I              BSP9DT                          WCP9DT
     I              BSCTTM                          WCCTTM
     I              BSOPQT                          WCOPQT
     I              BSM1WG                          WCM1WG
     I              BSOQQT                          WCOQQT
     I              BSM2WG                          WCM2WG
     I              BSORQT                          WCORQT
     I              BSM3WG                          WCM3WG
     I              BSOSQT                          WCOSQT
     I              BSM4WG                          WCM4WG
     I              BSRCNA                          WCRCNA
     I              BSDFVN                          WCDFVN
     I              BSP8DT                          WCP8DT
     I              BSCSTM                          WCCSTM
     I              BSOTQT                          WCOTQT
     I              BSM5WG                          WCM5WG
     I              BSF4PR                          WCF4PR
     I              BSWBSX                          WCWBSX
     I              BSWNSX                          WCWNSX
     I              BSWOSX                          WCWOSX
     I              BSOUQT                          WCOUQT
     I              BSM6WG                          WCM6WG
     I              BSOVQT                          WCOVQT
     I              BSM7WG                          WCM7WG
     I              BSWCSX                          WCWCSX
     I              BSQADT                          WCQADT
     I              BSWDSX                          WCWDSX
     I              BSVSST                          WCVSST
     I              BSMJDT                          WCMJDT
     I              BSBETM                          WCBETM
     I              BSCCVN                          WCCCVN
     I              BSCDVN                          WCCDVN
     I              BSMKDT                          WCMKDT
     I              BSBFTM                          WCBFTM
     I              BSCEVN                          WCCEVN
     I              BSCFVN                          WCCFVN
      *
     I@HSTPDF
      * Sales History             ActShipDt/ShipItem/Whse
      * Renamed input format fields
     I              F4AIC3                          WDAIC3
     I              F4C4NB                          WDC4NB
     I              F4DPNB                          WDDPNB
     I              F4UENB                          WDUENB
     I              F4MONA                          WDMONA
     I              F4RJCD                          WDRJCD
     I              F4RKCD                          WDRKCD
     I              F4GPTX                          WDGPTX
     I              F4ABTX                          WDABTX
     I              F4KXCD                          WDKXCD
     I              F4BOCD                          WDBOCD
     I              F4BTC7                          WDBTC7
     I              F4ANC7                          WDANC7
     I              F4AQTX                          WDAQTX
     I              F4BKC7                          WDBKC7
     I              F4BRTX                          WDBRTX
     I              F4HNNA                          WDHNNA
     I              F4DBCD                          WDDBCD
     I              F4CKTX                          WDCKTX
     I              F4BCNA                          WDBCNA
     I              F4A0DT                          WDA0DT
     I              F4ACDT                          WDACDT
     I              F4R4CD                          WDR4CD
     I              F4R5CD                          WDR5CD
     I              F4BFCD                          WDBFCD
     I              F4Q4CD                          WDQ4CD
     I              F4AQCD                          WDAQCD
     I              F4TBNB                          WDTBNB
     I              F4BZNA                          WDBZNA
     I              F4RLCD                          WDRLCD
     I              F4JNCD                          WDJNCD
     I              F4Q2CD                          WDQ2CD
     I              F4U2ST                          WDU2ST
     I              F4ATIN                          WDATIN
     I              F4T3NB                          WDT3NB
     I              F4RSRN                          WDRSRN
     I              F4ORIT                          WDORIT
     I              F4AJCD                          WDAJCD
     I              F4AVQT                          WDAVQT
     I              F4D0WG                          WDD0WG
     I              F4CCQT                          WDCCQT
     I              F4AUWG                          WDAUWG
     I              F4AGCD                          WDAGCD
     I              F4AKPR                          WDAKPR
     I              F4AUPR                          WDAUPR
     I              F4CRCD                          WDCRCD
     I              F4A5DT                          WDA5DT
     I              F4AWDT                          WDAWDT
     I              F4HDDT                          WDHDDT
     I              F4AGCS                          WDAGCS
     I              F4AQCS                          WDAQCS
     I              F4AVWG                          WDAVWG
     I              F4AYVA                          WDAYVA
     I              F4AMST                          WDAMST
     I              F4ANST                          WDANST
     I              F4VAST                          WDVAST
     I              F4L6NB                          WDL6NB
     I              F4UMCD                          WDUMCD
     I              F4HCDT                          WDHCDT
     I              F4ESNB                          WDESNB
     I              F4ETNB                          WDETNB
     I              F4BZNB                          WDBZNB
     I              F4EXQT                          WDEXQT
     I              F4BYWG                          WDBYWG
     I              F4S5NB                          WDS5NB
     I              F4MAVA                          WDMAVA
     I              F4KDVA                          WDKDVA
     I              F4USVA                          WDUSVA
     I              F4UTVA                          WDUTVA
     I              F4A4WG                          WDA4WG
     I              F4CKNB                          WDCKNB
     I              F4BMST                          WDBMST
     I              F4R8NB                          WDR8NB
     I              F4RMCD                          WDRMCD
     I              F4BZPR                          WDBZPR
     I              F4RDCD                          WDRDCD
     I              F4Q7CD                          WDQ7CD
     I              F4EXDT                          WDEXDT
     I              F4LQCD                          WDLQCD
     I              F4HICD                          WDHICD
     I              F4RBCD                          WDRBCD
     I              F4RGNB                          WDRGNB
     I              F4RHNB                          WDRHNB
     I              F4RINB                          WDRINB
     I              F4R1NB                          WDR1NB
     I              F4CONB                          WDCONB
     I              F4CEST                          WDCEST
     I              F4GNDT                          WDGNDT
     I              F4RMNB                          WDRMNB
     I              F4AODT                          WDAODT
     I              F4LLCD                          WDLLCD
     I              F4LMCD                          WDLMCD
     I              F4SKNB                          WDSKNB
     I              F4SLNB                          WDSLNB
     I              F4SMNB                          WDSMNB
     I              F4G7NA                          WDG7NA
     I              F4ONVA                          WDONVA
     I              F4N0CD                          WDN0CD
     I              F4B4NB                          WDB4NB
     I              F4B5NB                          WDB5NB
     I              F4N1CD                          WDN1CD
     I              F4GIDT                          WDGIDT
     I              F4Z1ST                          WDZ1ST
     I              F4ULVA                          WDULVA
     I              F4UNVA                          WDUNVA
     I              F4UOVA                          WDUOVA
     I              F4UPVA                          WDUPVA
     I              F4UQVA                          WDUQVA
     I              F4SDCD                          WDSDCD
     I              F4QZCD                          WDQZCD
     I              F4XWST                          WDXWST
     I              F4T9CD                          WDT9CD
     I              F4UBCD                          WDUBCD
     I              F4CFC7                          WDCFC7
     I              F4X1CD                          WDX1CD
     I              F4GASX                          WDGASX
     I              F4DUPR                          WDDUPR
     I              F4B6VL                          WDB6VL
     I              F4IANX                          WDIANX
     I              F4IBNX                          WDIBNX
     I              F4RPCD                          WDRPCD
     I              F4NYDT                          WDNYDT
     I              F4BZTM                          WDBZTM
     I              F4Z4NB                          WDZ4NB
     I              F4XACD                          WDXACD
     I              F4OANA                          WDOANA
     I              F4OKTX                          WDOKTX
     I              F4K4TX                          WDK4TX
     I              F4NBBO                          WDNBBO
     I              F4OCFR                          WDOCFR
     I              F4C0C7                          WDC0C7
     I              F4A1AA                          WDA1AA
     I              F4VEST                          WDVEST
     I              F4A5PR                          WDA5PR
     I              F4CDPR                          WDCDPR
     I              F4D0PR                          WDD0PR
     I              F4D0VL                          WDD0VL
     I              F4IRSX                          WDIRSX
     I              F4CEVL                          WDCEVL
     I              F4ISSX                          WDISSX
     I              F4ITSX                          WDITSX
     I              F4IUSX                          WDIUSX
     I              F4OHDT                          WDOHDT
     I              F4D9PR                          WDD9PR
     I              F4CFVL                          WDCFVL
     I              F4UVST                          WDUVST
     I              F4UWST                          WDUWST
     I              F4UXST                          WDUXST
     I              F4AATM                          WDAATM
     I              F4AYNA                          WDAYNA
     I              F4A0NA                          WDA0NA
     I              F4AXDT                          WDAXDT
      *
     I@BYREA1
      * Item Default              Retrieval index
      * Renamed input format fields
     I              BYHGCD                          WEHGCD
     I              BYAVNA                          WEAVNA
     I              BYAWNA                          WEAWNA
     I              BYL7NA                          WEL7NA
     I              BYL8NA                          WEL8NA
     I              BYL6NA                          WEL6NA
     I              BYMFNA                          WEMFNA
     I              BYHHCD                          WEHHCD
     I              BYAWPC                          WEAWPC
     I              BYLXST                          WELXST
     I              BYLGCD                          WELGCD
     I              BYAXPC                          WEAXPC
     I              BYLYST                          WELYST
     I              BYLHCD                          WELHCD
     I              BYLICD                          WELICD
     I              BYAIWG                          WEAIWG
     I              BYHICD                          WEHICD
     I              BYRBCD                          WERBCD
     I              BYFZST                          WEFZST
     I              BYAVST                          WEAVST
     I              BYCZWG                          WECZWG
     I              BYC0WG                          WEC0WG
     I              BYURTN                          WEURTN
     I              BYACC8                          WEACC8
     I              BYRINB                          WERINB
     I              BYRHNB                          WERHNB
     I              BYRGNB                          WERGNB
     I              BYLNCD                          WELNCD
     I              BYTFNB                          WETFNB
     I              BYN0CD                          WEN0CD
     I              BYX4ST                          WEX4ST
     I              BYCHTM                          WECHTM
     I              BYQZCD                          WEQZCD
     I              BYXWST                          WEXWST
     I              BYXXST                          WEXXST
     I              BYVMST                          WEVMST
     I              BYSWGH                          WESWGH
     I              BYPPHE                          WEPPHE
     I              BYLRCD                          WELRCD
     I              BYSFNB                          WESFNB
     I              BYA3WG                          WEA3WG
     I              BYSJNB                          WESJNB
     I              BYLLCD                          WELLCD
     I              BYLMCD                          WELMCD
     I              BYP3ST                          WEP3ST
     I              BYSKNB                          WESKNB
     I              BYSLNB                          WESLNB
     I              BYSMNB                          WESMNB
     I              BYP4ST                          WEP4ST
     I              BYCFNB                          WECFNB
     I              BYCGNB                          WECGNB
     I              BYILNB                          WEILNB
     I              BYCHNB                          WECHNB
     I              BYCINB                          WECINB
     I              BYCJNB                          WECJNB
     I              BYCMNB                          WECMNB
     I              BYCNNB                          WECNNB
     I              BYCRNB                          WECRNB
     I              BYCSNB                          WECSNB
     I              BYCVNB                          WECVNB
     I              BYCWNB                          WECWNB
     I              BYCXNB                          WECXNB
     I              BYCZNB                          WECZNB
     I              BYC0NB                          WEC0NB
     I              BYN1CD                          WEN1CD
     I              BYB4NB                          WEB4NB
     I              BYX5ST                          WEX5ST
     I              BYX6ST                          WEX6ST
     I              BYX7ST                          WEX7ST
     I              BYTMVA                          WETMVA
     I              BYTNVA                          WETNVA
     I              BYBLPR                          WEBLPR
     I              BYBMPR                          WEBMPR
     I              BYU9ST                          WEU9ST
     I              BYCMCO                          WECMCO
     I              BYQ1CD                          WEQ1CD
     I              BYAIC3                          WEAIC3
     I              BYQ8CD                          WEQ8CD
     I              BYR3CD                          WER3CD
     I              BYSDCD                          WESDCD
     I              BYICN1                          WEICN1
     I              BYSVCD                          WESVCD
     I              BYICN2                          WEICN2
     I              BYSWCD                          WESWCD
     I              BYV2NB                          WEV2NB
     I              BYSXCD                          WESXCD
     I              BYITCN                          WEITCN
     I              BYSYCD                          WESYCD
     I              BYITC5                          WEITC5
     I              BYSZCD                          WESZCD
     I              BYICN6                          WEICN6
     I              BYS0CD                          WES0CD
     I              BYICN7                          WEICN7
     I              BYS1CD                          WES1CD
     I              BYICN8                          WEICN8
     I              BYS2CD                          WES2CD
     I              BYICN9                          WEICN9
     I              BYS3CD                          WES3CD
     I              BYICN0                          WEICN0
     I              BYS4CD                          WES4CD
     I              BYB5NB                          WEB5NB
     I              BYXRCD                          WEXRCD
     I              BYPCCT                          WEPCCT
     I              BYBDNB                          WEBDNB
     I              BYBJNB                          WEBJNB
     I              BYSUST                          WESUST
     I              BYSVST                          WESVST
     I              BYSYST                          WESYST
     I              BYSZST                          WESZST
     I              BYS1ST                          WES1ST
     I              BYXTCD                          WEXTCD
     I              BYXUCD                          WEXUCD
     I              BYF5WG                          WEF5WG
     I              BYF6WG                          WEF6WG
     I              BYF7WG                          WEF7WG
     I              BYBLNB                          WEBLNB
     I              BYBNNB                          WEBNNB
     I              BYS2ST                          WES2ST
     I              BYS4ST                          WES4ST
     I              BYS5ST                          WES5ST
     I              BYS6ST                          WES6ST
     I              BYS8ST                          WES8ST
     I              BYS9ST                          WES9ST
     I              BYTCST                          WETCST
     I              BYTDST                          WETDST
     I              BYUVST                          WEUVST
     I              BYUWST                          WEUWST
     I              BYUXST                          WEUXST
     I              BYVSST                          WEVSST
     I              BYAHTM                          WEAHTM
     I              BYBEVN                          WEBEVN
     I              BYBFVN                          WEBFVN
     I              BYEKDT                          WEEKDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WFAIC3
     I              BZHGCD                          WFHGCD
     I              BZAVNA                          WFAVNA
     I              BZAWNA                          WFAWNA
     I              BZL7NA                          WFL7NA
     I              BZL8NA                          WFL8NA
     I              BZL6NA                          WFL6NA
     I              BZMFNA                          WFMFNA
     I              BZADCD                          WFADCD
     I              BZAWPC                          WFAWPC
     I              BZLXST                          WFLXST
     I              BZAECD                          WFAECD
     I              BZAXPC                          WFAXPC
     I              BZLYST                          WFLYST
     I              BZAFCD                          WFAFCD
     I              BZAICD                          WFAICD
     I              BZAIWG                          WFAIWG
     I              BZHICD                          WFHICD
     I              BZRBCD                          WFRBCD
     I              BZFZST                          WFFZST
     I              BZAVST                          WFAVST
     I              BZCZWG                          WFCZWG
     I              BZC0WG                          WFC0WG
     I              BZURTN                          WFURTN
     I              BZAJC8                          WFAJC8
     I              BZRINB                          WFRINB
     I              BZRHNB                          WFRHNB
     I              BZRGNB                          WFRGNB
     I              BZLNCD                          WFLNCD
     I              BZTFNB                          WFTFNB
     I              BZN0CD                          WFN0CD
     I              BZX4ST                          WFX4ST
     I              BZTMVA                          WFTMVA
     I              BZTNVA                          WFTNVA
     I              BZBLPR                          WFBLPR
     I              BZBMPR                          WFBMPR
     I              BZLRCD                          WFLRCD
     I              BZU9ST                          WFU9ST
     I              BZCMCO                          WFCMCO
     I              BZQ1CD                          WFQ1CD
     I              BZQ8CD                          WFQ8CD
     I              BZCHTM                          WFCHTM
     I              BZQZCD                          WFQZCD
     I              BZXWST                          WFXWST
     I              BZXXST                          WFXXST
     I              BZVMST                          WFVMST
     I              BZSWGH                          WFSWGH
     I              BZPPHE                          WFPPHE
     I              BZR3CD                          WFR3CD
     I              BZSDCD                          WFSDCD
     I              BZICN1                          WFICN1
     I              BZSVCD                          WFSVCD
     I              BZICN2                          WFICN2
     I              BZSWCD                          WFSWCD
     I              BZV2NB                          WFV2NB
     I              BZSXCD                          WFSXCD
     I              BZITCN                          WFITCN
     I              BZSYCD                          WFSYCD
     I              BZITC5                          WFITC5
     I              BZSZCD                          WFSZCD
     I              BZICN6                          WFICN6
     I              BZS0CD                          WFS0CD
     I              BZICN7                          WFICN7
     I              BZS1CD                          WFS1CD
     I              BZICN8                          WFICN8
     I              BZS2CD                          WFS2CD
     I              BZICN9                          WFICN9
     I              BZS3CD                          WFS3CD
     I              BZICN0                          WFICN0
     I              BZS4CD                          WFS4CD
     I              BZSFNB                          WFSFNB
     I              BZA3WG                          WFA3WG
     I              BZSJNB                          WFSJNB
     I              BZLLCD                          WFLLCD
     I              BZLMCD                          WFLMCD
     I              BZP3ST                          WFP3ST
     I              BZSKNB                          WFSKNB
     I              BZSLNB                          WFSLNB
     I              BZSMNB                          WFSMNB
     I              BZP4ST                          WFP4ST
     I              BZCFNB                          WFCFNB
     I              BZCGNB                          WFCGNB
     I              BZILNB                          WFILNB
     I              BZCHNB                          WFCHNB
     I              BZCINB                          WFCINB
     I              BZCJNB                          WFCJNB
     I              BZCMNB                          WFCMNB
     I              BZCNNB                          WFCNNB
     I              BZCRNB                          WFCRNB
     I              BZCSNB                          WFCSNB
     I              BZCVNB                          WFCVNB
     I              BZCWNB                          WFCWNB
     I              BZCXNB                          WFCXNB
     I              BZCZNB                          WFCZNB
     I              BZC0NB                          WFC0NB
     I              BZN1CD                          WFN1CD
     I              BZB4NB                          WFB4NB
     I              BZB5NB                          WFB5NB
     I              BZX5ST                          WFX5ST
     I              BZX6ST                          WFX6ST
     I              BZX7ST                          WFX7ST
     I              BZPCCT                          WFPCCT
     I              BZBDNB                          WFBDNB
     I              BZBJNB                          WFBJNB
     I              BZSUST                          WFSUST
     I              BZSVST                          WFSVST
     I              BZSYST                          WFSYST
     I              BZSZST                          WFSZST
     I              BZS1ST                          WFS1ST
     I              BZXRCD                          WFXRCD
     I              BZXTCD                          WFXTCD
     I              BZXUCD                          WFXUCD
     I              BZF5WG                          WFF5WG
     I              BZF6WG                          WFF6WG
     I              BZF7WG                          WFF7WG
     I              BZBLNB                          WFBLNB
     I              BZBNNB                          WFBNNB
     I              BZS2ST                          WFS2ST
     I              BZS4ST                          WFS4ST
     I              BZS5ST                          WFS5ST
     I              BZS6ST                          WFS6ST
     I              BZS8ST                          WFS8ST
     I              BZS9ST                          WFS9ST
     I              BZTCST                          WFTCST
     I              BZTDST                          WFTDST
     I              BZUVST                          WFUVST
     I              BZUWST                          WFUWST
     I              BZUXST                          WFUXST
     I              BZVSST                          WFVSST
     I              BZAATM                          WFAATM
     I              BZAYNA                          WFAYNA
     I              BZA0NA                          WFA0NA
     I              BZAXDT                          WFAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WGAJCD
     I              ADF8NA                          WGF8NA
     I              ADACNA                          WGACNA
     I              ADADNA                          WGADNA
     I              ADAENA                          WGAENA
     I              ADAJNA                          WGAJNA
     I              ADBTTX                          WGBTTX
     I              ADAOCD                          WGAOCD
     I              ADBGCD                          WGBGCD
     I              ADVHST                          WGVHST
     I              ADMPNA                          WGMPNA
     I              ADWPST                          WGWPST
     I              ADXUST                          WGXUST
     I              ADT0ST                          WGT0ST
     I              ADT1ST                          WGT1ST
     I              ADDBNB                          WGDBNB
     I              ADT2ST                          WGT2ST
     I              ADT3ST                          WGT3ST
     I              ADT4ST                          WGT4ST
     I              ADT6ST                          WGT6ST
     I              ADBWC3                          WGBWC3
     I              ADBTC3                          WGBTC3
     I              ADBUC3                          WGBUC3
     I              ADBVC3                          WGBVC3
     I              ADFCAA                          WGFCAA
     I              ADRQSX                          WGRQSX
     I              ADRRSX                          WGRRSX
     I              ADRSSX                          WGRSSX
     I              ADRTSX                          WGRTSX
     I              ADT7ST                          WGT7ST
     I              ADT8ST                          WGT8ST
     I              ADRNSX                          WGRNSX
     I              ADROSX                          WGROSX
     I              ADRPSX                          WGRPSX
     I              ADUVST                          WGUVST
     I              ADUWST                          WGUWST
     I              ADUXST                          WGUXST
     I              ADVSST                          WGVSST
     I              ADAATM                          WGAATM
     I              ADAYNA                          WGAYNA
     I              ADA0NA                          WGA0NA
     I              ADAXDT                          WGAXDT
      *
     I@EXRETY
      * Order Types               Active order Types
      * Renamed input format fields
     I              EXJNCD                          WHJNCD
     I              EXJVNA                          WHJVNA
     I              EXOAST                          WHOAST
     I              EXOBST                          WHOBST
     I              EXOEST                          WHOEST
     I              EXOFST                          WHOFST
     I              EXVBST                          WHVBST
     I              EXPYST                          WHPYST
     I              EXX8ST                          WHX8ST
     I              EXISTX                          WHISTX
     I              EXUVST                          WHUVST
     I              EXUWST                          WHUWST
     I              EXUXST                          WHUXST
     I              EXVSST                          WHVSST
     I              EXAATM                          WHAATM
     I              EXAYNA                          WHAYNA
     I              EXA0NA                          WHA0NA
     I              EXAXDT                          WHAXDT
      *
     I@BSCPBC
      * Inventory Stock Closing   Grp/WEDt/WhsCo/Whs/I S F
      * Renamed input format fields
     I              BSAIDX                          WIAIDX
     I              BSB2C3                          WIB2C3
     I              BSGRAA                          WIGRAA
     I              BSEJC7                          WIEJC7
     I              BSV8SX                          WIV8SX
     I              BSGPAA                          WIGPAA
     I              BSGQAA                          WIGQAA
     I              BSW1SX                          WIW1SX
     I              BSF3PR                          WIF3PR
     I              BSBSNY                          WIBSNY
     I              BSBTNY                          WIBTNY
     I              BSBUNY                          WIBUNY
     I              BSGSAA                          WIGSAA
     I              BSGTAA                          WIGTAA
     I              BSOEQT                          WIOEQT
     I              BSMQWG                          WIMQWG
     I              BSOFQT                          WIOFQT
     I              BSMRWG                          WIMRWG
     I              BSOGQT                          WIOGQT
     I              BSMXWG                          WIMXWG
     I              BSOHQT                          WIOHQT
     I              BSMSWG                          WIMSWG
     I              BSOWQT                          WIOWQT
     I              BSNAWG                          WINAWG
     I              BSOIQT                          WIOIQT
     I              BSMTWG                          WIMTWG
     I              BSOJQT                          WIOJQT
     I              BSMUWG                          WIMUWG
     I              BSOKQT                          WIOKQT
     I              BSMVWG                          WIMVWG
     I              BSOLQT                          WIOLQT
     I              BSMWWG                          WIMWWG
     I              BSFQVL                          WIFQVL
     I              BSOMQT                          WIOMQT
     I              BSMYWG                          WIMYWG
     I              BSONQT                          WIONQT
     I              BSMZWG                          WIMZWG
     I              BSOOQT                          WIOOQT
     I              BSM0WG                          WIM0WG
     I              BSDGVN                          WIDGVN
     I              BSP9DT                          WIP9DT
     I              BSCTTM                          WICTTM
     I              BSOPQT                          WIOPQT
     I              BSM1WG                          WIM1WG
     I              BSOQQT                          WIOQQT
     I              BSM2WG                          WIM2WG
     I              BSORQT                          WIORQT
     I              BSM3WG                          WIM3WG
     I              BSOSQT                          WIOSQT
     I              BSM4WG                          WIM4WG
     I              BSRCNA                          WIRCNA
     I              BSDFVN                          WIDFVN
     I              BSP8DT                          WIP8DT
     I              BSCSTM                          WICSTM
     I              BSOTQT                          WIOTQT
     I              BSM5WG                          WIM5WG
     I              BSF4PR                          WIF4PR
     I              BSWBSX                          WIWBSX
     I              BSWNSX                          WIWNSX
     I              BSWOSX                          WIWOSX
     I              BSOUQT                          WIOUQT
     I              BSM6WG                          WIM6WG
     I              BSOVQT                          WIOVQT
     I              BSM7WG                          WIM7WG
     I              BSWCSX                          WIWCSX
     I              BSQADT                          WIQADT
     I              BSWDSX                          WIWDSX
     I              BSVSST                          WIVSST
     I              BSMJDT                          WIMJDT
     I              BSBETM                          WIBETM
     I              BSCCVN                          WICCVN
     I              BSCDVN                          WICDVN
     I              BSMKDT                          WIMKDT
     I              BSBFTM                          WIBFTM
     I              BSCEVN                          WICEVN
     I              BSCFVN                          WICFVN
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WJAJVN
     I              DRAUNA                          WJAUNA
     I              DRB8NA                          WJB8NA
     I              DRAHVN                          WJAHVN
     I              DRI6ST                          WJI6ST
     I              DRI7ST                          WJI7ST
     I              DRXMST                          WJXMST
     I              DRXNST                          WJXNST
     I              DRI8ST                          WJI8ST
     I              DRNLNB                          WJNLNB
     I              DRMPNA                          WJMPNA
     I              DRBCCD                          WJBCCD
     I              DRAIC3                          WJAIC3
     I              DRDQCD                          WJDQCD
     I              DRDRCD                          WJDRCD
     I              DRAJCD                          WJAJCD
     I              DRBUVN                          WJBUVN
     I              DRUVST                          WJUVST
     I              DRUWST                          WJUWST
     I              DRUXST                          WJUXST
     I              DRAATM                          WJAATM
     I              DRAYNA                          WJAYNA
     I              DRA0NA                          WJA0NA
     I              DRAXDT                          WJAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WKAJVN
     I              DTDNCD                          WKDNCD
     I              DTAIC3                          WKAIC3
     I              DTDQCD                          WKDQCD
     I              DTDRCD                          WKDRCD
     I              DTAJCD                          WKAJCD
     I              DTJFST                          WKJFST
     I              DTUVST                          WKUVST
     I              DTUWST                          WKUWST
     I              DTUXST                          WKUXST
     I              DTAATM                          WKAATM
     I              DTAYNA                          WKAYNA
     I              DTA0NA                          WKA0NA
     I              DTAXDT                          WKAXDT
      *
     I@ADREWA
      * Warehouse Codes           ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WLAJCD
     I              ADF8NA                          WLF8NA
     I              ADACNA                          WLACNA
     I              ADADNA                          WLADNA
     I              ADAENA                          WLAENA
     I              ADAJNA                          WLAJNA
     I              ADBTTX                          WLBTTX
     I              ADAOCD                          WLAOCD
     I              ADBGCD                          WLBGCD
     I              ADVHST                          WLVHST
     I              ADMPNA                          WLMPNA
     I              ADWPST                          WLWPST
     I              ADXUST                          WLXUST
     I              ADT0ST                          WLT0ST
     I              ADT1ST                          WLT1ST
     I              ADDBNB                          WLDBNB
     I              ADT2ST                          WLT2ST
     I              ADT3ST                          WLT3ST
     I              ADT4ST                          WLT4ST
     I              ADT6ST                          WLT6ST
     I              ADBWC3                          WLBWC3
     I              ADBTC3                          WLBTC3
     I              ADBUC3                          WLBUC3
     I              ADBVC3                          WLBVC3
     I              ADFCAA                          WLFCAA
     I              ADRQSX                          WLRQSX
     I              ADRRSX                          WLRRSX
     I              ADRSSX                          WLRSSX
     I              ADRTSX                          WLRTSX
     I              ADT7ST                          WLT7ST
     I              ADT8ST                          WLT8ST
     I              ADRNSX                          WLRNSX
     I              ADROSX                          WLROSX
     I              ADRPSX                          WLRPSX
     I              ADUVST                          WLUVST
     I              ADUWST                          WLUWST
     I              ADUXST                          WLUXST
     I              ADVSST                          WLVSST
     I              ADAATM                          WLAATM
     I              ADAYNA                          WLAYNA
     I              ADA0NA                          WLA0NA
     I              ADAXDT                          WLAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WMAIC3
     I              ABADTX                          WMADTX
     I              ABACNA                          WMACNA
     I              ABADNA                          WMADNA
     I              ABAENA                          WMAENA
     I              ABAJNA                          WMAJNA
     I              ABBTTX                          WMBTTX
     I              ABBVTX                          WMBVTX
     I              ABBWTX                          WMBWTX
     I              ABA2NA                          WMA2NA
     I              ABABTX                          WMABTX
     I              ABBGCD                          WMBGCD
     I              ABKXCD                          WMKXCD
     I              ABUVST                          WMUVST
     I              ABUWST                          WMUWST
     I              ABUXST                          WMUXST
     I              ABVSST                          WMVSST
     I              ABAATM                          WMAATM
     I              ABAYNA                          WMAYNA
     I              ABA0NA                          WMA0NA
     I              ABAXDT                          WMAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WODNCD
     I              DNAUNA                          WOAUNA
     I              DNVKST                          WOVKST
     I              DNRSCD                          WORSCD
     I              DNUVST                          WOUVST
     I              DNUWST                          WOUWST
     I              DNUXST                          WOUXST
     I              DNAATM                          WOAATM
     I              DNAYNA                          WOAYNA
     I              DNA0NA                          WOA0NA
     I              DNAXDT                          WOAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WRAIC3
     I              KMV8CD                          WRV8CD
     I              KMAUNA                          WRAUNA
     I              KMI5ST                          WRI5ST
     I              KMBXTX                          WRBXTX
     I              KMM8NB                          WRM8NB
     I              KMUVST                          WRUVST
     I              KMUWST                          WRUWST
     I              KMUXST                          WRUXST
     I              KMVSST                          WRVSST
     I              KMAATM                          WRAATM
     I              KMAYNA                          WRAYNA
     I              KMA0NA                          WRA0NA
     I              KMAXDT                          WRAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPPBS1    E DSPPBSCPL0
      * UPD : Inventory Stock Closing   Update index
      * Renamed input format fields
     I              BSAIDX                          WCAIDX
     I              BSB2C3                          WCB2C3
     I              BSGRAA                          WCGRAA
     I              BSEJC7                          WCEJC7
     I              BSV8SX                          WCV8SX
     I              BSGPAA                          WCGPAA
     I              BSGQAA                          WCGQAA
     I              BSW1SX                          WCW1SX
     I              BSF3PR                          WCF3PR
     I              BSBSNY                          WCBSNY
     I              BSBTNY                          WCBTNY
     I              BSBUNY                          WCBUNY
     I              BSGSAA                          WCGSAA
     I              BSGTAA                          WCGTAA
     I              BSOEQT                          WCOEQT
     I              BSMQWG                          WCMQWG
     I              BSOFQT                          WCOFQT
     I              BSMRWG                          WCMRWG
     I              BSOGQT                          WCOGQT
     I              BSMXWG                          WCMXWG
     I              BSOHQT                          WCOHQT
     I              BSMSWG                          WCMSWG
     I              BSOWQT                          WCOWQT
     I              BSNAWG                          WCNAWG
     I              BSOIQT                          WCOIQT
     I              BSMTWG                          WCMTWG
     I              BSOJQT                          WCOJQT
     I              BSMUWG                          WCMUWG
     I              BSOKQT                          WCOKQT
     I              BSMVWG                          WCMVWG
     I              BSOLQT                          WCOLQT
     I              BSMWWG                          WCMWWG
     I              BSFQVL                          WCFQVL
     I              BSOMQT                          WCOMQT
     I              BSMYWG                          WCMYWG
     I              BSONQT                          WCONQT
     I              BSMZWG                          WCMZWG
     I              BSOOQT                          WCOOQT
     I              BSM0WG                          WCM0WG
     I              BSDGVN                          WCDGVN
     I              BSP9DT                          WCP9DT
     I              BSCTTM                          WCCTTM
     I              BSOPQT                          WCOPQT
     I              BSM1WG                          WCM1WG
     I              BSOQQT                          WCOQQT
     I              BSM2WG                          WCM2WG
     I              BSORQT                          WCORQT
     I              BSM3WG                          WCM3WG
     I              BSOSQT                          WCOSQT
     I              BSM4WG                          WCM4WG
     I              BSRCNA                          WCRCNA
     I              BSDFVN                          WCDFVN
     I              BSP8DT                          WCP8DT
     I              BSCSTM                          WCCSTM
     I              BSOTQT                          WCOTQT
     I              BSM5WG                          WCM5WG
     I              BSF4PR                          WCF4PR
     I              BSWBSX                          WCWBSX
     I              BSWNSX                          WCWNSX
     I              BSWOSX                          WCWOSX
     I              BSOUQT                          WCOUQT
     I              BSM6WG                          WCM6WG
     I              BSOVQT                          WCOVQT
     I              BSM7WG                          WCM7WG
     I              BSWCSX                          WCWCSX
     I              BSQADT                          WCQADT
     I              BSWDSX                          WCWDSX
     I              BSVSST                          WCVSST
     I              BSMJDT                          WCMJDT
     I              BSBETM                          WCBETM
     I              BSCCVN                          WCCCVN
     I              BSCDVN                          WCCDVN
     I              BSMKDT                          WCMKDT
     I              BSBFTM                          WCBFTM
     I              BSCEVN                          WCCEVN
     I              BSCFVN                          WCCFVN
      *
     IYARDCS      DS                            448
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
     IXDI8T       DS
      * Internal date
     I                                        1   80XDI8DT
     I                                        1   40XDI8CY
     I                                        1   10XDI8CC
     I                                        2   40XDI8YY
     I                                        5   60XDI8MM
     I                                        7   80XDI8DD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Inventory Stock Closing
      * I :  ISC Week Ending Date
     I                                    P   1   50P1AIDX
      * I :  ISC Warehouse Company
     I                                    P   6   70P1B2C3
      * I :  ISC Valuation Grouping
     I                                        8   8 P1WCSX
     IP2PARM      DS
      * I :  Week End Date
     I                                    P   1   40P2N6DT
     IP3PARM      DS
      * N :  Date Sun USR
     I                                    P   1   40P3JNDT
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Whs Prices posted'
      * ISC Week Ending Date
     I                                    P   1   50ZA0001
      * ISC Valuation Grouping
     I                                        6   6 ZA0002
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIDX    PARM           WP0001  80       ISC Week Ending
     C           P1B2C3    PARM           WP0002  30       ISC Warehouse C
     C           P1WCSX    PARM           WP0003  1        ISC Valuation G
     C           P2N6DT    PARM           WP0004  70       Week End Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Post Whse Prices  XF
      * 1. Change the Post Warehouse Sts to P
      * R9083 02/05/17 DN-Modify to Also RST by Grouping/WE Date.
      * S010245 03/22/24 JM-START-Use PPOOXFR which has reference to sale
      * history. This will calculate unshipped inventory accurately.
      * Rtv Prior Sunday      RT - Calendar  * 
     C                     EXSR SARVGN
      * Rtv -0- Shipmnt Final RT - Inventory Stock Closing  * 
     C                     EXSR SBRVGN
      * Exc Sales Hst Shp Bal RT - Sales History  * 
     C                     EXSR SDRVGN
      * Rtv Chg Post Sts      RT2 - Inventory Stock Closing  * 
     C                     EXSR SLRVGN
      * S010245 04/17/24 JM-Fix defect to change ISC Post Warehouse Sts t
      * Posted/Reposted.
      * Rtv Chg Post WarehouseSts - Inventory Stock Closing  * 
     C                     EXSR SMRVGN
      * S010245 03/22/24 JM-END
      * 2. Send email to plant (nathon ) that Warehouse Prices have been
      *
     C                     MOVEL*BLANK    WN0003 10        User Profile Na
      *
      * VAL Set Int. Acc EXTNL IF
     C                     MOVEL##USR     WN0003           User Profile Na
      *
     C                     MOVEL*BLANK    WN0004 10        User Code Model
      *
      * VAL User/Appl EXTERNAL IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SNRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0004    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0003    WL0088    P      User Profile Na
     C                     MOVEL'I/C'     WL0089    P      Application Cod
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0090    WUAIC3           Company Number
     C                     MOVELWL0091    YL0017    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0004    WL0088    P      User Profile Na
     C                     MOVEL'I/C'     WL0089    P      Application Cod
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0090    WUAIC3           Company Number
     C                     MOVELWL0091    YL0017    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0017    YN0001           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Use User Profile Control company if entered,get whse if the appl
      * CASE: LCL.Company Number is greater than zero
     C           YL0016    IFGT 0                          *IF
     C                     Z-ADDYL0016    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0017    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    YL0015           Company Number
     C                     MOVELWUWVST    YN0007           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SQRVGN
     C                     END                             *FI
      * RTV Screen Heading     RT
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SRRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * DSP Center Text Str 40 US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C                     MOVE 'N'       FLAG    1        FLAG
     C           UX        DOWGT0
     C           FLAG      ANDEQ'N'
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     MOVE 'Y'       FLAG
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
      *** ADDED FOR HPE, THERE HEADER FOOTER IS OFF   MEA 042494
     C                     SUB  1         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
     C                     MOVELWUDE40    YN0006           System Value Al
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR STRVGN
      * R9083 02/05/17 DN-Modify to Include Grouping Description in Messa
      * Setup message data for message
      * Convert ISC Week Ending Date to display format
      * Convert date
     C                     Z-ADDP1AIDX    XDI8DT
     C                     EXSR XDV82T
     C                     Z-ADDXDEXDT    ZA0001
     C                     MOVELP1WCSX    ZA0002           ISC Valuation G
      * Retrieve message Whs Prices posted
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3562' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0019    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * SND Pager Msg (MPLUS) UP - /UT User Programs  * 
     C                     CALL 'POMSUPC'              90  SND Pager Msg (
     C                     PARM WUCLAA    WQ0001 10        DL List ID
     C                     PARM YL0019    WQ0002132        Office Message
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Prior Sunday      RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WABCDT           Post to G_L Dat
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1B2C3    WQSA01           Company Number
     C                     Z-ADDP2N6DT    WABCDT           Post to G_L Dat
      * Establish starting position
     C           KPSSA     SETLL@AFREPU                    *
     C           KRSSA     READE@AFREPU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P3JNDT           Date Sun USR
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Day of Week is Sunday
     C           WAA9ST    IFEQ '1'                        *IF
     C                     Z-ADDWABCDT    P3JNDT           Date Sun USR
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSA     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv -0- Shipmnt Final RT - Inventory Stock Closing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIDX    WQSB01           ISC Week Ending
     C           *LIKE     DEFN WBB2C3    WQSB02           ISC Warehouse C
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           ISC Week Ending
     C                     KFLD           WQSB02           ISC Warehouse C
      * Setup key
     C                     Z-ADDP1AIDX    WQSB01           ISC Week Ending
     C                     Z-ADDP1B2C3    WQSB02           ISC Warehouse C
      * Establish starting position
     C           KRSSB     SETLL@BSCPA6                    *
     C           KRSSB     READE@BSCPA6                  90*
      * Data record not found
     C   90                MOVEL'USR3529' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Inventory Stock   CH - Inventory Stock Closing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIDX    WL0001           ISC Week Ending
     C                     Z-ADDWBB2C3    WL0002           ISC Warehouse C
     C                     MOVELWBGRAA    WL0003    P      ISC Warehouse C
     C                     Z-ADDWBEJC7    WL0004           ISC Item Code
     C                     MOVELWBV8SX    WL0005    P      ISC Warehouse T
     C                     MOVELWBGPAA    WL0006    P      ISC Item Cmdty
     C                     MOVELWBGQAA    WL0007    P      ISC Item Dft Cm
     C                     MOVELWBW1SX    WL0008    P      ISC Item Type
     C                     Z-ADDWBF3PR    WL0009           ISC Item Market
     C                     Z-ADDWBBSNY    WL0010           ISC Item Struct
     C                     Z-ADDWBBTNY    WL0011           ISC Item Struct
     C                     Z-ADDWBBUNY    WL0012           ISC Item Struct
     C                     MOVELWBGSAA    WL0013    P      ISC Item GL Sub
     C                     MOVELWBGTAA    WL0014    P      ISC Item UOM Pr
     C                     Z-ADDWBOEQT    WL0015           ISC Begin Inv F
     C                     Z-ADDWBMQWG    WL0016           ISC Begin Inv F
     C                     Z-ADDWBOFQT    WL0017           ISC Begin Inv A
     C                     Z-ADDWBMRWG    WL0018           ISC Begin Inv A
     C                     Z-ADDWBOGQT    WL0019           ISC Begin Inv Q
     C                     Z-ADDWBMXWG    WL0020           ISC Begin Inv L
     C                     Z-ADDWBOHQT    WL0021           ISC Floor Produ
     C                     Z-ADDWBMSWG    WL0022           ISC Floor Produ
     C                     Z-ADDWBOWQT    WL0023           ISC Floor Prod
     C                     Z-ADDWBNAWG    WL0024           ISC Floor Prod
     C                     Z-ADD*ZERO     WL0025           ISC Sales Produ
     C                     Z-ADD*ZERO     WL0026           ISC Sales Produ
     C                     Z-ADDWBOJQT    WL0027           ISC Inventory S
     C                     Z-ADDWBMUWG    WL0028           ISC Inventory S
     C                     Z-ADDWBOKQT    WL0029           ISC Ord Dtl Shi
     C                     Z-ADDWBMVWG    WL0030           ISC Ord Dtl Shi
     C                     Z-ADD*ZERO     WL0031           ISC Shipment Fi
     C                     Z-ADD*ZERO     WL0032           ISC Shipment Fi
     C                     Z-ADD*ZERO     WL0033           ISC FOB Gross A
     C                     Z-ADDWBOMQT    WL0034           ISC Inventory T
     C                     Z-ADDWBMYWG    WL0035           ISC Inventory T
     C                     Z-ADDWBONQT    WL0036           ISC Misc Invntr
     C                     Z-ADDWBMZWG    WL0037           ISC Misc Invntr
     C                     Z-ADDWBOOQT    WL0038           ISC Ending Inve
     C                     Z-ADDWBM0WG    WL0039           ISC Ending Inve
     C                     MOVELWBDGVN    WL0040    P      ISC End Inv Use
     C                     Z-ADDWBP9DT    WL0041           ISC End Inv Dat
     C                     Z-ADDWBCTTM    WL0042           ISC End Inv Tim
     C                     Z-ADDWBOPQT    WL0043           ISC Sun Ship In
     C                     Z-ADDWBM1WG    WL0044           ISC Sun Ship In
     C                     Z-ADD*ZERO     WL0045           ISC Unsh_Ship I
     C                     Z-ADD*ZERO     WL0046           ISC Unsh_Ship I
     C                     Z-ADDWBORQT    WL0047           ISC End Inv Par
     C                     Z-ADDWBM3WG    WL0048           ISC End Inv Par
     C                     Z-ADDWBOSQT    WL0049           ISC Ending Inv
     C                     Z-ADDWBM4WG    WL0050           ISC Ending Inv
     C                     MOVELWBRCNA    WL0051    P      ISC End Inv Adj
     C                     MOVELWBDFVN    WL0052    P      ISC Ending Inv
     C                     Z-ADDWBP8DT    WL0053           ISC Ending Inv
     C                     Z-ADDWBCSTM    WL0054           ISC Ending Inv
     C                     Z-ADDWBOTQT    WL0055           ISC Ending Inv
     C                     Z-ADDWBM5WG    WL0056           ISC Ending Inv
     C                     Z-ADDWBF4PR    WL0057           ISC Warehouse P
     C                     MOVELWBWBSX    WL0058    P      ISC Warehouse P
     C                     MOVELWBWNSX    WL0059    P      ISC Post Balanc
     C                     MOVELWBWOSX    WL0060    P      ISC Post Wareho
     C                     Z-ADD*ZERO     WL0061           ISC Commission
     C                     Z-ADDWBM6WG    WL0062           ISC Unused Lbs
     C                     Z-ADD0         WL0063           ISC TF Exempt N
     C                     Z-ADD*ZERO     WL0064           ISC TF Exempt P
     C                     MOVELWBWCSX    WL0065    P      ISC Valuation G
     C                     Z-ADDWBQADT    WL0066           ISC Unused Date
     C                     MOVELWBWDSX    WL0067    P      ISC Unused Sts
     C                     MOVELWBVSST    WL0068    P      Record Status
     C                     Z-ADDWBMJDT    WL0069           Create Date
     C                     Z-ADDWBBETM    WL0070           Create Time
     C                     MOVELWBCCVN    WL0071    P      Create User
     C                     MOVELWBCDVN    WL0072    P      Create Program
     C                     Z-ADDWBMKDT    WL0073           Change Date
     C                     Z-ADDWBBFTM    WL0074           Change Time
     C                     MOVELWBCEVN    WL0075    P      Change User
     C                     MOVELWBCFVN    WL0076    P      Change Program
     C                     EXSR SCCHRC
     C           KRSSB     READE@BSCPA6                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg Inventory Stock   CH - Inventory Stock Closing  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BSCPA5
     C                     Z-ADDWL0001    WCAIDX           ISC Week Ending
     C                     Z-ADDWL0002    WCB2C3           ISC Warehouse C
     C                     MOVELWL0003    WCGRAA    P      ISC Warehouse C
     C                     Z-ADDWL0004    WCEJC7           ISC Item Code
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCAIDX           ISC Week Ending
     C                     KFLD           WCB2C3           ISC Warehouse C
     C                     KFLD           WCGRAA           ISC Warehouse C
     C                     KFLD           WCEJC7           ISC Item Code
     C           KLCHSC    CHAIN@BSCPA5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBSCPL0'MDACP
     C                     MOVEL'@BSCPA5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBS1    YARDCS
      * Move non-key fields to @BSCPA5
     C                     MOVELWL0005    WCV8SX    P      ISC Warehouse T
     C                     MOVELWL0006    WCGPAA    P      ISC Item Cmdty
     C                     MOVELWL0007    WCGQAA    P      ISC Item Dft Cm
     C                     MOVELWL0008    WCW1SX    P      ISC Item Type
     C                     Z-ADDWL0009    WCF3PR           ISC Item Market
     C                     Z-ADDWL0010    WCBSNY           ISC Item Struct
     C                     Z-ADDWL0011    WCBTNY           ISC Item Struct
     C                     Z-ADDWL0012    WCBUNY           ISC Item Struct
     C                     MOVELWL0013    WCGSAA    P      ISC Item GL Sub
     C                     MOVELWL0014    WCGTAA    P      ISC Item UOM Pr
     C                     Z-ADDWL0015    WCOEQT           ISC Begin Inv F
     C                     Z-ADDWL0016    WCMQWG           ISC Begin Inv F
     C                     Z-ADDWL0017    WCOFQT           ISC Begin Inv A
     C                     Z-ADDWL0018    WCMRWG           ISC Begin Inv A
     C                     Z-ADDWL0019    WCOGQT           ISC Begin Inv Q
     C                     Z-ADDWL0020    WCMXWG           ISC Begin Inv L
     C                     Z-ADDWL0021    WCOHQT           ISC Floor Produ
     C                     Z-ADDWL0022    WCMSWG           ISC Floor Produ
     C                     Z-ADDWL0023    WCOWQT           ISC Floor Prod
     C                     Z-ADDWL0024    WCNAWG           ISC Floor Prod
     C                     Z-ADDWL0025    WCOIQT           ISC Sales Produ
     C                     Z-ADDWL0026    WCMTWG           ISC Sales Produ
     C                     Z-ADDWL0027    WCOJQT           ISC Inventory S
     C                     Z-ADDWL0028    WCMUWG           ISC Inventory S
     C                     Z-ADDWL0029    WCOKQT           ISC Ord Dtl Shi
     C                     Z-ADDWL0030    WCMVWG           ISC Ord Dtl Shi
     C                     Z-ADDWL0031    WCOLQT           ISC Shipment Fi
     C                     Z-ADDWL0032    WCMWWG           ISC Shipment Fi
     C                     Z-ADDWL0033    WCFQVL           ISC FOB Gross A
     C                     Z-ADDWL0034    WCOMQT           ISC Inventory T
     C                     Z-ADDWL0035    WCMYWG           ISC Inventory T
     C                     Z-ADDWL0036    WCONQT           ISC Misc Invntr
     C                     Z-ADDWL0037    WCMZWG           ISC Misc Invntr
     C                     Z-ADDWL0038    WCOOQT           ISC Ending Inve
     C                     Z-ADDWL0039    WCM0WG           ISC Ending Inve
     C                     MOVELWL0040    WCDGVN    P      ISC End Inv Use
     C                     Z-ADDWL0041    WCP9DT           ISC End Inv Dat
     C                     Z-ADDWL0042    WCCTTM           ISC End Inv Tim
     C                     Z-ADDWL0043    WCOPQT           ISC Sun Ship In
     C                     Z-ADDWL0044    WCM1WG           ISC Sun Ship In
     C                     Z-ADDWL0045    WCOQQT           ISC Unsh_Ship I
     C                     Z-ADDWL0046    WCM2WG           ISC Unsh_Ship I
     C                     Z-ADDWL0047    WCORQT           ISC End Inv Par
     C                     Z-ADDWL0048    WCM3WG           ISC End Inv Par
     C                     Z-ADDWL0049    WCOSQT           ISC Ending Inv
     C                     Z-ADDWL0050    WCM4WG           ISC Ending Inv
     C                     MOVELWL0051    WCRCNA    P      ISC End Inv Adj
     C                     MOVELWL0052    WCDFVN    P      ISC Ending Inv
     C                     Z-ADDWL0053    WCP8DT           ISC Ending Inv
     C                     Z-ADDWL0054    WCCSTM           ISC Ending Inv
     C                     Z-ADDWL0055    WCOTQT           ISC Ending Inv
     C                     Z-ADDWL0056    WCM5WG           ISC Ending Inv
     C                     Z-ADDWL0057    WCF4PR           ISC Warehouse P
     C                     MOVELWL0058    WCWBSX    P      ISC Warehouse P
     C                     MOVELWL0059    WCWNSX    P      ISC Post Balanc
     C                     MOVELWL0060    WCWOSX    P      ISC Post Wareho
     C                     Z-ADDWL0061    WCOUQT           ISC Commission
     C                     Z-ADDWL0062    WCM6WG           ISC Unused Lbs
     C                     Z-ADDWL0063    WCOVQT           ISC TF Exempt N
     C                     Z-ADDWL0064    WCM7WG           ISC TF Exempt P
     C                     MOVELWL0065    WCWCSX    P      ISC Valuation G
     C                     Z-ADDWL0066    WCQADT           ISC Unused Date
     C                     MOVELWL0067    WCWDSX    P      ISC Unused Sts
     C                     MOVELWL0068    WCVSST    P      Record Status
     C                     Z-ADDWL0069    WCMJDT           Create Date
     C                     Z-ADDWL0070    WCBETM           Create Time
     C                     MOVELWL0071    WCCCVN    P      Create User
     C                     MOVELWL0072    WCCDVN    P      Create Program
     C                     Z-ADDWL0073    WCMKDT           Change Date
     C                     Z-ADDWL0074    WCBFTM           Change Time
     C                     MOVELWL0075    WCCEVN    P      Change User
     C                     MOVELWL0076    WCCFVN    P      Change Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WCMKDT           Change Date
     C                     Z-ADD##JTM     WCBFTM           Change Time
     C                     MOVEL##USR     WCCEVN           Change User
     C                     MOVEL##PGM     WCCFVN           Change Program
      * Compute:Ending Inv Fin Qt
      * DB1.ISC End Inv Final Qty =
      *    *COMPUTE (x1 + x2 + x3 +x4 + x5)
      * x1    : DB1.ISC Ending Inventory Qty
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.ISC Ending Inv Adj Qty
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.ISC Sun Ship Inv Adj Qty
      * +     : PGM.*Synon (15,2) work field
      * x4    : DB1.ISC Unsh_Ship Inv Adj Qty
      * +     : PGM.*Synon (15,2) work field
      * x5    : DB1.ISC End Inv Partial Qty
     C           WCOOQT    ADD  WCOSQT    W0WA03           *Synon (15,2) w
     C           W0WA03    ADD  WCOPQT    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WCOQQT    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  WCORQT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WCOTQT           ISC Ending Inv
      * Compute:Ending Inv Fin Lb
      * DB1.ISC End Inv Final Lbs =
      *    *COMPUTE (x1 + x2 + x3 +x4 + x5)
      * x1    : DB1.ISC Ending Inventory Lbs
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.ISC Ending Inv Adj Lbs
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.ISC Sun Ship Inv Adj Lbs
      * +     : PGM.*Synon (15,2) work field
      * x4    : DB1.ISC Unsh_Ship Inv Adj Lbs
      * +     : PGM.*Synon (15,2) work field
      * x5    : DB1.ISC End Inv Partial Lbs
     C           WCM0WG    ADD  WCM4WG    W0WA03           *Synon (15,2) w
     C           W0WA03    ADD  WCM1WG    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WCM2WG    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  WCM3WG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WCM5WG           ISC Ending Inv
      * Comp: sales prod qty
      * DB1.ISC Sales Production Qty =
      *    *COMPUTE (x2 + x1 - x3)
      * x2    : DB1.ISC Ending Inv Final Qty
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.ISC Shipment Final Qty
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.ISC Begin Inv Final Qty
     C           WCOTQT    ADD  WCOLQT    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WCOEQT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WCOIQT           ISC Sales Produ
      * Comp: sales prod lbs
      * DB1.ISC Sales Production Lbs =
      *    *COMPUTE (x2 + x1 - x3)
      * x2    : DB1.ISC Ending Inv Final Lbs
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.ISC Shipment Final Lbs
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.ISC Begin Inv Final Lbs
     C           WCM5WG    ADD  WCMWWG    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WCMQWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WCMTWG           ISC Sales Produ
      * Set PGM.*Record Data Changed flag
     C           QPPBS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BSCPA5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBSCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Exc Sales Hst Shp Bal RT - Sales History  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Billing Activit
     C                     MOVEL*BLANK    WN0002  2        Print on Realiz
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and comments
     C                     EXSR UASUBR                     ***** Change Lo
      * ***************************
     C                     MOVEL'Y'       YL0001           First Time Flag
     C                     MOVEL'N'       WUWXST           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WDGNDT           Actual Shipped
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
      * Setup key
     C                     Z-ADDP1B2C3    WQSD01           Company Number
     C                     Z-ADDP3JNDT    WDGNDT           Actual Shipped
      * Establish starting position
     C           KPSSD     SETLL@HSTPDF                    *
     C           KRSSD     READE@HSTPDF                  90*
      * Data record not found
     C   90                MOVEL'USR1241' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Actual Shipped Date GE PAR.From Date
      *   |- c2    : DB1.Actual Shipped Date LE PAR.To Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDGNDT    IFGE P3JNDT                     *IF
     C           WDGNDT    IFLE P2N6DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Item code or Whse break --  Calc FOB and write record
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Shipped Item Code NE LCL.USR Item Code
      *   |- c2    : DB1.Warehouse Code NE LCL.Warehouse Code
      *   '-
     C           WDS5NB    IFNE YL0002                     *IF
     C           WDAJCD    ORNE YL0003                     *OR
      * Update if not 1st time for the break
      * CASE: LCL.First Time Flag is NO
     C           YL0001    IFEQ 'N'                        *IF
      * CASE: LCL.Weight Billed is Not equal zero
     C           YL0004    IFNE 0                          *IF
      * Compute: FOB price/cwt
      * LCL.FOB Price/CWT =
      *    *COMPUTE ((x1/x2)/x3)
      * x1    : LCL.FOB Gross Amount
      * /     : PGM.*Synon (17,7) work field *
      * x2    : LCL.Weight Billed
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0005    DIV  YL0004    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0006           FOB Price_CWT
     C                     END                             *FI
      * R9083 05/09/17 DN-Added IVG as Input Parm.
      * Rtv Chg Shipmnt Final RT - Inventory Stock Closing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIDX    WL0077           ISC Week Ending
     C                     Z-ADDP1B2C3    WL0078           ISC Warehouse C
     C                     MOVELYL0003    WL0079    P      ISC Warehouse C
     C                     Z-ADDYL0002    WL0080           ISC Item Code
     C                     Z-ADDYL0007    WL0081           ISC Shipment Fi
     C                     Z-ADDYL0004    WL0082           ISC Shipment Fi
     C                     Z-ADDYL0005    WL0083           ISC FOB Gross A
     C                     Z-ADDYL0008    WL0084           ISC Commission
     C                     Z-ADDYL0009    WL0085           ISC TF Exempt N
     C                     Z-ADDYL0010    WL0086           ISC TF Exempt P
     C                     MOVELP1WCSX    WL0087    P      ISC Valuation G
     C                     EXSR SERVGN
     C                     END                             *FI
     C                     MOVEL'N'       YL0001           First Time Flag
     C                     Z-ADDWDS5NB    YL0002           USR Item Code
     C                     MOVELWDAJCD    YL0003           Warehouse Code
     C                     Z-ADDWDGNDT    YL0011           Actual Shipped
     C                     Z-ADDWDA5PR    YL0012           Commodity Marke
     C                     Z-ADD*ZERO     YL0005           FOB Gross Amoun
     C                     Z-ADD*ZERO     YL0008           ISC Commission
     C                     Z-ADD*ZERO     YL0010           ISC TF Exempt P
     C                     Z-ADD*ZERO     YL0009           ISC TF Exempt N
     C                     Z-ADD*ZERO     YL0004           Weight Billed
     C                     Z-ADD*ZERO     YL0007           Quantity Billed
     C                     MOVEL'N'       WUWXST           Record Found US
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * RTV Billing Type       RT - Order Types  * 
     C                     EXSR SJRVGN
      * RTV Print Realization  RT - Company/Item  * 
     C                     EXSR SKRVGN
      * Exclude CM/DM
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Billing Activity Type is Credit or Debit Memo
      *   |- c2    : PAR.USR Sales Realiz. Flag is None
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0001    IFEQ '2'                        *IF
     C           WN0001    OREQ '3'
     C           'N'       IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CM/DM Only
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.USR Sales Realiz. Flag is CM/DM Only
      *   |- c2    : PAR.Billing Activity Type is Invoice or Transfer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'N'       IFEQ 'O'                        *IF
     C           WN0001    IFEQ '1'                        *IF
     C           WN0001    OREQ '4'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Include All Products?
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.USR Active Flag is Record Not Found
      *   |- c2    : PAR.Print on Realization Rpt is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'Y'       IFEQ 'N'                        *IF
     C           WN0002    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Record Selected
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * FOB amount and weight
      * CASE: PAR.Billing Activity Type is Invoice
     C           WN0001    IFEQ '1'                        *IF
      * CASE: DB1.Affect Sales Doll Status is no
     C           WDANST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     YL0013           FOB Gross Amoun
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWDUSVA    YL0013           FOB Gross Amoun
     C                     END                             *FI
      * CASE: DB1.Affect Sales Pnds Status is no
     C           WDVAST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     YL0014           USR Weight Bill
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWDBYWG    YL0014           USR Weight Bill
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Credit or Debit Memo
      * CASE: PAR.USR Sales Realiz. Flag is Process by Flags
     C           'N'       IFEQ 'P'                        *IF
      * CASE: DB1.Affect Sales Doll Status is no
     C           WDANST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     YL0013           FOB Gross Amoun
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWDUSVA    YL0013           FOB Gross Amoun
     C                     END                             *FI
      * CASE: DB1.Affect Sales Pnds Status is no
     C           WDVAST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     YL0014           USR Weight Bill
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWDBYWG    YL0014           USR Weight Bill
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.USR Sales Realiz. Flag is All
      *   |- c2    : PAR.USR Sales Realiz. Flag is CM/DM Only
      *   '-
     C           'N'       IFEQ 'A'                        *IF
     C           'N'       OREQ 'O'                        *OR
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Affect Sales Doll Status is no
      *   |- c2    : DB1.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDANST    IFEQ 'N'                        *IF
     C           WDVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     YL0013           FOB Gross Amoun
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWDUSVA    YL0013           FOB Gross Amoun
     C                     END                             *FI
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Affect Sales Pnds Status is no
      *   |- c2    : DB1.Affect Sales Doll Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDVAST    IFEQ 'N'                        *IF
     C           WDANST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     YL0014           USR Weight Bill
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWDBYWG    YL0014           USR Weight Bill
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * reverse sign if credit memo and positive
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Billing Activity Type is Credit Memo
      *   |- c2    : LCL.USR Weight Billed 11.2  7 is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0001    IFEQ '2'                        *IF
     C           YL0014    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           *ZERO     SUB  YL0014    YL0014           USR Weight Bill
     C                     END                             *FI
     C                     ADD  YL0013    YL0005           FOB Gross Amoun
     C                     ADD  YL0014    YL0004           Weight Billed
     C                     ADD  WDEXQT    YL0007           Quantity Billed
     C                     ADD  WDUOVA    YL0008           ISC Commission
      * RMC 02/28/07 New -- Accum TF Exempt lbs and net$
      * CASE: DB1.Order TF Exempt Code is Not Exempt
     C           WDIUSX    IFEQ 'NE'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  YL0014    YL0010           ISC TF Exempt P
      * CASE: LCL.FOB Gross Amount      USR is Not Zero
     C           YL0013    IFNE 0                          *IF
      * Compute: TF Exempt NPR
      * LCL.ISC TF Exempt NPR $ =
      *    *COMPUTE (x1 + (x2-x3))
      * x1    : LCL.ISC TF Exempt NPR Dollars
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.FOB Gross Amount      USR
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.Commission Amount
     C           YL0013    SUB  WDUOVA    W0WA01           *Synon (15,2) w
     C           YL0009    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0009           ISC TF Exempt N
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@HSTPDF                  90*
     C                     ENDDO
      * USER: Exit processing
      * Last record
      * CASE: WRK.Record Found USR is Record Found
     C           WUWXST    IFEQ 'Y'                        *IF
      * CASE: LCL.First Time Flag is NO
     C           YL0001    IFEQ 'N'                        *IF
      * CASE: LCL.Weight Billed is Not equal zero
     C           YL0004    IFNE 0                          *IF
      * Compute: FOB price/cwt
      * LCL.FOB Price/CWT =
      *    *COMPUTE ((x1/x2)/x3)
      * x1    : LCL.FOB Gross Amount
      * /     : PGM.*Synon (17,7) work field *
      * x2    : LCL.Weight Billed
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0005    DIV  YL0004    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0006           FOB Price_CWT
     C                     END                             *FI
      * R9083 05/09/17 DN-Added IVG as Input Parm.
      * Rtv Chg Shipmnt Final RT - Inventory Stock Closing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIDX    WL0077           ISC Week Ending
     C                     Z-ADDP1B2C3    WL0078           ISC Warehouse C
     C                     MOVELYL0003    WL0079    P      ISC Warehouse C
     C                     Z-ADDYL0002    WL0080           ISC Item Code
     C                     Z-ADDYL0007    WL0081           ISC Shipment Fi
     C                     Z-ADDYL0004    WL0082           ISC Shipment Fi
     C                     Z-ADDYL0005    WL0083           ISC FOB Gross A
     C                     Z-ADDYL0008    WL0084           ISC Commission
     C                     Z-ADDYL0009    WL0085           ISC TF Exempt N
     C                     Z-ADDYL0010    WL0086           ISC TF Exempt P
     C                     MOVELP1WCSX    WL0087    P      ISC Valuation G
     C                     EXSR SERVGN
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Chg Shipmnt Final RT - Inventory Stock Closing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WBAIDX           ISC Week Ending
     C                     KFLD           WBB2C3           ISC Warehouse C
     C                     KFLD           WBGRAA           ISC Warehouse C
     C                     KFLD           WBEJC7           ISC Item Code
      * Setup key
     C                     Z-ADDWL0077    WBAIDX           ISC Week Ending
     C                     Z-ADDWL0078    WBB2C3           ISC Warehouse C
     C                     MOVELWL0079    WBGRAA           ISC Warehouse C
     C                     Z-ADDWL0080    WBEJC7           ISC Item Code
      * Establish starting position
     C           KRSSE     CHAIN@BSCPA6              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3529' W0RTN   7
      * USER: Processing if Data record not found
      * Rtv Inv Stock Closing RT - Item Default  * 
     C                     EXSR SFRVGN
      * Rtv Inv Stock Closing RT - Company Item  * 
     C                     EXSR SGRVGN
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SHRVGN
     C                     MOVEL'P'       WUWNSX           ISC Post Balanc
     C                     MOVEL'O'       WUWOSX           ISC Post Wareho
     C           *ZERO     SUB  WL0081    WUOQQT           ISC Unsh_Ship I
     C           *ZERO     SUB  WL0082    WUM2WG           ISC Unsh_Ship I
      * R9083 05/09/17 DN-Populate ISC Valuation Grouping.
      * Crt Inventory Stock   CR - Inventory Stock Closing  * 
     C                     EXSR SICRRC
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WL0083    ADD  WBFQVL    WUFQVL           ISC FOB Gross A
     C           WL0084    ADD  WBOUQT    WUOUQT           ISC Commission
     C           WL0086    ADD  WBM7WG    WUM7WG           ISC TF Exempt P
     C           WL0085    ADD  WBOVQT    WUOVQT           ISC TF Exempt N
     C           WL0082    ADD  WBMWWG    WUMWWG           ISC Shipment Fi
     C           WL0081    ADD  WBOLQT    WUOLQT           ISC Shipment Fi
     C           WBOKQT    SUB  WUOLQT    WUOQQT           ISC Unsh_Ship I
     C           WBMVWG    SUB  WUMWWG    WUM2WG           ISC Unsh_Ship I
      * Comp: sales prod qty
      * WRK.ISC Sales Production Qty =
      *    *COMPUTE (x2 + x1 - x3)
      * x2    : DB1.ISC Ending Inv Final Qty
      * +     : PGM.*Synon (15,2) work field
      * x1    : WRK.ISC Shipment Final Qty
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.ISC Begin Inv Final Qty
     C           WBOTQT    ADD  WUOLQT    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WBOEQT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUOIQT           ISC Sales Produ
      * Comp: sales prod lbs
      * WRK.ISC Sales Production Lbs =
      *    *COMPUTE (x2 + x1 - x3)
      * x2    : DB1.ISC Ending Inv Final Lbs
      * +     : PGM.*Synon (15,2) work field
      * x1    : WRK.ISC Shipment Final Lbs
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.ISC Begin Inv Final Lbs
     C           WBM5WG    ADD  WUMWWG    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WBMQWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUMTWG           ISC Sales Produ
      * CASE: DB1.ISC Post Balance Sts is Posted
     C           WBWNSX    IFEQ 'P'                        *IF
     C                     MOVEL'R'       WUWNSX           ISC Post Balanc
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'P'       WUWNSX           ISC Post Balanc
     C                     END                             *FI
      * Chg Inventory Stock   CH - Inventory Stock Closing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIDX    WL0001           ISC Week Ending
     C                     Z-ADDWBB2C3    WL0002           ISC Warehouse C
     C                     MOVELWBGRAA    WL0003    P      ISC Warehouse C
     C                     Z-ADDWBEJC7    WL0004           ISC Item Code
     C                     MOVELWBV8SX    WL0005    P      ISC Warehouse T
     C                     MOVELWBGPAA    WL0006    P      ISC Item Cmdty
     C                     MOVELWBGQAA    WL0007    P      ISC Item Dft Cm
     C                     MOVELWBW1SX    WL0008    P      ISC Item Type
     C                     Z-ADDWBF3PR    WL0009           ISC Item Market
     C                     Z-ADDWBBSNY    WL0010           ISC Item Struct
     C                     Z-ADDWBBTNY    WL0011           ISC Item Struct
     C                     Z-ADDWBBUNY    WL0012           ISC Item Struct
     C                     MOVELWBGSAA    WL0013    P      ISC Item GL Sub
     C                     MOVELWBGTAA    WL0014    P      ISC Item UOM Pr
     C                     Z-ADDWBOEQT    WL0015           ISC Begin Inv F
     C                     Z-ADDWBMQWG    WL0016           ISC Begin Inv F
     C                     Z-ADDWBOFQT    WL0017           ISC Begin Inv A
     C                     Z-ADDWBMRWG    WL0018           ISC Begin Inv A
     C                     Z-ADDWBOGQT    WL0019           ISC Begin Inv Q
     C                     Z-ADDWBMXWG    WL0020           ISC Begin Inv L
     C                     Z-ADDWBOHQT    WL0021           ISC Floor Produ
     C                     Z-ADDWBMSWG    WL0022           ISC Floor Produ
     C                     Z-ADDWBOWQT    WL0023           ISC Floor Prod
     C                     Z-ADDWBNAWG    WL0024           ISC Floor Prod
     C                     Z-ADDWUOIQT    WL0025           ISC Sales Produ
     C                     Z-ADDWUMTWG    WL0026           ISC Sales Produ
     C                     Z-ADDWBOJQT    WL0027           ISC Inventory S
     C                     Z-ADDWBMUWG    WL0028           ISC Inventory S
     C                     Z-ADDWBOKQT    WL0029           ISC Ord Dtl Shi
     C                     Z-ADDWBMVWG    WL0030           ISC Ord Dtl Shi
     C                     Z-ADDWUOLQT    WL0031           ISC Shipment Fi
     C                     Z-ADDWUMWWG    WL0032           ISC Shipment Fi
     C                     Z-ADDWUFQVL    WL0033           ISC FOB Gross A
     C                     Z-ADDWBOMQT    WL0034           ISC Inventory T
     C                     Z-ADDWBMYWG    WL0035           ISC Inventory T
     C                     Z-ADDWBONQT    WL0036           ISC Misc Invntr
     C                     Z-ADDWBMZWG    WL0037           ISC Misc Invntr
     C                     Z-ADDWBOOQT    WL0038           ISC Ending Inve
     C                     Z-ADDWBM0WG    WL0039           ISC Ending Inve
     C                     MOVELWBDGVN    WL0040    P      ISC End Inv Use
     C                     Z-ADDWBP9DT    WL0041           ISC End Inv Dat
     C                     Z-ADDWBCTTM    WL0042           ISC End Inv Tim
     C                     Z-ADDWBOPQT    WL0043           ISC Sun Ship In
     C                     Z-ADDWBM1WG    WL0044           ISC Sun Ship In
     C                     Z-ADDWUOQQT    WL0045           ISC Unsh_Ship I
     C                     Z-ADDWUM2WG    WL0046           ISC Unsh_Ship I
     C                     Z-ADDWBORQT    WL0047           ISC End Inv Par
     C                     Z-ADDWBM3WG    WL0048           ISC End Inv Par
     C                     Z-ADDWBOSQT    WL0049           ISC Ending Inv
     C                     Z-ADDWBM4WG    WL0050           ISC Ending Inv
     C                     MOVELWBRCNA    WL0051    P      ISC End Inv Adj
     C                     MOVELWBDFVN    WL0052    P      ISC Ending Inv
     C                     Z-ADDWBP8DT    WL0053           ISC Ending Inv
     C                     Z-ADDWBCSTM    WL0054           ISC Ending Inv
     C                     Z-ADDWBOTQT    WL0055           ISC Ending Inv
     C                     Z-ADDWBM5WG    WL0056           ISC Ending Inv
     C                     Z-ADDWBF4PR    WL0057           ISC Warehouse P
     C                     MOVELWBWBSX    WL0058    P      ISC Warehouse P
     C                     MOVELWUWNSX    WL0059    P      ISC Post Balanc
     C                     MOVELWBWOSX    WL0060    P      ISC Post Wareho
     C                     Z-ADDWUOUQT    WL0061           ISC Commission
     C                     Z-ADDWBM6WG    WL0062           ISC Unused Lbs
     C                     Z-ADDWUOVQT    WL0063           ISC TF Exempt N
     C                     Z-ADDWUM7WG    WL0064           ISC TF Exempt P
     C                     MOVELWBWCSX    WL0065    P      ISC Valuation G
     C                     Z-ADDWBQADT    WL0066           ISC Unused Date
     C                     MOVELWBWDSX    WL0067    P      ISC Unused Sts
     C                     MOVELWBVSST    WL0068    P      Record Status
     C                     Z-ADDWBMJDT    WL0069           Create Date
     C                     Z-ADDWBBETM    WL0070           Create Time
     C                     MOVELWBCCVN    WL0071    P      Create User
     C                     MOVELWBCDVN    WL0072    P      Create Program
     C                     Z-ADDWBMKDT    WL0073           Change Date
     C                     Z-ADDWBBFTM    WL0074           Change Time
     C                     MOVELWBCEVN    WL0075    P      Change User
     C                     MOVELWBCFVN    WL0076    P      Change Program
     C                     EXSR SCCHRC
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Inv Stock Closing RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0080    WEHGCD           Item Code
      * Establish starting position
     C           KRSSF     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEAVNA    WUAVNA           Description Lin
     C                     Z-ADDWERINB    WUBUNY           Item Structure
     C                     Z-ADDWERHNB    WUBTNY           Item Structure
     C                     Z-ADDWERGNB    WUBSNY           Item Structure
     C                     MOVELWELNCD    WUGQAA           Default Commod
     C                     MOVELWEN0CD    WUW1SX           Item Type Code
     C                     MOVELWELRCD    WUGPAA           Commodity Price
     C                     MOVELWESYCD    WUGSAA           GL Sub Code
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Inv Stock Closing RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0078    WFAIC3           Company Number
     C                     Z-ADDWL0080    WFHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUGTAA           UOM Pricing
     C                     Z-ADD*ZERO     WUF3PR           Market Overage
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAICD    WUGTAA           UOM Pricing
     C                     Z-ADDWFBLPR    WUF3PR           Market Overage
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0079    WGAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUV8SX           Warehouse Type
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGWPST    WUV8SX           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt Inventory Stock   CR - Inventory Stock Closing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BSCPA5
     C                     Z-ADDWL0077    WCAIDX           ISC Week Ending
     C                     Z-ADDWL0078    WCB2C3           ISC Warehouse C
     C                     MOVELWL0079    WCGRAA           ISC Warehouse C
     C                     Z-ADDWL0080    WCEJC7           ISC Item Code
     C                     MOVELWUV8SX    WCV8SX           ISC Warehouse T
     C                     MOVELWUGPAA    WCGPAA           ISC Item Cmdty
     C                     MOVELWUGQAA    WCGQAA           ISC Item Dft Cm
     C                     MOVELWUW1SX    WCW1SX           ISC Item Type
     C                     Z-ADDWUF3PR    WCF3PR           ISC Item Market
     C                     Z-ADDWUBSNY    WCBSNY           ISC Item Struct
     C                     Z-ADDWUBTNY    WCBTNY           ISC Item Struct
     C                     Z-ADDWUBUNY    WCBUNY           ISC Item Struct
     C                     MOVELWUGSAA    WCGSAA           ISC Item GL Sub
     C                     MOVELWUGTAA    WCGTAA           ISC Item UOM Pr
     C                     Z-ADD*ZERO     WCOEQT           ISC Begin Inv F
     C                     Z-ADD*ZERO     WCMQWG           ISC Begin Inv F
     C                     Z-ADD*ZERO     WCOFQT           ISC Begin Inv A
     C                     Z-ADD*ZERO     WCMRWG           ISC Begin Inv A
     C                     Z-ADD*ZERO     WCOGQT           ISC Begin Inv Q
     C                     Z-ADD*ZERO     WCMXWG           ISC Begin Inv L
     C                     Z-ADD*ZERO     WCOHQT           ISC Floor Produ
     C                     Z-ADD*ZERO     WCMSWG           ISC Floor Produ
     C                     Z-ADD*ZERO     WCOWQT           ISC Floor Prod
     C                     Z-ADD*ZERO     WCNAWG           ISC Floor Prod
     C                     Z-ADDWL0081    WCOIQT           ISC Sales Produ
     C                     Z-ADDWL0082    WCMTWG           ISC Sales Produ
     C                     Z-ADD*ZERO     WCOJQT           ISC Inventory S
     C                     Z-ADD*ZERO     WCMUWG           ISC Inventory S
     C                     Z-ADD*ZERO     WCOKQT           ISC Ord Dtl Shi
     C                     Z-ADD*ZERO     WCMVWG           ISC Ord Dtl Shi
     C                     Z-ADDWL0081    WCOLQT           ISC Shipment Fi
     C                     Z-ADDWL0082    WCMWWG           ISC Shipment Fi
     C                     Z-ADDWL0083    WCFQVL           ISC FOB Gross A
     C                     Z-ADD*ZERO     WCOMQT           ISC Inventory T
     C                     Z-ADD*ZERO     WCMYWG           ISC Inventory T
     C                     Z-ADD*ZERO     WCONQT           ISC Misc Invntr
     C                     Z-ADD*ZERO     WCMZWG           ISC Misc Invntr
     C                     Z-ADD*ZERO     WCOOQT           ISC Ending Inve
     C                     Z-ADD*ZERO     WCM0WG           ISC Ending Inve
     C                     MOVEL*BLANK    WCDGVN           ISC End Inv Use
     C                     Z-ADD*ZERO     WCP9DT           ISC End Inv Dat
     C                     Z-ADD*ZERO     WCCTTM           ISC End Inv Tim
     C                     Z-ADD*ZERO     WCOPQT           ISC Sun Ship In
     C                     Z-ADD*ZERO     WCM1WG           ISC Sun Ship In
     C                     Z-ADDWUOQQT    WCOQQT           ISC Unsh_Ship I
     C                     Z-ADDWUM2WG    WCM2WG           ISC Unsh_Ship I
     C                     Z-ADD*ZERO     WCORQT           ISC End Inv Par
     C                     Z-ADD*ZERO     WCM3WG           ISC End Inv Par
     C                     Z-ADD*ZERO     WCOSQT           ISC Ending Inv
     C                     Z-ADD*ZERO     WCM4WG           ISC Ending Inv
     C                     MOVEL*BLANK    WCRCNA           ISC End Inv Adj
     C                     MOVEL*BLANK    WCDFVN           ISC Ending Inv
     C                     Z-ADD*ZERO     WCP8DT           ISC Ending Inv
     C                     Z-ADD*ZERO     WCCSTM           ISC Ending Inv
     C                     Z-ADD*ZERO     WCOTQT           ISC Ending Inv
     C                     Z-ADD*ZERO     WCM5WG           ISC Ending Inv
     C                     Z-ADD*ZERO     WCF4PR           ISC Warehouse P
     C                     MOVELWUOTTX    WCWBSX           ISC Warehouse P
     C                     MOVELWUWNSX    WCWNSX           ISC Post Balanc
     C                     MOVELWUWOSX    WCWOSX           ISC Post Wareho
     C                     Z-ADDWL0084    WCOUQT           ISC Commission
     C                     Z-ADD*ZERO     WCM6WG           ISC Unused Lbs
     C                     Z-ADDWL0085    WCOVQT           ISC TF Exempt N
     C                     Z-ADDWL0086    WCM7WG           ISC TF Exempt P
     C                     MOVELWL0087    WCWCSX           ISC Valuation G
     C                     Z-ADD*ZERO     WCQADT           ISC Unused Date
     C                     MOVELWUWDSX    WCWDSX           ISC Unused Sts
     C                     MOVEL'A'       WCVSST           Record Status
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     MOVEL*BLANK    WCCCVN           Create User
     C                     MOVEL*BLANK    WCCDVN           Create Program
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
     C                     MOVEL*BLANK    WCCEVN           Change User
     C                     MOVEL*BLANK    WCCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WCVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WCMJDT           Create Date
     C                     Z-ADD##JTM     WCBETM           Create Time
     C                     MOVEL##USR     WCCCVN           Create User
     C                     MOVEL##PGM     WCCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
     C                     MOVEL*BLANK    WCCEVN           Change User
     C                     MOVEL*BLANK    WCCFVN           Change Program
      * Compute:Ending Inv Fin Qt
      * DB1.ISC End Inv Final Qty =
      *    *COMPUTE (x1 + x2 + x3 +x4 + x5)
      * x1    : DB1.ISC Ending Inventory Qty
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.ISC Ending Inv Adj Qty
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.ISC Sun Ship Inv Adj Qty
      * +     : PGM.*Synon (15,2) work field
      * x4    : DB1.ISC Unsh_Ship Inv Adj Qty
      * +     : PGM.*Synon (15,2) work field
      * x5    : DB1.ISC End Inv Partial Qty
     C           WCOOQT    ADD  WCOSQT    W0WA03           *Synon (15,2) w
     C           W0WA03    ADD  WCOPQT    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WCOQQT    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  WCORQT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WCOTQT           ISC Ending Inv
      * Compute:Ending Inv Fin Lb
      * DB1.ISC End Inv Final Lbs =
      *    *COMPUTE (x1 + x2 + x3 +x4 + x5)
      * x1    : DB1.ISC Ending Inventory Lbs
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.ISC Ending Inv Adj Lbs
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.ISC Sun Ship Inv Adj Lbs
      * +     : PGM.*Synon (15,2) work field
      * x4    : DB1.ISC Unsh_Ship Inv Adj Lbs
      * +     : PGM.*Synon (15,2) work field
      * x5    : DB1.ISC End Inv Partial Lbs
     C           WCM0WG    ADD  WCM4WG    W0WA03           *Synon (15,2) w
     C           W0WA03    ADD  WCM1WG    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WCM2WG    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  WCM3WG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WCM5WG           ISC Ending Inv
     C           KLCRSI    KLIST
     C                     KFLD           WCAIDX           ISC Week Ending
     C                     KFLD           WCB2C3           ISC Warehouse C
     C                     KFLD           WCGRAA           ISC Warehouse C
     C                     KFLD           WCEJC7           ISC Item Code
      * Check for duplicate primary key
     C           KLCRSI    SETLL@BSCPA5                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3530' W0RTN   7
      * Send message 'Inventory Stock Closin EX'
     C                     MOVEL'USR3530' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@BSCPA5                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Billing Type       RT - Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WHJNCD           Order Type_Sale
      * Setup key
     C                     MOVELWDJNCD    WHJNCD           Order Type_Sale
      * Establish starting position
     C           KRSSJ     CHAIN@EXRETY              90    *
      * Data record not found
     C   90                MOVEL'USR1063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHOBST    WN0001           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Print Realization  RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
      * Setup key
     C                     Z-ADDWDAIC3    WFAIC3           Company Number
     C                     Z-ADDWDS5NB    WFHGCD           Item Code
      * Establish starting position
     C           KRSSK     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WULNCD           Default Commod
     C                     MOVEL*BLANK    WN0002           Print on Realiz
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFLNCD    WULNCD           Default Commod
     C                     MOVELWFX6ST    WN0002           Print on Realiz
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Chg Post Sts      RT2 - Inventory Stock Closing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIDX    WQSL01           ISC Week Ending
     C           *LIKE     DEFN WBB2C3    WQSL02           ISC Warehouse C
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           ISC Week Ending
     C                     KFLD           WQSL02           ISC Warehouse C
      * Setup key
     C                     Z-ADDP1AIDX    WQSL01           ISC Week Ending
     C                     Z-ADDP1B2C3    WQSL02           ISC Warehouse C
      * Establish starting position
     C           KRSSL     SETLL@BSCPA6                    *
     C           KRSSL     READE@BSCPA6                  90*
      * Data record not found
     C   90                MOVEL'USR3529' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ISC Post Balance Sts is Open
     C           WBWNSX    IFEQ 'O'                        *IF
      * RMC 06/01/06 *note ..db1.isc shipment final will be -0-, still ne
      *    to calc the diff between order dtl shipped and sales hist ship
     C           WBOKQT    SUB  WBOLQT    WUOQQT           ISC Unsh_Ship I
     C           WBMVWG    SUB  WBMWWG    WUM2WG           ISC Unsh_Ship I
      * Comp: sales prod qty
      * WRK.ISC Sales Production Qty =
      *    *COMPUTE (x2 + x1 - x3)
      * x2    : DB1.ISC Ending Inv Final Qty
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.ISC Shipment Final Qty
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.ISC Begin Inv Final Qty
     C           WBOTQT    ADD  WBOLQT    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WBOEQT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUOIQT           ISC Sales Produ
      * Comp: sales prod lbs
      * WRK.ISC Sales Production Lbs =
      *    *COMPUTE (x2 + x1 - x3)
      * x2    : DB1.ISC Ending Inv Final Lbs
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.ISC Shipment Final Lbs
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.ISC Begin Inv Final Lbs
     C           WBM5WG    ADD  WBMWWG    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WBMQWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUMTWG           ISC Sales Produ
      * Chg Inventory Stock   CH - Inventory Stock Closing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIDX    WL0001           ISC Week Ending
     C                     Z-ADDWBB2C3    WL0002           ISC Warehouse C
     C                     MOVELWBGRAA    WL0003    P      ISC Warehouse C
     C                     Z-ADDWBEJC7    WL0004           ISC Item Code
     C                     MOVELWBV8SX    WL0005    P      ISC Warehouse T
     C                     MOVELWBGPAA    WL0006    P      ISC Item Cmdty
     C                     MOVELWBGQAA    WL0007    P      ISC Item Dft Cm
     C                     MOVELWBW1SX    WL0008    P      ISC Item Type
     C                     Z-ADDWBF3PR    WL0009           ISC Item Market
     C                     Z-ADDWBBSNY    WL0010           ISC Item Struct
     C                     Z-ADDWBBTNY    WL0011           ISC Item Struct
     C                     Z-ADDWBBUNY    WL0012           ISC Item Struct
     C                     MOVELWBGSAA    WL0013    P      ISC Item GL Sub
     C                     MOVELWBGTAA    WL0014    P      ISC Item UOM Pr
     C                     Z-ADDWBOEQT    WL0015           ISC Begin Inv F
     C                     Z-ADDWBMQWG    WL0016           ISC Begin Inv F
     C                     Z-ADDWBOFQT    WL0017           ISC Begin Inv A
     C                     Z-ADDWBMRWG    WL0018           ISC Begin Inv A
     C                     Z-ADDWBOGQT    WL0019           ISC Begin Inv Q
     C                     Z-ADDWBMXWG    WL0020           ISC Begin Inv L
     C                     Z-ADDWBOHQT    WL0021           ISC Floor Produ
     C                     Z-ADDWBMSWG    WL0022           ISC Floor Produ
     C                     Z-ADDWBOWQT    WL0023           ISC Floor Prod
     C                     Z-ADDWBNAWG    WL0024           ISC Floor Prod
     C                     Z-ADDWUOIQT    WL0025           ISC Sales Produ
     C                     Z-ADDWUMTWG    WL0026           ISC Sales Produ
     C                     Z-ADDWBOJQT    WL0027           ISC Inventory S
     C                     Z-ADDWBMUWG    WL0028           ISC Inventory S
     C                     Z-ADDWBOKQT    WL0029           ISC Ord Dtl Shi
     C                     Z-ADDWBMVWG    WL0030           ISC Ord Dtl Shi
     C                     Z-ADDWBOLQT    WL0031           ISC Shipment Fi
     C                     Z-ADDWBMWWG    WL0032           ISC Shipment Fi
     C                     Z-ADDWBFQVL    WL0033           ISC FOB Gross A
     C                     Z-ADDWBOMQT    WL0034           ISC Inventory T
     C                     Z-ADDWBMYWG    WL0035           ISC Inventory T
     C                     Z-ADDWBONQT    WL0036           ISC Misc Invntr
     C                     Z-ADDWBMZWG    WL0037           ISC Misc Invntr
     C                     Z-ADDWBOOQT    WL0038           ISC Ending Inve
     C                     Z-ADDWBM0WG    WL0039           ISC Ending Inve
     C                     MOVELWBDGVN    WL0040    P      ISC End Inv Use
     C                     Z-ADDWBP9DT    WL0041           ISC End Inv Dat
     C                     Z-ADDWBCTTM    WL0042           ISC End Inv Tim
     C                     Z-ADDWBOPQT    WL0043           ISC Sun Ship In
     C                     Z-ADDWBM1WG    WL0044           ISC Sun Ship In
     C                     Z-ADDWUOQQT    WL0045           ISC Unsh_Ship I
     C                     Z-ADDWUM2WG    WL0046           ISC Unsh_Ship I
     C                     Z-ADDWBORQT    WL0047           ISC End Inv Par
     C                     Z-ADDWBM3WG    WL0048           ISC End Inv Par
     C                     Z-ADDWBOSQT    WL0049           ISC Ending Inv
     C                     Z-ADDWBM4WG    WL0050           ISC Ending Inv
     C                     MOVELWBRCNA    WL0051    P      ISC End Inv Adj
     C                     MOVELWBDFVN    WL0052    P      ISC Ending Inv
     C                     Z-ADDWBP8DT    WL0053           ISC Ending Inv
     C                     Z-ADDWBCSTM    WL0054           ISC Ending Inv
     C                     Z-ADDWBOTQT    WL0055           ISC Ending Inv
     C                     Z-ADDWBM5WG    WL0056           ISC Ending Inv
     C                     Z-ADDWBF4PR    WL0057           ISC Warehouse P
     C                     MOVELWBWBSX    WL0058    P      ISC Warehouse P
     C                     MOVEL'P'       WL0059    P      ISC Post Balanc
     C                     MOVELWBWOSX    WL0060    P      ISC Post Wareho
     C                     Z-ADDWBOUQT    WL0061           ISC Commission
     C                     Z-ADDWBM6WG    WL0062           ISC Unused Lbs
     C                     Z-ADDWBOVQT    WL0063           ISC TF Exempt N
     C                     Z-ADDWBM7WG    WL0064           ISC TF Exempt P
     C                     MOVELWBWCSX    WL0065    P      ISC Valuation G
     C                     Z-ADDWBQADT    WL0066           ISC Unused Date
     C                     MOVELWBWDSX    WL0067    P      ISC Unused Sts
     C                     MOVELWBVSST    WL0068    P      Record Status
     C                     Z-ADDWBMJDT    WL0069           Create Date
     C                     Z-ADDWBBETM    WL0070           Create Time
     C                     MOVELWBCCVN    WL0071    P      Create User
     C                     MOVELWBCDVN    WL0072    P      Create Program
     C                     Z-ADDWBMKDT    WL0073           Change Date
     C                     Z-ADDWBBFTM    WL0074           Change Time
     C                     MOVELWBCEVN    WL0075    P      Change User
     C                     MOVELWBCFVN    WL0076    P      Change Program
     C                     EXSR SCCHRC
     C                     ELSE
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.ISC Post Balance Sts is Posted
      *   |- c2    : DB1.ISC Post Balance Sts is Repost
      *   '-
     C           WBWNSX    IFEQ 'P'                        *IF
     C           WBWNSX    OREQ 'R'                        *OR
      * RMC 7/21/16  Do for repost too incase they do it multiple times
     C           WBOKQT    SUB  WBOLQT    WUOQQT           ISC Unsh_Ship I
     C           WBMVWG    SUB  WBMWWG    WUM2WG           ISC Unsh_Ship I
      * Comp: sales prod qty
      * WRK.ISC Sales Production Qty =
      *    *COMPUTE (x2 + x1 - x3)
      * x2    : DB1.ISC Ending Inv Final Qty
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.ISC Shipment Final Qty
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.ISC Begin Inv Final Qty
     C           WBOTQT    ADD  WBOLQT    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WBOEQT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUOIQT           ISC Sales Produ
      * Comp: sales prod lbs
      * WRK.ISC Sales Production Lbs =
      *    *COMPUTE (x2 + x1 - x3)
      * x2    : DB1.ISC Ending Inv Final Lbs
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.ISC Shipment Final Lbs
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.ISC Begin Inv Final Lbs
     C           WBM5WG    ADD  WBMWWG    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WBMQWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUMTWG           ISC Sales Produ
      * Chg Inventory Stock   CH - Inventory Stock Closing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIDX    WL0001           ISC Week Ending
     C                     Z-ADDWBB2C3    WL0002           ISC Warehouse C
     C                     MOVELWBGRAA    WL0003    P      ISC Warehouse C
     C                     Z-ADDWBEJC7    WL0004           ISC Item Code
     C                     MOVELWBV8SX    WL0005    P      ISC Warehouse T
     C                     MOVELWBGPAA    WL0006    P      ISC Item Cmdty
     C                     MOVELWBGQAA    WL0007    P      ISC Item Dft Cm
     C                     MOVELWBW1SX    WL0008    P      ISC Item Type
     C                     Z-ADDWBF3PR    WL0009           ISC Item Market
     C                     Z-ADDWBBSNY    WL0010           ISC Item Struct
     C                     Z-ADDWBBTNY    WL0011           ISC Item Struct
     C                     Z-ADDWBBUNY    WL0012           ISC Item Struct
     C                     MOVELWBGSAA    WL0013    P      ISC Item GL Sub
     C                     MOVELWBGTAA    WL0014    P      ISC Item UOM Pr
     C                     Z-ADDWBOEQT    WL0015           ISC Begin Inv F
     C                     Z-ADDWBMQWG    WL0016           ISC Begin Inv F
     C                     Z-ADDWBOFQT    WL0017           ISC Begin Inv A
     C                     Z-ADDWBMRWG    WL0018           ISC Begin Inv A
     C                     Z-ADDWBOGQT    WL0019           ISC Begin Inv Q
     C                     Z-ADDWBMXWG    WL0020           ISC Begin Inv L
     C                     Z-ADDWBOHQT    WL0021           ISC Floor Produ
     C                     Z-ADDWBMSWG    WL0022           ISC Floor Produ
     C                     Z-ADDWBOWQT    WL0023           ISC Floor Prod
     C                     Z-ADDWBNAWG    WL0024           ISC Floor Prod
     C                     Z-ADDWUOIQT    WL0025           ISC Sales Produ
     C                     Z-ADDWUMTWG    WL0026           ISC Sales Produ
     C                     Z-ADDWBOJQT    WL0027           ISC Inventory S
     C                     Z-ADDWBMUWG    WL0028           ISC Inventory S
     C                     Z-ADDWBOKQT    WL0029           ISC Ord Dtl Shi
     C                     Z-ADDWBMVWG    WL0030           ISC Ord Dtl Shi
     C                     Z-ADDWBOLQT    WL0031           ISC Shipment Fi
     C                     Z-ADDWBMWWG    WL0032           ISC Shipment Fi
     C                     Z-ADDWBFQVL    WL0033           ISC FOB Gross A
     C                     Z-ADDWBOMQT    WL0034           ISC Inventory T
     C                     Z-ADDWBMYWG    WL0035           ISC Inventory T
     C                     Z-ADDWBONQT    WL0036           ISC Misc Invntr
     C                     Z-ADDWBMZWG    WL0037           ISC Misc Invntr
     C                     Z-ADDWBOOQT    WL0038           ISC Ending Inve
     C                     Z-ADDWBM0WG    WL0039           ISC Ending Inve
     C                     MOVELWBDGVN    WL0040    P      ISC End Inv Use
     C                     Z-ADDWBP9DT    WL0041           ISC End Inv Dat
     C                     Z-ADDWBCTTM    WL0042           ISC End Inv Tim
     C                     Z-ADDWBOPQT    WL0043           ISC Sun Ship In
     C                     Z-ADDWBM1WG    WL0044           ISC Sun Ship In
     C                     Z-ADDWUOQQT    WL0045           ISC Unsh_Ship I
     C                     Z-ADDWUM2WG    WL0046           ISC Unsh_Ship I
     C                     Z-ADDWBORQT    WL0047           ISC End Inv Par
     C                     Z-ADDWBM3WG    WL0048           ISC End Inv Par
     C                     Z-ADDWBOSQT    WL0049           ISC Ending Inv
     C                     Z-ADDWBM4WG    WL0050           ISC Ending Inv
     C                     MOVELWBRCNA    WL0051    P      ISC End Inv Adj
     C                     MOVELWBDFVN    WL0052    P      ISC Ending Inv
     C                     Z-ADDWBP8DT    WL0053           ISC Ending Inv
     C                     Z-ADDWBCSTM    WL0054           ISC Ending Inv
     C                     Z-ADDWBOTQT    WL0055           ISC Ending Inv
     C                     Z-ADDWBM5WG    WL0056           ISC Ending Inv
     C                     Z-ADDWBF4PR    WL0057           ISC Warehouse P
     C                     MOVELWBWBSX    WL0058    P      ISC Warehouse P
     C                     MOVELWBWNSX    WL0059    P      ISC Post Balanc
     C                     MOVELWBWOSX    WL0060    P      ISC Post Wareho
     C                     Z-ADDWBOUQT    WL0061           ISC Commission
     C                     Z-ADDWBM6WG    WL0062           ISC Unused Lbs
     C                     Z-ADDWBOVQT    WL0063           ISC TF Exempt N
     C                     Z-ADDWBM7WG    WL0064           ISC TF Exempt P
     C                     MOVELWBWCSX    WL0065    P      ISC Valuation G
     C                     Z-ADDWBQADT    WL0066           ISC Unused Date
     C                     MOVELWBWDSX    WL0067    P      ISC Unused Sts
     C                     MOVELWBVSST    WL0068    P      Record Status
     C                     Z-ADDWBMJDT    WL0069           Create Date
     C                     Z-ADDWBBETM    WL0070           Create Time
     C                     MOVELWBCCVN    WL0071    P      Create User
     C                     MOVELWBCDVN    WL0072    P      Create Program
     C                     Z-ADDWBMKDT    WL0073           Change Date
     C                     Z-ADDWBBFTM    WL0074           Change Time
     C                     MOVELWBCEVN    WL0075    P      Change User
     C                     MOVELWBCFVN    WL0076    P      Change Program
     C                     EXSR SCCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@BSCPA6                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Chg Post WarehouseSts - Inventory Stock Closing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIWCSX    WQSM01           ISC Valuation G
     C           *LIKE     DEFN WIAIDX    WQSM02           ISC Week Ending
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           ISC Valuation G
     C                     KFLD           WQSM02           ISC Week Ending
      * Setup key
     C                     MOVELP1WCSX    WQSM01           ISC Valuation G
     C                     Z-ADDP1AIDX    WQSM02           ISC Week Ending
      * Establish starting position
     C           KRSSM     SETLL@BSCPBC                    *
     C           KRSSM     READE@BSCPBC                  90*
      * Data record not found
     C   90                MOVEL'USR3529' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ISC Post Warehouse Sts is Open
     C           WIWOSX    IFEQ 'O'                        *IF
      * Chg Inventory Stock   CH - Inventory Stock Closing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWIAIDX    WL0001           ISC Week Ending
     C                     Z-ADDWIB2C3    WL0002           ISC Warehouse C
     C                     MOVELWIGRAA    WL0003    P      ISC Warehouse C
     C                     Z-ADDWIEJC7    WL0004           ISC Item Code
     C                     MOVELWIV8SX    WL0005    P      ISC Warehouse T
     C                     MOVELWIGPAA    WL0006    P      ISC Item Cmdty
     C                     MOVELWIGQAA    WL0007    P      ISC Item Dft Cm
     C                     MOVELWIW1SX    WL0008    P      ISC Item Type
     C                     Z-ADDWIF3PR    WL0009           ISC Item Market
     C                     Z-ADDWIBSNY    WL0010           ISC Item Struct
     C                     Z-ADDWIBTNY    WL0011           ISC Item Struct
     C                     Z-ADDWIBUNY    WL0012           ISC Item Struct
     C                     MOVELWIGSAA    WL0013    P      ISC Item GL Sub
     C                     MOVELWIGTAA    WL0014    P      ISC Item UOM Pr
     C                     Z-ADDWIOEQT    WL0015           ISC Begin Inv F
     C                     Z-ADDWIMQWG    WL0016           ISC Begin Inv F
     C                     Z-ADDWIOFQT    WL0017           ISC Begin Inv A
     C                     Z-ADDWIMRWG    WL0018           ISC Begin Inv A
     C                     Z-ADDWIOGQT    WL0019           ISC Begin Inv Q
     C                     Z-ADDWIMXWG    WL0020           ISC Begin Inv L
     C                     Z-ADDWIOHQT    WL0021           ISC Floor Produ
     C                     Z-ADDWIMSWG    WL0022           ISC Floor Produ
     C                     Z-ADDWIOWQT    WL0023           ISC Floor Prod
     C                     Z-ADDWINAWG    WL0024           ISC Floor Prod
     C                     Z-ADDWIOIQT    WL0025           ISC Sales Produ
     C                     Z-ADDWIMTWG    WL0026           ISC Sales Produ
     C                     Z-ADDWIOJQT    WL0027           ISC Inventory S
     C                     Z-ADDWIMUWG    WL0028           ISC Inventory S
     C                     Z-ADDWIOKQT    WL0029           ISC Ord Dtl Shi
     C                     Z-ADDWIMVWG    WL0030           ISC Ord Dtl Shi
     C                     Z-ADDWIOLQT    WL0031           ISC Shipment Fi
     C                     Z-ADDWIMWWG    WL0032           ISC Shipment Fi
     C                     Z-ADDWIFQVL    WL0033           ISC FOB Gross A
     C                     Z-ADDWIOMQT    WL0034           ISC Inventory T
     C                     Z-ADDWIMYWG    WL0035           ISC Inventory T
     C                     Z-ADDWIONQT    WL0036           ISC Misc Invntr
     C                     Z-ADDWIMZWG    WL0037           ISC Misc Invntr
     C                     Z-ADDWIOOQT    WL0038           ISC Ending Inve
     C                     Z-ADDWIM0WG    WL0039           ISC Ending Inve
     C                     MOVELWIDGVN    WL0040    P      ISC End Inv Use
     C                     Z-ADDWIP9DT    WL0041           ISC End Inv Dat
     C                     Z-ADDWICTTM    WL0042           ISC End Inv Tim
     C                     Z-ADDWIOPQT    WL0043           ISC Sun Ship In
     C                     Z-ADDWIM1WG    WL0044           ISC Sun Ship In
     C                     Z-ADDWIOQQT    WL0045           ISC Unsh_Ship I
     C                     Z-ADDWIM2WG    WL0046           ISC Unsh_Ship I
     C                     Z-ADDWIORQT    WL0047           ISC End Inv Par
     C                     Z-ADDWIM3WG    WL0048           ISC End Inv Par
     C                     Z-ADDWIOSQT    WL0049           ISC Ending Inv
     C                     Z-ADDWIM4WG    WL0050           ISC Ending Inv
     C                     MOVELWIRCNA    WL0051    P      ISC End Inv Adj
     C                     MOVELWIDFVN    WL0052    P      ISC Ending Inv
     C                     Z-ADDWIP8DT    WL0053           ISC Ending Inv
     C                     Z-ADDWICSTM    WL0054           ISC Ending Inv
     C                     Z-ADDWIOTQT    WL0055           ISC Ending Inv
     C                     Z-ADDWIM5WG    WL0056           ISC Ending Inv
     C                     Z-ADDWIF4PR    WL0057           ISC Warehouse P
     C                     MOVELWIWBSX    WL0058    P      ISC Warehouse P
     C                     MOVELWIWNSX    WL0059    P      ISC Post Balanc
     C                     MOVEL'P'       WL0060    P      ISC Post Wareho
     C                     Z-ADDWIOUQT    WL0061           ISC Commission
     C                     Z-ADDWIM6WG    WL0062           ISC Unused Lbs
     C                     Z-ADDWIOVQT    WL0063           ISC TF Exempt N
     C                     Z-ADDWIM7WG    WL0064           ISC TF Exempt P
     C                     MOVELWIWCSX    WL0065    P      ISC Valuation G
     C                     Z-ADDWIQADT    WL0066           ISC Unused Date
     C                     MOVELWIWDSX    WL0067    P      ISC Unused Sts
     C                     MOVELWIVSST    WL0068    P      Record Status
     C                     Z-ADDWIMJDT    WL0069           Create Date
     C                     Z-ADDWIBETM    WL0070           Create Time
     C                     MOVELWICCVN    WL0071    P      Create User
     C                     MOVELWICDVN    WL0072    P      Create Program
     C                     Z-ADDWIMKDT    WL0073           Change Date
     C                     Z-ADDWIBFTM    WL0074           Change Time
     C                     MOVELWICEVN    WL0075    P      Change User
     C                     MOVELWICFVN    WL0076    P      Change Program
     C                     EXSR SCCHRC
     C                     ELSE
      * CASE: DB1.ISC Post Warehouse Sts is Posted or Reposted
     C           WIWOSX    IFEQ 'P'                        *IF
     C           WIWOSX    OREQ 'R'
      * Chg Inventory Stock   CH - Inventory Stock Closing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWIAIDX    WL0001           ISC Week Ending
     C                     Z-ADDWIB2C3    WL0002           ISC Warehouse C
     C                     MOVELWIGRAA    WL0003    P      ISC Warehouse C
     C                     Z-ADDWIEJC7    WL0004           ISC Item Code
     C                     MOVELWIV8SX    WL0005    P      ISC Warehouse T
     C                     MOVELWIGPAA    WL0006    P      ISC Item Cmdty
     C                     MOVELWIGQAA    WL0007    P      ISC Item Dft Cm
     C                     MOVELWIW1SX    WL0008    P      ISC Item Type
     C                     Z-ADDWIF3PR    WL0009           ISC Item Market
     C                     Z-ADDWIBSNY    WL0010           ISC Item Struct
     C                     Z-ADDWIBTNY    WL0011           ISC Item Struct
     C                     Z-ADDWIBUNY    WL0012           ISC Item Struct
     C                     MOVELWIGSAA    WL0013    P      ISC Item GL Sub
     C                     MOVELWIGTAA    WL0014    P      ISC Item UOM Pr
     C                     Z-ADDWIOEQT    WL0015           ISC Begin Inv F
     C                     Z-ADDWIMQWG    WL0016           ISC Begin Inv F
     C                     Z-ADDWIOFQT    WL0017           ISC Begin Inv A
     C                     Z-ADDWIMRWG    WL0018           ISC Begin Inv A
     C                     Z-ADDWIOGQT    WL0019           ISC Begin Inv Q
     C                     Z-ADDWIMXWG    WL0020           ISC Begin Inv L
     C                     Z-ADDWIOHQT    WL0021           ISC Floor Produ
     C                     Z-ADDWIMSWG    WL0022           ISC Floor Produ
     C                     Z-ADDWIOWQT    WL0023           ISC Floor Prod
     C                     Z-ADDWINAWG    WL0024           ISC Floor Prod
     C                     Z-ADDWIOIQT    WL0025           ISC Sales Produ
     C                     Z-ADDWIMTWG    WL0026           ISC Sales Produ
     C                     Z-ADDWIOJQT    WL0027           ISC Inventory S
     C                     Z-ADDWIMUWG    WL0028           ISC Inventory S
     C                     Z-ADDWIOKQT    WL0029           ISC Ord Dtl Shi
     C                     Z-ADDWIMVWG    WL0030           ISC Ord Dtl Shi
     C                     Z-ADDWIOLQT    WL0031           ISC Shipment Fi
     C                     Z-ADDWIMWWG    WL0032           ISC Shipment Fi
     C                     Z-ADDWIFQVL    WL0033           ISC FOB Gross A
     C                     Z-ADDWIOMQT    WL0034           ISC Inventory T
     C                     Z-ADDWIMYWG    WL0035           ISC Inventory T
     C                     Z-ADDWIONQT    WL0036           ISC Misc Invntr
     C                     Z-ADDWIMZWG    WL0037           ISC Misc Invntr
     C                     Z-ADDWIOOQT    WL0038           ISC Ending Inve
     C                     Z-ADDWIM0WG    WL0039           ISC Ending Inve
     C                     MOVELWIDGVN    WL0040    P      ISC End Inv Use
     C                     Z-ADDWIP9DT    WL0041           ISC End Inv Dat
     C                     Z-ADDWICTTM    WL0042           ISC End Inv Tim
     C                     Z-ADDWIOPQT    WL0043           ISC Sun Ship In
     C                     Z-ADDWIM1WG    WL0044           ISC Sun Ship In
     C                     Z-ADDWIOQQT    WL0045           ISC Unsh_Ship I
     C                     Z-ADDWIM2WG    WL0046           ISC Unsh_Ship I
     C                     Z-ADDWIORQT    WL0047           ISC End Inv Par
     C                     Z-ADDWIM3WG    WL0048           ISC End Inv Par
     C                     Z-ADDWIOSQT    WL0049           ISC Ending Inv
     C                     Z-ADDWIM4WG    WL0050           ISC Ending Inv
     C                     MOVELWIRCNA    WL0051    P      ISC End Inv Adj
     C                     MOVELWIDFVN    WL0052    P      ISC Ending Inv
     C                     Z-ADDWIP8DT    WL0053           ISC Ending Inv
     C                     Z-ADDWICSTM    WL0054           ISC Ending Inv
     C                     Z-ADDWIOTQT    WL0055           ISC Ending Inv
     C                     Z-ADDWIM5WG    WL0056           ISC Ending Inv
     C                     Z-ADDWIF4PR    WL0057           ISC Warehouse P
     C                     MOVELWIWBSX    WL0058    P      ISC Warehouse P
     C                     MOVELWIWNSX    WL0059    P      ISC Post Balanc
     C                     MOVEL'R'       WL0060    P      ISC Post Wareho
     C                     Z-ADDWIOUQT    WL0061           ISC Commission
     C                     Z-ADDWIM6WG    WL0062           ISC Unused Lbs
     C                     Z-ADDWIOVQT    WL0063           ISC TF Exempt N
     C                     Z-ADDWIM7WG    WL0064           ISC TF Exempt P
     C                     MOVELWIWCSX    WL0065    P      ISC Valuation G
     C                     Z-ADDWIQADT    WL0066           ISC Unused Date
     C                     MOVELWIWDSX    WL0067    P      ISC Unused Sts
     C                     MOVELWIVSST    WL0068    P      Record Status
     C                     Z-ADDWIMJDT    WL0069           Create Date
     C                     Z-ADDWIBETM    WL0070           Create Time
     C                     MOVELWICCVN    WL0071    P      Create User
     C                     MOVELWICDVN    WL0072    P      Create Program
     C                     Z-ADDWIMKDT    WL0073           Change Date
     C                     Z-ADDWIBFTM    WL0074           Change Time
     C                     MOVELWICEVN    WL0075    P      Change User
     C                     MOVELWICFVN    WL0076    P      Change Program
     C                     EXSR SCCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSM     READE@BSCPBC                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WJAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0003    WJAJVN           User Profile Na
      * Establish starting position
     C           KRSSN     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJAIC3    YL0016           Company Number
     C                     MOVELWJBUVN    WN0004           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WKAJVN           User Profile Na
     C                     KFLD           WKDNCD           Application Cod
      * Setup key
     C                     MOVELWL0088    WKAJVN           User Profile Na
     C                     MOVELWL0089    WKDNCD           Application Cod
      * Establish starting position
     C           KRSSO     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKAIC3    WL0090           Company Number
     C                     MOVELWKAJCD    WL0091           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Prod Whse for Co  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLBWC3    WQSP01           Shipping Compan
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Shipping Compan
      * Setup key
     C                     Z-ADDYL0018    WQSP01           Shipping Compan
      * Establish starting position
     C           KRSSP     SETLL@ADREWA                    *
     C           KRSSP     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WLVSST    IFEQ 'A'                        *IF
      * CASE: DB1.Production Warehouse Code is Warehouse Code not Blank
     C           WLAOCD    IFNE *BLANK                     *IF
     C                     MOVELWLAOCD    YN0001           Warehouse Code
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSP     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WMAIC3           Company Number
      * Setup key
     C                     Z-ADDWUAIC3    WMAIC3           Company Number
      * Establish starting position
     C           KRSSQ     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WODNCD    WQSR01           Application Cod
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSR01           Application Cod
     C                     MOVEL'I/C'     WQSR01           Application Cod
      * Establish starting position
     C           KRSSR     SETLL@DNRESF                    *
     C           KRSSR     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WORSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWOAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
     C           KRSSR     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WODNCD    WQSS01           Application Cod
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Application Cod
      * Setup key
     C                     MOVELWORSCD    WQSS01           Application Cod
      * Establish starting position
     C           KRSSS     SETLL@DNRESF                    *
     C           KRSSS     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWOAUNA    WUAUNA           Description
     C           KRSSS     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRV8CD           Company Value C
      * Setup key
     C                     Z-ADDYL0015    WRAIC3           Company Number
     C                     MOVEL@CN,002   WRV8CD           Company Value C
      * Establish starting position
     C           KRSST     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRBXTX    WUCLAA           System Value Al
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and comments
      *================================================================
      * RMC E2247 11/05/12  Employee Meat Sales were never excl, and they
      *   and have been non-exempt, so we are going to remove this code c
      *    the Empl meat sale flg here.
      * INV010 - Using the specs from the Bld Sls Hist Dwnld, update the
      *   Inventory Stock Closing file: shipments qty, lbs, fob amt, and
      * LJB E00350 02/26/2009  Exclude Employee Meat Sales from the calcs
      * RMC 02/28/07 Accum TF Exempt Lbs,Net & output to ISC fields
      * RMC 12/19/06 Accum Commission Amount to output to ISC Commission
      * RMC 1/12/06  Dont add SBD Accrual back into Fob Gross. The origin
      *   FOB Gross Calc has been changed in PDRGXFR to include the SBD A
      * RMC 1/09/06  Added SBD ACcrual back into Fob Gross
      * RMC 1/6/6 Added Company as input/restrict to LF
      * RMC 1/5/6 Add SBD Marketing Accrual back into Fob Gross Amt
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XDV82T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDI8DD    XDEX02           DD
     C                     Z-ADDXDI8MM    XDEX03           MM
     C                     Z-ADDXDI8YY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDI8MM    XDEX02           MM
     C                     Z-ADDXDI8DD    XDEX03           DD
     C                     Z-ADDXDI8YY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDI8YY    XDEX02           YY
     C                     Z-ADDXDI8MM    XDEX03           MM
     C                     Z-ADDXDI8DD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDV82E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3JNDT           Date Sun USR
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABCDT           Post to G_L Dat
     C                     Z-ADD*ZERO     WACQNB           Julian Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEINB           Week Number
     C                     Z-ADD*ZERO     WAAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WAOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WANQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WANRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WAOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WAOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIDX           ISC Week Ending
     C                     Z-ADD*ZERO     WBB2C3           ISC Warehouse C
     C                     Z-ADD*ZERO     WBEJC7           ISC Item Code
     C                     Z-ADD*ZERO     WBF3PR           ISC Item Market
     C                     Z-ADD*ZERO     WBBSNY           ISC Item Struct
     C                     Z-ADD*ZERO     WBBTNY           ISC Item Struct
     C                     Z-ADD*ZERO     WBBUNY           ISC Item Struct
     C                     Z-ADD*ZERO     WBOEQT           ISC Begin Inv F
     C                     Z-ADD*ZERO     WBMQWG           ISC Begin Inv F
     C                     Z-ADD*ZERO     WBOFQT           ISC Begin Inv A
     C                     Z-ADD*ZERO     WBMRWG           ISC Begin Inv A
     C                     Z-ADD*ZERO     WBOGQT           ISC Begin Inv Q
     C                     Z-ADD*ZERO     WBMXWG           ISC Begin Inv L
     C                     Z-ADD*ZERO     WBOHQT           ISC Floor Produ
     C                     Z-ADD*ZERO     WBMSWG           ISC Floor Produ
     C                     Z-ADD*ZERO     WBOWQT           ISC Floor Prod
     C                     Z-ADD*ZERO     WBNAWG           ISC Floor Prod
     C                     Z-ADD*ZERO     WBOIQT           ISC Sales Produ
     C                     Z-ADD*ZERO     WBMTWG           ISC Sales Produ
     C                     Z-ADD*ZERO     WBOJQT           ISC Inventory S
     C                     Z-ADD*ZERO     WBMUWG           ISC Inventory S
     C                     Z-ADD*ZERO     WBOKQT           ISC Ord Dtl Shi
     C                     Z-ADD*ZERO     WBMVWG           ISC Ord Dtl Shi
     C                     Z-ADD*ZERO     WBOLQT           ISC Shipment Fi
     C                     Z-ADD*ZERO     WBMWWG           ISC Shipment Fi
     C                     Z-ADD*ZERO     WBFQVL           ISC FOB Gross A
     C                     Z-ADD*ZERO     WBOMQT           ISC Inventory T
     C                     Z-ADD*ZERO     WBMYWG           ISC Inventory T
     C                     Z-ADD*ZERO     WBONQT           ISC Misc Invntr
     C                     Z-ADD*ZERO     WBMZWG           ISC Misc Invntr
     C                     Z-ADD*ZERO     WBOOQT           ISC Ending Inve
     C                     Z-ADD*ZERO     WBM0WG           ISC Ending Inve
     C                     Z-ADD*ZERO     WBP9DT           ISC End Inv Dat
     C                     Z-ADD*ZERO     WBCTTM           ISC End Inv Tim
     C                     Z-ADD*ZERO     WBOPQT           ISC Sun Ship In
     C                     Z-ADD*ZERO     WBM1WG           ISC Sun Ship In
     C                     Z-ADD*ZERO     WBOQQT           ISC Unsh_Ship I
     C                     Z-ADD*ZERO     WBM2WG           ISC Unsh_Ship I
     C                     Z-ADD*ZERO     WBORQT           ISC End Inv Par
     C                     Z-ADD*ZERO     WBM3WG           ISC End Inv Par
     C                     Z-ADD*ZERO     WBOSQT           ISC Ending Inv
     C                     Z-ADD*ZERO     WBM4WG           ISC Ending Inv
     C                     Z-ADD*ZERO     WBP8DT           ISC Ending Inv
     C                     Z-ADD*ZERO     WBCSTM           ISC Ending Inv
     C                     Z-ADD*ZERO     WBOTQT           ISC Ending Inv
     C                     Z-ADD*ZERO     WBM5WG           ISC Ending Inv
     C                     Z-ADD*ZERO     WBF4PR           ISC Warehouse P
     C                     Z-ADD*ZERO     WBOUQT           ISC Commission
     C                     Z-ADD*ZERO     WBM6WG           ISC Unused Lbs
     C                     Z-ADD*ZERO     WBOVQT           ISC TF Exempt N
     C                     Z-ADD*ZERO     WBM7WG           ISC TF Exempt P
     C                     Z-ADD*ZERO     WBQADT           ISC Unused Date
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDBTC7           Parent Customer
     C                     Z-ADD*ZERO     WDANC7           AR Customer Num
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDORIT           Original Item
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WDESNB           Accounting Year
     C                     Z-ADD*ZERO     WDETNB           Accounting Peri
     C                     Z-ADD*ZERO     WDBZNB           OM Week
     C                     Z-ADD*ZERO     WDEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WDBYWG           Weight Billed
     C                     Z-ADD*ZERO     WDS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WDUTVA           Standard Overag
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDCKNB           GL Document Num
     C                     Z-ADD*ZERO     WDR8NB           Shipping Compan
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WDSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WDSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WDONVA           Actual Freight
     C                     Z-ADD*ZERO     WDB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WDB5NB           PM Line Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WDUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WDUOVA           Commission Amou
     C                     Z-ADD*ZERO     WDUPVA           Financials Amou
     C                     Z-ADD*ZERO     WDUQVA           Financials Amou
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WDIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WDNYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WDBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WDZ4NB           MPC Number
     C                     Z-ADD*ZERO     WDOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WDCDPR           Market Value
     C                     Z-ADD*ZERO     WDD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WDD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WDCEVL           Sales Expense T
     C                     Z-ADD*ZERO     WDOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WDD9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WDCFVL           HST Item Target
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field ISC Item Structure Class
     C                     Z-ADD*ZERO     WUBUNY  30
      * Define work field ISC Item Structure Group
     C                     Z-ADD*ZERO     WUBTNY  30
      * Define work field ISC Item Structure Type
     C                     Z-ADD*ZERO     WUBSNY  30
      * Define work field ISC Item Dft Cmdty Mkt Bs
     C                     MOVEL*BLANK    WUGQAA  3
      * Define work field ISC Item Type
     C                     MOVEL*BLANK    WUW1SX  3
      * Define work field ISC Item Cmdty Price Grp
     C                     MOVEL*BLANK    WUGPAA  7
      * Define work field ISC Item GL Sub Code
     C                     MOVEL*BLANK    WUGSAA  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WEAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WEAIWG           Unit Weight
     C                     Z-ADD*ZERO     WECZWG           Minimum Weight
     C                     Z-ADD*ZERO     WEC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WEURTN           Number Cases On
     C                     Z-ADD*ZERO     WEACC8           Vendor item Def
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WETFNB           Transportation
     C                     Z-ADD*ZERO     WECHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WESWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WEPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WESFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WEA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WESJNB           Production Lead
     C                     Z-ADD*ZERO     WESKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WESLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WESMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WECFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WECGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WEILNB           Packages per ca
     C                     Z-ADD*ZERO     WECHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WECINB           PM Batch Size
     C                     Z-ADD*ZERO     WECJNB           Package Level s
     C                     Z-ADD*ZERO     WECMNB           Partial Item Co
     C                     Z-ADD*ZERO     WECNNB           WIP Item Code
     C                     Z-ADD*ZERO     WECRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WECSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WECVNB           FP Std Green We
     C                     Z-ADD*ZERO     WECWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WECXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WECZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WEC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WEB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WETMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WETNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WEBLPR           Market Overage
     C                     Z-ADD*ZERO     WEBMPR           Standard Overag
     C                     Z-ADD*ZERO     WECMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEICN1           Item Category N
     C                     Z-ADD*ZERO     WEICN2           Item Category N
     C                     Z-ADD*ZERO     WEV2NB           Item Category N
     C                     Z-ADD*ZERO     WEITCN           Item Category N
     C                     Z-ADD*ZERO     WEITC5           Item Category N
     C                     Z-ADD*ZERO     WEICN6           Item Category N
     C                     Z-ADD*ZERO     WEICN7           Item Category N
     C                     Z-ADD*ZERO     WEICN8           Item Category N
     C                     Z-ADD*ZERO     WEICN9           Item Category N
     C                     Z-ADD*ZERO     WEICN0           Item Category N
     C                     Z-ADD*ZERO     WEB5NB           PM Line Number
     C                     Z-ADD*ZERO     WEBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WEBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WEF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WEF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WEF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WEBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WEBNNB           Production Qty
     C                     Z-ADD*ZERO     WEAHTM           Job Time 1
     C                     Z-ADD*ZERO     WEEKDT           Job Date 1
      * Define work field ISC Item UOM Pricing
     C                     MOVEL*BLANK    WUGTAA  2
      * Define work field ISC Item Market Overage
     C                     Z-ADD*ZERO     WUF3PR 114
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WFAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WFAIWG           Unit Weight
     C                     Z-ADD*ZERO     WFCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WFC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WFURTN           Number Cases On
     C                     Z-ADD*ZERO     WFAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFTFNB           Transportation
     C                     Z-ADD*ZERO     WFTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WFTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WFBLPR           Market Overage
     C                     Z-ADD*ZERO     WFBMPR           Standard Overag
     C                     Z-ADD*ZERO     WFCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WFCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WFSWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WFPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WFICN1           Item Category N
     C                     Z-ADD*ZERO     WFICN2           Item Category N
     C                     Z-ADD*ZERO     WFV2NB           Item Category N
     C                     Z-ADD*ZERO     WFITCN           Item Category N
     C                     Z-ADD*ZERO     WFITC5           Item Category N
     C                     Z-ADD*ZERO     WFICN6           Item Category N
     C                     Z-ADD*ZERO     WFICN7           Item Category N
     C                     Z-ADD*ZERO     WFICN8           Item Category N
     C                     Z-ADD*ZERO     WFICN9           Item Category N
     C                     Z-ADD*ZERO     WFICN0           Item Category N
     C                     Z-ADD*ZERO     WFSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WFA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WFSJNB           Production Lead
     C                     Z-ADD*ZERO     WFSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WFSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WFSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WFCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WFCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WFILNB           Packages per ca
     C                     Z-ADD*ZERO     WFCHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WFCINB           PM Batch Size
     C                     Z-ADD*ZERO     WFCJNB           Package Level s
     C                     Z-ADD*ZERO     WFCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WFCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WFCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WFCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WFCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WFCWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WFCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WFCZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WFC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WFB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WFB5NB           PM Line Number
     C                     Z-ADD*ZERO     WFBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WFBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WFF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WFF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WFF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WFBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WFBNNB           Production Qty
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field ISC Warehouse Type
     C                     MOVEL*BLANK    WUV8SX  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WGBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WGBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WGBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WGBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field ISC Post Balance Sts
     C                     MOVEL*BLANK    WUWNSX  1
      * Define work field ISC Post Warehouse Sts
     C                     MOVEL*BLANK    WUWOSX  1
      * Define work field ISC Unsh_Ship Inv Adj Qty
     C                     Z-ADD*ZERO     WUOQQT 112
      * Define work field ISC Unsh_Ship Inv Adj Lbs
     C                     Z-ADD*ZERO     WUM2WG 112
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field ISC Unused Sts 2
     C                     MOVEL*BLANK    WUWDSX  2
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field ISC FOB Gross Amount
     C                     Z-ADD*ZERO     WUFQVL 112
      * Define work field ISC Commission Amount
     C                     Z-ADD*ZERO     WUOUQT 112
      * Define work field ISC TF Exempt Pounds
     C                     Z-ADD*ZERO     WUM7WG 112
      * Define work field ISC TF Exempt NPR Dollars
     C                     Z-ADD*ZERO     WUOVQT 112
      * Define work field ISC Shipment Final Lbs
     C                     Z-ADD*ZERO     WUMWWG 112
      * Define work field ISC Shipment Final Qty
     C                     Z-ADD*ZERO     WUOLQT 112
      * Define work field ISC Sales Production Qty
     C                     Z-ADD*ZERO     WUOIQT 112
      * Define work field ISC Sales Production Lbs
     C                     Z-ADD*ZERO     WUMTWG 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Default Commod Mark basis
     C                     MOVEL*BLANK    WULNCD  3
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJNLNB           Entity Number
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field DL List ID
     C                     MOVEL*BLANK    WUCLAA 10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRM8NB           System Value Nu
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA03 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCCHRC.
     C                     Z-ADD*ZERO     WL0001  80
     C                     Z-ADD*ZERO     WL0002  30
     C                     MOVEL*BLANK    WL0003  3
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005  2
     C                     MOVEL*BLANK    WL0006  7
     C                     MOVEL*BLANK    WL0007  3
     C                     MOVEL*BLANK    WL0008  3
     C                     Z-ADD*ZERO     WL0009 114
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  30
     C                     MOVEL*BLANK    WL0013  3
     C                     MOVEL*BLANK    WL0014  2
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016 112
     C                     Z-ADD*ZERO     WL0017 112
     C                     Z-ADD*ZERO     WL0018 112
     C                     Z-ADD*ZERO     WL0019 112
     C                     Z-ADD*ZERO     WL0020 112
     C                     Z-ADD*ZERO     WL0021 112
     C                     Z-ADD*ZERO     WL0022 112
     C                     Z-ADD*ZERO     WL0023 112
     C                     Z-ADD*ZERO     WL0024 112
     C                     Z-ADD*ZERO     WL0025 112
     C                     Z-ADD*ZERO     WL0026 112
     C                     Z-ADD*ZERO     WL0027 112
     C                     Z-ADD*ZERO     WL0028 112
     C                     Z-ADD*ZERO     WL0029 112
     C                     Z-ADD*ZERO     WL0030 112
     C                     Z-ADD*ZERO     WL0031 112
     C                     Z-ADD*ZERO     WL0032 112
     C                     Z-ADD*ZERO     WL0033 112
     C                     Z-ADD*ZERO     WL0034 112
     C                     Z-ADD*ZERO     WL0035 112
     C                     Z-ADD*ZERO     WL0036 112
     C                     Z-ADD*ZERO     WL0037 112
     C                     Z-ADD*ZERO     WL0038 112
     C                     Z-ADD*ZERO     WL0039 112
     C                     MOVEL*BLANK    WL0040 10
     C                     Z-ADD*ZERO     WL0041  70
     C                     Z-ADD*ZERO     WL0042  60
     C                     Z-ADD*ZERO     WL0043 112
     C                     Z-ADD*ZERO     WL0044 112
     C                     Z-ADD*ZERO     WL0045 112
     C                     Z-ADD*ZERO     WL0046 112
     C                     Z-ADD*ZERO     WL0047 112
     C                     Z-ADD*ZERO     WL0048 112
     C                     Z-ADD*ZERO     WL0049 112
     C                     Z-ADD*ZERO     WL0050 112
     C                     MOVEL*BLANK    WL0051 60
     C                     MOVEL*BLANK    WL0052 10
     C                     Z-ADD*ZERO     WL0053  70
     C                     Z-ADD*ZERO     WL0054  60
     C                     Z-ADD*ZERO     WL0055 112
     C                     Z-ADD*ZERO     WL0056 112
     C                     Z-ADD*ZERO     WL0057  94
     C                     MOVEL*BLANK    WL0058  1
     C                     MOVEL*BLANK    WL0059  1
     C                     MOVEL*BLANK    WL0060  1
     C                     Z-ADD*ZERO     WL0061 112
     C                     Z-ADD*ZERO     WL0062 112
     C                     Z-ADD*ZERO     WL0063 112
     C                     Z-ADD*ZERO     WL0064 112
     C                     MOVEL*BLANK    WL0065  1
     C                     Z-ADD*ZERO     WL0066  70
     C                     MOVEL*BLANK    WL0067  2
     C                     MOVEL*BLANK    WL0068  1
     C                     Z-ADD*ZERO     WL0069  70
     C                     Z-ADD*ZERO     WL0070  60
     C                     MOVEL*BLANK    WL0071 10
     C                     MOVEL*BLANK    WL0072 10
     C                     Z-ADD*ZERO     WL0073  70
     C                     Z-ADD*ZERO     WL0074  60
     C                     MOVEL*BLANK    WL0075 10
     C                     MOVEL*BLANK    WL0076 10
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0077  80
     C                     Z-ADD*ZERO     WL0078  30
     C                     MOVEL*BLANK    WL0079  3
     C                     Z-ADD*ZERO     WL0080  70
     C                     Z-ADD*ZERO     WL0081 112
     C                     Z-ADD*ZERO     WL0082 112
     C                     Z-ADD*ZERO     WL0083 112
     C                     Z-ADD*ZERO     WL0084 112
     C                     Z-ADD*ZERO     WL0085 112
     C                     Z-ADD*ZERO     WL0086 112
     C                     MOVEL*BLANK    WL0087  1
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0088 10
     C                     MOVEL*BLANK    WL0089  6
     C                     Z-ADD*ZERO     WL0090  30
     C                     MOVEL*BLANK    WL0091  3
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field USR Item Code
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field Weight Billed
     C                     Z-ADD*ZERO     YL0004 112
      * Define local work field FOB Gross Amount
     C                     Z-ADD*ZERO     YL0005 112
      * Define local work field FOB Price_CWT
     C                     Z-ADD*ZERO     YL0006 114
      * Define local work field Quantity Billed
     C                     Z-ADD*ZERO     YL0007 112
      * Define local work field ISC Commission Amount
     C                     Z-ADD*ZERO     YL0008 112
      * Define local work field ISC TF Exempt NPR Dollars
     C                     Z-ADD*ZERO     YL0009 112
      * Define local work field ISC TF Exempt Pounds
     C                     Z-ADD*ZERO     YL0010 112
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field Commodity Market Price
     C                     Z-ADD*ZERO     YL0012 114
      * Define local work field FOB Gross Amount      USR
     C                     Z-ADD*ZERO     YL0013  92
      * Define local work field USR Weight Billed 11.2  7
     C                     Z-ADD*ZERO     YL0014 112
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0001  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0015  30
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0002  3
      * Define null work field Allow Multi-Company
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0004 10
      * Define null work field Name
     C                     MOVEL*BLANK    YN0005 30
      * Define null work field System Value Alpha
     C                     MOVEL*BLANK    YN0006 40
      * Define null work field Access Denied (Y/N)
     C                     MOVEL*BLANK    YN0007  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0016  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0017  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0018  30
      * Define local work field Office Message USR 6
     C                     MOVEL*BLANK    YL0019140
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 PRKWHSPST
