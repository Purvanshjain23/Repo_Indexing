// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PNKOXFR
// ?Date: 14.08.2025 Time: 03:45:24
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Rtv TP Sales Comp Sel RT) TYPE(RTVOBJ) FILE(PNF4REP)           AC1992559;
PARAMETER(PAR.Ship_To_Customer);
PARAMETER(PAR.TP_Sales_Company_Select);
PARAMETER(PAR.TP_Sales_Company);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?04/03/17 DN R9700-Added Inter Company Group Flag as Input Parm.
EXECUTE FUNCTION(Clc Transfer Price    RT) TYPE(RTVOBJ) FILE(OMHSTPP)           AC1758265;
PARAMETER(PAR.Shipped_Item_Code);
PARAMETER(PAR.Actual_Shipped_Date);
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Weight_Billed);
PARAMETER(PAR.FOB_Gross_Amount);
PARAMETER(PAR.Shipping_Company_Number);
PARAMETER(PAR.Date_From_USR);
PARAMETER(PAR.Date_To_USR);
PARAMETER(PAR.TP_Sales_Company_Select);
PARAMETER(PAR.TP_Sales_Company);
PARAMETER(PAR.Inter_Company_Group_USR);
{
 //?USER: Initialize routine

 MOVE *ALL (To: PAR From: CON);

 //?***** Change Log and Comments
 DO;

 //?** 06/29-2009 LJB FP1314
 //?** Omit type code of IS=Inter-Company Sales Agreement
 ENDDO;

 //?USER: Process Data record

 // PGM.*Record selected = CND.*YES
 PGM.*Record_selected = 'Y';

 //?EOF:  Actual Ship Date LT "FROM DATE"
 CASE;

 // IF DB1.Actual Shipped Date LT PAR.Date From             USR
 IF DB1.Actual_Shipped_Date < PAR.Date_From_USR;

 QUIT;

 ENDIF;

 //?OMT:  Exempt Items
 CASE;

 // IF DB1.Order TF Exempt Code is Exempt Items
 IF DB1.Order_TF_Exempt_Code = 'EC'/'EP';

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 //?OMT:  Type Code = Inter Company
 CASE;

 // IF DB1.Type Code is Inter Company
 IF DB1.Type_Code = 'IC';

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 //?OMT:  Type Code = Inter-Company Sales Agreement      FP1314
 CASE;

 // IF DB1.Type Code is Inter-Comp Sales Agreemnt
 IF DB1.Type_Code = 'IS';

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 //?OMT:  IC Group S (440) If IC Group G (360/960) or vice-versa.     DN-R9700
 CASE;

 // IF PGM.*Record selected is *YES
 IF PGM.*Record_selected = 'Y';

 EXECUTE FUNCTION(RTV Alpha Value 2     RT) TYPE(RTVOBJ) FILE(PDKMREP)           AC2134765;
 PARAMETER(DB1.Company_Number);
 PARAMETER('ICPRGROUP');
 PARAMETER(LCL.Inter_Company_Group_USR);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 CASE;

 // IF PAR.Inter Company Group USR NE LCL.Inter Company Group USR
 IF PAR.Inter_Company_Group_USR <> LCL.Inter_Company_Group_USR;

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 ENDIF;

 //?04/03/17 DN R9700-Commented Out 'SEL: Accounting Company' & Moved Below.
 //?04/03/17 DN R9700-Process 'SEL: Accounting Company' if only IC Group=G.
 CASE;

 // IF PAR.Inter Company Group USR is Guymon & Triumph
 IF PAR.Inter_Company_Group_USR = 'G';

 //?SEL: Accounting Company
 CASE;

 // IF PAR.TP Sales Company is Select Company
 IF PAR.TP_Sales_Company = 'S';

 CASE;

 // IF PAR.TP Sales Company Select is greater than zero
 IF PAR.TP_Sales_Company_Select > *ZERO;

 CASE;

 // IF DB1.Company Number NE PAR.TP Sales Company Select
 IF DB1.Company_Number <> PAR.TP_Sales_Company_Select;

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 ENDIF;

 //?SEL: Accounting Company
 // IF PAR.TP Sales Company is Order Accounting Company
 IF PAR.TP_Sales_Company = 'O';

 CASE;

 // IF DB1.Company Number NE PAR.Company Number
 IF DB1.Company_Number <> PAR.Company_Number;

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 ENDIF;

 ENDIF;

 //?PRC:  Record Selected
 CASE;

 // IF PGM.*Record selected is *YES
 IF PGM.*Record_selected = 'Y';

 // PAR.Weight Billed = PAR.Weight Billed + DB1.Weight Billed
 PAR.Weight_Billed = PAR.Weight_Billed + DB1.Weight_Billed;

 // PAR.FOB Gross Amount = PAR.FOB Gross Amount + DB1.FOB Gross Amount
 PAR.FOB_Gross_Amount = PAR.FOB_Gross_Amount + DB1.FOB_Gross_Amount;

 ENDIF;

}


