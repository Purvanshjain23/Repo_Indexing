     H/TITLE Eml EDI Purchase Ords XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 08/18/21  Time  : 11:21:53
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDKMREL2IF  E           K        DISK
      * RSQ : Company Values            By Values/Co
      *
     FECP004L7IF  E           K        DISK
      * RSQ : EDI Purchase Order Header ST02-TRANS SET CONTROL #
      *
     FCAEOREL5IF  E           K        DISK
      * RSQ : Company Customer          Customer
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FPDNFREL1IF  E           K        DISK
      * RTV : Salesperson Electronic CM Retrieval index
      *
      * Long constants
     E                    @CN#    1  10  6   @CN    25
     I@KMREEL
      * Company Values            By Values/Co
      * Renamed input format fields
     I              KMAIC3                          WAAIC3
     I              KMV8CD                          WAV8CD
     I              KMAUNA                          WAAUNA
     I              KMI5ST                          WAI5ST
     I              KMBXTX                          WABXTX
     I              KMM8NB                          WAM8NB
     I              KMUVST                          WAUVST
     I              KMUWST                          WAUWST
     I              KMUXST                          WAUXST
     I              KMVSST                          WAVSST
     I              KMAATM                          WAAATM
     I              KMAYNA                          WAAYNA
     I              KMA0NA                          WAA0NA
     I              KMAXDT                          WAAXDT
      *
     I@P004O0
      * EDI Purchase Order Header ST02-TRANS SET CONTROL #
      * Renamed input format fields
     I              BQTSCN                          WBTSCN
     I              BQL3SX                          WBL3SX
     I              BQOSDT                          WBOSDT
     I              BQPONO                          WBPONO
     I              BQDKAA                          WBDKAA
     I              BQNAME                          WBNAME
     I              BQCQLF                          WBCQLF
     I              BQCNUM                          WBCNUM
     I              BQINRF                          WBINRF
     I              BQGNTX                          WBGNTX
     I              BQHUAA                          WBHUAA
     I              BQHUVL                          WBHUVL
     I              BQHVAA                          WBHVAA
     I              BQX8T1                          WBX8T1
     I              BQJ2AA                          WBJ2AA
     I              BQT6DT                          WBT6DT
     I              BQQLFX                          WBQLFX
     I              BQDELV                          WBDELV
     I              BQSHMT                          WBSHMT
     I              BQMTTY                          WBMTTY
     I              BQPLEX                          WBPLEX
     I              BQLDOP                          WBLDOP
     I              BQROUT                          WBROUT
     I              BQFOBP                          WBFOBP
     I              BQD3VL                          WBD3VL
     I              BQUNIT                          WBUNIT
     I              BQD4VL                          WBD4VL
     I              BQAMTX                          WBAMTX
     I              BQDSTS                          WBDSTS
     I              BQSRAA                          WBSRAA
     I              BQBRU1                          WBBRU1
     I              BQSSAA                          WBSSAA
     I              BQBSU1                          WBBSU1
     I              BQSTAA                          WBSTAA
     I              BQBTU1                          WBBTU1
     I              BQSUAA                          WBSUAA
     I              BQBUU1                          WBBUU1
     I              BQSVAA                          WBSVAA
     I              BQBVU1                          WBBVU1
     I              BQSWAA                          WBSWAA
     I              BQBWU1                          WBBWU1
     I              BQSXAA                          WBSXAA
     I              BQBXU1                          WBBXU1
     I              BQYDT1                          WBYDT1
     I              BQNLST                          WBNLST
     I              BQUFDT                          WBUFDT
     I              BQOJAA                          WBOJAA
     I              BQJ5NX                          WBJ5NX
      *
     I@EOREIQ
      * Company Customer          Customer
      * Renamed input format fields
     I              EOAIC3                          WCAIC3
     I              EOBKC7                          WCBKC7
     I              EOAQCD                          WCAQCD
     I              EOR4CD                          WCR4CD
     I              EOBYNA                          WCBYNA
     I              EOB6NA                          WCB6NA
     I              EOBZNA                          WCBZNA
     I              EOLLST                          WCLLST
     I              EOPPST                          WCPPST
     I              EOR5NB                          WCR5NB
     I              EOR6NB                          WCR6NB
     I              EOQGST                          WCQGST
     I              EOBOCD                          WCBOCD
     I              EOTBNB                          WCTBNB
     I              EOMTCU                          WCMTCU
     I              EOW2NB                          WCW2NB
     I              EORPCD                          WCRPCD
     I              EOAJCD                          WCAJCD
     I              EOX9ST                          WCX9ST
     I              EOT9CD                          WCT9CD
     I              EOUBCD                          WCUBCD
     I              EOISTX                          WCISTX
     I              EOLQCD                          WCLQCD
     I              EONJNA                          WCNJNA
     I              EOI0TX                          WCI0TX
     I              EONKNA                          WCNKNA
     I              EOI1TX                          WCI1TX
     I              EOVLST                          WCVLST
     I              EORLST                          WCRLST
     I              EOMMTX                          WCMMTX
     I              EOOHNA                          WCOHNA
     I              EOQ6ST                          WCQ6ST
     I              EOQ8ST                          WCQ8ST
     I              EORBST                          WCRBST
     I              EOREST                          WCREST
     I              EOUVST                          WCUVST
     I              EOUWST                          WCUWST
     I              EOUXST                          WCUXST
     I              EOVSST                          WCVSST
     I              EOAATM                          WCAATM
     I              EOAYNA                          WCAYNA
     I              EOA0NA                          WCA0NA
     I              EOAXDT                          WCAXDT
      *
     I@JEREWS
      * Sales Route               Active Records
      * Renamed input format fields
     I              JER4CD                          WDR4CD
     I              JEMZNA                          WDMZNA
     I              JEBCCD                          WDBCCD
     I              JEBFCD                          WDBFCD
     I              JEQ4CD                          WDQ4CD
     I              JEWOST                          WDWOST
     I              JER8CD                          WDR8CD
     I              JEUVST                          WDUVST
     I              JEUWST                          WDUWST
     I              JEUXST                          WDUXST
     I              JEVSST                          WDVSST
     I              JEAATM                          WDAATM
     I              JEAYNA                          WDAYNA
     I              JEA0NA                          WDA0NA
     I              JEAXDT                          WDAXDT
      *
     I@NFREAW
      * Salesperson Electronic CM Retrieval index
      * Renamed input format fields
     I              NFBCCD                          WEBCCD
     I              NFUGTX                          WEUGTX
     I              NFV4CD                          WEV4CD
     I              NFN1SX                          WEN1SX
     I              NFN2SX                          WEN2SX
     I              NFUVST                          WEUVST
     I              NFUWST                          WEUWST
     I              NFUXST                          WEUXST
     I              NFVSST                          WEVSST
     I              NFAATM                          WEAATM
     I              NFAYNA                          WEAYNA
     I              NFA0NA                          WEA0NA
     I              NFAXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  EDI Function Sts USR
     I                                        1   1 P1MHSX
     IP2PARM      DS
      * I :  EDI In Process Sts USR
     I                                        1   1 P2MISX
     IP3PARM      DS
      * I :  EDI Trading Partner No.
     I                                        1   6 P3J5NX
     IP4PARM      DS
      * I :  TRANS SET CONTROL APLHA
     I                                        1   9 P4DLAA
     IP5PARM      DS
      * FLD: EDI Purchase Order Header
      * N :  ST02-TRANS SET CONTROL NU
     I                                    P   1   50P5TSCN
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'EDI Status Message'
      * EDI Trading Partner No.
     I                                        1   6 ZA0001
      * TRANS SET CONTROL APLHA
     I                                        7  15 ZA0002
      * EDI Function Sts USR
     I                                       16  16 ZA0003
      * EDI In Process Sts USR
     I                                       17  17 ZA0004
      * Message data for 'ESNDMAIL'
      * Email Address
     I                                        1  50 ZA0005
      * Office Message USR
     I                                       51 182 ZA0006
      * Message data for 'EDI-Purch OrdHdr NF RTV'
      * ST02-TRANS SET CONTROL NU
     I                                    P   1   50ZA0007
      * Message data for 'ESNDMAILPO'
      * Email Address
     I                                        1  50 ZA0008
      * Office Message USR
     I                                       51 182 ZA0009
      * EDI Trading Partner No.
     I                                      183 188 ZA0010
      * Message data for 'ESNDFILE (Spool File)'
      * Email Address
     I                                        1  50 ZA0011
      * Customer Comment Line
     I                                       51 110 ZA0012
      * Program name USR
     I                                      111 120 ZA0013
      * Remove Spool File    USR
     I                                      121 124 ZA0014
      * Message data for 'ESNDFILE (Spool File)'
      * Email Address
     I                                        1  50 ZA0015
      * Customer Comment Line
     I                                       51 110 ZA0016
      * Program name USR
     I                                      111 120 ZA0017
      * Remove Spool File    USR
     I                                      121 124 ZA0018
      * Message data for 'ESNDFILE (Spool File)'
      * Email Address
     I                                        1  50 ZA0019
      * Customer Comment Line
     I                                       51 110 ZA0020
      * Program name USR
     I                                      111 120 ZA0021
      * Remove Spool File    USR
     I                                      121 124 ZA0022
      * Message data for 'ESNDFILE (Spool File)'
      * Email Address
     I                                        1  50 ZA0023
      * Customer Comment Line
     I                                       51 110 ZA0024
      * Program name USR
     I                                      111 120 ZA0025
      * Remove Spool File    USR
     I                                      121 124 ZA0026
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1MHSX    PARM           WP0001  1        EDI Function St
     C           P2MISX    PARM           WP0002  1        EDI In Process
     C           P3J5NX    PARM           WP0003  6        EDI Trading Par
     C           P4DLAA    PARM           WP0004  9        TRANS SET CONTR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Eml EDI Purchase Ords XF
      * CASE: PAR.EDI Function Sts USR is Error
     C           P1MHSX    IFEQ 'E'                        *IF
      * RMC 12/20/19  move to NEW dist list EDIPOERR
      * RTV Alpha Value W/O Co RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'EDIPOERR'WL0001    P      Company Value C
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0001    P      System Value Al
      * Setup message data for message
     C                     MOVELP3J5NX    ZA0001           EDI Trading Par
     C                     MOVELP4DLAA    ZA0002           TRANS SET CONTR
     C                     MOVELP1MHSX    ZA0003           EDI Function St
     C                     MOVELP2MISX    ZA0004           EDI In Process
      * Retrieve message EDI Status Message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3137' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0002    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message
     C                     MOVELYL0001    ZA0005           Email Address
     C                     MOVELYL0002    ZA0006           Office Message
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3136' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE P4DLAA    P5TSCN           ST02-TRANS SET
      * Eml EDI Purchase Ords RT - EDI Purchase Order Header  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Alpha Value W/O Co RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WL0002           System Value Al
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAV8CD    WQSA01           Company Value C
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Value C
      * Setup key
     C                     MOVELWL0001    WQSA01           Company Value C
      * Establish starting position
     C           KRSSA     SETLL@KMREEL                    *
     C           KRSSA     READE@KMREEL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWABXTX    WL0002           System Value Al
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@KMREEL                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Eml EDI Purchase Ords RT - EDI Purchase Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * **2/15/18 SZ Added code to send Reinhart and WoodFrutticher to th
      *           global FoodService email address.
      * **12/20/17 SZ Added code to read ShipTo Interchange to get ShipTo
      *           and the email address to go with that shipto. It was re
      *           That certain shipto 67th St BBQ orders be sent to a gro
      *           email addy.
      *           Added ship to DUNS parm to the PRT Purchase Order PF
      * **7/26/16 SZ Added code to block Dailys emails.  They do not want
      *           any emails now that all POs are going to M3.
      * **7/1/16 SZ Added code to send SYSCO foods emails to one global a
      * **9/4/14 SZ Replaced email addys with EDI support email addy
      * **9/4/14 SZ Added Trade Partner Code to subject line for EDI Supp
      * **6/10/14 SZ Rmvd Scott Lam and added Leanne Ramsey to error mess
      * **6/02/14 SZ added the word TEST to the msg comment. Recompiled f
      * **  added to ECP004
      * **4/24/14 SZ Shortened Purchase order to PO in the error message
      * **9/23/13 SZ crt new err msg to show TP with Control #.
      * **9/19/13 SZ Added Scott to the Purchase ord hdr not found messag
      * **8/02/13 SZ Chgd company number parm in the record not found
      * * routine from LCL to PAR.
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBTSCN    WQSB01           ST02-TRANS SET
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           ST02-TRANS SET
      * Setup key
     C                     Z-ADDP5TSCN    WQSB01           ST02-TRANS SET
      * Establish starting position
     C           KRSSB     SETLL@P004O0                    *
     C           KRSSB     READE@P004O0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3103' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,001   CAT  'com':ZQ  YL0004    P      Text Usr 50
     C                     MOVELYL0004    YL0005           Email Address
      * Setup message data for message
     C                     Z-ADDP5TSCN    ZA0007           ST02-TRANS SET
      * Retrieve message EDI-Purch OrdHdr NF RTV
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR4421' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0006    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message
     C                     MOVELYL0005    ZA0008           Email Address
     C                     MOVELYL0006    ZA0009           Office Message
     C                     MOVELP3J5NX    ZA0010           EDI Trading Par
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR4641' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Prt Purchase Order    PF - EDI Purchase Order Header  * 
     C                     CALL 'PON7PFR'              90  Prt Purchase Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBTSCN    WQ0001  90       ST02-TRANS SET
     C                     PARM WBD3VL    WQ0002 114       G7601-QUANTITY
     C                     PARM WBD4VL    WQ0003 112       G7603-WEIGHT OR
     C                     PARM WBAMTX    WQ0004 112       G7608-ORDER AMO
     C           YL0005    PARM *BLANK    WQ0005 50        Email Address
     C           YL0007    PARM *BLANK    WQ0006 30        Ship To Name
     C           YL0008    PARM YL0008    WQ0007  1        Email PO Error
     C           YL0009    PARM *BLANK    WQ0008 20        EDI Shipto Duns
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PON7PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Customer information not found send email to EDI Support
      * CASE: LCL.Email Address is Blank
     C           YL0005    IFEQ *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           YL0007    CAT  'PO:':ZQ  YL0010    P      Customer Commen
     C                     Z-ADD1         ZQ      50
     C           YL0010    CAT  WBPONO:ZQ YL0010    P      Customer Commen
     C                     Z-ADD1         ZQ      50
     C           YL0010    CAT  @CN,002:ZQYL0010    P      Customer Commen
      * RTV Alpha Value W/O Co RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'EDIPOERR'WL0001    P      Company Value C
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0004    P      System Value Al
      * Setup message data for message
     C                     MOVELYL0004    ZA0011           Text Usr 50
     C                     MOVELYL0010    ZA0012           Customer Commen
     C                     MOVEL@CN,003   ZA0013           Program name US
     C                     MOVEL'*YES'    ZA0014           Remove Spool Fi
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3109' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * E15257 JJH 07/24/19 - Add Gordon Foods to Group Email
      * If Foods iTrade/SYSCO, or Frutticher, or Reinhar send to their gr
      * CASE:
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : PAR.EDI Trading Partner No. is SYSCO Foods
      *   |- c2    : PAR.EDI Trading Partner No. is Wood Frutticher
      *   |- c3    : PAR.EDI Trading Partner No. is ReinhartFS
      *   |- c4    : PAR.EDI Trading Partner No. is Gordon Foods
      *   '-
     C           P3J5NX    IFEQ 'SYSCO'                    *IF
     C           P3J5NX    OREQ @CN,004                    *OR
     C           P3J5NX    OREQ @CN,005                    *OR
     C           P3J5NX    OREQ @CN,006                    *OR
     C                     Z-ADD1         ZQ      50
     C           YL0005    CAT  'PO:':ZQ  YL0010    P      Customer Commen
     C                     Z-ADD0         ZQ      50
     C           YL0010    CAT  WBPONO:ZQ YL0010    P      Customer Commen
     C                     Z-ADD1         ZQ      50
     C           YL0010    CAT  P3J5NX:ZQ YL0010    P      Customer Commen
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,007   CAT  @CN,008:ZQYL0004    P      Text Usr 50
      * Setup message data for message
     C                     MOVELYL0004    ZA0015           Text Usr 50
     C                     MOVELYL0010    ZA0016           Customer Commen
     C                     MOVEL@CN,003   ZA0017           Program name US
     C                     MOVEL'*NO'     ZA0018           Remove Spool Fi
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3109' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.EDI Trading Partner No. is SYSCO Dailys
     C           P3J5NX    IFEQ @CN,009                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Check to see if this is a 67th street BBQ customer.
      * If there is an alternate customer #, need to send this email to t
      * sales person that is not 67th BBQ. And also send to the 67th BBQ
      * Rtv ST Cust by DUNS   XF - EDI ShipTo Interchange  * 
     C                     CALL 'PUC9XFR'              90  Rtv ST Cust by
     C                     PARM *BLANK    W0RTN   7
     C           YL0011    PARM *ZERO     WQ0009  70       EDI ShipTo Cust
     C                     PARM YL0009    WQ0010 14        EDI ShipTo DUNS
     C           WUY4NY    PARM *ZERO     WQ0011 100       EDI Alt ST Cust
     C                     PARM *BLANK    WQ0012 60        EDI Email Addre
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUC9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,010                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.EDI Alt ST Cust Number is Greater than zero
     C           WUY4NY    IFGT 0                          *IF
      * RTV Sales rte by Cust  RT - Company Customer  * 
     C                     EXSR SCRVGN
      * RTV Salesman Code      RT - Sales Route  * 
     C                     EXSR SDRVGN
      * Rtv Email/EDI Sts 3    RT - Salesperson Electronic CM  * 
     C                     EXSR SERVGN
     C                     Z-ADD1         ZQ      50
     C           YL0007    CAT  'PO:':ZQ  YL0010    P      Customer Commen
     C                     Z-ADD1         ZQ      50
     C           YL0010    CAT  WBPONO:ZQ YL0010    P      Customer Commen
      * Setup message data for message
     C                     MOVELWUUGTX    ZA0019           Email Address
     C                     MOVELYL0010    ZA0020           Customer Commen
     C                     MOVEL@CN,003   ZA0021           Program name US
     C                     MOVEL'*NO'     ZA0022           Remove Spool Fi
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3109' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD1         ZQ      50
     C           YL0007    CAT  'PO:':ZQ  YL0010    P      Customer Commen
     C                     Z-ADD1         ZQ      50
     C           YL0010    CAT  WBPONO:ZQ YL0010    P      Customer Commen
      * Setup message data for message
     C                     MOVELYL0005    ZA0023           Email Address
     C                     MOVELYL0010    ZA0024           Customer Commen
     C                     MOVEL@CN,003   ZA0025           Program name US
     C                     MOVEL'*NO'     ZA0026           Remove Spool Fi
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3109' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
     C                     END                             *FI
      * W82895 DN 08/18/21-Commented Out. EDI Support No Longer Needs It.
     C                     END                             *FI
     C           KRSSB     READE@P004O0                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Sales rte by Cust  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCBKC7    WQSC01           Ship To Custome
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Ship To Custome
      * Setup key
     C                     Z-ADDWUY4NY    WQSC01           Ship To Custome
      * Establish starting position
     C           KRSSC     SETLL@EOREIQ                    *
     C           KRSSC     READE@EOREIQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR4CD           Sales Route Cod
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCR4CD    WUR4CD           Sales Route Cod
     C           KRSSC     READE@EOREIQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Salesman Code      RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDR4CD           Sales Route Cod
      * Setup key
     C                     MOVELWUR4CD    WDR4CD           Sales Route Cod
      * Establish starting position
     C           KRSSD     CHAIN@JEREWS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUBCCD           Salesperson Cod
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDBCCD    WUBCCD           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Email/EDI Sts 3    RT - Salesperson Electronic CM  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEBCCD           Salesperson Cod
      * Setup key
     C                     MOVELWUBCCD    WEBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSE     CHAIN@NFREAW              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2882' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUUGTX           Email Address
     C                     MOVEL*BLANK    WUUXST           EDI Status 3
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEUGTX    WUUGTX           Email Address
     C                     MOVELWEUXST    WUUXST           EDI Status 3
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P5TSCN           ST02-TRANS SET
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAM8NB           System Value Nu
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBTSCN           ST02-TRANS SET
     C                     Z-ADD*ZERO     WBOSDT           G5002-ORDER DAT
     C                     Z-ADD*ZERO     WBHUVL           SAC05-$$ AMT OF
     C                     Z-ADD*ZERO     WBT6DT           G6202 Ship Date
     C                     Z-ADD*ZERO     WBDELV           G6202-DELIVERY
     C                     Z-ADD*ZERO     WBD3VL           G7601-QUANTITY
     C                     Z-ADD*ZERO     WBD4VL           G7603-WEIGHT OR
     C                     Z-ADD*ZERO     WBAMTX           G7608-ORDER AMO
     C                     Z-ADD*ZERO     WBUFDT           POH Date Stamp
      * Define work field EDI Alt ST Cust Number
     C                     Z-ADD*ZERO     WUY4NY 100
      * Define work field Sales Route Code
     C                     MOVEL*BLANK    WUR4CD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCR5NB           Deliver after t
     C                     Z-ADD*ZERO     WCR6NB           Deliver before
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WCW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Salesperson Code
     C                     MOVEL*BLANK    WUBCCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Email Address
     C                     MOVEL*BLANK    WUUGTX 50
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     MOVEL*BLANK    WL0002 40
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0001 50
      * Define local work field Office Message USR
     C                     MOVEL*BLANK    YL0002132
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Text Usr 50
     C                     MOVEL*BLANK    YL0004 50
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0005 50
      * Define local work field Office Message USR
     C                     MOVEL*BLANK    YL0006132
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0007 30
      * Define local work field Email PO Error
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field EDI Shipto Duns Number
     C                     MOVEL*BLANK    YL0009 20
      * Define local work field Customer Comment Line
     C                     MOVEL*BLANK    YL0010 60
      * Define local work field EDI ShipTo Customer
     C                     Z-ADD*ZERO     YL0011  70
      * Define null work field EDI Email Address
     C                     MOVEL*BLANK    YN0001 60
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 edisupport@seaboardfoods.
00002 CUSTOMER NOT FOUND
00003 PON7PFR$
00004 WOODFR
00005 REINHT
00006 GORDON
00007 foodsvcorders@seaboardfoo
00008 ds.com
00009 DSYSCO
00010 Y2U0005
