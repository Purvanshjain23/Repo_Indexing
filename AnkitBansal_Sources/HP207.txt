      *****************  RPG PROGRAM HEADING  ************************
      *
      * SYSTEM:      HPS Data Mart
      * PROGRAM:     HP207 - Delete Current Records
      * PROGRAMMER:  LeAnne Fedor
      * CREATED:     12/26/02
      *
      * Function:    The Datamart BGF build was taking a long time.
      *              So, we have implemented logic that allows us to rebuild only the
      *              'current' data (as identified in the data area DABGF.)
      *
      *              This program is conditionally called from HPBLDBGF.
      *
      ****************************************************************
      * MODIFICATIONS:
      ****************************************************************
      * DATE      PROGRAMMER
      *
      * 06/30/04  LeAnne Fedor
      *           Recompile only.
      *
      * 10/07/04  LeAnne Fedor
      *           The users can now submit the BGF Datamart build. So,
      *           data area DABGF was increased to 100 characters to give us the
      *           ability to prevent multiple, simultaneous submissions.
      *
      * 02/01/05  LeAnne Fedor
      *           Recompile only. New fields (Sire Line Company and Prime Line) added
      *           to Datamart BGF: Weekly Production file.
      *
      * 02/03/05  LeAnne Fedor
      *           Recompile only. New field "Transferred In Open Gilts" add
      *           to BGF Daily and Weekly Production files.
      *
      * 02/07/05  LeAnne Fedor
      *           Recompile only due to file changes in Datamart files:
      *
      *               Datamart BGF Daily Production file:
      *                        Added: Transferred In Open Gilts
      *
      *               Datamart BGF Weekly Production file:
      *                        Added: Transferred In Open Gilts
      *                      Removed: Total Lactation Pounds
      *
      * 03/21/05  Barb Gutierrez
      *           Recompile only. Two new fields (culled head and culled lbs) added to file:
      *                BGF Daily Production
      *
      * 07/05/05  LeAnne Fedor
      *           Recompile only due to file changes in Datamart BGF Weekly Production file:
      *           Added 1 new field: Average Daily Beginning Piglet Inventory
      *
      * 08/23/05  LeAnne Fedor
      *           Recompile only. New field "Man Hours" added to Datamart files:
      *                BGF Daily Production and
      *                BGF Weekly Production
      *
      * 03/23/06  LeAnne Fedor
      *           Recompile only. New fields added to Datamart BGF Weekly Production file.
      *
      * 04/24/06  LeAnne Fedor
      *           Recompile only. New fields added to Datamart BGF Weekly Production file.
      *                 Cognos Report Grouping
      *                 Weaning Cognos Report Grouping
      *                 Report PCP Cognos Report Grouping
      *                 Report Farrowed Cognos Report Grouping
      *
      * 06/15/06  LeAnne Ramsey
      *           Recompile only. New field added to Datamart BGF Weekly Production file:
      *                Field: Total Gilt Weight @ 28 Weeks
      *
      * 08/04/08  LeAnne Ramsey
      *           Recompile only. Fields deleted from Weekly Production file.
      *                           BPPSGLSV - Nbr Gilts Bred w/Passed Date
      *                           BPWSLB   - Weekly Ending Lbs Supplement Used
      *                           BPP2LT   - Total P2 Litters Farrowed
      *                           BPTDGB   - Total Days Gilt Breeding Age
      *                           BPIOGLHD - Transferred in Open Gilts
      *                           BPOOGLHD - Gilts Transferred Out Open
      *                           BP17WNLT - 17+ Day Weaned Sows
      *                           BPTGLLB  - Total Gilt Weight @ 28 Weeks
      *
      * 11/07/08  LeAnne Ramsey
      *           Recompile only:
      *           Added 3 new fields to HPPB092-Datamart BGF: Weekly Production
      *            1) Target open gilt pool eligible
      *            2) Target litters farrowed/mated female/year
      *            3) Target pigs weaned/mated female/year
      *
      * 05/28/09  LeAnne Ramsey
      *           Recompile only. Added new field "Farrowing Crates" to:
      *                HPPB092-Datamart BGF: Weekly Production
      *
      * 09/01/09  LeAnne Ramsey
      *           Recompile only. Added new field "Report Total Litters Farrowed" to:
      *                 HPPB092-Datamart BGF: Weekly Production
      *
      * 01/14/10  LeAnne Ramsey
      *           Recompile only. Changed text on BPLVHD and BPLVLB in:
      *                HPPB092-Datamart BGF: Weekly Production
      *
      * 10/18/10  LeAnne Ramsey  (E1079)
      *           Recompile only. Sire Line Company is now 2-characters instead
      *           of one.
      /eject
      ****************************************************************
      * FILE SPECIFICATIONS
      ****************************************************************
      *
     Fhplb082a  uf   e           k disk
      *  DataMart BGF: Daily Production
      *
      *
     Fhppb092   uf   e           k disk
      *    DataMart BGF: Weekly Production
      *
      *
     Fhplb092d  uf   e           k disk    rename(bprec:bprecd)
      *    DataMart BGF: Weekly Production
      *
      /eject
      ****************************************************************
      * DEFINITION SPECIFICATIONS
      ****************************************************************
      *
      ****************************************************************
      * STANDALONE FIELDS
      ****************************************************************
      *
      *
      ****************************************************************
      * DATA STRUCTURES
      ****************************************************************
      *
      *---------------------------------------------------------------
      * Standard program status data structure
      *---------------------------------------------------------------
      *    externally defined as UTPGFR (record format: PGMDSR)
     D pgmds         esds                  extname(utpgfr)
      *
      *
      *---------------------------------------------------------------
      * Definition for external data area dabgf
      *---------------------------------------------------------------
     D
     Ddabgf            ds                  dtaara(dabgf)
     D  dacwkbegdt            59     66  0
     D  dacwkenddt            68     75  0
     D  dasbmfl               94     94
     D  daother               95    100
      *
      *
      * Workfields
      *
     D  wkcdyr         s              4  0
      *
      *
      * The following is a dummy C-spec to keep the D-specs from
      * running over into the C-specs on the compile listing. It
      * serves no other purpose and can be deleted at any time.
      *
     C                   if        sdpgm = *blank
     C                   endif
      /EJECT
      ****************************************************************
      * Mainline
      ****************************************************************
      *
      * Datamart BGF: Daily Production
      * (Logic deletes records where the record week-ending date is equal to
      * or greater than the data area week-ending date.)
      *
     C     dacwkenddt    setll     hplb082a
      *
     C                   dou       *in90 = *on                                  Do daily
     C                   read      hplb082a                               90
     C                   if        *in90 = *off                                 If not EOF
     C                   delete    bdrec
     C                   endif                                                  If not EOF
     C                   enddo                                                  Do daily
      *
      * Datamart BGF: Weekly Production
      *
      * First, delete records where the record week-ending date is equal to
      * or greater than the data area week-ending date.
      *
     C     dacwkenddt    setll     hplb092d
      *
     C                   dou       *in90 = *on                                  Do weekly
     C                   read      hplb092d                               90
     C                   if        *in90 = *off                                 If not EOF
     C                   delete    bprecd
     C                   endif                                                  If not EOF
     C                   enddo                                                  Do weekly
      *
      * Now, delete the bogus 'target' records that we will ultimately write.
      * (They all have a hardcoded year of 1990.)
      *
     C                   z-add     1990          wkcdyr
     C     wkcdyr        setll     hppb092
      *
     C                   dou       *in90 = *on                                  Do targets
     C     wkcdyr        reade     hppb092                                90
     C                   if        *in90 = *off                                 If not EOF
     C                   delete    bprec
     C                   endif                                                  If not EOF
     C                   enddo                                                  Do targets
      *
     C                   seton                                        lr
      /eject
      *---------------------------------------------------------------
      * Initialization subroutine
      *---------------------------------------------------------------
      *
     C     *inzsr        begsr
      *
      * Bring in the data area that contains the week-beginning date and the week-ending
      * date for the first week of 'current' data.
      *
     C                   in        dabgf
      *
     C                   endsr
      /eject
