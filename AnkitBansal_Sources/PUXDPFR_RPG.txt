     H/TITLE PRT PrelPick /LoadId PF   Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPJAKH
     H* Date          : 10/15/24  Time  : 08:11:41
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMFJCPL5IF  E           K        DISK
      * RSQ : Load Header               Co/DDDt/DDTm/Load
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBFCPLLIF  E           K        DISK
      * RSQ : Order Header TRG          Ld(d)/Ord
      *
     FPMAMREL2IF  E           K        DISK
      * RSQ : Order Header Extension    Load ID/Order#/Co#
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDIOREL1IF  E           K        DISK
      * RTV : Item Bill Of Material     Retrieval index
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FOPCPCPL1IF  E           K        DISK
      * RTV : Order Detail Comment      Retrieval index       NV
      *
     FPUB6CPL1IF  E           K        DISK
      * RTV : Pallet Master             Retrieval index
      *
     FPDKECPL1IF  E           K        DISK
      * RTV : Traffic Comments          Retrieval index
      *
     FPDIECPL1IF  E           K        DISK
      * RTV : Shipping Instructions     Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer Master           Retrieval index       NV
      *
     FPDJEREL1IF  E           K        DISK
      * RTV : Sales Route               Retrieval index
      *
     FOME5REL1IF  E           K        DISK
      * RTV : Country Master            Retrieval index
      *
     FPOAVCPL1IF  E           K        DISK
      * RTV : Customer Comment          Retrieval index
      *
     FPOAVCPL2IF  E           K        DISK
      * RSQ : Customer Comment          Cust/Type/Seq(D)
      *
     FPPB1REL1IF  E           K        DISK
      * RTV : Country Comment           Retrieval index
      *
     FOPBGWKLLIF  E           K        DISK
      * RSQ : Order Detail              Co/Whse/Order
      *
     FOPBFCPOBIF  E           K        DISK
      * RSQ : Order Header TRG          Ld/Ord -Avail for Pick
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier Info              Retrieval index
      *
     FPUXDPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT PrelPick /LoadId PF   Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UAD         6 34               Name/Address
      *
      * Long constants
     E                    @CN#    1  06  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WARMNB
     I              FJAIC3                          WAAIC3
     I              FJAODT                          WAAODT
     I              FJPJST                          WAPJST
     I              FJPKST                          WAPKST
     I              FJRNNB                          WARNNB
     I              FJDMTX                          WADMTX
     I              FJDNTX                          WADNTX
     I              FJDOTX                          WADOTX
     I              FJWTTX                          WAWTTX
     I              FJWUTX                          WAWUTX
     I              FJRPNB                          WARPNB
     I              FJFLAM                          WAFLAM
     I              FJXQST                          WAXQST
     I              FJRRNB                          WARRNB
     I              FJDXTX                          WADXTX
     I              FJDYTX                          WADYTX
     I              FJSBNB                          WASBNB
     I              FJBZNA                          WABZNA
     I              FJRONB                          WARONB
     I              FJSQNB                          WASQNB
     I              FJR1NB                          WAR1NB
     I              FJVCST                          WAVCST
     I              FJVDST                          WAVDST
     I              FJSDNB                          WASDNB
     I              FJPAOU                          WAPAOU
     I              FJDGWG                          WADGWG
     I              FJSXNB                          WASXNB
     I              FJHADT                          WAHADT
     I              FJAART                          WAAART
     I              FJDHWG                          WADHWG
     I              FJDIWG                          WADIWG
     I              FJAQDT                          WAAQDT
     I              FJS6NB                          WAS6NB
     I              FJT4NB                          WAT4NB
     I              FJPRTM                          WAPRTM
     I              FJNPSV                          WANPSV
     I              FJJ8TX                          WAJ8TX
     I              FJTLMI                          WATLMI
     I              FJJ9TX                          WAJ9TX
     I              FJQ2CD                          WAQ2CD
     I              FJVPCD                          WAVPCD
     I              FJDBCD                          WADBCD
     I              FJGRWE                          WAGRWE
     I              FJXCCD                          WAXCCD
     I              FJU2ST                          WAU2ST
     I              FJF9DT                          WAF9DT
     I              FJONTM                          WAONTM
     I              FJJ4DT                          WAJ4DT
     I              FJTRTM                          WATRTM
     I              FJJ5DT                          WAJ5DT
     I              FJSPTM                          WASPTM
     I              FJJ6DT                          WAJ6DT
     I              FJLFTM                          WALFTM
     I              FJJ7DT                          WAJ7DT
     I              FJBOTM                          WABOTM
     I              FJJ8DT                          WAJ8DT
     I              FJBLTM                          WABLTM
     I              FJKIDT                          WAKIDT
     I              FJASTM                          WAASTM
     I              FJKADT                          WAKADT
     I              FJAJCM                          WAAJCM
     I              FJXACD                          WAXACD
     I              FJOANA                          WAOANA
     I              FJK4TX                          WAK4TX
     I              FJVOAG                          WAVOAG
     I              FJKBDT                          WAKBDT
     I              FJNBBO                          WANBBO
     I              FJW4CD                          WAW4CD
     I              FJEFDT                          WAEFDT
     I              FJCNTN                          WACNTN
     I              FJKCDT                          WAKCDT
     I              FJTMIN                          WATMIN
     I              FJKDDT                          WAKDDT
     I              FJVMNB                          WAVMNB
     I              FJOCFR                          WAOCFR
     I              FJKJDT                          WAKJDT
     I              FJATTM                          WAATTM
     I              FJOTRS                          WAOTRS
     I              FJRNST                          WARNST
     I              FJBRBK                          WABRBK
     I              FJEIDT                          WAEIDT
     I              FJRMST                          WARMST
     I              FJAJCD                          WAAJCD
     I              FJKKDT                          WAKKDT
     I              FJAVTM                          WAAVTM
     I              FJKZDT                          WAKZDT
     I              FJAXTM                          WAAXTM
     I              FJLHOS                          WALHOS
     I              FJLHOR                          WALHOR
     I              FJWNTX                          WAWNTX
     I              FJOITX                          WAOITX
     I              FJOJTX                          WAOJTX
     I              FJLLDT                          WALLDT
     I              FJLSHG                          WALSHG
     I              FJYPST                          WAYPST
     I              FJK0DT                          WAK0DT
     I              FJAYTM                          WAAYTM
     I              FJKNNX                          WAKNNX
     I              FJICWG                          WAICWG
     I              FJIDWG                          WAIDWG
     I              FJH9SX                          WAH9SX
     I              FJWOTX                          WAWOTX
     I              FJK1DT                          WAK1DT
     I              FJAZTM                          WAAZTM
     I              FJK2DT                          WAK2DT
     I              FJA0TM                          WAA0TM
     I              FJROST                          WAROST
     I              FJRPST                          WARPST
     I              FJRQST                          WARQST
     I              FJRRST                          WARRST
     I              FJZBVA                          WAZBVA
     I              FJWPTX                          WAWPTX
     I              FJWQTX                          WAWQTX
     I              FJWRTX                          WAWRTX
     I              FJWSTX                          WAWSTX
     I              FJRVSX                          WARVSX
     I              FJRUSX                          WARUSX
     I              FJRWSX                          WARWSX
     I              FJRXSX                          WARXSX
     I              FJRYSX                          WARYSX
     I              FJRZSX                          WARZSX
     I              FJR0SX                          WAR0SX
     I              FJR1SX                          WAR1SX
     I              FJR2SX                          WAR2SX
     I              FJR3SX                          WAR3SX
     I              FJR4SX                          WAR4SX
     I              FJPYDT                          WAPYDT
     I              FJCKTM                          WACKTM
     I              FJPZDT                          WAPZDT
     I              FJCLTM                          WACLTM
     I              FJP0DT                          WAP0DT
     I              FJCMTM                          WACMTM
     I              FJP1DT                          WAP1DT
     I              FJCNTM                          WACNTM
     I              FJP2DT                          WAP2DT
     I              FJCOTM                          WACOTM
     I              FJP3DT                          WAP3DT
     I              FJCQTM                          WACQTM
     I              FJUVST                          WAUVST
     I              FJUWST                          WAUWST
     I              FJUXST                          WAUXST
     I              FJAATM                          WAAATM
     I              FJAYNA                          WAAYNA
     I              FJA0NA                          WAA0NA
     I              FJAXDT                          WAAXDT
      *
     I@BFCPR0
      * Order Header TRG          Ld(d)/Ord
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@AVCPG5
      * Customer Comment          Cust/Type/Seq(D)
      * Renamed input format fields
     I              AVBKC7                          WEBKC7
     I              AVI1SX                          WEI1SX
     I              AVM5NX                          WEM5NX
     I              AVXRTX                          WEXRTX
     I              AVUVST                          WEUVST
     I              AVUWST                          WEUWST
     I              AVUXST                          WEUXST
     I              AVVSST                          WEVSST
     I              AVAATM                          WEAATM
     I              AVAYNA                          WEAYNA
     I              AVA0NA                          WEA0NA
     I              AVAXDT                          WEAXDT
      *
     I@BGWKKM
      * Order Detail              Co/Whse/Order
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@BFCPNJ
      * Order Header TRG          Ld/Ord -Avail for Pick
      * Renamed input format fields
     I              BEAIC3                          WGAIC3
     I              BEC4NB                          WGC4NB
     I              BEJNCD                          WGJNCD
     I              BEANC7                          WGANC7
     I              BEBKC7                          WGBKC7
     I              BEBRTX                          WGBRTX
     I              BEHMNA                          WGHMNA
     I              BEHONA                          WGHONA
     I              BEHPNA                          WGHPNA
     I              BEHNNA                          WGHNNA
     I              BEDBCD                          WGDBCD
     I              BECKTX                          WGCKTX
     I              BEB0C7                          WGB0C7
     I              BEAETX                          WGAETX
     I              BEB1NA                          WGB1NA
     I              BEB3NA                          WGB3NA
     I              BEB4NA                          WGB4NA
     I              BEB2NA                          WGB2NA
     I              BEBHCD                          WGBHCD
     I              BEC8TX                          WGC8TX
     I              BEBCNA                          WGBCNA
     I              BEA0DT                          WGA0DT
     I              BEA5DT                          WGA5DT
     I              BEGNDT                          WGGNDT
     I              BEACDT                          WGACDT
     I              BEAQCD                          WGAQCD
     I              BEB6NA                          WGB6NA
     I              BEBYNA                          WGBYNA
     I              BEBZNA                          WGBZNA
     I              BEGTST                          WGGTST
     I              BEGVST                          WGGVST
     I              BEGUST                          WGGUST
     I              BEQFST                          WGQFST
     I              BECQCD                          WGCQCD
     I              BEGJST                          WGGJST
     I              BEGWST                          WGGWST
     I              BEGXST                          WGGXST
     I              BEGYST                          WGGYST
     I              BEAODT                          WGAODT
     I              BEAIVN                          WGAIVN
     I              BECXDT                          WGCXDT
     I              BEJZVA                          WGJZVA
     I              BEA1WG                          WGA1WG
     I              BEXIST                          WGXIST
     I              BEXJST                          WGXJST
     I              BEXKST                          WGXKST
     I              BEEIDT                          WGEIDT
     I              BEAFTM                          WGAFTM
     I              BEE8CD                          WGE8CD
     I              BEE9CD                          WGE9CD
     I              BERMNB                          WGRMNB
     I              BETBNB                          WGTBNB
     I              BER1NB                          WGR1NB
     I              BEPJST                          WGPJST
     I              BEU0ST                          WGU0ST
     I              BEU1ST                          WGU1ST
     I              BEQ2CD                          WGQ2CD
     I              BEU2ST                          WGU2ST
     I              BEVEST                          WGVEST
     I              BEVFST                          WGVFST
     I              BEVGST                          WGVGST
     I              BERPCD                          WGRPCD
     I              BERNNB                          WGRNNB
     I              BEVDST                          WGVDST
     I              BEATIN                          WGATIN
     I              BEU4ST                          WGU4ST
     I              BEU5ST                          WGU5ST
     I              BERSRN                          WGRSRN
     I              BEMHNA                          WGMHNA
     I              BEMINA                          WGMINA
     I              BEWBST                          WGWBST
     I              BER4CD                          WGR4CD
     I              BEBFCD                          WGBFCD
     I              BEQ4CD                          WGQ4CD
     I              BET3NB                          WGT3NB
     I              BESICD                          WGSICD
     I              BECONB                          WGCONB
     I              BECEST                          WGCEST
     I              BEAWDT                          WGAWDT
     I              BEJPCD                          WGJPCD
     I              BEXUST                          WGXUST
     I              BEZ1ST                          WGZ1ST
     I              BEVRVA                          WGVRVA
     I              BEOBST                          WGOBST
     I              BEBCST                          WGBCST
     I              BEBDST                          WGBDST
     I              BEB7VL                          WGB7VL
     I              BEGASX                          WGGASX
     I              BEGBSX                          WGGBSX
     I              BEGCSX                          WGGCSX
     I              BEGDSX                          WGGDSX
     I              BEFNSX                          WGFNSX
     I              BEFOSX                          WGFOSX
     I              BEFPSX                          WGFPSX
     I              BEFQSX                          WGFQSX
     I              BEFRSX                          WGFRSX
     I              BEFSSX                          WGFSSX
     I              BEFTSX                          WGFTSX
     I              BEFUSX                          WGFUSX
     I              BEFVSX                          WGFVSX
     I              BEFWSX                          WGFWSX
     I              BEFXSX                          WGFXSX
     I              BEFYSX                          WGFYSX
     I              BENODT                          WGNODT
     I              BENPDT                          WGNPDT
     I              BENQDT                          WGNQDT
     I              BENRDT                          WGNRDT
     I              BENSDT                          WGNSDT
     I              BEBPTM                          WGBPTM
     I              BEBQTM                          WGBQTM
     I              BEBRTM                          WGBRTM
     I              BEBSTM                          WGBSTM
     I              BEBTTM                          WGBTTM
     I              BEH0NX                          WGH0NX
     I              BEH1NX                          WGH1NX
     I              BEH2NX                          WGH2NX
     I              BEH3NX                          WGH3NX
     I              BEH4NX                          WGH4NX
     I              BEC0C7                          WGC0C7
     I              BEUVST                          WGUVST
     I              BEUWST                          WGUWST
     I              BEUXST                          WGUXST
     I              BEAATM                          WGAATM
     I              BEAYNA                          WGAYNA
     I              BEA0NA                          WGA0NA
     I              BEAXDT                          WGAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WHAIC3
     I              AMC4NB                          WHC4NB
     I              AMRMNB                          WHRMNB
     I              AMRUNB                          WHRUNB
     I              AMXACD                          WHXACD
     I              AMOANA                          WHOANA
     I              AMHBAA                          WHHBAA
     I              AMJ0T1                          WHJ0T1
     I              AMGENY                          WHGENY
     I              AMJ1T1                          WHJ1T1
     I              AMHCAA                          WHHCAA
     I              AMQWDT                          WHQWDT
     I              AMQXDT                          WHQXDT
     I              AMQYDT                          WHQYDT
     I              AMHDAA                          WHHDAA
     I              AMCCTX                          WHCCTX
     I              AMJ2T1                          WHJ2T1
     I              AMRLNA                          WHRLNA
     I              AMRMNA                          WHRMNA
     I              AMGINY                          WHGINY
     I              AMGFNY                          WHGFNY
     I              AMGGNY                          WHGGNY
     I              AMGHNY                          WHGHNY
     I              AMHEVL                          WHHEVL
     I              AMHFVL                          WHHFVL
     I              AMHGVL                          WHHGVL
     I              AMQZDT                          WHQZDT
     I              AMQ0DT                          WHQ0DT
     I              AMQ1DT                          WHQ1DT
     I              AMQ2DT                          WHQ2DT
     I              AMC2TX                          WHC2TX
     I              AMC3TX                          WHC3TX
     I              AMC6TX                          WHC6TX
     I              AMCHTX                          WHCHTX
     I              AMCITX                          WHCITX
     I              AMCLTX                          WHCLTX
     I              AMB4TX                          WHB4TX
     I              AMCUTX                          WHCUTX
     I              AMCVTX                          WHCVTX
     I              AMB9TX                          WHB9TX
     I              AMJWSC                          WHJWSC
     I              AMITNY                          WHITNY
     I              AMLMT1                          WHLMT1
     I              AMLWAA                          WHLWAA
     I              AMFVST                          WHFVST
     I              AMF0ST                          WHF0ST
     I              AMF2ST                          WHF2ST
     I              AMF3ST                          WHF3ST
     I              AMJUSC                          WHJUSC
     I              AMJVSC                          WHJVSC
     I              AMV3T1                          WHV3T1
     I              AMV4T1                          WHV4T1
     I              AMV5T1                          WHV5T1
     I              AMV6T1                          WHV6T1
     I              AMV7T1                          WHV7T1
     I              AMV8T1                          WHV8T1
     I              AMV9T1                          WHV9T1
     I              AMWAT1                          WHWAT1
     I              AMWBT1                          WHWBT1
     I              AMWCT1                          WHWCT1
     I              AMWDT1                          WHWDT1
     I              AMQJNY                          WHQJNY
     I              AMQKNY                          WHQKNY
     I              AMQLNY                          WHQLNY
     I              AMP8NY                          WHP8NY
     I              AMP9NY                          WHP9NY
     I              AMQANY                          WHQANY
     I              AMQCNY                          WHQCNY
     I              AMQDNY                          WHQDNY
     I              AMQENY                          WHQENY
     I              AMQFNY                          WHQFNY
     I              AMQGNY                          WHQGNY
     I              AMQHNY                          WHQHNY
     I              AMQINY                          WHQINY
     I              AMQMNY                          WHQMNY
     I              AMMYU1                          WHMYU1
     I              AMJXSC                          WHJXSC
     I              AMJYSC                          WHJYSC
     I              AMJZSC                          WHJZSC
     I              AMJ0SC                          WHJ0SC
     I              AMMZU1                          WHMZU1
     I              AMM0U1                          WHM0U1
     I              AMM1U1                          WHM1U1
     I              AMM2U1                          WHM2U1
     I              AMM3U1                          WHM3U1
     I              AMW5DT                          WHW5DT
     I              AMW6DT                          WHW6DT
     I              AMUVST                          WHUVST
     I              AMUWST                          WHUWST
     I              AMUXST                          WHUXST
     I              AMVSST                          WHVSST
     I              AMAATM                          WHAATM
     I              AMAYNA                          WHAYNA
     I              AMA0NA                          WHA0NA
     I              AMAXDT                          WHAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Header
      * I :  Load ID
     I                                    P   1   40P1RMNB
      * I :  Company Number
     I                                    P   5   60P1AIC3
      * I :  Scheduled Ship Date
     I                                    P   7  100P1AODT
     IP2PARM      DS
      * FLD: Load Detail
      * N :  Order Number
     I                                    P   1   40P2C4NB
     IP3PARM      DS
      * I :  USR Detail or Summary
     I                                        1   1 P3STST
     IP4PARM      DS
      * FLD: Order Header TRG
      * N :  Order in Use
     I                                        1   1 P4GJST
      * N :  Header Status
     I                                        2   2 P4GWST
      * N :  Order Type Print Status
     I                                        3   3 P4GYST
      * N :  Print Pick Slip
     I                                        4   4 P4U5ST
     IP5PARM      DS
      * FLD: *Arrays
      * I :  USR Warehouse Code
     I                                        1   3 P5CPCD
      * I :  USR CDE Parm 1
     I                                        4   6 P5VSCD
      * I :  USR CDE Parm 2
     I                                        7   9 P5VTCD
      * I :  USR CDE Parm 3
     I                                       10  12 P5VUCD
      * I :  USR CDE Parm 4
     I                                       13  15 P5VVCD
      * I :  USR CDE Parm 5
     I                                       16  18 P5VWCD
      * I :  USR CDE Parm 6
     I                                       19  21 P5VXCD
      * I :  USR CDE Parm 7
     I                                       22  24 P5VYCD
      * I :  USR CDE Parm 8
     I                                       25  27 P5VZCD
      * I :  USR CDE Parm 9
     I                                       28  30 P5V0CD
      * I :  USR Select/Omit Flag
     I                                       31  31 P5CYST
     IP6PARM      DS
      * I :  AUTO PRINT PRELIM PICK
     I                                        1   1 P6CLST
     IP7PARM      DS
      * I :  Load U_M
     I                                        1   2 P7R0SX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Requested Delv Date Error'
      * Requested Delivery Dt
     I                                    P   1   40ZA0001
      * Message data for 'Scheduled Ship Date Req'd'
      * Scheduled Ship Date
     I                                    P   1   40ZA0002
      * Message data for 'PrdDte Shipped BEF Made'
      * Production AgeDte Fr
     I                                    P   1   40ZA0003
      * Message data for 'Enter Age Days or Dates'
      * Item Age Days
     I                                    P   1   30ZA0004
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0005
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0006
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0007
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0008
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0009
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0010
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0011
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0012
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0013
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0014
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0015
      * Message data for 'Invalid Item Age Days'
      * Item Age Days
     I                                    P   1   30ZA0016
      * Message data for 'Invalid Prod OvrDates'
      * Production AgeDte Fr
     I                                    P   1   40ZA0017
      * Production AgeDte To
     I                                    P   5   80ZA0018
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P1AIC3    PARM           WP0002  30       Company Number
     C           P1AODT    PARM           WP0003  70       Scheduled Ship
     C           P3STST    PARM           WP0004  1        USR Detail or S
     C           P5CPCD    PARM           WP0005  3        USR Warehouse C
     C           P5VSCD    PARM           WP0006  3        USR CDE Parm 1
     C           P5VTCD    PARM           WP0007  3        USR CDE Parm 2
     C           P5VUCD    PARM           WP0008  3        USR CDE Parm 3
     C           P5VVCD    PARM           WP0009  3        USR CDE Parm 4
     C           P5VWCD    PARM           WP0010  3        USR CDE Parm 5
     C           P5VXCD    PARM           WP0011  3        USR CDE Parm 6
     C           P5VYCD    PARM           WP0012  3        USR CDE Parm 7
     C           P5VZCD    PARM           WP0013  3        USR CDE Parm 8
     C           P5V0CD    PARM           WP0014  3        USR CDE Parm 9
     C           P5CYST    PARM           WP0015  1        USR Select/Omit
     C           P6CLST    PARM           WP0016  1        AUTO PRINT PREL
     C           P7R0SX    PARM           WP0017  2        Load U_M
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT PrelPick /LoadId PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$YENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT PrelPick /LoadId PF: Mainline
      *================================================================
      * Establish starting position
     C           *LOVAL    SETLL@FJCPD4                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Deadline Depart
     C                     MOVEL'Y'       W0AL02  1        Deadline Depart
     C                     MOVEL'Y'       W0AL03  1        Load ID
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDFJAIC3    $CAIC3           Company Number
     C                     Z-ADDFJKZDT    $CKZDT           Deadline Depart
     C                     Z-ADDFJP0DT    $CP0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    $CCMTM           LPT Load Plan S
      * Load related totals format
     C                     Z-ADDFJAIC3    $XAIC3           Company Number
     C                     Z-ADDFJKZDT    $XKZDT           Deadline Depart
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDFJAIC3    $DAIC3           Company Number
     C                     Z-ADDFJKZDT    $DKZDT           Deadline Depart
     C                     Z-ADDFJAXTM    $DAXTM           Deadline Depart
      * Load related totals format
     C                     Z-ADDFJAIC3    $WAIC3           Company Number
     C                     Z-ADDFJKZDT    $WKZDT           Deadline Depart
     C                     Z-ADDFJAXTM    $WAXTM           Deadline Depart
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDFJAIC3    $EAIC3           Company Number
     C                     Z-ADDFJT4NB    $ET4NB           Schedule Sequen
     C                     Z-ADDFJRMNB    $ERMNB           Load ID
     C                     Z-ADDFJAODT    $EAODT           Scheduled Ship
     C                     MOVEL*BLANK    $EQ2CD           Shipping Method
     C                     MOVELFJBZNA    $EBZNA           Carrier Code
     C                     MOVELFJPJST    $EPJST           LTL Flag
     C                     Z-ADDFJRNNB    $ERNNB           Reefer Temperat
     C                     MOVELFJDMTX    $EDMTX           Seal 1
     C                     MOVELFJDNTX    $EDNTX           Seal 2
     C                     MOVELFJDOTX    $EDOTX           Seal 3
     C                     MOVELFJWTTX    $EWTTX           Seal 4
     C                     MOVELFJWUTX    $EWUTX           Seal 2 Unused
     C                     Z-ADDFJFLAM    $EFLAM           Flat Amount
     C                     MOVELFJXQST    $EXQST           Allocate Pounds
     C                     Z-ADDFJRRNB    $ERRNB           Total Stops
     C                     MOVELFJDXTX    $EDXTX           Trailer Id
     C                     MOVELFJDYTX    $EDYTX           Transloader Car
     C                     Z-ADDFJSBNB    $ESBNB           BOL Time
     C                     MOVELFJRONB    $ERONB           Truck Size
     C                     Z-ADDFJTLMI    $ETLMI           Total Load Mile
     C                     Z-ADDFJRPNB    $ERPNB           Total Load Orde
     C                     Z-ADDFJSQNB    $ESQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADDFJR1NB    $ER1NB           Rated Freight
     C                     MOVELFJVCST    $EVCST           Ship Status
     C                     MOVELFJVDST    $EVDST           Load Type
     C                     Z-ADDFJSDNB    $ESDNB           Number Pallets
     C                     Z-ADDFJPAOU    $EPAOU           Number Pallets
     C                     Z-ADDFJDGWG    $EDGWG           Load Carrier Pa
     C                     Z-ADDFJSXNB    $ESXNB           Estimated Arriv
     C                     Z-ADDFJHADT    $EHADT           Actual Arrival
     C                     Z-ADDFJAART    $EAART           Actual Arrival
     C                     Z-ADDFJDHWG    $EDHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    $EDIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    $EAQDT           Actual Departur
     C                     Z-ADDFJS6NB    $ES6NB           Departure Time
     C                     Z-ADDFJPRTM    $EPRTM           Product Tempera
     C                     Z-ADDFJNPSV    $ENPSV           Number Spacers
     C                     MOVELFJJ8TX    $EJ8TX           Car_Veh_Initial
     C                     MOVELFJPKST    $EPKST           Load Status
     C                     MOVELFJJ9TX    $EJ9TX           Recorder ID
     C                     MOVELFJVPCD    $EVPCD           Ship From Wareh
     C                     MOVELFJDBCD    $EDBCD           Ship To State C
     C                     Z-ADDFJGRWE    $EGRWE           Gross Weight
     C                     MOVELFJXCCD    $EXCCD           Carrier Broker
     C                     MOVELFJU2ST    $EU2ST           Export Status
     C                     Z-ADDFJF9DT    $EF9DT           Actual Ship Dat
     C                     MOVELFJONTM    $EONTM           On Time_Y_N
     C                     Z-ADDFJJ4DT    $EJ4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    $ETRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    $EJ5DT           Spotted Date
     C                     Z-ADDFJSPTM    $ESPTM           Spotted Time
     C                     Z-ADDFJJ6DT    $EJ6DT           Load Finished D
     C                     Z-ADDFJLFTM    $ELFTM           Load Finished T
     C                     Z-ADDFJJ7DT    $EJ7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    $EBOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    $EJ8DT           BOL Received Da
     C                     Z-ADDFJBLTM    $EBLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    $EKIDT           Truck Departure
     C                     Z-ADDFJASTM    $EASTM           Truck Departure
     C                     Z-ADDFJKADT    $EKADT           Adjusted Depart
     C                     Z-ADDFJAJCM    $EAJCM           Adjusted Depart
     C                     MOVELFJXACD    $EXACD           Shipping Line
     C                     MOVELFJOANA    $EOANA           Port Delv Termi
     C                     MOVELFJK4TX    $EK4TX           Vessel Name
     C                     Z-ADDFJVOAG    $EVOAG           Voyage
     C                     Z-ADDFJKBDT    $EKBDT           Sail Date
     C                     MOVELFJNBBO    $ENBBO           Booking Number
     C                     MOVELFJW4CD    $EW4CD           Discharge Port
     C                     Z-ADDFJEFDT    $EEFDT           Arrival Date
     C                     MOVELFJCNTN    $ECNTN           Container Numbe
     C                     Z-ADDFJKCDT    $EKCDT           Date In
     C                     Z-ADDFJTMIN    $ETMIN           Time In
     C                     Z-ADDFJKDDT    $EKDDT           Date Out
     C                     Z-ADDFJVMNB    $EVMNB           Time Out
     C                     Z-ADDFJOCFR    $EOCFR           Load Total Frei
     C                     Z-ADDFJKJDT    $EKJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    $EATTM           Scheduled Deliv
     C                     MOVELFJOTRS    $EOTRS           LH Unused Sts
     C                     MOVELFJRNST    $ERNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    $EBRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    $EEIDT           Requested Deliv
     C                     MOVELFJRMST    $ERMST           Load Acceptance
     C                     MOVELFJAJCD    $EAJCD           Warehouse Code
     C                     Z-ADDFJKKDT    $EKKDT           On Yard Date
     C                     Z-ADDFJAVTM    $EAVTM           On Yard Time
     C                     Z-ADDFJKZDT    $EKZDT           Deadline Depart
     C                     Z-ADDFJAXTM    $EAXTM           Deadline Depart
     C                     MOVELFJLHOS    $ELHOS           Load Held Over
     C                     MOVELFJLHOR    $ELHOR           Load Held Over
     C                     MOVELFJWNTX    $EWNTX           Load Held Over
     C                     MOVELFJOITX    $EOITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    $EOJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    $ELLDT           Express Mail Da
     C                     MOVELFJLSHG    $ELSHG           Load Shag Flag
     C                     MOVELFJYPST    $EYPST           Load Wash Flag
     C                     Z-ADDFJK0DT    $EK0DT           Product Complet
     C                     Z-ADDFJAYTM    $EAYTM           Product Complet
     C                     Z-ADDFJKNNX    $EKNNX           Pallets Loaded
     C                     Z-ADDFJICWG    $EICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    $EIDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    $EH9SX           Load Confirmed
     C                     MOVELFJWOTX    $EWOTX           Load Confirmed
     C                     Z-ADDFJK1DT    $EK1DT           Load Confirmati
     C                     Z-ADDFJAZTM    $EAZTM           Load Door 1
     C                     Z-ADDFJK2DT    $EK2DT           Override Total
     C                     Z-ADDFJA0TM    $EA0TM           Load Door 2
     C                     MOVELFJROST    $EROST           Partial Load
     C                     MOVELFJRPST    $ERPST           Load Confirmati
     C                     MOVELFJRQST    $ERQST           Export Load USD
     C                     MOVELFJRRST    $ERRST           Late Delivery E
     C                     Z-ADDFJZBVA    $EZBVA           Load Actual Fre
     C                     MOVELFJWPTX    $EWPTX           Hide on WW Load
     C                     MOVELFJWQTX    $EWQTX           Late Billing Em
     C                     MOVELFJWRTX    $EWRTX           Shipping Temp C
     C                     MOVELFJWSTX    $EWSTX           LH Held Over Rs
     C                     MOVELFJRVSX    $ERVSX           Multi Company L
     C                     MOVELFJRUSX    $ERUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    $ERWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    $ERXSX           LH Power Only L
     C                     MOVELFJRYSX    $ERYSX           MG Created Load
     C                     MOVELFJRZSX    $ERZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    $ER0SX           Load U_M
     C                     MOVELFJR1SX    $ER1SX           TPM Shipment St
     C                     MOVELFJR2SX    $ER2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    $ER3SX           LH On-Time Reas
     C                     MOVELFJR4SX    $ER4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    $EPYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    $ECKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    $EPZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    $ECLTM           LH Last Combo P
     C                     Z-ADDFJP0DT    $EP0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    $ECMTM           LPT Load Plan S
     C                     Z-ADDFJP1DT    $EP1DT           TPM Planned Shi
     C                     Z-ADDFJCNTM    $ECNTM           LH Unused Time
     C                     Z-ADDFJP2DT    $EP2DT           LH Unused Date
     C                     Z-ADDFJCOTM    $ECOTM           LH Unused Time
     C                     Z-ADDFJP3DT    $EP3DT           LH Unused Date
     C                     Z-ADDFJCQTM    $ECQTM           LH Unused Time
     C                     MOVELFJUVST    $EUVST           EDI Status 1
     C                     MOVELFJUWST    $EUWST           EDI Status 2
     C                     MOVELFJUXST    $EUXST           EDI Status 3
     C                     Z-ADDFJAATM    $EAATM           Job Time
     C                     MOVELFJAYNA    $EAYNA           User Id
     C                     MOVELFJA0NA    $EA0NA           Job Name
     C                     Z-ADDFJAXDT    $EAXDT           Job Date
      * Load related totals format
     C                     Z-ADDFJAIC3    $VAIC3           Company Number
     C                     Z-ADDFJRMNB    $VRMNB           Load ID
     C                     Z-ADDFJAODT    $VAODT           Scheduled Ship
     C                     MOVELFJWTTX    $VWTTX           Seal 4
     C                     MOVELFJWUTX    $VWUTX           Seal 2 Unused
     C                     Z-ADDFJGRWE    $VGRWE           Gross Weight
     C                     MOVELFJXCCD    $VXCCD           Carrier Broker
     C                     MOVELFJU2ST    $VU2ST           Export Status
     C                     Z-ADDFJF9DT    $VF9DT           Actual Ship Dat
     C                     MOVELFJONTM    $VONTM           On Time_Y_N
     C                     Z-ADDFJJ4DT    $VJ4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    $VTRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    $VJ5DT           Spotted Date
     C                     Z-ADDFJSPTM    $VSPTM           Spotted Time
     C                     Z-ADDFJJ6DT    $VJ6DT           Load Finished D
     C                     Z-ADDFJLFTM    $VLFTM           Load Finished T
     C                     Z-ADDFJJ7DT    $VJ7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    $VBOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    $VJ8DT           BOL Received Da
     C                     Z-ADDFJBLTM    $VBLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    $VKIDT           Truck Departure
     C                     Z-ADDFJASTM    $VASTM           Truck Departure
     C                     Z-ADDFJKADT    $VKADT           Adjusted Depart
     C                     Z-ADDFJAJCM    $VAJCM           Adjusted Depart
     C                     MOVELFJXACD    $VXACD           Shipping Line
     C                     MOVELFJOANA    $VOANA           Port Delv Termi
     C                     MOVELFJK4TX    $VK4TX           Vessel Name
     C                     Z-ADDFJVOAG    $VVOAG           Voyage
     C                     Z-ADDFJKBDT    $VKBDT           Sail Date
     C                     MOVELFJNBBO    $VNBBO           Booking Number
     C                     MOVELFJW4CD    $VW4CD           Discharge Port
     C                     Z-ADDFJEFDT    $VEFDT           Arrival Date
     C                     MOVELFJCNTN    $VCNTN           Container Numbe
     C                     Z-ADDFJKCDT    $VKCDT           Date In
     C                     Z-ADDFJTMIN    $VTMIN           Time In
     C                     Z-ADDFJKDDT    $VKDDT           Date Out
     C                     Z-ADDFJVMNB    $VVMNB           Time Out
     C                     Z-ADDFJOCFR    $VOCFR           Load Total Frei
     C                     Z-ADDFJKJDT    $VKJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    $VATTM           Scheduled Deliv
     C                     MOVELFJOTRS    $VOTRS           LH Unused Sts
     C                     MOVELFJRNST    $VRNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    $VBRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    $VEIDT           Requested Deliv
     C                     MOVELFJRMST    $VRMST           Load Acceptance
     C                     MOVELFJAJCD    $VAJCD           Warehouse Code
     C                     Z-ADDFJKKDT    $VKKDT           On Yard Date
     C                     Z-ADDFJAVTM    $VAVTM           On Yard Time
     C                     Z-ADDFJKZDT    $VKZDT           Deadline Depart
     C                     Z-ADDFJAXTM    $VAXTM           Deadline Depart
     C                     MOVELFJLHOS    $VLHOS           Load Held Over
     C                     MOVELFJLHOR    $VLHOR           Load Held Over
     C                     MOVELFJWNTX    $VWNTX           Load Held Over
     C                     MOVELFJOITX    $VOITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    $VOJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    $VLLDT           Express Mail Da
     C                     MOVELFJLSHG    $VLSHG           Load Shag Flag
     C                     MOVELFJYPST    $VYPST           Load Wash Flag
     C                     Z-ADDFJK0DT    $VK0DT           Product Complet
     C                     Z-ADDFJAYTM    $VAYTM           Product Complet
     C                     Z-ADDFJKNNX    $VKNNX           Pallets Loaded
     C                     Z-ADDFJICWG    $VICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    $VIDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    $VH9SX           Load Confirmed
     C                     MOVELFJWOTX    $VWOTX           Load Confirmed
     C                     Z-ADDFJK1DT    $VK1DT           Load Confirmati
     C                     Z-ADDFJAZTM    $VAZTM           Load Door 1
     C                     Z-ADDFJK2DT    $VK2DT           Override Total
     C                     Z-ADDFJA0TM    $VA0TM           Load Door 2
     C                     MOVELFJROST    $VROST           Partial Load
     C                     MOVELFJRPST    $VRPST           Load Confirmati
     C                     MOVELFJRQST    $VRQST           Export Load USD
     C                     MOVELFJRRST    $VRRST           Late Delivery E
     C                     Z-ADDFJZBVA    $VZBVA           Load Actual Fre
     C                     MOVELFJWPTX    $VWPTX           Hide on WW Load
     C                     MOVELFJWQTX    $VWQTX           Late Billing Em
     C                     MOVELFJWRTX    $VWRTX           Shipping Temp C
     C                     MOVELFJWSTX    $VWSTX           LH Held Over Rs
     C                     MOVELFJRVSX    $VRVSX           Multi Company L
     C                     MOVELFJRUSX    $VRUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    $VRWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    $VRXSX           LH Power Only L
     C                     MOVELFJRYSX    $VRYSX           MG Created Load
     C                     MOVELFJRZSX    $VRZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    $VR0SX           Load U_M
     C                     MOVELFJR1SX    $VR1SX           TPM Shipment St
     C                     MOVELFJR2SX    $VR2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    $VR3SX           LH On-Time Reas
     C                     MOVELFJR4SX    $VR4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    $VPYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    $VCKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    $VPZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    $VCLTM           LH Last Combo P
     C                     Z-ADDFJP0DT    $VP0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    $VCMTM           LPT Load Plan S
     C                     Z-ADDFJP1DT    $VP1DT           TPM Planned Shi
     C                     Z-ADDFJCNTM    $VCNTM           LH Unused Time
     C                     Z-ADDFJP2DT    $VP2DT           LH Unused Date
     C                     Z-ADDFJCOTM    $VCOTM           LH Unused Time
     C                     Z-ADDFJP3DT    $VP3DT           LH Unused Date
     C                     Z-ADDFJCQTM    $VCQTM           LH Unused Time
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDFJAIC3    $FAIC3           Company Number
     C                     Z-ADDFJT4NB    $FT4NB           Schedule Sequen
     C                     Z-ADDFJRMNB    $FRMNB           Load ID
     C                     Z-ADD*ZERO     $FRVNB           Stop_Drop
     C                     Z-ADDFJAODT    $FAODT           Scheduled Ship
     C                     Z-ADD*ZERO     $FC4NB           Order Number
     C                     MOVEL*BLANK    $FAYTX           Customer Name
     C                     MOVELFJQ2CD    $FQ2CD           Shipping Method
     C                     MOVELFJBZNA    $FBZNA           Carrier Code
     C                     MOVELFJDXTX    $FDXTX           Trailer Id
     C                     MOVELFJRONB    $FRONB           Truck Size
     C                     Z-ADDFJTLMI    $FTLMI           Total Load Mile
     C                     MOVELFJWTTX    $FWTTX           Seal 4
     C                     MOVELFJWUTX    $FWUTX           Seal 2 Unused
     C                     MOVELFJVDST    $FVDST           Load Type
     C                     MOVELFJJ8TX    $FJ8TX           Car_Veh_Initial
     C                     MOVELFJJ9TX    $FJ9TX           Recorder ID
     C                     Z-ADDFJGRWE    $FGRWE           Gross Weight
     C                     MOVELFJXCCD    $FXCCD           Carrier Broker
     C                     MOVELFJU2ST    $FU2ST           Export Status
     C                     Z-ADDFJF9DT    $FF9DT           Actual Ship Dat
     C                     MOVELFJONTM    $FONTM           On Time_Y_N
     C                     Z-ADDFJJ4DT    $FJ4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    $FTRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    $FJ5DT           Spotted Date
     C                     Z-ADDFJSPTM    $FSPTM           Spotted Time
     C                     Z-ADDFJJ6DT    $FJ6DT           Load Finished D
     C                     Z-ADDFJLFTM    $FLFTM           Load Finished T
     C                     Z-ADDFJJ7DT    $FJ7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    $FBOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    $FJ8DT           BOL Received Da
     C                     Z-ADDFJBLTM    $FBLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    $FKIDT           Truck Departure
     C                     Z-ADDFJASTM    $FASTM           Truck Departure
     C                     Z-ADDFJKADT    $FKADT           Adjusted Depart
     C                     Z-ADDFJAJCM    $FAJCM           Adjusted Depart
     C                     MOVELFJXACD    $FXACD           Shipping Line
     C                     MOVELFJOANA    $FOANA           Port Delv Termi
     C                     MOVELFJK4TX    $FK4TX           Vessel Name
     C                     Z-ADDFJVOAG    $FVOAG           Voyage
     C                     Z-ADDFJKBDT    $FKBDT           Sail Date
     C                     MOVELFJNBBO    $FNBBO           Booking Number
     C                     MOVELFJW4CD    $FW4CD           Discharge Port
     C                     Z-ADDFJEFDT    $FEFDT           Arrival Date
     C                     MOVELFJCNTN    $FCNTN           Container Numbe
     C                     Z-ADDFJKCDT    $FKCDT           Date In
     C                     Z-ADDFJTMIN    $FTMIN           Time In
     C                     Z-ADDFJKDDT    $FKDDT           Date Out
     C                     Z-ADDFJVMNB    $FVMNB           Time Out
     C                     Z-ADDFJOCFR    $FOCFR           Load Total Frei
     C                     Z-ADDFJKJDT    $FKJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    $FATTM           Scheduled Deliv
     C                     MOVELFJOTRS    $FOTRS           LH Unused Sts
     C                     MOVELFJRNST    $FRNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    $FBRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    $FEIDT           Requested Deliv
     C                     MOVELFJRMST    $FRMST           Load Acceptance
     C                     MOVELFJAJCD    $FAJCD           Warehouse Code
     C                     Z-ADDFJKKDT    $FKKDT           On Yard Date
     C                     Z-ADDFJAVTM    $FAVTM           On Yard Time
     C                     Z-ADDFJKZDT    $FKZDT           Deadline Depart
     C                     Z-ADDFJAXTM    $FAXTM           Deadline Depart
     C                     MOVELFJLHOS    $FLHOS           Load Held Over
     C                     MOVELFJLHOR    $FLHOR           Load Held Over
     C                     MOVELFJWNTX    $FWNTX           Load Held Over
     C                     MOVELFJOITX    $FOITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    $FOJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    $FLLDT           Express Mail Da
     C                     MOVELFJLSHG    $FLSHG           Load Shag Flag
     C                     MOVELFJYPST    $FYPST           Load Wash Flag
     C                     Z-ADDFJK0DT    $FK0DT           Product Complet
     C                     Z-ADDFJAYTM    $FAYTM           Product Complet
     C                     Z-ADDFJKNNX    $FKNNX           Pallets Loaded
     C                     Z-ADDFJICWG    $FICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    $FIDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    $FH9SX           Load Confirmed
     C                     MOVELFJWOTX    $FWOTX           Load Confirmed
     C                     Z-ADDFJK1DT    $FK1DT           Load Confirmati
     C                     Z-ADDFJAZTM    $FAZTM           Load Door 1
     C                     Z-ADDFJK2DT    $FK2DT           Override Total
     C                     Z-ADDFJA0TM    $FA0TM           Load Door 2
     C                     MOVELFJROST    $FROST           Partial Load
     C                     MOVELFJRPST    $FRPST           Load Confirmati
     C                     MOVELFJRQST    $FRQST           Export Load USD
     C                     MOVELFJRRST    $FRRST           Late Delivery E
     C                     Z-ADDFJZBVA    $FZBVA           Load Actual Fre
     C                     MOVELFJWPTX    $FWPTX           Hide on WW Load
     C                     MOVELFJWQTX    $FWQTX           Late Billing Em
     C                     MOVELFJWRTX    $FWRTX           Shipping Temp C
     C                     MOVELFJWSTX    $FWSTX           LH Held Over Rs
     C                     MOVELFJRVSX    $FRVSX           Multi Company L
     C                     MOVELFJRUSX    $FRUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    $FRWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    $FRXSX           LH Power Only L
     C                     MOVELFJRYSX    $FRYSX           MG Created Load
     C                     MOVELFJRZSX    $FRZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    $FR0SX           Load U_M
     C                     MOVELFJR1SX    $FR1SX           TPM Shipment St
     C                     MOVELFJR2SX    $FR2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    $FR3SX           LH On-Time Reas
     C                     MOVELFJR4SX    $FR4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    $FPYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    $FCKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    $FPZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    $FCLTM           LH Last Combo P
     C                     Z-ADDFJP0DT    $FP0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    $FCMTM           LPT Load Plan S
     C                     Z-ADDFJP1DT    $FP1DT           TPM Planned Shi
     C                     Z-ADDFJCNTM    $FCNTM           LH Unused Time
     C                     Z-ADDFJP2DT    $FP2DT           LH Unused Date
     C                     Z-ADDFJCOTM    $FCOTM           LH Unused Time
     C                     Z-ADDFJP3DT    $FP3DT           LH Unused Date
     C                     Z-ADDFJCQTM    $FCQTM           LH Unused Time
     C                     MOVELFJPKST    $FPKST           Load Status
     C                     Z-ADDFJRNNB    $FRNNB           Reefer Temperat
      * USER: Process before print of detail format
      * CASE: PAR.USR Detail or Summary is Detail
     C           P3STST    IFEQ 'D'                        *IF
      * New Page Print - /UT User Source  * 
     C                     MOVEL'Y'       W0NEWP           NEW PAGE
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Prelim List Dtls   PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN FJAIC3    WZA001           Company Number
     C                     Z-ADDFJAIC3    WZA001
     C           *LIKE     DEFN FJKZDT    WZA002           Deadline Depart
     C                     Z-ADDFJKZDT    WZA002
     C           *LIKE     DEFN FJAXTM    WZA003           Deadline Depart
     C                     Z-ADDFJAXTM    WZA003
     C           *LIKE     DEFN FJRMNB    WZA004           Load ID
     C                     Z-ADDFJRMNB    WZA004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C                     READ @FJCPD4                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Load Id or Schedule Ship Date
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Load ID is GT Zero
      *   |- c2    : PAR.Load ID NE DB1.Load ID
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1RMNB    IFGT *ZERO                      *IF
     C           P1RMNB    IFNE FJRMNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Scheduled Ship Date is entered
      *   |- c2    : PAR.Scheduled Ship Date NE DB1.Scheduled Ship Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AODT    IFNE *ZERO                      *IF
     C           P1AODT    IFNE FJAODT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Select records
      * CASE: PGM.*Record selected is *NO
     C           W0RSL     IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     P2C4NB           Order Number
      * RTV Prelim Pick Orders RT - OP Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0025           Load ID
     C                     Z-ADDP2C4NB    WL0026           Order Number
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0026    P2C4NB           Order Number
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * Check for at least one valid warehouse
      * VAL Prelim List Dtls   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0027           Load ID
     C                     MOVELP5CPCD    WL0028    P      USR Warehouse C
     C                     MOVELP5VSCD    WL0029    P      USR CDE Parm 1
     C                     MOVELP5VTCD    WL0030    P      USR CDE Parm 2
     C                     MOVELP5VUCD    WL0031    P      USR CDE Parm 3
     C                     MOVELP5VVCD    WL0032    P      USR CDE Parm 4
     C                     MOVELP5VWCD    WL0033    P      USR CDE Parm 5
     C                     MOVELP5VXCD    WL0034    P      USR CDE Parm 6
     C                     MOVELP5VYCD    WL0035    P      USR CDE Parm 7
     C                     MOVELP5VZCD    WL0036    P      USR CDE Parm 8
     C                     MOVELP5V0CD    WL0037    P      USR CDE Parm 9
     C                     MOVELP5CYST    WL0038    P      USR Select/Omit
     C                     EXSR TBRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Deadline Depart
     C                     MOVEL*BLANK    W0AL02  1        Deadline Depart
     C                     MOVEL*BLANK    W0AL03  1        Load ID
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Deadline Depart
     C                     MOVEL'Y'       W0AL02  1        Deadline Depart
     C                     MOVEL'Y'       W0AL03  1        Load ID
     C                     ELSE
      * Next record - Detect level breaks
     C           FJAIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           FJKZDT    IFNE WZA002                     Deadline Depart
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           FJAXTM    IFNE WZA003                     Deadline Depart
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           FJRMNB    IFNE WZA004                     Load ID
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL03    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$VKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$WKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert Deadline Departure Date to display format
      * Convert date
     C           1000000   ADD  $XKZDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VXKZDT
      * Print format
     C                     WRITE$XKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PRT Prelim List Dtls   PO: Mainline
      *================================================================
      * PRT Prelim List Dtls   PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQKB02           Load ID
      * Define keylist
     C           KPSB      KLIST
     C                     KFLD           WQKB02           Load ID
     C                     KFLD           FLRVNB           Stop_Drop
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB02           Load ID
      * Setup key
     C                     Z-ADD$FRMNB    WQKB02           Load ID
     C                     Z-ADD99999     FLRVNB           Stop_Drop
      * Establish starting position
     C           KPSB      SETLL@FLCPE8                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Load ID
     C                     MOVEL'Y'       W0BL01  1        Stop_Drop
     C                     MOVEL'Y'       W0BL02  1        Order Number
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $UCDWG           USR Weight Accu
     C                     Z-ADD*ZERO     $UA4WG           Tare Weight Tot
     C                     Z-ADDFLAIC3    $UAIC3           Company Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $SA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     $SCDWG           USR Weight Accu
     C                     Z-ADDFLAIC3    $SAIC3           Company Number
     C                     Z-ADDFLRMNB    $SRMNB           Load ID
     C                     Z-ADDFLRVNB    $SRVNB           Stop_Drop
     C                     Z-ADDFLC4NB    $SC4NB           Order Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADD*ZERO     $GT4NB           Schedule Sequen
     C                     Z-ADDFLRMNB    $GRMNB           Load ID
     C                     Z-ADD*ZERO     $GBNC3           Company
     C                     Z-ADD*ZERO     $GAODT           Scheduled Ship
     C                     MOVEL*BLANK    $GQ2CD           Shipping Method
     C                     MOVEL*BLANK    $GBZNA           Carrier Code
     C                     MOVEL*BLANK    $GMUTX           Trailer Id
     C                     MOVEL*BLANK    $GRONB           Truck Size
     C                     Z-ADD*ZERO     $GGFDT           Departure Date
     C                     Z-ADD*ZERO     $GS6NB           Departure Time
     C                     Z-ADD*ZERO     $GTLMI           Total Load Mile
     C                     MOVEL*BLANK    $GVDST           Load Type
     C                     MOVEL*BLANK    $GJ8TX           Car_Veh_Initial
     C                     MOVEL*BLANK    $GPKST           Load Status
     C                     Z-ADD*ZERO     $GRNNB           Reefer Temperat
     C                     MOVEL*BLANK    $GFRSX           Shipping Temp C
     C                     MOVEL*BLANK    $GXACD           Shipping Line
     C                     Z-ADD*ZERO     $GP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     $GCMTM           LPT Load Plan S
     C                     MOVEL*BLANK    $GJFNA           @Narrative  6
     C                     Z-ADDFLRVNB    $GRVNB           Stop_Drop
     C                     Z-ADDFLC4NB    $GC4NB           Order Number
     C                     Z-ADDFLAIC3    $GAIC3           Company Number
     C                     MOVEL*BLANK    $GLKNA           USR Customer 20
     C                     MOVEL*BLANK    $GAJCD           Warehouse Code
     C                     Z-ADD*ZERO     $GA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     $GHGCD           Item Code
     C                     Z-ADD*ZERO     $GAUWG           Weight Schedule
     C                     Z-ADD*ZERO     $GA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     $GN8QT           Qty Sched Ord U
     C                     Z-ADD*ZERO     $GN2QT           Qty Std Prod 1
     C                     Z-ADD*ZERO     $GCCQT           Quantity Schedu
     C                     MOVEL*BLANK    $GAGCD           U_M_Ordered
     C                     Z-ADD*ZERO     $GEIDT           Requested Deliv
     C                     MOVEL*BLANK    $GR4CD           Sales Route Cod
     C                     MOVELFLVCST    $GVCST           Ship Status
     C                     Z-ADDFLKEDT    $GKEDT           Estimated Arriv
     C                     Z-ADDFLSXNB    $GSXNB           Estimated Arriv
     C                     Z-ADDFLKFDT    $GKFDT           Appointment Con
     C                     Z-ADDFLACTM    $GACTM           Appointment Con
     C                     MOVELFLK5TX    $GK5TX           Confirmation Ma
     C                     MOVELFLW5CD    $GW5CD           Confirmation Nu
     C                     Z-ADDFLEJDT    $GEJDT           Actual Delivery
     C                     Z-ADDFLAGTM    $GAGTM           Actual Delivery
     C                     Z-ADDFLKJDT    $GKJDT           Scheduled Deliv
     C                     Z-ADDFLATTM    $GATTM           Scheduled Deliv
     C                     Z-ADDFLHDDT    $GHDDT           Deadline Depart
     C                     Z-ADDFLAUTM    $GAUTM           Deadline Depart
     C                     Z-ADDFLKKDT    $GKKDT           On Yard Date
     C                     Z-ADDFLAVTM    $GAVTM           On Yard Time
     C                     MOVELFLY7ST    $GY7ST           Load Dtl On Tim
     C                     MOVELFLY2ST    $GY2ST           On Time Addl Rs
     C                     MOVELFLWHTX    $GWHTX           Seal Nbr 1
     C                     MOVELFLWITX    $GWITX           Seal Nbr 2
     C                     MOVELFLWJTX    $GWJTX           Seal Nbr 3
     C                     MOVELFLWKTX    $GWKTX           Seal Nbr 4
     C                     MOVELFLWLTX    $GWLTX           Seal Nbr 5
     C                     Z-ADDFLN7DT    $GN7DT           LD Carrier Appt
     C                     Z-ADDFLN8DT    $GN8DT           LD Unused Date
     C                     Z-ADDFLN9DT    $GN9DT           LD Unused Date
     C                     Z-ADDFLB3TM    $GB3TM           LD Carrier Appt
     C                     Z-ADDFLB4TM    $GB4TM           LD Unused Time
     C                     Z-ADDFLB5TM    $GB5TM           LD Unused Time
     C                     MOVELFLIASX    $GIASX           Miles Error Sts
     C                     MOVELFLIBSX    $GIBSX           LD Unused Sts 2
     C                     MOVELFLICSX    $GICSX           HPB Transload S
     C                     MOVELFLWVTX    $GWVTX           LD Cst Svc Trac
     C                     MOVELFLWWTX    $GWWTX           Carrier Ref PRO
     C                     MOVELFLWXTX    $GWXTX           Cust Assigned A
     C                     MOVELFLUVST    $GUVST           EDI Status 1
     C                     MOVELFLUWST    $GUWST           EDI Status 2
     C                     MOVELFLUXST    $GUXST           EDI Status 3
     C                     Z-ADDFLRUNB    $GRUNB           Stop_Drop Seque
     C                     MOVELFLDQTX    $GDQTX           Comments for Pi
     C                     Z-ADDFLRXNB    $GRXNB           Freight Charge
     C                     Z-ADDFLSQNB    $GSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADDFLT0NB    $GT0NB           Freight Misc_Ch
     C                     Z-ADDFLT1NB    $GT1NB           Freight Stop Ch
     C                     MOVEL*BLANK    $GVGST           Slip Sheet
     C                     MOVEL*BLANK    $GVFST           Shrink Wrap
     C                     MOVEL*BLANK    $GVEST           Palletize
     C                     MOVEL*BLANK    $GLMNA           USR City 15
     C                     MOVEL*BLANK    $GLNNA           USR State 2
     C                     Z-ADD*ZERO     $GAFTM           Requested Deliv
     C                     Z-ADDFLZ4NB    $GZ4NB           MPC Number
     C                     MOVEL*BLANK    $GIUTX           Text USR
     C                     Z-ADDFLAATM    $GAATM           Job Time
     C                     MOVELFLAYNA    $GAYNA           User Id
     C                     MOVELFLA0NA    $GA0NA           Job Name
     C                     Z-ADDFLAXDT    $GAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Prelim. Pick Dtls  PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : PRT Trf Cmts Pre Pick  PO
     C                     EXSR UESUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : PRT Shipping Inst.     PO
     C                     EXSR UFSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : PRT Ship To Address    PO
     C                     EXSR UGSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     ADD  WN0016    $SCDWG           USR Weight Accu
     C                     ADD  WN0017    $SA4WG           Tare Weight Tot
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN FLRMNB    WZB001           Load ID
     C                     Z-ADDFLRMNB    WZB001
     C           *LIKE     DEFN FLRVNB    WZB002           Stop_Drop
     C                     Z-ADDFLRVNB    WZB002
     C           *LIKE     DEFN FLC4NB    WZB003           Order Number
     C                     Z-ADDFLC4NB    WZB003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@FLCPE8                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Get the warehouse from the first order detail record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * RTV Warehouse code     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0017           Company Number
     C                     Z-ADDFLC4NB    WL0018           Order Number
     C                     Z-ADD*ZERO     WL0019           Order Sequence
     C                     Z-ADD*ZERO     WL0020           Order Secondary
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0021    WUAJCD    P      Warehouse Code
      * Select passed warehouses
      * CASE: PAR.USR Select/Omit Flag is Select
     C           P5CYST    IFEQ 'S'                        *IF
      * Select only Order Detail records matching warehouse codes passed
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           P5CPCD    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELP5CPCD    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELP5CPCD    WUAJCD           Warehouse Code
     C                     GOTO B3EXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 1 is Warehouse Code not Blank
     C           P5VSCD    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELP5VSCD    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELP5VSCD    WUAJCD           Warehouse Code
     C                     GOTO B3EXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 2 is Warehouse Code not Blank
     C           P5VTCD    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELP5VTCD    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELP5VTCD    WUAJCD           Warehouse Code
     C                     GOTO B3EXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 3 is Warehouse Code not Blank
     C           P5VUCD    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELP5VUCD    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELP5VUCD    WUAJCD           Warehouse Code
     C                     GOTO B3EXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 4 is Warehouse Code not Blank
     C           P5VVCD    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELP5VVCD    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELP5VVCD    WUAJCD           Warehouse Code
     C                     GOTO B3EXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 5 is Warehouse Code not Blank
     C           P5VWCD    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELP5VWCD    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELP5VWCD    WUAJCD           Warehouse Code
     C                     GOTO B3EXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 6 is Warehouse Code not Blank
     C           P5VXCD    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELP5VXCD    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELP5VXCD    WUAJCD           Warehouse Code
     C                     GOTO B3EXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 7 is Warehouse Code not Blank
     C           P5VYCD    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELP5VYCD    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELP5VYCD    WUAJCD           Warehouse Code
     C                     GOTO B3EXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 8 is Warehouse Code not Blank
     C           P5VZCD    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELP5VZCD    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELP5VZCD    WUAJCD           Warehouse Code
     C                     GOTO B3EXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 9 is Warehouse Code not Blank
     C           P5V0CD    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELP5V0CD    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELP5V0CD    WUAJCD           Warehouse Code
     C                     GOTO B3EXIT                     *QUIT
     C                     END                             *FI
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Omit passed warehouses
      * CASE: PAR.USR Select/Omit Flag is Omit
     C           P5CYST    IFEQ 'O'                        *IF
      * Omit any Order Detail records matching warehouse codes passed in
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code not Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code not Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code not Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code not Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code not Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code not Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code not Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code not Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code not Blank
      *   |- c10   : PAR.USR CDE Parm 9 is Warehouse Code not Blank
      *   '-
     C           P5CPCD    IFNE *BLANK                     *IF
     C           P5VSCD    ORNE *BLANK                     *OR
     C           P5VTCD    ORNE *BLANK                     *OR
     C           P5VUCD    ORNE *BLANK                     *OR
     C           P5VVCD    ORNE *BLANK                     *OR
     C           P5VWCD    ORNE *BLANK                     *OR
     C           P5VXCD    ORNE *BLANK                     *OR
     C           P5VYCD    ORNE *BLANK                     *OR
     C           P5VZCD    ORNE *BLANK                     *OR
     C           P5V0CD    ORNE *BLANK                     *OR
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10
      *   |- c1    : PAR.USR Warehouse Code EQ WRK.Warehouse Code
      *   |- c2    : PAR.USR CDE Parm 1 EQ WRK.Warehouse Code
      *   |- c3    : PAR.USR CDE Parm 2 EQ WRK.Warehouse Code
      *   |- c4    : PAR.USR CDE Parm 3 EQ WRK.Warehouse Code
      *   |- c5    : PAR.USR CDE Parm 4 EQ WRK.Warehouse Code
      *   |- c6    : PAR.USR CDE Parm 5 EQ WRK.Warehouse Code
      *   |- c7    : PAR.USR CDE Parm 6 EQ WRK.Warehouse Code
      *   |- c8    : PAR.USR CDE Parm 7 EQ WRK.Warehouse Code
      *   |- c9    : PAR.USR CDE Parm 8 EQ WRK.Warehouse Code
      *   |- c10   : PAR.USR CDE Parm 9 EQ WRK.Warehouse Code
      *   '-
     C           P5CPCD    IFEQ WUAJCD                     *IF
     C           P5VSCD    OREQ WUAJCD                     *OR
     C           P5VTCD    OREQ WUAJCD                     *OR
     C           P5VUCD    OREQ WUAJCD                     *OR
     C           P5VVCD    OREQ WUAJCD                     *OR
     C           P5VWCD    OREQ WUAJCD                     *OR
     C           P5VXCD    OREQ WUAJCD                     *OR
     C           P5VYCD    OREQ WUAJCD                     *OR
     C           P5VZCD    OREQ WUAJCD                     *OR
     C           P5V0CD    OREQ WUAJCD                     *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL Valid  Prelim Pick RT - Order Header TRG  * 
     C                     EXSR SYRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Load ID
     C                     MOVEL*BLANK    W0BL01  1        Stop_Drop
     C                     MOVEL*BLANK    W0BL02  1        Order Number
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Load ID
     C                     MOVEL'Y'       W0BL01  1        Stop_Drop
     C                     MOVEL'Y'       W0BL02  1        Order Number
     C                     ELSE
      * Next record - Detect level breaks
     C           FLRMNB    IFNE WZB001                     Load ID
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           FLRVNB    IFNE WZB002                     Stop_Drop
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           FLC4NB    IFNE WZB003                     Order Number
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL02    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           WN0010    IFEQ *BLANK                     *IF
     C           WN0010    OREQ 'N'
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$SKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
      * PRTOBJ calls after print of Order Number format
      * Embedded PRTOBJ : PRT Load Summ Exp Inst PO
     C                     EXSR UJSUBR                     Embedded PRTOBJ
      * USER: Process after print of Order Number format
     C                     ADD  $SCDWG    $UCDWG           USR Weight Accu
     C                     ADD  $SA4WG    $UA4WG           Tare Weight Tot
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
      * USER: Process after print of Stop/Drop format
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Load ID format
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 4
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$UKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * PRT Prelim. Pick Dtls  PO: Mainline
      *================================================================
      * PRT Prelim. Pick Dtls  PO: Initialise
     C                     EXSR ZCINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQKC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQKC02           Order Number
      * Define keylist
     C           KPSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Order Number
      * Setup key
     C                     Z-ADD$GAIC3    WQKC01           Company Number
     C                     Z-ADD$GC4NB    WQKC02           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
      * Establish starting position
     C           KPSC      SETLL@BGWKAE                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        Order Sequence
     C                     MOVEL'Y'       W0CL03  1        Order Secondary
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $LBPTM           Maximum Gross W
     C                     MOVEL*BLANK    $LD3T1           Text 35 USR
     C                     MOVEL*BLANK    $LQUU1           Pallet Type/Qty
     C                     Z-ADD*ZERO     $LCDWG           USR Weight Accu
     C                     Z-ADDWCAIC3    $LAIC3           Company Number
     C                     Z-ADDWCC4NB    $LC4NB           Order Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWCAIC3    $HAIC3           Company Number
     C                     Z-ADDWCC4NB    $HC4NB           Order Number
     C                     Z-ADDWCDPNB    $HDPNB           Order Sequence
     C                     Z-ADDWCUENB    $HUENB           Order Secondary
     C                     MOVEL*BLANK    $HPFTX           Text 1 Length U
     C                     MOVELWCAJCD    $HAJCD           Warehouse Code
     C                     Z-ADDWCA1AA    $HA1AA           Ham Group Numbe
     C                     Z-ADDWCHGCD    $HHGCD           Item Code
     C                     Z-ADD*ZERO     $HCDWG           USR Weight Accu
     C                     Z-ADDWCA4WG    $HA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     $HN8QT           Qty Sched Ord U
     C                     Z-ADD*ZERO     $HN9QT           Qty Sched Prod
     C                     Z-ADDWCCCQT    $HCCQT           Quantity Schedu
     C                     Z-ADDWCBKC7    $HBKC7           Ship To Custome
     C                     Z-ADDWCCFC7    $HCFC7           Order Group Cod
     C                     MOVELWCGMST    $HGMST           Detail Line Sta
     C                     MOVELWCGNST    $HGNST           Detail Line Sta
     C                     Z-ADDWCMAVA    $HMAVA           Billing Detail
     C                     Z-ADDWCKDVA    $HKDVA           Billing Detail
     C                     Z-ADDWCL8VA    $HL8VA           Billing Detail
     C                     Z-ADDWCL9VA    $HL9VA           Quantity to Sub
     C                     MOVELWCGTST    $HGTST           Comment Print A
     C                     MOVELWCGVST    $HGVST           Comment Print I
     C                     MOVELWCGUST    $HGUST           Comment Print P
     C                     MOVELWCQFST    $HQFST           Comment Print S
     C                     Z-ADDWCEXDT    $HEXDT           Market Pricing
     C                     MOVELWCLQCD    $HLQCD           Commodity Marke
     C                     MOVELWCRDCD    $HRDCD           Date Method Cod
     C                     MOVELWCQ7CD    $HQ7CD           Price Method Co
     C                     Z-ADDWCBZPR    $HBZPR           Price Overage O
     C                     Z-ADDWCL6NB    $HL6NB           Contract Number
     C                     MOVELWCU1ST    $HU1ST           Price Status
     C                     Z-ADDWCGIDT    $HGIDT           Pricing Date Us
     C                     MOVELWCCRCD    $HCRCD           U_M_Base Price
     C                     MOVELWCAGCD    $HAGCD           U_M_Ordered
     C                     Z-ADD*ZERO     $HTNDT           Production AgeD
     C                     Z-ADD*ZERO     $HTODT           Production AgeD
     C                     MOVELWCRPCD    $HRPCD           Age Code
     C                     Z-ADD*ZERO     $HMUDT           Date - ATR
     C                     MOVEL*BLANK    $HL3NA           USR Description
     C                     MOVELWCRZST    $HRZST           Work Confirm St
     C                     MOVELWCR0ST    $HR0ST           Work Over_Short
     C                     MOVELWCR1ST    $HR1ST           OD Production P
     C                     MOVELWCG7NA    $HG7NA           Order Desc_Line
     C                     MOVELWCG8NA    $HG8NA           Order Desc_Line
     C                     MOVELWCVEST    $HVEST           Palletize
     C                     MOVELWCVGST    $HVGST           Slip Sheet
     C                     MOVELWCAVST    $HAVST           Catch Weight St
     C                     MOVELWCU0ST    $HU0ST           Price Audit
     C                     MOVELWCRFCD    $HRFCD           Price Audit Rea
     C                     MOVELWCFZST    $HFZST           Production Date
     C                     Z-ADDWCR1NB    $HR1NB           Rated Freight
     C                     Z-ADDWCAVQT    $HAVQT           Quantity Ordere
     C                     Z-ADDWCD0WG    $HD0WG           Weight Ordered
     C                     Z-ADDWCAUWG    $HAUWG           Weight Schedule
     C                     Z-ADDWCCBQT    $HCBQT           Quantity Shippe
     C                     Z-ADDWCATWG    $HATWG           Weight Shipped
     C                     Z-ADDWCAQCS    $HAQCS           Unit Cost Prici
     C                     Z-ADDWCAGCS    $HAGCS           Unit Cost Per P
     C                     Z-ADDWCALPR    $HALPR           Unit Price_Cred
     C                     Z-ADDWCAUPR    $HAUPR           Unit Price Orde
     C                     Z-ADDWCAVWG    $HAVWG           Unit Weight Ord
     C                     Z-ADDWCA5DT    $HA5DT           Requested Ship
     C                     Z-ADDWCAODT    $HAODT           Scheduled Ship
     C                     Z-ADDWCGNDT    $HGNDT           Actual Shipped
     C                     MOVELWCAMST    $HAMST           Affect Inventor
     C                     MOVELWCANST    $HANST           Affect Sales Do
     C                     MOVELWCVAST    $HVAST           Affect Sales Pn
     C                     Z-ADDWCRGNB    $HRGNB           Item Structure
     C                     Z-ADDWCRHNB    $HRHNB           Item Structure
     C                     Z-ADDWCRINB    $HRINB           Item Structure
     C                     MOVELWCRBCD    $HRBCD           Item Level
     C                     MOVELWCHICD    $HHICD           Quality Level
     C                     MOVELWCRNCD    $HRNCD           Pricing Product
     C                     MOVELWCROCD    $HROCD           Season Product
     C                     Z-ADDWCCXDT    $HCXDT           Date of Origina
     C                     MOVELWCAJVN    $HAJVN           User Profile Na
     C                     MOVELWCKXCD    $HKXCD           Country Code
     C                     MOVELWCJPCD    $HJPCD           Event Code
     C                     MOVELWCCQCD    $HCQCD           Reason Code
     C                     MOVELWCR4CD    $HR4CD           Sales Route Cod
     C                     MOVELWCZ1ST    $HZ1ST           Modified Flag
     C                     MOVELWCZ3ST    $HZ3ST           Substituted Fla
     C                     MOVELWCZ4ST    $HZ4ST           OD Schedule Ove
     C                     Z-ADDWCDUPR    $HDUPR           Invoice Unit Pr
     C                     Z-ADDWCB6VL    $HB6VL           Invoice Extende
     C                     MOVELWCFZSX    $HFZSX           OD Adj Type Ove
     C                     MOVELWCF0SX    $HF0SX           Affect Trade Fu
     C                     MOVELWCF1SX    $HF1SX           Affect Commissi
     C                     MOVELWCF2SX    $HF2SX           Affect Pricing
     C                     MOVELWCF3SX    $HF3SX           Released by Use
     C                     MOVELWCF4SX    $HF4SX           Ord TF Exempt C
     C                     MOVELWCF5SX    $HF5SX           OD Pallet Type
     C                     MOVELWCF6SX    $HF6SX           Production Ware
     C                     MOVELWCF7SX    $HF7SX           OD Price Type
     C                     Z-ADDWCNTDT    $HNTDT           Warehouse Palle
     C                     Z-ADDWCNUDT    $HNUDT           Consumed Item C
     C                     Z-ADDWCNVDT    $HNVDT           Deadline Depart
     C                     Z-ADDWCNWDT    $HNWDT           OD Price Type R
     C                     Z-ADDWCNXDT    $HNXDT           OD Firm Date
     C                     Z-ADDWCBUTM    $HBUTM           Deadline Depart
     C                     Z-ADDWCBVTM    $HBVTM           Price Code
     C                     Z-ADDWCBWTM    $HBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     $HUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     $HUQNB           Max Carcass Wei
     C                     Z-ADDWCBXTM    $HBXTM           Substitution Li
     C                     Z-ADDWCBYTM    $HBYTM           Max Qty to sche
     C                     Z-ADDWCH5NX    $HH5NX           Warehouse Palle
     C                     Z-ADDWCH6NX    $HH6NX           Warehouse Avg P
     C                     Z-ADDWCH7NX    $HH7NX           OD Item Target
     C                     Z-ADDWCH8NX    $HH8NX           OD Estimated Gr
     C                     Z-ADDWCH9NX    $HH9NX           OD Maximum Unit
     C                     Z-ADDWCDVPR    $HDVPR           Order Gate_Fina
     C                     Z-ADDWCDWPR    $HDWPR           OD Ceiling Pric
     C                     Z-ADDWCDXPR    $HDXPR           OD Gate_Final P
     C                     Z-ADDWCDYPR    $HDYPR           OD Weighted Avg
     C                     Z-ADDWCDZPR    $HDZPR           OD Original Ord
     C                     Z-ADDWCGSPR    $HGSPR           OD Cancel Date
     C                     Z-ADDWCGTPR    $HGTPR           OD Unused Prc 7
     C                     Z-ADDWCGUPR    $HGUPR           OD Unused Prc 8
     C                     MOVELWCHOST    $HHOST           OD MPR Sent to
     C                     MOVELWCHPST    $HHPST           OD MPR Prc Read
     C                     MOVELWCIOST    $HIOST           OD UnUsed Price
     C                     Z-ADDWCPEWG    $HPEWG           Weight Amount E
     C                     Z-ADDWCRINY    $HRINY           Item Age Days
     C                     Z-ADDWCTIDT    $HTIDT           Production Ovr
     C                     Z-ADDWCTJDT    $HTJDT           Production Ovr
     C                     MOVELWCH2ST    $HH2ST           OD Spot Buy
     C                     MOVELWCH0ST    $HH0ST           OD Clm Full Ret
     C                     MOVELWCH1ST    $HH1ST           Order Line Erro
     C                     Z-ADDWCTKDT    $HTKDT           OD Market Begin
     C                     Z-ADDWCTLDT    $HTLDT           OD Market Endin
     C                     Z-ADDWCTMDT    $HTMDT           OD Atch to Ord
     C                     MOVELWCUVST    $HUVST           EDI Status 1
     C                     MOVELWCUWST    $HUWST           EDI Status 2
     C                     MOVELWCUXST    $HUXST           EDI Status 3
     C                     Z-ADDWCAATM    $HAATM           Job Time
     C                     MOVELWCAYNA    $HAYNA           User Id
     C                     MOVELWCA0NA    $HA0NA           Job Name
     C                     Z-ADDWCAXDT    $HAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Detail Comment     PO
     C                     EXSR UDSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     MOVEL'N'       WUJDST           USR Check Y/N S
     C                     ADD  $HCDWG    WN0016           USR Weight Accu
     C                     ADD  $HA4WG    WN0017           Tare Weight Tot
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WCAIC3    WZC001           Company Number
     C                     Z-ADDWCAIC3    WZC001
     C           *LIKE     DEFN WCC4NB    WZC002           Order Number
     C                     Z-ADDWCC4NB    WZC002
     C           *LIKE     DEFN WCDPNB    WZC003           Order Sequence
     C                     Z-ADDWCDPNB    WZC003
     C           *LIKE     DEFN WCUENB    WZC004           Order Secondary
     C                     Z-ADDWCUENB    WZC004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@BGWKAE                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Company Number
     C                     MOVEL*BLANK    W0CL01  1        Order Number
     C                     MOVEL*BLANK    W0CL02  1        Order Sequence
     C                     MOVEL*BLANK    W0CL03  1        Order Secondary
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        Order Sequence
     C                     MOVEL'Y'       W0CL03  1        Order Secondary
     C                     ELSE
      * Next record - Detect level breaks
     C           WCAIC3    IFNE WZC001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           WCC4NB    IFNE WZC002                     Order Number
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           WCDPNB    IFNE WZC003                     Order Sequence
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           WCUENB    IFNE WZC004                     Order Secondary
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Order Number format
      * CASE: PAR.Palletize is yes
     C           $GVEST    IFEQ 'Y'                        *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,003   CAT  'ONTO:':ZQ$LD3T1    P      Text 35 USR
      * Load Pallet Type and Pallet Qty values              WI464
      * CASE: *OTHERWISE
      * Rtv Pallet Desc       RT - Pallet Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0005    WL0015    P      PM Pallet Type
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    YL0012    P      PM Description
      * Rtv Pallet Desc       RT - Pallet Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0006    WL0015    P      PM Pallet Type
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    YL0013    P      PM Description
      * Rtv Pallet Desc       RT - Pallet Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0007    WL0015    P      PM Pallet Type
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    YL0014    P      PM Description
      * Rtv Pallet Desc       RT - Pallet Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0008    WL0015    P      PM Pallet Type
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    YL0015    P      PM Description
     C                     Z-ADD2         ZQ      50
     C           YL0012    CAT  YL0013:ZQ YL0016    P      Text usr 14
     C                     Z-ADD2         ZQ      50
     C           YL0014    CAT  YL0015:ZQ WUD7U1    P      Text usr 14
     C                     Z-ADD2         ZQ      50
     C           YL0016    CAT  WUD7U1:ZQ YL0009    P      Pallet Type/Qty
     C                     MOVELYL0009    $LQUU1           Pallet Type/Qty
      * E2684 7/17/13 RMC If any boxes on the order, print Shrink Wrap
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0004    IFEQ 'BX'                       *IF
     C                     MOVEL'Y'       YL0003           Shrink Wrap
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD01        ZQ      50
     C           @CN,004   CAT  '***':ZQ  $LD3T1    P      Text 35 USR
     C                     END                             *FI
     C                     Z-ADDWN0015    $LBPTM           Maximum Gross W
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 5
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           WN0015    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           YL0009    IFEQ @CN,005                    *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           YL0003    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
      * Print format
     C                     WRITE$LKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * PRT Detail Comment     PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN CPAIC3    WQKD01           Company Number
     C           *LIKE     DEFN CPC4NB    WQKD02           Order Number
     C           *LIKE     DEFN CPDPNB    WQKD03           Order Sequence
     C           *LIKE     DEFN CPUENB    WQKD04           Order Secondary
      * Define keylist
     C           KPSD      KLIST
     C                     KFLD           WQKD01           Company Number
     C                     KFLD           WQKD02           Order Number
     C                     KFLD           WQKD03           Order Sequence
     C                     KFLD           WQKD04           Order Secondary
     C                     KFLD           CPDXNB           Sequence Number
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           Company Number
     C                     KFLD           WQKD02           Order Number
     C                     KFLD           WQKD03           Order Sequence
     C                     KFLD           WQKD04           Order Secondary
      * Setup key
     C                     Z-ADD$LAIC3    WQKD01           Company Number
     C                     Z-ADD$LC4NB    WQKD02           Order Number
     C                     Z-ADD$HDPNB    WQKD03           Order Sequence
     C                     Z-ADD$HUENB    WQKD04           Order Secondary
     C                     Z-ADD*ZERO     CPDXNB           Sequence Number
      * Establish starting position
     C           KPSD      SETLL@CPCPOL                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        Company Number
     C                     MOVEL'Y'       W0DL01  1        Order Number
     C                     MOVEL'Y'       W0DL02  1        Order Sequence
     C                     MOVEL'Y'       W0DL03  1        Order Secondary
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP02  1
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDCPAIC3    $IAIC3           Company Number
     C                     Z-ADDCPC4NB    $IC4NB           Order Number
     C                     Z-ADDCPDPNB    $IDPNB           Order Sequence
     C                     Z-ADDCPUENB    $IUENB           Order Secondary
      * Load related totals format
     C                     Z-ADDCPAIC3    $KAIC3           Company Number
     C                     Z-ADDCPC4NB    $KC4NB           Order Number
     C                     Z-ADDCPDPNB    $KDPNB           Order Sequence
     C                     Z-ADDCPUENB    $KUENB           Order Secondary
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP03  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDCPAIC3    $JAIC3           Company Number
     C                     Z-ADDCPC4NB    $JC4NB           Order Number
     C                     Z-ADDCPDPNB    $JDPNB           Order Sequence
     C                     Z-ADDCPUENB    $JUENB           Order Secondary
     C                     MOVELCPG4NA    $JG4NA           Comment Text
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN CPAIC3    WZD001           Company Number
     C                     Z-ADDCPAIC3    WZD001
     C           *LIKE     DEFN CPC4NB    WZD002           Order Number
     C                     Z-ADDCPC4NB    WZD002
     C           *LIKE     DEFN CPDPNB    WZD003           Order Sequence
     C                     Z-ADDCPDPNB    WZD003
     C           *LIKE     DEFN CPUENB    WZD004           Order Secondary
     C                     Z-ADDCPUENB    WZD004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@CPCPOL                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        Company Number
     C                     MOVEL*BLANK    W0DL01  1        Order Number
     C                     MOVEL*BLANK    W0DL02  1        Order Sequence
     C                     MOVEL*BLANK    W0DL03  1        Order Secondary
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        Company Number
     C                     MOVEL'Y'       W0DL01  1        Order Number
     C                     MOVEL'Y'       W0DL02  1        Order Sequence
     C                     MOVEL'Y'       W0DL03  1        Order Secondary
     C                     ELSE
      * Next record - Detect level breaks
     C           CPAIC3    IFNE WZD001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           CPC4NB    IFNE WZD002                     Order Number
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C           CPDPNB    IFNE WZD003                     Order Sequence
     C           W0DL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL02
     C                     END
     C           CPUENB    IFNE WZD004                     Order Secondary
     C           W0DL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL03
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL03    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$KKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP03
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP02
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         E0MAIN    BEGSR
      *================================================================
      * PRT Trf Cmts Pre Pick  PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN KERMNB    WQKE01           Load ID
      * Define keylist
     C           KRSE      KLIST
     C                     KFLD           WQKE01           Load ID
      * Setup key
     C                     Z-ADD$GRMNB    WQKE01           Load ID
      * Establish starting position
     C           KRSE      SETLL@KECPGI                    *
      * Read first record with user selection
     C                     EXSR E3READ
     C           W0EOFE    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0EL1P  1        First page
     C                     MOVEL'Y'       W0EL00  1        Load ID
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      * Print report body
     C           W0EOFE    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR E1PHDR
      * Print report detail line
     C                     EXSR E2PDTL
      * Read next record with user selection
     C                     EXSR E3READ
      * Print totals
     C                     EXSR E4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         E0EXIT    ENDSR
      /EJECT
     CSR         E1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0EL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP1P  1
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP00  1
     C                     END
      *
      *================================================================
     CSR         E1EXIT    ENDSR
      /EJECT
     CSR         E2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDKERMNB    $MRMNB           Load ID
     C                     Z-ADDKEDXNB    $MDXNB           Sequence Number
     C                     MOVELKEGXTX    $MGXTX           Comment Line
     C                     MOVELKEUVST    $MUVST           EDI Status 1
     C                     MOVELKEUWST    $MUWST           EDI Status 2
     C                     MOVELKEUXST    $MUXST           EDI Status 3
     C                     MOVELKEVSST    $MVSST           Record Status
     C                     Z-ADDKEAATM    $MAATM           Job Time
     C                     MOVELKEAYNA    $MAYNA           User Id
     C                     MOVELKEA0NA    $MA0NA           Job Name
     C                     Z-ADDKEAXDT    $MAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         E2EXIT    ENDSR
      /EJECT
     CSR         E3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN KERMNB    WZE001           Load ID
     C                     Z-ADDKERMNB    WZE001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFE    OREQ '1'
     C           KRSE      READE@KECPGI                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFE  1
      * Quit if no record read
     C           W0EOFE    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0EL00  1        Load ID
     C           W0EOFE    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0EL00  1        Load ID
     C                     ELSE
      * Next record - Detect level breaks
     C           KERMNB    IFNE WZE001                     Load ID
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL00
     C                     END
     C                     END
      *================================================================
     CSR         E3EXIT    ENDSR
      /EJECT
     CSR         E4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP00
     C                     END
      *
     C           W0EOFE    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         E4EXIT    ENDSR
      /EJECT
     CSR         F0MAIN    BEGSR
      *================================================================
      * PRT Shipping Inst.     PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN IEAIC3    WQKF01           Company Number
     C           *LIKE     DEFN IEC4NB    WQKF02           Order Number
      * Define keylist
     C           KRSF      KLIST
     C                     KFLD           WQKF01           Company Number
     C                     KFLD           WQKF02           Order Number
      * Setup key
     C                     Z-ADD$GAIC3    WQKF01           Company Number
     C                     Z-ADD$GC4NB    WQKF02           Order Number
      * Establish starting position
     C           KRSF      SETLL@IECPSA                    *
      * Read first record with user selection
     C                     EXSR F3READ
     C           W0EOFF    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0FL1P  1        First page
     C                     MOVEL'Y'       W0FL00  1        Company Number
     C                     MOVEL'Y'       W0FL01  1        Order Number
      * Set column headings flag
     C                     MOVE 'Y'       W0FCDT
      * Print report body
     C           W0EOFF    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR F1PHDR
      * Print report detail line
     C                     EXSR F2PDTL
      * Read next record with user selection
     C                     EXSR F3READ
      * Print totals
     C                     EXSR F4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         F0EXIT    ENDSR
      /EJECT
     CSR         F1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0FL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP1P  1
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP00  1
     C                     END
      *
     C           W0FL01    IFEQ 'Y'
      * Load key header format
     C                     MOVEL*BLANK    $NBDST           Order Certifica
     C                     Z-ADDIEAIC3    $NAIC3           Company Number
     C                     Z-ADDIEC4NB    $NC4NB           Order Number
     C                     Z-ADDIEDXNB    $NDXNB           Sequence Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP01  1
     C                     END
      *
      *================================================================
     CSR         F1EXIT    ENDSR
      /EJECT
     CSR         F2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDIEAIC3    $OAIC3           Company Number
     C                     Z-ADDIEC4NB    $OC4NB           Order Number
     C                     Z-ADDIEDXNB    $ODXNB           Sequence Number
     C                     MOVELIEMQNA    $OMQNA           Shipping Instru
     C                     MOVELIEUVST    $OUVST           EDI Status 1
     C                     MOVELIEUWST    $OUWST           EDI Status 2
     C                     MOVELIEUXST    $OUXST           EDI Status 3
     C                     Z-ADDIEAATM    $OAATM           Job Time
     C                     MOVELIEAYNA    $OAYNA           User Id
     C                     MOVELIEA0NA    $OA0NA           Job Name
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         F2EXIT    ENDSR
      /EJECT
     CSR         F3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN IEAIC3    WZF001           Company Number
     C                     Z-ADDIEAIC3    WZF001
     C           *LIKE     DEFN IEC4NB    WZF002           Order Number
     C                     Z-ADDIEC4NB    WZF002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFF    OREQ '1'
     C           KRSF      READE@IECPSA                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFF  1
      * Quit if no record read
     C           W0EOFF    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0FL00  1        Company Number
     C                     MOVEL*BLANK    W0FL01  1        Order Number
     C           W0EOFF    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0FL00  1        Company Number
     C                     MOVEL'Y'       W0FL01  1        Order Number
     C                     ELSE
      * Next record - Detect level breaks
     C           IEAIC3    IFNE WZF001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL00
     C                     END
     C           IEC4NB    IFNE WZF002                     Order Number
     C           W0FL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL01
     C                     END
     C                     END
      *================================================================
     CSR         F3EXIT    ENDSR
      /EJECT
     CSR         F4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0FL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP01
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP00
     C                     END
      *
     C           W0EOFF    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         F4EXIT    ENDSR
      /EJECT
     CSR         G0MAIN    BEGSR
      *================================================================
      * PRT Ship To Address    PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN BEAIC3    WQKG01           Company Number
     C           *LIKE     DEFN BEC4NB    WQKG02           Order Number
      * Define keylist
     C           KRSG      KLIST
     C                     KFLD           WQKG01           Company Number
     C                     KFLD           WQKG02           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WQKG01           Company Number
     C                     Z-ADDFLC4NB    WQKG02           Order Number
      * Establish starting position
     C           KRSG      SETLL@BECPFK                    *
      * Read first record with user selection
     C                     EXSR G3READ
     C           W0EOFG    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0GL1P  1        First page
     C                     MOVEL'Y'       W0GL00  1        Company Number
      * Set column headings flag
     C                     MOVE 'Y'       W0GCDT
      * Print report body
     C           W0EOFG    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR G1PHDR
      * Print report detail line
     C                     EXSR G2PDTL
      * Read next record with user selection
     C                     EXSR G3READ
      * Print totals
     C                     EXSR G4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         G0EXIT    ENDSR
      /EJECT
     CSR         G1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0GL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP1P  1
     C                     END
      *
     C           W0GL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP00  1
     C                     END
      *
      *================================================================
     CSR         G1EXIT    ENDSR
      /EJECT
     CSR         G2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBEAIC3    $PAIC3           Company Number
     C                     Z-ADDBEC4NB    $PC4NB           Order Number
     C                     Z-ADDBEBKC7    $PBKC7           Ship To Custome
     C                     MOVELBEBCNA    $PBCNA           Customer Purcha
     C                     MOVEL*BLANK    $PGINA           USR Compressed
     C                     MOVELBER4CD    $PR4CD           Sales Route Cod
     C                     MOVEL*BLANK    $PMZNA           Sales Route Des
     C                     MOVEL*BLANK    $PGJNA           USR Compressed
     C                     MOVEL*BLANK    $PGKNA           USR Compressed
     C                     MOVEL*BLANK    $PGLNA           USR Compressed
     C                     MOVEL*BLANK    $PGMNA           USR Compressed
     C                     MOVEL*BLANK    $PNWNA           USR Compressed
     C                     MOVEL*BLANK    $PCDTX           USR Telephone C
     C                     MOVELBEB6NA    $PB6NA           Special Instruc
     C                     MOVELBEBYNA    $PBYNA           Special Instruc
     C                     Z-ADDBEB7VL    $PB7VL           Invoice Order V
     C                     MOVELBEGASX    $PGASX           Process Sts for
     C                     MOVELBEGBSX    $PGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $PGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $PGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $PFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $PFOSX           Email Cust On O
     C                     MOVELBEFPSX    $PFPSX           Order Emailed
     C                     MOVELBEFQSX    $PFQSX           Export Docs Go
     C                     MOVELBEFRSX    $PFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $PFSSX           Broker Order St
     C                     MOVELBEFTSX    $PFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $PFUSX           Order Requires
     C                     MOVELBEFVSX    $PFVSX           OH Load Plan Re
     C                     MOVELBEFWSX    $PFWSX           Export USDA App
     C                     MOVELBEFXSX    $PFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $PFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $PNODT           OH Appt Confirm
     C                     Z-ADDBENPDT    $PNPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    $PNQDT           Load Actual Shi
     C                     Z-ADDBENRDT    $PNRDT           Load BOL Comple
     C                     Z-ADDBENSDT    $PNSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    $PBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $PBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $PBRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    $PBSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    $PBTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    $PH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $PH1NX           Act Non_Ref Frt
     C                     Z-ADDBEH2NX    $PH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $PH3NX           OH Total Non_Re
     C                     Z-ADDBEH4NX    $PH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $PC0C7           Claim Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Cust Comment PL   PO
     C                     EXSR UHSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Country Comment   PO
     C                     EXSR UISUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         G2EXIT    ENDSR
      /EJECT
     CSR         G3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BEAIC3    WZG001           Company Number
     C                     Z-ADDBEAIC3    WZG001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFG    OREQ '1'
     C           KRSG      READE@BECPFK                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFG  1
      * Quit if no record read
     C           W0EOFG    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0GL00  1        Company Number
     C           W0EOFG    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0GL00  1        Company Number
     C                     ELSE
      * Next record - Detect level breaks
     C           BEAIC3    IFNE WZG001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL00
     C                     END
     C                     END
      *================================================================
     CSR         G3EXIT    ENDSR
      /EJECT
     CSR         G4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0GL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP00
     C                     END
      *
     C           W0EOFG    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         G4EXIT    ENDSR
      /EJECT
     CSR         H0MAIN    BEGSR
      *================================================================
      * Prt Cust Comment PL   PO: Mainline
      *================================================================
      * Prt Cust Comment PL   PO: Initialise
     C                     EXSR ZHINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN AVBKC7    WQKH01           Ship To Custome
     C           *LIKE     DEFN AVI1SX    WQKH02           Comment Type
      * Define keylist
     C           KPSH      KLIST
     C                     KFLD           WQKH01           Ship To Custome
     C                     KFLD           WQKH02           Comment Type
     C                     KFLD           AVM5NX           Comment Sequenc
      * Define keylist
     C           KRSH      KLIST
     C                     KFLD           WQKH01           Ship To Custome
     C                     KFLD           WQKH02           Comment Type
      * Setup key
     C                     Z-ADD$PBKC7    WQKH01           Ship To Custome
     C                     MOVEL'PI'      WQKH02           Comment Type
     C                     Z-ADD*ZERO     AVM5NX           Comment Sequenc
      * Establish starting position
     C           KPSH      SETLL@AVCPG4                    *
      * Read first record with user selection
     C                     EXSR H3READ
     C           W0EOFH    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0HL1P  1        First page
     C                     MOVEL'Y'       W0HL00  1        Ship To Custome
     C                     MOVEL'Y'       W0HL01  1        Comment Type
      * Set column headings flag
     C                     MOVE 'Y'       W0HCDT
      * Print report body
     C           W0EOFH    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR H1PHDR
      * Print report detail line
     C                     EXSR H2PDTL
      * Read next record with user selection
     C                     EXSR H3READ
      * Print totals
     C                     EXSR H4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         H0EXIT    ENDSR
      /EJECT
     CSR         H1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0HL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP1P  1
     C                     END
      *
     C           W0HL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP00  1
     C                     END
      *
     C           W0HL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP01  1
     C                     END
      *
      *================================================================
     CSR         H1EXIT    ENDSR
      /EJECT
     CSR         H2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDAVBKC7    $QBKC7           Ship To Custome
     C                     MOVELAVI1SX    $QI1SX           Comment Type
     C                     Z-ADDAVM5NX    $QM5NX           Comment Sequenc
     C                     MOVELAVXRTX    $QXRTX           Customer Commen
     C                     MOVELAVUVST    $QUVST           EDI Status 1
     C                     MOVELAVUWST    $QUWST           EDI Status 2
     C                     MOVELAVUXST    $QUXST           EDI Status 3
     C                     MOVELAVVSST    $QVSST           Record Status
     C                     Z-ADDAVAATM    $QAATM           Job Time
     C                     MOVELAVAYNA    $QAYNA           User Id
     C                     MOVELAVA0NA    $QA0NA           Job Name
     C                     Z-ADDAVAXDT    $QAXDT           Job Date
      * USER: Process before print of detail format
      * CASE: LCL.First time flag 2     USR is Yes
     C           YL0018    IFEQ 'Y'                        *IF
     C           W0FSUM    ADD  YL0017    YL0020           USR Counter
      * CASE: LCL.USR Counter GE LCL.Page Length
     C           YL0020    IFGE YL0019                     *IF
      * SET W0PB03             US - /UT User Source  * 
     C                     MOVEL'Y'       W0BP03  1
     C                     ELSE
      * CASE: *OTHERWISE
      * SET W0PB03             US - /UT User Source  * 
     C                     MOVEL'N'       W0BP03  1
     C                     END                             *FI
     C                     MOVEL'N'       YL0018           First time flag
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * These fields are print control fields used in the previous PRTOBJ
      * to control the Header field print when overflow occurs.
      * Do first time for Order Break
      * CASE: WRK.USR First Time is Yes
     C           WUTMST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTMST           USR First Time
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUDLST           USR Overflow
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     END                             *FI
      *
      *================================================================
     CSR         H2EXIT    ENDSR
      /EJECT
     CSR         H3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN AVBKC7    WZH001           Ship To Custome
     C                     Z-ADDAVBKC7    WZH001
     C           *LIKE     DEFN AVI1SX    WZH002           Comment Type
     C                     MOVELAVI1SX    WZH002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFH    OREQ '1'
     C           KRSH      READE@AVCPG4                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFH  1
      * Quit if no record read
     C           W0EOFH    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0HL00  1        Ship To Custome
     C                     MOVEL*BLANK    W0HL01  1        Comment Type
     C           W0EOFH    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0HL00  1        Ship To Custome
     C                     MOVEL'Y'       W0HL01  1        Comment Type
     C                     ELSE
      * Next record - Detect level breaks
     C           AVBKC7    IFNE WZH001                     Ship To Custome
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL00
     C                     END
     C           AVI1SX    IFNE WZH002                     Comment Type
     C           W0HL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL01
     C                     END
     C                     END
      *================================================================
     CSR         H3EXIT    ENDSR
      /EJECT
     CSR         H4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0HL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP01
     C                     END
      *
     C           W0HL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP00
     C                     END
      *
     C           W0EOFH    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         H4EXIT    ENDSR
      /EJECT
     CSR         I0MAIN    BEGSR
      *================================================================
      * Prt Country Comment   PO: Mainline
      *================================================================
      * Prt Country Comment   PO: Initialise
     C                     EXSR ZIINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN B1KXCD    WQKI01           Country Code
     C           *LIKE     DEFN B1I1SX    WQKI02           Comment Type
      * Define keylist
     C           KRSI      KLIST
     C                     KFLD           WQKI01           Country Code
     C                     KFLD           WQKI02           Comment Type
      * Setup key
     C                     MOVELYL0021    WQKI01           Country Code
     C                     MOVEL'PL'      WQKI02           Comment Type
      * Establish starting position
     C           KRSI      SETLL@B1REED                    *
      * Read first record with user selection
     C                     EXSR I3READ
     C           W0EOFI    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0IL1P  1        First page
     C                     MOVEL'Y'       W0IL00  1        Country Code
     C                     MOVEL'Y'       W0IL01  1        Comment Type
      * Set column headings flag
     C                     MOVE 'Y'       W0ICDT
      * Print report body
     C           W0EOFI    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR I1PHDR
      * Print report detail line
     C                     EXSR I2PDTL
      * Read next record with user selection
     C                     EXSR I3READ
      * Print totals
     C                     EXSR I4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         I0EXIT    ENDSR
      /EJECT
     CSR         I1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0IL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IP1P  1
     C                     END
      *
     C           W0IL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IP00  1
     C                     END
      *
     C           W0IL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IP01  1
     C                     END
      *
      *================================================================
     CSR         I1EXIT    ENDSR
      /EJECT
     CSR         I2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELB1KXCD    $RKXCD           Country Code
     C                     MOVELB1I1SX    $RI1SX           Comment Type
     C                     Z-ADDB1M5NX    $RM5NX           Comment Sequenc
     C                     MOVELB1Q6NA    $RQ6NA           Comment
     C                     MOVELB1UVST    $RUVST           EDI Status 1
     C                     MOVELB1UWST    $RUWST           EDI Status 2
     C                     MOVELB1UXST    $RUXST           EDI Status 3
     C                     MOVELB1VSST    $RVSST           Record Status
     C                     Z-ADDB1AATM    $RAATM           Job Time
     C                     MOVELB1AYNA    $RAYNA           User Id
     C                     MOVELB1A0NA    $RA0NA           Job Name
     C                     Z-ADDB1AXDT    $RAXDT           Job Date
      * USER: Process before print of detail format
      * CASE: LCL.First time flag 2     USR is Yes
     C           YL0022    IFEQ 'Y'                        *IF
     C           W0FSUM    ADD  YL0025    YL0024           USR Counter
      * CASE: LCL.USR Counter GE LCL.Page Length
     C           YL0024    IFGE YL0023                     *IF
      * SET W0PB03             US - /UT User Source  * 
     C                     MOVEL'Y'       W0BP03  1
     C                     ELSE
      * CASE: *OTHERWISE
      * SET W0PB03             US - /UT User Source  * 
     C                     MOVEL'N'       W0BP03  1
     C                     END                             *FI
     C                     MOVEL'N'       YL0022           First time flag
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * These fields are print control fields used in the previous PRTOBJ
      * to control the Header field print when overflow occurs.
      * Do first time for Order Break
      * CASE: WRK.USR First Time is Yes
     C           WUTMST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTMST           USR First Time
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUDLST           USR Overflow
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     END                             *FI
      *
      *================================================================
     CSR         I2EXIT    ENDSR
      /EJECT
     CSR         I3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN B1KXCD    WZI001           Country Code
     C                     MOVELB1KXCD    WZI001
     C           *LIKE     DEFN B1I1SX    WZI002           Comment Type
     C                     MOVELB1I1SX    WZI002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFI    OREQ '1'
     C           KRSI      READE@B1REED                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFI  1
      * Quit if no record read
     C           W0EOFI    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0IL00  1        Country Code
     C                     MOVEL*BLANK    W0IL01  1        Comment Type
     C           W0EOFI    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0IL00  1        Country Code
     C                     MOVEL'Y'       W0IL01  1        Comment Type
     C                     ELSE
      * Next record - Detect level breaks
     C           B1KXCD    IFNE WZI001                     Country Code
      * Set on level break indicator
     C                     MOVEL'Y'       W0IL00
     C                     END
     C           B1I1SX    IFNE WZI002                     Comment Type
     C           W0IL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0IL01
     C                     END
     C                     END
      *================================================================
     CSR         I3EXIT    ENDSR
      /EJECT
     CSR         I4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0IL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0IP01
     C                     END
      *
     C           W0IL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0IP00
     C                     END
      *
     C           W0EOFI    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         I4EXIT    ENDSR
      /EJECT
     CSR         J0MAIN    BEGSR
      *================================================================
      * PRT Load Summ Exp Inst PO: Mainline
      *================================================================
      * PRT Load Summ Exp Inst PO: Initialise
     C                     EXSR ZJINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQKJ01           Company Number
     C           *LIKE     DEFN WHC4NB    WQKJ02           Order Number
      * Define keylist
     C           KRSJ      KLIST
     C                     KFLD           WQKJ01           Company Number
     C                     KFLD           WQKJ02           Order Number
      * Setup key
     C                     Z-ADD$UAIC3    WQKJ01           Company Number
     C                     Z-ADD$SC4NB    WQKJ02           Order Number
      * Establish starting position
     C           KRSJ      SETLL@AMREJF                    *
      * Read first record with user selection
     C                     EXSR J3READ
     C           W0EOFJ    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0JL1P  1        First page
     C                     MOVEL'Y'       W0JL00  1        Company Number
      * Set column headings flag
     C                     MOVE 'Y'       W0JCDT
      * Print report body
     C           W0EOFJ    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR J1PHDR
      * Print report detail line
     C                     EXSR J2PDTL
      * Read next record with user selection
     C                     EXSR J3READ
      * Print totals
     C                     EXSR J4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         J0EXIT    ENDSR
      /EJECT
     CSR         J1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0JL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0JP1P  1
     C                     END
      *
     C           W0JL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0JP00  1
     C                     END
      *
      *================================================================
     CSR         J1EXIT    ENDSR
      /EJECT
     CSR         J2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWHAIC3    $TAIC3           Company Number
     C                     Z-ADDWHC4NB    $TC4NB           Order Number
     C                     Z-ADDWHRMNB    $TRMNB           Load ID
     C                     Z-ADDWHRUNB    $TRUNB           Stop_Drop Seque
     C                     MOVELWHXACD    $TXACD           Shipping Line
     C                     MOVEL*BLANK    $TJNNA           USR Description
     C                     MOVELWHJ1T1    $TJ1T1           OHE Booking Num
     C                     Z-ADDWHQWDT    $TQWDT           OHE Sail_Flight
     C                     MOVELWHOANA    $TOANA           Port Delv Termi
     C                     MOVELWHHBAA    $THBAA           OHE City
     C                     MOVELWHHCAA    $THCAA           OHE Discharge P
     C                     Z-ADDWHQYDT    $TQYDT           OHE Arrival Dat
     C                     MOVELWHJ0T1    $TJ0T1           OHE Vessel_Airl
     C                     MOVELWHGENY    $TGENY           OHE Voyage_Flig
     C                     MOVELWHJ2T1    $TJ2T1           OHE Container N
     C                     Z-ADDWHQXDT    $TQXDT           OHE Port Cut Da
     C                     MOVELWHHDAA    $THDAA           OHE Late Delive
     C                     MOVELWHCCTX    $TCCTX           OHE Ship Status
     C                     MOVELWHRLNA    $TRLNA           OHE Comment 1
     C                     MOVELWHRMNA    $TRMNA           OHE Comment 2
     C                     Z-ADDWHGINY    $TGINY           OHE Unused Numb
     C                     Z-ADDWHGFNY    $TGFNY           OHE Unused Numb
     C                     Z-ADDWHGGNY    $TGGNY           OHE Unused Numb
     C                     Z-ADDWHGHNY    $TGHNY           OHE Unused Numb
     C                     Z-ADDWHHEVL    $THEVL           OHE HPB RIN Equ
     C                     Z-ADDWHHFVL    $THFVL           OHE HPB RIN Pri
     C                     Z-ADDWHHGVL    $THGVL           Transload Termi
     C                     Z-ADDWHQZDT    $TQZDT           OHE Est Arrv at
     C                     Z-ADDWHQ0DT    $TQ0DT           OHE Backhaul ET
     C                     Z-ADDWHQ1DT    $TQ1DT           OHE Port_Pier P
     C                     Z-ADDWHQ2DT    $TQ2DT           OHE Actual Ship
     C                     MOVELWHC2TX    $TC2TX           OHE Carrier SCA
     C                     MOVELWHC3TX    $TC3TX           OHE Spot Buy
     C                     MOVELWHC6TX    $TC6TX           OHE PO ACK Flag
     C                     MOVELWHCHTX    $TCHTX           OHE Override Ty
     C                     MOVELWHCITX    $TCITX           OHE Backhaul St
     C                     MOVELWHCLTX    $TCLTX           OHE Backhaul ET
     C                     MOVELWHB4TX    $TB4TX           OHE Load Haul T
     C                     MOVELWHCUTX    $TCUTX           OHE Backhaul Ca
     C                     MOVELWHCVTX    $TCVTX           OHE Bookings Co
     C                     MOVELWHB9TX    $TB9TX           OHE EDI Error R
     C                     MOVELWHJWSC    $TJWSC           OHE EDI Error R
     C                     Z-ADDWHITNY    $TITNY           HPB COA Batch N
     C                     MOVELWHLMT1    $TLMT1           Delivery P_O  N
     C                     MOVELWHLWAA    $TLWAA           OHE Intended fo
     C                     MOVELWHFVST    $TFVST           OHE EDI 943 Act
     C                     MOVELWHF0ST    $TF0ST           OHE EDI 944 Act
     C                     MOVELWHF2ST    $TF2ST           OHE EDI 940 Act
     C                     MOVELWHF3ST    $TF3ST           OHE EDI 945 Act
     C                     MOVELWHJUSC    $TJUSC           OHE EDI 856 Act
     C                     MOVELWHJVSC    $TJVSC           OHE EDI 824 Act
     C                     MOVELWHV3T1    $TV3T1           OHE Transload S
     C                     MOVELWHV4T1    $TV4T1           OHE Abs Rate Ov
     C                     MOVELWHV5T1    $TV5T1           OHE Appt Confir
     C                     MOVELWHV6T1    $TV6T1           OHE Backhaul Co
     C                     MOVELWHV7T1    $TV7T1           OHE Backhaul Ch
     C                     MOVELWHV8T1    $TV8T1           OHE Transload C
     C                     MOVELWHV9T1    $TV9T1           OHE Pier Pass I
     C                     MOVELWHWAT1    $TWAT1           OHE Carrier Nm
     C                     MOVELWHWBT1    $TWBT1           OHE Appt Confir
     C                     MOVELWHWCT1    $TWCT1           OHE Backhaul Co
     C                     MOVELWHWDT1    $TWDT1           Letter of Credi
     C                     Z-ADDWHQJNY    $TQJNY           OHE Backhaul Re
     C                     Z-ADDWHQKNY    $TQKNY           LD Stop_Drop
     C                     Z-ADDWHQLNY    $TQLNY           OHE Unused Numb
     C                     Z-ADDWHP8NY    $TP8NY           OHE Pier Pass F
     C                     Z-ADDWHP9NY    $TP9NY           OHE Port Check
     C                     Z-ADDWHQANY    $TQANY           OHE Port Cut Ti
     C                     Z-ADDWHQCNY    $TQCNY           OHE Backhaul Tr
     C                     Z-ADDWHQDNY    $TQDNY           OHE Load Sched
     C                     Z-ADDWHQENY    $TQENY           Original Appoin
     C                     Z-ADDWHQFNY    $TQFNY           Original Appoin
     C                     Z-ADDWHQGNY    $TQGNY           OHE PowerPro Lo
     C                     Z-ADDWHQHNY    $TQHNY           OHE PowerPro Lo
     C                     Z-ADDWHQINY    $TQINY           OHE Unused Nume
     C                     Z-ADDWHQMNY    $TQMNY           OHE Orig ABS Fr
     C                     MOVELWHMYU1    $TMYU1           OHE Genset Numb
     C                     MOVELWHJXSC    $TJXSC           OHE Email BOL_S
     C                     MOVELWHJYSC    $TJYSC           OHE EDI Order A
     C                     MOVELWHJZSC    $TJZSC           OHE EDI 601 Act
     C                     MOVELWHJ0SC    $TJ0SC           OHE Unused Stat
     C                     MOVELWHMZU1    $TMZU1           OHE Unused Text
     C                     MOVELWHM0U1    $TM0U1           OHE Unused Text
     C                     MOVELWHM1U1    $TM1U1           OHE Customer Ve
     C                     MOVELWHM2U1    $TM2U1           OHE EDI 824 AES
     C                     MOVELWHM3U1    $TM3U1           OHE Unused Text
     C                     Z-ADDWHW5DT    $TW5DT           OHE Unused Date
     C                     Z-ADDWHW6DT    $TW6DT           OHE Unused Date
     C                     MOVELWHUVST    $TUVST           EDI Status 1
     C                     MOVELWHUWST    $TUWST           EDI Status 2
     C                     MOVELWHUXST    $TUXST           EDI Status 3
     C                     MOVELWHVSST    $TVSST           Record Status
     C                     Z-ADDWHAATM    $TAATM           Job Time
     C                     MOVELWHAYNA    $TAYNA           User Id
     C                     MOVELWHA0NA    $TA0NA           Job Name
     C                     Z-ADDWHAXDT    $TAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0JPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         J2EXIT    ENDSR
      /EJECT
     CSR         J3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WHAIC3    WZJ001           Company Number
     C                     Z-ADDWHAIC3    WZJ001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFJ    OREQ '1'
     C           KRSJ      READE@AMREJF                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFJ  1
      * Quit if no record read
     C           W0EOFJ    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: DB1.Record Status is Deleted & Inactive
     C           WHVSST    IFEQ 'D'                        *IF
     C           WHVSST    OREQ 'I'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0JL00  1        Company Number
     C           W0EOFJ    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0JL00  1        Company Number
     C                     ELSE
      * Next record - Detect level breaks
     C           WHAIC3    IFNE WZJ001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0JL00
     C                     END
     C                     END
      *================================================================
     CSR         J3EXIT    ENDSR
      /EJECT
     CSR         J4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0JL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0JP00
     C                     END
      *
     C           W0EOFJ    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         J4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT PrelPick /LoadId PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT PrelPick /LoadId PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of PRT PrelPick /LoadId PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE 'P'       W0AP00
     C                     END                             FI
      * Print Deadline Departure Date of PRT PrelPick /LoadId PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Convert fields to external form
      * Convert LPT Load Plan Start Dt to display format
      * Convert date
     C           1000000   ADD  $CP0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCP0DT
      * Print format
     C                     WRITE$CKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Deadline Departure Time of PRT PrelPick /LoadId PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Load ID of PRT PrelPick /LoadId PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$EKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print Detail line. of PRT PrelPick /LoadId PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * USER: On print of detail format
     C                     MOVEL'N'       WUB5SX           Print Yes/No
      * Mention hidden format
     C   99N99             WRITE$FDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PRT Prelim List Dtls   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Load ID of PRT Prelim List Dtls   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Stop_Drop of PRT Prelim List Dtls   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Order Number of PRT Prelim List Dtls   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Detail line. of PRT Prelim List Dtls   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     Z-ADD$FAIC3    $GBNC3           Company
     C                     MOVEL'Y'       WUE6ST           USR Status (Y/N
      * Increment counter (used for null report msg) if select record
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * RTV Prelim Pick fldADysRT - Order Header TRG  * 
     C                     EXSR SDRVGN
      * CASE: PAR.Header Status is Confirmed & Complete
     C           WN0007    IFEQ 'C'                        *IF
     C           WN0007    OREQ 'R'
     C                     MOVEL*BLANK    $GJFNA           @Narrative  6
     C                     MOVEL'COMPL'   $GJFNA           @Narrative  6
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $GJFNA           @Narrative  6
     C                     END                             *FI
      * ** Rtv miles into wrk context. If Override miles exist, put them
      * ** on the report, else, put total miles       E00207
      * RTV Prelim Pick fields RT - Load Header  * 
     C                     EXSR SERVGN
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$SRMNB    WL0001           Load ID
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YN0002    P      Load Status
     C                     Z-ADDWL0003    YN0003           Total Load Mile
     C                     Z-ADDWL0004    WUK2DT           Override Total
      * ** put override or total miles into cur context   E00207
      * CASE: WRK.Override Total Load Miles is Entered
     C           WUK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDWUK2DT    $GTLMI           Total Load Mile
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUTLMI    $GTLMI           Total Load Mile
     C                     END                             *FI
      * RTV Prelim. Pick data  RT - PD Order Detail  * 
     C                     EXSR SGRVGN
      * If not first time, then hide header fields
      * CASE: WRK.USR First Time is No
     C           WUTMST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       WUE6ST           USR Status (Y/N
     C                     MOVEL'N'       WN0018           USR Display 2
     C                     END                             *FI
     C                     MOVEL'N'       WUTMST           USR First Time
      * Dont RTV Departure Date and Time, but determine if to print it.
      * CASE: WRK.ZERO is Zero
     C           WUW0NB    IFEQ *ZERO                      *IF
      * The deadline departure date/time is used from the om load header
     C                     Z-ADDWN0005    $GGFDT           Departure Date
      * CUR.Departure Time = PAR.Deadline Departure Time *HHMM
     C                     Z-ADDWN0006    XTTIM
     C           XTTIM     DIV  100       $GS6NB
      * Change zero hours to 24:00 hours unless date is also zero
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CUR.Departure Time is Zero
      *   |- c2    : CUR.Departure Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $GS6NB    IFEQ *ZERO                      *IF
     C           $GGFDT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD2400      $GS6NB           Departure Time
     C                     END                             *FI
      * Do not print departure deadlines if date/time is zero
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CUR.Departure Date is Not entered
      *   |- c2    : CUR.Departure Time is Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $GGFDT    IFEQ *ZERO                      *IF
     C           $GS6NB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WN0018           USR Display 2
     C                     END                             *FI
      * Do not print departure deadlines if Collect Truck
      * CASE: CUR.Shipping Method is Collect Truck
     C           $GQ2CD    IFEQ 'CT'                       *IF
     C                     MOVEL'N'       WN0018           USR Display 2
     C                     END                             *FI
      * Do not print Departure Date/Time if Load Status is not Lockeed OR
      *   Mileage is less than Zero OR Load Accepted Flag is not Accepted
      * Rtv Dsp Dept Dte/Tme  IF
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.Load Status is Entered,Combined,Unlock
      *   |- c2    : PAR.Load Acceptance Flag is Load not Accepted
      *   |- c3    : PAR.Total Load Miles LE WRK.ZERO
      *   '-
     C           $GPKST    IFEQ 'C'                        *IF
     C           $GPKST    OREQ 'E'
     C           $GPKST    OREQ 'U'
     C           FJRMST    OREQ 'U'                        *OR
     C           $GTLMI    ORLE WUW0NB                     *OR
     C                     MOVEL'N'       WN0018           USR Display 2
     C                     END                             *FI
      * ** Also test the Override miles. If not entered, turn off display
      * CASE: PAR.USR Display 2 is No
     C           WN0018    IFEQ 'N'                        *IF
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$SRMNB    WL0001           Load ID
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YN0002    P      Load Status
     C                     Z-ADDWL0003    YN0003           Total Load Mile
     C                     Z-ADDWL0004    WUK2DT           Override Total
      * CASE: WRK.Override Total Load Miles is Not Entered
     C           WUK2DT    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       WN0018           USR Display 2
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * OMS336 - Phase I
      * 05/11/04 SLM PKTR01 Multi-Company - Function was changed
      *    to remove Company RST or Pos
      * this needs to RST on order !! doing 1 order at a time -- RMC 6/30
      * RTV Combo for P & T    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$GC4NB    WL0005           Order Number
     C                     Z-ADD$GRMNB    WL0006           Load ID
     C                     MOVELWUVEST    WL0007    P      Palletize
     C                     MOVELWUAGCD    WL0008    P      U_M_Ordered
     C                     MOVELWUIHSX    WL0009    P      Palletize
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WUVEST    P      Palletize
     C                     MOVELWL0008    WUAGCD    P      U_M_Ordered
     C                     MOVELWL0009    WUIHSX    P      Palletize
     C                     MOVEL'Y'       WUXTST           Status Unused 1
      * palletized -- RMC orig code before 6-30-21
      * CASE: palletized=no
      *  - c1 AND c2
      *   |- c1    : WRK.U/M - Ordered is Combos
      *   |- c2    : WRK.Palletize             USR is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUAGCD    IFEQ 'CB'                       *IF
     C           WUIHSX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUXTST           Status Unused 1
     C                     END                             *FI
      * print export if export status=yes
      * CASE: PAR.Export Status is yes
     C           WN0010    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,002   $GIUTX           Text USR
     C                     END                             *FI
      * RTV Shipping Line-OHE  RT - Order Header Extension  * 
     C                     EXSR SKRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Company to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $GBNC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$GBNC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VGBNC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VGBNC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $GAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VGAODT
      * Convert Departure Date to display format
      * Convert date
     C           1000000   ADD  $GGFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VGGFDT
      * Convert LPT Load Plan Start Dt to display format
      * Convert date
     C           1000000   ADD  $GP0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VGP0DT
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $GC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$GC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VGC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VGC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $GAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$GAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VGAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VGAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $GHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$GHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VGHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VGHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  $GEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VGEIDT
     C                     MOVEL'0'       *IN79
     C           WUE6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WN0018    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WN0007    IFEQ *BLANK                     *IF
     C           WN0007    OREQ 'L'
     C           WN0007    OREQ 'A'
     C           WN0007    OREQ 'X'
     C           WN0007    OREQ 'C'
     C           WN0007    OREQ 'R'
     C           WN0007    OREQ 'E'
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           WN0010    IFEQ *BLANK                     *IF
     C           WN0010    OREQ 'N'
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           WN0014    IFEQ *BLANK                     *IF
     C           WN0014    OREQ 'N'
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           WN0011    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           WN0012    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           WUXTST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           WN0013    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$GCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$GDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of PRT Prelim. Pick Dtls  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Company Number of PRT Prelim. Pick Dtls  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Order Number of PRT Prelim. Pick Dtls  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE 'P'       W0CP01
     C                     END                             FI
      * Print Order Sequence Number of PRT Prelim. Pick Dtls  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print Order Secondary Line Seq of PRT Prelim. Pick Dtls  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print Detail line. of PRT Prelim. Pick Dtls  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Rtv Tare Weight        RT - Company Item  * 
     C                     EXSR SLRVGN
      * RTV Item Box Tare Wgt  RT - Item Bill Of Material  * 
     C                     EXSR SMRVGN
     C           WUA3WG    ADD  WUAIWG    WUA4WG           Tare Weight Tot
     C           WUA4WG    MULT $HCCQT    WN0019    H      @Weight
     C                     Z-ADDWN0019    $HA4WG           Tare Weight Tot
     C           $HA4WG    ADD  WCAUWG    $HCDWG           USR Weight Accu
     C                     MOVEL'*'       $HPFTX           Text 1 Length U
     C                     MOVEL'N'       WUDTSX           Print (Yes/No)
      * ** 12/21/2005 LJB - Move qty ordered to 5.0 field for printing
     C                     Z-ADDWCAVQT    $HN8QT           Qty Sched Ord U
      * ** 12/21/2005 LJB - Move qty scheduled to 5.0 field for printing
     C                     Z-ADDWCCCQT    $HN9QT           Qty Sched Prod
      * CASE: CUR.Qty Sched Ord USR NE CUR.Qty Sched Prod USR
     C           $HN8QT    IFNE $HN9QT                     *IF
     C                     MOVEL'Y'       WUDTSX           Print (Yes/No)
     C                     END                             *FI
      * Added for OMS349
     C                     EXSR UCSUBR                     Added for OMS34
      * Palletize
      * CASE: DB1.Palletize is yes
     C           WCVEST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0001           Palletize
      * Load unique pallet types
      * CASE:
      *  - c1ANDc2ANDc3ANDc4
      *   |- c1    : DB1.OD Pallet Type NE LCL.Pallet Type 1
      *   |- c2    : DB1.OD Pallet Type NE LCL.Pallet Type 2
      *   |- c3    : DB1.OD Pallet Type NE LCL.Pallet Type 3
      *   |- c4    : DB1.OD Pallet Type NE LCL.Pallet Type 4
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCF5SX    IFNE YL0005                     *IF
     C           WCF5SX    IFNE YL0006                     *IF
     C           WCF5SX    IFNE YL0007                     *IF
     C           WCF5SX    IFNE YL0008                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Load next blank pallet type field
      * CASE: LCL.Pallet Type 1 is None
     C           YL0005    IFEQ *BLANK                     *IF
     C                     MOVELWCF5SX    YL0005           Pallet Type 1
     C                     ELSE
      * CASE: LCL.Pallet Type 2 is None
     C           YL0006    IFEQ *BLANK                     *IF
     C                     MOVELWCF5SX    YL0006           Pallet Type 2
     C                     ELSE
      * CASE: LCL.Pallet Type 3 is None
     C           YL0007    IFEQ *BLANK                     *IF
     C                     MOVELWCF5SX    YL0007           Pallet Type 3
     C                     ELSE
      * CASE: LCL.Pallet Type 4 is None
     C           YL0008    IFEQ *BLANK                     *IF
     C                     MOVELWCF5SX    YL0008           Pallet Type 4
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Slip Sheet
      * CASE: DB1.Slip Sheet is yes
     C           WCVGST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0002           Slip Sheet
     C                     END                             *FI
      * save if any boxes exist on order for printing Shrink Wrap comment
      * CASE: DB1.U/M - Ordered is EQ Boxes
     C           WCAGCD    IFEQ 'BX'                       *IF
     C                     MOVELWCAGCD    YL0004           U_M_Ordered
     C                     END                             *FI
     C                     Z-ADDWCH8NX    $HUPNB           Min Carcass Wei
     C                     Z-ADDWCH9NX    $HUQNB           Max Carcass Wei
      * Rtv Req Dlv Dt/Time   RT - Order Header TRG  * 
     C                     EXSR SORVGN
      * Val Age Information   IF
     C                     MOVEL*BLANK    WUB8SX           Error Flag
     C                     MOVEL*BLANK    WUECST           Error Status
     C                     MOVEL*BLANK    WUKWTX           Error Reason De
     C                     MOVEL*BLANK    WUKXTX           Error Reason De
     C                     MOVEL*BLANK    WUKYTX           Error Reason De
     C                     MOVEL*BLANK    WUKZTX           Error Reason De
     C                     MOVEL*BLANK    WUTITX           Error Reason De
      * CASE: PAR.Company Organization is Seaboard
     C           WUYJSX    IFEQ 'S'                        *IF
      * CASE: PAR.Requested Delivery Date is not entered
     C           YL0010    IFEQ 0                          *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  YL0010    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0001
      * Send message 'Requested Delv Date Error'
     C                     MOVEL'USR4329' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: PAR.Scheduled Ship Date is not entered
     C           $HAODT    IFEQ 0                          *IF
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $HAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0002
      * Send message 'Scheduled Ship Date Req'd'
     C                     MOVEL'USR2230' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Age information   XF - Order Detail  * 
     C                     CALL 'PNQNXFR'              90  Val Age informa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $HHGCD    WQ0004  70       Item Code
     C                     PARM $HAJCD    WQ0005  3        Warehouse Code
     C           WUB8SX    PARM WUB8SX    WQ0006  1        Error Flag
     C           WUKWTX    PARM WUKWTX    WQ0007 30        Error Reason De
     C           WUKXTX    PARM WUKXTX    WQ0008 30        Error Reason De
     C           WUKYTX    PARM WUKYTX    WQ0009 30        Error Reason De
     C           WUKZTX    PARM WUKZTX    WQ0010 30        Error Reason De
     C           WUTITX    PARM WUTITX    WQ0011 30        Error Reason De
     C                     PARM $HAIC3    WQ0012  30       Company Number
     C                     PARM $HAODT    WQ0013  70       Scheduled Ship
     C                     PARM YL0010    WQ0014  70       Requested Deliv
     C                     PARM $HRINY    WQ0015  40       Item Age Days
     C                     PARM $HTIDT    WQ0016  70       Production Ovr
     C                     PARM $HTJDT    WQ0017  70       Production Ovr
     C           $HTNDT    PARM $HTNDT    WQ0018  70       Production AgeD
     C           $HTODT    PARM $HTODT    WQ0019  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Verify if message should be sent if validation is required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Error Flag            USR is Yes
      *   |- c2    : PAR.Production Dates Sts Usr is Validation routine
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUB8SX    IFEQ 'Y'                        *IF
     C           'C'       IFEQ 'V'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * message 1 Product is shipped before product is made
      * CASE: WRK.Error Reason Descript 1 NE WRK.Blank for 30          US
     C           WUKWTX    IFNE WUW4TX                     *IF
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $HTNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0003
      * Send message 'PrdDte Shipped BEF Made'
     C                     MOVEL'USR4307' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 2 Either Days or override date but not both
      * CASE: WRK.Error Reason Descript 2 NE WRK.Blank for 30          US
     C           WUKXTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADD$HRINY    ZA0004           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $HTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0005
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  $HTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0006
      * Send message 'Enter Age Days or Dates'
     C                     MOVEL'USR4304' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 3 With Chill Days Either Days or Override Dates required
      * CASE: WRK.Error Reason Descript 3 NE WRK.Blank for 30          US
     C           WUKYTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADD$HRINY    ZA0007           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $HTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0008
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  $HTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0009
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 4 From date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 4 NE WRK.Blank for 30          US
     C           WUKZTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADD$HRINY    ZA0010           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $HTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0011
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  $HTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0012
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 5 To date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 5 NE WRK.Blank for 30          US
     C           WUTITX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADD$HRINY    ZA0013           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $HTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0014
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  $HTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0015
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: PAR.Production Ovr AgeDte Fr is not entered
     C           $HTIDT    IFEQ 0                          *IF
      * Setup message data for message
     C                     Z-ADD$HRINY    ZA0016           Item Age Days
      * Send message 'Invalid Item Age Days'
     C                     MOVEL'USR4309' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $HTNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0017
      * Convert Production AgeDte To to display format
      * Convert date
     C           1000000   ADD  $HTODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0018
      * Send message 'Invalid Prod OvrDates'
     C                     MOVEL'USR4310' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $HHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$HHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VHHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VHHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $HTNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VHTNDT
      * Convert Production AgeDte To to display format
      * Convert date
     C           1000000   ADD  $HTODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VHTODT
     C                     MOVEL'0'       *IN79
     C           WUDTSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$HCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$HDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print Company Number of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print Order Number of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print Order Sequence Number of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP02
     C                     END                             FI
      * Print Order Secondary Line Seq of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP03    ANDEQ'P'
      * Print format
     C                     WRITE$IKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DP03
     C                     END                             FI
      * Print Detail line. of PRT Detail Comment     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$JCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$JDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Print First Page Format of PRT Trf Cmts Pre Pick  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0EL1P
     C                     END                             FI
      * Print Load ID of PRT Trf Cmts Pre Pick  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP00
     C                     END                             FI
      * Print Detail line. of PRT Trf Cmts Pre Pick  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ECDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EPDT    ANDEQ'P'
      * Print column headings if required
     C           W0ECDT    IFEQ 'Y'
     C                     WRITE$MCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ECDT
     C                     END                             FI
      * Print format
     C                     WRITE$MDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EPDT
     C                     END                             FI
      * Print First Page Format of PRT Shipping Inst.     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0FL1P
     C                     END                             FI
      * Print Company Number of PRT Shipping Inst.     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP00
     C                     END                             FI
      * Print Order Number of PRT Shipping Inst.     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP01    ANDEQ'P'
      * Print format
     C                     WRITE$NKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0FCDT
      *
      * Reset format print flag
     C                     MOVE 'P'       W0FP01
     C                     END                             FI
      * Print Detail line. of PRT Shipping Inst.     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0FCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FPDT    ANDEQ'P'
      * Print column headings if required
     C           W0FCDT    IFEQ 'Y'
     C                     WRITE$OCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0FCDT
     C                     END                             FI
      * Print format
     C                     WRITE$ODTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0FPDT
     C                     END                             FI
      * Print First Page Format of PRT Ship To Address    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0GL1P
     C                     END                             FI
      * Print Company Number of PRT Ship To Address    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP00
     C                     END                             FI
      * Print Detail line. of PRT Ship To Address    PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0GCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * RTV Customer Telephone RT - Customer  * 
     C                     EXSR SQRVGN
      * RTV Country Code       RT - Customer  * 
     C                     EXSR SRRVGN
      * RTV Description        RT - PD Sales Route  * 
     C                     EXSR SSRVGN
      * Print country if not USA
      * CASE: WRK.Country Code is USA
     C           WUKXCD    IFEQ 'USA'                      *IF
     C                     MOVEL'N'       WUD4ST           USR Flag 1
      * ** Clear country description if USA           05/10/2007
     C                     MOVEL*BLANK    WUDATX           Country Descrip
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUD4ST           USR Flag 1
      * RTV Desc, Status       RT - Country  * 
     C                     EXSR STRVGN
     C                     END                             *FI
     C                     MOVELBEBRTX    WUADTX           Name
     C                     MOVELBEHMNA    WUACNA           Address Line 1
     C                     MOVELBEHONA    WUADNA           Address Line 2
     C                     MOVELBEHPNA    WUAENA           Address Line 3
     C                     MOVELBEHNNA    WUAJNA           City
     C                     MOVELBEDBCD    WUEINA           State
     C                     MOVELBECKTX    WUBTTX           Zip Postal Code
      * RTV Comprs Nme/Add/CtryUS - /UT User Source  * Ship To Address
      * Use this function to compress name/address information
      *
     C                     MOVELWUADTX    UUADTX           Name
     C                     MOVELWUACNA    UUACNA           Address 1
     C                     MOVELWUADNA    UUADNA           Address 2
     C                     MOVELWUAENA    UUAENA           Address 3
     C                     MOVELWUAJNA    UUAJNA           City
     C                     MOVELWUEINA    UUEINA           State
     C                     MOVELWUBTTX    UUBTTX           Zip
     C                     MOVELWUDATX    UUDATX           Country
     C                     EXSR UJ1UF
     C                     MOVELUAD,1     $PGINA
     C                     MOVELUAD,2     $PGJNA
     C                     MOVELUAD,3     $PGKNA
     C                     MOVELUAD,4     $PGLNA
     C                     MOVELUAD,5     $PGMNA
     C                     MOVELUAD,6     $PNWNA
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Special Instructions is Equal to Blank
      *   |- c2    : DB1.Special Instructions 2 is Equal to Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BEB6NA    IFEQ *BLANK                     *IF
     C           BEBYNA    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUD4ST           USR Flag 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUD4ST           USR Flag 1
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $PBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$PBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VPBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VPBKC7           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           WUD4ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0GCDT    IFEQ 'Y'
     C                     WRITE$PCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0GCDT
     C                     END                             FI
      * Print format
     C                     WRITE$PDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0GPDT
     C                     END                             FI
      * Print First Page Format of Prt Cust Comment PL   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0HL1P
     C                     END                             FI
      * Print Ship To Customer of Prt Cust Comment PL   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP00
     C                     END                             FI
      * Print Comment Type of Prt Cust Comment PL   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP01
     C                     END                             FI
      * Print Detail line. of Prt Cust Comment PL   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0HCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HPDT    ANDEQ'P'
     C                     MOVEL'0'       *IN79
     C           WUTMST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0HCDT    IFEQ 'Y'
     C                     WRITE$QCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0HCDT
     C                     END                             FI
      * Print format
     C                     WRITE$QDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0HPDT
     C                     END                             FI
      * Print First Page Format of Prt Country Comment   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0IP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0IL1P
     C                     END                             FI
      * Print Country Code of Prt Country Comment   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0IP00
     C                     END                             FI
      * Print Comment Type of Prt Country Comment   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0IP01
     C                     END                             FI
      * Print Detail line. of Prt Country Comment   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ICDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IPDT    ANDEQ'P'
      * Print column headings if required
     C           W0ICDT    IFEQ 'Y'
     C                     WRITE$RCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ICDT
     C                     END                             FI
      * Print format
     C                     WRITE$RDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0IPDT
     C                     END                             FI
      * Print First Page Format of PRT Load Summ Exp Inst PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0JP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0JP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0JP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0JL1P
     C                     END                             FI
      * Print Company Number of PRT Load Summ Exp Inst PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0JP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0JP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0JP00
     C                     END                             FI
      * Print Detail line. of PRT Load Summ Exp Inst PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0JCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0JPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0JPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * RTV Carrier Name       RT - Carrier  * 
     C                     EXSR SZRVGN
      * CUR = DB1 By name
     C                     Z-ADDWHAIC3    $TAIC3           Company Number
     C                     Z-ADDWHC4NB    $TC4NB           Order Number
     C                     Z-ADDWHRMNB    $TRMNB           Load ID
     C                     Z-ADDWHRUNB    $TRUNB           Stop_Drop Seque
     C                     MOVELWHXACD    $TXACD           Shipping Line
     C                     MOVELWHJ1T1    $TJ1T1           OHE Booking Num
     C                     Z-ADDWHQWDT    $TQWDT           OHE Sail_Flight
     C                     MOVELWHOANA    $TOANA           Port Delv Termi
     C                     MOVELWHHBAA    $THBAA           OHE City
     C                     MOVELWHHCAA    $THCAA           OHE Discharge P
     C                     Z-ADDWHQYDT    $TQYDT           OHE Arrival Dat
     C                     MOVELWHJ0T1    $TJ0T1           OHE Vessel_Airl
     C                     MOVELWHGENY    $TGENY           OHE Voyage_Flig
     C                     MOVELWHJ2T1    $TJ2T1           OHE Container N
     C                     Z-ADDWHQXDT    $TQXDT           OHE Port Cut Da
     C                     MOVELWHHDAA    $THDAA           OHE Late Delive
     C                     MOVELWHCCTX    $TCCTX           OHE Ship Status
     C                     MOVELWHRLNA    $TRLNA           OHE Comment 1
     C                     MOVELWHRMNA    $TRMNA           OHE Comment 2
     C                     Z-ADDWHGINY    $TGINY           OHE Unused Numb
     C                     Z-ADDWHGFNY    $TGFNY           OHE Unused Numb
     C                     Z-ADDWHGGNY    $TGGNY           OHE Unused Numb
     C                     Z-ADDWHGHNY    $TGHNY           OHE Unused Numb
     C                     Z-ADDWHHEVL    $THEVL           OHE HPB RIN Equ
     C                     Z-ADDWHHFVL    $THFVL           OHE HPB RIN Pri
     C                     Z-ADDWHHGVL    $THGVL           Transload Termi
     C                     Z-ADDWHQZDT    $TQZDT           OHE Est Arrv at
     C                     Z-ADDWHQ0DT    $TQ0DT           OHE Backhaul ET
     C                     Z-ADDWHQ1DT    $TQ1DT           OHE Port_Pier P
     C                     Z-ADDWHQ2DT    $TQ2DT           OHE Actual Ship
     C                     MOVELWHC2TX    $TC2TX           OHE Carrier SCA
     C                     MOVELWHC3TX    $TC3TX           OHE Spot Buy
     C                     MOVELWHC6TX    $TC6TX           OHE PO ACK Flag
     C                     MOVELWHCHTX    $TCHTX           OHE Override Ty
     C                     MOVELWHCITX    $TCITX           OHE Backhaul St
     C                     MOVELWHCLTX    $TCLTX           OHE Backhaul ET
     C                     MOVELWHB4TX    $TB4TX           OHE Load Haul T
     C                     MOVELWHCUTX    $TCUTX           OHE Backhaul Ca
     C                     MOVELWHCVTX    $TCVTX           OHE Bookings Co
     C                     MOVELWHB9TX    $TB9TX           OHE EDI Error R
     C                     MOVELWHJWSC    $TJWSC           OHE EDI Error R
     C                     Z-ADDWHITNY    $TITNY           HPB COA Batch N
     C                     MOVELWHLMT1    $TLMT1           Delivery P_O  N
     C                     MOVELWHLWAA    $TLWAA           OHE Intended fo
     C                     MOVELWHFVST    $TFVST           OHE EDI 943 Act
     C                     MOVELWHF0ST    $TF0ST           OHE EDI 944 Act
     C                     MOVELWHF2ST    $TF2ST           OHE EDI 940 Act
     C                     MOVELWHF3ST    $TF3ST           OHE EDI 945 Act
     C                     MOVELWHJUSC    $TJUSC           OHE EDI 856 Act
     C                     MOVELWHJVSC    $TJVSC           OHE EDI 824 Act
     C                     MOVELWHV3T1    $TV3T1           OHE Transload S
     C                     MOVELWHV4T1    $TV4T1           OHE Abs Rate Ov
     C                     MOVELWHV5T1    $TV5T1           OHE Appt Confir
     C                     MOVELWHV6T1    $TV6T1           OHE Backhaul Co
     C                     MOVELWHV7T1    $TV7T1           OHE Backhaul Ch
     C                     MOVELWHV8T1    $TV8T1           OHE Transload C
     C                     MOVELWHV9T1    $TV9T1           OHE Pier Pass I
     C                     MOVELWHWAT1    $TWAT1           OHE Carrier Nm
     C                     MOVELWHWBT1    $TWBT1           OHE Appt Confir
     C                     MOVELWHWCT1    $TWCT1           OHE Backhaul Co
     C                     MOVELWHWDT1    $TWDT1           Letter of Credi
     C                     Z-ADDWHQJNY    $TQJNY           OHE Backhaul Re
     C                     Z-ADDWHQKNY    $TQKNY           LD Stop_Drop
     C                     Z-ADDWHQLNY    $TQLNY           OHE Unused Numb
     C                     Z-ADDWHP8NY    $TP8NY           OHE Pier Pass F
     C                     Z-ADDWHP9NY    $TP9NY           OHE Port Check
     C                     Z-ADDWHQANY    $TQANY           OHE Port Cut Ti
     C                     Z-ADDWHQCNY    $TQCNY           OHE Backhaul Tr
     C                     Z-ADDWHQDNY    $TQDNY           OHE Load Sched
     C                     Z-ADDWHQENY    $TQENY           Original Appoin
     C                     Z-ADDWHQFNY    $TQFNY           Original Appoin
     C                     Z-ADDWHQGNY    $TQGNY           OHE PowerPro Lo
     C                     Z-ADDWHQHNY    $TQHNY           OHE PowerPro Lo
     C                     Z-ADDWHQINY    $TQINY           OHE Unused Nume
     C                     Z-ADDWHQMNY    $TQMNY           OHE Orig ABS Fr
     C                     MOVELWHMYU1    $TMYU1           OHE Genset Numb
     C                     MOVELWHJXSC    $TJXSC           OHE Email BOL_S
     C                     MOVELWHJYSC    $TJYSC           OHE EDI Order A
     C                     MOVELWHJZSC    $TJZSC           OHE EDI 601 Act
     C                     MOVELWHJ0SC    $TJ0SC           OHE Unused Stat
     C                     MOVELWHMZU1    $TMZU1           OHE Unused Text
     C                     MOVELWHM0U1    $TM0U1           OHE Unused Text
     C                     MOVELWHM1U1    $TM1U1           OHE Customer Ve
     C                     MOVELWHM2U1    $TM2U1           OHE EDI 824 AES
     C                     MOVELWHM3U1    $TM3U1           OHE Unused Text
     C                     Z-ADDWHW5DT    $TW5DT           OHE Unused Date
     C                     Z-ADDWHW6DT    $TW6DT           OHE Unused Date
     C                     MOVELWHUVST    $TUVST           EDI Status 1
     C                     MOVELWHUWST    $TUWST           EDI Status 2
     C                     MOVELWHUXST    $TUXST           EDI Status 3
     C                     MOVELWHVSST    $TVSST           Record Status
     C                     Z-ADDWHAATM    $TAATM           Job Time
     C                     MOVELWHAYNA    $TAYNA           User Id
     C                     MOVELWHA0NA    $TA0NA           Job Name
     C                     Z-ADDWHAXDT    $TAXDT           Job Date
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert OHE Sail_Flight Date to display format
      * Convert date
     C           1000000   ADD  $TQWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VTQWDT
      * Convert OHE Arrival Date to display format
      * Convert date
     C           1000000   ADD  $TQYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VTQYDT
      * Print column headings if required
     C           W0JCDT    IFEQ 'Y'
     C                     WRITE$TCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0JCDT
     C                     END                             FI
      * Print format
     C                     WRITE$TDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0JPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT PrelPick /LoadId PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT PrelPick /LoadId PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Deadline Departure Date of PRT PrelPick /LoadId PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * Deadline Departure Time of PRT PrelPick /LoadId PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT PrelPick /LoadId PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT PrelPick /LoadId PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Prelim List Dtls   PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Prelim List Dtls   PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Stop_Drop of PRT Prelim List Dtls   PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Prelim List Dtls   PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Prelim List Dtls   PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD10        W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Prelim. Pick Dtls  PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Prelim. Pick Dtls  PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Prelim. Pick Dtls  PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of PRT Prelim. Pick Dtls  PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Secondary Line Seq of PRT Prelim. Pick Dtls  PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Prelim. Pick Dtls  PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD3         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Detail Comment     PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Detail Comment     PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Detail Comment     PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of PRT Detail Comment     PO
     C           W0DP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Secondary Line Seq of PRT Detail Comment     PO
     C           W0DP03    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Detail Comment     PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Trf Cmts Pre Pick  PO
     C           W0EP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Trf Cmts Pre Pick  PO
     C           W0EP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Trf Cmts Pre Pick  PO
     C           W0EPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ECDT    IFEQ 'Y'
     C                     Z-ADD2         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Shipping Inst.     PO
     C           W0FP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Shipping Inst.     PO
     C           W0FP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Shipping Inst.     PO
     C           W0FP01    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Shipping Inst.     PO
     C           W0FPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0FCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Ship To Address    PO
     C           W0GP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Ship To Address    PO
     C           W0GP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Ship To Address    PO
     C           W0GPDT    IFEQ 'Y'
     C                     Z-ADD11        W0DTLN
     C           W0GCDT    IFEQ 'Y'
     C                     Z-ADD3         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Cust Comment PL   PO
     C           W0HP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Ship To Customer of Prt Cust Comment PL   PO
     C           W0HP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Comment Type of Prt Cust Comment PL   PO
     C           W0HP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Cust Comment PL   PO
     C           W0HPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0HCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Country Comment   PO
     C           W0IP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Country Code of Prt Country Comment   PO
     C           W0IP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Comment Type of Prt Country Comment   PO
     C           W0IP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Country Comment   PO
     C           W0IPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ICDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Load Summ Exp Inst PO
     C           W0JP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Load Summ Exp Inst PO
     C           W0JP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Load Summ Exp Inst PO
     C           W0JPDT    IFEQ 'Y'
     C                     Z-ADD5         W0DTLN
     C           W0JCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
     C                     Z-ADDP1AIC3    $BAIC3           Company Number
     C                     Z-ADDP1RMNB    $BRMNB           Load ID
     C                     Z-ADDP1AODT    $BAODT           Scheduled Ship
      * TOP.USR Desc. 10 = Condition name of PAR.USR Detail or Summary
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1210393   Y2LSNO  70       List number
     C                     PARM P3STST    W0INVL 25        USR Detail or S
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BNCNA    PARM           W0CNNM 25        USR Desc. 10
      *
     C                     MOVELP7R0SX    $BR0SX           Load U_M
      * WAS PRINT SUBMITTED FROM PROMPT SCREEN OR AT LOAD LOCK TIME
      * CASE: PAR.AUTO PRINT PRELIM PICK is AUTO PRINT NO
     C           P6CLST    IFEQ 'N'                        *IF
      * TOP.USR Blank 10 = Condition name of PAR.USR Select/Omit Flag
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1377659   Y2LSNO  70       List number
     C                     PARM P5CYST    W0INVL 25        USR Select/Omit
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BNHNA    PARM           W0CNNM 25        USR Blank 10
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,001   $BNHNA           USR Blank 10
     C                     END                             *FI
      * CASE:
      *  - c1ANDc2ANDc3ANDc4ANDc5ANDc6ANDc7ANDc8ANDc9ANDc10
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code Blank
      *   |- c10   : PAR.USR CDE Parm 9 is Warehouse Code Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5CPCD    IFEQ *BLANK                     *IF
     C           P5VSCD    IFEQ *BLANK                     *IF
     C           P5VTCD    IFEQ *BLANK                     *IF
     C           P5VUCD    IFEQ *BLANK                     *IF
     C           P5VVCD    IFEQ *BLANK                     *IF
     C           P5VWCD    IFEQ *BLANK                     *IF
     C           P5VXCD    IFEQ *BLANK                     *IF
     C           P5VYCD    IFEQ *BLANK                     *IF
     C           P5VZCD    IFEQ *BLANK                     *IF
     C           P5V0CD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'ALL'     $BCPCD           USR Warehouse C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP5CPCD    $BCPCD           USR Warehouse C
     C                     MOVELP5VSCD    $BVSCD           USR CDE Parm 1
     C                     MOVELP5VTCD    $BVTCD           USR CDE Parm 2
     C                     MOVELP5VUCD    $BVUCD           USR CDE Parm 3
     C                     MOVELP5VVCD    $BVVCD           USR CDE Parm 4
     C                     MOVELP5VWCD    $BVWCD           USR CDE Parm 5
     C                     MOVELP5VXCD    $BVXCD           USR CDE Parm 6
     C                     MOVELP5VYCD    $BVYCD           USR CDE Parm 7
     C                     MOVELP5VZCD    $BVZCD           USR CDE Parm 8
     C                     MOVELP5V0CD    $BV0CD           USR CDE Parm 9
     C                     END                             *FI
      * CASE: TOP.Company Number is greater than zero
     C           $BAIC3    IFGT *ZERO                      *IF
     C                     MOVEL*BLANK    $BSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SCRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BSQTX           Company Name DR
     C                     MOVEL'*ALL'    $BSQTX           Company Name DR
     C                     END                             *FI
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $BAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBAODT
     C                     MOVEL'0'       *IN79
     C           WUB5SX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$BAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BSQTX           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $BSQTX           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Prelim Pick fldADysRT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    BEAIC3           Company Number
     C                     Z-ADDFLC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEBKC7    WUBKC7           Ship To Custome
     C                     MOVELBEBRTX    $GLKNA           Ship To Name
     C                     MOVELBEHNNA    $GLMNA           Ship To City
     C                     MOVELBEDBCD    $GLNNA           Ship To State C
     C                     MOVELBEGWST    WN0007           Header Status
     C                     Z-ADDBEA1WG    WUA1WG           Order Weight To
     C                     Z-ADDBEEIDT    $GEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $GAFTM           Requested Deliv
     C                     Z-ADDBER1NB    WUR1NB           Rated Freight
     C                     MOVELBEQ2CD    WUQ2CD           Shipping Method
     C                     MOVELBEU2ST    WN0010           Export Status
     C                     MOVELBEVEST    $GVEST           Palletize
     C                     MOVELBEVFST    $GVFST           Shrink Wrap
     C                     MOVELBEVGST    $GVGST           Slip Sheet
     C                     MOVELBER4CD    $GR4CD           Sales Route Cod
     C                     MOVELBEBDST    WN0011           Order Certifica
     C                     MOVELBEFNSX    WN0012           Transfer in Sto
     C                     MOVELBEFQSX    WN0013           Export Docs Go
     C                     MOVELBEFTSX    WN0014           Air Freight Ord
     C                     Z-ADDBEBPTM    WN0015           Maximum Gross W
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Prelim Pick fields RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WARMNB           Load ID
      * Setup key
     C                     Z-ADD$GRMNB    WARMNB           Load ID
      * Establish starting position
     C           KRSSE     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $GAODT           Scheduled Ship
     C                     MOVEL*BLANK    $GPKST           Load Status
     C                     Z-ADD*ZERO     $GRNNB           Reefer Temperat
     C                     MOVEL*BLANK    $GMUTX           Trailer Id
     C                     MOVEL*BLANK    $GBZNA           Carrier Code
     C                     MOVEL*BLANK    $GRONB           Truck Size
     C                     MOVEL*BLANK    $GVDST           Load Type
     C                     Z-ADD*ZERO     $GT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WUPRTM           Product Tempera
     C                     MOVEL*BLANK    $GJ8TX           Car_Veh_Initial
     C                     Z-ADD*ZERO     WUTLMI           Total Load Mile
     C                     MOVEL*BLANK    $GQ2CD           Shipping Method
     C                     MOVEL*BLANK    $GXACD           Shipping Line
     C                     Z-ADD*ZERO     WN0005           Deadline Depart
     C                     Z-ADD*ZERO     WN0006           Deadline Depart
     C                     MOVEL*BLANK    $GFRSX           Shipping Temp C
     C                     Z-ADD*ZERO     $GCMTM           LPT Load Plan S
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAAODT    $GAODT           Scheduled Ship
     C                     MOVELWAPKST    $GPKST           Load Status
     C                     Z-ADDWARNNB    $GRNNB           Reefer Temperat
     C                     MOVELWADXTX    $GMUTX           Trailer Id
     C                     MOVELWABZNA    $GBZNA           Carrier Code
     C                     MOVELWARONB    $GRONB           Truck Size
     C                     MOVELWAVDST    $GVDST           Load Type
     C                     Z-ADDWAT4NB    $GT4NB           Schedule Sequen
     C                     Z-ADDWAPRTM    WUPRTM           Product Tempera
     C                     MOVELWAJ8TX    $GJ8TX           Car_Veh_Initial
     C                     Z-ADDWATLMI    WUTLMI           Total Load Mile
     C                     MOVELWAQ2CD    $GQ2CD           Shipping Method
     C                     MOVELWAXACD    $GXACD           Shipping Line
     C                     Z-ADDWAKZDT    WN0005           Deadline Depart
     C                     Z-ADDWAAXTM    WN0006           Deadline Depart
     C                     MOVELWAWRTX    $GFRSX           Shipping Temp C
     C                     Z-ADDWACMTM    $GCMTM           LPT Load Plan S
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WARMNB           Load ID
      * Setup key
     C                     Z-ADDWL0001    WARMNB           Load ID
      * Establish starting position
     C           KRSSF     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAPKST    WL0002           Load Status
     C                     Z-ADDWATLMI    WL0003           Total Load Mile
     C                     Z-ADDWAK2DT    WL0004           Override Total
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Prelim. Pick data  RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSG01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSG02           Order Number
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
      * Setup key
     C                     Z-ADD$GAIC3    WQSG01           Company Number
     C                     Z-ADD$GC4NB    WQSG02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSG     SETLL@BGWKL1                    *
     C           KRSSG     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $GHGCD           Item Code
     C                     MOVEL*BLANK    $GAJCD           Warehouse Code
     C                     MOVEL*BLANK    $GAGCD           U_M_Ordered
     C                     Z-ADD*ZERO     WUCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WUAUWG           Weight Schedule
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDOMHGCD    $GHGCD           Item Code
     C                     MOVELOMAJCD    $GAJCD           Warehouse Code
     C                     MOVELOMAGCD    $GAGCD           U_M_Ordered
     C                     Z-ADDOMCCQT    WUCCQT           Quantity Schedu
     C                     Z-ADDOMAUWG    WUAUWG           Weight Schedule
     C           KRSSG     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Combo for P & T    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/11/04 SLM PKTR01 Multi-Company Order Header TFG
      *                     Remove Co from Parms
     C                     MOVEL*BLANK    WL0008           U_M_Ordered
      * RMC added 6-30-21
     C                     MOVEL*BLANK    WL0009           Palletize
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSH01           Load ID
     C           *LIKE     DEFN WBC4NB    WQSH02           Order Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Load ID
     C                     KFLD           WQSH02           Order Number
      * Setup key
     C                     Z-ADDWL0006    WQSH01           Load ID
     C                     Z-ADDWL0005    WQSH02           Order Number
      * Establish starting position
     C           KRSSH     SETLL@BFCPR0                    *
     C           KRSSH     READE@BFCPR0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     GOTO SHEXIT                     *QUIT
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RMC change par.palletize to BOTH .. was output - 6/30/21
      * CASE: PAR.U/M - Ordered is Mixed
     C           WL0008    IFEQ 'MX'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWBVEST    WL0007           Palletize
      * RTV Combo for P & T    RT - Order Detail  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
      * RMC after 6-30-21   check par.palletize
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Palletize is no
      *   |- c2    : PAR.U/M - Ordered is Combos
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0007    IFEQ 'N'                        *IF
     C           WL0008    IFEQ 'CB'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WL0009           Palletize
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Pallet Flag/Combo  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0010           Company Number
     C                     Z-ADDWBC4NB    WL0011           Order Number
     C                     Z-ADD1         WL0012           Order Sequence
     C                     Z-ADD1         WL0013           Order Secondary
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WL0009    P      Palletize
     C                     END                             *FI
     C           KRSSH     READE@BFCPR0                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Combo for P & T    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSI01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSI02           Order Number
      * Define keylist
     C           KPSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WQSI01           Company Number
     C                     Z-ADDWBC4NB    WQSI02           Order Number
     C                     Z-ADD1         OMDPNB           Order Sequence
     C                     Z-ADD1         OMUENB           Order Secondary
      * Establish starting position
     C           KPSSI     SETLL@BGWKL1                    *
     C           KRSSI     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0008           U_M_Ordered
     C                     GOTO SIEXIT                     *QUIT
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.U/M - Ordered is Not Entered
     C           WL0008    IFEQ *BLANK                     *IF
     C                     MOVELOMAGCD    WL0008           U_M_Ordered
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.U/M - Ordered EQ PAR.U/M - Ordered
     C           OMAGCD    IFEQ WL0008                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      WL0008           U_M_Ordered
     C                     GOTO SIEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSI     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Pallet Flag/Combo  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WL0014           Palletize
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSJ02           Order Number
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
      * Setup key
     C                     Z-ADDWL0010    WQSJ01           Company Number
     C                     Z-ADDWL0011    WQSJ02           Order Number
     C                     Z-ADDWL0012    OMDPNB           Order Sequence
     C                     Z-ADDWL0013    OMUENB           Order Secondary
      * Establish starting position
     C           KPSSJ     SETLL@BGWKL1                    *
     C           KRSSJ     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RMC added not Cancelled check 6-30-21
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.U/M - Ordered is Combos
      *   |- c2    : DB1.Palletize is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           OMAGCD    IFEQ 'CB'                       *IF
     C           OMVEST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELOMVEST    WL0014           Palletize
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSJ     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Shipping Line-OHE  RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AMRMNB    WQSK01           Load ID
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Load ID
      * Setup key
     C                     Z-ADD$GRMNB    WQSK01           Load ID
      * Establish starting position
     C           KRSSK     SETLL@AMREJM                    *
     C           KRSSK     READE@AMREJM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $GXACD           Shipping Line
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** pass back the first record found with a shipping line
      * CASE: DB1.Shipping Line is not entered
     C           AMXACD    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELAMXACD    $GXACD           Shipping Line
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSK     READE@AMREJM                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Tare Weight        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD$HAIC3    BZAIC3           Company Number
     C                     Z-ADD$HHGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSL     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    $HL3NA           Description Lin
     C                     Z-ADDBZA3WG    WUA3WG           Misc Tare Weigh
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Item Box Tare Wgt  RT - Item Bill Of Material  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0020  3        Item Type Code
     C                     MOVEL*BLANK    WN0021  1        Package Type Co
     C                     Z-ADD*ZERO     WN0022 112       Unit Weight USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
      * Declare restrictor key work fields
     C           *LIKE     DEFN IOAIC3    WQSM01           Company Number
     C           *LIKE     DEFN IOHGCD    WQSM02           Item Code
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Item Code
      * Setup key
     C                     Z-ADD$HAIC3    WQSM01           Company Number
     C                     Z-ADD$HHGCD    WQSM02           Item Code
      * Establish starting position
     C           KRSSM     SETLL@IORETI                    *
     C           KRSSM     READE@IORETI                  90*
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
      * RTV Type/Pack/Unit Wgt RT - Company Item  * 
     C                     EXSR SNRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Item Type Code is Packaging and Supplies
      *   |- c2    : PAR.Package Type Code is Box
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0020    IFEQ 'PS'                       *IF
     C           WN0021    IFEQ 'B'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     GOTO SMEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
     C                     END                             *FI
     C           KRSSM     READE@IORETI                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     Z-ADDWN0022    WUAIWG           Unit Weight
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Type/Pack/Unit Wgt RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDIOAIC3    BZAIC3           Company Number
     C                     Z-ADDIOC9NB    BZHGCD           Item Code
      * Establish starting position
     C           KRSSN     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZAIWG    WUAIWG           Unit Weight
     C                     MOVELBZN0CD    WN0020           Item Type Code
     C                     MOVELBZX4ST    WN0021           Package Type Co
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Req Dlv Dt/Time   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDC4NB    WQSO01           Order Number
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Order Number
      * Setup key
     C                     Z-ADD$HC4NB    WQSO01           Order Number
      * Establish starting position
     C           KRSSO     SETLL@BFCPY2                    *
     C           KRSSO     READE@BFCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $HAIC3           Company Number
     C                     Z-ADD*ZERO     YL0010           Requested Deliv
     C                     Z-ADD*ZERO     YL0011           Requested Deliv
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDAIC3    $HAIC3           Company Number
     C                     Z-ADDWDEIDT    YL0010           Requested Deliv
     C                     Z-ADDWDAFTM    YL0011           Requested Deliv
     C           KRSSO     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Pallet Desc       RT - Pallet Master  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           B6LWSC           PM Pallet Type
      * Setup key
     C                     MOVELWL0015    B6LWSC           PM Pallet Type
      * Establish starting position
     C           KRSSP     CHAIN@B6CPH3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR5203' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0016           PM Description
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELB6QJU1    WL0016           PM Description
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Customer Telephone RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDBEBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSQ     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBBVTX    $PCDTX           Telephone Numbe
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Country Code       RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDBEBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSR     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBKXCD    WUKXCD           Country Code
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Description        RT - PD Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL$PR4CD    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSS     CHAIN@JEREWF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $PMZNA           Sales Route Des
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEMZNA    $PMZNA           Sales Route Des
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Desc, Status       RT - Country  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           E5KXCD           Country Code
      * Setup key
     C                     MOVELWUKXCD    E5KXCD           Country Code
      * Establish starting position
     C           KRSST     CHAIN@E5REB8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1158' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUDATX           Country Descrip
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELE5DATX    WUDATX           Country Descrip
     C                     MOVELE5VSST    WUVSST           Record Status
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Record count      RT - Customer Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBKC7    WQSU01           Ship To Custome
     C           *LIKE     DEFN WEI1SX    WQSU02           Comment Type
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Ship To Custome
     C                     KFLD           WQSU02           Comment Type
      * Setup key
     C                     Z-ADD$PBKC7    WQSU01           Ship To Custome
     C                     MOVEL'PI'      WQSU02           Comment Type
      * Establish starting position
     C           KRSSU     SETLL@AVCPG5                    *
     C           KRSSU     READE@AVCPG5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2993' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD0         YL0017           USR Count
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         YL0017           USR Count
     C           KRSSU     READE@AVCPG5                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Country Code only  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSV01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSV02           Order Number
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Company Number
     C                     KFLD           WQSV02           Order Number
      * Setup key
     C                     Z-ADD$PAIC3    WQSV01           Company Number
     C                     Z-ADD$PC4NB    WQSV02           Order Number
      * Establish starting position
     C           KRSSV     SETLL@BGWKAE                    *
     C           KRSSV     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0021           Country Code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WCGMST    IFEQ 'L'                        *IF
     C           WCGMST    OREQ 'A'
     C           WCGMST    OREQ 'C'
     C           WCGMST    OREQ 'R'
     C           WCGMST    OREQ 'E'
     C           WCGMST    OREQ 'H'
     C           WCGMST    OREQ 'I'
      * PAR = DB1 By name
     C                     MOVELWCKXCD    YL0021           Country Code
     C                     GOTO SVEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSV     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Warehouse code     RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSW01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSW02           Order Number
      * Define keylist
     C           KPSSW     KLIST
     C                     KFLD           WQSW01           Company Number
     C                     KFLD           WQSW02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Company Number
     C                     KFLD           WQSW02           Order Number
      * Setup key
     C                     Z-ADDWL0017    WQSW01           Company Number
     C                     Z-ADDWL0018    WQSW02           Order Number
     C                     Z-ADDWL0019    OMDPNB           Order Sequence
     C                     Z-ADDWL0020    OMUENB           Order Secondary
      * Establish starting position
     C           KPSSW     SETLL@BGWKL1                    *
     C           KRSSW     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0021           Warehouse Code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELOMAJCD    WL0021           Warehouse Code
     C                     GOTO SWEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSW     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Check for Whse     RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSX01           Company Number
     C           *LIKE     DEFN WFAJCD    WQSX02           Warehouse Code
     C           *LIKE     DEFN WFC4NB    WQSX03           Order Number
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Warehouse Code
     C                     KFLD           WQSX03           Order Number
      * Setup key
     C                     Z-ADDWL0022    WQSX01           Company Number
     C                     MOVELWL0024    WQSX02           Warehouse Code
     C                     Z-ADDWL0023    WQSX03           Order Number
      * Establish starting position
     C           KRSSX     SETLL@BGWKKM                    *
     C           KRSSX     READE@BGWKKM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WFGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SXEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSX     READE@BGWKKM                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * VAL Valid  Prelim Pick RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSY02           Load ID
     C           *LIKE     DEFN WGC4NB    WQSY03           Order Number
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY02           Load ID
     C                     KFLD           WQSY03           Order Number
      * Setup key
     C                     Z-ADDFLRMNB    WQSY02           Load ID
     C                     Z-ADDFLC4NB    WQSY03           Order Number
      * Establish starting position
     C           KRSSY     SETLL@BFCPNJ                    *
     C           KRSSY     READE@BFCPNJ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     GOTO SYEXIT                     *QUIT
     C           KRSSY     READE@BFCPNJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL$TXACD    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSZ     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $TJNNA           Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    $TJNNA           Name
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Prelim Pick Orders RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQTA02           Load ID
      * Define keylist
     C           KPSTA     KLIST
     C                     KFLD           WQTA02           Load ID
     C                     KFLD           WGC4NB           Order Number
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA02           Load ID
      * Setup key
     C                     Z-ADDWL0025    WQTA02           Load ID
     C                     Z-ADDWL0026    WGC4NB           Order Number
      * Establish starting position
     C           KPSTA     SETLL@BFCPNJ                    *
     C           KRSTA     READE@BFCPNJ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDWGC4NB    WL0026           Order Number
     C                     GOTO TAEXIT                     *QUIT
     C           KRSTA     READE@BFCPNJ                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * VAL Prelim List Dtls   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQTB02           Load ID
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB02           Load ID
      * Setup key
     C                     Z-ADDWL0027    WQTB02           Load ID
      * Establish starting position
     C           KRSTB     SETLL@FLCPE8                    *
     C           KRSTB     READE@FLCPE8                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Validate warehouse selections
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * RTV Warehouse code     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0017           Company Number
     C                     Z-ADDFLC4NB    WL0018           Order Number
     C                     Z-ADD*ZERO     WL0019           Order Sequence
     C                     Z-ADD*ZERO     WL0020           Order Secondary
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0021    WUAJCD    P      Warehouse Code
      * Select passed warehouses
      * CASE: PAR.USR Select/Omit Flag is Select
     C           WL0038    IFEQ 'S'                        *IF
      * Select only Order Detail records matching warehouse codes passed
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WL0028    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELWL0028    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     GOTO TBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 1 is Warehouse Code not Blank
     C           WL0029    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELWL0029    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     GOTO TBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 2 is Warehouse Code not Blank
     C           WL0030    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELWL0030    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     GOTO TBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 3 is Warehouse Code not Blank
     C           WL0031    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELWL0031    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     GOTO TBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 4 is Warehouse Code not Blank
     C           WL0032    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELWL0032    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     GOTO TBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 5 is Warehouse Code not Blank
     C           WL0033    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELWL0033    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     GOTO TBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 6 is Warehouse Code not Blank
     C           WL0034    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELWL0034    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     GOTO TBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 7 is Warehouse Code not Blank
     C           WL0035    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELWL0035    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     GOTO TBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 8 is Warehouse Code not Blank
     C           WL0036    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELWL0036    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     GOTO TBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.USR CDE Parm 9 is Warehouse Code not Blank
     C           WL0037    IFNE *BLANK                     *IF
      * RTV Check for Whse     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0022           Company Number
     C                     Z-ADDFLC4NB    WL0023           Order Number
     C                     MOVELWL0037    WL0024    P      Warehouse Code
     C                     EXSR SXRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     GOTO TBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Omit passed warehouses
      * CASE: PAR.USR Select/Omit Flag is Omit
     C           WL0038    IFEQ 'O'                        *IF
      * Omit any Order Detail records matching warehouse codes passed in
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code not Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code not Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code not Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code not Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code not Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code not Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code not Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code not Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code not Blank
      *   |- c10   : PAR.USR CDE Parm 9 is Warehouse Code not Blank
      *   '-
     C           WL0028    IFNE *BLANK                     *IF
     C           WL0029    ORNE *BLANK                     *OR
     C           WL0030    ORNE *BLANK                     *OR
     C           WL0031    ORNE *BLANK                     *OR
     C           WL0032    ORNE *BLANK                     *OR
     C           WL0033    ORNE *BLANK                     *OR
     C           WL0034    ORNE *BLANK                     *OR
     C           WL0035    ORNE *BLANK                     *OR
     C           WL0036    ORNE *BLANK                     *OR
     C           WL0037    ORNE *BLANK                     *OR
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10
      *   |- c1    : PAR.USR Warehouse Code EQ WRK.Warehouse Code
      *   |- c2    : PAR.USR CDE Parm 1 EQ WRK.Warehouse Code
      *   |- c3    : PAR.USR CDE Parm 2 EQ WRK.Warehouse Code
      *   |- c4    : PAR.USR CDE Parm 3 EQ WRK.Warehouse Code
      *   |- c5    : PAR.USR CDE Parm 4 EQ WRK.Warehouse Code
      *   |- c6    : PAR.USR CDE Parm 5 EQ WRK.Warehouse Code
      *   |- c7    : PAR.USR CDE Parm 6 EQ WRK.Warehouse Code
      *   |- c8    : PAR.USR CDE Parm 7 EQ WRK.Warehouse Code
      *   |- c9    : PAR.USR CDE Parm 8 EQ WRK.Warehouse Code
      *   |- c10   : PAR.USR CDE Parm 9 EQ WRK.Warehouse Code
      *   '-
     C           WL0028    IFEQ WUAJCD                     *IF
     C           WL0029    OREQ WUAJCD                     *OR
     C           WL0030    OREQ WUAJCD                     *OR
     C           WL0031    OREQ WUAJCD                     *OR
     C           WL0032    OREQ WUAJCD                     *OR
     C           WL0033    OREQ WUAJCD                     *OR
     C           WL0034    OREQ WUAJCD                     *OR
     C           WL0035    OREQ WUAJCD                     *OR
     C           WL0036    OREQ WUAJCD                     *OR
     C           WL0037    OREQ WUAJCD                     *OR
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTB     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Prelim List Dtls   PO
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Order Number
     C                     Z-ADD*ZERO     WN0002  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0003  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0004  1        Load Type
     C                     Z-ADD*ZERO     WN0005  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0006  60       Deadline Depart
     C                     MOVEL*BLANK    WN0007  1        Header Status
     C                     Z-ADD*ZERO     WN0008  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0009  40       Requested Deliv
     C                     MOVEL*BLANK    WN0010  1        Export Status
     C                     MOVEL*BLANK    WN0011  1        Order Certifica
     C                     MOVEL*BLANK    WN0012  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0013  1        Export Docs Go
     C                     MOVEL*BLANK    WN0014  1        Air Freight Ord
     C                     Z-ADD*ZERO     WN0015  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0016 112       USR Weight Accu
     C                     Z-ADD*ZERO     WN0017 112       Tare Weight Tot
     C                     MOVEL*BLANK    WN0018  1        USR Display 2
      *
      * PRT Prelim List Dtls   PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Prelim. Pick Dtls  PO
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0019 112       @Weight
      *
      * PRT Prelim. Pick Dtls  PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Added for OMS349
      *================================================================
      * Calculating the Oldest Label Date.
      * CASE: PAR.Load Type is *Not Bulk
     C           $GVDST    IFEQ *BLANK                     *IF
     C           $GVDST    OREQ 'R'
      * CLC Oldest Label Dt    IF
      * This internal function will return the 'Oldest Label Date' to it'
      * calling function based on the input 'Age Code' and 'Scheduled Shi
      * Date'.
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      * CASE: PAR.Age Code is A: 0 Day
     C           $HRPCD    IFEQ 'A'                        *IF
     C                     Z-ADD$HAODT    $HMUDT           Date - ATR
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is B: 1 Day
     C           $HRPCD    IFEQ 'B'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-1 *DAYS
     C           $HAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     $HMUDT
     C                     ELSE
     C           XDINDT    SUB  1000000   $HMUDT
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is C: 2 Day
     C           $HRPCD    IFEQ 'C'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-2 *DAYS
     C           $HAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     $HMUDT
     C                     ELSE
     C           XDINDT    SUB  1000000   $HMUDT
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is D: 3 Day
     C           $HRPCD    IFEQ 'D'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-3 *DAYS
     C           $HAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     $HMUDT
     C                     ELSE
     C           XDINDT    SUB  1000000   $HMUDT
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is E: 4 Day
     C           $HRPCD    IFEQ 'E'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-4 *DAYS
     C           $HAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     $HMUDT
     C                     ELSE
     C           XDINDT    SUB  1000000   $HMUDT
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is F: 5 Day
     C           $HRPCD    IFEQ 'F'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-5 *DAYS
     C           $HAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     $HMUDT
     C                     ELSE
     C           XDINDT    SUB  1000000   $HMUDT
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is G: 6 Day
     C           $HRPCD    IFEQ 'G'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-6 *DAYS
     C           $HAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     $HMUDT
     C                     ELSE
     C           XDINDT    SUB  1000000   $HMUDT
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           $HRPCD    IFEQ 'H'                        *IF
     C           $HRPCD    OREQ 'I'                        *OR
      * RMC 9/12/06 PFS019 90 days chgd to 120 days
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-7 *DAYS
     C           $HAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-7        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     $HMUDT
     C                     ELSE
     C           XDINDT    SUB  1000000   $HMUDT
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Detail Comment     PO
      *================================================================
      * PRT Detail Comment     PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Trf Cmts Pre Pick  PO
      *================================================================
      * PRT Trf Cmts Pre Pick  PO: Mainline
     C                     EXSR E0MAIN
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Shipping Inst.     PO
      *================================================================
      * PRT Shipping Inst.     PO: Mainline
     C                     EXSR F0MAIN
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Ship To Address    PO
      *================================================================
      * PRT Ship To Address    PO: Mainline
     C                     EXSR G0MAIN
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Cust Comment PL   PO
      *================================================================
      * Prt Cust Comment PL   PO: Mainline
     C                     EXSR H0MAIN
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Country Comment   PO
      *================================================================
      * RTV Country Code only  RT - Order Detail  * 
     C                     EXSR SVRVGN
      * Prt Country Comment   PO: Mainline
     C                     EXSR I0MAIN
      *================================================================
     CSR         UIEXIT    ENDSR
     C           UJ1UF     BEGSR
      *============================================================
      * UJ1UF - COMPRESS NAME/ADDRESS/COUNTRY INFORMATION
      *============================================================
      *
     C           *LIKE     DEFN WUADTX    UUADTX
     C           *LIKE     DEFN WUACNA    UUACNA
     C           *LIKE     DEFN WUADNA    UUADNA
     C           *LIKE     DEFN WUAENA    UUAENA
     C           *LIKE     DEFN WUAJNA    UUAJNA
     C           *LIKE     DEFN WUEINA    UUEINA
     C           *LIKE     DEFN WUBTTX    UUBTTX- 1
     C           *LIKE     DEFN WUDATX    UUDATX
      * FILL OUTPUT ARRAY
     C                     MOVE *BLANK    UAD
     C                     Z-ADD1         UX      20
     C                     MOVELUUADTX    UAD,UX
     C                     ADD  1         UX
     C           UUACNA    IFNE *BLANK
     C                     MOVELUUACNA    UAD,UX
     C                     ADD  1         UX
     C                     END
     C           UUADNA    IFNE *BLANK
     C                     MOVELUUADNA    UAD,UX
     C                     ADD  1         UX
     C                     END
     C           UUAENA    IFNE *BLANK
     C                     MOVELUUAENA    UAD,UX
     C                     ADD  1         UX
     C                     END
     C                     MOVE *BLANK    UUCSTZ 34
     C                     MOVELUUAJNA    UUCST  23
     C                     MOVE UUEINA    UUCST
     C                     MOVELUUCST     UUCSTZ
     C                     MOVE UUBTTX    UUCSTZ
     C                     MOVELUUCSTZ    UAD,UX
     C           UUDATX    IFNE *BLANK
     C                     ADD  1         UX
     C                     MOVELUUDATX    UAD,UX
     C                     END
     C                     ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Load Summ Exp Inst PO
      *================================================================
      * CASE: PAR.Export Status is Not Yes
     C           WN0010    IFEQ *BLANK                     *IF
     C           WN0010    OREQ 'N'
     C                     GOTO UJEXIT                     *QUIT
     C                     END                             *FI
      * PRT Load Summ Exp Inst PO: Mainline
     C                     EXSR J0MAIN
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * PRT Prelim List Dtls   PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL'Y'       WUTMST           USR First Time
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZCINIT    BEGSR
      *================================================================
      * PRT Prelim. Pick Dtls  PO: Initialise
      *================================================================
      * USER: Initialize program
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GAIC3    WQ0001  30       Company Number
     C           WUYISX    PARM *BLANK    WQ0002  1        Plant Company S
     C           WUYJSX    PARM *BLANK    WQ0003  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WUJDST           USR Check Y/N S
     C                     Z-ADD*ZERO     WN0016           USR Weight Accu
     C                     Z-ADD*ZERO     WN0017           Tare Weight Tot
     C                     MOVEL'N'       YL0001           Palletize
     C                     MOVEL'N'       YL0002           Slip Sheet
      * *****
      * E2684 RMC 7/17/13
      * Cond Shrink Wrap comment on lcl.shrink wrap instead of par.shrink
      * & print shrink wrap if any palleted boxes are on the order
     C                     MOVEL$GVFST    YL0003           Shrink Wrap
     C                     MOVEL*BLANK    YL0004           U_M_Ordered
      * ** W107505
     C                     MOVEL*BLANK    YL0005           Pallet Type 1
     C                     MOVEL*BLANK    YL0006           Pallet Type 2
     C                     MOVEL*BLANK    YL0007           Pallet Type 3
     C                     MOVEL*BLANK    YL0008           Pallet Type 4
     C                     MOVEL*BLANK    YL0009           Pallet Type/Qty
     C                     MOVEL'blanks'  YL0009           Pallet Type/Qty
      *================================================================
     CSR         ZCEXIT    ENDSR
      /EJECT
     CSR         ZHINIT    BEGSR
      *================================================================
      * Prt Cust Comment PL   PO: Initialise
      *================================================================
      * USER: Initialize program
      * Rtv Record count      RT - Customer Comment  * 
     C                     EXSR SURVGN
     C                     MOVEL'Y'       YL0018           First time flag
     C                     Z-ADD69        YL0019           Page Length
     C                     MOVEL'Y'       WUTMST           USR First Time
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZIINIT    BEGSR
      *================================================================
      * Prt Country Comment   PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL'Y'       YL0022           First time flag
     C                     Z-ADD69        YL0023           Page Length
     C                     MOVEL'Y'       WUTMST           USR First Time
      *================================================================
     CSR         ZIEXIT    ENDSR
      /EJECT
     CSR         ZJINIT    BEGSR
      *================================================================
      * PRT Load Summ Exp Inst PO: Initialise
      *================================================================
      * USER: Initialize program
      *================================================================
     CSR         ZJEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2C4NB           Order Number
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4GJST           Order in Use
     C                     MOVEL*BLANK    P4GWST           Header Status
     C                     MOVEL*BLANK    P4GYST           Order Type Prin
     C                     MOVEL*BLANK    P4U5ST           Print Pick Slip
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Define work field Print Yes/No          USR
     C                     MOVEL*BLANK    WUB5SX  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    FJAIC3           Company Number
     C                     MOVEL*LOVAL    FJKZDT           Deadline Depart
     C                     MOVEL*LOVAL    FJAXTM           Deadline Depart
     C                     MOVEL*LOVAL    FJRMNB           Load ID
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field Palletize
     C                     MOVEL*BLANK    WUVEST  1
      * Define work field Shrink Wrap
     C                     MOVEL*BLANK    WUVFST  1
      * Define work field Slip Sheet
     C                     MOVEL*BLANK    WUVGST  1
      * Define work field USR First Time
     C                     MOVEL*BLANK    WUTMST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    FLRMNB           Load ID
     C                     MOVEL*HIVAL    FLRVNB           Stop_Drop
     C                     MOVEL*LOVAL    FLC4NB           Order Number
      * Define work field USR Status (Y/N)
     C                     MOVEL*BLANK    WUE6ST  1
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Order Weight Total
     C                     Z-ADD*ZERO     WUA1WG 112
      * Define work field Rated Freight
     C                     Z-ADD*ZERO     WUR1NB 112
      * Define work field Shipping Method
     C                     MOVEL*BLANK    WUQ2CD  2
      * Define work field Product Temperature
     C                     Z-ADD*ZERO     WUPRTM  52
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WARPNB           Total Load Orde
     C                     Z-ADD*ZERO     WAFLAM           Flat Amount
     C                     Z-ADD*ZERO     WARRNB           Total Stops
     C                     Z-ADD*ZERO     WASBNB           BOL Time
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WASDNB           Number Pallets
     C                     Z-ADD*ZERO     WAPAOU           Number Pallets
     C                     Z-ADD*ZERO     WADGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAHADT           Actual Arrival
     C                     Z-ADD*ZERO     WAAART           Actual Arrival
     C                     Z-ADD*ZERO     WADHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WADIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WAAQDT           Actual Departur
     C                     Z-ADD*ZERO     WAS6NB           Departure Time
     C                     Z-ADD*ZERO     WAT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WAPRTM           Product Tempera
     C                     Z-ADD*ZERO     WANPSV           Number Spacers
     C                     Z-ADD*ZERO     WATLMI           Total Load Mile
     C                     Z-ADD*ZERO     WAGRWE           Gross Weight
     C                     Z-ADD*ZERO     WAF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WAJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WATRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WAJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WASPTM           Spotted Time
     C                     Z-ADD*ZERO     WAJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WALFTM           Load Finished T
     C                     Z-ADD*ZERO     WAJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WABOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WAJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WABLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WAKIDT           Truck Departure
     C                     Z-ADD*ZERO     WAASTM           Truck Departure
     C                     Z-ADD*ZERO     WAKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WAAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WAVOAG           Voyage
     C                     Z-ADD*ZERO     WAKBDT           Sail Date
     C                     Z-ADD*ZERO     WAEFDT           Arrival Date
     C                     Z-ADD*ZERO     WAKCDT           Date In
     C                     Z-ADD*ZERO     WATMIN           Time In
     C                     Z-ADD*ZERO     WAKDDT           Date Out
     C                     Z-ADD*ZERO     WAVMNB           Time Out
     C                     Z-ADD*ZERO     WAOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WABRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WALLDT           Express Mail Da
     C                     Z-ADD*ZERO     WAK0DT           Product Complet
     C                     Z-ADD*ZERO     WAAYTM           Product Complet
     C                     Z-ADD*ZERO     WAKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WAICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WAIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WAK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WAAZTM           Load Door 1
     C                     Z-ADD*ZERO     WAK2DT           Override Total
     C                     Z-ADD*ZERO     WAA0TM           Load Door 2
     C                     Z-ADD*ZERO     WAZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WAPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WACKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WAPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WACLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WAP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WACMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WAP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WACNTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WACOTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WACQTM           LH Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Define work field Quantity Scheduled
     C                     Z-ADD*ZERO     WUCCQT 112
      * Define work field Weight Scheduled
     C                     Z-ADD*ZERO     WUAUWG 112
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field U_M_Ordered
     C                     MOVEL*BLANK    WUAGCD  2
      * Define work field Palletize             USR
     C                     MOVEL*BLANK    WUIHSX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           AR Customer Num
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A_R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field Status Unused 1
     C                     MOVEL*BLANK    WUXTST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WCDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WCDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WCDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WCDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WCGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Item Age Days
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WCTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WCTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Plant Company Sts
     C                     MOVEL*BLANK    WUYISX  1
      * Define work field Company Organization
     C                     MOVEL*BLANK    WUYJSX  1
      * Define work field USR Check Y/N Status
     C                     MOVEL*BLANK    WUJDST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WCAIC3           Company Number
     C                     MOVEL*LOVAL    WCC4NB           Order Number
     C                     MOVEL*LOVAL    WCDPNB           Order Sequence
     C                     MOVEL*LOVAL    WCUENB           Order Secondary
      * Define work field Misc Tare Weight
     C                     Z-ADD*ZERO     WUA3WG  52
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Tare Weight Total
     C                     Z-ADD*ZERO     WUA4WG 112
      * Define work field Print (Yes/No) USR
     C                     MOVEL*BLANK    WUDTSX  1
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field Error Flag            USR
     C                     MOVEL*BLANK    WUB8SX  1
      * Define work field Error Reason Descript 1
     C                     MOVEL*BLANK    WUKWTX 30
      * Define work field Error Reason Descript 2
     C                     MOVEL*BLANK    WUKXTX 30
      * Define work field Error Reason Descript 3
     C                     MOVEL*BLANK    WUKYTX 30
      * Define work field Error Reason Descript 4
     C                     MOVEL*BLANK    WUKZTX 30
      * Define work field Error Reason Descript 5
     C                     MOVEL*BLANK    WUTITX 30
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Blank for 30          USR
     C                     MOVEL*BLANK    WUW4TX 30
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    CPAIC3           Company Number
     C                     MOVEL*LOVAL    CPC4NB           Order Number
     C                     MOVEL*LOVAL    CPDPNB           Order Sequence
     C                     MOVEL*LOVAL    CPUENB           Order Secondary
     C                     MOVEL*LOVAL    CPDXNB           Sequence Number
      * Define work field Text usr 14
     C                     MOVEL*BLANK    WUD7U1 14
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    KERMNB           Load ID
     C                     MOVEL*LOVAL    KEDXNB           Sequence Number
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    IEAIC3           Company Number
     C                     MOVEL*LOVAL    IEC4NB           Order Number
     C                     MOVEL*LOVAL    IEDXNB           Sequence Number
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BEAIC3           Company Number
     C                     MOVEL*LOVAL    BEC4NB           Order Number
      * Define work field Country Code
     C                     MOVEL*BLANK    WUKXCD  6
      * Define work field USR Flag 1
     C                     MOVEL*BLANK    WUD4ST  1
      * Define work field Country Description
     C                     MOVEL*BLANK    WUDATX 30
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Define work field Name
     C                     MOVEL*BLANK    WUADTX 30
      * Define work field Address Line 1
     C                     MOVEL*BLANK    WUACNA 30
      * Define work field Address Line 2
     C                     MOVEL*BLANK    WUADNA 30
      * Define work field Address Line 3
     C                     MOVEL*BLANK    WUAENA 30
      * Define work field City
     C                     MOVEL*BLANK    WUAJNA 20
      * Define work field State
     C                     MOVEL*BLANK    WUEINA  2
      * Define work field Zip Postal Code
     C                     MOVEL*BLANK    WUBTTX 11
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEM5NX           Comment Sequenc
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    AVBKC7           Ship To Custome
     C                     MOVEL*LOVAL    AVI1SX           Comment Type
     C                     MOVEL*LOVAL    AVM5NX           Comment Sequenc
      * Define work field USR Overflow
     C                     MOVEL*BLANK    WUDLST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    B1KXCD           Country Code
     C                     MOVEL*LOVAL    B1I1SX           Comment Type
     C                     MOVEL*LOVAL    B1M5NX           Comment Sequenc
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHRMNB           Load ID
     C                     Z-ADD*ZERO     WHRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WHQWDT           OHE Sail_Flight
     C                     Z-ADD*ZERO     WHQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WHQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WHGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WHGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WHGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WHGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WHHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WHHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WHHGVL           Transload Termi
     C                     Z-ADD*ZERO     WHQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WHQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WHQ1DT           OHE Port_Pier P
     C                     Z-ADD*ZERO     WHQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WHITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WHQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WHQKNY           LD Stop_Drop
     C                     Z-ADD*ZERO     WHQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WHP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WHP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WHQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WHQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WHQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WHQENY           Original Appoin
     C                     Z-ADD*ZERO     WHQFNY           Original Appoin
     C                     Z-ADD*ZERO     WHQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WHQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WHQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WHQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WHW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WHW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WHAIC3           Company Number
     C                     MOVEL*LOVAL    WHC4NB           Order Number
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002  1
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004  70
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007  1
     C                     MOVEL*BLANK    WL0008  2
     C                     MOVEL*BLANK    WL0009  1
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  70
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  30
     C                     MOVEL*BLANK    WL0014  1
      * Define local variables for subroutine SPRVGN.
     C                     MOVEL*BLANK    WL0015  2
     C                     MOVEL*BLANK    WL0016 15
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  30
     C                     Z-ADD*ZERO     WL0020  30
     C                     MOVEL*BLANK    WL0021  3
      * Define local variables for subroutine SXRVGN.
     C                     Z-ADD*ZERO     WL0022  30
     C                     Z-ADD*ZERO     WL0023  70
     C                     MOVEL*BLANK    WL0024  3
      * Define local variables for subroutine TARVGN.
     C                     Z-ADD*ZERO     WL0025  70
     C                     Z-ADD*ZERO     WL0026  70
      * Define local variables for subroutine TBRVGN.
     C                     Z-ADD*ZERO     WL0027  70
     C                     MOVEL*BLANK    WL0028  3
     C                     MOVEL*BLANK    WL0029  3
     C                     MOVEL*BLANK    WL0030  3
     C                     MOVEL*BLANK    WL0031  3
     C                     MOVEL*BLANK    WL0032  3
     C                     MOVEL*BLANK    WL0033  3
     C                     MOVEL*BLANK    WL0034  3
     C                     MOVEL*BLANK    WL0035  3
     C                     MOVEL*BLANK    WL0036  3
     C                     MOVEL*BLANK    WL0037  3
     C                     MOVEL*BLANK    WL0038  1
      * Define null work field Ship To Address Line 1
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field Load Status
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field Total Load Miles
     C                     Z-ADD*ZERO     YN0003  70
      * Define local work field Palletize
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Slip Sheet
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Shrink Wrap
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field U_M_Ordered
     C                     MOVEL*BLANK    YL0004  2
      * Define local work field Pallet Type 1
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field Pallet Type 2
     C                     MOVEL*BLANK    YL0006  2
      * Define local work field Pallet Type 3
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field Pallet Type 4
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field Pallet Type/Qty String
     C                     MOVEL*BLANK    YL0009 60
      * Define null work field Order Type_Sales
     C                     MOVEL*BLANK    YN0004  2
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field Requested Delivery Time
     C                     Z-ADD*ZERO     YL0011  40
      * Define local work field Pallet type 1 Desc
     C                     MOVEL*BLANK    YL0012  6
      * Define local work field Pallet type 2 Desc
     C                     MOVEL*BLANK    YL0013  6
      * Define local work field Pallet type 3 Desc
     C                     MOVEL*BLANK    YL0014  6
      * Define local work field Pallet type 4 Desc
     C                     MOVEL*BLANK    YL0015  6
      * Define local work field Text usr 14
     C                     MOVEL*BLANK    YL0016 14
      * Define local work field USR Count
     C                     Z-ADD*ZERO     YL0017  30
      * Define local work field First time flag 2     USR
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Page Length
     C                     Z-ADD*ZERO     YL0019  30
      * Define local work field USR Counter
     C                     Z-ADD*ZERO     YL0020  50
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0021  6
      * Define local work field First time flag 2     USR
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field Page Length
     C                     Z-ADD*ZERO     YL0023  30
      * Define local work field USR Counter
     C                     Z-ADD*ZERO     YL0024  50
      * Define local work field USR Count
     C                     Z-ADD*ZERO     YL0025  30
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0005  1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 AUTO PRINT
00002 **EXPORT**
00003 *** PALLETIZE
00004 *** FLOOR LOAD
00005 blanks
00006 Y2U0005
