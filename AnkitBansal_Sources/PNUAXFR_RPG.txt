     H/TITLE Cpy Cust Item Formula XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 09/09/10  Time  : 17:09:37
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPNF9REL1IF  E           K        DISK
      * RTV : IP Cust Item Formula Dtl  Retrieval index
      *
     FPNF8REL1IF  E           K        DISK
      * RTV : IP Cust Item Price Elem   Retrieval index
      *
     FPNF3REL1IF  E           K        DISK
      * RTV : IP Cust Item Pricing Dtl  Retrieval index
      *
     FPNF9REL0IF  E           K        DISK                      A
      * UPD : IP Cust Item Formula Dtl  Update index
      *
     FPNF8REL0IF  E           K        DISK                      A
      * UPD : IP Cust Item Price Elem   Update index
      *
     FPNF3REL0IF  E           K        DISK                      A
      * UPD : IP Cust Item Pricing Dtl  Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@F9REF3
      * IP Cust Item Formula Dtl  Retrieval index
      * Renamed input format fields
     I              F9BKC7                          WABKC7
     I              F9HGCD                          WAHGCD
     I              F9RRNY                          WARRNY
     I              F9IUST                          WAIUST
     I              F9WNT1                          WAWNT1
     I              F9MPAA                          WAMPAA
     I              F9RSNY                          WARSNY
     I              F9GZPR                          WAGZPR
     I              F9GXPC                          WAGXPC
     I              F9GYPC                          WAGYPC
     I              F9VSST                          WAVSST
     I              F9MJDT                          WAMJDT
     I              F9BETM                          WABETM
     I              F9CCVN                          WACCVN
     I              F9CDVN                          WACDVN
     I              F9MKDT                          WAMKDT
     I              F9BFTM                          WABFTM
     I              F9CEVN                          WACEVN
     I              F9CFVN                          WACFVN
      *
     I@F9REF2
      * IP Cust Item Formula Dtl  Update index
      * Renamed input format fields
     I              F9BKC7                          WBBKC7
     I              F9HGCD                          WBHGCD
     I              F9RRNY                          WBRRNY
     I              F9IUST                          WBIUST
     I              F9WNT1                          WBWNT1
     I              F9MPAA                          WBMPAA
     I              F9RSNY                          WBRSNY
     I              F9GZPR                          WBGZPR
     I              F9GXPC                          WBGXPC
     I              F9GYPC                          WBGYPC
     I              F9VSST                          WBVSST
     I              F9MJDT                          WBMJDT
     I              F9BETM                          WBBETM
     I              F9CCVN                          WBCCVN
     I              F9CDVN                          WBCDVN
     I              F9MKDT                          WBMKDT
     I              F9BFTM                          WBBFTM
     I              F9CEVN                          WBCEVN
     I              F9CFVN                          WBCFVN
      *
     I@F8REFY
      * IP Cust Item Price Elem   Retrieval index
      * Renamed input format fields
     I              F8BKC7                          WCBKC7
     I              F8HGCD                          WCHGCD
     I              F8MCAA                          WCMCAA
     I              F8GYPR                          WCGYPR
     I              F8MOAA                          WCMOAA
     I              F8VSST                          WCVSST
     I              F8MJDT                          WCMJDT
     I              F8BETM                          WCBETM
     I              F8CCVN                          WCCCVN
     I              F8CDVN                          WCCDVN
     I              F8MKDT                          WCMKDT
     I              F8BFTM                          WCBFTM
     I              F8CEVN                          WCCEVN
     I              F8CFVN                          WCCFVN
      *
     I@F8REFX
      * IP Cust Item Price Elem   Update index
      * Renamed input format fields
     I              F8BKC7                          WDBKC7
     I              F8HGCD                          WDHGCD
     I              F8MCAA                          WDMCAA
     I              F8GYPR                          WDGYPR
     I              F8MOAA                          WDMOAA
     I              F8VSST                          WDVSST
     I              F8MJDT                          WDMJDT
     I              F8BETM                          WDBETM
     I              F8CCVN                          WDCCVN
     I              F8CDVN                          WDCDVN
     I              F8MKDT                          WDMKDT
     I              F8BFTM                          WDBFTM
     I              F8CEVN                          WDCEVN
     I              F8CFVN                          WDCFVN
      *
     I@F3REFG
      * IP Cust Item Pricing Dtl  Retrieval index
      * Renamed input format fields
     I              F3BKC7                          WEBKC7
     I              F3HGCD                          WEHGCD
     I              F3ILST                          WEILST
     I              F3INST                          WEINST
     I              F3MMAA                          WEMMAA
     I              F3MKAA                          WEMKAA
     I              F3MLAA                          WEMLAA
     I              F3CYC3                          WECYC3
     I              F3VSST                          WEVSST
     I              F3MJDT                          WEMJDT
     I              F3BETM                          WEBETM
     I              F3CCVN                          WECCVN
     I              F3CDVN                          WECDVN
     I              F3MKDT                          WEMKDT
     I              F3BFTM                          WEBFTM
     I              F3CEVN                          WECEVN
     I              F3CFVN                          WECFVN
      *
     I@F3REFF
      * IP Cust Item Pricing Dtl  Update index
      * Renamed input format fields
     I              F3BKC7                          WFBKC7
     I              F3HGCD                          WFHGCD
     I              F3ILST                          WFILST
     I              F3INST                          WFINST
     I              F3MMAA                          WFMMAA
     I              F3MKAA                          WFMKAA
     I              F3MLAA                          WFMLAA
     I              F3CYC3                          WFCYC3
     I              F3VSST                          WFVSST
     I              F3MJDT                          WFMJDT
     I              F3BETM                          WFBETM
     I              F3CCVN                          WFCCVN
     I              F3CDVN                          WFCDVN
     I              F3MKDT                          WFMKDT
     I              F3BFTM                          WFBFTM
     I              F3CEVN                          WFCEVN
     I              F3CFVN                          WFCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPNF91    E DSPNF9REL0
      * UPD : IP Cust Item Formula Dtl  Update index
      * Renamed input format fields
     I              F9BKC7                          WBBKC7
     I              F9HGCD                          WBHGCD
     I              F9RRNY                          WBRRNY
     I              F9IUST                          WBIUST
     I              F9WNT1                          WBWNT1
     I              F9MPAA                          WBMPAA
     I              F9RSNY                          WBRSNY
     I              F9GZPR                          WBGZPR
     I              F9GXPC                          WBGXPC
     I              F9GYPC                          WBGYPC
     I              F9VSST                          WBVSST
     I              F9MJDT                          WBMJDT
     I              F9BETM                          WBBETM
     I              F9CCVN                          WBCCVN
     I              F9CDVN                          WBCDVN
     I              F9MKDT                          WBMKDT
     I              F9BFTM                          WBBFTM
     I              F9CEVN                          WBCEVN
     I              F9CFVN                          WBCFVN
      *
     IQPNF81    E DSPNF8REL0
      * UPD : IP Cust Item Price Elem   Update index
      * Renamed input format fields
     I              F8BKC7                          WDBKC7
     I              F8HGCD                          WDHGCD
     I              F8MCAA                          WDMCAA
     I              F8GYPR                          WDGYPR
     I              F8MOAA                          WDMOAA
     I              F8VSST                          WDVSST
     I              F8MJDT                          WDMJDT
     I              F8BETM                          WDBETM
     I              F8CCVN                          WDCCVN
     I              F8CDVN                          WDCDVN
     I              F8MKDT                          WDMKDT
     I              F8BFTM                          WDBFTM
     I              F8CEVN                          WDCEVN
     I              F8CFVN                          WDCFVN
      *
     IQPNF31    E DSPNF3REL0
      * UPD : IP Cust Item Pricing Dtl  Update index
      * Renamed input format fields
     I              F3BKC7                          WFBKC7
     I              F3HGCD                          WFHGCD
     I              F3ILST                          WFILST
     I              F3INST                          WFINST
     I              F3MMAA                          WFMMAA
     I              F3MKAA                          WFMKAA
     I              F3MLAA                          WFMLAA
     I              F3CYC3                          WFCYC3
     I              F3VSST                          WFVSST
     I              F3MJDT                          WFMJDT
     I              F3BETM                          WFBETM
     I              F3CCVN                          WFCCVN
     I              F3CDVN                          WFCDVN
     I              F3MKDT                          WFMKDT
     I              F3BFTM                          WFBFTM
     I              F3CEVN                          WFCEVN
     I              F3CFVN                          WFCFVN
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: IP Cust Item Formula Dtl
      * I :  Ship To Customer
     I                                    P   1   40P1BKC7
      * I :  Item Code
     I                                    P   5   80P1HGCD
     IP2PARM      DS
      * I :  Item Code USR
     I                                    P   1   40P2B6C7
     IP3PARM      DS
      * I :  Record Found USR
     I                                        1   1 P3WXST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1BKC7    PARM           WP0001  70       Ship To Custome
     C           P1HGCD    PARM           WP0002  70       Item Code
     C           P2B6C7    PARM           WP0003  70       Item Code USR
     C           P3WXST    PARM           WP0004  1        Record Found US
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Cpy Cust Item Formula XF
      * Cpy Cust Item Formula RT - IP Cust Item Formula Dtl  * 
     C                     EXSR SARVGN
      * Cpy CustItem Prc Elem RT - IP Cust Item Price Elem  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0001           Ship To Custome
     C                     Z-ADDP1HGCD    WL0002           Item Code
     C                     MOVEL@CN,001   WL0003    P      PE Price Elemen
     C                     Z-ADDP2B6C7    WL0004           Item Code USR
     C                     EXSR SCRVGN
      * Cpy CustItem Prc Elem RT - IP Cust Item Price Elem  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0001           Ship To Custome
     C                     Z-ADDP1HGCD    WL0002           Item Code
     C                     MOVEL@CN,002   WL0003    P      PE Price Elemen
     C                     Z-ADDP2B6C7    WL0004           Item Code USR
     C                     EXSR SCRVGN
      * CASE: PAR.Record Found USR is Record Not Found
     C           P3WXST    IFEQ 'N'                        *IF
      * Cpy Cust Item Prc Dtl RT - IP Cust Item Pricing Dtl  * 
     C                     EXSR SERVGN
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Cpy Cust Item Formula RT - IP Cust Item Formula Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WABKC7    WQSA01           Ship To Custome
     C           *LIKE     DEFN WAHGCD    WQSA02           Item Code
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Ship To Custome
     C                     KFLD           WQSA02           Item Code
      * Setup key
     C                     Z-ADDP1BKC7    WQSA01           Ship To Custome
     C                     Z-ADDP1HGCD    WQSA02           Item Code
      * Establish starting position
     C           KRSSA     SETLL@F9REF3                    *
     C           KRSSA     READE@F9REF3                  90*
      * Data record not found
     C   90                MOVEL'USR4294' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Crt Cust Item Formula CR - IP Cust Item Formula Dtl  * 
     C                     EXSR SBCRRC
     C           KRSSA     READE@F9REF3                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Crt Cust Item Formula CR - IP Cust Item Formula Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @F9REF2
     C                     Z-ADDWABKC7    WBBKC7           Ship To Custome
     C                     Z-ADDP2B6C7    WBHGCD           Item Code
     C                     Z-ADDWARRNY    WBRRNY           CIFD Sequence N
     C                     MOVELWAIUST    WBIUST           CIFD Formula Va
     C                     MOVELWAWNT1    WBWNT1           CIFD Fromula Va
     C                     MOVELWAMPAA    WBMPAA           CIFD Commodity
     C                     MOVELWARSNY    WBRSNY           CIFD Commodity
     C                     Z-ADDWAGZPR    WBGZPR           CIFD Market Pre
     C                     Z-ADDWAGXPC    WBGXPC           CIFD Percent of
     C                     Z-ADDWAGYPC    WBGYPC           CIFD Yield Perc
     C                     MOVELWAVSST    WBVSST           Record Status
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     MOVEL*BLANK    WBCCVN           Create User
     C                     MOVEL*BLANK    WBCDVN           Create Program
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
     C                     MOVEL*BLANK    WBCEVN           Change User
     C                     MOVEL*BLANK    WBCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WBVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WBMJDT           Create Date
     C                     Z-ADD##JTM     WBBETM           Create Time
     C                     MOVEL##USR     WBCCVN           Create User
     C                     MOVEL##PGM     WBCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
     C                     MOVEL*BLANK    WBCEVN           Change User
     C                     MOVEL*BLANK    WBCFVN           Change Program
     C           KLCRSB    KLIST
     C                     KFLD           WBBKC7           Ship To Custome
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBRRNY           CIFD Sequence N
      * Check for duplicate primary key
     C           KLCRSB    SETLL@F9REF2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4295' W0RTN   7
      * Send message 'IP Cust Item Formula D EX'
     C                     MOVEL'USR4295' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@F9REF2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Cpy CustItem Prc Elem RT - IP Cust Item Price Elem  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCBKC7           Ship To Custome
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCMCAA           PE Price Elemen
      * Setup key
     C                     Z-ADDWL0001    WCBKC7           Ship To Custome
     C                     Z-ADDWL0002    WCHGCD           Item Code
     C                     MOVELWL0003    WCMCAA           PE Price Elemen
      * Establish starting position
     C           KRSSC     CHAIN@F8REFY              90    *
      * Data record not found
     C   90                MOVEL'USR4291' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Crt CustItem Prc Elem CR - IP Cust Item Price Elem  * 
     C                     EXSR SDCRRC
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt CustItem Prc Elem CR - IP Cust Item Price Elem  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @F8REFX
     C                     Z-ADDWCBKC7    WDBKC7           Ship To Custome
     C                     Z-ADDWL0004    WDHGCD           Item Code
     C                     MOVELWCMCAA    WDMCAA           PE Price Elemen
     C                     Z-ADDWCGYPR    WDGYPR           CIPE Rate
     C                     MOVELWCMOAA    WDMOAA           CIPE Rate UOM
     C                     MOVELWCVSST    WDVSST           Record Status
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     MOVEL*BLANK    WDCCVN           Create User
     C                     MOVEL*BLANK    WDCDVN           Create Program
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
     C                     MOVEL*BLANK    WDCEVN           Change User
     C                     MOVEL*BLANK    WDCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WDVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WDMJDT           Create Date
     C                     Z-ADD##JTM     WDBETM           Create Time
     C                     MOVEL##USR     WDCCVN           Create User
     C                     MOVEL##PGM     WDCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
     C                     MOVEL*BLANK    WDCEVN           Change User
     C                     MOVEL*BLANK    WDCFVN           Change Program
     C           KLCRSD    KLIST
     C                     KFLD           WDBKC7           Ship To Custome
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDMCAA           PE Price Elemen
      * Check for duplicate primary key
     C           KLCRSD    SETLL@F8REFX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4292' W0RTN   7
      * Send message 'IP Cust Item Price Ele EX'
     C                     MOVEL'USR4292' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@F8REFX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Cpy Cust Item Prc Dtl RT - IP Cust Item Pricing Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEBKC7           Ship To Custome
     C                     KFLD           WEHGCD           Item Code
      * Setup key
     C                     Z-ADDP1BKC7    WEBKC7           Ship To Custome
     C                     Z-ADDP1HGCD    WEHGCD           Item Code
      * Establish starting position
     C           KRSSE     CHAIN@F3REFG              90    *
      * Data record not found
     C   90                MOVEL'USR4281' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Crt IP Cust Item Pric CR - IP Cust Item Pricing Dtl  * 
     C                     EXSR SFCRRC
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Crt IP Cust Item Pric CR - IP Cust Item Pricing Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @F3REFF
     C                     Z-ADDWEBKC7    WFBKC7           Ship To Custome
     C                     Z-ADDP2B6C7    WFHGCD           Item Code
     C                     MOVELWEILST    WFILST           Price Sheet Ite
     C                     MOVELWEINST    WFINST           Order Form Prin
     C                     MOVELWEMMAA    WFMMAA           OE Dft Commodit
     C                     MOVELWEMKAA    WFMKAA           OE Dft Price Me
     C                     MOVELWEMLAA    WFMLAA           OE Dft Market D
     C                     Z-ADDWECYC3    WFCYC3           CIPD Unused Nbr
     C                     MOVELWEVSST    WFVSST           Record Status
     C                     Z-ADD*ZERO     WFMJDT           Create Date
     C                     Z-ADD*ZERO     WFBETM           Create Time
     C                     MOVEL*BLANK    WFCCVN           Create User
     C                     MOVEL*BLANK    WFCDVN           Create Program
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
     C                     MOVEL*BLANK    WFCEVN           Change User
     C                     MOVEL*BLANK    WFCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WFVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WFMJDT           Create Date
     C                     Z-ADD##JTM     WFBETM           Create Time
     C                     MOVEL##USR     WFCCVN           Create User
     C                     MOVEL##PGM     WFCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
     C                     MOVEL*BLANK    WFCEVN           Change User
     C                     MOVEL*BLANK    WFCFVN           Change Program
     C           KLCRSF    KLIST
     C                     KFLD           WFBKC7           Ship To Custome
     C                     KFLD           WFHGCD           Item Code
      * Check for duplicate primary key
     C           KLCRSF    SETLL@F3REFF                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4282' W0RTN   7
      * Send message 'IP Cust Item Pricing D EX'
     C                     MOVEL'USR4282' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@F3REFF                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WARRNY           CIFD Sequence N
     C                     Z-ADD*ZERO     WAGZPR           CIFD Market Pre
     C                     Z-ADD*ZERO     WAGXPC           CIFD Percent of
     C                     Z-ADD*ZERO     WAGYPC           CIFD Yield Perc
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCGYPR           CIPE Rate
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WECYC3           CIPD Unused Nbr
     C                     Z-ADD*ZERO     WEMJDT           Create Date
     C                     Z-ADD*ZERO     WEBETM           Create Time
     C                     Z-ADD*ZERO     WEMKDT           Change Date
     C                     Z-ADD*ZERO     WEBFTM           Change Time
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003 10
     C                     Z-ADD*ZERO     WL0004  70
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 CIFRTO
00002 CIPFEE
