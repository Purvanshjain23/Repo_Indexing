     H/TITLE Cpy Carc Merit Pgm     XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1181
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL                     n
     H* System        : HPEDEVMDL
     H* User name     : ISSMASO
     H* Date          : 10/23/07  Time  : 11:21:04
     H* Copyright     : HPEDEVMDL                     n
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKARREL0IF  E           K        DISK
      * RTV : Carcass Merit Program     Retrieval index
      *
     FPKB0REL1IF  E           K        DISK
      * RTV : Carcass Merit Prog Com    Retrieval index
      *
     FPKBYREL1IF  E           K        DISK
      * RTV : Carcass Merit Matrix Row  Retrieval index
      *
     FPKBZREL1IF  E           K        DISK
      * RTV : Carcass Merit Matrix Col  Retrieval index
      *
     FPKARREL1IF  E           K        DISK                      A
      * UPD : Carcass Merit Program     Update index
      *
     FPKB0REL0IF  E           K        DISK                      A
      * UPD : Carcass Merit Prog Com    Update index
      *
     FPKBYREL0IF  E           K        DISK                      A
      * UPD : Carcass Merit Matrix Row  Update index
      *
     FPKBZREL0IF  E           K        DISK                      A
      * UPD : Carcass Merit Matrix Col  Update index
      *
     I@ARREBF
      * Carcass Merit Program     Retrieval index
      * Renamed input format fields
     I              ARAMCD                          WAAMCD
     I              ARA3TX                          WAA3TX
     I              ARDLST                          WADLST
     I              ARDMST                          WADMST
     I              ARDOST                          WADOST
     I              ARDQST                          WADQST
     I              ARAZPC                          WAAZPC
     I              ARA0PC                          WAA0PC
     I              ARDTST                          WADTST
     I              ARF5ST                          WAF5ST
     I              ARI1PR                          WAI1PR
     I              ARVEPR                          WAVEPR
     I              ARVFPR                          WAVFPR
     I              ARVHPR                          WAVHPR
     I              ARVIPR                          WAVIPR
     I              ARVJPR                          WAVJPR
     I              ARZ2ST                          WAZ2ST
     I              ARZ3ST                          WAZ3ST
     I              ARZ4ST                          WAZ4ST
     I              ARAAVN                          WAAAVN
     I              ARAADT                          WAAADT
     I              ARAMTM                          WAAMTM
     I              ARAJST                          WAAJST
     I              ARAHVN                          WAAHVN
     I              ARAGVN                          WAAGVN
     I              ARABVN                          WAABVN
     I              ARABDT                          WAABDT
     I              ARABTM                          WAABTM
      *
     I@ARREBG
      * Carcass Merit Program     Update index
      * Renamed input format fields
     I              ARAMCD                          WBAMCD
     I              ARA3TX                          WBA3TX
     I              ARDLST                          WBDLST
     I              ARDMST                          WBDMST
     I              ARDOST                          WBDOST
     I              ARDQST                          WBDQST
     I              ARAZPC                          WBAZPC
     I              ARA0PC                          WBA0PC
     I              ARDTST                          WBDTST
     I              ARF5ST                          WBF5ST
     I              ARI1PR                          WBI1PR
     I              ARVEPR                          WBVEPR
     I              ARVFPR                          WBVFPR
     I              ARVHPR                          WBVHPR
     I              ARVIPR                          WBVIPR
     I              ARVJPR                          WBVJPR
     I              ARZ2ST                          WBZ2ST
     I              ARZ3ST                          WBZ3ST
     I              ARZ4ST                          WBZ4ST
     I              ARAAVN                          WBAAVN
     I              ARAADT                          WBAADT
     I              ARAMTM                          WBAMTM
     I              ARAJST                          WBAJST
     I              ARAHVN                          WBAHVN
     I              ARAGVN                          WBAGVN
     I              ARABVN                          WBABVN
     I              ARABDT                          WBABDT
     I              ARABTM                          WBABTM
      *
     I@B0REGL
      * Carcass Merit Prog Com    Retrieval index
      * Renamed input format fields
     I              B0AMCD                          WCAMCD
     I              B0ESNB                          WCESNB
     I              B0B5TX                          WCB5TX
     I              B0ENST                          WCENST
     I              B0AAVN                          WCAAVN
     I              B0AADT                          WCAADT
     I              B0AMTM                          WCAMTM
     I              B0AJST                          WCAJST
     I              B0AHVN                          WCAHVN
     I              B0AGVN                          WCAGVN
     I              B0ABVN                          WCABVN
     I              B0ABDT                          WCABDT
     I              B0ABTM                          WCABTM
      *
     I@B0REGK
      * Carcass Merit Prog Com    Update index
      * Renamed input format fields
     I              B0AMCD                          WDAMCD
     I              B0ESNB                          WDESNB
     I              B0B5TX                          WDB5TX
     I              B0ENST                          WDENST
     I              B0AAVN                          WDAAVN
     I              B0AADT                          WDAADT
     I              B0AMTM                          WDAMTM
     I              B0AJST                          WDAJST
     I              B0AHVN                          WDAHVN
     I              B0AGVN                          WDAGVN
     I              B0ABVN                          WDABVN
     I              B0ABDT                          WDABDT
     I              B0ABTM                          WDABTM
      *
     I@BYREGF
      * Carcass Merit Matrix Row  Retrieval index
      * Renamed input format fields
     I              BYAMCD                          WEAMCD
     I              BYE8NB                          WEE8NB
     I              BYEGNB                          WEEGNB
     I              BYEHNB                          WEEHNB
     I              BYEINB                          WEEINB
     I              BYEJNB                          WEEJNB
     I              BYEKNB                          WEEKNB
     I              BYAQPC                          WEAQPC
     I              BYEMNB                          WEEMNB
     I              BYE2NB                          WEE2NB
     I              BYLJA1                          WELJA1
     I              BYAAVN                          WEAAVN
     I              BYAADT                          WEAADT
     I              BYAMTM                          WEAMTM
     I              BYAJST                          WEAJST
     I              BYAHVN                          WEAHVN
     I              BYAGVN                          WEAGVN
     I              BYABVN                          WEABVN
     I              BYABDT                          WEABDT
     I              BYABTM                          WEABTM
      *
     I@BYREGE
      * Carcass Merit Matrix Row  Update index
      * Renamed input format fields
     I              BYAMCD                          WFAMCD
     I              BYE8NB                          WFE8NB
     I              BYEGNB                          WFEGNB
     I              BYEHNB                          WFEHNB
     I              BYEINB                          WFEINB
     I              BYEJNB                          WFEJNB
     I              BYEKNB                          WFEKNB
     I              BYAQPC                          WFAQPC
     I              BYEMNB                          WFEMNB
     I              BYE2NB                          WFE2NB
     I              BYLJA1                          WFLJA1
     I              BYAAVN                          WFAAVN
     I              BYAADT                          WFAADT
     I              BYAMTM                          WFAMTM
     I              BYAJST                          WFAJST
     I              BYAHVN                          WFAHVN
     I              BYAGVN                          WFAGVN
     I              BYABVN                          WFABVN
     I              BYABDT                          WFABDT
     I              BYABTM                          WFABTM
      *
     I@BZREGI
      * Carcass Merit Matrix Col  Retrieval index
      * Renamed input format fields
     I              BZAMCD                          WGAMCD
     I              BZE8NB                          WGE8NB
     I              BZE4NB                          WGE4NB
     I              BZA1PC                          WGA1PC
     I              BZE7NB                          WGE7NB
     I              BZCHCD                          WGCHCD
     I              BZERNB                          WGERNB
     I              BZAAVN                          WGAAVN
     I              BZAADT                          WGAADT
     I              BZAMTM                          WGAMTM
     I              BZAJST                          WGAJST
     I              BZAHVN                          WGAHVN
     I              BZAGVN                          WGAGVN
     I              BZABVN                          WGABVN
     I              BZABDT                          WGABDT
     I              BZABTM                          WGABTM
      *
     I@BZREGH
      * Carcass Merit Matrix Col  Update index
      * Renamed input format fields
     I              BZAMCD                          WHAMCD
     I              BZE8NB                          WHE8NB
     I              BZE4NB                          WHE4NB
     I              BZA1PC                          WHA1PC
     I              BZE7NB                          WHE7NB
     I              BZCHCD                          WHCHCD
     I              BZERNB                          WHERNB
     I              BZAAVN                          WHAAVN
     I              BZAADT                          WHAADT
     I              BZAMTM                          WHAMTM
     I              BZAJST                          WHAJST
     I              BZAHVN                          WHAHVN
     I              BZAGVN                          WHAGVN
     I              BZABVN                          WHABVN
     I              BZABDT                          WHABDT
     I              BZABTM                          WHABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKAR1    E DSPKARREL1
      * UPD : Carcass Merit Program     Update index
      * Renamed input format fields
     I              ARAMCD                          WBAMCD
     I              ARA3TX                          WBA3TX
     I              ARDLST                          WBDLST
     I              ARDMST                          WBDMST
     I              ARDOST                          WBDOST
     I              ARDQST                          WBDQST
     I              ARAZPC                          WBAZPC
     I              ARA0PC                          WBA0PC
     I              ARDTST                          WBDTST
     I              ARF5ST                          WBF5ST
     I              ARI1PR                          WBI1PR
     I              ARVEPR                          WBVEPR
     I              ARVFPR                          WBVFPR
     I              ARVHPR                          WBVHPR
     I              ARVIPR                          WBVIPR
     I              ARVJPR                          WBVJPR
     I              ARZ2ST                          WBZ2ST
     I              ARZ3ST                          WBZ3ST
     I              ARZ4ST                          WBZ4ST
     I              ARAAVN                          WBAAVN
     I              ARAADT                          WBAADT
     I              ARAMTM                          WBAMTM
     I              ARAJST                          WBAJST
     I              ARAHVN                          WBAHVN
     I              ARAGVN                          WBAGVN
     I              ARABVN                          WBABVN
     I              ARABDT                          WBABDT
     I              ARABTM                          WBABTM
      *
     IQPKB01    E DSPKB0REL0
      * UPD : Carcass Merit Prog Com    Update index
      * Renamed input format fields
     I              B0AMCD                          WDAMCD
     I              B0ESNB                          WDESNB
     I              B0B5TX                          WDB5TX
     I              B0ENST                          WDENST
     I              B0AAVN                          WDAAVN
     I              B0AADT                          WDAADT
     I              B0AMTM                          WDAMTM
     I              B0AJST                          WDAJST
     I              B0AHVN                          WDAHVN
     I              B0AGVN                          WDAGVN
     I              B0ABVN                          WDABVN
     I              B0ABDT                          WDABDT
     I              B0ABTM                          WDABTM
      *
     IQPKBY1    E DSPKBYREL0
      * UPD : Carcass Merit Matrix Row  Update index
      * Renamed input format fields
     I              BYAMCD                          WFAMCD
     I              BYE8NB                          WFE8NB
     I              BYEGNB                          WFEGNB
     I              BYEHNB                          WFEHNB
     I              BYEINB                          WFEINB
     I              BYEJNB                          WFEJNB
     I              BYEKNB                          WFEKNB
     I              BYAQPC                          WFAQPC
     I              BYEMNB                          WFEMNB
     I              BYE2NB                          WFE2NB
     I              BYLJA1                          WFLJA1
     I              BYAAVN                          WFAAVN
     I              BYAADT                          WFAADT
     I              BYAMTM                          WFAMTM
     I              BYAJST                          WFAJST
     I              BYAHVN                          WFAHVN
     I              BYAGVN                          WFAGVN
     I              BYABVN                          WFABVN
     I              BYABDT                          WFABDT
     I              BYABTM                          WFABTM
      *
     IQPKBZ1    E DSPKBZREL0
      * UPD : Carcass Merit Matrix Col  Update index
      * Renamed input format fields
     I              BZAMCD                          WHAMCD
     I              BZE8NB                          WHE8NB
     I              BZE4NB                          WHE4NB
     I              BZA1PC                          WHA1PC
     I              BZE7NB                          WHE7NB
     I              BZCHCD                          WHCHCD
     I              BZERNB                          WHERNB
     I              BZAAVN                          WHAAVN
     I              BZAADT                          WHAADT
     I              BZAMTM                          WHAMTM
     I              BZAJST                          WHAJST
     I              BZAHVN                          WHAHVN
     I              BZAGVN                          WHAGVN
     I              BZABVN                          WHABVN
     I              BZABDT                          WHABDT
     I              BZABTM                          WHABTM
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Carcass Merit Program
      * I : MAP CMP Program Code
     I                                        1   3 P1AMCD
      * I : MAP CMP Description
     I                                        4  28 P1A3TX
     IP2PARM      DS
      * I : MAP Carc Merit Pgm Code USR
     I                                        1   3 P2A0CD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AMCD    PARM           WP0001  3        CMP Program Cod
     C           P1A3TX    PARM           WP0002 25        CMP Description
     C           P2A0CD    PARM           WP0003  3        Carc Merit Pgm
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Cpy Carc Merit Pgm     XF
      * 10/23/2007 ADDED CMP Grade Type Adj &
      *            CMP CLC Premium First  THIS was not being passed
      * Rtv CMP Info Record   RT - Carcass Merit Program  * 
     C                     EXSR SARVGN
      * Read org record and copy to new carcass merit pgm
      * 10/23/2007 ADDED CMP Grade Type Adj &
      *            CMP CLC Premium First  THIS was not being passed
      * Crt Carcass Merit Pgm CR - Carcass Merit Program  * 
     C                     EXSR SBCRRC
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * If no error found
      * Cpy Carc Merit Pgm Com Rt - Carcass Merit Prog Com  * 
     C                     EXSR SCRVGN
      * Cpy CMP Matrix Row    RT - Carcass Merit Matrix Row  * 
     C                     EXSR SERVGN
      * Cpy CMP Matrix Col    RT - Carcass Merit Matrix Col  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv CMP Info Record   RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAMCD           CMP Program Cod
      * Setup key
     C                     MOVELP1AMCD    WAAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSA     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUA3TX           CMP Description
     C                     MOVEL*BLANK    WUDLST           CMP Grading Typ
     C                     MOVEL*BLANK    WUDMST           CMP Sort Basis
     C                     MOVEL*BLANK    WUDOST           CMP Sts
     C                     MOVEL*BLANK    WUDQST           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WUAZPC           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WUA0PC           CMP Lean Factor
     C                     MOVEL*BLANK    WUDTST           CMP Optimal Row
     C                     MOVEL*BLANK    WUF5ST           CMP Type
     C                     Z-ADD*ZERO     WUI1PR           CMP Market Add/
     C                     Z-ADD*ZERO     WUVEPR           CMP % of Carcas
     C                     Z-ADD*ZERO     WUVFPR           CMP Fixed Cost
     C                     Z-ADD*ZERO     WUVHPR           CMP Grade Type
     C                     MOVEL*BLANK    WUZ2ST           CMP CLC Premium
     C                     MOVEL*BLANK    WUAJST           RS Record Statu
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAA3TX    WUA3TX           CMP Description
     C                     MOVELWADLST    WUDLST           CMP Grading Typ
     C                     MOVELWADMST    WUDMST           CMP Sort Basis
     C                     MOVELWADOST    WUDOST           CMP Sts
     C                     MOVELWADQST    WUDQST           CMP Carc Wgt Ty
     C                     Z-ADDWAAZPC    WUAZPC           CMP Std Lean Pe
     C                     Z-ADDWAA0PC    WUA0PC           CMP Lean Factor
     C                     MOVELWADTST    WUDTST           CMP Optimal Row
     C                     MOVELWAF5ST    WUF5ST           CMP Type
     C                     Z-ADDWAI1PR    WUI1PR           CMP Market Add/
     C                     Z-ADDWAVEPR    WUVEPR           CMP % of Carcas
     C                     Z-ADDWAVFPR    WUVFPR           CMP Fixed Cost
     C                     Z-ADDWAVHPR    WUVHPR           CMP Grade Type
     C                     MOVELWAZ2ST    WUZ2ST           CMP CLC Premium
     C                     MOVELWAAJST    WUAJST           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Crt Carcass Merit Pgm CR - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ARREBG
     C                     MOVELP2A0CD    WBAMCD           CMP Program Cod
     C                     MOVELP1A3TX    WBA3TX           CMP Description
     C                     MOVELWUDLST    WBDLST           CMP Grading Typ
     C                     MOVELWUDMST    WBDMST           CMP Sort Basis
     C                     MOVELWUDOST    WBDOST           CMP Sts
     C                     MOVELWUDQST    WBDQST           CMP Carc Wgt Ty
     C                     Z-ADDWUAZPC    WBAZPC           CMP Std Lean Pe
     C                     Z-ADDWUA0PC    WBA0PC           CMP Lean Factor
     C                     MOVELWUDTST    WBDTST           CMP Optimal Row
     C                     MOVELWUF5ST    WBF5ST           CMP Type
     C                     Z-ADDWUI1PR    WBI1PR           CMP Market Add/
     C                     Z-ADDWUVEPR    WBVEPR           CMP % of Carcas
     C                     Z-ADDWUVFPR    WBVFPR           CMP Fixed Cost
     C                     Z-ADDWUVHPR    WBVHPR           CMP Grade Type
     C                     Z-ADDYL0001    WBVIPR           CMP Unused Pric
     C                     Z-ADDYL0002    WBVJPR           CMP Unused Pric
     C                     MOVELWUZ2ST    WBZ2ST           CMP CLC Premium
     C                     MOVELYL0003    WBZ3ST           CMP Unused Sts
     C                     MOVELYL0004    WBZ4ST           CMP Unused Sts
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELWUAJST    WBAJST           RS Record Statu
     C                     MOVELWUAHVN    WBAHVN           RS Job
     C                     MOVELWUAGVN    WBAGVN           RS Program
     C                     MOVELWUABVN    WBABVN           RS User Added
     C                     Z-ADDWUABDT    WBABDT           RS Date Added
     C                     Z-ADDWUABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSB    KLIST
     C                     KFLD           WBAMCD           CMP Program Cod
      * Check for duplicate primary key
     C           KLCRSB    SETLL@ARREBG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0040' W0RTN   7
      * Send message 'Carcass Merit Program  EX'
     C                     MOVEL'PRK0040' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@ARREBG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Cpy Carc Merit Pgm Com Rt - Carcass Merit Prog Com  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAMCD    WQSC01           CMP Program Cod
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           CMP Program Cod
      * Setup key
     C                     MOVELP1AMCD    WQSC01           CMP Program Cod
      * Establish starting position
     C           KRSSC     SETLL@B0REGL                    *
     C           KRSSC     READE@B0REGL                  90*
      * Data record not found
     C   90                MOVEL'PRK0136' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Create New cpy records
      * Create Carcass Merit Prog - Carcass Merit Prog Com  * 
     C                     EXSR SDCRRC
     C           KRSSC     READE@B0REGL                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Create Carcass Merit Prog - Carcass Merit Prog Com  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B0REGK
     C                     MOVELP2A0CD    WDAMCD           CMP Program Cod
     C                     Z-ADDWCESNB    WDESNB           CMPC Comment Li
     C                     MOVELWCB5TX    WDB5TX           CMPC Comment
     C                     MOVELWCENST    WDENST           CMPC Comment Ty
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST           RS Record Statu
     C                     MOVELWCAHVN    WDAHVN           RS Job
     C                     MOVELWCAGVN    WDAGVN           RS Program
     C                     MOVELWCABVN    WDABVN           RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRSD    KLIST
     C                     KFLD           WDAMCD           CMP Program Cod
     C                     KFLD           WDESNB           CMPC Comment Li
      * Check for duplicate primary key
     C           KLCRSD    SETLL@B0REGK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0137' W0RTN   7
      * Send message 'Carcass Merit Prog Com EX'
     C                     MOVEL'PRK0137' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@B0REGK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Cpy CMP Matrix Row    RT - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAMCD    WQSE01           CMP Program Cod
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           CMP Program Cod
      * Setup key
     C                     MOVELP1AMCD    WQSE01           CMP Program Cod
      * Establish starting position
     C           KRSSE     SETLL@BYREGF                    *
     C           KRSSE     READE@BYREGF                  90*
      * Data record not found
     C   90                MOVEL'PRK0132' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Create Carcass Merit Matr - Carcass Merit Matrix Row  * 
     C                     EXSR SFCRRC
     C           KRSSE     READE@BYREGF                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Create Carcass Merit Matr - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BYREGE
     C                     MOVELP2A0CD    WFAMCD           CMP Program Cod
     C                     Z-ADDWEE8NB    WFE8NB           CMMR Row Number
     C                     Z-ADDWEEGNB    WFEGNB           CMMR Carc Wgt M
     C                     Z-ADDWEEHNB    WFEHNB           CMMR Carc Wgt M
     C                     Z-ADDWEEINB    WFEINB           CMMR Carc Wgt M
     C                     Z-ADDWEEJNB    WFEJNB           CMMR Live Wgt M
     C                     Z-ADDWEEKNB    WFEKNB           CMMR Live Wgt M
     C                     Z-ADDWEAQPC    WFAQPC           CMMR Std Dressi
     C                     Z-ADDWEEMNB    WFEMNB           CMMR Sort Disco
     C                     Z-ADDWEE2NB    WFE2NB           CMMR Unused Fie
     C                     Z-ADDWELJA1    WFLJA1           CMMR Midpoint
     C                     MOVEL*BLANK    WFAAVN           RS User Changed
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     MOVELWEAJST    WFAJST           RS Record Statu
     C                     MOVELWEAHVN    WFAHVN           RS Job
     C                     MOVELWEAGVN    WFAGVN           RS Program
     C                     MOVELWEABVN    WFABVN           RS User Added
     C                     Z-ADDWEABDT    WFABDT           RS Date Added
     C                     Z-ADDWEABTM    WFABTM           RS Time Added
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WFAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WFAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WFAJST           RS Record Statu
     C                     MOVEL##USR     WFABVN           RS User Added
     C                     Z-ADD##JDT     WFABDT           RS Date Added
     C                     Z-ADD##JTM     WFABTM           RS Time Added
     C                     MOVEL##PGM     WFAGVN           RS Program
     C                     MOVEL##JOB     WFAHVN           RS Job
     C           KLCRSF    KLIST
     C                     KFLD           WFAMCD           CMP Program Cod
     C                     KFLD           WFE8NB           CMMR Row Number
      * Check for duplicate primary key
     C           KLCRSF    SETLL@BYREGE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0133' W0RTN   7
      * Send message 'Carcass Merit Matrix R EX'
     C                     MOVEL'PRK0133' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@BYREGE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Cpy CMP Matrix Col    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAMCD    WQSG01           CMP Program Cod
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           CMP Program Cod
      * Setup key
     C                     MOVELP1AMCD    WQSG01           CMP Program Cod
      * Establish starting position
     C           KRSSG     SETLL@BZREGI                    *
     C           KRSSG     READE@BZREGI                  90*
      * Data record not found
     C   90                MOVEL'PRK0134' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Crt CMM Col           CR - Carcass Merit Matrix Col  * 
     C                     EXSR SHCRRC
     C           KRSSG     READE@BZREGI                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * Crt CMM Col           CR - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BZREGH
     C                     MOVELP2A0CD    WHAMCD           CMP Program Cod
     C                     Z-ADDWGE8NB    WHE8NB           CMMR Row Number
     C                     Z-ADDWGE4NB    WHE4NB           CMMC Column Num
     C                     Z-ADDWGA1PC    WHA1PC           CMMC Lean Perce
     C                     Z-ADDWGE7NB    WHE7NB           CMMC Backfat In
     C                     MOVELWGCHCD    WHCHCD           CMMC Grade
     C                     Z-ADDWGERNB    WHERNB           CMMC Premium Va
     C                     MOVEL*BLANK    WHAAVN           RS User Changed
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     MOVELWGAJST    WHAJST           RS Record Statu
     C                     MOVELWGAHVN    WHAHVN           RS Job
     C                     MOVELWGAGVN    WHAGVN           RS Program
     C                     MOVELWGABVN    WHABVN           RS User Added
     C                     Z-ADDWGABDT    WHABDT           RS Date Added
     C                     Z-ADDWGABTM    WHABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WHAJST           RS Record Statu
     C                     MOVEL##USR     WHABVN           RS User Added
     C                     Z-ADD##JDT     WHABDT           RS Date Added
     C                     Z-ADD##JTM     WHABTM           RS Time Added
     C                     MOVEL##PGM     WHAGVN           RS Program
     C                     MOVEL##JOB     WHAHVN           RS Job
     C           KLCRSH    KLIST
     C                     KFLD           WHAMCD           CMP Program Cod
     C                     KFLD           WHE8NB           CMMR Row Number
     C                     KFLD           WHE4NB           CMMC Column Num
      * Check for duplicate primary key
     C           KLCRSH    SETLL@BZREGH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0135' W0RTN   7
      * Send message 'Carcass Merit Matrix C EX'
     C                     MOVEL'PRK0135' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@BZREGH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field CMP Description
     C                     MOVEL*BLANK    WUA3TX 25
      * Define work field CMP Grading Type
     C                     MOVEL*BLANK    WUDLST  1
      * Define work field CMP Sort Basis
     C                     MOVEL*BLANK    WUDMST  1
      * Define work field CMP Sts
     C                     MOVEL*BLANK    WUDOST  1
      * Define work field CMP Carc Wgt Type
     C                     MOVEL*BLANK    WUDQST  2
      * Define work field CMP Std Lean Percent
     C                     Z-ADD*ZERO     WUAZPC  31
      * Define work field CMP Lean Factor
     C                     Z-ADD*ZERO     WUA0PC  31
      * Define work field CMP Optimal Row Nbr f/srt
     C                     MOVEL*BLANK    WUDTST  1
      * Define work field CMP Type
     C                     MOVEL*BLANK    WUF5ST  1
      * Define work field CMP Market Add/Deduct
     C                     Z-ADD*ZERO     WUI1PR  52
      * Define work field CMP % of Carcass Cutout
     C                     Z-ADD*ZERO     WUVEPR  52
      * Define work field CMP Fixed Cost Per Head
     C                     Z-ADD*ZERO     WUVFPR  52
      * Define work field CMP Grade Type Adj
     C                     Z-ADD*ZERO     WUVHPR  52
      * Define work field CMP CLC Premium First
     C                     MOVEL*BLANK    WUZ2ST  1
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAZPC           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WAA0PC           CMP Lean Factor
     C                     Z-ADD*ZERO     WAI1PR           CMP Market Add/
     C                     Z-ADD*ZERO     WAVEPR           CMP % of Carcas
     C                     Z-ADD*ZERO     WAVFPR           CMP Fixed Cost
     C                     Z-ADD*ZERO     WAVHPR           CMP Grade Type
     C                     Z-ADD*ZERO     WAVIPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WAVJPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field RS Job
     C                     MOVEL*BLANK    WUAHVN 10
      * Define work field RS Program
     C                     MOVEL*BLANK    WUAGVN 10
      * Define work field RS User Added
     C                     MOVEL*BLANK    WUABVN 10
      * Define work field RS Date Added
     C                     Z-ADD*ZERO     WUABDT  70
      * Define work field RS Time Added
     C                     Z-ADD*ZERO     WUABTM  60
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCESNB           CMPC Comment Li
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEE8NB           CMMR Row Number
     C                     Z-ADD*ZERO     WEEGNB           CMMR Carc Wgt M
     C                     Z-ADD*ZERO     WEEHNB           CMMR Carc Wgt M
     C                     Z-ADD*ZERO     WEEINB           CMMR Carc Wgt M
     C                     Z-ADD*ZERO     WEEJNB           CMMR Live Wgt M
     C                     Z-ADD*ZERO     WEEKNB           CMMR Live Wgt M
     C                     Z-ADD*ZERO     WEAQPC           CMMR Std Dressi
     C                     Z-ADD*ZERO     WEEMNB           CMMR Sort Disco
     C                     Z-ADD*ZERO     WEE2NB           CMMR Unused Fie
     C                     Z-ADD*ZERO     WELJA1           CMMR Midpoint
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGE8NB           CMMR Row Number
     C                     Z-ADD*ZERO     WGE4NB           CMMC Column Num
     C                     Z-ADD*ZERO     WGA1PC           CMMC Lean Perce
     C                     Z-ADD*ZERO     WGE7NB           CMMC Backfat In
     C                     Z-ADD*ZERO     WGERNB           CMMC Premium Va
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local work field CMP Unused Price 2
     C                     Z-ADD*ZERO     YL0001  52
      * Define local work field CMP Unused Price 3
     C                     Z-ADD*ZERO     YL0002  52
      * Define local work field CMP Unused Sts 2
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field CMP Unused Sts 3
     C                     MOVEL*BLANK    YL0004  1
      *================================================================
     CSR         ZZEXIT    ENDSR
