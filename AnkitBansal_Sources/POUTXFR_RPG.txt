     H/TITLE Cpy Production Sched  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 04/28/09  Time  : 14:28:42
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDLMCPL1IF  E           K        DISK
      * RTV : PS Prod Dept Schedule     Retrieval index
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FPDJCCPL1IF  E           K        DISK
      * RTV : PS Prod Schedule          Retrieval index
      *
     FCAAQREL1IF  E           K        DISK
      * RTV : Company Defaults          Retrieval index       NV
      *
     FPDLMCPL0IF  E           K        DISK                      A
      * UPD : PS Prod Dept Schedule     Update index
      *
     FPDI8CPL0IF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
     FPDJCCPL0IF  E           K        DISK                      A
      * UPD : PS Prod Schedule          Update index
      *
     I@LMCPO1
      * PS Prod Dept Schedule     Retrieval index
      * Renamed input format fields
     I              LMAIC3                          WAAIC3
     I              LMV5ST                          WAV5ST
     I              LMELDT                          WAELDT
     I              LMR3CD                          WAR3CD
     I              LMRMPA                          WARMPA
     I              LMGFWG                          WAGFWG
     I              LMGGWG                          WAGGWG
     I              LMCLNB                          WACLNB
     I              LMGHWG                          WAGHWG
     I              LMDVNB                          WADVNB
     I              LMGNWG                          WAGNWG
     I              LMDZNB                          WADZNB
     I              LMGOWG                          WAGOWG
     I              LMD0NB                          WAD0NB
     I              LMGPWG                          WAGPWG
     I              LMD1NB                          WAD1NB
     I              LMGQWG                          WAGQWG
     I              LMD4NB                          WAD4NB
     I              LMGRWG                          WAGRWG
     I              LMTKST                          WATKST
     I              LMTLST                          WATLST
     I              LMTNST                          WATNST
     I              LMCD3S                          WACD3S
     I              LMTVST                          WATVST
     I              LMTWST                          WATWST
     I              LMUVST                          WAUVST
     I              LMUWST                          WAUWST
     I              LMUXST                          WAUXST
     I              LMVSST                          WAVSST
     I              LMAATM                          WAAATM
     I              LMAYNA                          WAAYNA
     I              LMA0NA                          WAA0NA
     I              LMAXDT                          WAAXDT
      *
     I@LMCPO0
      * PS Prod Dept Schedule     Update index
      * Renamed input format fields
     I              LMAIC3                          WBAIC3
     I              LMV5ST                          WBV5ST
     I              LMELDT                          WBELDT
     I              LMR3CD                          WBR3CD
     I              LMRMPA                          WBRMPA
     I              LMGFWG                          WBGFWG
     I              LMGGWG                          WBGGWG
     I              LMCLNB                          WBCLNB
     I              LMGHWG                          WBGHWG
     I              LMDVNB                          WBDVNB
     I              LMGNWG                          WBGNWG
     I              LMDZNB                          WBDZNB
     I              LMGOWG                          WBGOWG
     I              LMD0NB                          WBD0NB
     I              LMGPWG                          WBGPWG
     I              LMD1NB                          WBD1NB
     I              LMGQWG                          WBGQWG
     I              LMD4NB                          WBD4NB
     I              LMGRWG                          WBGRWG
     I              LMTKST                          WBTKST
     I              LMTLST                          WBTLST
     I              LMTNST                          WBTNST
     I              LMCD3S                          WBCD3S
     I              LMTVST                          WBTVST
     I              LMTWST                          WBTWST
     I              LMUVST                          WBUVST
     I              LMUWST                          WBUWST
     I              LMUXST                          WBUXST
     I              LMVSST                          WBVSST
     I              LMAATM                          WBAATM
     I              LMAYNA                          WBAYNA
     I              LMA0NA                          WBA0NA
     I              LMAXDT                          WBAXDT
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WCAIC3
     I              I8V5ST                          WCV5ST
     I              I8ELDT                          WCELDT
     I              I8HGCD                          WCHGCD
     I              I8AJCD                          WCAJCD
     I              I8GPDT                          WCGPDT
     I              I8WTSP                          WCWTSP
     I              I8QTSP                          WCQTSP
     I              I8DJPC                          WCDJPC
     I              I8F8WG                          WCF8WG
     I              I8WTIN                          WCWTIN
     I              I8D5NB                          WCD5NB
     I              I8DXWG                          WCDXWG
     I              I8B2NB                          WCB2NB
     I              I8WTCN                          WCWTCN
     I              I8PSCV                          WCPSCV
     I              I8SAWT                          WCSAWT
     I              I8B9NB                          WCB9NB
     I              I8D1WG                          WCD1WG
     I              I8CBNB                          WCCBNB
     I              I8EZWG                          WCEZWG
     I              I8CCNB                          WCCCNB
     I              I8E0WG                          WCE0WG
     I              I8D6NB                          WCD6NB
     I              I8OAWT                          WCOAWT
     I              I8CDNB                          WCCDNB
     I              I8UNW2                          WCUNW2
     I              I8CENB                          WCCENB
     I              I8F9WG                          WCF9WG
     I              I8BPNB                          WCBPNB
     I              I8GAWG                          WCGAWG
     I              I8BQNB                          WCBQNB
     I              I8GBWG                          WCGBWG
     I              I8BRNB                          WCBRNB
     I              I8GCWG                          WCGCWG
     I              I8BSNB                          WCBSNB
     I              I8GDWG                          WCGDWG
     I              I8BWNB                          WCBWNB
     I              I8GEWG                          WCGEWG
     I              I8PS6U                          WCPS6U
     I              I8WCST                          WCWCST
     I              I8WPST                          WCWPST
     I              I8B5ST                          WCB5ST
     I              I8TFST                          WCTFST
     I              I8TEST                          WCTEST
     I              I8THST                          WCTHST
     I              I8UDST                          WCUDST
     I              I8UFST                          WCUFST
     I              I8UGST                          WCUGST
     I              I8UHST                          WCUHST
     I              I8B6ST                          WCB6ST
     I              I8B7ST                          WCB7ST
     I              I8DVWG                          WCDVWG
     I              I8D7NB                          WCD7NB
     I              I8FCAD                          WCFCAD
     I              I8D9NB                          WCD9NB
     I              I8DWWG                          WCDWWG
     I              I8EANB                          WCEANB
     I              I8SHWT                          WCSHWT
     I              I8EBNB                          WCEBNB
     I              I8AVWT                          WCAVWT
     I              I8ECNB                          WCECNB
     I              I8WTON                          WCWTON
     I              I8EDNB                          WCEDNB
     I              I8FNWT                          WCFNWT
     I              I8EENB                          WCEENB
     I              I8QTAS                          WCQTAS
     I              I8EFNB                          WCEFNB
     I              I8WAIO                          WCWAIO
     I              I8EGNB                          WCEGNB
     I              I8R3CD                          WCR3CD
     I              I8RGNB                          WCRGNB
     I              I8RHNB                          WCRHNB
     I              I8RINB                          WCRINB
     I              I8XRCD                          WCXRCD
     I              I8UVST                          WCUVST
     I              I8UWST                          WCUWST
     I              I8UXST                          WCUXST
     I              I8VSST                          WCVSST
     I              I8AATM                          WCAATM
     I              I8AYNA                          WCAYNA
     I              I8A0NA                          WCA0NA
     I              I8AXDT                          WCAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WDAIC3
     I              I8V5ST                          WDV5ST
     I              I8ELDT                          WDELDT
     I              I8HGCD                          WDHGCD
     I              I8AJCD                          WDAJCD
     I              I8GPDT                          WDGPDT
     I              I8WTSP                          WDWTSP
     I              I8QTSP                          WDQTSP
     I              I8DJPC                          WDDJPC
     I              I8F8WG                          WDF8WG
     I              I8WTIN                          WDWTIN
     I              I8D5NB                          WDD5NB
     I              I8DXWG                          WDDXWG
     I              I8B2NB                          WDB2NB
     I              I8WTCN                          WDWTCN
     I              I8PSCV                          WDPSCV
     I              I8SAWT                          WDSAWT
     I              I8B9NB                          WDB9NB
     I              I8D1WG                          WDD1WG
     I              I8CBNB                          WDCBNB
     I              I8EZWG                          WDEZWG
     I              I8CCNB                          WDCCNB
     I              I8E0WG                          WDE0WG
     I              I8D6NB                          WDD6NB
     I              I8OAWT                          WDOAWT
     I              I8CDNB                          WDCDNB
     I              I8UNW2                          WDUNW2
     I              I8CENB                          WDCENB
     I              I8F9WG                          WDF9WG
     I              I8BPNB                          WDBPNB
     I              I8GAWG                          WDGAWG
     I              I8BQNB                          WDBQNB
     I              I8GBWG                          WDGBWG
     I              I8BRNB                          WDBRNB
     I              I8GCWG                          WDGCWG
     I              I8BSNB                          WDBSNB
     I              I8GDWG                          WDGDWG
     I              I8BWNB                          WDBWNB
     I              I8GEWG                          WDGEWG
     I              I8PS6U                          WDPS6U
     I              I8WCST                          WDWCST
     I              I8WPST                          WDWPST
     I              I8B5ST                          WDB5ST
     I              I8TFST                          WDTFST
     I              I8TEST                          WDTEST
     I              I8THST                          WDTHST
     I              I8UDST                          WDUDST
     I              I8UFST                          WDUFST
     I              I8UGST                          WDUGST
     I              I8UHST                          WDUHST
     I              I8B6ST                          WDB6ST
     I              I8B7ST                          WDB7ST
     I              I8DVWG                          WDDVWG
     I              I8D7NB                          WDD7NB
     I              I8FCAD                          WDFCAD
     I              I8D9NB                          WDD9NB
     I              I8DWWG                          WDDWWG
     I              I8EANB                          WDEANB
     I              I8SHWT                          WDSHWT
     I              I8EBNB                          WDEBNB
     I              I8AVWT                          WDAVWT
     I              I8ECNB                          WDECNB
     I              I8WTON                          WDWTON
     I              I8EDNB                          WDEDNB
     I              I8FNWT                          WDFNWT
     I              I8EENB                          WDEENB
     I              I8QTAS                          WDQTAS
     I              I8EFNB                          WDEFNB
     I              I8WAIO                          WDWAIO
     I              I8EGNB                          WDEGNB
     I              I8R3CD                          WDR3CD
     I              I8RGNB                          WDRGNB
     I              I8RHNB                          WDRHNB
     I              I8RINB                          WDRINB
     I              I8XRCD                          WDXRCD
     I              I8UVST                          WDUVST
     I              I8UWST                          WDUWST
     I              I8UXST                          WDUXST
     I              I8VSST                          WDVSST
     I              I8AATM                          WDAATM
     I              I8AYNA                          WDAYNA
     I              I8A0NA                          WDA0NA
     I              I8AXDT                          WDAXDT
      *
     I@JCCPVC
      * PS Prod Schedule          Retrieval index
      * Renamed input format fields
     I              JCAIC3                          WEAIC3
     I              JCV5ST                          WEV5ST
     I              JCELDT                          WEELDT
     I              JCHVHD                          WEHVHD
     I              JCZ6NB                          WEZ6NB
     I              JCZ7NB                          WEZ7NB
     I              JCDGPC                          WEDGPC
     I              JCAVCW                          WEAVCW
     I              JCDIPC                          WEDIPC
     I              JCZ0NB                          WEZ0NB
     I              JCAVLE                          WEAVLE
     I              JCECWG                          WEECWG
     I              JCUVST                          WEUVST
     I              JCUWST                          WEUWST
     I              JCUXST                          WEUXST
     I              JCVSST                          WEVSST
     I              JCAATM                          WEAATM
     I              JCAYNA                          WEAYNA
     I              JCA0NA                          WEA0NA
     I              JCAXDT                          WEAXDT
      *
     I@JCCPVB
      * PS Prod Schedule          Update index
      * Renamed input format fields
     I              JCAIC3                          WFAIC3
     I              JCV5ST                          WFV5ST
     I              JCELDT                          WFELDT
     I              JCHVHD                          WFHVHD
     I              JCZ6NB                          WFZ6NB
     I              JCZ7NB                          WFZ7NB
     I              JCDGPC                          WFDGPC
     I              JCAVCW                          WFAVCW
     I              JCDIPC                          WFDIPC
     I              JCZ0NB                          WFZ0NB
     I              JCAVLE                          WFAVLE
     I              JCECWG                          WFECWG
     I              JCUVST                          WFUVST
     I              JCUWST                          WFUWST
     I              JCUXST                          WFUXST
     I              JCVSST                          WFVSST
     I              JCAATM                          WFAATM
     I              JCAYNA                          WFAYNA
     I              JCA0NA                          WFA0NA
     I              JCAXDT                          WFAXDT
      *
     I@AQREB9
      * Company Defaults          Retrieval index       NV
      * Renamed input format fields
     I              AQAIC3                          WGAIC3
     I              AQASVA                          WGASVA
     I              AQAIST                          WGAIST
     I              AQA3ST                          WGA3ST
     I              AQAVST                          WGAVST
     I              AQBYNA                          WGBYNA
     I              AQB6NA                          WGB6NA
     I              AQBZNA                          WGBZNA
     I              AQJ8ST                          WGJ8ST
     I              AQJ7NA                          WGJ7NA
     I              AQJ8NA                          WGJ8NA
     I              AQJ9NA                          WGJ9NA
     I              AQKANA                          WGKANA
     I              AQLWCD                          WGLWCD
     I              AQEJTX                          WGEJTX
     I              AQDGPC                          WGDGPC
     I              AQBFCD                          WGBFCD
     I              AQIDCD                          WGIDCD
     I              AQBSCD                          WGBSCD
     I              AQTOCD                          WGTOCD
     I              AQTPCD                          WGTPCD
     I              AQR4CD                          WGR4CD
     I              AQUVST                          WGUVST
     I              AQUWST                          WGUWST
     I              AQUXST                          WGUXST
     I              AQVSST                          WGVSST
     I              AQAATM                          WGAATM
     I              AQAYNA                          WGAYNA
     I              AQA0NA                          WGA0NA
     I              AQAXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDLM1    E DSPDLMCPL0
      * UPD : PS Prod Dept Schedule     Update index
      * Renamed input format fields
     I              LMAIC3                          WBAIC3
     I              LMV5ST                          WBV5ST
     I              LMELDT                          WBELDT
     I              LMR3CD                          WBR3CD
     I              LMRMPA                          WBRMPA
     I              LMGFWG                          WBGFWG
     I              LMGGWG                          WBGGWG
     I              LMCLNB                          WBCLNB
     I              LMGHWG                          WBGHWG
     I              LMDVNB                          WBDVNB
     I              LMGNWG                          WBGNWG
     I              LMDZNB                          WBDZNB
     I              LMGOWG                          WBGOWG
     I              LMD0NB                          WBD0NB
     I              LMGPWG                          WBGPWG
     I              LMD1NB                          WBD1NB
     I              LMGQWG                          WBGQWG
     I              LMD4NB                          WBD4NB
     I              LMGRWG                          WBGRWG
     I              LMTKST                          WBTKST
     I              LMTLST                          WBTLST
     I              LMTNST                          WBTNST
     I              LMCD3S                          WBCD3S
     I              LMTVST                          WBTVST
     I              LMTWST                          WBTWST
     I              LMUVST                          WBUVST
     I              LMUWST                          WBUWST
     I              LMUXST                          WBUXST
     I              LMVSST                          WBVSST
     I              LMAATM                          WBAATM
     I              LMAYNA                          WBAYNA
     I              LMA0NA                          WBA0NA
     I              LMAXDT                          WBAXDT
      *
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WDAIC3
     I              I8V5ST                          WDV5ST
     I              I8ELDT                          WDELDT
     I              I8HGCD                          WDHGCD
     I              I8AJCD                          WDAJCD
     I              I8GPDT                          WDGPDT
     I              I8WTSP                          WDWTSP
     I              I8QTSP                          WDQTSP
     I              I8DJPC                          WDDJPC
     I              I8F8WG                          WDF8WG
     I              I8WTIN                          WDWTIN
     I              I8D5NB                          WDD5NB
     I              I8DXWG                          WDDXWG
     I              I8B2NB                          WDB2NB
     I              I8WTCN                          WDWTCN
     I              I8PSCV                          WDPSCV
     I              I8SAWT                          WDSAWT
     I              I8B9NB                          WDB9NB
     I              I8D1WG                          WDD1WG
     I              I8CBNB                          WDCBNB
     I              I8EZWG                          WDEZWG
     I              I8CCNB                          WDCCNB
     I              I8E0WG                          WDE0WG
     I              I8D6NB                          WDD6NB
     I              I8OAWT                          WDOAWT
     I              I8CDNB                          WDCDNB
     I              I8UNW2                          WDUNW2
     I              I8CENB                          WDCENB
     I              I8F9WG                          WDF9WG
     I              I8BPNB                          WDBPNB
     I              I8GAWG                          WDGAWG
     I              I8BQNB                          WDBQNB
     I              I8GBWG                          WDGBWG
     I              I8BRNB                          WDBRNB
     I              I8GCWG                          WDGCWG
     I              I8BSNB                          WDBSNB
     I              I8GDWG                          WDGDWG
     I              I8BWNB                          WDBWNB
     I              I8GEWG                          WDGEWG
     I              I8PS6U                          WDPS6U
     I              I8WCST                          WDWCST
     I              I8WPST                          WDWPST
     I              I8B5ST                          WDB5ST
     I              I8TFST                          WDTFST
     I              I8TEST                          WDTEST
     I              I8THST                          WDTHST
     I              I8UDST                          WDUDST
     I              I8UFST                          WDUFST
     I              I8UGST                          WDUGST
     I              I8UHST                          WDUHST
     I              I8B6ST                          WDB6ST
     I              I8B7ST                          WDB7ST
     I              I8DVWG                          WDDVWG
     I              I8D7NB                          WDD7NB
     I              I8FCAD                          WDFCAD
     I              I8D9NB                          WDD9NB
     I              I8DWWG                          WDDWWG
     I              I8EANB                          WDEANB
     I              I8SHWT                          WDSHWT
     I              I8EBNB                          WDEBNB
     I              I8AVWT                          WDAVWT
     I              I8ECNB                          WDECNB
     I              I8WTON                          WDWTON
     I              I8EDNB                          WDEDNB
     I              I8FNWT                          WDFNWT
     I              I8EENB                          WDEENB
     I              I8QTAS                          WDQTAS
     I              I8EFNB                          WDEFNB
     I              I8WAIO                          WDWAIO
     I              I8EGNB                          WDEGNB
     I              I8R3CD                          WDR3CD
     I              I8RGNB                          WDRGNB
     I              I8RHNB                          WDRHNB
     I              I8RINB                          WDRINB
     I              I8XRCD                          WDXRCD
     I              I8UVST                          WDUVST
     I              I8UWST                          WDUWST
     I              I8UXST                          WDUXST
     I              I8VSST                          WDVSST
     I              I8AATM                          WDAATM
     I              I8AYNA                          WDAYNA
     I              I8A0NA                          WDA0NA
     I              I8AXDT                          WDAXDT
      *
     IQPDJC1    E DSPDJCCPL0
      * UPD : PS Prod Schedule          Update index
      * Renamed input format fields
     I              JCAIC3                          WFAIC3
     I              JCV5ST                          WFV5ST
     I              JCELDT                          WFELDT
     I              JCHVHD                          WFHVHD
     I              JCZ6NB                          WFZ6NB
     I              JCZ7NB                          WFZ7NB
     I              JCDGPC                          WFDGPC
     I              JCAVCW                          WFAVCW
     I              JCDIPC                          WFDIPC
     I              JCZ0NB                          WFZ0NB
     I              JCAVLE                          WFAVLE
     I              JCECWG                          WFECWG
     I              JCUVST                          WFUVST
     I              JCUWST                          WFUWST
     I              JCUXST                          WFUXST
     I              JCVSST                          WFVSST
     I              JCAATM                          WFAATM
     I              JCAYNA                          WFAYNA
     I              JCA0NA                          WFA0NA
     I              JCAXDT                          WFAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: PS Prod Schedule
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Production Type
     I                                        3   3 P1V5ST
      * I :  Production Date
     I                                    P   4   70P1ELDT
     IP2PARM      DS
      * I :  Date To               USR
     I                                    P   1   40P2JFDT
     IP3PARM      DS
      * I :  Kill Plan USR
     I                                    P   1   30P3TUNX
     IP4PARM      DS
      * I :  Cut Plan USR
     I                                    P   1   30P4TVNX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1V5ST    PARM           WP0002  1        Production Type
     C           P1ELDT    PARM           WP0003  70       Production Date
     C           P2JFDT    PARM           WP0004  70       Date To
     C           P3TUNX    PARM           WP0005  50       Kill Plan USR
     C           P4TVNX    PARM           WP0006  50       Cut Plan USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Cpy Production Sched  XF
      * Cpy Production Sched  RT - PS Prod Dept Schedule  * 
     C                     EXSR SARVGN
      * Cpy Production Sched  RT - PS Prod Item Schedule  * 
     C                     EXSR SCRVGN
      * Cpy Production Sched  RT - PS Prod Schedule  * 
     C                     EXSR SERVGN
      * Upd Kill/Cut Pln 4OMS XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PLDBXFR'              90  Upd Kill/Cut Pl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C                     PARM P2JFDT    WQ0002  70       Date
     C                     PARM P3TUNX    WQ0003  50       Hog Volume
     C                     PARM P4TVNX    WQ0004  50       Hog Volume USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLDBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Cpy Production Sched  RT - PS Prod Dept Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAV5ST    WQSA02           Production Type
     C           *LIKE     DEFN WAELDT    WQSA03           Production Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Production Type
     C                     KFLD           WQSA03           Production Date
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     MOVELP1V5ST    WQSA02           Production Type
     C                     Z-ADDP1ELDT    WQSA03           Production Date
      * Establish starting position
     C           KRSSA     SETLL@LMCPO1                    *
     C           KRSSA     READE@LMCPO1                  90*
      * Data record not found
     C   90                MOVEL'USR2507' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Create PS Prod Dept Sched - PS Prod Dept Schedule  * 
     C                     EXSR SBCRRC
     C           KRSSA     READE@LMCPO1                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Create PS Prod Dept Sched - PS Prod Dept Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @LMCPO0
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     MOVELWAV5ST    WBV5ST           Production Type
     C                     Z-ADDP2JFDT    WBELDT           Production Date
     C                     MOVELWAR3CD    WBR3CD           Department Code
     C                     Z-ADDWARMPA    WBRMPA           CDS RM Pieces A
     C                     Z-ADDWAGFWG    WBGFWG           CDS RM Weight A
     C                     Z-ADDWAGGWG    WBGGWG           CDS Avg Piece W
     C                     Z-ADDWACLNB    WBCLNB           CDS CV Pieces A
     C                     Z-ADDWAGHWG    WBGHWG           CDS CV Weight A
     C                     Z-ADDWADVNB    WBDVNB           CDS Pieces Unus
     C                     Z-ADDWAGNWG    WBGNWG           CDS Weight Unus
     C                     Z-ADDWADZNB    WBDZNB           CDS Pieces Unus
     C                     Z-ADDWAGOWG    WBGOWG           CDS Weight Unus
     C                     Z-ADDWAD0NB    WBD0NB           CDS Pieces Unus
     C                     Z-ADDWAGPWG    WBGPWG           CDS Weight Unus
     C                     Z-ADDWAD1NB    WBD1NB           CDS Pieces Unus
     C                     Z-ADDWAGQWG    WBGQWG           CDS Weight Unus
     C                     Z-ADDWAD4NB    WBD4NB           CDS Pieces Unus
     C                     Z-ADDWAGRWG    WBGRWG           CDS Weight Unus
     C                     MOVELWATKST    WBTKST           CDS Department
     C                     MOVELWATLST    WBTLST           CDS Unused Sts
     C                     MOVELWATNST    WBTNST           CDS Unused Sts
     C                     MOVELWACD3S    WBCD3S           CDS Unused Sts
     C                     MOVELWATVST    WBTVST           CDS Unused Sts
     C                     MOVELWATWST    WBTWST           CDS Unused Sts
     C                     MOVELWAUVST    WBUVST           EDI Status 1
     C                     MOVELWAUWST    WBUWST           EDI Status 2
     C                     MOVELWAUXST    WBUXST           EDI Status 3
     C                     MOVELWAVSST    WBVSST           Record Status
     C                     Z-ADDWAAATM    WBAATM           Job Time
     C                     MOVELWAAYNA    WBAYNA           User Id
     C                     MOVELWAA0NA    WBA0NA           Job Name
     C                     Z-ADDWAAXDT    WBAXDT           Job Date
      *
      * USER: Processing before Data update
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WBVSST           Record Status
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
     C           KLCRSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBV5ST           Production Type
     C                     KFLD           WBELDT           Production Date
     C                     KFLD           WBR3CD           Department Code
      * Check for duplicate primary key
     C           KLCRSB    SETLL@LMCPO0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2508' W0RTN   7
      * Send message 'PS Prod Dept Schedule  EX'
     C                     MOVEL'USR2508' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@LMCPO0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Cpy Production Sched  RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCV5ST    WQSC02           Production Type
     C           *LIKE     DEFN WCELDT    WQSC03           Production Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Production Type
     C                     KFLD           WQSC03           Production Date
      * Setup key
     C                     Z-ADDP1AIC3    WQSC01           Company Number
     C                     MOVELP1V5ST    WQSC02           Production Type
     C                     Z-ADDP1ELDT    WQSC03           Production Date
      * Establish starting position
     C           KRSSC     SETLL@I8CPUS                    *
     C           KRSSC     READE@I8CPUS                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.PS Item Id is FG *All Base
     C           WCWCST    IFEQ 'FGB'                      *IF
     C           WCWCST    OREQ 'FBC'
      * U1LP Crt Prd Plan Dtl CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0001           Company Number
     C                     MOVELWCV5ST    WL0002    P      Production Type
     C                     Z-ADDP2JFDT    WL0003           Production Date
     C                     Z-ADDWCHGCD    WL0004           Item Code
     C                     MOVELWCAJCD    WL0005    P      Warehouse Code
     C                     Z-ADDWCGPDT    WL0006           PS Available Sh
     C                     Z-ADDWCWTSP    WL0007           PS Weight Plann
     C                     Z-ADDWCQTSP    WL0008           PS Pieces Plann
     C                     Z-ADDWCDJPC    WL0009           PS % of Carcass
     C                     Z-ADDWCF8WG    WL0010           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WL0011           PS Weight Inv O
     C                     Z-ADD*ZERO     WL0012           PS Pieces Inv O
     C                     Z-ADDWCDXWG    WL0013           PS Weight Stand
     C                     Z-ADDWCB2NB    WL0014           PS Pieces Stand
     C                     Z-ADD*ZERO     WL0015           PS Weight Conve
     C                     Z-ADD*ZERO     WL0016           PS Pieces Conve
     C                     Z-ADD*ZERO     WL0017           PS Weight Shipp
     C                     Z-ADD*ZERO     WL0018           PS Pieces Shipp
     C                     Z-ADD*ZERO     WL0019           PS Weight Prod
     C                     Z-ADD*ZERO     WL0020           PS Pieces Prod
     C                     Z-ADD*ZERO     WL0021           PS Weight Inv A
     C                     Z-ADD*ZERO     WL0022           PS Pieces Inv A
     C                     Z-ADD*ZERO     WL0023           PS Weight Ship
     C                     Z-ADD*ZERO     WL0024           PS Pieces Ship
     C                     Z-ADD*ZERO     WL0025           PS Weight Prod
     C                     Z-ADD*ZERO     WL0026           PS Pieces Prod
     C                     Z-ADD*ZERO     WL0027           PS Weight Inv A
     C                     Z-ADD*ZERO     WL0028           PS Pieces Inv A
     C                     Z-ADDWCF9WG    WL0029           PS Unit Weight
     C                     Z-ADD*ZERO     WL0030           PS Pieces Whse
     C                     Z-ADD*ZERO     WL0031           PS Weight Whse
     C                     Z-ADDWCBQNB    WL0032           PS Pieces Unuse
     C                     Z-ADDWCGBWG    WL0033           PS Weight Unuse
     C                     Z-ADDWCBRNB    WL0034           PS Pieces Unuse
     C                     Z-ADDWCGCWG    WL0035           PS Weight Unuse
     C                     Z-ADDWCBSNB    WL0036           PS Pieces Unuse
     C                     Z-ADDWCGDWG    WL0037           PS Weight Unuse
     C                     Z-ADDWCBWNB    WL0038           PS Pieces Unuse
     C                     Z-ADDWCGEWG    WL0039           PS Weight Unuse
     C                     Z-ADDWCPS6U    WL0040           PS Pieces Unuse
     C                     MOVELWCWCST    WL0041    P      PS Item Id
     C                     MOVELWCWPST    WL0042    P      Warehouse Type
     C                     MOVELWCB5ST    WL0043    P      PS Lock Status
     C                     MOVELWCTFST    WL0044    P      PS Export/Domes
     C                     MOVELWCTEST    WL0045    P      PS Print On Sch
     C                     MOVELWCTHST    WL0046    P      PS Piece Count
     C                     MOVELWCUDST    WL0047    P      PS Unused Sts 1
     C                     MOVELWCUFST    WL0048    P      PS Unused Sts 2
     C                     MOVELWCUGST    WL0049    P      PS Unused Sts 3
     C                     MOVELWCUHST    WL0050    P      PS Unused Sts 4
     C                     MOVELWCB6ST    WL0051    P      PS Item Sched N
     C                     MOVELWCB7ST    WL0052    P      PS Production W
     C                     Z-ADD*ZERO     WL0053           PS Weight Order
     C                     Z-ADD*ZERO     WL0054           PS Pieces Order
     C                     Z-ADD*ZERO     WL0055           PS Weight FC Ad
     C                     Z-ADD*ZERO     WL0056           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WL0057           PS Weight FX Ad
     C                     Z-ADD*ZERO     WL0058           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WL0059           PS Weight Sched
     C                     Z-ADD*ZERO     WL0060           PS Pieces Sched
     C                     Z-ADD*ZERO     WL0061           PS Weight Avail
     C                     Z-ADD*ZERO     WL0062           PS Pieces Avail
     C                     Z-ADD*ZERO     WL0063           PS Weight Produ
     C                     Z-ADD*ZERO     WL0064           PS Pieces Produ
     C                     Z-ADD*ZERO     WL0065           PS Weight Fab N
     C                     Z-ADD*ZERO     WL0066           PS Pieces Fab N
     C                     Z-ADD*ZERO     WL0067           PS Weight Sched
     C                     Z-ADD*ZERO     WL0068           PS Pieces Sched
     C                     Z-ADD*ZERO     WL0069           PS Weight Sched
     C                     Z-ADD*ZERO     WL0070           PS Pieces Sched
     C                     MOVELWCR3CD    WL0071    P      Department Code
     C                     Z-ADDWCRGNB    WL0072           Item Structure
     C                     Z-ADDWCRHNB    WL0073           Item Structure
     C                     Z-ADDWCRINB    WL0074           Item Structure
     C                     MOVELWCXRCD    WL0075    P      Primal Group Co
     C                     MOVELWCUVST    WL0076    P      EDI Status 1
     C                     MOVELWCUWST    WL0077    P      EDI Status 2
     C                     MOVELWCUXST    WL0078    P      EDI Status 3
     C                     MOVELWCVSST    WL0079    P      Record Status
     C                     Z-ADDWCAATM    WL0080           Job Time
     C                     MOVELWCAYNA    WL0081    P      User Id
     C                     MOVELWCA0NA    WL0082    P      Job Name
     C                     Z-ADDWCAXDT    WL0083           Job Date
     C                     EXSR SDCRRC
     C                     ELSE
      * CASE: DB1.PS Item Id is FG *All Conv/Fab
     C           WCWCST    IFEQ 'FCV'                      *IF
     C           WCWCST    OREQ 'FCC'
     C           WCWCST    OREQ 'FFB'
     C           WCWCST    OREQ 'FFC'
      * U1LP Crt Prd Plan Dtl CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0001           Company Number
     C                     MOVELWCV5ST    WL0002    P      Production Type
     C                     Z-ADDP2JFDT    WL0003           Production Date
     C                     Z-ADDWCHGCD    WL0004           Item Code
     C                     MOVELWCAJCD    WL0005    P      Warehouse Code
     C                     Z-ADDWCGPDT    WL0006           PS Available Sh
     C                     Z-ADDWCWTSP    WL0007           PS Weight Plann
     C                     Z-ADDWCQTSP    WL0008           PS Pieces Plann
     C                     Z-ADDWCDJPC    WL0009           PS % of Carcass
     C                     Z-ADDWCF8WG    WL0010           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WL0011           PS Weight Inv O
     C                     Z-ADD*ZERO     WL0012           PS Pieces Inv O
     C                     Z-ADD*ZERO     WL0013           PS Weight Stand
     C                     Z-ADD*ZERO     WL0014           PS Pieces Stand
     C                     Z-ADD*ZERO     WL0015           PS Weight Conve
     C                     Z-ADD*ZERO     WL0016           PS Pieces Conve
     C                     Z-ADD*ZERO     WL0017           PS Weight Shipp
     C                     Z-ADD*ZERO     WL0018           PS Pieces Shipp
     C                     Z-ADD*ZERO     WL0019           PS Weight Prod
     C                     Z-ADD*ZERO     WL0020           PS Pieces Prod
     C                     Z-ADD*ZERO     WL0021           PS Weight Inv A
     C                     Z-ADD*ZERO     WL0022           PS Pieces Inv A
     C                     Z-ADD*ZERO     WL0023           PS Weight Ship
     C                     Z-ADD*ZERO     WL0024           PS Pieces Ship
     C                     Z-ADD*ZERO     WL0025           PS Weight Prod
     C                     Z-ADD*ZERO     WL0026           PS Pieces Prod
     C                     Z-ADD*ZERO     WL0027           PS Weight Inv A
     C                     Z-ADD*ZERO     WL0028           PS Pieces Inv A
     C                     Z-ADDWCF9WG    WL0029           PS Unit Weight
     C                     Z-ADD*ZERO     WL0030           PS Pieces Whse
     C                     Z-ADD*ZERO     WL0031           PS Weight Whse
     C                     Z-ADDWCBQNB    WL0032           PS Pieces Unuse
     C                     Z-ADDWCGBWG    WL0033           PS Weight Unuse
     C                     Z-ADDWCBRNB    WL0034           PS Pieces Unuse
     C                     Z-ADDWCGCWG    WL0035           PS Weight Unuse
     C                     Z-ADDWCBSNB    WL0036           PS Pieces Unuse
     C                     Z-ADDWCGDWG    WL0037           PS Weight Unuse
     C                     Z-ADDWCBWNB    WL0038           PS Pieces Unuse
     C                     Z-ADDWCGEWG    WL0039           PS Weight Unuse
     C                     Z-ADDWCPS6U    WL0040           PS Pieces Unuse
     C                     MOVELWCWCST    WL0041    P      PS Item Id
     C                     MOVELWCWPST    WL0042    P      Warehouse Type
     C                     MOVELWCB5ST    WL0043    P      PS Lock Status
     C                     MOVELWCTFST    WL0044    P      PS Export/Domes
     C                     MOVELWCTEST    WL0045    P      PS Print On Sch
     C                     MOVELWCTHST    WL0046    P      PS Piece Count
     C                     MOVELWCUDST    WL0047    P      PS Unused Sts 1
     C                     MOVELWCUFST    WL0048    P      PS Unused Sts 2
     C                     MOVELWCUGST    WL0049    P      PS Unused Sts 3
     C                     MOVELWCUHST    WL0050    P      PS Unused Sts 4
     C                     MOVELWCB6ST    WL0051    P      PS Item Sched N
     C                     MOVELWCB7ST    WL0052    P      PS Production W
     C                     Z-ADD*ZERO     WL0053           PS Weight Order
     C                     Z-ADD*ZERO     WL0054           PS Pieces Order
     C                     Z-ADD*ZERO     WL0055           PS Weight FC Ad
     C                     Z-ADD*ZERO     WL0056           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WL0057           PS Weight FX Ad
     C                     Z-ADD*ZERO     WL0058           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WL0059           PS Weight Sched
     C                     Z-ADD*ZERO     WL0060           PS Pieces Sched
     C                     Z-ADD*ZERO     WL0061           PS Weight Avail
     C                     Z-ADD*ZERO     WL0062           PS Pieces Avail
     C                     Z-ADD*ZERO     WL0063           PS Weight Produ
     C                     Z-ADD*ZERO     WL0064           PS Pieces Produ
     C                     Z-ADD*ZERO     WL0065           PS Weight Fab N
     C                     Z-ADD*ZERO     WL0066           PS Pieces Fab N
     C                     Z-ADD*ZERO     WL0067           PS Weight Sched
     C                     Z-ADD*ZERO     WL0068           PS Pieces Sched
     C                     Z-ADD*ZERO     WL0069           PS Weight Sched
     C                     Z-ADD*ZERO     WL0070           PS Pieces Sched
     C                     MOVELWCR3CD    WL0071    P      Department Code
     C                     Z-ADDWCRGNB    WL0072           Item Structure
     C                     Z-ADDWCRHNB    WL0073           Item Structure
     C                     Z-ADDWCRINB    WL0074           Item Structure
     C                     MOVELWCXRCD    WL0075    P      Primal Group Co
     C                     MOVELWCUVST    WL0076    P      EDI Status 1
     C                     MOVELWCUWST    WL0077    P      EDI Status 2
     C                     MOVELWCUXST    WL0078    P      EDI Status 3
     C                     MOVELWCVSST    WL0079    P      Record Status
     C                     Z-ADDWCAATM    WL0080           Job Time
     C                     MOVELWCAYNA    WL0081    P      User Id
     C                     MOVELWCA0NA    WL0082    P      Job Name
     C                     Z-ADDWCAXDT    WL0083           Job Date
     C                     EXSR SDCRRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@I8CPUS                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * U1LP Crt Prd Plan Dtl CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADDWL0001    WDAIC3           Company Number
     C                     MOVELWL0002    WDV5ST           Production Type
     C                     Z-ADDWL0003    WDELDT           Production Date
     C                     Z-ADDWL0004    WDHGCD           Item Code
     C                     MOVELWL0005    WDAJCD           Warehouse Code
     C                     Z-ADDWL0006    WDGPDT           PS Available Sh
     C                     Z-ADDWL0007    WDWTSP           PS Weight Plann
     C                     Z-ADDWL0008    WDQTSP           PS Pieces Plann
     C                     Z-ADDWL0009    WDDJPC           PS % of Carcass
     C                     Z-ADDWL0010    WDF8WG           PS Avg Piece Wg
     C                     Z-ADDWL0011    WDWTIN           PS Weight Inv O
     C                     Z-ADDWL0012    WDD5NB           PS Pieces Inv O
     C                     Z-ADDWL0013    WDDXWG           PS Weight Stand
     C                     Z-ADDWL0014    WDB2NB           PS Pieces Stand
     C                     Z-ADDWL0015    WDWTCN           PS Weight Conve
     C                     Z-ADDWL0016    WDPSCV           PS Pieces Conve
     C                     Z-ADDWL0017    WDSAWT           PS Weight Shipp
     C                     Z-ADDWL0018    WDB9NB           PS Pieces Shipp
     C                     Z-ADDWL0019    WDD1WG           PS Weight Prod
     C                     Z-ADDWL0020    WDCBNB           PS Pieces Prod
     C                     Z-ADDWL0021    WDEZWG           PS Weight Inv A
     C                     Z-ADDWL0022    WDCCNB           PS Pieces Inv A
     C                     Z-ADDWL0023    WDE0WG           PS Weight Ship
     C                     Z-ADDWL0024    WDD6NB           PS Pieces Ship
     C                     Z-ADDWL0025    WDOAWT           PS Weight Prod
     C                     Z-ADDWL0026    WDCDNB           PS Pieces Prod
     C                     Z-ADDWL0027    WDUNW2           PS Weight Inv A
     C                     Z-ADDWL0028    WDCENB           PS Pieces Inv A
     C                     Z-ADDWL0029    WDF9WG           PS Unit Weight
     C                     Z-ADDWL0030    WDBPNB           PS Pieces Whse
     C                     Z-ADDWL0031    WDGAWG           PS Weight Whse
     C                     Z-ADDWL0032    WDBQNB           PS Pieces Unuse
     C                     Z-ADDWL0033    WDGBWG           PS Weight Unuse
     C                     Z-ADDWL0034    WDBRNB           PS Pieces Unuse
     C                     Z-ADDWL0035    WDGCWG           PS Weight Unuse
     C                     Z-ADDWL0036    WDBSNB           PS Pieces Unuse
     C                     Z-ADDWL0037    WDGDWG           PS Weight Unuse
     C                     Z-ADDWL0038    WDBWNB           PS Pieces Unuse
     C                     Z-ADDWL0039    WDGEWG           PS Weight Unuse
     C                     Z-ADDWL0040    WDPS6U           PS Pieces Unuse
     C                     MOVELWL0041    WDWCST           PS Item Id
     C                     MOVELWL0042    WDWPST           Warehouse Type
     C                     MOVELWL0043    WDB5ST           PS Lock Status
     C                     MOVELWL0044    WDTFST           PS Export/Domes
     C                     MOVELWL0045    WDTEST           PS Print On Sch
     C                     MOVELWL0046    WDTHST           PS Piece Count
     C                     MOVELWL0047    WDUDST           PS Unused Sts 1
     C                     MOVELWL0048    WDUFST           PS Unused Sts 2
     C                     MOVELWL0049    WDUGST           PS Unused Sts 3
     C                     MOVELWL0050    WDUHST           PS Unused Sts 4
     C                     MOVELWL0051    WDB6ST           PS Item Sched N
     C                     MOVELWL0052    WDB7ST           PS Production W
     C                     Z-ADDWL0053    WDDVWG           PS Weight Order
     C                     Z-ADDWL0054    WDD7NB           PS Pieces Order
     C                     Z-ADDWL0055    WDFCAD           PS Weight FC Ad
     C                     Z-ADDWL0056    WDD9NB           PS Pieces FC Ad
     C                     Z-ADDWL0057    WDDWWG           PS Weight FX Ad
     C                     Z-ADDWL0058    WDEANB           PS Pieces FX Ad
     C                     Z-ADDWL0059    WDSHWT           PS Weight Sched
     C                     Z-ADDWL0060    WDEBNB           PS Pieces Sched
     C                     Z-ADDWL0061    WDAVWT           PS Weight Avail
     C                     Z-ADDWL0062    WDECNB           PS Pieces Avail
     C                     Z-ADDWL0063    WDWTON           PS Weight Produ
     C                     Z-ADDWL0064    WDEDNB           PS Pieces Produ
     C                     Z-ADDWL0065    WDFNWT           PS Weight Fab N
     C                     Z-ADDWL0066    WDEENB           PS Pieces Fab N
     C                     Z-ADDWL0067    WDQTAS           PS Weight Sched
     C                     Z-ADDWL0068    WDEFNB           PS Pieces Sched
     C                     Z-ADDWL0069    WDWAIO           PS Weight Sched
     C                     Z-ADDWL0070    WDEGNB           PS Pieces Sched
     C                     MOVELWL0071    WDR3CD           Department Code
     C                     Z-ADDWL0072    WDRGNB           Item Structure
     C                     Z-ADDWL0073    WDRHNB           Item Structure
     C                     Z-ADDWL0074    WDRINB           Item Structure
     C                     MOVELWL0075    WDXRCD           Primal Group Co
     C                     MOVELWL0076    WDUVST           EDI Status 1
     C                     MOVELWL0077    WDUWST           EDI Status 2
     C                     MOVELWL0078    WDUXST           EDI Status 3
     C                     MOVELWL0079    WDVSST           Record Status
     C                     Z-ADDWL0080    WDAATM           Job Time
     C                     MOVELWL0081    WDAYNA           User Id
     C                     MOVELWL0082    WDA0NA           Job Name
     C                     Z-ADDWL0083    WDAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WDVSST           Record Status
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     MOVEL'N'       WDB5ST           PS Lock Status
     C           KLCRSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDV5ST           Production Type
     C                     KFLD           WDELDT           Production Date
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSD    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Cpy Production Sched  RT - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEV5ST           Production Type
     C                     KFLD           WEELDT           Production Date
      * Setup key
     C                     Z-ADDP1AIC3    WEAIC3           Company Number
     C                     MOVELP1V5ST    WEV5ST           Production Type
     C                     Z-ADDP1ELDT    WEELDT           Production Date
      * Establish starting position
     C           KRSSE     CHAIN@JCCPVC              90    *
      * Data record not found
     C   90                MOVEL'USR1795' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * U1LP Crt Prd Plan Hdr CR - PS Prod Schedule  * 
     C                     EXSR SFCRRC
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * U1LP Crt Prd Plan Hdr CR - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @JCCPVB
     C                     Z-ADDWEAIC3    WFAIC3           Company Number
     C                     MOVELWEV5ST    WFV5ST           Production Type
     C                     Z-ADDP2JFDT    WFELDT           Production Date
     C                     Z-ADDWEHVHD    WFHVHD           Hog Volume
     C                     Z-ADDWEZ6NB    WFZ6NB           Average Live We
     C                     Z-ADDWEZ7NB    WFZ7NB           Average Hot Wei
     C                     Z-ADDWEDGPC    WFDGPC           Cooler Shrink P
     C                     Z-ADDWEAVCW    WFAVCW           Average Cold We
     C                     Z-ADDWEDIPC    WFDIPC           Average Lean Pe
     C                     Z-ADDWEZ0NB    WFZ0NB           Average Backfat
     C                     Z-ADDWEAVLE    WFAVLE           Average Loin-Ey
     C                     Z-ADDWEECWG    WFECWG           Hot Weight Tota
     C                     MOVELWEUVST    WFUVST           EDI Status 1
     C                     MOVELWEUWST    WFUWST           EDI Status 2
     C                     MOVELWEUXST    WFUXST           EDI Status 3
     C                     MOVELWEVSST    WFVSST           Record Status
     C                     Z-ADDWEAATM    WFAATM           Job Time
     C                     MOVELWEAYNA    WFAYNA           User Id
     C                     MOVELWEA0NA    WFA0NA           Job Name
     C                     Z-ADDWEAXDT    WFAXDT           Job Date
      *
      * USER: Processing before Data update
      * RTV Cooler Shrink %    RT - Company Defaults  * 
     C                     EXSR SGRVGN
      * Cold Weight
      * DB1.Average Cold Weight =
      *    *COMPUTE (x1 - (x1 * (x2 / x3)))
      * x1    : DB1.Average Hot Weight
      * -     : PGM.*Synon (17,7) work field
      * x1    : DB1.Average Hot Weight
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : DB1.Cooler Shrink Percent
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WFDGPC    DIV  100       W0WD02    H      *Synon (17,7) w
     C           WFZ7NB    MULT W0WD02    W0WD01           *Synon (17,7) w
     C           WFZ7NB    SUB  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WFAVCW           Average Cold We
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WFVSST           Record Status
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
     C           KLCRSF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFV5ST           Production Type
     C                     KFLD           WFELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSF    SETLL@JCCPVB                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1796' W0RTN   7
      * Send message 'PS Prod Schedule       EX'
     C                     MOVEL'USR1796' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@JCCPVB                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Cooler Shrink %    RT - Company Defaults  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAIC3           Company Number
      * Setup key
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
      * Establish starting position
     C           KRSSG     CHAIN@AQREB9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0041' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WFDGPC           Cooler Shrink P
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGDGPC    WFDGPC           Cooler Shrink P
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAELDT           Production Date
     C                     Z-ADD*ZERO     WARMPA           CDS RM Pieces A
     C                     Z-ADD*ZERO     WAGFWG           CDS RM Weight A
     C                     Z-ADD*ZERO     WAGGWG           CDS Avg Piece W
     C                     Z-ADD*ZERO     WACLNB           CDS CV Pieces A
     C                     Z-ADD*ZERO     WAGHWG           CDS CV Weight A
     C                     Z-ADD*ZERO     WADVNB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WAGNWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WADZNB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WAGOWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WAD0NB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WAGPWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WAD1NB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WAGQWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WAD4NB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WAGRWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCELDT           Production Date
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WCWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WCQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WCDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WCF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WCWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WCD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WCDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WCB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WCWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WCPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WCSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WCB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WCD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WCCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WCEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WCCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WCE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WCD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WCOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WCCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WCUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WCCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WCF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WCBPNB           PS Pieces Whse
     C                     Z-ADD*ZERO     WCGAWG           PS Weight Whse
     C                     Z-ADD*ZERO     WCBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WCGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WCBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WCGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WCBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WCGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WCBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WCGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WCPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WCDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WCD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WCFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WCD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WCDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WCEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WCSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WCEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WCAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WCECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WCWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WCEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WCFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WCEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WCQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WCEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WCWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WCEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEELDT           Production Date
     C                     Z-ADD*ZERO     WEHVHD           Hog Volume
     C                     Z-ADD*ZERO     WEZ6NB           Average Live We
     C                     Z-ADD*ZERO     WEZ7NB           Average Hot Wei
     C                     Z-ADD*ZERO     WEDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     WEAVCW           Average Cold We
     C                     Z-ADD*ZERO     WEDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WEZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WEAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WEECWG           Hot Weight Tota
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGASVA           Credit Limit
     C                     Z-ADD*ZERO     WGDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDCRRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  1
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005  3
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007  92
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  72
     C                     Z-ADD*ZERO     WL0010  92
     C                     Z-ADD*ZERO     WL0011  92
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  92
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  92
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  92
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  92
     C                     Z-ADD*ZERO     WL0020  70
     C                     Z-ADD*ZERO     WL0021  92
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023  92
     C                     Z-ADD*ZERO     WL0024  70
     C                     Z-ADD*ZERO     WL0025  92
     C                     Z-ADD*ZERO     WL0026  70
     C                     Z-ADD*ZERO     WL0027  92
     C                     Z-ADD*ZERO     WL0028  70
     C                     Z-ADD*ZERO     WL0029 112
     C                     Z-ADD*ZERO     WL0030  70
     C                     Z-ADD*ZERO     WL0031 112
     C                     Z-ADD*ZERO     WL0032  70
     C                     Z-ADD*ZERO     WL0033 112
     C                     Z-ADD*ZERO     WL0034  70
     C                     Z-ADD*ZERO     WL0035 112
     C                     Z-ADD*ZERO     WL0036  70
     C                     Z-ADD*ZERO     WL0037 112
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039 112
     C                     Z-ADD*ZERO     WL0040  70
     C                     MOVEL*BLANK    WL0041  3
     C                     MOVEL*BLANK    WL0042  2
     C                     MOVEL*BLANK    WL0043  1
     C                     MOVEL*BLANK    WL0044  1
     C                     MOVEL*BLANK    WL0045  1
     C                     MOVEL*BLANK    WL0046  1
     C                     MOVEL*BLANK    WL0047  1
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  1
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  2
     C                     MOVEL*BLANK    WL0052  3
     C                     Z-ADD*ZERO     WL0053  92
     C                     Z-ADD*ZERO     WL0054  70
     C                     Z-ADD*ZERO     WL0055  92
     C                     Z-ADD*ZERO     WL0056  70
     C                     Z-ADD*ZERO     WL0057  92
     C                     Z-ADD*ZERO     WL0058  70
     C                     Z-ADD*ZERO     WL0059  92
     C                     Z-ADD*ZERO     WL0060  70
     C                     Z-ADD*ZERO     WL0061  92
     C                     Z-ADD*ZERO     WL0062  70
     C                     Z-ADD*ZERO     WL0063  92
     C                     Z-ADD*ZERO     WL0064  70
     C                     Z-ADD*ZERO     WL0065  92
     C                     Z-ADD*ZERO     WL0066  70
     C                     Z-ADD*ZERO     WL0067  92
     C                     Z-ADD*ZERO     WL0068  70
     C                     Z-ADD*ZERO     WL0069  92
     C                     Z-ADD*ZERO     WL0070  70
     C                     MOVEL*BLANK    WL0071  6
     C                     Z-ADD*ZERO     WL0072  30
     C                     Z-ADD*ZERO     WL0073  30
     C                     Z-ADD*ZERO     WL0074  30
     C                     MOVEL*BLANK    WL0075  6
     C                     MOVEL*BLANK    WL0076  1
     C                     MOVEL*BLANK    WL0077  1
     C                     MOVEL*BLANK    WL0078  1
     C                     MOVEL*BLANK    WL0079  1
     C                     Z-ADD*ZERO     WL0080  60
     C                     MOVEL*BLANK    WL0081 10
     C                     MOVEL*BLANK    WL0082 10
     C                     Z-ADD*ZERO     WL0083  70
      *================================================================
     CSR         ZZEXIT    ENDSR
