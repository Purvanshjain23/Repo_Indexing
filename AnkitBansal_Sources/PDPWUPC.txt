/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  PDPWUPC                                       */
/*  PROGRAM NAME:    Print LOT/LOCATION VARIANCE                   */
/*  PROGRAMMER:      Purva Patel                                   */
/*  CREATE DATE:     03/16/98                                      */
/*                                                                 */
/*  FUNCTION:        This CLP is submitted AFTER THE INVENTORY     */
/*                   IS ALLOCATED FOR THE LOAD OR THE ORDER        */
/*                                                                 */
/*                   USER OPTIONS ARE PASSED THROUGH THE PARMS.    */
/*                                                                 */
/*******************************************************************/
/*  Modification History                                           */
/*  RMC  2/18/00 IF USER CLASS IS NOT *PGMR, PRINT 2 ADDITIONAL    */
/*               COPIES OF THE REPORT ON PRINTERS GUPPRT131 AND    */
/*               GUPPRT240. SCAN: RMC218                           */
/*                                                                 */
/*  PKD  4/14/00 REMOVED PRINTING OF THE REPORT ON PRINTER         */
/*               GUPPRT131 AND GUPPRT240 PER JIM NORRIS.           */
/*  SLM  7/28/05 CHG TO PASS THE AGE CODE FOR THE REPORT           */
/*               ALSO CHANGED THE PROGRAM NAME ON THE COMMENTS     */
/*               WAS PROGRAM NUMBER:  PDLGUPC                      */
/*  JBB  7/21/16 Hold the report so that it does not print on a    */
/*   Issue 12135 printer at Alisa Cunningham's request.  Also      */
/*               email the reports to Alisa and Ashley Withershoop.*/
/*******************************************************************/
             PGM        PARM(&COMP &WHS &XPDTE &VAR &PDTL &PTRN +
                          &RPTTYP &PGM &PGMPRTF &PDEV &HOLD &SAVE +
                          &XCOPIES &TYPE &ITEM &QTY &AGE &JOBTYP)
/*-----------------------------------------------------------------*/
/*                      PARAMETER                                  */
/*-----------------------------------------------------------------*/
/* Print Options                                                   */
             DCL        VAR(&RTN) TYPE(*CHAR) LEN(7)
             DCL        VAR(&PDEV) TYPE(*CHAR) LEN(10)
             DCL        VAR(&HOLD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&SAVE) TYPE(*CHAR) LEN(4)
             DCL        VAR(&XCOPIES) TYPE(*CHAR) LEN(15)
             DCL        VAR(&PGM) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PGMPRTF) TYPE(*CHAR) LEN(10)
             DCL        VAR(&CLASS) TYPE(*CHAR) LEN(10)
             DCL        VAR(&USRPR) TYPE(*CHAR) LEN(10)

/* Function Specific                                               */
             DCL        VAR(&COMP) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&ITEM) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&QTY) TYPE(*DEC) LEN(5 0)
             DCL        VAR(&WHS) TYPE(*CHAR) LEN(3)
             DCL        VAR(&XPDTE) TYPE(*CHAR) LEN(7)
             DCL        VAR(&VAR) TYPE(*CHAR) LEN(2)
             DCL        VAR(&PDTL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&PTRN) TYPE(*CHAR) LEN(1)
             DCL        VAR(&RPTTYP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&TYPE)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&AGE)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&JOBTYP) TYPE(*CHAR) LEN(1)

/*-----------------------------------------------------------------*/
/*                    PROGRAM VARIABLES                            */
/*-----------------------------------------------------------------*/

             DCL        VAR(&PDTE)    TYPE(*DEC) LEN(7 0)
             DCL        VAR(&COPIES)  TYPE(*DEC) LEN(2 0)
             DCL        VAR(&COMMAND) TYPE(*CHAR) LEN(512)
             DCL        VAR(&COMPA)   TYPE(*CHAR) LEN(3)
             DCL        VAR(&DESC)    TYPE(*CHAR) LEN(50)
             DCL        VAR(&DISTNME) TYPE(*CHAR) LEN(60)
             DCL        VAR(&DISTSCH) TYPE(*CHAR) LEN(30)
             DCL        VAR(&AGECDE)  TYPE(*CHAR) LEN(4)
             DCL        VAR(&JOBDTE)  TYPE(*CHAR) LEN(7)
             DCL        VAR(&MDATE) TYPE(*CHAR) LEN(10)

/*-----------------------------------------------------------------*/
/*                     INITIALIZATION                              */
/*-----------------------------------------------------------------*/

             CHGVAR     VAR(&PDTE) VALUE(&XPDTE)
             CHGVAR     VAR(&COPIES) VALUE(&XCOPIES)

             /* JBB  7/21/16  Issue: 12135                */
             /* Hold the report so that it can be emailed */
             IF         COND(&JOBTYP = '0') THEN(DO)
             CHGVAR     VAR(&COMPA) VALUE(&COMP)

             RTVJOBA    CYMDDATE(&JOBDTE)
             CVTDAT     DATE(&JOBDTE) TOVAR(&MDATE) FROMFMT(*CYMD) +
                          TOFMT(*MDYY) TOSEP(/)

             CHGVAR     VAR(&HOLD) VALUE('*YES')

             /* Get email distribution list for Freezer Inventory */
             CALL       PGM(POMTXFR) PARM(' ' &COMP 'INVNIGHTR' +
                          &DISTSCH)

             CHGVAR     VAR(&AGECDE) VALUE(&AGE)
             IF         COND(&AGE = ' ') THEN(CHGVAR VAR(&AGECDE) +
                          VALUE('*ALL'))
             ENDDO

/*-----------------------------------------------------------------*/
/*                           MAIN                                  */
/*-----------------------------------------------------------------*/
             SBDPRTOVR  CMDVAR(&COMMAND) FILE(&PGMPRTF) OUTQ(&PDEV) +
                          DRAWER(*PRTF) COPIES(&COPIES) HOLD(&HOLD) +
                          SAVE(&SAVE)
             CALL       PGM(QCMDEXC) PARM(&COMMAND 512)

             CALL       PGM(&PGM) PARM(' ' &COMP &WHS &TYPE &ITEM +
                          &QTY &AGE)

             /* JBB  7/21/16  Issue: 12135                */
             /* Setup for email                           */
             IF         COND(&JOBTYP = '0') THEN(DO)
             CHGVAR     VAR(&DESC) VALUE('                      ')

             CHGVAR     VAR(&DESC) VALUE(&COMPA *BCAT 'Freezer +
                          Inventory Report -' *BCAT &AGECDE *BCAT +
                          'for' *BCAT &MDATE)

             CHGVAR     VAR(&DISTNME) VALUE('Distribution List: ' +
                          *BCAT &DISTSCH)

/* ---------------------------------------------------------------  */
/* Email of the Freezer Inventory Report                            */
/* ---------------------------------------------------------------  */

             ESEND/ESNDMAIL RECIPIENT(&DISTSCH) SUBJECT(&DESC) +
                          MSG(&DISTNME) ATTLIST((* *PDF *N &PGMPRTF))
             ENDDO
/*-----------------------------------------------------------------*/
/* RMC218:     RTVUSRPRF  RTNUSRPRF(&USRPR) USRCLS(&CLASS)         */
/*           IF COND(&CLASS = '*PGMR') THEN(GOTO ENDPGM)           */
/*           IF COND(&USRPR *NE 'PDSECOFR') THEN(GOTO ENDPGM)      */
/*-----------------------------------------------------------------*/
/*           CHGVAR     VAR(&COPIES) VALUE(01)                     */
/*           SBDPRTOVR  CMDVAR(&COMMAND) FILE(&PGMPRTF) +          */
/*                        OUTQ(GUPPRT131) DRAWER(*PRTF) +          */
/*                        COPIES(&COPIES) HOLD(&HOLD) SAVE(&SAVE)  */
/*           CALL       PGM(QCMDEXC) PARM(&COMMAND 512)            */
/*                                                                 */
/*           CALL       PGM(&PGM) PARM(' ' &COMP &WHS &TYPE &ITEM) */
/*-----------------------------------------------------------------*/
/*           SBDPRTOVR  CMDVAR(&COMMAND) FILE(&PGMPRTF) +          */
/*                        OUTQ(GUPPRT240) DRAWER(*PRTF) +          */
/*                        COPIES(&COPIES) HOLD(&HOLD) SAVE(&SAVE)  */
/*           CALL       PGM(QCMDEXC) PARM(&COMMAND 512)            */
/*                                                                 */
/*           CALL       PGM(&PGM) PARM(' ' &COMP &WHS &TYPE &ITEM) */
/*-----------------------------------------------------------------*/
/*                      PROGRAM END                                */
/*-----------------------------------------------------------------*/
 ENDPGM:
             DLTOVR     FILE(*ALL)

             ENDPGM
