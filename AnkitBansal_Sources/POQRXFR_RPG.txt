     H/TITLE Tmp ReClc Wgt Sched   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 10/05/22  Time  : 10:01:58
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FOPBGWKLFIF  E           K        DISK
      * RSQ : Order Detail              Co/Itm/Whs/SSD(d)/Od Omt
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDKNCPL1IF  E           K        DISK
      * RTV : Order Detail Schedule     Retrieval index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPDKNCPL0UF  E           K        DISK
      * UPD : Order Detail Schedule     Update index
      *
     FCABZREL0UF  E           K        DISK
      * UPD : Company Item              Update index
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WAAIC3
     I              BZHGCD                          WAHGCD
     I              BZAVNA                          WAAVNA
     I              BZAWNA                          WAAWNA
     I              BZL7NA                          WAL7NA
     I              BZL8NA                          WAL8NA
     I              BZL6NA                          WAL6NA
     I              BZMFNA                          WAMFNA
     I              BZADCD                          WAADCD
     I              BZAWPC                          WAAWPC
     I              BZLXST                          WALXST
     I              BZAECD                          WAAECD
     I              BZAXPC                          WAAXPC
     I              BZLYST                          WALYST
     I              BZAFCD                          WAAFCD
     I              BZAICD                          WAAICD
     I              BZAIWG                          WAAIWG
     I              BZHICD                          WAHICD
     I              BZRBCD                          WARBCD
     I              BZFZST                          WAFZST
     I              BZAVST                          WAAVST
     I              BZCZWG                          WACZWG
     I              BZC0WG                          WAC0WG
     I              BZURTN                          WAURTN
     I              BZAJC8                          WAAJC8
     I              BZRINB                          WARINB
     I              BZRHNB                          WARHNB
     I              BZRGNB                          WARGNB
     I              BZLNCD                          WALNCD
     I              BZTFNB                          WATFNB
     I              BZN0CD                          WAN0CD
     I              BZX4ST                          WAX4ST
     I              BZTMVA                          WATMVA
     I              BZTNVA                          WATNVA
     I              BZBLPR                          WABLPR
     I              BZBMPR                          WABMPR
     I              BZLRCD                          WALRCD
     I              BZU9ST                          WAU9ST
     I              BZCMCO                          WACMCO
     I              BZQ1CD                          WAQ1CD
     I              BZQ8CD                          WAQ8CD
     I              BZCHTM                          WACHTM
     I              BZQZCD                          WAQZCD
     I              BZXWST                          WAXWST
     I              BZXXST                          WAXXST
     I              BZVMST                          WAVMST
     I              BZSWGH                          WASWGH
     I              BZPPHE                          WAPPHE
     I              BZR3CD                          WAR3CD
     I              BZSDCD                          WASDCD
     I              BZICN1                          WAICN1
     I              BZSVCD                          WASVCD
     I              BZICN2                          WAICN2
     I              BZSWCD                          WASWCD
     I              BZV2NB                          WAV2NB
     I              BZSXCD                          WASXCD
     I              BZITCN                          WAITCN
     I              BZSYCD                          WASYCD
     I              BZITC5                          WAITC5
     I              BZSZCD                          WASZCD
     I              BZICN6                          WAICN6
     I              BZS0CD                          WAS0CD
     I              BZICN7                          WAICN7
     I              BZS1CD                          WAS1CD
     I              BZICN8                          WAICN8
     I              BZS2CD                          WAS2CD
     I              BZICN9                          WAICN9
     I              BZS3CD                          WAS3CD
     I              BZICN0                          WAICN0
     I              BZS4CD                          WAS4CD
     I              BZSFNB                          WASFNB
     I              BZA3WG                          WAA3WG
     I              BZSJNB                          WASJNB
     I              BZLLCD                          WALLCD
     I              BZLMCD                          WALMCD
     I              BZP3ST                          WAP3ST
     I              BZSKNB                          WASKNB
     I              BZSLNB                          WASLNB
     I              BZSMNB                          WASMNB
     I              BZP4ST                          WAP4ST
     I              BZCFNB                          WACFNB
     I              BZCGNB                          WACGNB
     I              BZILNB                          WAILNB
     I              BZCHNB                          WACHNB
     I              BZCINB                          WACINB
     I              BZCJNB                          WACJNB
     I              BZCMNB                          WACMNB
     I              BZCNNB                          WACNNB
     I              BZCRNB                          WACRNB
     I              BZCSNB                          WACSNB
     I              BZCVNB                          WACVNB
     I              BZCWNB                          WACWNB
     I              BZCXNB                          WACXNB
     I              BZCZNB                          WACZNB
     I              BZC0NB                          WAC0NB
     I              BZN1CD                          WAN1CD
     I              BZB4NB                          WAB4NB
     I              BZB5NB                          WAB5NB
     I              BZX5ST                          WAX5ST
     I              BZX6ST                          WAX6ST
     I              BZX7ST                          WAX7ST
     I              BZPCCT                          WAPCCT
     I              BZBDNB                          WABDNB
     I              BZBJNB                          WABJNB
     I              BZSUST                          WASUST
     I              BZSVST                          WASVST
     I              BZSYST                          WASYST
     I              BZSZST                          WASZST
     I              BZS1ST                          WAS1ST
     I              BZXRCD                          WAXRCD
     I              BZXTCD                          WAXTCD
     I              BZXUCD                          WAXUCD
     I              BZF5WG                          WAF5WG
     I              BZF6WG                          WAF6WG
     I              BZF7WG                          WAF7WG
     I              BZBLNB                          WABLNB
     I              BZBNNB                          WABNNB
     I              BZS2ST                          WAS2ST
     I              BZS4ST                          WAS4ST
     I              BZS5ST                          WAS5ST
     I              BZS6ST                          WAS6ST
     I              BZS8ST                          WAS8ST
     I              BZS9ST                          WAS9ST
     I              BZTCST                          WATCST
     I              BZTDST                          WATDST
     I              BZUVST                          WAUVST
     I              BZUWST                          WAUWST
     I              BZUXST                          WAUXST
     I              BZVSST                          WAVSST
     I              BZAATM                          WAAATM
     I              BZAYNA                          WAAYNA
     I              BZA0NA                          WAA0NA
     I              BZAXDT                          WAAXDT
      *
     I@BGWKKG
      * Order Detail              Co/Itm/Whs/SSD(d)/Od Omt
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@KNCPHO
      * Order Detail Schedule     Retrieval index
      * Renamed input format fields
     I              KNAIC3                          WEAIC3
     I              KNC4NB                          WEC4NB
     I              KNDPNB                          WEDPNB
     I              KNUENB                          WEUENB
     I              KNJGDT                          WEJGDT
     I              KNAODT                          WEAODT
     I              KNAJCD                          WEAJCD
     I              KNAYAA                          WEAYAA
     I              KNHGCD                          WEHGCD
     I              KNIGQT                          WEIGQT
     I              KNFLWG                          WEFLWG
     I              KNIUQT                          WEIUQT
     I              KNF3WG                          WEF3WG
     I              KNIVQT                          WEIVQT
     I              KNF4WG                          WEF4WG
     I              KNP7ST                          WEP7ST
     I              KNP8ST                          WEP8ST
     I              KNQAST                          WEQAST
     I              KNUVST                          WEUVST
     I              KNUWST                          WEUWST
     I              KNUXST                          WEUXST
     I              KNVSST                          WEVSST
     I              KNAATM                          WEAATM
     I              KNAYNA                          WEAYNA
     I              KNA0NA                          WEA0NA
     I              KNAXDT                          WEAXDT
      *
     I@KNCPHN
      * Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WFAIC3
     I              KNC4NB                          WFC4NB
     I              KNDPNB                          WFDPNB
     I              KNUENB                          WFUENB
     I              KNJGDT                          WFJGDT
     I              KNAODT                          WFAODT
     I              KNAJCD                          WFAJCD
     I              KNAYAA                          WFAYAA
     I              KNHGCD                          WFHGCD
     I              KNIGQT                          WFIGQT
     I              KNFLWG                          WFFLWG
     I              KNIUQT                          WFIUQT
     I              KNF3WG                          WFF3WG
     I              KNIVQT                          WFIVQT
     I              KNF4WG                          WFF4WG
     I              KNP7ST                          WFP7ST
     I              KNP8ST                          WFP8ST
     I              KNQAST                          WFQAST
     I              KNUVST                          WFUVST
     I              KNUWST                          WFUWST
     I              KNUXST                          WFUXST
     I              KNVSST                          WFVSST
     I              KNAATM                          WFAATM
     I              KNAYNA                          WFAYNA
     I              KNA0NA                          WFA0NA
     I              KNAXDT                          WFAXDT
      *
     I@BZREJV
      * Company Item              Update index
      * Renamed input format fields
     I              BZAIC3                          WGAIC3
     I              BZHGCD                          WGHGCD
     I              BZAVNA                          WGAVNA
     I              BZAWNA                          WGAWNA
     I              BZL7NA                          WGL7NA
     I              BZL8NA                          WGL8NA
     I              BZL6NA                          WGL6NA
     I              BZMFNA                          WGMFNA
     I              BZADCD                          WGADCD
     I              BZAWPC                          WGAWPC
     I              BZLXST                          WGLXST
     I              BZAECD                          WGAECD
     I              BZAXPC                          WGAXPC
     I              BZLYST                          WGLYST
     I              BZAFCD                          WGAFCD
     I              BZAICD                          WGAICD
     I              BZAIWG                          WGAIWG
     I              BZHICD                          WGHICD
     I              BZRBCD                          WGRBCD
     I              BZFZST                          WGFZST
     I              BZAVST                          WGAVST
     I              BZCZWG                          WGCZWG
     I              BZC0WG                          WGC0WG
     I              BZURTN                          WGURTN
     I              BZAJC8                          WGAJC8
     I              BZRINB                          WGRINB
     I              BZRHNB                          WGRHNB
     I              BZRGNB                          WGRGNB
     I              BZLNCD                          WGLNCD
     I              BZTFNB                          WGTFNB
     I              BZN0CD                          WGN0CD
     I              BZX4ST                          WGX4ST
     I              BZTMVA                          WGTMVA
     I              BZTNVA                          WGTNVA
     I              BZBLPR                          WGBLPR
     I              BZBMPR                          WGBMPR
     I              BZLRCD                          WGLRCD
     I              BZU9ST                          WGU9ST
     I              BZCMCO                          WGCMCO
     I              BZQ1CD                          WGQ1CD
     I              BZQ8CD                          WGQ8CD
     I              BZCHTM                          WGCHTM
     I              BZQZCD                          WGQZCD
     I              BZXWST                          WGXWST
     I              BZXXST                          WGXXST
     I              BZVMST                          WGVMST
     I              BZSWGH                          WGSWGH
     I              BZPPHE                          WGPPHE
     I              BZR3CD                          WGR3CD
     I              BZSDCD                          WGSDCD
     I              BZICN1                          WGICN1
     I              BZSVCD                          WGSVCD
     I              BZICN2                          WGICN2
     I              BZSWCD                          WGSWCD
     I              BZV2NB                          WGV2NB
     I              BZSXCD                          WGSXCD
     I              BZITCN                          WGITCN
     I              BZSYCD                          WGSYCD
     I              BZITC5                          WGITC5
     I              BZSZCD                          WGSZCD
     I              BZICN6                          WGICN6
     I              BZS0CD                          WGS0CD
     I              BZICN7                          WGICN7
     I              BZS1CD                          WGS1CD
     I              BZICN8                          WGICN8
     I              BZS2CD                          WGS2CD
     I              BZICN9                          WGICN9
     I              BZS3CD                          WGS3CD
     I              BZICN0                          WGICN0
     I              BZS4CD                          WGS4CD
     I              BZSFNB                          WGSFNB
     I              BZA3WG                          WGA3WG
     I              BZSJNB                          WGSJNB
     I              BZLLCD                          WGLLCD
     I              BZLMCD                          WGLMCD
     I              BZP3ST                          WGP3ST
     I              BZSKNB                          WGSKNB
     I              BZSLNB                          WGSLNB
     I              BZSMNB                          WGSMNB
     I              BZP4ST                          WGP4ST
     I              BZCFNB                          WGCFNB
     I              BZCGNB                          WGCGNB
     I              BZILNB                          WGILNB
     I              BZCHNB                          WGCHNB
     I              BZCINB                          WGCINB
     I              BZCJNB                          WGCJNB
     I              BZCMNB                          WGCMNB
     I              BZCNNB                          WGCNNB
     I              BZCRNB                          WGCRNB
     I              BZCSNB                          WGCSNB
     I              BZCVNB                          WGCVNB
     I              BZCWNB                          WGCWNB
     I              BZCXNB                          WGCXNB
     I              BZCZNB                          WGCZNB
     I              BZC0NB                          WGC0NB
     I              BZN1CD                          WGN1CD
     I              BZB4NB                          WGB4NB
     I              BZB5NB                          WGB5NB
     I              BZX5ST                          WGX5ST
     I              BZX6ST                          WGX6ST
     I              BZX7ST                          WGX7ST
     I              BZPCCT                          WGPCCT
     I              BZBDNB                          WGBDNB
     I              BZBJNB                          WGBJNB
     I              BZSUST                          WGSUST
     I              BZSVST                          WGSVST
     I              BZSYST                          WGSYST
     I              BZSZST                          WGSZST
     I              BZS1ST                          WGS1ST
     I              BZXRCD                          WGXRCD
     I              BZXTCD                          WGXTCD
     I              BZXUCD                          WGXUCD
     I              BZF5WG                          WGF5WG
     I              BZF6WG                          WGF6WG
     I              BZF7WG                          WGF7WG
     I              BZBLNB                          WGBLNB
     I              BZBNNB                          WGBNNB
     I              BZS2ST                          WGS2ST
     I              BZS4ST                          WGS4ST
     I              BZS5ST                          WGS5ST
     I              BZS6ST                          WGS6ST
     I              BZS8ST                          WGS8ST
     I              BZS9ST                          WGS9ST
     I              BZTCST                          WGTCST
     I              BZTDST                          WGTDST
     I              BZUVST                          WGUVST
     I              BZUWST                          WGUWST
     I              BZUXST                          WGUXST
     I              BZVSST                          WGVSST
     I              BZAATM                          WGAATM
     I              BZAYNA                          WGAYNA
     I              BZA0NA                          WGA0NA
     I              BZAXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDKN1    E DSPDKNCPL0
      * UPD : Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WFAIC3
     I              KNC4NB                          WFC4NB
     I              KNDPNB                          WFDPNB
     I              KNUENB                          WFUENB
     I              KNJGDT                          WFJGDT
     I              KNAODT                          WFAODT
     I              KNAJCD                          WFAJCD
     I              KNAYAA                          WFAYAA
     I              KNHGCD                          WFHGCD
     I              KNIGQT                          WFIGQT
     I              KNFLWG                          WFFLWG
     I              KNIUQT                          WFIUQT
     I              KNF3WG                          WFF3WG
     I              KNIVQT                          WFIVQT
     I              KNF4WG                          WFF4WG
     I              KNP7ST                          WFP7ST
     I              KNP8ST                          WFP8ST
     I              KNQAST                          WFQAST
     I              KNUVST                          WFUVST
     I              KNUWST                          WFUWST
     I              KNUXST                          WFUXST
     I              KNVSST                          WFVSST
     I              KNAATM                          WFAATM
     I              KNAYNA                          WFAYNA
     I              KNA0NA                          WFA0NA
     I              KNAXDT                          WFAXDT
      *
     IYBRDCS      DS                            100
     IQCABZ1    E DSCABZREL0
      * UPD : Company Item              Update index
      * Renamed input format fields
     I              BZAIC3                          WGAIC3
     I              BZHGCD                          WGHGCD
     I              BZAVNA                          WGAVNA
     I              BZAWNA                          WGAWNA
     I              BZL7NA                          WGL7NA
     I              BZL8NA                          WGL8NA
     I              BZL6NA                          WGL6NA
     I              BZMFNA                          WGMFNA
     I              BZADCD                          WGADCD
     I              BZAWPC                          WGAWPC
     I              BZLXST                          WGLXST
     I              BZAECD                          WGAECD
     I              BZAXPC                          WGAXPC
     I              BZLYST                          WGLYST
     I              BZAFCD                          WGAFCD
     I              BZAICD                          WGAICD
     I              BZAIWG                          WGAIWG
     I              BZHICD                          WGHICD
     I              BZRBCD                          WGRBCD
     I              BZFZST                          WGFZST
     I              BZAVST                          WGAVST
     I              BZCZWG                          WGCZWG
     I              BZC0WG                          WGC0WG
     I              BZURTN                          WGURTN
     I              BZAJC8                          WGAJC8
     I              BZRINB                          WGRINB
     I              BZRHNB                          WGRHNB
     I              BZRGNB                          WGRGNB
     I              BZLNCD                          WGLNCD
     I              BZTFNB                          WGTFNB
     I              BZN0CD                          WGN0CD
     I              BZX4ST                          WGX4ST
     I              BZTMVA                          WGTMVA
     I              BZTNVA                          WGTNVA
     I              BZBLPR                          WGBLPR
     I              BZBMPR                          WGBMPR
     I              BZLRCD                          WGLRCD
     I              BZU9ST                          WGU9ST
     I              BZCMCO                          WGCMCO
     I              BZQ1CD                          WGQ1CD
     I              BZQ8CD                          WGQ8CD
     I              BZCHTM                          WGCHTM
     I              BZQZCD                          WGQZCD
     I              BZXWST                          WGXWST
     I              BZXXST                          WGXXST
     I              BZVMST                          WGVMST
     I              BZSWGH                          WGSWGH
     I              BZPPHE                          WGPPHE
     I              BZR3CD                          WGR3CD
     I              BZSDCD                          WGSDCD
     I              BZICN1                          WGICN1
     I              BZSVCD                          WGSVCD
     I              BZICN2                          WGICN2
     I              BZSWCD                          WGSWCD
     I              BZV2NB                          WGV2NB
     I              BZSXCD                          WGSXCD
     I              BZITCN                          WGITCN
     I              BZSYCD                          WGSYCD
     I              BZITC5                          WGITC5
     I              BZSZCD                          WGSZCD
     I              BZICN6                          WGICN6
     I              BZS0CD                          WGS0CD
     I              BZICN7                          WGICN7
     I              BZS1CD                          WGS1CD
     I              BZICN8                          WGICN8
     I              BZS2CD                          WGS2CD
     I              BZICN9                          WGICN9
     I              BZS3CD                          WGS3CD
     I              BZICN0                          WGICN0
     I              BZS4CD                          WGS4CD
     I              BZSFNB                          WGSFNB
     I              BZA3WG                          WGA3WG
     I              BZSJNB                          WGSJNB
     I              BZLLCD                          WGLLCD
     I              BZLMCD                          WGLMCD
     I              BZP3ST                          WGP3ST
     I              BZSKNB                          WGSKNB
     I              BZSLNB                          WGSLNB
     I              BZSMNB                          WGSMNB
     I              BZP4ST                          WGP4ST
     I              BZCFNB                          WGCFNB
     I              BZCGNB                          WGCGNB
     I              BZILNB                          WGILNB
     I              BZCHNB                          WGCHNB
     I              BZCINB                          WGCINB
     I              BZCJNB                          WGCJNB
     I              BZCMNB                          WGCMNB
     I              BZCNNB                          WGCNNB
     I              BZCRNB                          WGCRNB
     I              BZCSNB                          WGCSNB
     I              BZCVNB                          WGCVNB
     I              BZCWNB                          WGCWNB
     I              BZCXNB                          WGCXNB
     I              BZCZNB                          WGCZNB
     I              BZC0NB                          WGC0NB
     I              BZN1CD                          WGN1CD
     I              BZB4NB                          WGB4NB
     I              BZB5NB                          WGB5NB
     I              BZX5ST                          WGX5ST
     I              BZX6ST                          WGX6ST
     I              BZX7ST                          WGX7ST
     I              BZPCCT                          WGPCCT
     I              BZBDNB                          WGBDNB
     I              BZBJNB                          WGBJNB
     I              BZSUST                          WGSUST
     I              BZSVST                          WGSVST
     I              BZSYST                          WGSYST
     I              BZSZST                          WGSZST
     I              BZS1ST                          WGS1ST
     I              BZXRCD                          WGXRCD
     I              BZXTCD                          WGXTCD
     I              BZXUCD                          WGXUCD
     I              BZF5WG                          WGF5WG
     I              BZF6WG                          WGF6WG
     I              BZF7WG                          WGF7WG
     I              BZBLNB                          WGBLNB
     I              BZBNNB                          WGBNNB
     I              BZS2ST                          WGS2ST
     I              BZS4ST                          WGS4ST
     I              BZS5ST                          WGS5ST
     I              BZS6ST                          WGS6ST
     I              BZS8ST                          WGS8ST
     I              BZS9ST                          WGS9ST
     I              BZTCST                          WGTCST
     I              BZTDST                          WGTDST
     I              BZUVST                          WGUVST
     I              BZUWST                          WGUWST
     I              BZUXST                          WGUXST
     I              BZVSST                          WGVSST
     I              BZAATM                          WGAATM
     I              BZAYNA                          WGAYNA
     I              BZA0NA                          WGA0NA
     I              BZAXDT                          WGAXDT
      *
     IYCRDCS      DS                            605
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Company Item
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Item Code
     I                                    P   3   60P1HGCD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1HGCD    PARM           WP0002  70       Item Code
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Tmp ReClc Wgt Sched   XF
      * rmc - 11/19/08 change to work for 1 item
      * Upd Unit Wgt Chg Sts  RT - Company Item  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Upd Unit Wgt Chg Sts  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1HGCD    WAHGCD           Item Code
      * Establish starting position
     C           KRSSA     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Item Type Code is Finished Goods
     C           WAN0CD    IFEQ 'FG'                       *IF
      * UPS ReClc Wgt Sched   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAHGCD    WL0002           Item Code
     C                     Z-ADDWAAIWG    WL0003           Unit Weight
     C                     EXSR SBRVGN
      * Chg Unit Wgt Chg Sts  CH - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0004           Company Number
     C                     Z-ADDWAHGCD    WL0005           Item Code
     C                     MOVEL'NO'      WL0006    P      Unit Weight Cha
     C                     EXSR SHCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * UPS ReClc Wgt Sched   RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0002 112       Weight Schedule
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBHGCD    WQSB02           Item Code
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Item Code
      * Setup key
     C                     Z-ADDWL0001    WQSB01           Company Number
     C                     Z-ADDWL0002    WQSB02           Item Code
      * Establish starting position
     C           KRSSB     SETLL@BGWKKG                    *
     C           KRSSB     READE@BGWKKG                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Hdr Sts,BillActTy RT - Order Header TRG  * 
     C                     EXSR SCRVGN
      * CASE: LCL.Billing Activity Type is Invoice or Transfer
     C           YL0002    IFEQ '1'                        *IF
     C           YL0002    OREQ '4'
     C           WBCCQT    MULT WL0003    WN0002    H      Weight Schedule
     C           WBAVQT    MULT WL0003    WN0001    H      Weight Ordered
     C                     MOVEL'UWC'     YL0003           Pricing Event C
      * Set to event that will create tms order trigger - if gross wt is
      * CASE: DB1.Weight Ordered NE PAR.Weight Ordered
     C           WBD0WG    IFNE WN0001                     *IF
     C                     MOVEL'UWT'     YL0003           Pricing Event C
     C                     END                             *FI
      * Chg Wgt Sched,Unit Wt CH - Order Detail  * 
     C                     EXSR SDCHRC
      * UPS ReClc Wgt Sched   RT - Order Detail Schedule  * 
     C                     EXSR SERVGN
      * ****    PDD012   ********
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0011  30       Company Number
     C                     PARM WBC4NB    WQ0012  70       Order Number
     C                     PARM WBBKC7    WQ0013  70       Ship To Custome
     C           WUB5VL    PARM WUB5VL    WQ0014 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0015 112       Order Weight To
     C                     PARM YL0003    WQ0016  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV Load ID            RT - PD Order Header  * 
     C                     EXSR SGRVGN
      * RMC 02/05/07 do this only if there is a Load on the Order
      * CASE: WRK.Load ID is NE Blank
     C           WURMNB    IFNE 0                          *IF
      * RTV UPD Ld Abs.Frt/Wgt XF - PD Order Header  * 
     C                     CALL 'PDE0XFR'              90  RTV UPD Ld Abs.
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WURMNB    WQ0017  70       Load ID
     C           WURPNB    PARM WURPNB    WQ0018  70       Total Load Orde
     C           WURQNB    PARM WURQNB    WQ0019 112       Total Freight
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@BGWKKG                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Hdr Sts,BillActTy RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWBC4NB    WCC4NB           Order Number
      * Establish starting position
     C           KRSSC     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCGWST    YL0001           Header Status
     C                     MOVELWCOBST    YL0002           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg Wgt Sched,Unit Wt CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  70       Item Code
     C                     MOVEL*BLANK    WN0004  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0005  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0006  70       Order Group Cod
     C                     MOVEL*BLANK    WN0007  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0008  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0009 112       Billing Detail
     C                     Z-ADD*ZERO     WN0010 112       Billing Detail
     C                     Z-ADD*ZERO     WN0011 112       Billing Detail
     C                     Z-ADD*ZERO     WN0012 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0013  1        Comment Print A
     C                     MOVEL*BLANK    WN0014  1        Comment Print I
     C                     MOVEL*BLANK    WN0015  1        Comment Print P
     C                     MOVEL*BLANK    WN0016  1        Comment Print S
     C                     Z-ADD*ZERO     WN0017 112       Extended Amount
     C                     Z-ADD*ZERO     WN0018  70       Market Pricing
     C                     MOVEL*BLANK    WN0019  3        Commodity Marke
     C                     MOVEL*BLANK    WN0020  3        Date Method Cod
     C                     MOVEL*BLANK    WN0021  3        Price Method Co
     C                     Z-ADD*ZERO     WN0022 114       Price Overage O
     C                     Z-ADD*ZERO     WN0023  70       Contract Number
     C                     MOVEL*BLANK    WN0024  1        Price Status
     C                     Z-ADD*ZERO     WN0025  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0026  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0027  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0028  1        Work Confirm St
     C                     MOVEL*BLANK    WN0029  1        Work Over/Short
     C                     MOVEL*BLANK    WN0030  1        OD Production P
     C                     MOVEL*BLANK    WN0031 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0032 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0033  1        Age Code
     C                     MOVEL*BLANK    WN0034  1        Palletize
     C                     MOVEL*BLANK    WN0035  1        Slip Sheet
     C                     MOVEL*BLANK    WN0036  1        Catch Weight St
     C                     MOVEL*BLANK    WN0037  1        Price Audit
     C                     MOVEL*BLANK    WN0038  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0039  1        Production Date
     C                     Z-ADD*ZERO     WN0040 112       Rated Freight
     C                     Z-ADD*ZERO     WN0041 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0042 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0043 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0044 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0045 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0046 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0047 114       Unit Price
     C                     Z-ADD*ZERO     WN0048 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0049 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0050 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0051  70       Requested Ship
     C                     Z-ADD*ZERO     WN0052  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0053  70       Actual Shipped
     C                     MOVEL*BLANK    WN0054  1        Affect Inventor
     C                     MOVEL*BLANK    WN0055  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0056  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0057  30       Item Structure
     C                     Z-ADD*ZERO     WN0058  30       Item Structure
     C                     Z-ADD*ZERO     WN0059  30       Item Structure
     C                     MOVEL*BLANK    WN0060  2        Item Level
     C                     MOVEL*BLANK    WN0061  2        Quality Level
     C                     MOVEL*BLANK    WN0062  2        Pricing Product
     C                     MOVEL*BLANK    WN0063  2        Season Product
     C                     Z-ADD*ZERO     WN0064  70       Date of Origina
     C                     MOVEL*BLANK    WN0065 10        User Profile Na
     C                     MOVEL*BLANK    WN0066  6        Country Code
     C                     MOVEL*BLANK    WN0067  2        Event Code
     C                     MOVEL*BLANK    WN0068  3        Reason Code
     C                     MOVEL*BLANK    WN0069  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0070  1        Modified Flag
     C                     MOVEL*BLANK    WN0071  1        Substituted Fla
     C                     MOVEL*BLANK    WN0072  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0073 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0074 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0075  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0076  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0077  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0078  1        Affect Commissi
     C                     MOVEL*BLANK    WN0079  1        Affect Pricing
     C                     MOVEL*BLANK    WN0080  1        Released by Use
     C                     MOVEL*BLANK    WN0081  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0082  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0083  3        Production Ware
     C                     MOVEL*BLANK    WN0084  3        OD Price Type
     C                     Z-ADD*ZERO     WN0085  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0086  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0087  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0088  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0089  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0090  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0091  60       Price Code
     C                     Z-ADD*ZERO     WN0092  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0093  60       Substitution Li
     C                     Z-ADD*ZERO     WN0094  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0095 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0096 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0097 112       OD Item Target
     C                     Z-ADD*ZERO     WN0098 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0099 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0100 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0101 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0102 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0103 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0104 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0105 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0106 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0107 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0108  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0109  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0110  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0111 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0112  40       Item Age Days
     C                     Z-ADD*ZERO     WN0113  70       Production Ovr
     C                     Z-ADD*ZERO     WN0114  70       Production Ovr
     C                     MOVEL*BLANK    WN0115  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0116  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0117  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0118  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0119  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0120  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0121  1        EDI Status 1
     C                     MOVEL*BLANK    WN0122  1        EDI Status 2
     C                     MOVEL*BLANK    WN0123  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0124  60       Job Time
     C                     MOVEL*BLANK    WN0125 10        User Id
     C                     MOVEL*BLANK    WN0126 10        Job Name
     C                     Z-ADD*ZERO     WN0127  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWBAIC3    WDAIC3           Company Number
     C                     Z-ADDWBC4NB    WDC4NB           Order Number
     C                     Z-ADDWBDPNB    WDDPNB           Order Sequence
     C                     Z-ADDWBUENB    WDUENB           Order Secondary
      *
     C           KLCHSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C           KLCHSD    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWN0001    WDD0WG           Weight Ordered
     C                     Z-ADDWN0002    WDAUWG           Weight Schedule
     C                     Z-ADDWL0003    WDAVWG           Unit Weight Ord
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt func
     C                     EXSR UASUBR                     Calc Gross Weig
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * UPS ReClc Wgt Sched   RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0128 112       OD Weight Sched
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WEC4NB    WQSE02           Order Number
     C           *LIKE     DEFN WEDPNB    WQSE03           Order Sequence
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
     C                     KFLD           WQSE03           Order Sequence
      * Setup key
     C                     Z-ADDWBAIC3    WQSE01           Company Number
     C                     Z-ADDWBC4NB    WQSE02           Order Number
     C                     Z-ADDWBDPNB    WQSE03           Order Sequence
      * Establish starting position
     C           KRSSE     SETLL@KNCPHO                    *
     C           KRSSE     READE@KNCPHO                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WEIGQT    MULT WL0003    WN0128    H      OD Weight Sched
      * CHG Weight Scheduled   CH - PD Order Detail Schedule  * 
     C                     EXSR SFCHRC
     C           KRSSE     READE@KNCPHO                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * CHG Weight Scheduled   CH - PD Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0129  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0130  3        Warehouse Code
     C                     MOVEL*BLANK    WN0131  3        Order From Ware
     C                     Z-ADD*ZERO     WN0132  70       Item Code
     C                     Z-ADD*ZERO     WN0133 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0134 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0135 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0136 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0137 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0138  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0139  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0140  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0141  1        EDI Status 1
     C                     MOVEL*BLANK    WN0142  1        EDI Status 2
     C                     MOVEL*BLANK    WN0143  1        EDI Status 3
     C                     MOVEL*BLANK    WN0144  1        Record Status
     C                     Z-ADD*ZERO     WN0145  60       Job Time
     C                     MOVEL*BLANK    WN0146 10        User Id
     C                     MOVEL*BLANK    WN0147 10        Job Name
     C                     Z-ADD*ZERO     WN0148  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWEAIC3    WFAIC3           Company Number
     C                     Z-ADDWEC4NB    WFC4NB           Order Number
     C                     Z-ADDWEDPNB    WFDPNB           Order Sequence
     C                     Z-ADDWEUENB    WFUENB           Order Secondary
     C                     Z-ADDWEJGDT    WFJGDT           OD Production D
      *
     C           KLCHSF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C                     KFLD           WFJGDT           OD Production D
     C           KLCHSF    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YBRDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADDWN0128    WFFLWG           OD Weight Sched
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##PGM     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Load ID            RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWBC4NB    WCC4NB           Order Number
      * Establish starting position
     C           KRSSG     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WURMNB           Load ID
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCRMNB    WURMNB           Load ID
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg Unit Wgt Chg Sts  CH - Company Item  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0149 30        Description Lin
     C                     MOVEL*BLANK    WN0150 30        Description Lin
     C                     MOVEL*BLANK    WN0151 32        Item Label Line
     C                     MOVEL*BLANK    WN0152 32        Item Label Line
     C                     MOVEL*BLANK    WN0153 32        Item Label Line
     C                     MOVEL*BLANK    WN0154 32        Item Label Line
     C                     MOVEL*BLANK    WN0155  2        UOM Primary
     C                     Z-ADD*ZERO     WN0156  94       Conversion Fact
     C                     MOVEL*BLANK    WN0157  1        Operation Facto
     C                     MOVEL*BLANK    WN0158  2        UOM Second
     C                     Z-ADD*ZERO     WN0159  94       Conversion Fact
     C                     MOVEL*BLANK    WN0160  1        Operation Facto
     C                     MOVEL*BLANK    WN0161  2        UOM Third
     C                     MOVEL*BLANK    WN0162  2        UOM Pricing
     C                     Z-ADD*ZERO     WN0163 112       Unit Weight
     C                     MOVEL*BLANK    WN0164  2        Quality Level
     C                     MOVEL*BLANK    WN0165  2        Item Level
     C                     MOVEL*BLANK    WN0166  1        Production Date
     C                     MOVEL*BLANK    WN0167  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0168 112       Minimum Weight
     C                     Z-ADD*ZERO     WN0169 112       Maximum Weight
     C                     Z-ADD*ZERO     WN0170  50       Number Cases On
     C                     Z-ADD*ZERO     WN0171  80       Vendor Item Def
     C                     Z-ADD*ZERO     WN0172  30       Item Structure
     C                     Z-ADD*ZERO     WN0173  30       Item Structure
     C                     Z-ADD*ZERO     WN0174  30       Item Structure
     C                     MOVEL*BLANK    WN0175  3        Default Commod
     C                     Z-ADD*ZERO     WN0176  30       Transportation
     C                     MOVEL*BLANK    WN0177  3        Item Type Code
     C                     MOVEL*BLANK    WN0178  1        Package Type Co
     C                     Z-ADD*ZERO     WN0179 112       Maximum Audit V
     C                     Z-ADD*ZERO     WN0180 112       Minimum Audit V
     C                     Z-ADD*ZERO     WN0181 114       Market Overage
     C                     Z-ADD*ZERO     WN0182 114       Standard Overag
     C                     MOVEL*BLANK    WN0183  7        Commodity Price
     C                     MOVEL*BLANK    WN0184  1        Item Pricing Op
     C                     Z-ADD*ZERO     WN0185 114       Item Pricing Co
     C                     MOVEL*BLANK    WN0186  3        Default Warehou
     C                     MOVEL*BLANK    WN0187  3        Price Method De
     C                     Z-ADD*ZERO     WN0188  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0189  2        Base_Conv_Loss
     C                     MOVEL*BLANK    WN0190  1        Variety_Rendere
     C                     MOVEL*BLANK    WN0191  1        Frozen Make to
     C                     MOVEL*BLANK    WN0192  1        Credit Item Sta
     C                     Z-ADD*ZERO     WN0193 112       Std Weight_Head
     C                     Z-ADD*ZERO     WN0194  70       Pieces Per Head
     C                     MOVEL*BLANK    WN0195  6        Department Code
     C                     MOVEL*BLANK    WN0196  1        Group for Packa
     C                     Z-ADD*ZERO     WN0197  20       Item Category N
     C                     MOVEL*BLANK    WN0198  3        Made to Order C
     C                     Z-ADD*ZERO     WN0199  20       Item Category N
     C                     MOVEL*BLANK    WN0200  3        Transportation
     C                     Z-ADD*ZERO     WN0201  20       Item Category N
     C                     MOVEL*BLANK    WN0202  3        Item Category C
     C                     Z-ADD*ZERO     WN0203  20       Item Category N
     C                     MOVEL*BLANK    WN0204  3        GL Sub Code
     C                     Z-ADD*ZERO     WN0205  20       Item Category N
     C                     MOVEL*BLANK    WN0206  3        Item Structure
     C                     Z-ADD*ZERO     WN0207  20       Item Category N
     C                     MOVEL*BLANK    WN0208  3        Item Primal Sch
     C                     Z-ADD*ZERO     WN0209  20       Item Category N
     C                     MOVEL*BLANK    WN0210  3        Item Exc Man Pr
     C                     Z-ADD*ZERO     WN0211  20       Item Category N
     C                     MOVEL*BLANK    WN0212  3        Item Prod Sched
     C                     Z-ADD*ZERO     WN0213  20       Item Category N
     C                     MOVEL*BLANK    WN0214  3        Item Category C
     C                     Z-ADD*ZERO     WN0215  20       Item Category N
     C                     MOVEL*BLANK    WN0216  3        Item Category C
     C                     Z-ADD*ZERO     WN0217  52       Pallet Tare Wei
     C                     Z-ADD*ZERO     WN0218  52       Misc Tare Weigh
     C                     Z-ADD*ZERO     WN0219  30       Production Lead
     C                     MOVEL*BLANK    WN0220  3        Packaging Code
     C                     MOVEL*BLANK    WN0221  3        Item Market Cod
     C                     MOVEL*BLANK    WN0222  1        TF Co_Ownership
     C                     Z-ADD*ZERO     WN0223  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WN0224  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WN0225  20       Agrimetrics gra
     C                     MOVEL*BLANK    WN0226  1        PA Base Avail R
     C                     Z-ADD*ZERO     WN0227 114       PM Pounds per H
     C                     Z-ADD*ZERO     WN0228  74       Item Frt Overag
     C                     Z-ADD*ZERO     WN0229  74       Packages per ca
     C                     Z-ADD*ZERO     WN0230  30       Use_Freeze_Sell
     C                     Z-ADD*ZERO     WN0231 114       PM Batch Size
     C                     Z-ADD*ZERO     WN0232 114       Package Level s
     C                     Z-ADD*ZERO     WN0233  70       Partial Item Co
     C                     Z-ADD*ZERO     WN0234  70       WIP Item Code
     C                     Z-ADD*ZERO     WN0235  70       WIP Reject Code
     C                     Z-ADD*ZERO     WN0236  92       Std Costing Uni
     C                     Z-ADD*ZERO     WN0237  92       FP Std Green We
     C                     Z-ADD*ZERO     WN0238 114       PM Std LBS Man
     C                     Z-ADD*ZERO     WN0239 114       PM Raw Meat LBS
     C                     Z-ADD*ZERO     WN0240 114       PM Formula LBS
     C                     Z-ADD*ZERO     WN0241 114       PM Finished LBS
     C                     MOVEL*BLANK    WN0242  3        SH Unused_was b
     C                     Z-ADD*ZERO     WN0243  30       PM Raw Material
     C                     Z-ADD*ZERO     WN0244  50       PM Line Number
     C                     MOVEL*BLANK    WN0245  1        Seconds Item
     C                     MOVEL*BLANK    WN0246  2        Print on Realiz
     C                     MOVEL*BLANK    WN0247  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0248  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0249  70       Bags Per Unit
     C                     MOVEL*BLANK    WN0250  1        Export_Domestic
     C                     MOVEL*BLANK    WN0251  1        Print On Schedu
     C                     MOVEL*BLANK    WN0252  1        Fresh Inv Alloc
     C                     MOVEL*BLANK    WN0253  1        Fresh Sched As
     C                     MOVEL*BLANK    WN0254  1        Frozen Inv Allo
     C                     MOVEL*BLANK    WN0255  6        Primal Group Co
     C                     MOVEL*BLANK    WN0256 12        Item Meat Cost
     C                     MOVEL*BLANK    WN0257 12        UPC Code 2
     C                     Z-ADD*ZERO     WN0258 112       Item Target Pri
     C                     Z-ADD*ZERO     WN0259 112       Minimum Piece W
     C                     Z-ADD*ZERO     WN0260 112       Maximum Piece W
     C                     Z-ADD*ZERO     WN0261  70       Seaboard Equiva
     C                     Z-ADD*ZERO     WN0262  70       Production Qty
     C                     MOVEL*BLANK    WN0263  1        Scheduling Posi
     C                     MOVEL*BLANK    WN0264  1        Sold 100 Percen
     C                     MOVEL*BLANK    WN0265  1        Maximum Shifts
     C                     MOVEL*BLANK    WN0266  1        Value Added Sts
     C                     MOVEL*BLANK    WN0267  2        Label Type
     C                     MOVEL*BLANK    WN0268  2        Item TF Exempt
     C                     MOVEL*BLANK    WN0269  3        Item TF Classif
     C                     MOVEL*BLANK    WN0270  3        Default Workcen
     C                     MOVEL*BLANK    WN0271  1        EDI Status 1
     C                     MOVEL*BLANK    WN0272  1        EDI Status 2
     C                     MOVEL*BLANK    WN0273  1        EDI Status 3
     C                     MOVEL*BLANK    WN0274  1        Record Status
     C                     Z-ADD*ZERO     WN0275  60       Job Time
     C                     MOVEL*BLANK    WN0276 10        User Id
     C                     MOVEL*BLANK    WN0277 10        Job Name
     C                     Z-ADD*ZERO     WN0278  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BZREJV
     C                     Z-ADDWL0004    WGAIC3           Company Number
     C                     Z-ADDWL0005    WGHGCD           Item Code
      *
     C           KLCHSH    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C           KLCHSH    CHAIN@BZREJV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CABZREL0'MDACP
     C                     MOVEL'@BZREJV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCABZ1    YCRDCS
      * Move non-key fields to @BZREJV
     C                     MOVELWL0006    WGX7ST    P      Unit Weight Cha
      *
      * Set PGM.*Record Data Changed flag
     C           QCABZ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCABZ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BZREJV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCABZREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt fun
      *================================================================
      * Rtv Tare Weight        XF - Company Item  * 
     C                     CALL 'PBI3XFR'              90  Rtv Tare Weight
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDAIC3    WQ0001  30       Company Number
     C                     PARM WDHGCD    WQ0002  70       Item Code
     C           YL0004    PARM YL0004    WQ0003  52       Misc Tare Weigh
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBI3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * WI464 get wt for order's pallet type
      * RTV Itm BxID & Tares  XF - Item Bill Of Material  * 
     C                     CALL 'PBI4XFR'              90  RTV Itm BxID &
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDAIC3    WQ0004  30       Company Number
     C                     PARM WDHGCD    WQ0005  70       Item Code
     C           YL0005    PARM *ZERO     WQ0006  52       Box Weight
     C           YL0006    PARM *ZERO     WQ0007  50       Number Cases On
     C           YL0007    PARM *ZERO     WQ0008  52       Pallet Tare Wei
     C           YL0008    PARM *ZERO     WQ0009  70       Box iD
     C                     PARM WDF5SX    WQ0010  2        OD Pallet Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           YL0005    ADD  YL0004    YL0009           Total Tare USR
      * Box + Misc Tare
      * LCL.Weight 1.1             .U =
      *    *COMPUTE ((x1 + x2) * x3)
      * x1    : LCL.Box Weight
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Misc Tare Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : DB1.Quantity Ordered
     C           YL0005    ADD  YL0004    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT WDAVQT    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0010           Weight 1.1
      * Pallet Tare
      * CASE: DB1.Palletize is yes
     C           WDVEST    IFEQ 'Y'                        *IF
      * CASE: LCL.Number Cases On A Pallet is GT Zero
     C           YL0006    IFGT 0                          *IF
      * Pallet Weight
      * LCL.Weight 1.2             .U =
      *    *COMPUTE (x1 / x2 * x3)
      * x1    : DB1.Quantity Ordered
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Number Cases On A Pallet
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Pallet Tare Weight
     C           WDAVQT    DIV  YL0006    W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT YL0007    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0011           Weight 1.2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0011           Weight 1.2
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0011           Weight 1.2
     C                     END                             *FI
      * Estimated Gross
      * DB1.OD Estimated Gross Weight =
      *    *COMPUTE (x1 + x2 + x3)
      * x1    : DB1.Weight Ordered
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Weight 1.1             .U
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.Weight 1.2             .U
     C           WDD0WG    ADD  YL0010    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  YL0011    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WDH8NX           OD Estimated Gr
      * E00196 RMC 8/24/12 chk pfs interface SHPTRN too
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           Production Lead
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WAILNB           Packages per ca
     C                     Z-ADD*ZERO     WACHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           Package Level s
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           FP Std Green We
     C                     Z-ADD*ZERO     WACWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBL8VA           Billing Detail
     C                     Z-ADD*ZERO     WBL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WBATWG           Weight Shipped
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WBNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WBNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WBNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WBNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WBBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBBVTM           Price Code
     C                     Z-ADD*ZERO     WBBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WBBXTM           Substitution Li
     C                     Z-ADD*ZERO     WBBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WBH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WBH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WBH7NX           OD Item Target
     C                     Z-ADD*ZERO     WBH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WBH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WBDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WBDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WBDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WBDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WBDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WBGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WBGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WBGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WBPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WBRINY           Item Age Days
     C                     Z-ADD*ZERO     WBTIDT           Production Ovr
     C                     Z-ADD*ZERO     WBTJDT           Production Ovr
     C                     Z-ADD*ZERO     WBTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WBTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WBTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WCA1WG           Order Weight To
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCVRVA           A/R order Value
     C                     Z-ADD*ZERO     WCB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WCNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WCNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WCNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WCNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WCNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WCBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WCBQTM           Time of Origina
     C                     Z-ADD*ZERO     WCBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WCBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WCBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WCH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WCH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WCH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WCH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WCH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEDPNB           Order Sequence
     C                     Z-ADD*ZERO     WEUENB           Order Secondary
     C                     Z-ADD*ZERO     WEJGDT           OD Production D
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WEFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WEIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WEF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WEIVQT           OD Quantity Unu
     C                     Z-ADD*ZERO     WEF4WG           OD Unused weigh
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Unused Parm - Value   USR
     C                     Z-ADD*ZERO     WUB5VL 112
      * Define work field Order Weight Total
     C                     Z-ADD*ZERO     WUA1WG 112
      * Define work field Load ID
     C                     Z-ADD*ZERO     WURMNB  70
      * Define work field Total Load Order Weight
     C                     Z-ADD*ZERO     WURPNB  70
      * Define work field Total Freight
     C                     Z-ADD*ZERO     WURQNB 112
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003 112
      * Define local variables for subroutine SHCHRC.
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
     C                     MOVEL*BLANK    WL0006  3
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Billing Activity Type
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Pricing Event Called From
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field Misc Tare Weight
     C                     Z-ADD*ZERO     YL0004  52
      * Define local work field Box Weight
     C                     Z-ADD*ZERO     YL0005  52
      * Define local work field Number Cases On A Pallet
     C                     Z-ADD*ZERO     YL0006  50
      * Define local work field Pallet Tare Weight
     C                     Z-ADD*ZERO     YL0007  52
      * Define local work field Box iD
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Total Tare USR
     C                     Z-ADD*ZERO     YL0009  52
      * Define local work field Weight 1.1             .U
     C                     Z-ADD*ZERO     YL0010  92
      * Define local work field Weight 1.2             .U
     C                     Z-ADD*ZERO     YL0011  92
      *================================================================
     CSR         ZZEXIT    ENDSR
