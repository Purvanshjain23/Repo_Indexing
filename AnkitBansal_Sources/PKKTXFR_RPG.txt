     H/TITLE AGP Int BO/TH Crt PCD XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:38:34
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKD0CPL1IF  E           K        DISK
      * RTV : Producer Contract History Retrieval index
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPKD2CPL2IF  E           K        DISK
      * RSQ : Producer Replacement Cost Prdcr/Effective Dt (D)
      *
     FPKD1CPL1IF  E           K        DISK
      * RTV : Producer Contract Damage  Retrieval index
      *
     FPKAWCPL0UF  E           K        DISK
      * UPD : Buy Order Header          Update index
      *
     FPKD1CPL0UF  E           K        DISK                      A
      * UPD : Producer Contract Damage  Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
     I@AWCPBI
      * Buy Order Header          Retrieval index
      * Renamed input format fields
     I              AWHMNB                          WAHMNB
     I              AWBNNB                          WABNNB
     I              AWARDT                          WAARDT
     I              AWASDT                          WAASDT
     I              AWA4ST                          WAA4ST
     I              AWA5ST                          WAA5ST
     I              AWAAPR                          WAAAPR
     I              AWA6ST                          WAA6ST
     I              AWA7ST                          WAA7ST
     I              AWB3ST                          WAB3ST
     I              AWALPR                          WAALPR
     I              AWETCD                          WAETCD
     I              AWEUCD                          WAEUCD
     I              AWJ5TX                          WAJ5TX
     I              AWD5DT                          WAD5DT
     I              AWD6DT                          WAD6DT
     I              AWD7DT                          WAD7DT
     I              AWD8DT                          WAD8DT
     I              AWD9DT                          WAD9DT
     I              AWJOEJ                          WAJOEJ
     I              AWKOFF                          WAKOFF
     I              AWKWPE                          WAKWPE
     I              AWIMBF                          WAIMBF
     I              AWOPTR                          WAOPTR
     I              AWOEJD                          WAOEJD
     I              AWIRMF                          WAIRMF
     I              AWJIRM                          WAJIRM
     I              AWJRKF                          WAJRKF
     I              AWKFIR                          WAKFIR
     I              AWUZST                          WAUZST
     I              AWU0ST                          WAU0ST
     I              AWU1ST                          WAU1ST
     I              AWU2ST                          WAU2ST
     I              AWU3ST                          WAU3ST
     I              AWHXNB                          WAHXNB
     I              AWGANB                          WAGANB
     I              AWGBNB                          WAGBNB
     I              AWABCD                          WAABCD
     I              AWAECD                          WAAECD
     I              AWAKCD                          WAAKCD
     I              AWALCD                          WAALCD
     I              AWAGCD                          WAAGCD
     I              AWAICD                          WAAICD
     I              AWAMCD                          WAAMCD
     I              AWACCD                          WAACCD
     I              AWAAVN                          WAAAVN
     I              AWAADT                          WAAADT
     I              AWAMTM                          WAAMTM
     I              AWAJST                          WAAJST
     I              AWAHVN                          WAAHVN
     I              AWAGVN                          WAAGVN
     I              AWABVN                          WAABVN
     I              AWABDT                          WAABDT
     I              AWABTM                          WAABTM
      *
     I@ACREAI
      * Producer                  Retrieval index
      * Renamed input format fields
     I              ACABCD                          WBABCD
     I              ACAGTX                          WBAGTX
     I              ACALNB                          WBALNB
     I              ACAATH                          WBAATH
     I              ACAMNB                          WBAMNB
     I              ACIWST                          WBIWST
     I              ACAPST                          WBAPST
     I              ACGCNB                          WBGCNB
     I              ACGJNB                          WBGJNB
     I              ACC2TX                          WBC2TX
     I              ACAACD                          WBAACD
     I              ACACCD                          WBACCD
     I              ACADCD                          WBADCD
     I              ACAAVN                          WBAAVN
     I              ACAADT                          WBAADT
     I              ACAMTM                          WBAMTM
     I              ACAJST                          WBAJST
     I              ACAHVN                          WBAHVN
     I              ACAGVN                          WBAGVN
     I              ACABVN                          WBABVN
     I              ACABDT                          WBABDT
     I              ACABTM                          WBABTM
      *
     I@AWCPAZ
      * Buy Order Header          Update index
      * Renamed input format fields
     I              AWHMNB                          WCHMNB
     I              AWBNNB                          WCBNNB
     I              AWARDT                          WCARDT
     I              AWASDT                          WCASDT
     I              AWA4ST                          WCA4ST
     I              AWA5ST                          WCA5ST
     I              AWAAPR                          WCAAPR
     I              AWA6ST                          WCA6ST
     I              AWA7ST                          WCA7ST
     I              AWB3ST                          WCB3ST
     I              AWALPR                          WCALPR
     I              AWETCD                          WCETCD
     I              AWEUCD                          WCEUCD
     I              AWJ5TX                          WCJ5TX
     I              AWD5DT                          WCD5DT
     I              AWD6DT                          WCD6DT
     I              AWD7DT                          WCD7DT
     I              AWD8DT                          WCD8DT
     I              AWD9DT                          WCD9DT
     I              AWJOEJ                          WCJOEJ
     I              AWKOFF                          WCKOFF
     I              AWKWPE                          WCKWPE
     I              AWIMBF                          WCIMBF
     I              AWOPTR                          WCOPTR
     I              AWOEJD                          WCOEJD
     I              AWIRMF                          WCIRMF
     I              AWJIRM                          WCJIRM
     I              AWJRKF                          WCJRKF
     I              AWKFIR                          WCKFIR
     I              AWUZST                          WCUZST
     I              AWU0ST                          WCU0ST
     I              AWU1ST                          WCU1ST
     I              AWU2ST                          WCU2ST
     I              AWU3ST                          WCU3ST
     I              AWHXNB                          WCHXNB
     I              AWGANB                          WCGANB
     I              AWGBNB                          WCGBNB
     I              AWABCD                          WCABCD
     I              AWAECD                          WCAECD
     I              AWAKCD                          WCAKCD
     I              AWALCD                          WCALCD
     I              AWAGCD                          WCAGCD
     I              AWAICD                          WCAICD
     I              AWAMCD                          WCAMCD
     I              AWACCD                          WCACCD
     I              AWAAVN                          WCAAVN
     I              AWAADT                          WCAADT
     I              AWAMTM                          WCAMTM
     I              AWAJST                          WCAJST
     I              AWAHVN                          WCAHVN
     I              AWAGVN                          WCAGVN
     I              AWABVN                          WCABVN
     I              AWABDT                          WCABDT
     I              AWABTM                          WCABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WDHMNB
     I              A1BNNB                          WDBNNB
     I              A1BONB                          WDBONB
     I              A1CVNB                          WDCVNB
     I              A1B0DT                          WDB0DT
     I              A1AWDT                          WDAWDT
     I              A1BICD                          WDBICD
     I              A1CPST                          WDCPST
     I              A1ACPR                          WDACPR
     I              A1B9PR                          WDB9PR
     I              A1CAPR                          WDCAPR
     I              A1C4ST                          WDC4ST
     I              A1AIPR                          WDAIPR
     I              A1A6DT                          WDA6DT
     I              A1C2ST                          WDC2ST
     I              A1CXNB                          WDCXNB
     I              A1CWNB                          WDCWNB
     I              A1FCNB                          WDFCNB
     I              A1H9NB                          WDH9NB
     I              A1FDNB                          WDFDNB
     I              A1FENB                          WDFENB
     I              A1HENB                          WDHENB
     I              A1HFNB                          WDHFNB
     I              A1CYNB                          WDCYNB
     I              A1LRNB                          WDLRNB
     I              A1E0NB                          WDE0NB
     I              A1A5PC                          WDA5PC
     I              A1FBNB                          WDFBNB
     I              A1A4PC                          WDA4PC
     I              A1F7NB                          WDF7NB
     I              A1HDNB                          WDHDNB
     I              A1F5NB                          WDF5NB
     I              A1F4NB                          WDF4NB
     I              A1F3NB                          WDF3NB
     I              A1F2NB                          WDF2NB
     I              A1AVPC                          WDAVPC
     I              A1AWPC                          WDAWPC
     I              A1CWPC                          WDCWPC
     I              A1A8PC                          WDA8PC
     I              A1A7PC                          WDA7PC
     I              A1B8PR                          WDB8PR
     I              A1AMPR                          WDAMPR
     I              A1ANPR                          WDANPR
     I              A1AYVA                          WDAYVA
     I              A1AWVA                          WDAWVA
     I              A1AOPR                          WDAOPR
     I              A1AXVA                          WDAXVA
     I              A1APPR                          WDAPPR
     I              A1ASPR                          WDASPR
     I              A1A4VA                          WDA4VA
     I              A1ATPR                          WDATPR
     I              A1A5VA                          WDA5VA
     I              A1CBPR                          WDCBPR
     I              A1CCPR                          WDCCPR
     I              A1LPNB                          WDLPNB
     I              A1CDPR                          WDCDPR
     I              A1A7VA                          WDA7VA
     I              A1A2PR                          WDA2PR
     I              A1JWST                          WDJWST
     I              A1CWST                          WDCWST
     I              A1D7ST                          WDD7ST
     I              A1D8ST                          WDD8ST
     I              A1DWST                          WDDWST
     I              A1D6ST                          WDD6ST
     I              A1GHNB                          WDGHNB
     I              A1BYDT                          WDBYDT
     I              A1E0ST                          WDE0ST
     I              A1E1ST                          WDE1ST
     I              A1E2ST                          WDE2ST
     I              A1BSDT                          WDBSDT
     I              A1BTDT                          WDBTDT
     I              A1BUDT                          WDBUDT
     I              A1HGNB                          WDHGNB
     I              A1HHNB                          WDHHNB
     I              A1HINB                          WDHINB
     I              A1A3PR                          WDA3PR
     I              A1A4PR                          WDA4PR
     I              A1A6PR                          WDA6PR
     I              A1J9NB                          WDJ9NB
     I              A1D6PR                          WDD6PR
     I              A1D7PR                          WDD7PR
     I              A1D8PR                          WDD8PR
     I              A1D9PR                          WDD9PR
     I              A1EAPR                          WDEAPR
     I              A1EBPR                          WDEBPR
     I              A1ECPR                          WDECPR
     I              A1EDPR                          WDEDPR
     I              A1EEPR                          WDEEPR
     I              A1EFPR                          WDEFPR
     I              A1EGPR                          WDEGPR
     I              A1EHPR                          WDEHPR
     I              A1KAST                          WDKAST
     I              A1J7ST                          WDJ7ST
     I              A1J9ST                          WDJ9ST
     I              A1OXNB                          WDOXNB
     I              A1LKST                          WDLKST
     I              A1LLST                          WDLLST
     I              A1J8ST                          WDJ8ST
     I              A1LIST                          WDLIST
     I              A1LJST                          WDLJST
     I              A1NZTX                          WDNZTX
     I              A1HJCD                          WDHJCD
     I              A1R4ST                          WDR4ST
     I              A1R5ST                          WDR5ST
     I              A1R6ST                          WDR6ST
     I              A1R7ST                          WDR7ST
     I              A1THWT                          WDTHWT
     I              A1T2WT                          WDT2WT
     I              A1THHD                          WDTHHD
     I              A1T2HD                          WDT2HD
     I              A1OBPR                          WDOBPR
     I              A1KOER                          WDKOER
     I              A1OPIR                          WDOPIR
     I              A1OPEM                          WDOPEM
     I              A1IORP                          WDIORP
     I              A1OWEO                          WDOWEO
     I              A1OQET                          WDOQET
     I              A1URST                          WDURST
     I              A1USST                          WDUSST
     I              A1HHPC                          WDHHPC
     I              A1S9PR                          WDS9PR
     I              A1TAPR                          WDTAPR
     I              A1TBPR                          WDTBPR
     I              A1JFUR                          WDJFUR
     I              A1KRIF                          WDKRIF
     I              A1KORF                          WDKORF
     I              A1KAPR                          WDKAPR
     I              A1KROT                          WDKROT
     I              A1OTJG                          WDOTJG
     I              A1IRJG                          WDIRJG
     I              A1IMJF                          WDIMJF
     I              A1IRGF                          WDIRGF
     I              A1KRJF                          WDKRJF
     I              A1OJRF                          WDOJRF
     I              A1KFOR                          WDKFOR
     I              A1ORJK                          WDORJK
     I              A1OMVJ                          WDOMVJ
     I              A1MVNF                          WDMVNF
     I              A1MCNF                          WDMCNF
     I              A1NCNF                          WDNCNF
     I              A1NCHF                          WDNCHF
     I              A1IGIR                          WDIGIR
     I              A1KFJR                          WDKFJR
     I              A1EADT                          WDEADT
     I              A1EBDT                          WDEBDT
     I              A1ECDT                          WDECDT
     I              A1EDDT                          WDEDDT
     I              A1EEDT                          WDEEDT
     I              A1U4ST                          WDU4ST
     I              A1U5ST                          WDU5ST
     I              A1U6ST                          WDU6ST
     I              A1U7ST                          WDU7ST
     I              A1U8ST                          WDU8ST
     I              A1U9ST                          WDU9ST
     I              A1VAST                          WDVAST
     I              A1VBST                          WDVBST
     I              A1BDCD                          WDBDCD
     I              A1CSCD                          WDCSCD
     I              A1ABCD                          WDABCD
     I              A1AECD                          WDAECD
     I              A1ACCD                          WDACCD
     I              A1AGCD                          WDAGCD
     I              A1BECD                          WDBECD
     I              A1AAVN                          WDAAVN
     I              A1AADT                          WDAADT
     I              A1AMTM                          WDAMTM
     I              A1AJST                          WDAJST
     I              A1AHVN                          WDAHVN
     I              A1AGVN                          WDAGVN
     I              A1ABVN                          WDABVN
     I              A1ABDT                          WDABDT
     I              A1ABTM                          WDABTM
      *
     I@D0CPYE
      * Producer Contract History Retrieval index
      * Renamed input format fields
     I              D0AKCD                          WEAKCD
     I              D0NKNB                          WENKNB
     I              D0QHST                          WEQHST
     I              D0DDDT                          WEDDDT
     I              D0DEDT                          WEDEDT
     I              D0NLNB                          WENLNB
     I              D0AWSH                          WEAWSH
     I              D0ADSH                          WEADSH
     I              D0KLDY                          WEKLDY
     I              D0AAVN                          WEAAVN
     I              D0AADT                          WEAADT
     I              D0AMTM                          WEAMTM
     I              D0AJST                          WEAJST
     I              D0AHVN                          WEAHVN
     I              D0AGVN                          WEAGVN
     I              D0ABVN                          WEABVN
     I              D0ABDT                          WEABDT
     I              D0ABTM                          WEABTM
      *
     I@AXCPBX
      * Buy Order Load            Retrieval index
      * Renamed input format fields
     I              AXHMNB                          WFHMNB
     I              AXBNNB                          WFBNNB
     I              AXBONB                          WFBONB
     I              AXCQDT                          WFCQDT
     I              AXABTH                          WFABTH
     I              AXACTH                          WFACTH
     I              AXBPNB                          WFBPNB
     I              AXCSNB                          WFCSNB
     I              AXAUDT                          WFAUDT
     I              AXCMST                          WFCMST
     I              AXAGPR                          WFAGPR
     I              AXATVA                          WFATVA
     I              AXI1ST                          WFI1ST
     I              AXDHNB                          WFDHNB
     I              AXDINB                          WFDINB
     I              AXCNST                          WFCNST
     I              AXGINB                          WFGINB
     I              AXBZDT                          WFBZDT
     I              AXLSNB                          WFLSNB
     I              AXF3TX                          WFF3TX
     I              AXO8ST                          WFO8ST
     I              AXO9ST                          WFO9ST
     I              AXPAST                          WFPAST
     I              AXLDSH                          WFLDSH
     I              AXPBST                          WFPBST
     I              AXPCST                          WFPCST
     I              AXPDST                          WFPDST
     I              AXUWST                          WFUWST
     I              AXUXST                          WFUXST
     I              AXUYST                          WFUYST
     I              AXJKRU                          WFJKRU
     I              AXKEOR                          WFKEOR
     I              AXIOEW                          WFIOEW
     I              AXKJIO                          WFKJIO
     I              AXIOJR                          WFIOJR
     I              AXEIRR                          WFEIRR
     I              AXITMF                          WFITMF
     I              AXODJE                          WFODJE
     I              AXRJIF                          WFRJIF
     I              AXOEJF                          WFOEJF
     I              AXD0DT                          WFD0DT
     I              AXD1DT                          WFD1DT
     I              AXD2DT                          WFD2DT
     I              AXD3DT                          WFD3DT
     I              AXD4DT                          WFD4DT
     I              AXBNCD                          WFBNCD
     I              AXABCD                          WFABCD
     I              AXAECD                          WFAECD
     I              AXAAVN                          WFAAVN
     I              AXAADT                          WFAADT
     I              AXAMTM                          WFAMTM
     I              AXAJST                          WFAJST
     I              AXAHVN                          WFAHVN
     I              AXAGVN                          WFAGVN
     I              AXABVN                          WFABVN
     I              AXABDT                          WFABDT
     I              AXABTM                          WFABTM
      *
     I@D2CPYQ
      * Producer Replacement Cost Prdcr/Effective Dt (D)
      * Renamed input format fields
     I              D2ABCD                          WGABCD
     I              D2DFDT                          WGDFDT
     I              D2M4PR                          WGM4PR
     I              D2AAVN                          WGAAVN
     I              D2AADT                          WGAADT
     I              D2AMTM                          WGAMTM
     I              D2AJST                          WGAJST
     I              D2AHVN                          WGAHVN
     I              D2AGVN                          WGAGVN
     I              D2ABVN                          WGABVN
     I              D2ABDT                          WGABDT
     I              D2ABTM                          WGABTM
      *
     I@D1CPYI
      * Producer Contract Damage  Retrieval index
      * Renamed input format fields
     I              D1AKCD                          WHAKCD
     I              D1HMNB                          WHHMNB
     I              D1BNNB                          WHBNNB
     I              D1BONB                          WHBONB
     I              D1CVNB                          WHCVNB
     I              D1B0DT                          WHB0DT
     I              D1NKNB                          WHNKNB
     I              D1QHST                          WHQHST
     I              D1CYNB                          WHCYNB
     I              D1LRNB                          WHLRNB
     I              D1F7NB                          WHF7NB
     I              D1FENB                          WHFENB
     I              D1E0NB                          WHE0NB
     I              D1HDNB                          WHHDNB
     I              D1HFNB                          WHHFNB
     I              D1NQNB                          WHNQNB
     I              D1CBPR                          WHCBPR
     I              D1MSPR                          WHMSPR
     I              D1MTPR                          WHMTPR
     I              D1MUPR                          WHMUPR
     I              D1MVPR                          WHMVPR
     I              D1EFVA                          WHEFVA
     I              D1EGVA                          WHEGVA
     I              D1EHVA                          WHEHVA
     I              D1MWPR                          WHMWPR
     I              D1MXPR                          WHMXPR
     I              D1MYPR                          WHMYPR
     I              D1MZPR                          WHMZPR
     I              D1ABCD                          WHABCD
     I              D1AECD                          WHAECD
     I              D1AAVN                          WHAAVN
     I              D1AADT                          WHAADT
     I              D1AMTM                          WHAMTM
     I              D1AJST                          WHAJST
     I              D1AHVN                          WHAHVN
     I              D1AGVN                          WHAGVN
     I              D1ABVN                          WHABVN
     I              D1ABDT                          WHABDT
     I              D1ABTM                          WHABTM
      *
     I@D1CPYH
      * Producer Contract Damage  Update index
      * Renamed input format fields
     I              D1AKCD                          WIAKCD
     I              D1HMNB                          WIHMNB
     I              D1BNNB                          WIBNNB
     I              D1BONB                          WIBONB
     I              D1CVNB                          WICVNB
     I              D1B0DT                          WIB0DT
     I              D1NKNB                          WINKNB
     I              D1QHST                          WIQHST
     I              D1CYNB                          WICYNB
     I              D1LRNB                          WILRNB
     I              D1F7NB                          WIF7NB
     I              D1FENB                          WIFENB
     I              D1E0NB                          WIE0NB
     I              D1HDNB                          WIHDNB
     I              D1HFNB                          WIHFNB
     I              D1NQNB                          WINQNB
     I              D1CBPR                          WICBPR
     I              D1MSPR                          WIMSPR
     I              D1MTPR                          WIMTPR
     I              D1MUPR                          WIMUPR
     I              D1MVPR                          WIMVPR
     I              D1EFVA                          WIEFVA
     I              D1EGVA                          WIEGVA
     I              D1EHVA                          WIEHVA
     I              D1MWPR                          WIMWPR
     I              D1MXPR                          WIMXPR
     I              D1MYPR                          WIMYPR
     I              D1MZPR                          WIMZPR
     I              D1ABCD                          WIABCD
     I              D1AECD                          WIAECD
     I              D1AAVN                          WIAAVN
     I              D1AADT                          WIAADT
     I              D1AMTM                          WIAMTM
     I              D1AJST                          WIAJST
     I              D1AHVN                          WIAHVN
     I              D1AGVN                          WIAGVN
     I              D1ABVN                          WIABVN
     I              D1ABDT                          WIABDT
     I              D1ABTM                          WIABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WJHMNB
     I              A1BNNB                          WJBNNB
     I              A1BONB                          WJBONB
     I              A1CVNB                          WJCVNB
     I              A1B0DT                          WJB0DT
     I              A1AWDT                          WJAWDT
     I              A1BICD                          WJBICD
     I              A1CPST                          WJCPST
     I              A1ACPR                          WJACPR
     I              A1B9PR                          WJB9PR
     I              A1CAPR                          WJCAPR
     I              A1C4ST                          WJC4ST
     I              A1AIPR                          WJAIPR
     I              A1A6DT                          WJA6DT
     I              A1C2ST                          WJC2ST
     I              A1CXNB                          WJCXNB
     I              A1CWNB                          WJCWNB
     I              A1FCNB                          WJFCNB
     I              A1H9NB                          WJH9NB
     I              A1FDNB                          WJFDNB
     I              A1FENB                          WJFENB
     I              A1HENB                          WJHENB
     I              A1HFNB                          WJHFNB
     I              A1CYNB                          WJCYNB
     I              A1LRNB                          WJLRNB
     I              A1E0NB                          WJE0NB
     I              A1A5PC                          WJA5PC
     I              A1FBNB                          WJFBNB
     I              A1A4PC                          WJA4PC
     I              A1F7NB                          WJF7NB
     I              A1HDNB                          WJHDNB
     I              A1F5NB                          WJF5NB
     I              A1F4NB                          WJF4NB
     I              A1F3NB                          WJF3NB
     I              A1F2NB                          WJF2NB
     I              A1AVPC                          WJAVPC
     I              A1AWPC                          WJAWPC
     I              A1CWPC                          WJCWPC
     I              A1A8PC                          WJA8PC
     I              A1A7PC                          WJA7PC
     I              A1B8PR                          WJB8PR
     I              A1AMPR                          WJAMPR
     I              A1ANPR                          WJANPR
     I              A1AYVA                          WJAYVA
     I              A1AWVA                          WJAWVA
     I              A1AOPR                          WJAOPR
     I              A1AXVA                          WJAXVA
     I              A1APPR                          WJAPPR
     I              A1ASPR                          WJASPR
     I              A1A4VA                          WJA4VA
     I              A1ATPR                          WJATPR
     I              A1A5VA                          WJA5VA
     I              A1CBPR                          WJCBPR
     I              A1CCPR                          WJCCPR
     I              A1LPNB                          WJLPNB
     I              A1CDPR                          WJCDPR
     I              A1A7VA                          WJA7VA
     I              A1A2PR                          WJA2PR
     I              A1JWST                          WJJWST
     I              A1CWST                          WJCWST
     I              A1D7ST                          WJD7ST
     I              A1D8ST                          WJD8ST
     I              A1DWST                          WJDWST
     I              A1D6ST                          WJD6ST
     I              A1GHNB                          WJGHNB
     I              A1BYDT                          WJBYDT
     I              A1E0ST                          WJE0ST
     I              A1E1ST                          WJE1ST
     I              A1E2ST                          WJE2ST
     I              A1BSDT                          WJBSDT
     I              A1BTDT                          WJBTDT
     I              A1BUDT                          WJBUDT
     I              A1HGNB                          WJHGNB
     I              A1HHNB                          WJHHNB
     I              A1HINB                          WJHINB
     I              A1A3PR                          WJA3PR
     I              A1A4PR                          WJA4PR
     I              A1A6PR                          WJA6PR
     I              A1J9NB                          WJJ9NB
     I              A1D6PR                          WJD6PR
     I              A1D7PR                          WJD7PR
     I              A1D8PR                          WJD8PR
     I              A1D9PR                          WJD9PR
     I              A1EAPR                          WJEAPR
     I              A1EBPR                          WJEBPR
     I              A1ECPR                          WJECPR
     I              A1EDPR                          WJEDPR
     I              A1EEPR                          WJEEPR
     I              A1EFPR                          WJEFPR
     I              A1EGPR                          WJEGPR
     I              A1EHPR                          WJEHPR
     I              A1KAST                          WJKAST
     I              A1J7ST                          WJJ7ST
     I              A1J9ST                          WJJ9ST
     I              A1OXNB                          WJOXNB
     I              A1LKST                          WJLKST
     I              A1LLST                          WJLLST
     I              A1J8ST                          WJJ8ST
     I              A1LIST                          WJLIST
     I              A1LJST                          WJLJST
     I              A1NZTX                          WJNZTX
     I              A1HJCD                          WJHJCD
     I              A1R4ST                          WJR4ST
     I              A1R5ST                          WJR5ST
     I              A1R6ST                          WJR6ST
     I              A1R7ST                          WJR7ST
     I              A1THWT                          WJTHWT
     I              A1T2WT                          WJT2WT
     I              A1THHD                          WJTHHD
     I              A1T2HD                          WJT2HD
     I              A1OBPR                          WJOBPR
     I              A1KOER                          WJKOER
     I              A1OPIR                          WJOPIR
     I              A1OPEM                          WJOPEM
     I              A1IORP                          WJIORP
     I              A1OWEO                          WJOWEO
     I              A1OQET                          WJOQET
     I              A1URST                          WJURST
     I              A1USST                          WJUSST
     I              A1HHPC                          WJHHPC
     I              A1S9PR                          WJS9PR
     I              A1TAPR                          WJTAPR
     I              A1TBPR                          WJTBPR
     I              A1JFUR                          WJJFUR
     I              A1KRIF                          WJKRIF
     I              A1KORF                          WJKORF
     I              A1KAPR                          WJKAPR
     I              A1KROT                          WJKROT
     I              A1OTJG                          WJOTJG
     I              A1IRJG                          WJIRJG
     I              A1IMJF                          WJIMJF
     I              A1IRGF                          WJIRGF
     I              A1KRJF                          WJKRJF
     I              A1OJRF                          WJOJRF
     I              A1KFOR                          WJKFOR
     I              A1ORJK                          WJORJK
     I              A1OMVJ                          WJOMVJ
     I              A1MVNF                          WJMVNF
     I              A1MCNF                          WJMCNF
     I              A1NCNF                          WJNCNF
     I              A1NCHF                          WJNCHF
     I              A1IGIR                          WJIGIR
     I              A1KFJR                          WJKFJR
     I              A1EADT                          WJEADT
     I              A1EBDT                          WJEBDT
     I              A1ECDT                          WJECDT
     I              A1EDDT                          WJEDDT
     I              A1EEDT                          WJEEDT
     I              A1U4ST                          WJU4ST
     I              A1U5ST                          WJU5ST
     I              A1U6ST                          WJU6ST
     I              A1U7ST                          WJU7ST
     I              A1U8ST                          WJU8ST
     I              A1U9ST                          WJU9ST
     I              A1VAST                          WJVAST
     I              A1VBST                          WJVBST
     I              A1BDCD                          WJBDCD
     I              A1CSCD                          WJCSCD
     I              A1ABCD                          WJABCD
     I              A1AECD                          WJAECD
     I              A1ACCD                          WJACCD
     I              A1AGCD                          WJAGCD
     I              A1BECD                          WJBECD
     I              A1AAVN                          WJAAVN
     I              A1AADT                          WJAADT
     I              A1AMTM                          WJAMTM
     I              A1AJST                          WJAJST
     I              A1AHVN                          WJAHVN
     I              A1AGVN                          WJAGVN
     I              A1ABVN                          WJABVN
     I              A1ABDT                          WJABDT
     I              A1ABTM                          WJABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKAW1    E DSPKAWCPL0
      * UPD : Buy Order Header          Update index
      * Renamed input format fields
     I              AWHMNB                          WCHMNB
     I              AWBNNB                          WCBNNB
     I              AWARDT                          WCARDT
     I              AWASDT                          WCASDT
     I              AWA4ST                          WCA4ST
     I              AWA5ST                          WCA5ST
     I              AWAAPR                          WCAAPR
     I              AWA6ST                          WCA6ST
     I              AWA7ST                          WCA7ST
     I              AWB3ST                          WCB3ST
     I              AWALPR                          WCALPR
     I              AWETCD                          WCETCD
     I              AWEUCD                          WCEUCD
     I              AWJ5TX                          WCJ5TX
     I              AWD5DT                          WCD5DT
     I              AWD6DT                          WCD6DT
     I              AWD7DT                          WCD7DT
     I              AWD8DT                          WCD8DT
     I              AWD9DT                          WCD9DT
     I              AWJOEJ                          WCJOEJ
     I              AWKOFF                          WCKOFF
     I              AWKWPE                          WCKWPE
     I              AWIMBF                          WCIMBF
     I              AWOPTR                          WCOPTR
     I              AWOEJD                          WCOEJD
     I              AWIRMF                          WCIRMF
     I              AWJIRM                          WCJIRM
     I              AWJRKF                          WCJRKF
     I              AWKFIR                          WCKFIR
     I              AWUZST                          WCUZST
     I              AWU0ST                          WCU0ST
     I              AWU1ST                          WCU1ST
     I              AWU2ST                          WCU2ST
     I              AWU3ST                          WCU3ST
     I              AWHXNB                          WCHXNB
     I              AWGANB                          WCGANB
     I              AWGBNB                          WCGBNB
     I              AWABCD                          WCABCD
     I              AWAECD                          WCAECD
     I              AWAKCD                          WCAKCD
     I              AWALCD                          WCALCD
     I              AWAGCD                          WCAGCD
     I              AWAICD                          WCAICD
     I              AWAMCD                          WCAMCD
     I              AWACCD                          WCACCD
     I              AWAAVN                          WCAAVN
     I              AWAADT                          WCAADT
     I              AWAMTM                          WCAMTM
     I              AWAJST                          WCAJST
     I              AWAHVN                          WCAHVN
     I              AWAGVN                          WCAGVN
     I              AWABVN                          WCABVN
     I              AWABDT                          WCABDT
     I              AWABTM                          WCABTM
      *
     IYARDCS      DS                            219
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKD11    E DSPKD1CPL0
      * UPD : Producer Contract Damage  Update index
      * Renamed input format fields
     I              D1AKCD                          WIAKCD
     I              D1HMNB                          WIHMNB
     I              D1BNNB                          WIBNNB
     I              D1BONB                          WIBONB
     I              D1CVNB                          WICVNB
     I              D1B0DT                          WIB0DT
     I              D1NKNB                          WINKNB
     I              D1QHST                          WIQHST
     I              D1CYNB                          WICYNB
     I              D1LRNB                          WILRNB
     I              D1F7NB                          WIF7NB
     I              D1FENB                          WIFENB
     I              D1E0NB                          WIE0NB
     I              D1HDNB                          WIHDNB
     I              D1HFNB                          WIHFNB
     I              D1NQNB                          WINQNB
     I              D1CBPR                          WICBPR
     I              D1MSPR                          WIMSPR
     I              D1MTPR                          WIMTPR
     I              D1MUPR                          WIMUPR
     I              D1MVPR                          WIMVPR
     I              D1EFVA                          WIEFVA
     I              D1EGVA                          WIEGVA
     I              D1EHVA                          WIEHVA
     I              D1MWPR                          WIMWPR
     I              D1MXPR                          WIMXPR
     I              D1MYPR                          WIMYPR
     I              D1MZPR                          WIMZPR
     I              D1ABCD                          WIABCD
     I              D1AECD                          WIAECD
     I              D1AAVN                          WIAAVN
     I              D1AADT                          WIAADT
     I              D1AMTM                          WIAMTM
     I              D1AJST                          WIAJST
     I              D1AHVN                          WIAHVN
     I              D1AGVN                          WIAGVN
     I              D1ABVN                          WIABVN
     I              D1ABDT                          WIABDT
     I              D1ABTM                          WIABTM
      *
     IYBRDCS      DS                            166
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WJHMNB
     I              A1BNNB                          WJBNNB
     I              A1BONB                          WJBONB
     I              A1CVNB                          WJCVNB
     I              A1B0DT                          WJB0DT
     I              A1AWDT                          WJAWDT
     I              A1BICD                          WJBICD
     I              A1CPST                          WJCPST
     I              A1ACPR                          WJACPR
     I              A1B9PR                          WJB9PR
     I              A1CAPR                          WJCAPR
     I              A1C4ST                          WJC4ST
     I              A1AIPR                          WJAIPR
     I              A1A6DT                          WJA6DT
     I              A1C2ST                          WJC2ST
     I              A1CXNB                          WJCXNB
     I              A1CWNB                          WJCWNB
     I              A1FCNB                          WJFCNB
     I              A1H9NB                          WJH9NB
     I              A1FDNB                          WJFDNB
     I              A1FENB                          WJFENB
     I              A1HENB                          WJHENB
     I              A1HFNB                          WJHFNB
     I              A1CYNB                          WJCYNB
     I              A1LRNB                          WJLRNB
     I              A1E0NB                          WJE0NB
     I              A1A5PC                          WJA5PC
     I              A1FBNB                          WJFBNB
     I              A1A4PC                          WJA4PC
     I              A1F7NB                          WJF7NB
     I              A1HDNB                          WJHDNB
     I              A1F5NB                          WJF5NB
     I              A1F4NB                          WJF4NB
     I              A1F3NB                          WJF3NB
     I              A1F2NB                          WJF2NB
     I              A1AVPC                          WJAVPC
     I              A1AWPC                          WJAWPC
     I              A1CWPC                          WJCWPC
     I              A1A8PC                          WJA8PC
     I              A1A7PC                          WJA7PC
     I              A1B8PR                          WJB8PR
     I              A1AMPR                          WJAMPR
     I              A1ANPR                          WJANPR
     I              A1AYVA                          WJAYVA
     I              A1AWVA                          WJAWVA
     I              A1AOPR                          WJAOPR
     I              A1AXVA                          WJAXVA
     I              A1APPR                          WJAPPR
     I              A1ASPR                          WJASPR
     I              A1A4VA                          WJA4VA
     I              A1ATPR                          WJATPR
     I              A1A5VA                          WJA5VA
     I              A1CBPR                          WJCBPR
     I              A1CCPR                          WJCCPR
     I              A1LPNB                          WJLPNB
     I              A1CDPR                          WJCDPR
     I              A1A7VA                          WJA7VA
     I              A1A2PR                          WJA2PR
     I              A1JWST                          WJJWST
     I              A1CWST                          WJCWST
     I              A1D7ST                          WJD7ST
     I              A1D8ST                          WJD8ST
     I              A1DWST                          WJDWST
     I              A1D6ST                          WJD6ST
     I              A1GHNB                          WJGHNB
     I              A1BYDT                          WJBYDT
     I              A1E0ST                          WJE0ST
     I              A1E1ST                          WJE1ST
     I              A1E2ST                          WJE2ST
     I              A1BSDT                          WJBSDT
     I              A1BTDT                          WJBTDT
     I              A1BUDT                          WJBUDT
     I              A1HGNB                          WJHGNB
     I              A1HHNB                          WJHHNB
     I              A1HINB                          WJHINB
     I              A1A3PR                          WJA3PR
     I              A1A4PR                          WJA4PR
     I              A1A6PR                          WJA6PR
     I              A1J9NB                          WJJ9NB
     I              A1D6PR                          WJD6PR
     I              A1D7PR                          WJD7PR
     I              A1D8PR                          WJD8PR
     I              A1D9PR                          WJD9PR
     I              A1EAPR                          WJEAPR
     I              A1EBPR                          WJEBPR
     I              A1ECPR                          WJECPR
     I              A1EDPR                          WJEDPR
     I              A1EEPR                          WJEEPR
     I              A1EFPR                          WJEFPR
     I              A1EGPR                          WJEGPR
     I              A1EHPR                          WJEHPR
     I              A1KAST                          WJKAST
     I              A1J7ST                          WJJ7ST
     I              A1J9ST                          WJJ9ST
     I              A1OXNB                          WJOXNB
     I              A1LKST                          WJLKST
     I              A1LLST                          WJLLST
     I              A1J8ST                          WJJ8ST
     I              A1LIST                          WJLIST
     I              A1LJST                          WJLJST
     I              A1NZTX                          WJNZTX
     I              A1HJCD                          WJHJCD
     I              A1R4ST                          WJR4ST
     I              A1R5ST                          WJR5ST
     I              A1R6ST                          WJR6ST
     I              A1R7ST                          WJR7ST
     I              A1THWT                          WJTHWT
     I              A1T2WT                          WJT2WT
     I              A1THHD                          WJTHHD
     I              A1T2HD                          WJT2HD
     I              A1OBPR                          WJOBPR
     I              A1KOER                          WJKOER
     I              A1OPIR                          WJOPIR
     I              A1OPEM                          WJOPEM
     I              A1IORP                          WJIORP
     I              A1OWEO                          WJOWEO
     I              A1OQET                          WJOQET
     I              A1URST                          WJURST
     I              A1USST                          WJUSST
     I              A1HHPC                          WJHHPC
     I              A1S9PR                          WJS9PR
     I              A1TAPR                          WJTAPR
     I              A1TBPR                          WJTBPR
     I              A1JFUR                          WJJFUR
     I              A1KRIF                          WJKRIF
     I              A1KORF                          WJKORF
     I              A1KAPR                          WJKAPR
     I              A1KROT                          WJKROT
     I              A1OTJG                          WJOTJG
     I              A1IRJG                          WJIRJG
     I              A1IMJF                          WJIMJF
     I              A1IRGF                          WJIRGF
     I              A1KRJF                          WJKRJF
     I              A1OJRF                          WJOJRF
     I              A1KFOR                          WJKFOR
     I              A1ORJK                          WJORJK
     I              A1OMVJ                          WJOMVJ
     I              A1MVNF                          WJMVNF
     I              A1MCNF                          WJMCNF
     I              A1NCNF                          WJNCNF
     I              A1NCHF                          WJNCHF
     I              A1IGIR                          WJIGIR
     I              A1KFJR                          WJKFJR
     I              A1EADT                          WJEADT
     I              A1EBDT                          WJEBDT
     I              A1ECDT                          WJECDT
     I              A1EDDT                          WJEDDT
     I              A1EEDT                          WJEEDT
     I              A1U4ST                          WJU4ST
     I              A1U5ST                          WJU5ST
     I              A1U6ST                          WJU6ST
     I              A1U7ST                          WJU7ST
     I              A1U8ST                          WJU8ST
     I              A1U9ST                          WJU9ST
     I              A1VAST                          WJVAST
     I              A1VBST                          WJVBST
     I              A1BDCD                          WJBDCD
     I              A1CSCD                          WJCSCD
     I              A1ABCD                          WJABCD
     I              A1AECD                          WJAECD
     I              A1ACCD                          WJACCD
     I              A1AGCD                          WJAGCD
     I              A1BECD                          WJBECD
     I              A1AAVN                          WJAAVN
     I              A1AADT                          WJAADT
     I              A1AMTM                          WJAMTM
     I              A1AJST                          WJAJST
     I              A1AHVN                          WJAHVN
     I              A1AGVN                          WJAGVN
     I              A1ABVN                          WJABVN
     I              A1ABDT                          WJABDT
     I              A1ABTM                          WJABTM
      *
     IYCRDCS      DS                            583
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  PC Contract Code
     I                                        1   5 P1AKCD
     IP2PARM      DS
      * I :  CC Company Number
     I                                    P   1   20P2HONB
     IP3PARM      DS
      * I :  Date From USR
     I                                    P   1   40P3B3DT
     IP4PARM      DS
      * I :  Date To   USR
     I                                    P   1   40P4B4DT
     IP5PARM      DS
      * FLD: *Arrays
      * I :  TH Source Code
     I                                        1   3 P5LKST
      * I :  BOH Commodity Market Code
     I                                        4   6 P5ETCD
      * I :  BOH Commodity Price Group
     I                                        7  13 P5EUCD
      * I :  BOH Market Date Method
     I                                       14  16 P5J5TX
      * I :  PO Option Code
     I                                       17  19 P5AICD
      * I :  CMP Program Code
     I                                       20  22 P5AMCD
      * I :  BOH Payment Type
     I                                       23  23 P5A4ST
      * I :  TH Payment Sts
     I                                       24  25 P5CWST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AKCD    PARM           WP0001  5        PC Contract Cod
     C           P2HONB    PARM           WP0002  30       CC Company Numb
     C           P3B3DT    PARM           WP0003  70       Date From USR
     C           P4B4DT    PARM           WP0004  70       Date To   USR
     C           P5LKST    PARM           WP0005  3        TH Source Code
     C           P5ETCD    PARM           WP0006  3        BOH Commodity M
     C           P5EUCD    PARM           WP0007  7        BOH Commodity P
     C           P5J5TX    PARM           WP0008  3        BOH Market Date
     C           P5AICD    PARM           WP0009  3        PO Option Code
     C           P5AMCD    PARM           WP0010  3        CMP Program Cod
     C           P5A4ST    PARM           WP0011  1        BOH Payment Typ
     C           P5CWST    PARM           WP0012  2        TH Payment Sts
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * AGP Int BO/TH Crt PCD XF
      * DOC: Increased Buy Order Number field length from 5 to 7.
     C                     EXSR UASUBR                     DOC: Increased
      * DOC: Change Buy Order Header and Tattoo Header
     C                     EXSR UBSUBR                     DOC: Change Buy
      * DOC: Create Producer Contract Damage
     C                     EXSR UCSUBR                     DOC: Create Pro
      * AGP Int BO/TH Crt PCD RT - Buy Order Header  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * AGP Int BO/TH Crt PCD RT - Buy Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  52       BOH Market Add/
     C                     MOVEL*BLANK    WN0002  2        BOH Quote Price
     C                     Z-ADD*ZERO     WN0003  52       BOH Quoted Base
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@AWCPBI                    *
     C                     READ @AWCPBI                  90*
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.BOH Kill Date GE PAR.Date From USR
      *   |- c2    : DB1.BOH Kill Date LE PAR.Date To   USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAASDT    IFGE P3B3DT                     *IF
     C           WAASDT    IFLE P4B4DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Producer Type     RT - Producer  * 
     C                     EXSR SBRVGN
      * CASE: WRK.SR Source Code EQ PAR.TH Source Code
     C           WUAACD    IFEQ P5LKST                     *IF
     C                     Z-ADD*ZERO     WN0001           BOH Market Add/
     C                     MOVEL*BLANK    WN0002           BOH Quote Price
     C                     Z-ADD*ZERO     WN0003           BOH Quoted Base
      * AGP Init BOH          CH - Buy Order Header  * 
     C                     EXSR SCCHRC
      * AGP Init TH           RT - Tattoo Header  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @AWCPBI                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Producer Type     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBABCD           PD Producer Cod
      * Setup key
     C                     MOVELWAABCD    WBABCD           PD Producer Cod
      * Establish starting position
     C           KRSSB     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAACD           SR Source Code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAACD    WUAACD           SR Source Code
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * AGP Init BOH          CH - Buy Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0004  70       BOH Buy Order D
     C                     Z-ADD*ZERO     WN0005  70       BOH Kill Date
     C                     MOVEL*BLANK    WN0006  1        BOH Buy Order T
     C                     MOVEL*BLANK    WN0007  1        BOH Status
     C                     MOVEL*BLANK    WN0008  1        BOH Delv Plan P
     C                     Z-ADD*ZERO     WN0009  70       BOH MPR Reporti
     C                     Z-ADD*ZERO     WN0010  70       BOH Hedge Date
     C                     Z-ADD*ZERO     WN0011  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0012  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0013  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0014  70       BOH Hedge Head
     C                     Z-ADD*ZERO     WN0015  70       BOH Hedge Refer
     C                     Z-ADD*ZERO     WN0016  70       BOH Hedge Time
     C                     Z-ADD*ZERO     WN0017  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0018  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0019  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0020  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0021 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0022 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0023 112       BOH Unused Nbr
     C                     MOVEL*BLANK    WN0024  1        BOH MPR Reporti
     C                     MOVEL*BLANK    WN0025  1        BOH MPR EST RPT
     C                     MOVEL*BLANK    WN0026  2        BOH MPR Purchas
     C                     MOVEL*BLANK    WN0027  3        BOH Status 4
     C                     MOVEL*BLANK    WN0028  3        BOH Status 5
     C                     Z-ADD*ZERO     WN0029  30       PPWS Company Nu
     C                     Z-ADD*ZERO     WN0030  40       CW Year
     C                     Z-ADD*ZERO     WN0031  20       CW Week Number
     C                     MOVEL*BLANK    WN0032  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0033  6        PL Location Cod
     C                     MOVEL*BLANK    WN0034  5        PC Contract Cod
     C                     MOVEL*BLANK    WN0035  5        PSC Sub-Contrac
     C                     MOVEL*BLANK    WN0036  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0037  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0038 10        RS User Changed
     C                     Z-ADD*ZERO     WN0039  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0040  60       RS Time Changed
     C                     MOVEL*BLANK    WN0041  1        RS Record Statu
     C                     MOVEL*BLANK    WN0042 10        RS Job
     C                     MOVEL*BLANK    WN0043 10        RS Program
     C                     MOVEL*BLANK    WN0044 10        RS User Added
     C                     Z-ADD*ZERO     WN0045  70       RS Date Added
     C                     Z-ADD*ZERO     WN0046  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AWCPAZ
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C           KLCHSC    CHAIN@AWCPAZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAWCPL0'MDACP
     C                     MOVEL'@AWCPAZ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAW1    YARDCS
      * Move non-key fields to @AWCPAZ
     C                     MOVELP5A4ST    WCA4ST    P      BOH Payment Typ
     C                     Z-ADDWN0001    WCAAPR           BOH Market Add/
     C                     MOVELWN0002    WCB3ST    P      BOH Quote Price
     C                     Z-ADDWN0003    WCALPR           BOH Quoted Base
     C                     MOVELP5ETCD    WCETCD    P      BOH Commodity M
     C                     MOVELP5EUCD    WCEUCD    P      BOH Commodity P
     C                     MOVELP5J5TX    WCJ5TX    P      BOH Market Date
     C                     MOVELP5AICD    WCAICD    P      PO Option Code
     C                     MOVELP5AMCD    WCAMCD    P      CMP Program Cod
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AWCPAZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAWCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * AGP Init TH           RT - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0047  40       Calendar Year
     C                     MOVEL*BLANK    WN0048  1        Calendar Quarte
     C                     Z-ADD*ZERO     WN0049  52       Head Analyzed P
     C                     Z-ADD*ZERO     WN0050  72       Additional Rep
     C                     Z-ADD*ZERO     WN0051  72       Actual Rep Cost
     C                     Z-ADD*ZERO     WN0052  52       Actual Rep Cost
     C                     Z-ADD*ZERO     WN0053  52       Actual Rep Cost
     C                     Z-ADD*ZERO     WN0054  92       Contract Paymen
     C                     Z-ADD*ZERO     WN0055  92       Additional Cont
     C                     Z-ADD*ZERO     WN0056  92       Contract Cost A
     C                     Z-ADD*ZERO     WN0057  52       Contract Cost /
     C                     Z-ADD*ZERO     WN0058  52       Contract Cost /
     C                     Z-ADD*ZERO     WN0059  52       Actual-Contract
     C                     Z-ADD*ZERO     WN0060  52       Actual-Contract
     C                     MOVEL*BLANK    WN0061 10        RS User Changed
     C                     Z-ADD*ZERO     WN0062  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0063  60       RS Time Changed
     C                     MOVEL*BLANK    WN0064  1        RS Record Statu
     C                     MOVEL*BLANK    WN0065 10        RS Job
     C                     MOVEL*BLANK    WN0066 10        RS Program
     C                     MOVEL*BLANK    WN0067 10        RS User Added
     C                     Z-ADD*ZERO     WN0068  70       RS Date Added
     C                     Z-ADD*ZERO     WN0069  60       RS Time Added
     C                     Z-ADD*ZERO     WN0070  72       PRC Replacement
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSD01           BOH Company Num
     C           *LIKE     DEFN WDBNNB    WQSD02           BOH Buy Order N
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           BOH Company Num
     C                     KFLD           WQSD02           BOH Buy Order N
      * Setup key
     C                     Z-ADDWAHMNB    WQSD01           BOH Company Num
     C                     Z-ADDWABNNB    WQSD02           BOH Buy Order N
      * Establish starting position
     C           KRSSD     SETLL@A1CPC4                    *
     C           KRSSD     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Hog Class Type is Resale
     C           WDLLST    IFEQ 'R'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Year/Quarter      RT - Producer Contract History  * 
     C                     EXSR SERVGN
      * Head Analyzed Percent
      * CASE: DB1.TH Head Killed is Not Zero
     C           WDFENB    IFNE 0                          *IF
      * Head Analyzed Percent
      * PAR.Head Analyzed Percent =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : DB1.TH Head Accepted
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : DB1.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WDHFNB    DIV  WDFENB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0049           Head Analyzed P
     C                     END                             *FI
      * Rtv Exp Paid By Who - Buy Order Load  * 
     C                     EXSR SFRVGN
      * Seaboard Freight
      * CASE: WRK.BOL Freight Exp Paid By is Seaboard
     C           WUO8ST    IFEQ 'S'                        *IF
     C                     Z-ADDWDCDPR    WN0050           Additional Rep
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0050           Additional Rep
     C                     END                             *FI
      * Calc Additional Replacement Cost if found for producer
      * Rtv Prdcr Rplcmnt Cst RT - Producer Replacement Cost  * 
     C                     EXSR SGRVGN
      *   Calc the additional replacement cost
      * CASE: PAR.PRC Replacement Cost is Not Zeros
     C           WN0070    IFNE 0                          *IF
      * Additional Rep Cost
      * PAR.Additional Rep Cost Amt =
      *    *COMPUTE (x3 + (x1 * x2))
      * x3    : PAR.Additional Rep Cost Amt
      * +     : PGM.*Synon (17,7) work field
      * x1    : DB1.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PRC Replacement Cost
     C           WDFENB    MULT WN0070    W0WA01           *Synon (15,2) w
     C           WN0050    ADD  W0WA01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0050           Additional Rep
     C                     END                             *FI
      * Actual Rep Cost
      * PAR.Actual Rep Cost Amt =
      *    *COMPUTE (x1 + x2)
      * x1    : DB1.TH Payment Gross
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Additional Rep Cost Amt
     C           WDCBPR    ADD  WN0050    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0051           Actual Rep Cost
      * Actual Rep Cost /HD
      * CASE: DB1.TH Head Killed is Not Zero
     C           WDFENB    IFNE 0                          *IF
      * Actual Rep Cost /Hd
      * PAR.Actual Rep Cost /Hd =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Actual Rep Cost Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Head Killed
     C           WN0051    DIV  WDFENB    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0052           Actual Rep Cost
     C                     END                             *FI
      * Actual Rep Cost /Lv CWT
      * CASE: DB1.TH Live Wgt is Greater then Zero
     C           WDCYNB    IFGT 0                          *IF
      * Actual Rep Cost /Lv CWT
      * PAR.Actual Rep Cost /Lv CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Actual Rep Cost Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WDCYNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0051    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0053           Actual Rep Cost
     C                     END                             *FI
      * Additional Contract Amt
      * PAR.Additional Contract Amt =
      *    *COMPUTE (x1 * x2)
      * x1    : DB1.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.1
     C           WDFENB    MULT 1         W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0055           Additional Cont
      * Upd Actual Pay        RT - Producer Contract Damage  * 
     C                     EXSR SHRVGN
      * AGP Init TH           CH - Tattoo Header  * 
     C                     EXSR SKCHRC
     C                     END                             *FI
     C           KRSSD     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Year/Quarter      RT - Producer Contract History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAKCD    WQSE01           PC Contract Cod
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           PC Contract Cod
      * Setup key
     C                     MOVELP1AKCD    WQSE01           PC Contract Cod
      * Establish starting position
     C           KRSSE     SETLL@D0CPYE                    *
     C           KRSSE     READE@D0CPYE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0744' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0047           Calendar Year
     C                     MOVEL*BLANK    WN0048           Calendar Quarte
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.TH Kill Date GE DB1.Calendar Quarter Start
      *   |- c2    : PAR.TH Kill Date LE DB1.Calendar Quarter End
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDB0DT    IFGE WEDDDT                     *IF
     C           WDB0DT    IFLE WEDEDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PAR = DB1 By name
     C                     Z-ADDWENKNB    WN0047           Calendar Year
     C                     MOVELWEQHST    WN0048           Calendar Quarte
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSE     READE@D0CPYE                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Exp Paid By Who - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
      * Setup key
     C                     Z-ADDWDHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WFBONB           BOL Load Number
      * Establish starting position
     C           KRSSF     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFO8ST    WUO8ST           BOL Freight Exp
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Rplcmnt Cst RT - Producer Replacement Cost  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGABCD    WQSG01           PD Producer Cod
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           PD Producer Cod
     C                     KFLD           WGDFDT           PRC Effective D
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           PD Producer Cod
      * Setup key
     C                     MOVELWDABCD    WQSG01           PD Producer Cod
     C                     Z-ADDWDB0DT    WGDFDT           PRC Effective D
      * Establish starting position
     C           KPSSG     SETLL@D2CPYQ                    *
     C           KRSSG     READE@D2CPYQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0753' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0070           PRC Replacement
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGM4PR    WN0070           PRC Replacement
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@D2CPYQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Upd Actual Pay        RT - Producer Contract Damage  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHAKCD           PC Contract Cod
     C                     KFLD           WHHMNB           BOH Company Num
     C                     KFLD           WHBNNB           BOH Buy Order N
     C                     KFLD           WHBONB           BOL Load Number
     C                     KFLD           WHCVNB           TH Tattoo Numbe
     C                     KFLD           WHB0DT           TH Kill Date
      * Setup key
     C                     MOVELP1AKCD    WHAKCD           PC Contract Cod
     C                     Z-ADDWDHMNB    WHHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WHBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WHBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WHCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WHB0DT           TH Kill Date
      * Establish starting position
     C           KRSSH     CHAIN@D1CPYI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0746' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Prd Cntrct Damage CR - Producer Contract Damage  * 
     C                     EXSR SICRRC
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Actual Pay        CH - Producer Contract Damage  * 
     C                     EXSR SJCHRC
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt Prd Cntrct Damage CR - Producer Contract Damage  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D1CPYH
     C                     MOVELP1AKCD    WIAKCD           PC Contract Cod
     C                     Z-ADDWDHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WIBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WIB0DT           TH Kill Date
     C                     Z-ADDWN0047    WINKNB           Calendar Year
     C                     MOVELWN0048    WIQHST           Calendar Quarte
     C                     Z-ADDWDCYNB    WICYNB           TH Live Wgt
     C                     Z-ADDWDLRNB    WILRNB           TH Adj Live Wgt
     C                     Z-ADDWDF7NB    WIF7NB           TH Avg Live Wgt
     C                     Z-ADDWDFENB    WIFENB           TH Head Killed
     C                     Z-ADDWDE0NB    WIE0NB           TH Hot Wgt
     C                     Z-ADDWDHDNB    WIHDNB           TH Avg Hot Wgt
     C                     Z-ADDWDHFNB    WIHFNB           TH Head Accepte
     C                     Z-ADDWN0049    WINQNB           Head Analyzed P
     C                     Z-ADDWDCBPR    WICBPR           TH Payment Gros
     C                     Z-ADDWN0050    WIMSPR           Additional Rep
     C                     Z-ADDWN0051    WIMTPR           Actual Rep Cost
     C                     Z-ADDWN0052    WIMUPR           Actual Rep Cost
     C                     Z-ADDWN0053    WIMVPR           Actual Rep Cost
     C                     Z-ADDWN0054    WIEFVA           Contract Paymen
     C                     Z-ADDWN0055    WIEGVA           Additional Cont
     C                     Z-ADDWN0056    WIEHVA           Contract Cost A
     C                     Z-ADDWN0057    WIMWPR           Contract Cost /
     C                     Z-ADDWN0058    WIMXPR           Contract Cost /
     C                     Z-ADDWN0059    WIMYPR           Actual-Contract
     C                     Z-ADDWN0060    WIMZPR           Actual-Contract
     C                     MOVELWDABCD    WIABCD           PD Producer Cod
     C                     MOVELWDAECD    WIAECD           PL Location Cod
     C                     MOVEL*BLANK    WIAAVN           RS User Changed
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL*BLANK    WIAHVN           RS Job
     C                     MOVEL*BLANK    WIAGVN           RS Program
     C                     MOVEL*BLANK    WIABVN           RS User Added
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRSI    KLIST
     C                     KFLD           WIAKCD           PC Contract Cod
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRSI    SETLL@D1CPYH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0747' W0RTN   7
      * Send message 'Producer Contract Dama EX'
     C                     MOVEL'PRK0747' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@D1CPYH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Actual Pay        CH - Producer Contract Damage  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0071  92       Contract Paymen
     C                     Z-ADD*ZERO     WN0072  92       Contract Cost A
     C                     Z-ADD*ZERO     WN0073  52       Contract Cost /
     C                     Z-ADD*ZERO     WN0074  52       Contract Cost /
     C                     Z-ADD*ZERO     WN0075  52       Actual-Contract
     C                     Z-ADD*ZERO     WN0076  52       Actual-Contract
     C                     MOVEL*BLANK    WN0077 10        RS User Changed
     C                     Z-ADD*ZERO     WN0078  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0079  60       RS Time Changed
     C                     MOVEL*BLANK    WN0080  1        RS Record Statu
     C                     MOVEL*BLANK    WN0081 10        RS Job
     C                     MOVEL*BLANK    WN0082 10        RS Program
     C                     MOVEL*BLANK    WN0083 10        RS User Added
     C                     Z-ADD*ZERO     WN0084  70       RS Date Added
     C                     Z-ADD*ZERO     WN0085  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @D1CPYH
     C                     MOVELP1AKCD    WIAKCD    P      PC Contract Cod
     C                     Z-ADDWDHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WIBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WIB0DT           TH Kill Date
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WIAKCD           PC Contract Cod
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C           KLCHSJ    CHAIN@D1CPYH              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKD1CPL0'MDACP
     C                     MOVEL'@D1CPYH' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKD11    YBRDCS
      * Move non-key fields to @D1CPYH
     C                     Z-ADDWN0047    WINKNB           Calendar Year
     C                     MOVELWN0048    WIQHST    P      Calendar Quarte
     C                     Z-ADDWDCYNB    WICYNB           TH Live Wgt
     C                     Z-ADDWDLRNB    WILRNB           TH Adj Live Wgt
     C                     Z-ADDWDF7NB    WIF7NB           TH Avg Live Wgt
     C                     Z-ADDWDFENB    WIFENB           TH Head Killed
     C                     Z-ADDWDE0NB    WIE0NB           TH Hot Wgt
     C                     Z-ADDWDHDNB    WIHDNB           TH Avg Hot Wgt
     C                     Z-ADDWDHFNB    WIHFNB           TH Head Accepte
     C                     Z-ADDWN0049    WINQNB           Head Analyzed P
     C                     Z-ADDWDCBPR    WICBPR           TH Payment Gros
     C                     Z-ADDWN0050    WIMSPR           Additional Rep
     C                     Z-ADDWN0051    WIMTPR           Actual Rep Cost
     C                     Z-ADDWN0052    WIMUPR           Actual Rep Cost
     C                     Z-ADDWN0053    WIMVPR           Actual Rep Cost
     C                     Z-ADDWN0055    WIEGVA           Additional Cont
     C                     MOVELWDABCD    WIABCD    P      PD Producer Cod
     C                     MOVELWDAECD    WIAECD    P      PL Location Cod
      *
      * Set PGM.*Record Data Changed flag
     C           QPKD11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@D1CPYH                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKD1CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * AGP Init TH           CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0086  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0087 10        TH Group Refere
     C                     MOVEL*BLANK    WN0088  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0089  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0090  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0091  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0092  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0093  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0094  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0095  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0096  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0097  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0098  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0099  50       TH Held Over
     C                     Z-ADD*ZERO     WN0100  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0101  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0102  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0103  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0104  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0105  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0106  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0107  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0108  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0109  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0110  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0111  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0112  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0113  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0114  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0115  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0116  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0117  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0118  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0119  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0120  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0121  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0122  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0123  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0124  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0125  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0126  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0127  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0128  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0129  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0130  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0131  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0132  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0133  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0134  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0135  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0136  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0137  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0138  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0139  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0140  1        TH Header Error
     C                     MOVEL*BLANK    WN0141  1        TH Detail Error
     C                     MOVEL*BLANK    WN0142  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0143  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0144  80       TH Commission A
     C                     Z-ADD*ZERO     WN0145  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0146  1        TH User Error O
     C                     MOVEL*BLANK    WN0147  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0148  1        TH Sex
     C                     Z-ADD*ZERO     WN0149  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0150  70       TH Commission P
     C                     Z-ADD*ZERO     WN0151  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0152  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0153  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0154  31       TH FFLI
     C                     Z-ADD*ZERO     WN0155  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0156  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0157  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0158  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0159  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0160  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0161  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0162  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0163  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0164  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0165  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0166  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0167  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0168  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0169  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0170  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0171  1        TH Source Type
     C                     MOVEL*BLANK    WN0172  1        TH Scale Ticket
     C                     Z-ADD*ZERO     WN0173  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0174  3        TH Source Code
     C                     MOVEL*BLANK    WN0175  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0176  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0177  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0178  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0179  3        TH State
     C                     MOVEL*BLANK    WN0180  3        TH Unused Code
     C                     MOVEL*BLANK    WN0181  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0182  1        TH Commission S
     C                     MOVEL*BLANK    WN0183  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0184  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0185  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0186  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0187  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0188  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0189  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0190  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0191  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0192  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0193  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0194  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0195  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0196  3        TH PHA Average
     C                     MOVEL*BLANK    WN0197  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0198  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0199  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0200  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0201  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0202  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0203  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0204  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0205  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0206  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0207  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0208  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0209  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0210 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0211 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0212 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0213 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0214  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0215  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0216  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0217  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0218  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0219  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0220  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0221  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0222  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0223  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0224  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0225  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0226  70       TH Unused Date
     C                     MOVEL*BLANK    WN0227  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0228  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0229  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0230  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0231  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0232  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0233  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0234  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0235  6        DF Defect Code
     C                     MOVEL*BLANK    WN0236  6        THP Process Cod
     C                     MOVEL*BLANK    WN0237  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0238  6        PL Location Cod
     C                     MOVEL*BLANK    WN0239  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0240  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0241  3        HC Class Code
     C                     MOVEL*BLANK    WN0242 10        RS User Changed
     C                     Z-ADD*ZERO     WN0243  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0244  60       RS Time Changed
     C                     MOVEL*BLANK    WN0245  1        RS Record Statu
     C                     MOVEL*BLANK    WN0246 10        RS Job
     C                     MOVEL*BLANK    WN0247 10        RS Program
     C                     MOVEL*BLANK    WN0248 10        RS User Added
     C                     Z-ADD*ZERO     WN0249  70       RS Date Added
     C                     Z-ADD*ZERO     WN0250  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWDHMNB    WJHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WJBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WJBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WJCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WJB0DT           TH Kill Date
      *
     C           KLCHSK    KLIST
     C                     KFLD           WJHMNB           BOH Company Num
     C                     KFLD           WJBNNB           BOH Buy Order N
     C                     KFLD           WJBONB           BOL Load Number
     C                     KFLD           WJCVNB           TH Tattoo Numbe
     C                     KFLD           WJB0DT           TH Kill Date
     C           KLCHSK    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YCRDCS
      * Move non-key fields to @A1CPC5
     C                     MOVELP5CWST    WJCWST    P      TH Payment Sts
     C                     MOVELP5A4ST    WJJ9ST    P      TH Payment Type
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * DOC: Increased Buy Order Number field length from 5 to 7.
      *================================================================
      * H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Num
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * DOC: Change Buy Order Header and Tattoo Header
      *================================================================
      * Buy Order with Buy Order Type = O and its associated Market
      * and Subject Tattoos are changed as follows:
      * BOH     Payment Type = C
      *         Carcass Merit Program = SB3
      *         Commodity Market Code = ISM
      *         Commodity Group Code = SG
      *         Market Date Method = CUR
      *         Pricing Option Code = CBP
      * TH      Payment Type = C
      *         Payment Status = SC
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * DOC: Create Producer Contract Damage
      *================================================================
      * At the same time the Buy Order Header and the Tattoo Header
      * are changed, create the actual payment (Replacement Cost)
      * information in the Producer Contract Damage.
      * After the Payment Edit has finished.  We would run another
      * program that will update the Producer Contract Damage with
      * new calculated Gross and etc.
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WAARDT           BOH Buy Order D
     C                     Z-ADD*ZERO     WAASDT           BOH Kill Date
     C                     Z-ADD*ZERO     WAAAPR           BOH Market Add/
     C                     Z-ADD*ZERO     WAALPR           BOH Quoted Base
     C                     Z-ADD*ZERO     WAD5DT           BOH MPR Reporti
     C                     Z-ADD*ZERO     WAD6DT           BOH Hedge Date
     C                     Z-ADD*ZERO     WAD7DT           BOH Unused Date
     C                     Z-ADD*ZERO     WAD8DT           BOH Unused Date
     C                     Z-ADD*ZERO     WAD9DT           BOH Unused Date
     C                     Z-ADD*ZERO     WAJOEJ           BOH Hedge Head
     C                     Z-ADD*ZERO     WAKOFF           BOH Hedge Refer
     C                     Z-ADD*ZERO     WAKWPE           BOH Hedge Time
     C                     Z-ADD*ZERO     WAIMBF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAOPTR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAOEJD           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAIRMF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAJIRM           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAJRKF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAKFIR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAHXNB           PPWS Company Nu
     C                     Z-ADD*ZERO     WAGANB           CW Year
     C                     Z-ADD*ZERO     WAGBNB           CW Week Number
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field SR Source Code
     C                     MOVEL*BLANK    WUAACD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBALNB           PD Production C
     C                     Z-ADD*ZERO     WBAATH           PD Std Delv Tim
     C                     Z-ADD*ZERO     WBAMNB           PD Std Truck Si
     C                     Z-ADD*ZERO     WBGCNB           PD VND Address
     C                     Z-ADD*ZERO     WBGJNB           PD EDI Trading
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WDACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WDB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WDCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WDAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WDA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WDCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WDCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WDFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WDH9NB           TH Held Over
     C                     Z-ADD*ZERO     WDFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WDFENB           TH Head Killed
     C                     Z-ADD*ZERO     WDHENB           TH Head Adds
     C                     Z-ADD*ZERO     WDHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WDCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WDLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WDE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WDA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WDFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WDA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WDF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WDHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WDF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WDF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WDF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WDF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WDAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WDAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WDCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WDA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WDA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WDB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WDAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WDAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WDAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WDAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WDAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WDASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WDA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WDATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WDA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WDCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WDCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WDLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WDCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WDA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WDA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WDGHNB           TH Commission A
     C                     Z-ADD*ZERO     WDBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WDBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WDBTDT           TH Commission P
     C                     Z-ADD*ZERO     WDBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WDHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WDHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WDHINB           TH FFLI
     C                     Z-ADD*ZERO     WDA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WDA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WDA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WDJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WDD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WDD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WDD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WDD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WDEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WDEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WDECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WDEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WDEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WDEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WDOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WDTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WDT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WDTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WDT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WDOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WDKOER           TH Head Identif
     C                     Z-ADD*ZERO     WDOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WDOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WDIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WDOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WDHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WDS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WDTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WDTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WDJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WDKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WDKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WDKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WDKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WDOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WDIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WDIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WDIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WDKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WDOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WDKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WDORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WDOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WDMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WDMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WDNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WDNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WDIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WDKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WDEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WDEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WDECDT           TH Head LFT
     C                     Z-ADD*ZERO     WDEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WDEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WENKNB           Calendar Year
     C                     Z-ADD*ZERO     WEDDDT           Calendar Quarte
     C                     Z-ADD*ZERO     WEDEDT           Calendar Quarte
     C                     Z-ADD*ZERO     WENLNB           Quarterly Short
     C                     Z-ADD*ZERO     WEAWSH           Avg Weekly Shor
     C                     Z-ADD*ZERO     WEADSH           Avg Daily Short
     C                     Z-ADD*ZERO     WEKLDY           Kill Days in Qu
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field BOL Freight Exp Paid By
     C                     MOVEL*BLANK    WUO8ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFBONB           BOL Load Number
     C                     Z-ADD*ZERO     WFCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WFABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WFACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WFBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WFCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WFAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WFAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WFATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WFDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WFDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WFGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WFBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WFLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WFLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WFJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WFKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WFIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WFKJIO           BOL Auth Gate E
     C                     Z-ADD*ZERO     WFIOJR           BOL Head Receiv
     C                     Z-ADD*ZERO     WFEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFRJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFD0DT           BOL Auth Gate E
     C                     Z-ADD*ZERO     WFD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGDFDT           PRC Effective D
     C                     Z-ADD*ZERO     WGM4PR           PRC Replacement
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WHBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WHBONB           BOL Load Number
     C                     Z-ADD*ZERO     WHCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WHB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WHNKNB           Calendar Year
     C                     Z-ADD*ZERO     WHCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WHLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WHF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WHFENB           TH Head Killed
     C                     Z-ADD*ZERO     WHE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WHHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WHHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WHNQNB           Head Analyzed P
     C                     Z-ADD*ZERO     WHCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WHMSPR           Additional Rep
     C                     Z-ADD*ZERO     WHMTPR           Actual Rep Cost
     C                     Z-ADD*ZERO     WHMUPR           Actual Rep Cost
     C                     Z-ADD*ZERO     WHMVPR           Actual Rep Cost
     C                     Z-ADD*ZERO     WHEFVA           Contract Paymen
     C                     Z-ADD*ZERO     WHEGVA           Additional Cont
     C                     Z-ADD*ZERO     WHEHVA           Contract Cost A
     C                     Z-ADD*ZERO     WHMWPR           Contract Cost /
     C                     Z-ADD*ZERO     WHMXPR           Contract Cost /
     C                     Z-ADD*ZERO     WHMYPR           Actual-Contract
     C                     Z-ADD*ZERO     WHMZPR           Actual-Contract
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
