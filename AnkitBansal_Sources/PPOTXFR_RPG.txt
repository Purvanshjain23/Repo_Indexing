     H/TITLE Exc Crt Closing Bal   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 05/09/17  Time  : 13:13:54
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FPPBSCPL9IF  E           K        DISK
      * RSQ : Inventory Stock Closing   Grp/WEDt/WhsCo/Whs/It
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPMA5REL1IF  E           K        DISK
      * RTV : Inventory Stock Close Ctl Retrieval index
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FPPBSCPL0IF  E           K        DISK                      A
      * UPD : Inventory Stock Closing   Update index
      *
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          WAAIC3
     I              AFBCDT                          WABCDT
     I              AFCQNB                          WACQNB
     I              AFESNB                          WAESNB
     I              AFETNB                          WAETNB
     I              AFBZNB                          WABZNB
     I              AFA9ST                          WAA9ST
     I              AFEINB                          WAEINB
     I              AFC5ST                          WAC5ST
     I              AFAQNB                          WAAQNB
     I              AFCMST                          WACMST
     I              AFV9ST                          WAV9ST
     I              AFWAST                          WAWAST
     I              AFX2ST                          WAX2ST
     I              AFOJDT                          WAOJDT
     I              AFNQNX                          WANQNX
     I              AFNRNX                          WANRNX
     I              AFI9SX                          WAI9SX
     I              AFJASX                          WAJASX
     I              AFOKDT                          WAOKDT
     I              AFOLDT                          WAOLDT
     I              AFUVST                          WAUVST
     I              AFUWST                          WAUWST
     I              AFUXST                          WAUXST
     I              AFAATM                          WAAATM
     I              AFAYNA                          WAAYNA
     I              AFA0NA                          WAA0NA
     I              AFAXDT                          WAAXDT
      *
     I@BSCPZB
      * Inventory Stock Closing   Grp/WEDt/WhsCo/Whs/It
      * Renamed input format fields
     I              BSAIDX                          WBAIDX
     I              BSB2C3                          WBB2C3
     I              BSGRAA                          WBGRAA
     I              BSEJC7                          WBEJC7
     I              BSV8SX                          WBV8SX
     I              BSGPAA                          WBGPAA
     I              BSGQAA                          WBGQAA
     I              BSW1SX                          WBW1SX
     I              BSF3PR                          WBF3PR
     I              BSBSNY                          WBBSNY
     I              BSBTNY                          WBBTNY
     I              BSBUNY                          WBBUNY
     I              BSGSAA                          WBGSAA
     I              BSGTAA                          WBGTAA
     I              BSOEQT                          WBOEQT
     I              BSMQWG                          WBMQWG
     I              BSOFQT                          WBOFQT
     I              BSMRWG                          WBMRWG
     I              BSOGQT                          WBOGQT
     I              BSMXWG                          WBMXWG
     I              BSOHQT                          WBOHQT
     I              BSMSWG                          WBMSWG
     I              BSOWQT                          WBOWQT
     I              BSNAWG                          WBNAWG
     I              BSOIQT                          WBOIQT
     I              BSMTWG                          WBMTWG
     I              BSOJQT                          WBOJQT
     I              BSMUWG                          WBMUWG
     I              BSOKQT                          WBOKQT
     I              BSMVWG                          WBMVWG
     I              BSOLQT                          WBOLQT
     I              BSMWWG                          WBMWWG
     I              BSFQVL                          WBFQVL
     I              BSOMQT                          WBOMQT
     I              BSMYWG                          WBMYWG
     I              BSONQT                          WBONQT
     I              BSMZWG                          WBMZWG
     I              BSOOQT                          WBOOQT
     I              BSM0WG                          WBM0WG
     I              BSDGVN                          WBDGVN
     I              BSP9DT                          WBP9DT
     I              BSCTTM                          WBCTTM
     I              BSOPQT                          WBOPQT
     I              BSM1WG                          WBM1WG
     I              BSOQQT                          WBOQQT
     I              BSM2WG                          WBM2WG
     I              BSORQT                          WBORQT
     I              BSM3WG                          WBM3WG
     I              BSOSQT                          WBOSQT
     I              BSM4WG                          WBM4WG
     I              BSRCNA                          WBRCNA
     I              BSDFVN                          WBDFVN
     I              BSP8DT                          WBP8DT
     I              BSCSTM                          WBCSTM
     I              BSOTQT                          WBOTQT
     I              BSM5WG                          WBM5WG
     I              BSF4PR                          WBF4PR
     I              BSWBSX                          WBWBSX
     I              BSWNSX                          WBWNSX
     I              BSWOSX                          WBWOSX
     I              BSOUQT                          WBOUQT
     I              BSM6WG                          WBM6WG
     I              BSOVQT                          WBOVQT
     I              BSM7WG                          WBM7WG
     I              BSWCSX                          WBWCSX
     I              BSQADT                          WBQADT
     I              BSWDSX                          WBWDSX
     I              BSVSST                          WBVSST
     I              BSMJDT                          WBMJDT
     I              BSBETM                          WBBETM
     I              BSCCVN                          WBCCVN
     I              BSCDVN                          WBCDVN
     I              BSMKDT                          WBMKDT
     I              BSBFTM                          WBBFTM
     I              BSCEVN                          WBCEVN
     I              BSCFVN                          WBCFVN
      *
     I@BYREA1
      * Item Default              Retrieval index
      * Renamed input format fields
     I              BYHGCD                          WCHGCD
     I              BYAVNA                          WCAVNA
     I              BYAWNA                          WCAWNA
     I              BYL7NA                          WCL7NA
     I              BYL8NA                          WCL8NA
     I              BYL6NA                          WCL6NA
     I              BYMFNA                          WCMFNA
     I              BYHHCD                          WCHHCD
     I              BYAWPC                          WCAWPC
     I              BYLXST                          WCLXST
     I              BYLGCD                          WCLGCD
     I              BYAXPC                          WCAXPC
     I              BYLYST                          WCLYST
     I              BYLHCD                          WCLHCD
     I              BYLICD                          WCLICD
     I              BYAIWG                          WCAIWG
     I              BYHICD                          WCHICD
     I              BYRBCD                          WCRBCD
     I              BYFZST                          WCFZST
     I              BYAVST                          WCAVST
     I              BYCZWG                          WCCZWG
     I              BYC0WG                          WCC0WG
     I              BYURTN                          WCURTN
     I              BYACC8                          WCACC8
     I              BYRINB                          WCRINB
     I              BYRHNB                          WCRHNB
     I              BYRGNB                          WCRGNB
     I              BYLNCD                          WCLNCD
     I              BYTFNB                          WCTFNB
     I              BYN0CD                          WCN0CD
     I              BYX4ST                          WCX4ST
     I              BYCHTM                          WCCHTM
     I              BYQZCD                          WCQZCD
     I              BYXWST                          WCXWST
     I              BYXXST                          WCXXST
     I              BYVMST                          WCVMST
     I              BYSWGH                          WCSWGH
     I              BYPPHE                          WCPPHE
     I              BYLRCD                          WCLRCD
     I              BYSFNB                          WCSFNB
     I              BYA3WG                          WCA3WG
     I              BYSJNB                          WCSJNB
     I              BYLLCD                          WCLLCD
     I              BYLMCD                          WCLMCD
     I              BYP3ST                          WCP3ST
     I              BYSKNB                          WCSKNB
     I              BYSLNB                          WCSLNB
     I              BYSMNB                          WCSMNB
     I              BYP4ST                          WCP4ST
     I              BYCFNB                          WCCFNB
     I              BYCGNB                          WCCGNB
     I              BYILNB                          WCILNB
     I              BYCHNB                          WCCHNB
     I              BYCINB                          WCCINB
     I              BYCJNB                          WCCJNB
     I              BYCMNB                          WCCMNB
     I              BYCNNB                          WCCNNB
     I              BYCRNB                          WCCRNB
     I              BYCSNB                          WCCSNB
     I              BYCVNB                          WCCVNB
     I              BYCWNB                          WCCWNB
     I              BYCXNB                          WCCXNB
     I              BYCZNB                          WCCZNB
     I              BYC0NB                          WCC0NB
     I              BYN1CD                          WCN1CD
     I              BYB4NB                          WCB4NB
     I              BYX5ST                          WCX5ST
     I              BYX6ST                          WCX6ST
     I              BYX7ST                          WCX7ST
     I              BYTMVA                          WCTMVA
     I              BYTNVA                          WCTNVA
     I              BYBLPR                          WCBLPR
     I              BYBMPR                          WCBMPR
     I              BYU9ST                          WCU9ST
     I              BYCMCO                          WCCMCO
     I              BYQ1CD                          WCQ1CD
     I              BYAIC3                          WCAIC3
     I              BYQ8CD                          WCQ8CD
     I              BYR3CD                          WCR3CD
     I              BYSDCD                          WCSDCD
     I              BYICN1                          WCICN1
     I              BYSVCD                          WCSVCD
     I              BYICN2                          WCICN2
     I              BYSWCD                          WCSWCD
     I              BYV2NB                          WCV2NB
     I              BYSXCD                          WCSXCD
     I              BYITCN                          WCITCN
     I              BYSYCD                          WCSYCD
     I              BYITC5                          WCITC5
     I              BYSZCD                          WCSZCD
     I              BYICN6                          WCICN6
     I              BYS0CD                          WCS0CD
     I              BYICN7                          WCICN7
     I              BYS1CD                          WCS1CD
     I              BYICN8                          WCICN8
     I              BYS2CD                          WCS2CD
     I              BYICN9                          WCICN9
     I              BYS3CD                          WCS3CD
     I              BYICN0                          WCICN0
     I              BYS4CD                          WCS4CD
     I              BYB5NB                          WCB5NB
     I              BYXRCD                          WCXRCD
     I              BYPCCT                          WCPCCT
     I              BYBDNB                          WCBDNB
     I              BYBJNB                          WCBJNB
     I              BYSUST                          WCSUST
     I              BYSVST                          WCSVST
     I              BYSYST                          WCSYST
     I              BYSZST                          WCSZST
     I              BYS1ST                          WCS1ST
     I              BYXTCD                          WCXTCD
     I              BYXUCD                          WCXUCD
     I              BYF5WG                          WCF5WG
     I              BYF6WG                          WCF6WG
     I              BYF7WG                          WCF7WG
     I              BYBLNB                          WCBLNB
     I              BYBNNB                          WCBNNB
     I              BYS2ST                          WCS2ST
     I              BYS4ST                          WCS4ST
     I              BYS5ST                          WCS5ST
     I              BYS6ST                          WCS6ST
     I              BYS8ST                          WCS8ST
     I              BYS9ST                          WCS9ST
     I              BYTCST                          WCTCST
     I              BYTDST                          WCTDST
     I              BYUVST                          WCUVST
     I              BYUWST                          WCUWST
     I              BYUXST                          WCUXST
     I              BYVSST                          WCVSST
     I              BYAHTM                          WCAHTM
     I              BYBEVN                          WCBEVN
     I              BYBFVN                          WCBFVN
     I              BYEKDT                          WCEKDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WDAIC3
     I              BZHGCD                          WDHGCD
     I              BZAVNA                          WDAVNA
     I              BZAWNA                          WDAWNA
     I              BZL7NA                          WDL7NA
     I              BZL8NA                          WDL8NA
     I              BZL6NA                          WDL6NA
     I              BZMFNA                          WDMFNA
     I              BZADCD                          WDADCD
     I              BZAWPC                          WDAWPC
     I              BZLXST                          WDLXST
     I              BZAECD                          WDAECD
     I              BZAXPC                          WDAXPC
     I              BZLYST                          WDLYST
     I              BZAFCD                          WDAFCD
     I              BZAICD                          WDAICD
     I              BZAIWG                          WDAIWG
     I              BZHICD                          WDHICD
     I              BZRBCD                          WDRBCD
     I              BZFZST                          WDFZST
     I              BZAVST                          WDAVST
     I              BZCZWG                          WDCZWG
     I              BZC0WG                          WDC0WG
     I              BZURTN                          WDURTN
     I              BZAJC8                          WDAJC8
     I              BZRINB                          WDRINB
     I              BZRHNB                          WDRHNB
     I              BZRGNB                          WDRGNB
     I              BZLNCD                          WDLNCD
     I              BZTFNB                          WDTFNB
     I              BZN0CD                          WDN0CD
     I              BZX4ST                          WDX4ST
     I              BZTMVA                          WDTMVA
     I              BZTNVA                          WDTNVA
     I              BZBLPR                          WDBLPR
     I              BZBMPR                          WDBMPR
     I              BZLRCD                          WDLRCD
     I              BZU9ST                          WDU9ST
     I              BZCMCO                          WDCMCO
     I              BZQ1CD                          WDQ1CD
     I              BZQ8CD                          WDQ8CD
     I              BZCHTM                          WDCHTM
     I              BZQZCD                          WDQZCD
     I              BZXWST                          WDXWST
     I              BZXXST                          WDXXST
     I              BZVMST                          WDVMST
     I              BZSWGH                          WDSWGH
     I              BZPPHE                          WDPPHE
     I              BZR3CD                          WDR3CD
     I              BZSDCD                          WDSDCD
     I              BZICN1                          WDICN1
     I              BZSVCD                          WDSVCD
     I              BZICN2                          WDICN2
     I              BZSWCD                          WDSWCD
     I              BZV2NB                          WDV2NB
     I              BZSXCD                          WDSXCD
     I              BZITCN                          WDITCN
     I              BZSYCD                          WDSYCD
     I              BZITC5                          WDITC5
     I              BZSZCD                          WDSZCD
     I              BZICN6                          WDICN6
     I              BZS0CD                          WDS0CD
     I              BZICN7                          WDICN7
     I              BZS1CD                          WDS1CD
     I              BZICN8                          WDICN8
     I              BZS2CD                          WDS2CD
     I              BZICN9                          WDICN9
     I              BZS3CD                          WDS3CD
     I              BZICN0                          WDICN0
     I              BZS4CD                          WDS4CD
     I              BZSFNB                          WDSFNB
     I              BZA3WG                          WDA3WG
     I              BZSJNB                          WDSJNB
     I              BZLLCD                          WDLLCD
     I              BZLMCD                          WDLMCD
     I              BZP3ST                          WDP3ST
     I              BZSKNB                          WDSKNB
     I              BZSLNB                          WDSLNB
     I              BZSMNB                          WDSMNB
     I              BZP4ST                          WDP4ST
     I              BZCFNB                          WDCFNB
     I              BZCGNB                          WDCGNB
     I              BZILNB                          WDILNB
     I              BZCHNB                          WDCHNB
     I              BZCINB                          WDCINB
     I              BZCJNB                          WDCJNB
     I              BZCMNB                          WDCMNB
     I              BZCNNB                          WDCNNB
     I              BZCRNB                          WDCRNB
     I              BZCSNB                          WDCSNB
     I              BZCVNB                          WDCVNB
     I              BZCWNB                          WDCWNB
     I              BZCXNB                          WDCXNB
     I              BZCZNB                          WDCZNB
     I              BZC0NB                          WDC0NB
     I              BZN1CD                          WDN1CD
     I              BZB4NB                          WDB4NB
     I              BZB5NB                          WDB5NB
     I              BZX5ST                          WDX5ST
     I              BZX6ST                          WDX6ST
     I              BZX7ST                          WDX7ST
     I              BZPCCT                          WDPCCT
     I              BZBDNB                          WDBDNB
     I              BZBJNB                          WDBJNB
     I              BZSUST                          WDSUST
     I              BZSVST                          WDSVST
     I              BZSYST                          WDSYST
     I              BZSZST                          WDSZST
     I              BZS1ST                          WDS1ST
     I              BZXRCD                          WDXRCD
     I              BZXTCD                          WDXTCD
     I              BZXUCD                          WDXUCD
     I              BZF5WG                          WDF5WG
     I              BZF6WG                          WDF6WG
     I              BZF7WG                          WDF7WG
     I              BZBLNB                          WDBLNB
     I              BZBNNB                          WDBNNB
     I              BZS2ST                          WDS2ST
     I              BZS4ST                          WDS4ST
     I              BZS5ST                          WDS5ST
     I              BZS6ST                          WDS6ST
     I              BZS8ST                          WDS8ST
     I              BZS9ST                          WDS9ST
     I              BZTCST                          WDTCST
     I              BZTDST                          WDTDST
     I              BZUVST                          WDUVST
     I              BZUWST                          WDUWST
     I              BZUXST                          WDUXST
     I              BZVSST                          WDVSST
     I              BZAATM                          WDAATM
     I              BZAYNA                          WDAYNA
     I              BZA0NA                          WDA0NA
     I              BZAXDT                          WDAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WEAJCD
     I              ADF8NA                          WEF8NA
     I              ADACNA                          WEACNA
     I              ADADNA                          WEADNA
     I              ADAENA                          WEAENA
     I              ADAJNA                          WEAJNA
     I              ADBTTX                          WEBTTX
     I              ADAOCD                          WEAOCD
     I              ADBGCD                          WEBGCD
     I              ADVHST                          WEVHST
     I              ADMPNA                          WEMPNA
     I              ADWPST                          WEWPST
     I              ADXUST                          WEXUST
     I              ADT0ST                          WET0ST
     I              ADT1ST                          WET1ST
     I              ADDBNB                          WEDBNB
     I              ADT2ST                          WET2ST
     I              ADT3ST                          WET3ST
     I              ADT4ST                          WET4ST
     I              ADT6ST                          WET6ST
     I              ADBWC3                          WEBWC3
     I              ADBTC3                          WEBTC3
     I              ADBUC3                          WEBUC3
     I              ADBVC3                          WEBVC3
     I              ADFCAA                          WEFCAA
     I              ADRQSX                          WERQSX
     I              ADRRSX                          WERRSX
     I              ADRSSX                          WERSSX
     I              ADRTSX                          WERTSX
     I              ADT7ST                          WET7ST
     I              ADT8ST                          WET8ST
     I              ADRNSX                          WERNSX
     I              ADROSX                          WEROSX
     I              ADRPSX                          WERPSX
     I              ADUVST                          WEUVST
     I              ADUWST                          WEUWST
     I              ADUXST                          WEUXST
     I              ADVSST                          WEVSST
     I              ADAATM                          WEAATM
     I              ADAYNA                          WEAYNA
     I              ADA0NA                          WEA0NA
     I              ADAXDT                          WEAXDT
      *
     I@BSCPA5
      * Inventory Stock Closing   Update index
      * Renamed input format fields
     I              BSAIDX                          WFAIDX
     I              BSB2C3                          WFB2C3
     I              BSGRAA                          WFGRAA
     I              BSEJC7                          WFEJC7
     I              BSV8SX                          WFV8SX
     I              BSGPAA                          WFGPAA
     I              BSGQAA                          WFGQAA
     I              BSW1SX                          WFW1SX
     I              BSF3PR                          WFF3PR
     I              BSBSNY                          WFBSNY
     I              BSBTNY                          WFBTNY
     I              BSBUNY                          WFBUNY
     I              BSGSAA                          WFGSAA
     I              BSGTAA                          WFGTAA
     I              BSOEQT                          WFOEQT
     I              BSMQWG                          WFMQWG
     I              BSOFQT                          WFOFQT
     I              BSMRWG                          WFMRWG
     I              BSOGQT                          WFOGQT
     I              BSMXWG                          WFMXWG
     I              BSOHQT                          WFOHQT
     I              BSMSWG                          WFMSWG
     I              BSOWQT                          WFOWQT
     I              BSNAWG                          WFNAWG
     I              BSOIQT                          WFOIQT
     I              BSMTWG                          WFMTWG
     I              BSOJQT                          WFOJQT
     I              BSMUWG                          WFMUWG
     I              BSOKQT                          WFOKQT
     I              BSMVWG                          WFMVWG
     I              BSOLQT                          WFOLQT
     I              BSMWWG                          WFMWWG
     I              BSFQVL                          WFFQVL
     I              BSOMQT                          WFOMQT
     I              BSMYWG                          WFMYWG
     I              BSONQT                          WFONQT
     I              BSMZWG                          WFMZWG
     I              BSOOQT                          WFOOQT
     I              BSM0WG                          WFM0WG
     I              BSDGVN                          WFDGVN
     I              BSP9DT                          WFP9DT
     I              BSCTTM                          WFCTTM
     I              BSOPQT                          WFOPQT
     I              BSM1WG                          WFM1WG
     I              BSOQQT                          WFOQQT
     I              BSM2WG                          WFM2WG
     I              BSORQT                          WFORQT
     I              BSM3WG                          WFM3WG
     I              BSOSQT                          WFOSQT
     I              BSM4WG                          WFM4WG
     I              BSRCNA                          WFRCNA
     I              BSDFVN                          WFDFVN
     I              BSP8DT                          WFP8DT
     I              BSCSTM                          WFCSTM
     I              BSOTQT                          WFOTQT
     I              BSM5WG                          WFM5WG
     I              BSF4PR                          WFF4PR
     I              BSWBSX                          WFWBSX
     I              BSWNSX                          WFWNSX
     I              BSWOSX                          WFWOSX
     I              BSOUQT                          WFOUQT
     I              BSM6WG                          WFM6WG
     I              BSOVQT                          WFOVQT
     I              BSM7WG                          WFM7WG
     I              BSWCSX                          WFWCSX
     I              BSQADT                          WFQADT
     I              BSWDSX                          WFWDSX
     I              BSVSST                          WFVSST
     I              BSMJDT                          WFMJDT
     I              BSBETM                          WFBETM
     I              BSCCVN                          WFCCVN
     I              BSCDVN                          WFCDVN
     I              BSMKDT                          WFMKDT
     I              BSBFTM                          WFBFTM
     I              BSCEVN                          WFCEVN
     I              BSCFVN                          WFCFVN
      *
     I@A5REKR
      * Inventory Stock Close Ctl Retrieval index
      * Renamed input format fields
     I              A5AIC3                          WGAIC3
     I              A5FXTX                          WGFXTX
     I              A5F1TX                          WGF1TX
     I              A5C0TM                          WGC0TM
     I              A5F0TX                          WGF0TX
     I              A5C1TM                          WGC1TM
     I              A5ISST                          WGISST
     I              A5KWT1                          WGKWT1
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WHAIC3
     I              AFBCDT                          WHBCDT
     I              AFCQNB                          WHCQNB
     I              AFESNB                          WHESNB
     I              AFETNB                          WHETNB
     I              AFBZNB                          WHBZNB
     I              AFA9ST                          WHA9ST
     I              AFEINB                          WHEINB
     I              AFC5ST                          WHC5ST
     I              AFAQNB                          WHAQNB
     I              AFCMST                          WHCMST
     I              AFV9ST                          WHV9ST
     I              AFWAST                          WHWAST
     I              AFX2ST                          WHX2ST
     I              AFOJDT                          WHOJDT
     I              AFNQNX                          WHNQNX
     I              AFNRNX                          WHNRNX
     I              AFI9SX                          WHI9SX
     I              AFJASX                          WHJASX
     I              AFOKDT                          WHOKDT
     I              AFOLDT                          WHOLDT
     I              AFUVST                          WHUVST
     I              AFUWST                          WHUWST
     I              AFUXST                          WHUXST
     I              AFAATM                          WHAATM
     I              AFAYNA                          WHAYNA
     I              AFA0NA                          WHA0NA
     I              AFAXDT                          WHAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPPBS1    E DSPPBSCPL0
      * UPD : Inventory Stock Closing   Update index
      * Renamed input format fields
     I              BSAIDX                          WFAIDX
     I              BSB2C3                          WFB2C3
     I              BSGRAA                          WFGRAA
     I              BSEJC7                          WFEJC7
     I              BSV8SX                          WFV8SX
     I              BSGPAA                          WFGPAA
     I              BSGQAA                          WFGQAA
     I              BSW1SX                          WFW1SX
     I              BSF3PR                          WFF3PR
     I              BSBSNY                          WFBSNY
     I              BSBTNY                          WFBTNY
     I              BSBUNY                          WFBUNY
     I              BSGSAA                          WFGSAA
     I              BSGTAA                          WFGTAA
     I              BSOEQT                          WFOEQT
     I              BSMQWG                          WFMQWG
     I              BSOFQT                          WFOFQT
     I              BSMRWG                          WFMRWG
     I              BSOGQT                          WFOGQT
     I              BSMXWG                          WFMXWG
     I              BSOHQT                          WFOHQT
     I              BSMSWG                          WFMSWG
     I              BSOWQT                          WFOWQT
     I              BSNAWG                          WFNAWG
     I              BSOIQT                          WFOIQT
     I              BSMTWG                          WFMTWG
     I              BSOJQT                          WFOJQT
     I              BSMUWG                          WFMUWG
     I              BSOKQT                          WFOKQT
     I              BSMVWG                          WFMVWG
     I              BSOLQT                          WFOLQT
     I              BSMWWG                          WFMWWG
     I              BSFQVL                          WFFQVL
     I              BSOMQT                          WFOMQT
     I              BSMYWG                          WFMYWG
     I              BSONQT                          WFONQT
     I              BSMZWG                          WFMZWG
     I              BSOOQT                          WFOOQT
     I              BSM0WG                          WFM0WG
     I              BSDGVN                          WFDGVN
     I              BSP9DT                          WFP9DT
     I              BSCTTM                          WFCTTM
     I              BSOPQT                          WFOPQT
     I              BSM1WG                          WFM1WG
     I              BSOQQT                          WFOQQT
     I              BSM2WG                          WFM2WG
     I              BSORQT                          WFORQT
     I              BSM3WG                          WFM3WG
     I              BSOSQT                          WFOSQT
     I              BSM4WG                          WFM4WG
     I              BSRCNA                          WFRCNA
     I              BSDFVN                          WFDFVN
     I              BSP8DT                          WFP8DT
     I              BSCSTM                          WFCSTM
     I              BSOTQT                          WFOTQT
     I              BSM5WG                          WFM5WG
     I              BSF4PR                          WFF4PR
     I              BSWBSX                          WFWBSX
     I              BSWNSX                          WFWNSX
     I              BSWOSX                          WFWOSX
     I              BSOUQT                          WFOUQT
     I              BSM6WG                          WFM6WG
     I              BSOVQT                          WFOVQT
     I              BSM7WG                          WFM7WG
     I              BSWCSX                          WFWCSX
     I              BSQADT                          WFQADT
     I              BSWDSX                          WFWDSX
     I              BSVSST                          WFVSST
     I              BSMJDT                          WFMJDT
     I              BSBETM                          WFBETM
     I              BSCCVN                          WFCCVN
     I              BSCDVN                          WFCDVN
     I              BSMKDT                          WFMKDT
     I              BSBFTM                          WFBFTM
     I              BSCEVN                          WFCEVN
     I              BSCFVN                          WFCFVN
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Inventory Stock Closing
      * I :  ISC Week Ending Date
     I                                    P   1   50P1AIDX
      * I :  ISC Warehouse Company
     I                                    P   6   70P1B2C3
      * I :  ISC Valuation Grouping
     I                                        8   8 P1WCSX
     IP2PARM      DS
      * I :  Week End Date
     I                                    P   1   40P2N6DT
     IP3PARM      DS
      * I :  Last Week Ending Date USR
     I                                    P   1   50P3ALDX
     IP4PARM      DS
      * N :  Date Sun USR
     I                                    P   1   40P4JNDT
     IP5PARM      DS
      * N :  Date Sat USR
     I                                    P   1   40P5JMDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIDX    PARM           WP0001  80       ISC Week Ending
     C           P1B2C3    PARM           WP0002  30       ISC Warehouse C
     C           P1WCSX    PARM           WP0003  1        ISC Valuation G
     C           P2N6DT    PARM           WP0004  70       Week End Date
     C           P3ALDX    PARM           WP0005  80       Last Week Endin
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Crt Closing Bal   XF
     C                     Z-ADDP2N6DT    P5JMDT           Date Sat USR
      * 1. Crt new week's Inv Stock Closing bals
      * Rtv Sunday that starts the new week
      * Rtv Prior Sunday      RT - Calendar  * 
     C                     EXSR SARVGN
      *   a. Roll forward ending week's to beginning new week's balances
      * RMC 11/30/05 remove ISC company from input rst parm; do both
      * R9083 02/17/17 DN-Changed Access Path to Read by Group/WeekEnd.
      * Rtv Crt New Weeks Rcd RT - Inventory Stock Closing  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1WCSX    WL0001    P      ISC Valuation G
     C                     Z-ADDP3ALDX    WL0002           ISC Week Ending
     C                     Z-ADDP1AIDX    WL0003           PT Prod Date YY
     C                     Z-ADDP4JNDT    WL0004           Date Sun USR
     C                     Z-ADDP5JMDT    WL0005           Date Sat USR
     C                     EXSR SBRVGN
      *   b. Rtv End Inv from IC Item Bal -- Ending Inventory Download
      *     POFPPVR AND POFQUPC - read the item bal the same way & upd IS
      * R9083 05/08/17 DN-Added ISC Valuation Grouping to Parm.
      * Exc Build End Inv-ISC XF - Item Balance  * 
     C                     CALL 'PPO1XFR'              90  Exc Build End I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P5JMDT    WQ0001  70       Date To
     C                     PARM P1AIDX    WQ0002  80       ISC Week Ending
     C                     PARM P1WCSX    WQ0003  1        ISC Valuation G
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPO1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *   c. Rtv Partials (PT) & Rejects (RJ) from the Yield system
      *   ---> Manually entered
      *   d. Floor Production from Item Trans --> Production Download- PO
      * ******
      * ******
      * Rtv Date/Time         RT - Inventory Stock Close Ctl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1B2C3    WL0082           Company Number
     C                     MOVEL'RR'      WL0083    P      ISC Data Collec
     C                     Z-ADDP5JMDT    WL0086           Date
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0084    YL0001           ISC From Time
     C                     Z-ADDWL0085    YL0002           ISC To Time
     C                     Z-ADDWL0087    YL0003           From Date
     C                     Z-ADDWL0088    YL0004           Thru Date
      * R9083 05/09/17 DN-Added ISC Valuation Grouping to Parm.
      * Prt Prdctn Dwnl-ISC   UP - Item Transaction Detail  * 
     C                     CALL 'PPOWUPR'              90  Prt Prdctn Dwnl
     C                     PARM WUH3TX    WQ0004  7        Return Code Usr
     C                     PARM YL0003    WQ0005  70       From Date
     C                     PARM YL0004    WQ0006  70       Thru Date
     C                     PARM P1AIDX    WQ0007  80       PT Prod Date YY
     C                     PARM YL0001    WQ0008  60       ISC From Time
     C                     PARM YL0002    WQ0009  60       ISC To Time
     C                     PARM P1WCSX    WQ0010  1        ISC Valuation G
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPOWUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      *   e. Inventory Shipments from Item Transaction  "IO" rcds
      *      Sunday ---> Saturday                     * calls ppo5pfr *
      * R9083 05/09/17 DN-Added ISC Valuation Grouping to Parm.
      * Prt Inventory Shp-ISC UP - Item Transaction Detail  * 
     C                     CALL 'PPO4UPC'              90  Prt Inventory S
     C                     PARM WUH3TX    WQ0011  7        Return Code Usr
     C                     PARM P4JNDT    WQ0012  70       From Date
     C                     PARM P5JMDT    WQ0013  70       Thru Date
     C                     PARM P1AIDX    WQ0014  80       PT Prod Date YY
     C                     PARM P1WCSX    WQ0015  1        ISC Valuation G
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPO4UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      *   f. Upd Order Dtl Shipment Initial --> Order Dtl Download- pof8p
      *      Sunday ---> Saturday                     * calls ppoypfr *
      * R9083 05/09/17 DN-Added ISC Valuation Grouping to Parm.
      * Prt Ord Dtl Shpmt-ISC UP - Order Detail  * 
     C                     CALL 'PPOZUPR'              90  Prt Ord Dtl Shp
     C                     PARM WUH3TX    WQ0016  7        Return Code Usr
     C                     PARM P4JNDT    WQ0017  70       From Date
     C                     PARM P5JMDT    WQ0018  70       Thru Date
     C                     PARM P1AIDX    WQ0019  80       ISC Week Ending
     C                     PARM P1WCSX    WQ0020  1        ISC Valuation G
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPOZUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      *   g. Upd Sun Shpmnt Inv Adj --> orders shipped Sun after week end
      *                                                * calls ppo3pfr *
      * RTV Next Sunday        RT - Calendar  * 
     C                     EXSR SJRVGN
      * R9083 05/09/17 DN-Added ISC Valuation Grouping to Parm.
      * Prt Ord Dtl SunSh-ISC UP - Order Detail  * 
     C                     CALL 'PPO2UPC'              90  Prt Ord Dtl Sun
     C                     PARM WUH3TX    WQ0021  7        Return Code Usr
     C                     PARM WUJNDT    WQ0022  70       From Date
     C                     PARM P1AIDX    WQ0023  80       ISC Week Ending
     C                     PARM P1WCSX    WQ0024  1        ISC Valuation G
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPO2UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      *   h. Inventory Transfers from Item Transaction  "T""TW" rcds
      *      Other Inventory Adj from Item Transaction  "R""RC""RP""S"
      * ******
      * ******
      * Rtv Date/Time         RT - Inventory Stock Close Ctl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1B2C3    WL0082           Company Number
     C                     MOVEL'TW'      WL0083    P      ISC Data Collec
     C                     Z-ADDP5JMDT    WL0086           Date
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0084    YL0001           ISC From Time
     C                     Z-ADDWL0085    YL0002           ISC To Time
     C                     Z-ADDWL0087    YL0003           From Date
     C                     Z-ADDWL0088    YL0004           Thru Date
      * Prt Inv Txf/MscAd ISC UP - Item Transaction Detail  * 
     C                     CALL 'PPSHUPC'              90  Prt Inv Txf/Msc
     C                     PARM WUH3TX    WQ0025  7        Return Code Usr
     C                     PARM YL0003    WQ0026  70       From Date
     C                     PARM YL0004    WQ0027  70       Thru Date
     C                     PARM P1AIDX    WQ0028  80       PT Prod Date YY
     C                     PARM YL0001    WQ0029  60       ISC From Time
     C                     PARM YL0002    WQ0030  60       ISC To Time
     C                     PARM P1WCSX    WQ0031  1        ISC Valuation G
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPSHUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      *   Z. Delete ISC Records for Scale check items and items that dont
      *   have an Item Balance.               12/19/08 S00598
      * R9083 02/17/17 DN-Added ISC Valuation Grouping to Parm.
      * Exc Del inv/scl item  XF - Inventory Stock Closing  * 
     C                     CALL 'PMCBXFR'              90  Exc Del inv/scl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIDX    WQ0032  80       ISC Week Ending
     C                     PARM P1WCSX    WQ0033  1        ISC Valuation G
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Prior Sunday      RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WABCDT           Post to G/L Dat
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1B2C3    WQSA01           Company Number
     C                     Z-ADDP2N6DT    WABCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSA     SETLL@AFREPU                    *
     C           KRSSA     READE@AFREPU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P4JNDT           Date Sun USR
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Day of Week is Sunday
     C           WAA9ST    IFEQ '1'                        *IF
     C                     Z-ADDWABCDT    P4JNDT           Date Sun USR
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSA     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Crt New Weeks Rcd RT - Inventory Stock Closing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 11/10/2009 slm
      * E00470 Item Description Data sync
      * Item Type = was not getting updated in the Crt from the
      * Item Default.
      * this was due to the fact that we did not think the users
      * were changing from wip TO FG or FG to wip
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBWCSX    WQSB01           ISC Valuation G
     C           *LIKE     DEFN WBAIDX    WQSB02           ISC Week Ending
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           ISC Valuation G
     C                     KFLD           WQSB02           ISC Week Ending
      * Setup key
     C                     MOVELWL0001    WQSB01           ISC Valuation G
     C                     Z-ADDWL0002    WQSB02           ISC Week Ending
      * Establish starting position
     C           KRSSB     SETLL@BSCPZB                    *
     C           KRSSB     READE@BSCPZB                  90*
      * Data record not found
     C   90                MOVEL'USR3529' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Inv Stock Closing RT - Item Default  * 
     C                     EXSR SCRVGN
      * Rtv Inv Stock Closing RT - Company Item  * 
     C                     EXSR SDRVGN
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SERVGN
     C                     MOVEL'O'       WUWNSX           ISC Post Balanc
     C                     MOVEL'O'       WUWOSX           ISC Post Wareho
     C           WBM5WG    SUB  WBM4WG    WUMXWG           ISC Beg Inv Lbs
     C           WBOTQT    SUB  WBOSQT    WUOGQT           ISC Beg Inv Qty
      * CASE: DB1.ISC Warehouse Price /UOM is Entered
     C           WBF4PR    IFNE 0                          *IF
     C                     MOVEL'P'       WUWBSX           ISC Warehouse P
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUOTTX    WUWBSX           ISC Warehouse P
     C                     END                             *FI
      * 11/10/2009 slm
      * R9083 02/17/17 DN-Populate ISC Valuation Grouping.
      * Crt Inventory Stock   CR - Inventory Stock Closing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0003    WL0006           ISC Week Ending
     C                     Z-ADDWBB2C3    WL0007           ISC Warehouse C
     C                     MOVELWBGRAA    WL0008    P      ISC Warehouse C
     C                     Z-ADDWBEJC7    WL0009           ISC Item Code
     C                     MOVELWUV8SX    WL0010    P      ISC Warehouse T
     C                     MOVELWUGPAA    WL0011    P      ISC Item Cmdty
     C                     MOVELWUGQAA    WL0012    P      ISC Item Dft Cm
     C                     MOVELWUW1SX    WL0013    P      ISC Item Type
     C                     Z-ADDWUF3PR    WL0014           ISC Item Market
     C                     Z-ADDWUBSNY    WL0015           ISC Item Struct
     C                     Z-ADDWUBTNY    WL0016           ISC Item Struct
     C                     Z-ADDWUBUNY    WL0017           ISC Item Struct
     C                     MOVELWUGSAA    WL0018    P      ISC Item G/L Su
     C                     MOVELWUGTAA    WL0019    P      ISC Item U/M -
     C                     Z-ADDWBOTQT    WL0020           ISC Beg Inv Fin
     C                     Z-ADDWBM5WG    WL0021           ISC Beg Inv Fin
     C                     Z-ADDWBOSQT    WL0022           ISC Beg Inv Adj
     C                     Z-ADDWBM4WG    WL0023           ISC Beg Inv Adj
     C                     Z-ADDWUOGQT    WL0024           ISC Beg Inv Qty
     C                     Z-ADDWUMXWG    WL0025           ISC Beg Inv Lbs
     C                     Z-ADD0         WL0026           ISC Floor Produ
     C                     Z-ADD0         WL0027           ISC Floor Produ
     C                     Z-ADD0         WL0028           ISC Floor Prod
     C                     Z-ADD0         WL0029           ISC Floor Prod
     C                     Z-ADD0         WL0030           ISC Sales Produ
     C                     Z-ADD0         WL0031           ISC Sales Produ
     C                     Z-ADD0         WL0032           ISC Inventory S
     C                     Z-ADD0         WL0033           ISC Inventory S
     C                     Z-ADD0         WL0034           ISC Ord Dtl Shi
     C                     Z-ADD0         WL0035           ISC Ord Dtl Shi
     C                     Z-ADD0         WL0036           ISC Shipment Fi
     C                     Z-ADD0         WL0037           ISC Shipment Fi
     C                     Z-ADD0         WL0038           ISC FOB Gross A
     C                     Z-ADD0         WL0039           ISC Inventory T
     C                     Z-ADD0         WL0040           ISC Inventory T
     C                     Z-ADD0         WL0041           ISC Misc Invntr
     C                     Z-ADD0         WL0042           ISC Misc Invntr
     C                     Z-ADD0         WL0043           ISC Ending Inve
     C                     Z-ADD0         WL0044           ISC Ending Inve
     C                     MOVEL*BLANK    WL0045           ISC End Inv Use
     C                     Z-ADD0         WL0046           ISC End Inv Dat
     C                     Z-ADD0         WL0047           ISC End Inv Tim
     C                     Z-ADD0         WL0048           ISC Sun Shp Inv
     C                     Z-ADD0         WL0049           ISC Sun Shp Inv
     C                     Z-ADD0         WL0050           ISC Unsh/Ship I
     C                     Z-ADD0         WL0051           ISC Unsh/Ship I
     C                     Z-ADD0         WL0052           ISC End Inv Par
     C                     Z-ADD0         WL0053           ISC End Inv Par
     C                     Z-ADD0         WL0054           ISC End Inv Adj
     C                     Z-ADD0         WL0055           ISC End Inv Adj
     C                     MOVEL*BLANK    WL0056           ISC End Inv Adj
     C                     MOVEL*BLANK    WL0057           ISC Ending Inv
     C                     Z-ADD0         WL0058           ISC Ending Inv
     C                     Z-ADD0         WL0059           ISC Ending Inv
     C                     Z-ADD0         WL0060           ISC End Inv Fin
     C                     Z-ADD0         WL0061           ISC End Inv Fin
     C                     Z-ADD0         WL0062           ISC Warehouse P
     C                     MOVELWUWBSX    WL0063    P      ISC Warehouse P
     C                     MOVELWUWNSX    WL0064    P      ISC Post Balanc
     C                     MOVELWUWOSX    WL0065    P      ISC Post Wareho
     C                     Z-ADD0         WL0066           ISC Commission
     C                     Z-ADD0         WL0067           ISC Unused Lbs
     C                     Z-ADD0         WL0068           ISC TF Exempt N
     C                     Z-ADD0         WL0069           ISC TF Exempt L
     C                     MOVELWL0001    WL0070    P      ISC Valuation G
     C                     Z-ADD0         WL0071           ISC Unused Date
     C                     MOVELWUWDSX    WL0072    P      ISC Unused Sts
     C                     MOVEL'A'       WL0073    P      Record Status
     C                     Z-ADD0         WL0074           Create Date
     C                     Z-ADD0         WL0075           Create Time
     C                     MOVEL*BLANK    WL0076           Create User
     C                     MOVEL*BLANK    WL0077           Create Program
     C                     Z-ADD0         WL0078           Change Date
     C                     Z-ADD0         WL0079           Change Time
     C                     MOVEL*BLANK    WL0080           Change User
     C                     MOVEL*BLANK    WL0081           Change Program
     C                     EXSR SFCRRC
     C           KRSSB     READE@BSCPZB                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Inv Stock Closing RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCHGCD           Item Code
      * Setup key
     C                     Z-ADDWBEJC7    WCHGCD           Item Code
      * Establish starting position
     C           KRSSC     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCAVNA    WUAVNA           Description Lin
     C                     Z-ADDWCRINB    WUBUNY           Item Structure
     C                     Z-ADDWCRHNB    WUBTNY           Item Structure
     C                     Z-ADDWCRGNB    WUBSNY           Item Structure
     C                     MOVELWCLNCD    WUGQAA           Default Commod
     C                     MOVELWCN0CD    WUW1SX           Item Type Code
     C                     MOVELWCLRCD    WUGPAA           Commodity Price
     C                     MOVELWCSYCD    WUGSAA           G/L Sub Code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Inv Stock Closing RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
      * Setup key
     C                     Z-ADDWBB2C3    WDAIC3           Company Number
     C                     Z-ADDWBEJC7    WDHGCD           Item Code
      * Establish starting position
     C           KRSSD     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUGTAA           U/M - Pricing
     C                     Z-ADD*ZERO     WUF3PR           Market Overage
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDAICD    WUGTAA           U/M - Pricing
     C                     Z-ADDWDBLPR    WUF3PR           Market Overage
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     MOVELWBGRAA    WEAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUV8SX           Warehouse Type
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEWPST    WUV8SX           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Crt Inventory Stock   CR - Inventory Stock Closing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BSCPA5
     C                     Z-ADDWL0006    WFAIDX           ISC Week Ending
     C                     Z-ADDWL0007    WFB2C3           ISC Warehouse C
     C                     MOVELWL0008    WFGRAA           ISC Warehouse C
     C                     Z-ADDWL0009    WFEJC7           ISC Item Code
     C                     MOVELWL0010    WFV8SX           ISC Warehouse T
     C                     MOVELWL0011    WFGPAA           ISC Item Cmdty
     C                     MOVELWL0012    WFGQAA           ISC Item Dft Cm
     C                     MOVELWL0013    WFW1SX           ISC Item Type
     C                     Z-ADDWL0014    WFF3PR           ISC Item Market
     C                     Z-ADDWL0015    WFBSNY           ISC Item Struct
     C                     Z-ADDWL0016    WFBTNY           ISC Item Struct
     C                     Z-ADDWL0017    WFBUNY           ISC Item Struct
     C                     MOVELWL0018    WFGSAA           ISC Item G/L Su
     C                     MOVELWL0019    WFGTAA           ISC Item U/M -
     C                     Z-ADDWL0020    WFOEQT           ISC Beg Inv Fin
     C                     Z-ADDWL0021    WFMQWG           ISC Beg Inv Fin
     C                     Z-ADDWL0022    WFOFQT           ISC Beg Inv Adj
     C                     Z-ADDWL0023    WFMRWG           ISC Beg Inv Adj
     C                     Z-ADDWL0024    WFOGQT           ISC Beg Inv Qty
     C                     Z-ADDWL0025    WFMXWG           ISC Beg Inv Lbs
     C                     Z-ADDWL0026    WFOHQT           ISC Floor Produ
     C                     Z-ADDWL0027    WFMSWG           ISC Floor Produ
     C                     Z-ADDWL0028    WFOWQT           ISC Floor Prod
     C                     Z-ADDWL0029    WFNAWG           ISC Floor Prod
     C                     Z-ADDWL0030    WFOIQT           ISC Sales Produ
     C                     Z-ADDWL0031    WFMTWG           ISC Sales Produ
     C                     Z-ADDWL0032    WFOJQT           ISC Inventory S
     C                     Z-ADDWL0033    WFMUWG           ISC Inventory S
     C                     Z-ADDWL0034    WFOKQT           ISC Ord Dtl Shi
     C                     Z-ADDWL0035    WFMVWG           ISC Ord Dtl Shi
     C                     Z-ADDWL0036    WFOLQT           ISC Shipment Fi
     C                     Z-ADDWL0037    WFMWWG           ISC Shipment Fi
     C                     Z-ADDWL0038    WFFQVL           ISC FOB Gross A
     C                     Z-ADDWL0039    WFOMQT           ISC Inventory T
     C                     Z-ADDWL0040    WFMYWG           ISC Inventory T
     C                     Z-ADDWL0041    WFONQT           ISC Misc Invntr
     C                     Z-ADDWL0042    WFMZWG           ISC Misc Invntr
     C                     Z-ADDWL0043    WFOOQT           ISC Ending Inve
     C                     Z-ADDWL0044    WFM0WG           ISC Ending Inve
     C                     MOVELWL0045    WFDGVN           ISC End Inv Use
     C                     Z-ADDWL0046    WFP9DT           ISC End Inv Dat
     C                     Z-ADDWL0047    WFCTTM           ISC End Inv Tim
     C                     Z-ADDWL0048    WFOPQT           ISC Sun Shp Inv
     C                     Z-ADDWL0049    WFM1WG           ISC Sun Shp Inv
     C                     Z-ADDWL0050    WFOQQT           ISC Unsh/Ship I
     C                     Z-ADDWL0051    WFM2WG           ISC Unsh/Ship I
     C                     Z-ADDWL0052    WFORQT           ISC End Inv Par
     C                     Z-ADDWL0053    WFM3WG           ISC End Inv Par
     C                     Z-ADDWL0054    WFOSQT           ISC End Inv Adj
     C                     Z-ADDWL0055    WFM4WG           ISC End Inv Adj
     C                     MOVELWL0056    WFRCNA           ISC End Inv Adj
     C                     MOVELWL0057    WFDFVN           ISC Ending Inv
     C                     Z-ADDWL0058    WFP8DT           ISC Ending Inv
     C                     Z-ADDWL0059    WFCSTM           ISC Ending Inv
     C                     Z-ADDWL0060    WFOTQT           ISC End Inv Fin
     C                     Z-ADDWL0061    WFM5WG           ISC End Inv Fin
     C                     Z-ADDWL0062    WFF4PR           ISC Warehouse P
     C                     MOVELWL0063    WFWBSX           ISC Warehouse P
     C                     MOVELWL0064    WFWNSX           ISC Post Balanc
     C                     MOVELWL0065    WFWOSX           ISC Post Wareho
     C                     Z-ADDWL0066    WFOUQT           ISC Commission
     C                     Z-ADDWL0067    WFM6WG           ISC Unused Lbs
     C                     Z-ADDWL0068    WFOVQT           ISC TF Exempt N
     C                     Z-ADDWL0069    WFM7WG           ISC TF Exempt L
     C                     MOVELWL0070    WFWCSX           ISC Valuation G
     C                     Z-ADDWL0071    WFQADT           ISC Unused Date
     C                     MOVELWL0072    WFWDSX           ISC Unused Sts
     C                     MOVELWL0073    WFVSST           Record Status
     C                     Z-ADDWL0074    WFMJDT           Create Date
     C                     Z-ADDWL0075    WFBETM           Create Time
     C                     MOVELWL0076    WFCCVN           Create User
     C                     MOVELWL0077    WFCDVN           Create Program
     C                     Z-ADDWL0078    WFMKDT           Change Date
     C                     Z-ADDWL0079    WFBFTM           Change Time
     C                     MOVELWL0080    WFCEVN           Change User
     C                     MOVELWL0081    WFCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WFVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WFMJDT           Create Date
     C                     Z-ADD##JTM     WFBETM           Create Time
     C                     MOVEL##USR     WFCCVN           Create User
     C                     MOVEL##PGM     WFCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD0         WFMKDT           Change Date
     C                     Z-ADD0         WFBFTM           Change Time
     C                     MOVEL*BLANK    WFCEVN           Change User
     C                     MOVEL*BLANK    WFCFVN           Change Program
      * Compute:Ending Inv Fin Qt
      * DB1.ISC End Inv Final Qty =
      *    *COMPUTE (x1 + x2 + x3 +x4 + x5)
      * x1    : DB1.ISC Ending Inventory Qty
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.ISC End Inv Adj Qty
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.ISC Sun Shp Inv Adj Qty
      * +     : PGM.*Synon (15,2) work field
      * x4    : DB1.ISC Unsh/Ship Inv Adj Qty
      * +     : PGM.*Synon (15,2) work field
      * x5    : DB1.ISC End Inv Partial Qty
     C           WFOOQT    ADD  WFOSQT    W0WA03           *Synon (15,2) w
     C           W0WA03    ADD  WFOPQT    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WFOQQT    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  WFORQT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WFOTQT           ISC End Inv Fin
      * Compute:Ending Inv Fin Lb
      * DB1.ISC End Inv Final Lbs =
      *    *COMPUTE (x1 + x2 + x3 +x4 + x5)
      * x1    : DB1.ISC Ending Inventory Lbs
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.ISC End Inv Adj Lbs
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.ISC Sun Shp Inv Adj Lbs
      * +     : PGM.*Synon (15,2) work field
      * x4    : DB1.ISC Unsh/Ship Inv Adj Lbs
      * +     : PGM.*Synon (15,2) work field
      * x5    : DB1.ISC End Inv Partial Lbs
     C           WFM0WG    ADD  WFM4WG    W0WA03           *Synon (15,2) w
     C           W0WA03    ADD  WFM1WG    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WFM2WG    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  WFM3WG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WFM5WG           ISC End Inv Fin
     C           KLCRSF    KLIST
     C                     KFLD           WFAIDX           ISC Week Ending
     C                     KFLD           WFB2C3           ISC Warehouse C
     C                     KFLD           WFGRAA           ISC Warehouse C
     C                     KFLD           WFEJC7           ISC Item Code
      * Check for duplicate primary key
     C           KLCRSF    SETLL@BSCPA5                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3530' W0RTN   7
      * Send message 'Inventory Stock Closin EX'
     C                     MOVEL'USR3530' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@BSCPA5                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Date/Time         RT - Inventory Stock Close Ctl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGFXTX           ISC Data Collec
      * Setup key
     C                     Z-ADDWL0082    WGAIC3           Company Number
     C                     MOVELWL0083    WGFXTX           ISC Data Collec
      * Establish starting position
     C           KRSSG     CHAIN@A5REKR              90    *
      * Data record not found
     C   90                MOVEL'USR3743' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWGC0TM    WL0084           ISC From Time
     C                     Z-ADDWGC1TM    WL0085           ISC To Time
      * Rtv Prior Day per par RT - Calendar  * 
     C                     EXSR SHRVGN
      * RTV Next Day per par  RT - Calendar  * 
     C                     EXSR SIRVGN
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Prior Day per par RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSH01           Company Number
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WABCDT           Post to G/L Dat
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
      * Setup key
     C                     Z-ADDWGAIC3    WQSH01           Company Number
     C                     Z-ADDWL0086    WABCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSH     SETLL@AFREPU                    *
     C           KRSSH     READE@AFREPU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0087           Date Mon USR
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Day of Week EQ PAR.Day of Week
     C           WAA9ST    IFEQ WGF1TX                     *IF
     C                     Z-ADDWABCDT    WL0087           Date Mon USR
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSH     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Next Day per par  RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSI01           Company Number
      * Define keylist
     C           KPSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WHBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
      * Setup key
     C                     Z-ADDWGAIC3    WQSI01           Company Number
     C                     Z-ADDWL0086    WHBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSI     SETLL@AFREBE                    *
     C           KRSSI     READE@AFREBE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0088           Scheduled Ship
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Day of Week EQ PAR.Day of Week
     C           WHA9ST    IFEQ WGF0TX                     *IF
     C                     Z-ADDWHBCDT    WL0088           Scheduled Ship
     C                     GOTO SIEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSI     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Next Sunday        RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSJ01           Company Number
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WHBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
      * Setup key
     C                     Z-ADDP1B2C3    WQSJ01           Company Number
     C                     Z-ADDP5JMDT    WHBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSJ     SETLL@AFREBE                    *
     C           KRSSJ     READE@AFREBE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUJNDT           Scheduled Ship
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Day of Week is Sunday
     C           WHA9ST    IFEQ '1'                        *IF
     C                     Z-ADDWHBCDT    WUJNDT           Scheduled Ship
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSJ     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P4JNDT           Date Sun USR
     C                     Z-ADD*ZERO     P5JMDT           Date Sat USR
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WACQNB           Julian Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEINB           Week Number
     C                     Z-ADD*ZERO     WAAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WAOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WANQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WANRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WAOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WAOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIDX           ISC Week Ending
     C                     Z-ADD*ZERO     WBB2C3           ISC Warehouse C
     C                     Z-ADD*ZERO     WBEJC7           ISC Item Code
     C                     Z-ADD*ZERO     WBF3PR           ISC Item Market
     C                     Z-ADD*ZERO     WBBSNY           ISC Item Struct
     C                     Z-ADD*ZERO     WBBTNY           ISC Item Struct
     C                     Z-ADD*ZERO     WBBUNY           ISC Item Struct
     C                     Z-ADD*ZERO     WBOEQT           ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WBMQWG           ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WBOFQT           ISC Beg Inv Adj
     C                     Z-ADD*ZERO     WBMRWG           ISC Beg Inv Adj
     C                     Z-ADD*ZERO     WBOGQT           ISC Beg Inv Qty
     C                     Z-ADD*ZERO     WBMXWG           ISC Beg Inv Lbs
     C                     Z-ADD*ZERO     WBOHQT           ISC Floor Produ
     C                     Z-ADD*ZERO     WBMSWG           ISC Floor Produ
     C                     Z-ADD*ZERO     WBOWQT           ISC Floor Prod
     C                     Z-ADD*ZERO     WBNAWG           ISC Floor Prod
     C                     Z-ADD*ZERO     WBOIQT           ISC Sales Produ
     C                     Z-ADD*ZERO     WBMTWG           ISC Sales Produ
     C                     Z-ADD*ZERO     WBOJQT           ISC Inventory S
     C                     Z-ADD*ZERO     WBMUWG           ISC Inventory S
     C                     Z-ADD*ZERO     WBOKQT           ISC Ord Dtl Shi
     C                     Z-ADD*ZERO     WBMVWG           ISC Ord Dtl Shi
     C                     Z-ADD*ZERO     WBOLQT           ISC Shipment Fi
     C                     Z-ADD*ZERO     WBMWWG           ISC Shipment Fi
     C                     Z-ADD*ZERO     WBFQVL           ISC FOB Gross A
     C                     Z-ADD*ZERO     WBOMQT           ISC Inventory T
     C                     Z-ADD*ZERO     WBMYWG           ISC Inventory T
     C                     Z-ADD*ZERO     WBONQT           ISC Misc Invntr
     C                     Z-ADD*ZERO     WBMZWG           ISC Misc Invntr
     C                     Z-ADD*ZERO     WBOOQT           ISC Ending Inve
     C                     Z-ADD*ZERO     WBM0WG           ISC Ending Inve
     C                     Z-ADD*ZERO     WBP9DT           ISC End Inv Dat
     C                     Z-ADD*ZERO     WBCTTM           ISC End Inv Tim
     C                     Z-ADD*ZERO     WBOPQT           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WBM1WG           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WBOQQT           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WBM2WG           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WBORQT           ISC End Inv Par
     C                     Z-ADD*ZERO     WBM3WG           ISC End Inv Par
     C                     Z-ADD*ZERO     WBOSQT           ISC End Inv Adj
     C                     Z-ADD*ZERO     WBM4WG           ISC End Inv Adj
     C                     Z-ADD*ZERO     WBP8DT           ISC Ending Inv
     C                     Z-ADD*ZERO     WBCSTM           ISC Ending Inv
     C                     Z-ADD*ZERO     WBOTQT           ISC End Inv Fin
     C                     Z-ADD*ZERO     WBM5WG           ISC End Inv Fin
     C                     Z-ADD*ZERO     WBF4PR           ISC Warehouse P
     C                     Z-ADD*ZERO     WBOUQT           ISC Commission
     C                     Z-ADD*ZERO     WBM6WG           ISC Unused Lbs
     C                     Z-ADD*ZERO     WBOVQT           ISC TF Exempt N
     C                     Z-ADD*ZERO     WBM7WG           ISC TF Exempt L
     C                     Z-ADD*ZERO     WBQADT           ISC Unused Date
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field ISC Item Structure Class
     C                     Z-ADD*ZERO     WUBUNY  30
      * Define work field ISC Item Structure Group
     C                     Z-ADD*ZERO     WUBTNY  30
      * Define work field ISC Item Structure Type
     C                     Z-ADD*ZERO     WUBSNY  30
      * Define work field ISC Item Dft Cmdty Mkt Bs
     C                     MOVEL*BLANK    WUGQAA  3
      * Define work field ISC Item Type
     C                     MOVEL*BLANK    WUW1SX  3
      * Define work field ISC Item Cmdty Price Grp
     C                     MOVEL*BLANK    WUGPAA  7
      * Define work field ISC Item G/L Sub Code
     C                     MOVEL*BLANK    WUGSAA  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WCAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WCAIWG           Unit Weight
     C                     Z-ADD*ZERO     WCCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WCC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WCURTN           Number Cases On
     C                     Z-ADD*ZERO     WCACC8           Vendor item Def
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCTFNB           Transportation
     C                     Z-ADD*ZERO     WCCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WCSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WCPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WCSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WCA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WCSJNB           Production Lead
     C                     Z-ADD*ZERO     WCSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WCSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WCSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WCCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WCCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WCILNB           Packages per ca
     C                     Z-ADD*ZERO     WCCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WCCINB           PM Batch Size
     C                     Z-ADD*ZERO     WCCJNB           Package Level s
     C                     Z-ADD*ZERO     WCCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WCCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WCCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WCCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WCCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WCCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WCCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WCCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WCC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WCB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WCTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WCTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WCBLPR           Market Overage
     C                     Z-ADD*ZERO     WCBMPR           Standard Overag
     C                     Z-ADD*ZERO     WCCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCICN1           Item Category N
     C                     Z-ADD*ZERO     WCICN2           Item Category N
     C                     Z-ADD*ZERO     WCV2NB           Item Category N
     C                     Z-ADD*ZERO     WCITCN           Item Category N
     C                     Z-ADD*ZERO     WCITC5           Item Category N
     C                     Z-ADD*ZERO     WCICN6           Item Category N
     C                     Z-ADD*ZERO     WCICN7           Item Category N
     C                     Z-ADD*ZERO     WCICN8           Item Category N
     C                     Z-ADD*ZERO     WCICN9           Item Category N
     C                     Z-ADD*ZERO     WCICN0           Item Category N
     C                     Z-ADD*ZERO     WCB5NB           PM Line Number
     C                     Z-ADD*ZERO     WCBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WCBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WCF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WCF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WCF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WCBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WCBNNB           Production Qty
     C                     Z-ADD*ZERO     WCAHTM           Job Time
     C                     Z-ADD*ZERO     WCEKDT           Job Date
      * Define work field ISC Item U/M - Pricing
     C                     MOVEL*BLANK    WUGTAA  2
      * Define work field ISC Item Market Overage
     C                     Z-ADD*ZERO     WUF3PR 114
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAIWG           Unit Weight
     C                     Z-ADD*ZERO     WDCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WDC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WDURTN           Number Cases On
     C                     Z-ADD*ZERO     WDAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDTFNB           Transportation
     C                     Z-ADD*ZERO     WDTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WDTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WDBLPR           Market Overage
     C                     Z-ADD*ZERO     WDBMPR           Standard Overag
     C                     Z-ADD*ZERO     WDCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WDCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WDSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WDPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WDICN1           Item Category N
     C                     Z-ADD*ZERO     WDICN2           Item Category N
     C                     Z-ADD*ZERO     WDV2NB           Item Category N
     C                     Z-ADD*ZERO     WDITCN           Item Category N
     C                     Z-ADD*ZERO     WDITC5           Item Category N
     C                     Z-ADD*ZERO     WDICN6           Item Category N
     C                     Z-ADD*ZERO     WDICN7           Item Category N
     C                     Z-ADD*ZERO     WDICN8           Item Category N
     C                     Z-ADD*ZERO     WDICN9           Item Category N
     C                     Z-ADD*ZERO     WDICN0           Item Category N
     C                     Z-ADD*ZERO     WDSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WDA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WDSJNB           Production Lead
     C                     Z-ADD*ZERO     WDSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WDSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WDSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WDCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WDCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WDILNB           Packages per ca
     C                     Z-ADD*ZERO     WDCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WDCINB           PM Batch Size
     C                     Z-ADD*ZERO     WDCJNB           Package Level s
     C                     Z-ADD*ZERO     WDCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WDCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WDCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WDCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WDCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WDCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WDCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WDCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WDC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WDB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WDB5NB           PM Line Number
     C                     Z-ADD*ZERO     WDBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WDBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WDF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WDF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WDF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WDBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WDBNNB           Production Qty
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field ISC Warehouse Type
     C                     MOVEL*BLANK    WUV8SX  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WEBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WEBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WEBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WEBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field ISC Post Balance Sts
     C                     MOVEL*BLANK    WUWNSX  1
      * Define work field ISC Post Warehouse Sts
     C                     MOVEL*BLANK    WUWOSX  1
      * Define work field ISC Beg Inv Lbs
     C                     Z-ADD*ZERO     WUMXWG 112
      * Define work field ISC Beg Inv Qty
     C                     Z-ADD*ZERO     WUOGQT 112
      * Define work field ISC Warehouse Price Ovrrd
     C                     MOVEL*BLANK    WUWBSX  1
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field ISC Unused Sts 2
     C                     MOVEL*BLANK    WUWDSX  2
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC0TM           ISC From Time
     C                     Z-ADD*ZERO     WGC1TM           ISC To Time
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Define work field Date Sun USR
     C                     Z-ADD*ZERO     WUJNDT  70
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA03 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001  1
     C                     Z-ADD*ZERO     WL0002  80
     C                     Z-ADD*ZERO     WL0003  80
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005  70
      * Define local variables for subroutine SFCRRC.
     C                     Z-ADD*ZERO     WL0006  80
     C                     Z-ADD*ZERO     WL0007  30
     C                     MOVEL*BLANK    WL0008  3
     C                     Z-ADD*ZERO     WL0009  70
     C                     MOVEL*BLANK    WL0010  2
     C                     MOVEL*BLANK    WL0011  7
     C                     MOVEL*BLANK    WL0012  3
     C                     MOVEL*BLANK    WL0013  3
     C                     Z-ADD*ZERO     WL0014 114
     C                     Z-ADD*ZERO     WL0015  30
     C                     Z-ADD*ZERO     WL0016  30
     C                     Z-ADD*ZERO     WL0017  30
     C                     MOVEL*BLANK    WL0018  3
     C                     MOVEL*BLANK    WL0019  2
     C                     Z-ADD*ZERO     WL0020 112
     C                     Z-ADD*ZERO     WL0021 112
     C                     Z-ADD*ZERO     WL0022 112
     C                     Z-ADD*ZERO     WL0023 112
     C                     Z-ADD*ZERO     WL0024 112
     C                     Z-ADD*ZERO     WL0025 112
     C                     Z-ADD*ZERO     WL0026 112
     C                     Z-ADD*ZERO     WL0027 112
     C                     Z-ADD*ZERO     WL0028 112
     C                     Z-ADD*ZERO     WL0029 112
     C                     Z-ADD*ZERO     WL0030 112
     C                     Z-ADD*ZERO     WL0031 112
     C                     Z-ADD*ZERO     WL0032 112
     C                     Z-ADD*ZERO     WL0033 112
     C                     Z-ADD*ZERO     WL0034 112
     C                     Z-ADD*ZERO     WL0035 112
     C                     Z-ADD*ZERO     WL0036 112
     C                     Z-ADD*ZERO     WL0037 112
     C                     Z-ADD*ZERO     WL0038 112
     C                     Z-ADD*ZERO     WL0039 112
     C                     Z-ADD*ZERO     WL0040 112
     C                     Z-ADD*ZERO     WL0041 112
     C                     Z-ADD*ZERO     WL0042 112
     C                     Z-ADD*ZERO     WL0043 112
     C                     Z-ADD*ZERO     WL0044 112
     C                     MOVEL*BLANK    WL0045 10
     C                     Z-ADD*ZERO     WL0046  70
     C                     Z-ADD*ZERO     WL0047  60
     C                     Z-ADD*ZERO     WL0048 112
     C                     Z-ADD*ZERO     WL0049 112
     C                     Z-ADD*ZERO     WL0050 112
     C                     Z-ADD*ZERO     WL0051 112
     C                     Z-ADD*ZERO     WL0052 112
     C                     Z-ADD*ZERO     WL0053 112
     C                     Z-ADD*ZERO     WL0054 112
     C                     Z-ADD*ZERO     WL0055 112
     C                     MOVEL*BLANK    WL0056 60
     C                     MOVEL*BLANK    WL0057 10
     C                     Z-ADD*ZERO     WL0058  70
     C                     Z-ADD*ZERO     WL0059  60
     C                     Z-ADD*ZERO     WL0060 112
     C                     Z-ADD*ZERO     WL0061 112
     C                     Z-ADD*ZERO     WL0062  94
     C                     MOVEL*BLANK    WL0063  1
     C                     MOVEL*BLANK    WL0064  1
     C                     MOVEL*BLANK    WL0065  1
     C                     Z-ADD*ZERO     WL0066 112
     C                     Z-ADD*ZERO     WL0067 112
     C                     Z-ADD*ZERO     WL0068 112
     C                     Z-ADD*ZERO     WL0069 112
     C                     MOVEL*BLANK    WL0070  1
     C                     Z-ADD*ZERO     WL0071  70
     C                     MOVEL*BLANK    WL0072  2
     C                     MOVEL*BLANK    WL0073  1
     C                     Z-ADD*ZERO     WL0074  70
     C                     Z-ADD*ZERO     WL0075  60
     C                     MOVEL*BLANK    WL0076 10
     C                     MOVEL*BLANK    WL0077 10
     C                     Z-ADD*ZERO     WL0078  70
     C                     Z-ADD*ZERO     WL0079  60
     C                     MOVEL*BLANK    WL0080 10
     C                     MOVEL*BLANK    WL0081 10
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0082  30
     C                     MOVEL*BLANK    WL0083  2
     C                     Z-ADD*ZERO     WL0084  60
     C                     Z-ADD*ZERO     WL0085  60
     C                     Z-ADD*ZERO     WL0086  70
     C                     Z-ADD*ZERO     WL0087  70
     C                     Z-ADD*ZERO     WL0088  70
      * Define local work field ISC From Time
     C                     Z-ADD*ZERO     YL0001  60
      * Define local work field ISC To Time
     C                     Z-ADD*ZERO     YL0002  60
      * Define local work field From Date             USR
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field Thru Date             USR
     C                     Z-ADD*ZERO     YL0004  70
      *================================================================
     CSR         ZZEXIT    ENDSR
