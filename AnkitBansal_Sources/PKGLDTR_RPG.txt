     H/TITLE Dsp Th/Ttt Scale Tkt  DT  Display transactions
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Display DBF header and associated DBF detail records
     H* - DBF header record fields appear on SFL control record
     H* - DBF detail records appear on SFL detail record
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Display transactions
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJBADE
     H* Date          : 02/05/21  Time  : 16:25:15
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKGLDTR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: Dsp Th/Ttt Scale Tkt  DT  Display transactions
      *
     FPKA1CPLZIF  E           K        DISK
     F                                              KINFDS INFDS1
      * SPN : Tattoo Header             SPN Tto Hdr/Ttto ScaleTk
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKA3REL1IF  E           K        DISK
      * RTV : Pen                       Retrieval index
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKA8REL1IF  E           K        DISK
      * RTV : Hog Classification        Retrieval index
      *
     FPKA7REL1IF  E           K        DISK
      * RTV : Hog Defect                Retrieval index
      *
     FPKCCREL0IF  E           K        DISK
      * RTV : Tattoo Header Process     Retrieval index
      *
     FPKADREL0IF  E           K        DISK
      * RTV : Hog Buyer                 Retrieval index
      *
     FPKAIREL0IF  E           K        DISK
      * RTV : Genetic                   Retrieval index
      *
      * Long constants
     E                    @CN#    1  31  6   @CN    25
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WAHMNB
     I              A1BNNB                          WABNNB
     I              A1BONB                          WABONB
     I              A1CVNB                          WACVNB
     I              A1B0DT                          WAB0DT
     I              A1AWDT                          WAAWDT
     I              A1BICD                          WABICD
     I              A1CPST                          WACPST
     I              A1ACPR                          WAACPR
     I              A1B9PR                          WAB9PR
     I              A1CAPR                          WACAPR
     I              A1C4ST                          WAC4ST
     I              A1AIPR                          WAAIPR
     I              A1A6DT                          WAA6DT
     I              A1C2ST                          WAC2ST
     I              A1CXNB                          WACXNB
     I              A1CWNB                          WACWNB
     I              A1FCNB                          WAFCNB
     I              A1H9NB                          WAH9NB
     I              A1FDNB                          WAFDNB
     I              A1FENB                          WAFENB
     I              A1HENB                          WAHENB
     I              A1HFNB                          WAHFNB
     I              A1CYNB                          WACYNB
     I              A1LRNB                          WALRNB
     I              A1E0NB                          WAE0NB
     I              A1A5PC                          WAA5PC
     I              A1FBNB                          WAFBNB
     I              A1A4PC                          WAA4PC
     I              A1F7NB                          WAF7NB
     I              A1HDNB                          WAHDNB
     I              A1F5NB                          WAF5NB
     I              A1F4NB                          WAF4NB
     I              A1F3NB                          WAF3NB
     I              A1F2NB                          WAF2NB
     I              A1AVPC                          WAAVPC
     I              A1AWPC                          WAAWPC
     I              A1CWPC                          WACWPC
     I              A1A8PC                          WAA8PC
     I              A1A7PC                          WAA7PC
     I              A1B8PR                          WAB8PR
     I              A1AMPR                          WAAMPR
     I              A1ANPR                          WAANPR
     I              A1AYVA                          WAAYVA
     I              A1AWVA                          WAAWVA
     I              A1AOPR                          WAAOPR
     I              A1AXVA                          WAAXVA
     I              A1APPR                          WAAPPR
     I              A1ASPR                          WAASPR
     I              A1A4VA                          WAA4VA
     I              A1ATPR                          WAATPR
     I              A1A5VA                          WAA5VA
     I              A1CBPR                          WACBPR
     I              A1CCPR                          WACCPR
     I              A1LPNB                          WALPNB
     I              A1CDPR                          WACDPR
     I              A1A7VA                          WAA7VA
     I              A1A2PR                          WAA2PR
     I              A1JWST                          WAJWST
     I              A1CWST                          WACWST
     I              A1D7ST                          WAD7ST
     I              A1D8ST                          WAD8ST
     I              A1DWST                          WADWST
     I              A1D6ST                          WAD6ST
     I              A1GHNB                          WAGHNB
     I              A1BYDT                          WABYDT
     I              A1E0ST                          WAE0ST
     I              A1E1ST                          WAE1ST
     I              A1E2ST                          WAE2ST
     I              A1BSDT                          WABSDT
     I              A1BTDT                          WABTDT
     I              A1BUDT                          WABUDT
     I              A1HGNB                          WAHGNB
     I              A1HHNB                          WAHHNB
     I              A1HINB                          WAHINB
     I              A1A3PR                          WAA3PR
     I              A1A4PR                          WAA4PR
     I              A1A6PR                          WAA6PR
     I              A1J9NB                          WAJ9NB
     I              A1D6PR                          WAD6PR
     I              A1D7PR                          WAD7PR
     I              A1D8PR                          WAD8PR
     I              A1D9PR                          WAD9PR
     I              A1EAPR                          WAEAPR
     I              A1EBPR                          WAEBPR
     I              A1ECPR                          WAECPR
     I              A1EDPR                          WAEDPR
     I              A1EEPR                          WAEEPR
     I              A1EFPR                          WAEFPR
     I              A1EGPR                          WAEGPR
     I              A1EHPR                          WAEHPR
     I              A1KAST                          WAKAST
     I              A1J7ST                          WAJ7ST
     I              A1J9ST                          WAJ9ST
     I              A1OXNB                          WAOXNB
     I              A1LKST                          WALKST
     I              A1LLST                          WALLST
     I              A1J8ST                          WAJ8ST
     I              A1LIST                          WALIST
     I              A1LJST                          WALJST
     I              A1NZTX                          WANZTX
     I              A1HJCD                          WAHJCD
     I              A1R4ST                          WAR4ST
     I              A1R5ST                          WAR5ST
     I              A1R6ST                          WAR6ST
     I              A1R7ST                          WAR7ST
     I              A1THWT                          WATHWT
     I              A1T2WT                          WAT2WT
     I              A1THHD                          WATHHD
     I              A1T2HD                          WAT2HD
     I              A1OBPR                          WAOBPR
     I              A1KOER                          WAKOER
     I              A1OPIR                          WAOPIR
     I              A1OPEM                          WAOPEM
     I              A1IORP                          WAIORP
     I              A1OWEO                          WAOWEO
     I              A1OQET                          WAOQET
     I              A1URST                          WAURST
     I              A1USST                          WAUSST
     I              A1HHPC                          WAHHPC
     I              A1S9PR                          WAS9PR
     I              A1TAPR                          WATAPR
     I              A1TBPR                          WATBPR
     I              A1JFUR                          WAJFUR
     I              A1KRIF                          WAKRIF
     I              A1KORF                          WAKORF
     I              A1KAPR                          WAKAPR
     I              A1KROT                          WAKROT
     I              A1OTJG                          WAOTJG
     I              A1IRJG                          WAIRJG
     I              A1IMJF                          WAIMJF
     I              A1IRGF                          WAIRGF
     I              A1KRJF                          WAKRJF
     I              A1OJRF                          WAOJRF
     I              A1KFOR                          WAKFOR
     I              A1ORJK                          WAORJK
     I              A1OMVJ                          WAOMVJ
     I              A1MVNF                          WAMVNF
     I              A1MCNF                          WAMCNF
     I              A1NCNF                          WANCNF
     I              A1NCHF                          WANCHF
     I              A1IGIR                          WAIGIR
     I              A1KFJR                          WAKFJR
     I              A1EADT                          WAEADT
     I              A1EBDT                          WAEBDT
     I              A1ECDT                          WAECDT
     I              A1EDDT                          WAEDDT
     I              A1EEDT                          WAEEDT
     I              A1U4ST                          WAU4ST
     I              A1U5ST                          WAU5ST
     I              A1U6ST                          WAU6ST
     I              A1U7ST                          WAU7ST
     I              A1U8ST                          WAU8ST
     I              A1U9ST                          WAU9ST
     I              A1VAST                          WAVAST
     I              A1VBST                          WAVBST
     I              A1BDCD                          WABDCD
     I              A1CSCD                          WACSCD
     I              A1ABCD                          WAABCD
     I              A1AECD                          WAAECD
     I              A1ACCD                          WAACCD
     I              A1AGCD                          WAAGCD
     I              A1BECD                          WABECD
     I              A1AAVN                          WAAAVN
     I              A1AADT                          WAAADT
     I              A1AMTM                          WAAMTM
     I              A1AJST                          WAAJST
     I              A1AHVN                          WAAHVN
     I              A1AGVN                          WAAGVN
     I              A1ABVN                          WAABVN
     I              A1ABDT                          WAABDT
     I              A1ABTM                          WAABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      * Outward parameters
     IPARC        DS                             18
      * KEY : Tattoo Scale Ticket       Retrieval index
      * I : MAP BOH Company Number
     I                                    P   1   20PAHMNB
      * I : MAP BOH Buy Order Number
     I                                    P   3   60PABNNB
      * I : MAP BOL Load Number
     I                                    P   7   90PABONB
      * I : MAP TH Tattoo Number
     I                                    P  10  120PACVNB
      * I : MAP TH Kill Date
     I                                    P  13  160PAB0DT
      *
      * Outward parameters
     IPBRC        DS                             16
      * KEY : Tattoo Header             Retrieval index
      * I : RST BOH Company Number
     I                                    P   1   20PBHMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60PBBNNB
      * I : RST BOL Load Number
     I                                    P   7   90PBBONB
      * I : RST TH Tattoo Number
     I                                    P  10  120PBCVNB
      * I : RST TH Kill Date
     I                                    P  13  160PBB0DT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I : RST BOL Load Number
     I                                    P   7   90P1BONB
      * I : RST TH Tattoo Number
     I                                    P  10  120P1CVNB
      * I : RST TH Kill Date
     I                                    P  13  160P1B0DT
      * I : MAP DF Defect Code
     I                                       17  22 P1BDCD
      * I : MAP PD Producer Code
     I                                       23  28 P1ABCD
      * I : MAP PL Location Code
     I                                       29  34 P1AECD
      * I : MAP HC Class Code
     I                                       35  37 P1BECD
     IP2PARM      DS
      * FLD: *Arrays
      * I : MAP Oms Warehouse Code
     I                                        1   3 P2J8NB
      * I : MAP CC Company Number
     I                                    P   4   50P2HONB
      * I : MAP Oms Application Code
     I                                        6  11 P2C7CD
      * I : MAP Oms SalesPerson Code
     I                                       12  14 P2C8CD
      * I : MAP Oms Allow Multi-Company
     I                                       15  15 P2G8ST
      * I : MAP Oms Default Printer
     I                                       16  25 P2G9ST
      * I : MAP Oms Name
     I                                       26  55 P2EUTX
      * I : MAP Oms System Value Alpha
     I                                       56  95 P2EVTX
      * I : MAP Oms Access Denied (Y/N)
     I                                       96  96 P2HAST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BNNB    PARM           WP0002  70       BOH Buy Order N
     C           P1BONB    PARM           WP0003  50       BOL Load Number
     C           P1CVNB    PARM           WP0004  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0005  70       TH Kill Date
     C           P1BDCD    PARM           WP0006  6        DF Defect Code
     C           P1ABCD    PARM           WP0007  6        PD Producer Cod
     C           P1AECD    PARM           WP0008  6        PL Location Cod
     C           P1BECD    PARM           WP0009  3        HC Class Code
     C           P2J8NB    PARM           WP0010  3        Oms Warehouse C
     C           P2HONB    PARM           WP0011  30       CC Company Numb
     C           P2C7CD    PARM           WP0012  6        Oms Application
     C           P2C8CD    PARM           WP0013  3        Oms SalesPerson
     C           P2G8ST    PARM           WP0014  1        Oms Allow Multi
     C           P2G9ST    PARM           WP0015 10        Oms Default Pri
     C           P2EUTX    PARM           WP0016 30        Oms Name
     C           P2EVTX    PARM           WP0017 40        Oms System Valu
     C           P2HAST    PARM           WP0018  1        Oms Access Deni
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Set first cycle indicator
     C                     MOVEL'Y'       W01ST   1
      * Conduct program process
      * Set first cycle indicator
     C                     MOVEL'Y'       W01ST   1
     C                     DO   *HIVAL                     DO
      * Initialize screen
     C                     EXSR ABIZSF
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'                        DO
      * Convert fields to external form
     C                     EXSR MOCV#1
      * Bypass screen on first cycle
     C           W01ST     IFNE 'Y'
      * Display screen
     C                     EXSR CAEXFM
     C                     END
      * Cancel first cycle indicator
     C                     MOVEL'N'       W01ST
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG           CAS
      * HOME: Request subfile reload
     C   30                CAS            ADHMKY
      * Validate screen input
     C                     CAS            DAPRSF
     C                     END                             SAC
      *
     C                     END                             OD
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      * Set first cycle indicator
     C           W0TRN     IFEQ 'N'                        IF
     C                     MOVEL'Y'       W01ST   1
     C                     SETOF                     30    *
     C                     END                             IF
     C                     END                             OD
      *****************************************************************
      /EJECT
     CSR         ABIZSF    BEGSR
      *================================================================
      * Initialize screen
      *================================================================
     C                     SETOF                     81    *
      * Initialise subfile control
     C                     EXSR MAIZ#1
      * Initialise screen detail record
     C                     EXSR MDIZ#2
      * Clear subfile
     C                     SETON                     80    *
     C                     WRITE#SFLCTL
     C                     SETOF                     80    *
      * Reset count of SFL records
     C                     Z-ADD*ZERO     ##RRMX  50
     C                     Z-ADD*ZERO     ##RR    50
     C                     MOVEL'KEY'     W0SCR   3
      * Position subfile on page 1
     C                     Z-ADD1         ##SFRC
     C                     MOVEL'Y'       W0TRN   1
     C                     MOVEL'Y'       W0FST   1
      *================================================================
     CSR         ABEXIT    ENDSR
      /EJECT
     CSR         ADHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN   1
      *================================================================
     CSR         ADEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      *
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * PUTOVR unless conditioned fields change
     C                     SETON                     86
     C           *IN88     IFNE CAIN88
     C           *IN81     ORNE CAIN81
     C                     SETOF                     86
     C                     END
     C                     MOVE *IN88     CAIN88  1
     C                     MOVE *IN81     CAIN81  1
     C                     MOVELW0SCR     W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END                              UOD
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSF    BEGSR
      *================================================================
      * Process subfile records
      *================================================================
      * Confirm/update is not deferred
     C           YPMTFD    IFEQ *BLANKS
     C                     MOVEL'N'       W0DCF   1
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Initialise derived fields
     C                     EXSR MJIZ#2
     C                     END
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Validate SFL control keys if input
     C           W0SCR     IFEQ 'KEY'
     C                     EXSR DCVLH1
     C                     END
      * QUIT if error:
     C   99                GOTO DAEXIT
      * If keys only, now get the rest of the data
     C           W0SCR     IFEQ 'KEY'
     C           YPMTFD    ANDEQ*BLANKS
     C                     EXSR DBLDSF
     C                     GOTO DAEXIT
     C                     END
      * Validate SFL control non keys
     C                     EXSR DEVLH2
      *................................................................
      * Process subfile records
     C           *IN81     IFEQ '1'
     C           1         DO   ##RRMX    ##RR
     C           ##RR      CHAIN#SFLRCD              92    *
      * Setof record error indicators
      * 98Invalid SFLRCD
     C                     SETOF                         98
      * Copy header keys to detail record
     C                     Z-ADDP1HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    #1BONB           BOL Load Number
     C                     Z-ADDP1CVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    #1B0DT           TH Kill Date
      * Validate subfile record
     C                     EXSR DIVLSF
      * If SFLRCD invalid, note that errors present
     C   98N99             Z-ADD##RR      ##SFRC     99    *
      * Convert fields to external form
     C                     EXSR MNCV#2
     C                     UPDAT#SFLRCD
     C                     END                             OD
     C                     END                             FI
      *................................................................
      * Quit if subfile invalid:
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * Calculate function fields
     C                     EXSR DKVLHV
      * Quit if header invalid:
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * USER: Process command keys
      * CASE: CTL.*CMD key is CF16
     C           *IN16     IFEQ '1'                        *IF
      * User selected to reprint scale ticket with out update
      * Pmt Prt Scale Tkt AFK PV - STR Prompt  * 
     C                     CLEARPARC
     C                     Z-ADD#2HMNB    PAHMNB           BOH Company Num
     C                     Z-ADD#2BNNB    PABNNB           BOH Buy Order N
     C                     Z-ADD#2BONB    PABONB           BOL Load Number
     C                     Z-ADD#2CVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADD#2B0DT    PAB0DT           TH Kill Date
      *
     C                     CALL 'PKHCPVR'              90  Pmt Prt Scale T
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Tattoo Sca
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKHCPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: CTL.*CMD key is CF17
     C           *IN17     IFEQ '1'                        *IF
      * Dsp Tattoo Defect     DF - Tattoo Defect  * 
     C                     CLEARPBRC
     C                     Z-ADD#2HMNB    PBHMNB           BOH Company Num
     C                     Z-ADD#2BNNB    PBBNNB           BOH Buy Order N
     C                     Z-ADD#2BONB    PBBONB           BOL Load Number
     C                     Z-ADD#2CVNB    PBCVNB           TH Tattoo Numbe
     C                     Z-ADD#2B0DT    PBB0DT           TH Kill Date
      *
     C                     CALL 'PKJ6DFR'              90  Dsp Tattoo Defe
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Tattoo Hea
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ6DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * THIS IS CURRENTLY BEING DEVELOPED BY SusanMason 2/21/2014
      * F19=ReApply Scale Ticket  ONLY if already done with this tattoo s
      * CASE: CTL.*CMD key is CF19
     C           *IN19     IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUNMST           Allow Change Us
      * CASE: JOB.*USER is PorkISTesting
     C           ##USR     IFEQ @CN,001                    *IF
     C           ##USR     OREQ @CN,002
     C           ##USR     OREQ @CN,003
     C           ##USR     OREQ @CN,004
     C           ##USR     OREQ @CN,005
     C           ##USR     OREQ @CN,006
     C           ##USR     OREQ @CN,007
     C           ##USR     OREQ @CN,008
     C           ##USR     OREQ @CN,009
     C           ##USR     OREQ @CN,010
     C           ##USR     OREQ @CN,011
     C           ##USR     OREQ @CN,012
     C           ##USR     OREQ @CN,013
     C           ##USR     OREQ @CN,014
     C           ##USR     OREQ @CN,015
     C           ##USR     OREQ @CN,016
     C           ##USR     OREQ @CN,017
     C           ##USR     OREQ @CN,018
     C           ##USR     OREQ @CN,019
     C           ##USR     OREQ @CN,020
     C           ##USR     OREQ @CN,021
     C           ##USR     OREQ @CN,022
     C           ##USR     OREQ @CN,023
     C           ##USR     OREQ @CN,024
     C           ##USR     OREQ @CN,025
     C           ##USR     OREQ @CN,026
     C           ##USR     OREQ @CN,027
     C                     ELSE
      * CASE: JOB.*USER is Receiving Group
     C           ##USR     IFEQ @CN,028                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUNMST           Allow Change Us
      * Send message 'Option ReApply Not Allow'
     C                     MOVEL'PRK1295' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Vry BOL Head InfoPay  RT - Buy Order Load  * 
     C                     EXSR SARVGN
      * CASE: WRK.Allow Change Usr Y/N is Yes
     C           WUNMST    IFEQ 'Y'                        *IF
      * Rtv Tattoo InforReApp RT - Tattoo Header  * 
     C                     EXSR SBRVGN
      * Tattoo validation
      * CASE: LCL.TH Payment Sts is Paid Anything
     C           YL0005    IFEQ 'PL'                       *IF
     C           YL0005    OREQ 'PC'
     C           YL0005    OREQ 'NC'
     C           YL0005    OREQ 'NL'
     C                     MOVEL'N'       WUNMST           Allow Change Us
      * Send message 'Tattoo Is paid OptnNAll'
     C                     MOVEL'PRK0724' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: LCL.TH Held Over is greater than 0
     C           YL0004    IFGT *ZERO                      *IF
     C                     MOVEL'N'       WUNMST           Allow Change Us
      * Send message 'Held Overs on Tattoo'
     C                     MOVEL'PRK1242' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: LCL.TH Held/Ovr Completed Dte is Greater than 0
     C           YL0007    IFGT *ZERO                      *IF
     C                     MOVEL'N'       WUNMST           Allow Change Us
      * Send message 'Held Overs on Tattoo'
     C                     MOVEL'PRK1242' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Allow Change Usr Y/N is Yes
     C           WUNMST    IFEQ 'Y'                        *IF
      * THIS IS CURRENTLY BEING DEVELOPED BY SusanMason 2/21/2014
      * Re-Apply the Tattoo Scale data
      * Send message 'Processing'
     C                     MOVEL'PRK0957' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * Exc Scl Tkt,w/Upd ReApXF - Tattoo Scale Ticket  * 
     C                     CALL 'PLUFXFR'              90  zExc Scl Tkt,w/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2HMNB    WQ0001  30       BOH Company Num
     C                     PARM #2BNNB    WQ0002  70       BOH Buy Order N
     C                     PARM #2BONB    WQ0003  50       BOL Load Number
     C                     PARM #2CVNB    WQ0004  50       TH Tattoo Numbe
     C                     PARM #2B0DT    WQ0005  70       TH Kill Date
     C                     PARM 'N'       WQ0006  1        TH Scale Ticket
     C                     PARM WUMLST    WQ0007  1        Print Scale Tkt
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLUFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2HMNB    WQ0008  30       BOH Company Num
     C                     PARM #2BNNB    WQ0009  70       BOH Buy Order N
     C                     PARM #2BONB    WQ0010  50       BOL Load Number
     C                     PARM #2CVNB    WQ0011  50       TH Tattoo Numbe
     C                     PARM #2B0DT    WQ0012  70       TH Kill Date
     C                     PARM WUCWNB    WQ0013  50       TH Head Receive
     C                     PARM WUH9NB    WQ0014  50       TH Held Over
     C                     PARM WULPNB    WQ0015  80       TH AP Voucher/D
     C                     PARM WUBYDT    WQ0016  70       TH Voucher Paym
     C                     PARM 'TS'      WQ0017  2        Tattoo Action U
     C                     PARM WUDDCD    WQ0018  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Exit after successful update
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBLDSF    BEGSR
      *================================================================
      * Load screen fields from DBF
      *================================================================
      * Load subfile control from DBF
     C                     EXSR MBFL#1
      * Validate SFL control non keys
     C                     EXSR DFVLH3
      * Read all DBF detail records for header
      * Read ahead
     C           KSPNH     READE@B3CPRG                  82*
     C           *IN82     DOWEQ'0'
      * For each DBF detail record read:
     C                     ADD  1         ##RR    50
     C                     EXSR MDIZ#2
     C                     EXSR MEFL#2
      * USER: Initialize subfile record
      * CASE: RCD.TST Head is Not Zero
     C           #1FMNB    IFNE *ZERO                      *IF
     C           #1FLNB    DIV  #1FMNB    #RD7NB           TD Avg Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #RD7NB           TD Avg Live Wgt
     C                     END                             *FI
     C                     Z-ADD#1FMNB    #RB5NB           Head Total USR
     C                     Z-ADD#1FLNB    #RH3NB           Weight Tot USR
      * Rtv Pen Type          RT - Pen  * 
     C                     EXSR SCRVGN
      * Manual / Live Scale
      * CASE: DB2.TST Record Created Status is Manual Record
     C           B3I3ST    IFEQ 'M'                        *IF
     C                     MOVEL@CN,029   #RG2TX           @Desc 15
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,030   #RG2TX           @Desc 15
     C                     END                             *FI
      * Scale ticket printed or not
      * CASE: DB2.RS Record Status is Active
     C           B3AJST    IFEQ 'A'                        *IF
     C                     MOVELWUCRTX    #REQTX           @Desc 30
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #REQTX           @Desc 30
     C                     MOVEL@CN,031   #REQTX           @Desc 30
     C                     END                             *FI
     C           YPMTFD    IFEQ *BLANKS
      * Validate details
     C                     EXSR DJVLSF
     C                     END
      * Output DBF to subfile
      * Convert fields to external form
     C                     EXSR MNCV#2
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
      * Read next Data record
     C           KSPNH     READE@B3CPRG                  82*
     C                     END                             WOD
     C                     Z-ADD##RR      ##RRMX     81    *
     C           YPMTFD    IFEQ *BLANKS
      * Calculate function fields
     C                     EXSR DKVLHV
     C                     END
     C                     MOVEL'DTL'     W0SCR
      * Position subfile on page 1
     C                     Z-ADD1         ##SFRC
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCVLH1    BEGSR
      *================================================================
      * Validate header keys
      *================================================================
      * Check restriction within
     C                     EXSR VACKRL
      * Check existence of header
     C           YPMTFD    IFEQ *BLANKS
     C           KSPNH     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#2HMNB    A1HMNB
     C                     Z-ADD#2BNNB    A1BNNB
     C                     Z-ADD#2BONB    A1BONB
     C                     Z-ADD#2CVNB    A1CVNB
     C                     Z-ADD#2B0DT    A1B0DT
     C           KSPNH     CHAIN@A1CPRF              90    *
      * If header not found, error
     C   90                DO
     C                     SETON                     99    PC
      * Send message 'Tattoo Header          NF'
     C                     MOVEL'PRK0061' ZAMSID
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DEVLH2    BEGSR
      *================================================================
      * Validate header non-key fields
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate header non-key fields
      * Rtv Producer Name     RT - Producer  * 
     C                     EXSR SDRVGN
      * Rtv Pdctn Loc Name    RT - Producer Location  * 
     C                     EXSR SERVGN
      * Rtv Hog Class         RT - Hog Classification  * 
     C                     EXSR SFRVGN
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR SGRVGN
      * CASE: CTL.TH Scale Ticket Sts is Printed
     C           #2J7ST    IFEQ 'P'                        *IF
     C                     MOVEL'R'       #2J7ST           TH Scale Ticket
     C                     END                             *FI
     C                     END
      * Validate relations if no field errors
     C           *IN99     IFNE '1'
     C                     EXSR DFVLH3
     C                     END
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         DFVLH3    BEGSR
      *================================================================
      * Validate header non-key relations
      *================================================================
      * Check reference to Hog Defect
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Tattoo Header Process
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Producer Location
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Hog Buyer
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Genetic
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Hog Classification
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         DFEXIT    ENDSR
      /EJECT
     CSR         DIVLSF    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record fields
     C           #1FLNB    DIV  #1FMNB    #RD7NB           TD Avg Live Wgt
      * CASE: CTL.TH Scale Ticket Sts is Printed
     C           #2J7ST    IFEQ 'P'                        *IF
     C                     MOVEL'R'       #2J7ST           TH Scale Ticket
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Validate relations if no field errors
     C  N98                EXSR DJVLSF
     C                     END
      *================================================================
     CSR         DIEXIT    ENDSR
      /EJECT
     CSR         DJVLSF    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
      * Check reference to Pen
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      *
      * CALC: Subfile record function fields
     C                     ADD  #1FMNB    #CQENB           Head Received
     C                     ADD  #1FLNB    #CGRNB           Weight SUM
      * Manual / Live Scale
      * CASE: DB2.TST Record Created Status is Manual Record
     C           B3I3ST    IFEQ 'M'                        *IF
     C                     MOVEL@CN,029   #RG2TX           @Desc 15
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,030   #RG2TX           @Desc 15
     C                     END                             *FI
      * Scale ticket printed or not
      * CASE: DB2.RS Record Status is Active
     C           B3AJST    IFEQ 'A'                        *IF
     C                     MOVELWUCRTX    #REQTX           @Desc 30
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #REQTX           @Desc 30
     C                     MOVEL@CN,031   #REQTX           @Desc 30
     C                     END                             *FI
      *================================================================
     CSR         DJEXIT    ENDSR
      /EJECT
     CSR         DKVLHV    BEGSR
      *================================================================
      * Calculate function fields
      *================================================================
      * CALC: Header function fields
      * CASE: CTL.Head Received  SUM is Not Zero
     C           #CQENB    IFNE *ZERO                      *IF
     C           #CGRNB    DIV  #CQENB    #2F7NB           TH Avg Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #2F7NB           TH Avg Live Wgt
     C                     END                             *FI
      *================================================================
     CSR         DKEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
      * Set 87 = Detail screen, 88 = Key screen
     C           W0SCR     COMP 'DTL'                    87*
     C           W0SCR     COMP 'KEY'                    88*
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise header fields
      *================================================================
     C                     MOVELP2EVTX    #PEVTX           Oms System Valu
     C                     MOVELP2J8NB    #PJ8NB           Oms Warehouse C
     C                     Z-ADDP2HONB    #PHONB           CC Company Numb
     C                     MOVELP2C7CD    #PC7CD           Oms Application
     C                     MOVELP2C8CD    #PC8CD           Oms SalesPerson
     C                     MOVELP2G8ST    #PG8ST           Oms Allow Multi
     C                     MOVELP2G9ST    #PG9ST           Oms Default Pri
     C                     MOVELP2EUTX    #PEUTX           Oms Name
     C                     MOVELP2HAST    #PHAST           Oms Access Deni
     C                     Z-ADDP1HMNB    #2HMNB           BOH Company Num
     C                     MOVELP1BDCD    #2BDCD           DF Defect Code
     C                     MOVEL*BLANK    #CBCTX           DF Description
     C                     Z-ADD*ZERO     #2AWDT           TH Purchase Dat
     C                     MOVEL*BLANK    #2BICD           TH Group Refere
     C                     MOVEL*BLANK    #2CPST           TH Live Purchas
     C                     Z-ADD*ZERO     #2ACPR           TH Live Purchas
     C                     Z-ADD*ZERO     #2B9PR           TH Live Gross A
     C                     Z-ADD*ZERO     #2CAPR           TH LIve Net Amt
     C                     MOVEL*BLANK    #2C4ST           TH Resale UOM
     C                     Z-ADD*ZERO     #2AIPR           TH Recalc Live
     C                     Z-ADD*ZERO     #2A6DT           TH Pricing Date
     C                     MOVEL*BLANK    #2C2ST           TH Resale Sprea
     C                     Z-ADD*ZERO     #2CXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     #2CWNB           TH Head Receive
     C                     Z-ADD*ZERO     #2FCNB           TH Yard Deads
     C                     Z-ADD*ZERO     #2H9NB           TH Held Over
     C                     Z-ADD*ZERO     #2FDNB           TH Head Condemn
     C                     Z-ADD*ZERO     #2FENB           TH Head Killed
     C                     Z-ADD*ZERO     #2HENB           TH Head Adds
     C                     Z-ADD*ZERO     #2HFNB           TH Head Accepte
     C                     Z-ADD*ZERO     #2CYNB           TH Live Wgt
     C                     Z-ADD*ZERO     #2LRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     #2E0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     #2A5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     #2FBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     #2A4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     #2HDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     #2F5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     #2F4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     #2F3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     #2F2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     #2AVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     #2AWPC           TH Actual Yield
     C                     Z-ADD*ZERO     #2CWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     #2A8PC           TH Yield Differ
     C                     Z-ADD*ZERO     #2A7PC           TH Recalc Live
     C                     Z-ADD*ZERO     #2B8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     #2AMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     #2ANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     #2AYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     #2AWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     #2AOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     #2AXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     #2APPR           TH CM Carcass G
     C                     Z-ADD*ZERO     #2ASPR           TH Deduction Am
     C                     Z-ADD*ZERO     #2A4VA           TH Total Net WO
     C                     Z-ADD*ZERO     #2ATPR           TH Carcass Net
     C                     Z-ADD*ZERO     #2A5VA           TH Additions Am
     C                     Z-ADD*ZERO     #2CBPR           TH Payment Gros
     C                     Z-ADD*ZERO     #2CCPR           Th Payment Net
     C                     Z-ADD*ZERO     #2LPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     #2CDPR           TH Freight Amou
     C                     Z-ADD*ZERO     #2A7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     #2A2PR           TH Fixed Cost A
     C                     MOVEL*BLANK    #2JWST           TH Calc Net Sts
     C                     MOVEL*BLANK    #2CWST           TH Payment Sts
     C                     MOVEL*BLANK    #2D7ST           TH Header Error
     C                     MOVEL*BLANK    #2D8ST           TH Detail Error
     C                     MOVEL*BLANK    #2DWST           TH Kill Balanci
     C                     MOVEL*BLANK    #2D6ST           TH Bal to Kill
     C                     Z-ADD*ZERO     #2GHNB           TH Commission A
     C                     Z-ADD*ZERO     #2BYDT           TH Voucher Paym
     C                     MOVEL*BLANK    #2E0ST           TH User Error O
     C                     MOVEL*BLANK    #2E1ST           TH Held Over Re
     C                     MOVEL*BLANK    #2E2ST           TH Sex
     C                     Z-ADD*ZERO     #2BSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     #2BTDT           TH Commission P
     C                     Z-ADD*ZERO     #2BUDT           TH Actual Check
     C                     Z-ADD*ZERO     #2HGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     #2HHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     #2HINB           TH FFLI
     C                     Z-ADD*ZERO     #2A3PR           TH Kill Product
     C                     Z-ADD*ZERO     #2A4PR           TH Cut Product
     C                     Z-ADD*ZERO     #2A6PR           TH Render Produ
     C                     Z-ADD*ZERO     #2J9NB           TH Head Exclude
     C                     Z-ADD*ZERO     #2D6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     #2D7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     #2D8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     #2D9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     #2EAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     #2EBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     #2ECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     #2EDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     #2EEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     #2EFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     #2EGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     #2EHPR           TH CM Gross Car
     C                     MOVEL*BLANK    #2KAST           TH Source Type
     C                     MOVEL*BLANK    #2J7ST           TH Scale Ticket
     C                     MOVEL*BLANK    #2J8ST           TH Posted to HP
     C                     MOVEL*BLANK    #2LIST           TH Schedule Kil
     C                     MOVEL*BLANK    #2LJST           TH Shift Held O
     C                     MOVEL*BLANK    #2NZTX           TH State
     C                     MOVEL*BLANK    #2HJCD           TH Unused Code
     C                     MOVEL*BLANK    #2R4ST           TH Unused Sts 2
     C                     MOVEL*BLANK    #2R5ST           TH Commission S
     C                     MOVEL*BLANK    #2R6ST           TH Paid 2 Week
     C                     MOVEL*BLANK    #2R7ST           TH Unused Sts 1
     C                     Z-ADD*ZERO     #2THWT           TH DOA Weight
     C                     Z-ADD*ZERO     #2T2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     #2THHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     #2T2HD           TH Shift Held O
     C                     Z-ADD*ZERO     #2OBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     #2KOER           TH Head Identif
     C                     Z-ADD*ZERO     #2OPIR           TH Percent Iden
     C                     Z-ADD*ZERO     #2OPEM           TH Percent Acce
     C                     Z-ADD*ZERO     #2IORP           TH Head Adjuste
     C                     Z-ADD*ZERO     #2OWEO           TH PHA Head Add
     C                     MOVEL*BLANK    #2OQET           TH PHA Add Type
     C                     MOVEL*BLANK    #2URST           TH PHA Average
     C                     MOVEL*BLANK    #2USST           TH PHA Add Reas
     C                     Z-ADD*ZERO     #2HHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     #2S9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     #2TAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     #2TBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     #2JFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     #2KRIF           TH Broken Back
     C                     Z-ADD*ZERO     #2KORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     #2KAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     #2KROT           TH Excluded Car
     C                     Z-ADD*ZERO     #2OTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     #2IRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     #2IMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     #2IRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     #2KRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     #2OJRF           TH Break Even P
     C                     Z-ADD*ZERO     #2KFOR           TH Meat Value F
     C                     Z-ADD*ZERO     #2ORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     #2OMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     #2MVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     #2MCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     #2NCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     #2NCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     #2IGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     #2KFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     #2EADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     #2EBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     #2ECDT           TH Head LFT
     C                     Z-ADD*ZERO     #2EDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     #2EEDT           TH Unused Date
     C                     MOVEL*BLANK    #2U4ST           TH Unused Sts 1
     C                     MOVEL*BLANK    #2U5ST           TH Unused Sts 2
     C                     MOVEL*BLANK    #2U6ST           TH Unused Sts 3
     C                     MOVEL*BLANK    #2U7ST           TH Unused Sts 4
     C                     MOVEL*BLANK    #2U8ST           TH Unused Sts 5
     C                     MOVEL*BLANK    #2U9ST           TH Unused Sts 6
     C                     MOVEL*BLANK    #2VAST           TH Unused Sts 7
     C                     MOVEL*BLANK    #2VBST           TH Unused Sts 8
     C                     MOVEL*BLANK    #2J9ST           TH Payment Type
     C                     Z-ADD*ZERO     #2OXNB           TH HPS Movement
     C                     MOVEL*BLANK    #2LKST           TH Source Code
     C                     MOVEL*BLANK    #2LLST           TH Hog Class Ty
     C                     MOVEL*BLANK    #2AGCD           GN Genetic Code
     C                     MOVEL*BLANK    #2CSCD           THP Process Cod
     C                     MOVEL*BLANK    #2ACCD           HB Buyer Code
     C                     MOVEL*BLANK    #2AAVN           RS User Changed
     C                     Z-ADD*ZERO     #2AADT           RS Date Changed
     C                     Z-ADD*ZERO     #2AMTM           RS Time Changed
     C                     MOVEL*BLANK    #2AJST           RS Record Statu
     C                     MOVEL*BLANK    #2AHVN           RS Job
     C                     MOVEL*BLANK    #2AGVN           RS Program
     C                     MOVEL*BLANK    #2ABVN           RS User Added
     C                     Z-ADD*ZERO     #2ABDT           RS Date Added
     C                     Z-ADD*ZERO     #2ABTM           RS Time Added
     C                     MOVELP1ABCD    #2ABCD           PD Producer Cod
     C                     MOVEL*BLANK    #CAGTX           PD Name
     C                     MOVELP1AECD    #2AECD           PL Location Cod
     C                     MOVEL*BLANK    #CA8TX           PL Name
     C                     Z-ADDP1BNNB    #2BNNB           BOH Buy Order N
     C                     Z-ADDP1B0DT    #2B0DT           TH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V2B0DT
     C                     Z-ADDP1BONB    #2BONB           BOL Load Number
     C                     MOVELP1BECD    #2BECD           HC Class Code
     C                     MOVEL*BLANK    #CBDTX           HC Description
     C                     Z-ADDP1CVNB    #2CVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     #CQENB           Head Received
     C                     Z-ADD*ZERO     #CGRNB           Weight SUM
     C                     Z-ADD*ZERO     #2F7NB           TH Avg Live Wgt
      * Check restriction within
     C                     EXSR VICKRL
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move file header fields to screen header
      *================================================================
     C                     Z-ADDA1HMNB    #2HMNB           BOH Company Num
     C                     MOVELA1BDCD    #2BDCD           DF Defect Code
     C                     Z-ADDA1AWDT    #2AWDT           TH Purchase Dat
     C                     MOVELA1BICD    #2BICD           TH Group Refere
     C                     MOVELA1CPST    #2CPST           TH Live Purchas
     C                     Z-ADDA1ACPR    #2ACPR           TH Live Purchas
     C                     Z-ADDA1B9PR    #2B9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    #2CAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    #2C4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    #2AIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    #2A6DT           TH Pricing Date
     C                     MOVELA1C2ST    #2C2ST           TH Resale Sprea
     C                     Z-ADDA1CXNB    #2CXNB           TH Dead On Arri
     C                     Z-ADDA1CWNB    #2CWNB           TH Head Receive
     C                     Z-ADDA1FCNB    #2FCNB           TH Yard Deads
     C                     Z-ADDA1H9NB    #2H9NB           TH Held Over
     C                     Z-ADDA1FDNB    #2FDNB           TH Head Condemn
     C                     Z-ADDA1FENB    #2FENB           TH Head Killed
     C                     Z-ADDA1HENB    #2HENB           TH Head Adds
     C                     Z-ADDA1HFNB    #2HFNB           TH Head Accepte
     C                     Z-ADDA1CYNB    #2CYNB           TH Live Wgt
     C                     Z-ADDA1LRNB    #2LRNB           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    #2E0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    #2A5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    #2FBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    #2A4PC           TH Tot Light Re
     C                     Z-ADDA1HDNB    #2HDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    #2F5NB           TH Avg Light Re
     C                     Z-ADDA1F4NB    #2F4NB           TH Avg Lean Per
     C                     Z-ADDA1F3NB    #2F3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    #2F2NB           TH Avg Backfat
     C                     Z-ADDA1AVPC    #2AVPC           TH Std Yield Pe
     C                     Z-ADDA1AWPC    #2AWPC           TH Actual Yield
     C                     Z-ADDA1CWPC    #2CWPC           TH Adj Actual Y
     C                     Z-ADDA1A8PC    #2A8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    #2A7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    #2B8PR           TH CM Market Pr
     C                     Z-ADDA1AMPR    #2AMPR           TH CM Base Mkt
     C                     Z-ADDA1ANPR    #2ANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    #2AYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    #2AWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    #2AOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    #2AXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    #2APPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    #2ASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    #2A4VA           TH Total Net WO
     C                     Z-ADDA1ATPR    #2ATPR           TH Carcass Net
     C                     Z-ADDA1A5VA    #2A5VA           TH Additions Am
     C                     Z-ADDA1CBPR    #2CBPR           TH Payment Gros
     C                     Z-ADDA1CCPR    #2CCPR           Th Payment Net
     C                     Z-ADDA1LPNB    #2LPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    #2CDPR           TH Freight Amou
     C                     Z-ADDA1A7VA    #2A7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    #2A2PR           TH Fixed Cost A
     C                     MOVELA1JWST    #2JWST           TH Calc Net Sts
     C                     MOVELA1CWST    #2CWST           TH Payment Sts
     C                     MOVELA1D7ST    #2D7ST           TH Header Error
     C                     MOVELA1D8ST    #2D8ST           TH Detail Error
     C                     MOVELA1DWST    #2DWST           TH Kill Balanci
     C                     MOVELA1D6ST    #2D6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    #2GHNB           TH Commission A
     C                     Z-ADDA1BYDT    #2BYDT           TH Voucher Paym
     C                     MOVELA1E0ST    #2E0ST           TH User Error O
     C                     MOVELA1E1ST    #2E1ST           TH Held Over Re
     C                     MOVELA1E2ST    #2E2ST           TH Sex
     C                     Z-ADDA1BSDT    #2BSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    #2BTDT           TH Commission P
     C                     Z-ADDA1BUDT    #2BUDT           TH Actual Check
     C                     Z-ADDA1HGNB    #2HGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    #2HHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    #2HINB           TH FFLI
     C                     Z-ADDA1A3PR    #2A3PR           TH Kill Product
     C                     Z-ADDA1A4PR    #2A4PR           TH Cut Product
     C                     Z-ADDA1A6PR    #2A6PR           TH Render Produ
     C                     Z-ADDA1J9NB    #2J9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    #2D6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    #2D7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    #2D8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    #2D9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    #2EAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    #2EBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    #2ECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    #2EDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    #2EEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    #2EFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    #2EGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    #2EHPR           TH CM Gross Car
     C                     MOVELA1KAST    #2KAST           TH Source Type
     C                     MOVELA1J7ST    #2J7ST           TH Scale Ticket
     C                     MOVELA1J8ST    #2J8ST           TH Posted to HP
     C                     MOVELA1LIST    #2LIST           TH Schedule Kil
     C                     MOVELA1LJST    #2LJST           TH Shift Held O
     C                     MOVELA1NZTX    #2NZTX           TH State
     C                     MOVELA1HJCD    #2HJCD           TH Unused Code
     C                     MOVELA1R4ST    #2R4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    #2R5ST           TH Commission S
     C                     MOVELA1R6ST    #2R6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    #2R7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    #2THWT           TH DOA Weight
     C                     Z-ADDA1T2WT    #2T2WT           TH Avg Lean % E
     C                     Z-ADDA1THHD    #2THHD           TH HPS Farm Sit
     C                     Z-ADDA1T2HD    #2T2HD           TH Shift Held O
     C                     Z-ADDA1OBPR    #2OBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    #2KOER           TH Head Identif
     C                     Z-ADDA1OPIR    #2OPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    #2OPEM           TH Percent Acce
     C                     Z-ADDA1IORP    #2IORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    #2OWEO           TH PHA Head Add
     C                     MOVELA1OQET    #2OQET           TH PHA Add Type
     C                     MOVELA1URST    #2URST           TH PHA Average
     C                     MOVELA1USST    #2USST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    #2HHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    #2S9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    #2TAPR           TH VC Gross Val
     C                     Z-ADDA1TBPR    #2TBPR           TH Excluded Gro
     C                     Z-ADDA1JFUR    #2JFUR           TH Avg Lean %
     C                     Z-ADDA1KRIF    #2KRIF           TH Broken Back
     C                     Z-ADDA1KORF    #2KORF           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    #2KAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    #2KROT           TH Excluded Car
     C                     Z-ADDA1OTJG    #2OTJG           TH Excluded Pre
     C                     Z-ADDA1IRJG    #2IRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    #2IMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    #2IRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    #2KRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    #2OJRF           TH Break Even P
     C                     Z-ADDA1KFOR    #2KFOR           TH Meat Value F
     C                     Z-ADDA1ORJK    #2ORJK           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    #2OMVJ           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    #2MVNF           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    #2MCNF           TH Avg Backfat
     C                     Z-ADDA1NCNF    #2NCNF           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    #2NCHF           TH MPR Sort Los
     C                     Z-ADDA1IGIR    #2IGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    #2KFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    #2EADT           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    #2EBDT           TH Cold Scl Upl
     C                     Z-ADDA1ECDT    #2ECDT           TH Head LFT
     C                     Z-ADDA1EDDT    #2EDDT           TH Head EUT/KOA
     C                     Z-ADDA1EEDT    #2EEDT           TH Unused Date
     C                     MOVELA1U4ST    #2U4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    #2U5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    #2U6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    #2U7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    #2U8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    #2U9ST           TH Unused Sts 6
     C                     MOVELA1VAST    #2VAST           TH Unused Sts 7
     C                     MOVELA1VBST    #2VBST           TH Unused Sts 8
     C                     MOVELA1J9ST    #2J9ST           TH Payment Type
     C                     Z-ADDA1OXNB    #2OXNB           TH HPS Movement
     C                     MOVELA1LKST    #2LKST           TH Source Code
     C                     MOVELA1LLST    #2LLST           TH Hog Class Ty
     C                     MOVELA1AGCD    #2AGCD           GN Genetic Code
     C                     MOVELA1CSCD    #2CSCD           THP Process Cod
     C                     MOVELA1ACCD    #2ACCD           HB Buyer Code
     C                     MOVELA1AAVN    #2AAVN           RS User Changed
     C                     Z-ADDA1AADT    #2AADT           RS Date Changed
     C                     Z-ADDA1AMTM    #2AMTM           RS Time Changed
     C                     MOVELA1AJST    #2AJST           RS Record Statu
     C                     MOVELA1AHVN    #2AHVN           RS Job
     C                     MOVELA1AGVN    #2AGVN           RS Program
     C                     MOVELA1ABVN    #2ABVN           RS User Added
     C                     Z-ADDA1ABDT    #2ABDT           RS Date Added
     C                     Z-ADDA1ABTM    #2ABTM           RS Time Added
     C                     MOVELA1ABCD    #2ABCD           PD Producer Cod
     C                     MOVELA1AECD    #2AECD           PL Location Cod
     C                     Z-ADDA1BNNB    #2BNNB           BOH Buy Order N
     C                     Z-ADDA1B0DT    #2B0DT           TH Kill Date
     C                     Z-ADDA1BONB    #2BONB           BOL Load Number
     C                     MOVELA1BECD    #2BECD           HC Class Code
     C                     Z-ADDA1CVNB    #2CVNB           TH Tattoo Numbe
     C                     Z-ADDA1F7NB    #2F7NB           TH Avg Live Wgt
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#2    BEGSR
      *================================================================
      * Initialise screen detail record
      *================================================================
     C                     Z-ADD*ZERO     #RH3NB           Weight Tot USR
     C                     Z-ADD*ZERO     #RB5NB           Head Total USR
     C                     Z-ADDP1HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    #1BONB           BOL Load Number
     C                     Z-ADDP1CVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    #1B0DT           TH Kill Date
     C                     Z-ADD*ZERO     #1JDA1           TST Wgt Hour
     C                     Z-ADD*ZERO     #1CFDT           TST Last Zero D
     C                     Z-ADD*ZERO     #1APTM           TST Last Zero T
     C                     MOVEL*BLANK    #1I3ST           TST Record Crea
     C                     Z-ADD*ZERO     #1HVNB           Pen Company Num
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     Z-ADD*ZERO     #1FKNB           TST Sequence Nu
     C                     Z-ADD*ZERO     #1FMNB           TST Head
     C                     Z-ADD*ZERO     #1FLNB           TST Wgt
     C                     Z-ADD*ZERO     #RD7NB           TD Avg Live Wgt
     C                     Z-ADD*ZERO     #1B6DT           TST Wgt Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1B6DT
     C                     Z-ADD*ZERO     #1ANTM           TST Wgt Time
     C                     MOVEL*BLANK    #1CMCD           Pen Number
     C                     MOVEL*BLANK    #RG2TX           @Desc 15
     C                     MOVEL*BLANK    #REQTX           @Desc 30
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MEFL#2    BEGSR
      *================================================================
      * Load screen detail record
      *================================================================
     C                     Z-ADDB3HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDB3BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDB3BONB    #1BONB           BOL Load Number
     C                     Z-ADDB3CVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADDB3B0DT    #1B0DT           TH Kill Date
     C                     Z-ADDB3JDA1    #1JDA1           TST Wgt Hour
     C                     Z-ADDB3CFDT    #1CFDT           TST Last Zero D
     C                     Z-ADDB3APTM    #1APTM           TST Last Zero T
     C                     MOVELB3I3ST    #1I3ST           TST Record Crea
     C                     Z-ADDB3HVNB    #1HVNB           Pen Company Num
     C                     MOVELB3AAVN    #1AAVN           RS User Changed
     C                     Z-ADDB3AADT    #1AADT           RS Date Changed
     C                     Z-ADDB3AMTM    #1AMTM           RS Time Changed
     C                     MOVELB3AJST    #1AJST           RS Record Statu
     C                     MOVELB3AHVN    #1AHVN           RS Job
     C                     MOVELB3AGVN    #1AGVN           RS Program
     C                     MOVELB3ABVN    #1ABVN           RS User Added
     C                     Z-ADDB3ABDT    #1ABDT           RS Date Added
     C                     Z-ADDB3ABTM    #1ABTM           RS Time Added
     C                     Z-ADDB3FKNB    #1FKNB           TST Sequence Nu
     C                     Z-ADDB3FMNB    #1FMNB           TST Head
     C                     Z-ADDB3FLNB    #1FLNB           TST Wgt
     C                     Z-ADDB3B6DT    #1B6DT           TST Wgt Date
     C                     Z-ADDB3ANTM    #1ANTM           TST Wgt Time
     C                     MOVELB3CMCD    #1CMCD           Pen Number
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MJIZ#2    BEGSR
      *================================================================
      * Initialise derived fields
      *================================================================
     C                     Z-ADD*ZERO     #CQENB           Head Received
     C                     Z-ADD*ZERO     #CGRNB           Weight SUM
      *================================================================
     CSR         MJEXIT    ENDSR
      /EJECT
     CSR         MNCV#2    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert TST Wgt Date to display format
      * Convert date
     C           1000000   ADD  #1B6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B6DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#1    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #2B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2B0DT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Vry BOL Head InfoPay  RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#2HMNB    AXHMNB           BOH Company Num
     C                     Z-ADD#2BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADD#2BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSSA     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAXI1ST    YL0001           BOL Freight All
     C                     Z-ADDAXDHNB    YL0002           BOL Head Receiv
     C                     Z-ADDAXDINB    YL0003           BOL Live Wgt Re
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Tattoo InforReApp RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
     C                     KFLD           WACVNB           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#2HMNB    WAHMNB           BOH Company Num
     C                     Z-ADD#2BNNB    WABNNB           BOH Buy Order N
     C                     Z-ADD#2BONB    WABONB           BOL Load Number
     C                     Z-ADD#2CVNB    WACVNB           TH Tattoo Numbe
     C                     Z-ADD#2B0DT    WAB0DT           TH Kill Date
      * Establish starting position
     C           KRSSB     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Pen Type          RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           A3HVNB           Pen Company Num
     C                     KFLD           A3CMCD           Pen Number
      * Setup key
     C                     Z-ADD#1HVNB    A3HVNB           Pen Company Num
     C                     MOVEL#1CMCD    A3CMCD           Pen Number
      * Establish starting position
     C           KRSSC     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA3FWST    WUFWST           Pen Type
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#2ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSD     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAGTX    #CAGTX           PD Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Pdctn Loc Name    RT - Producer Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVEL#2ABCD    AFABCD           PD Producer Cod
     C                     MOVEL#2AECD    AFAECD           PL Location Cod
      * Establish starting position
     C           KRSSE     CHAIN@AFREAR              90    *
      * Data record not found
     C   90                MOVEL'PRK0015' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAFA8TX    #CA8TX           PL Name
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Hog Class         RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           A8BECD           HC Class Code
      * Setup key
     C                     MOVEL#2BECD    A8BECD           HC Class Code
      * Establish starting position
     C           KRSSF     CHAIN@A8REDA              90    *
      * Data record not found
     C   90                MOVEL'PRK0075' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA8BDTX    #CBDTX           HC Description
     C                     MOVELA8BXST    WUBXST           HC Defect Requi
     C                     MOVELA8BYST    WUBYST           HC Price Requir
     C                     MOVELA8BITX    WUBITX           HC Resolution
     C                     MOVELA8B0ST    WUB0ST           HC Qualificatio
     C                     MOVELA8FBST    #2LLST           HC Class Type
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#2BDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSG     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    #CBCTX           DF Description
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    #CBCTX           DF Description
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * C2156 DOA HELD OVERS
      * 12/24/96   SLM     User was report of Doa after scale tickets
      *                    were done.  The tattoo was sent to kill and th
      *                    missed reporting doas.  So if the user had the
      *                    scaling pgm up for this tattoo before the sent
      *                    was completed then when the scaleing exits the
      *                    scale ticket file is recounted which puts the
      *                    held overs back on the org day.  Tattoo scale
      *                    tickets are not moved for held overs.
      *                    Validate if there is one tattoo detail for thi
      *                    tattoo that has been driven then do not allow
      *                    user to change the tattoo scale file.
      *                    Also if error go to display pgm
      *                    Only if no error, and all open tattoo detail
      *                    will the edits be allowed.
      * C2287 Scale Tickets Afk
      * 01/24/97   SLM     User is needs to be allow to print scale
      *                    tickets after sent to kill because they are no
      *                    the shipped weight from the producer until lat
      *                    in the day.  The hogs could already be sent to
      *                    kill.
      *                    Create a routine that will not recount the
      *                    tattoo scale to the tattoo hdr, or the
      *                    buy order, or the pens.
      * E3625 JJH 12/04/14 - Recompile because PrklISTesting List for
      *  field *USER to add users Julius High (ISJHIGH) and Collin Lynch
      *  ISCLYNC.
      * H16853 ISE 01/23/21 - Increased the length from 5 to 7 and correc
      *                       alignment for Buy Order Number field.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#2HMNB'
     C           YPMTFD    OREQ '#2BNNB'
     C           YPMTFD    OREQ '#2BONB'
     C           YPMTFD    OREQ '#2CVNB'
     C           YPMTFD    OREQ '#2B0DT'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2HMNB' defaulted for 'BOH Company Number'.
      * Field '(CTL) #2CVNB' defaulted for 'TH Tattoo Number'.
      * Field '(CTL) #2B0DT' defaulted for 'TH Kill Date'.
     C                     CALL 'PKB7SRR'              90  Sel Kill/Tattoo
     C                     PARM *BLANK    W0RTN   7
     C           #2HMNB    PARM #2HMNB    WQ0019  30       BOH Company Num
     C           #2CVNB    PARM #2CVNB    WQ0020  50       TH Tattoo Numbe
     C           #2B0DT    PARM #2B0DT    WQ0021  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKB7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2CVNB    IFNE *ZERO                      TH Tattoo Numbe
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2B0DT    IFNE *ZERO                      TH Kill Date
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Hog Defect
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#2BDCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        DF Defect Code
     C           YPMTFD    OREQ '#2BDCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2BDCD' defaulted for 'DF Defect Code'.
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #2BDCD    PARM #2BDCD    WQ0022  6        DF Defect Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2BDCD    IFNE *BLANK                     DF Defect Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #2BDCD    IFEQ *BLANK                     DF Defect Code
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBA7    KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#2BDCD    A7BDCD
     C           KLVBA7    CHAIN@A7REC1              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Hog Defect             NF'
     C                     MOVEL'PRK0073' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0073' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Tattoo Header Process
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #2CSCD    IFEQ *BLANK                     THP Process Cod
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCCC    KLIST
     C                     KFLD           CCCSCD           THP Process Cod
      * Setup key
     C                     MOVEL#2CSCD    CCCSCD
     C           KLVCCC    CHAIN@CCREH3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Tattoo Header Process  NF'
     C                     MOVEL'PRK0172' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0172' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Producer Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#2ABCD    WK1X01  1
     C                     MOVEL#2AECD    WK1X02  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#2ABCD'
     C           WK1X02    OREQ '?'                        PL Location Cod
     C           YPMTFD    OREQ '#2AECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2ABCD' defaulted for 'PD Producer Code'.
      * Field '(CTL) #2AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PWF5SRR'              90  Sel Prod Loc by
     C                     PARM *BLANK    W0RTN   7
     C           #2ABCD    PARM #2ABCD    WQ0023  6        PD Producer Cod
     C           #2AECD    PARM #2AECD    WQ0024  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWF5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2AECD    IFNE *BLANK                     PL Location Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #2ABCD    IFEQ *BLANK                     PD Producer Cod
     C           #2AECD    ANDEQ*BLANK                     PL Location Cod
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDAF    KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVEL#2ABCD    AFABCD
     C                     MOVEL#2AECD    AFAECD
     C           KLVDAF    CHAIN@AFREAR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Producer Location      NF'
     C                     MOVEL'PRK0015' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0015' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Hog Buyer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#2ACCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        HB Buyer Code
     C           YPMTFD    OREQ '#2ACCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2ACCD' defaulted for 'HB Buyer Code'.
     C                     CALL 'PKD3SRR'              90  Sel Hog Buyer
     C                     PARM *BLANK    W0RTN   7
     C           #2ACCD    PARM #2ACCD    WQ0025  3        HB Buyer Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKD3SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2ACCD    IFNE *BLANK                     HB Buyer Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #2ACCD    IFEQ *BLANK                     HB Buyer Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEAD    KLIST
     C                     KFLD           ADACCD           HB Buyer Code
      * Setup key
     C                     MOVEL#2ACCD    ADACCD
     C           KLVEAD    CHAIN@ADREAF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Hog Buyer              NF'
     C                     MOVEL'PRK0011' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0011' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Genetic
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#2AGCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        GN Genetic Code
     C           YPMTFD    OREQ '#2AGCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2AGCD' defaulted for 'GN Genetic Code'.
     C                     CALL 'PKNASRR'              90  Sel Genetic Act
     C                     PARM *BLANK    W0RTN   7
     C           #2AGCD    PARM #2AGCD    WQ0026  5        GN Genetic Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKNASRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2AGCD    IFNE *BLANK                     GN Genetic Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #2AGCD    IFEQ *BLANK                     GN Genetic Code
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFAI    KLIST
     C                     KFLD           AIAGCD           GN Genetic Code
      * Setup key
     C                     MOVEL#2AGCD    AIAGCD
     C           KLVFAI    CHAIN@AIREA9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Genetic                NF'
     C                     MOVEL'PRK0021' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0021' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Hog Classification
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#2BECD    WK1X01  1
     C           WK1X01    IFEQ '?'                        HC Class Code
     C           YPMTFD    OREQ '#2BECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2BECD' defaulted for 'HC Class Code'.
     C                     CALL 'PKC0SRR'              90  Sel Hog Classif
     C                     PARM *BLANK    W0RTN   7
     C           #2BECD    PARM #2BECD    WQ0027  3        HC Class Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKC0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2BECD    IFNE *BLANK                     HC Class Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #2BECD    IFEQ *BLANK                     HC Class Code
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGA8    KLIST
     C                     KFLD           A8BECD           HC Class Code
      * Setup key
     C                     MOVEL#2BECD    A8BECD
     C           KLVGA8    CHAIN@A8REDA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Hog Classification     NF'
     C                     MOVEL'PRK0075' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0075' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Pen
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CMCD    WK1X02  1
     C           YPMTFD    IFEQ '#1HVNB'
     C           ##RR      ANDEQYPMRRN
     C           WK1X02    OREQ '?'                        Pen Number
     C           YPMTFD    OREQ '#1CMCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1HVNB' defaulted for 'Pen Company Number'.
      * Field '(RCD) #1CMCD' defaulted for 'Pen Number'.
     C                     CALL 'PKJ0SRR'              90  Sel Pen
     C                     PARM *BLANK    W0RTN   7
     C           #1HVNB    PARM #1HVNB    WQ0028  30       Pen Company Num
     C           #1CMCD    PARM #1CMCD    WQ0029  3        Pen Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HVNB    IFNE *ZERO                      Pen Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1CMCD    IFNE *BLANK                     Pen Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HVNB    IFEQ *ZERO                      Pen Company Num
     C           #1CMCD    ANDEQ*BLANK                     Pen Number
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHA3    KLIST
     C                     KFLD           A3HVNB           Pen Company Num
     C                     KFLD           A3CMCD           Pen Number
      * Setup key
     C                     Z-ADD#1HVNB    A3HVNB
     C                     MOVEL#1CMCD    A3CMCD
     C           KLVHA3    CHAIN@A3REDD              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Pen                    NF'
     C                     MOVEL'PRK0065' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0065' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#2HMNB'
     C           YPMTFD    OREQ '#2BNNB'
     C           YPMTFD    OREQ '#2BONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(RCD) #1BNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(RCD) #1BONB' defaulted for 'BOL Load Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2ABCD' defaulted for 'PD Producer Code'.
      * Field '(CTL) #2AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PKQJSRR'              90  Sel Producer BO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0030  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0031  70       BOH Buy Order N
     C           #1BONB    PARM #1BONB    WQ0032  50       BOL Load Number
     C                     PARM #2ABCD    WQ0033  6        PD Producer Cod
     C                     PARM #2AECD    WQ0034  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VI999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVIAX    KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#2HMNB    AXHMNB
     C                     Z-ADD#2BNNB    AXBNNB
     C                     Z-ADD#2BONB    AXBONB
     C           KLVIAX    CHAIN@AXCPBX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
     C           VI999     TAG
      * Restrictor relation not satisfied
      * Send message 'Buy Order Load         NF'
     C                     MOVEL'PRK0051' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0051' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD13        ZHSTRW  40
     C                     Z-ADD20        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Allow Change Usr Y/N
     C                     MOVEL*BLANK    WUNMST  1
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WAACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WAB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WACAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WAAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WAA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WACXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WACWNB           TH Head Receive
     C                     Z-ADD*ZERO     WAFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WAH9NB           TH Held Over
     C                     Z-ADD*ZERO     WAFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WAFENB           TH Head Killed
     C                     Z-ADD*ZERO     WAHENB           TH Head Adds
     C                     Z-ADD*ZERO     WAHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WACYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WALRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WAE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WAA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WAFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WAA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WAF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WAHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WAF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WAF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WAAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WAAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WACWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WAA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WAA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WAB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WAAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WAAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WAAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WAAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WAAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WAASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WAA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WAATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WAA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WACBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WACCPR           Th Payment Net
     C                     Z-ADD*ZERO     WALPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WACDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WAA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WAA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WAGHNB           TH Commission A
     C                     Z-ADD*ZERO     WABYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WABSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WABTDT           TH Commission P
     C                     Z-ADD*ZERO     WABUDT           TH Actual Check
     C                     Z-ADD*ZERO     WAHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WAHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAHINB           TH FFLI
     C                     Z-ADD*ZERO     WAA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WAA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WAA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WAJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WAD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WAD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WAD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WAD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WAEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WAEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WAECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WAEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WAEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WAEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WAOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WATHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WAT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WATHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WAT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WAOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WAKOER           TH Head Identif
     C                     Z-ADD*ZERO     WAOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WAOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WAIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WAOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WAHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WAS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WATAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WATBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WAJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WAKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WAKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WAKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WAKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WAOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WAIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WAIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WAIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WAKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WAKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WAORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WAOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WAMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WANCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WANCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WAIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WAEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAECDT           TH Head LFT
     C                     Z-ADD*ZERO     WAEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WAEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Print Scale Tkt       USR
     C                     MOVEL*BLANK    WUMLST  1
      * Define work field TH Head Received
     C                     Z-ADD*ZERO     WUCWNB  50
      * Define work field TH Held Over
     C                     Z-ADD*ZERO     WUH9NB  50
      * Define work field TH AP Voucher/Document#
     C                     Z-ADD*ZERO     WULPNB  80
      * Define work field TH Voucher Payment Date
     C                     Z-ADD*ZERO     WUBYDT  70
      * Define work field Tattoo Nbr Alpha Usr
     C                     MOVEL*BLANK    WUDDCD  5
      * Define work field Pen Type
     C                     MOVEL*BLANK    WUFWST  1
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field HC Defect Required
     C                     MOVEL*BLANK    WUBXST  1
      * Define work field HC Price Required
     C                     MOVEL*BLANK    WUBYST  1
      * Define work field HC Resolution
     C                     MOVEL*BLANK    WUBITX 60
      * Define work field HC Qualification
     C                     MOVEL*BLANK    WUB0ST  1
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field BOL Freight Allocation
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field BOL Head Received
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field BOL Live Wgt Received
     C                     Z-ADD*ZERO     YL0003  71
      * Define local work field TH Held Over
     C                     Z-ADD*ZERO     YL0004  50
      * Define local work field TH Payment Sts
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field TH Held Over Record
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field TH Held/Ovr Completed Dte
     C                     Z-ADD*ZERO     YL0007  70
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Subfile page size
     C                     Z-ADD08        ##SFPG  30       SFLPAG
      * Initialise subfile positioner
     C                     Z-ADD1         ##SFRC
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP2EVTX    ##CMP
      *****************************************************************
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PRKTEST
00002 ISPPATE
00003 ISSMASO
00004 ISRCENT
00005 ISPURVAP
00006 ISROSEM
00007 ISSHARONZ
00008 ISSZURN
00009 ISJHIGH
00010 ISJBADE
00011 ISJAMESB
00012 ISDNGUY
00013 ISDANNYN
00014 PRKTESTGU
00015 PRKTESTST
00016 PRKTESTTF
00017 TPMTEST
00018 TFTST961
00019 ISSUSANM
00020 ISJULIUSH
00021 ISBGUTI
00022 ISBARBG
00023 TFBKNAD
00024 ISBBARK
00025 ISNFOY
00026 ISNATHANF
00027 ISDREDD
00028 OKJGLOV
00029 Manual Entry
00030 Live Scale
00031 Printed
