     H/TITLE Prg MPR Info           XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 01:30:20
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKE4CPL3IF  E           K        DISK
      * RSQ : MPR Estimated Purchases   Reporting Date (desc)
      *
     FPKE7CPL3IF  E           K        DISK
      * RSQ : MPR Prior Day Purchased   Reporting Date (desc)
      *
     FPKFHCPL4IF  E           K        DISK
      * RSQ : MPR Prior Day Sched Dtl   Reporting Date (desc)
      *
     FPKE6CPL3IF  E           K        DISK
      * RSQ : MPR Prior Day Slaughtered Reporting Date (desc)
      *
     FPKE4CPL2IF  E           K        DISK                      A
      * UPD : MPR Estimated Purchases   Update index for Purge
      *
     FPKE4CPL0UF  E           K        DISK
      * UPD : MPR Estimated Purchases   Update index
      *
     FPKE7CPL2IF  E           K        DISK                      A
      * UPD : MPR Prior Day Purchased   Update index for Purge
      *
     FPKE7CPL0UF  E           K        DISK
      * UPD : MPR Prior Day Purchased   Update index
      *
     FPKFHCPL3IF  E           K        DISK                      A
      * UPD : MPR Prior Day Sched Dtl   Update index for Purge
      *
     FPKFHCPL0UF  E           K        DISK
      * UPD : MPR Prior Day Sched Dtl   Update index
      *
     FPKE6CPL2IF  E           K        DISK                      A
      * UPD : MPR Prior Day Slaughtered Update index for Purge
      *
     FPKE6CPL0UF  E           K        DISK
      * UPD : MPR Prior Day Slaughtered Update index
      *
     I@E4CPNO
      * MPR Estimated Purchases   Reporting Date (desc)
      * Renamed input format fields
     I              E4HONB                          WAHONB
     I              E4ETDT                          WAETDT
     I              E4C0A1                          WAC0A1
     I              E4C1A1                          WAC1A1
     I              E4AAVN                          WAAAVN
     I              E4AADT                          WAAADT
     I              E4AMTM                          WAAMTM
     I              E4AJST                          WAAJST
     I              E4AHVN                          WAAHVN
     I              E4AGVN                          WAAGVN
     I              E4ABVN                          WAABVN
     I              E4ABDT                          WAABDT
     I              E4ABTM                          WAABTM
      *
     I@E4CPNN
      * MPR Estimated Purchases   Update index for Purge
      * Renamed input format fields
     I              E4HONB                          WBHONB
     I              E4ETDT                          WBETDT
     I              E4C0A1                          WBC0A1
     I              E4C1A1                          WBC1A1
     I              E4AAVN                          WBAAVN
     I              E4AADT                          WBAADT
     I              E4AMTM                          WBAMTM
     I              E4AJST                          WBAJST
     I              E4AHVN                          WBAHVN
     I              E4AGVN                          WBAGVN
     I              E4ABVN                          WBABVN
     I              E4ABDT                          WBABDT
     I              E4ABTM                          WBABTM
      *
     I@E4CPF6
      * MPR Estimated Purchases   Update index
      * Renamed input format fields
     I              E4HONB                          WCHONB
     I              E4ETDT                          WCETDT
     I              E4C0A1                          WCC0A1
     I              E4C1A1                          WCC1A1
     I              E4AAVN                          WCAAVN
     I              E4AADT                          WCAADT
     I              E4AMTM                          WCAMTM
     I              E4AJST                          WCAJST
     I              E4AHVN                          WCAHVN
     I              E4AGVN                          WCAGVN
     I              E4ABVN                          WCABVN
     I              E4ABDT                          WCABDT
     I              E4ABTM                          WCABTM
      *
     I@E7CPNR
      * MPR Prior Day Purchased   Reporting Date (desc)
      * Renamed input format fields
     I              E7H8CD                          WDH8CD
     I              E7ETDT                          WDETDT
     I              E7C2A1                          WDC2A1
     I              E7IBCD                          WDIBCD
     I              E7DWA1                          WDDWA1
     I              E7DXA1                          WDDXA1
     I              E7DYA1                          WDDYA1
     I              E7DZA1                          WDDZA1
     I              E7D0A1                          WDD0A1
     I              E7UZPR                          WDUZPR
     I              E7IDCD                          WDIDCD
     I              E7AAVN                          WDAAVN
     I              E7AADT                          WDAADT
     I              E7AMTM                          WDAMTM
     I              E7AJST                          WDAJST
     I              E7AHVN                          WDAHVN
     I              E7AGVN                          WDAGVN
     I              E7ABVN                          WDABVN
     I              E7ABDT                          WDABDT
     I              E7ABTM                          WDABTM
      *
     I@E7CPNS
      * MPR Prior Day Purchased   Update index for Purge
      * Renamed input format fields
     I              E7H8CD                          WEH8CD
     I              E7ETDT                          WEETDT
     I              E7C2A1                          WEC2A1
     I              E7IBCD                          WEIBCD
     I              E7DWA1                          WEDWA1
     I              E7DXA1                          WEDXA1
     I              E7DYA1                          WEDYA1
     I              E7DZA1                          WEDZA1
     I              E7D0A1                          WED0A1
     I              E7UZPR                          WEUZPR
     I              E7IDCD                          WEIDCD
     I              E7AAVN                          WEAAVN
     I              E7AADT                          WEAADT
     I              E7AMTM                          WEAMTM
     I              E7AJST                          WEAJST
     I              E7AHVN                          WEAHVN
     I              E7AGVN                          WEAGVN
     I              E7ABVN                          WEABVN
     I              E7ABDT                          WEABDT
     I              E7ABTM                          WEABTM
      *
     I@E7CPGL
      * MPR Prior Day Purchased   Update index
      * Renamed input format fields
     I              E7H8CD                          WFH8CD
     I              E7ETDT                          WFETDT
     I              E7C2A1                          WFC2A1
     I              E7IBCD                          WFIBCD
     I              E7DWA1                          WFDWA1
     I              E7DXA1                          WFDXA1
     I              E7DYA1                          WFDYA1
     I              E7DZA1                          WFDZA1
     I              E7D0A1                          WFD0A1
     I              E7UZPR                          WFUZPR
     I              E7IDCD                          WFIDCD
     I              E7AAVN                          WFAAVN
     I              E7AADT                          WFAADT
     I              E7AMTM                          WFAMTM
     I              E7AJST                          WFAJST
     I              E7AHVN                          WFAHVN
     I              E7AGVN                          WFAGVN
     I              E7ABVN                          WFABVN
     I              E7ABDT                          WFABDT
     I              E7ABTM                          WFABTM
      *
     I@FHCPNT
      * MPR Prior Day Sched Dtl   Reporting Date (desc)
      * Renamed input format fields
     I              FHH8CD                          WGH8CD
     I              FHETDT                          WGETDT
     I              FHC2A1                          WGC2A1
     I              FHCQDT                          WGCQDT
     I              FHBNNB                          WGBNNB
     I              FHBONB                          WGBONB
     I              FHABCD                          WGABCD
     I              FHAECD                          WGAECD
     I              FHBPNB                          WGBPNB
     I              FHAAVN                          WGAAVN
     I              FHAADT                          WGAADT
     I              FHAMTM                          WGAMTM
     I              FHAJST                          WGAJST
     I              FHAHVN                          WGAHVN
     I              FHAGVN                          WGAGVN
     I              FHABVN                          WGABVN
     I              FHABDT                          WGABDT
     I              FHABTM                          WGABTM
      *
     I@FHCPNU
      * MPR Prior Day Sched Dtl   Update index for Purge
      * Renamed input format fields
     I              FHH8CD                          WHH8CD
     I              FHETDT                          WHETDT
     I              FHC2A1                          WHC2A1
     I              FHCQDT                          WHCQDT
     I              FHBNNB                          WHBNNB
     I              FHBONB                          WHBONB
     I              FHABCD                          WHABCD
     I              FHAECD                          WHAECD
     I              FHBPNB                          WHBPNB
     I              FHAAVN                          WHAAVN
     I              FHAADT                          WHAADT
     I              FHAMTM                          WHAMTM
     I              FHAJST                          WHAJST
     I              FHAHVN                          WHAHVN
     I              FHAGVN                          WHAGVN
     I              FHABVN                          WHABVN
     I              FHABDT                          WHABDT
     I              FHABTM                          WHABTM
      *
     I@FHCPHM
      * MPR Prior Day Sched Dtl   Update index
      * Renamed input format fields
     I              FHH8CD                          WIH8CD
     I              FHETDT                          WIETDT
     I              FHC2A1                          WIC2A1
     I              FHCQDT                          WICQDT
     I              FHBNNB                          WIBNNB
     I              FHBONB                          WIBONB
     I              FHABCD                          WIABCD
     I              FHAECD                          WIAECD
     I              FHBPNB                          WIBPNB
     I              FHAAVN                          WIAAVN
     I              FHAADT                          WIAADT
     I              FHAMTM                          WIAMTM
     I              FHAJST                          WIAJST
     I              FHAHVN                          WIAHVN
     I              FHAGVN                          WIAGVN
     I              FHABVN                          WIABVN
     I              FHABDT                          WIABDT
     I              FHABTM                          WIABTM
      *
     I@E6CPNX
      * MPR Prior Day Slaughtered Reporting Date (desc)
      * Renamed input format fields
     I              E6H8CD                          WJH8CD
     I              E6ETDT                          WJETDT
     I              E6C2A1                          WJC2A1
     I              E6IBCD                          WJIBCD
     I              E6DOA1                          WJDOA1
     I              E6DPA1                          WJDPA1
     I              E6DQA1                          WJDQA1
     I              E6UUPR                          WJUUPR
     I              E6UVPR                          WJUVPR
     I              E6UWPR                          WJUWPR
     I              E6UXPR                          WJUXPR
     I              E6DRA1                          WJDRA1
     I              E6DSA1                          WJDSA1
     I              E6UYPR                          WJUYPR
     I              E6DTA1                          WJDTA1
     I              E6DUA1                          WJDUA1
     I              E6DVA1                          WJDVA1
     I              E6AAVN                          WJAAVN
     I              E6AADT                          WJAADT
     I              E6AMTM                          WJAMTM
     I              E6AJST                          WJAJST
     I              E6AHVN                          WJAHVN
     I              E6AGVN                          WJAGVN
     I              E6ABVN                          WJABVN
     I              E6ABDT                          WJABDT
     I              E6ABTM                          WJABTM
      *
     I@E6CPNY
      * MPR Prior Day Slaughtered Update index for Purge
      * Renamed input format fields
     I              E6H8CD                          WKH8CD
     I              E6ETDT                          WKETDT
     I              E6C2A1                          WKC2A1
     I              E6IBCD                          WKIBCD
     I              E6DOA1                          WKDOA1
     I              E6DPA1                          WKDPA1
     I              E6DQA1                          WKDQA1
     I              E6UUPR                          WKUUPR
     I              E6UVPR                          WKUVPR
     I              E6UWPR                          WKUWPR
     I              E6UXPR                          WKUXPR
     I              E6DRA1                          WKDRA1
     I              E6DSA1                          WKDSA1
     I              E6UYPR                          WKUYPR
     I              E6DTA1                          WKDTA1
     I              E6DUA1                          WKDUA1
     I              E6DVA1                          WKDVA1
     I              E6AAVN                          WKAAVN
     I              E6AADT                          WKAADT
     I              E6AMTM                          WKAMTM
     I              E6AJST                          WKAJST
     I              E6AHVN                          WKAHVN
     I              E6AGVN                          WKAGVN
     I              E6ABVN                          WKABVN
     I              E6ABDT                          WKABDT
     I              E6ABTM                          WKABTM
      *
     I@E6CPF9
      * MPR Prior Day Slaughtered Update index
      * Renamed input format fields
     I              E6H8CD                          WLH8CD
     I              E6ETDT                          WLETDT
     I              E6C2A1                          WLC2A1
     I              E6IBCD                          WLIBCD
     I              E6DOA1                          WLDOA1
     I              E6DPA1                          WLDPA1
     I              E6DQA1                          WLDQA1
     I              E6UUPR                          WLUUPR
     I              E6UVPR                          WLUVPR
     I              E6UWPR                          WLUWPR
     I              E6UXPR                          WLUXPR
     I              E6DRA1                          WLDRA1
     I              E6DSA1                          WLDSA1
     I              E6UYPR                          WLUYPR
     I              E6DTA1                          WLDTA1
     I              E6DUA1                          WLDUA1
     I              E6DVA1                          WLDVA1
     I              E6AAVN                          WLAAVN
     I              E6AADT                          WLAADT
     I              E6AMTM                          WLAMTM
     I              E6AJST                          WLAJST
     I              E6AHVN                          WLAHVN
     I              E6AGVN                          WLAGVN
     I              E6ABVN                          WLABVN
     I              E6ABDT                          WLABDT
     I              E6ABTM                          WLABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKE41    E DSPKE4CPL2
      * UPD : MPR Estimated Purchases   Update index for Purge
      * Renamed input format fields
     I              E4HONB                          WBHONB
     I              E4ETDT                          WBETDT
     I              E4C0A1                          WBC0A1
     I              E4C1A1                          WBC1A1
     I              E4AAVN                          WBAAVN
     I              E4AADT                          WBAADT
     I              E4AMTM                          WBAMTM
     I              E4AJST                          WBAJST
     I              E4AHVN                          WBAHVN
     I              E4AGVN                          WBAGVN
     I              E4ABVN                          WBABVN
     I              E4ABDT                          WBABDT
     I              E4ABTM                          WBABTM
      *
     IQPKE42    E DSPKE4CPL0
      * UPD : MPR Estimated Purchases   Update index
      * Renamed input format fields
     I              E4HONB                          WCHONB
     I              E4ETDT                          WCETDT
     I              E4C0A1                          WCC0A1
     I              E4C1A1                          WCC1A1
     I              E4AAVN                          WCAAVN
     I              E4AADT                          WCAADT
     I              E4AMTM                          WCAMTM
     I              E4AJST                          WCAJST
     I              E4AHVN                          WCAHVN
     I              E4AGVN                          WCAGVN
     I              E4ABVN                          WCABVN
     I              E4ABDT                          WCABDT
     I              E4ABTM                          WCABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKE71    E DSPKE7CPL2
      * UPD : MPR Prior Day Purchased   Update index for Purge
      * Renamed input format fields
     I              E7H8CD                          WEH8CD
     I              E7ETDT                          WEETDT
     I              E7C2A1                          WEC2A1
     I              E7IBCD                          WEIBCD
     I              E7DWA1                          WEDWA1
     I              E7DXA1                          WEDXA1
     I              E7DYA1                          WEDYA1
     I              E7DZA1                          WEDZA1
     I              E7D0A1                          WED0A1
     I              E7UZPR                          WEUZPR
     I              E7IDCD                          WEIDCD
     I              E7AAVN                          WEAAVN
     I              E7AADT                          WEAADT
     I              E7AMTM                          WEAMTM
     I              E7AJST                          WEAJST
     I              E7AHVN                          WEAHVN
     I              E7AGVN                          WEAGVN
     I              E7ABVN                          WEABVN
     I              E7ABDT                          WEABDT
     I              E7ABTM                          WEABTM
      *
     IQPKE72    E DSPKE7CPL0
      * UPD : MPR Prior Day Purchased   Update index
      * Renamed input format fields
     I              E7H8CD                          WFH8CD
     I              E7ETDT                          WFETDT
     I              E7C2A1                          WFC2A1
     I              E7IBCD                          WFIBCD
     I              E7DWA1                          WFDWA1
     I              E7DXA1                          WFDXA1
     I              E7DYA1                          WFDYA1
     I              E7DZA1                          WFDZA1
     I              E7D0A1                          WFD0A1
     I              E7UZPR                          WFUZPR
     I              E7IDCD                          WFIDCD
     I              E7AAVN                          WFAAVN
     I              E7AADT                          WFAADT
     I              E7AMTM                          WFAMTM
     I              E7AJST                          WFAJST
     I              E7AHVN                          WFAHVN
     I              E7AGVN                          WFAGVN
     I              E7ABVN                          WFABVN
     I              E7ABDT                          WFABDT
     I              E7ABTM                          WFABTM
      *
     IQPKFH1    E DSPKFHCPL3
      * UPD : MPR Prior Day Sched Dtl   Update index for Purge
      * Renamed input format fields
     I              FHH8CD                          WHH8CD
     I              FHETDT                          WHETDT
     I              FHC2A1                          WHC2A1
     I              FHCQDT                          WHCQDT
     I              FHBNNB                          WHBNNB
     I              FHBONB                          WHBONB
     I              FHABCD                          WHABCD
     I              FHAECD                          WHAECD
     I              FHBPNB                          WHBPNB
     I              FHAAVN                          WHAAVN
     I              FHAADT                          WHAADT
     I              FHAMTM                          WHAMTM
     I              FHAJST                          WHAJST
     I              FHAHVN                          WHAHVN
     I              FHAGVN                          WHAGVN
     I              FHABVN                          WHABVN
     I              FHABDT                          WHABDT
     I              FHABTM                          WHABTM
      *
     IQPKFH2    E DSPKFHCPL0
      * UPD : MPR Prior Day Sched Dtl   Update index
      * Renamed input format fields
     I              FHH8CD                          WIH8CD
     I              FHETDT                          WIETDT
     I              FHC2A1                          WIC2A1
     I              FHCQDT                          WICQDT
     I              FHBNNB                          WIBNNB
     I              FHBONB                          WIBONB
     I              FHABCD                          WIABCD
     I              FHAECD                          WIAECD
     I              FHBPNB                          WIBPNB
     I              FHAAVN                          WIAAVN
     I              FHAADT                          WIAADT
     I              FHAMTM                          WIAMTM
     I              FHAJST                          WIAJST
     I              FHAHVN                          WIAHVN
     I              FHAGVN                          WIAGVN
     I              FHABVN                          WIABVN
     I              FHABDT                          WIABDT
     I              FHABTM                          WIABTM
      *
     IQPKE61    E DSPKE6CPL2
      * UPD : MPR Prior Day Slaughtered Update index for Purge
      * Renamed input format fields
     I              E6H8CD                          WKH8CD
     I              E6ETDT                          WKETDT
     I              E6C2A1                          WKC2A1
     I              E6IBCD                          WKIBCD
     I              E6DOA1                          WKDOA1
     I              E6DPA1                          WKDPA1
     I              E6DQA1                          WKDQA1
     I              E6UUPR                          WKUUPR
     I              E6UVPR                          WKUVPR
     I              E6UWPR                          WKUWPR
     I              E6UXPR                          WKUXPR
     I              E6DRA1                          WKDRA1
     I              E6DSA1                          WKDSA1
     I              E6UYPR                          WKUYPR
     I              E6DTA1                          WKDTA1
     I              E6DUA1                          WKDUA1
     I              E6DVA1                          WKDVA1
     I              E6AAVN                          WKAAVN
     I              E6AADT                          WKAADT
     I              E6AMTM                          WKAMTM
     I              E6AJST                          WKAJST
     I              E6AHVN                          WKAHVN
     I              E6AGVN                          WKAGVN
     I              E6ABVN                          WKABVN
     I              E6ABDT                          WKABDT
     I              E6ABTM                          WKABTM
      *
     IQPKE62    E DSPKE6CPL0
      * UPD : MPR Prior Day Slaughtered Update index
      * Renamed input format fields
     I              E6H8CD                          WLH8CD
     I              E6ETDT                          WLETDT
     I              E6C2A1                          WLC2A1
     I              E6IBCD                          WLIBCD
     I              E6DOA1                          WLDOA1
     I              E6DPA1                          WLDPA1
     I              E6DQA1                          WLDQA1
     I              E6UUPR                          WLUUPR
     I              E6UVPR                          WLUVPR
     I              E6UWPR                          WLUWPR
     I              E6UXPR                          WLUXPR
     I              E6DRA1                          WLDRA1
     I              E6DSA1                          WLDSA1
     I              E6UYPR                          WLUYPR
     I              E6DTA1                          WLDTA1
     I              E6DUA1                          WLDUA1
     I              E6DVA1                          WLDVA1
     I              E6AAVN                          WLAAVN
     I              E6AADT                          WLAADT
     I              E6AMTM                          WLAMTM
     I              E6AJST                          WLAJST
     I              E6AHVN                          WLAHVN
     I              E6AGVN                          WLAGVN
     I              E6ABVN                          WLABVN
     I              E6ABDT                          WLABDT
     I              E6ABTM                          WLABTM
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Purge Date USR
     I                                    P   1   40P1EPDT
     IP2PARM      DS
      * FLD: *Arrays
      * I : RST Purge Code
     I                                        1   3 P2N7CD
      * I : RST Library
     I                                        4  13 P2LBNM
      * I : RST Purge Application Code
     I                                       14  19 P2HWCD
      * I :  File
     I                                       20  29 P2A4VN
      * I :  Logical Name
     I                                       30  39 P2A8VN
      * I :  Tape Physical File
     I                                       40  49 P2A9VN
      * I :  Field Name
     I                                       50  55 P2A7VN
      * I :  Date Format
     I                                       56  65 P2VLTX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1EPDT    PARM           WP0001  70       Purge Date USR
     C           P2N7CD    PARM           WP0002  3        Purge Code
     C           P2LBNM    PARM           WP0003 10        Library
     C           P2HWCD    PARM           WP0004  6        Purge Applicati
     C           P2A4VN    PARM           WP0005 10        File
     C           P2A8VN    PARM           WP0006 10        Logical Name
     C           P2A9VN    PARM           WP0007 10        Tape Physical F
     C           P2A7VN    PARM           WP0008  6        Field Name
     C           P2VLTX    PARM           WP0009 10        Date Format
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prg MPR Info           XF
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * ***** Purge the MPR files *****
      * RTV MPR Estmtd Purch Purg - MPR Estimated Purchases  * 
     C                     EXSR SARVGN
      * RTV Prior Day Purch Purge - MPR Prior Day Purchased  * 
     C                     EXSR SDRVGN
      * RTV MPR Prr Dy Sch Purge - MPR Prior Day Sched Dtl  * 
     C                     EXSR SGRVGN
      * RTV Prior Day Slg Purge - MPR Prior Day Slaughtered  * 
     C                     EXSR SJRVGN
      * ** the following are not being used or are seldom used   03/13/20
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV MPR Estmtd Purch Purg - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WAETDT           MPR Reporting D
      * Setup key
     C                     Z-ADDP1EPDT    WAETDT           MPR Reporting D
      * Establish starting position
     C           KPSSA     SETLL@E4CPNO                    *
     C                     READ @E4CPNO                  90*
      * Data record not found
     C   90                MOVEL'PRK0969' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** 01/23/2009 LJB FP1009 Write to Purge Library instead of QTEMP
      * ** 08/17/2007 LJB FP1009 write to QTEMP then delete from producti
      * CRT MPR Estmtd Purch Purg - MPR Estimated Purchases  * 
     C                     EXSR SBCRRC
      * Del MPR Estmtd Purch  DL - MPR Estimated Purchases  * 
     C                     EXSR SCDLRC
     C                     READ @E4CPNO                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * CRT MPR Estmtd Purch Purg - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPNN
     C                     Z-ADDWAHONB    WBHONB           CC Company Numb
     C                     Z-ADDWAETDT    WBETDT           MPR Reporting D
     C                     Z-ADDWAC0A1    WBC0A1           MPR Purchase Ty
     C                     Z-ADDWAC1A1    WBC1A1           MPR Estimated H
     C                     MOVELWAAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWAAADT    WBAADT           RS Date Changed
     C                     Z-ADDWAAMTM    WBAMTM           RS Time Changed
     C                     MOVELWAAJST    WBAJST           RS Record Statu
     C                     MOVELWAAHVN    WBAHVN           RS Job
     C                     MOVELWAAGVN    WBAGVN           RS Program
     C                     MOVELWAABVN    WBABVN           RS User Added
     C                     Z-ADDWAABDT    WBABDT           RS Date Added
     C                     Z-ADDWAABTM    WBABTM           RS Time Added
      *
     C           KLCRSB    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBETDT           MPR Reporting D
     C                     KFLD           WBC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRSB    SETLL@E4CPNN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPNN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCDLRC    BEGSR
      *================================================================
      * Del MPR Estmtd Purch  DL - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @E4CPF6
     C                     Z-ADDWAHONB    WCHONB           CC Company Numb
     C                     Z-ADDWAETDT    WCETDT           MPR Reporting D
     C                     Z-ADDWAC0A1    WCC0A1           MPR Purchase Ty
      *
     C           KLDLSC    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
     C           KLDLSC    CHAIN@E4CPF6              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE4CPL0'MDACP
     C                     MOVEL'@E4CPF6' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@E4CPF6                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Prior Day Purch Purge - MPR Prior Day Purchased  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WDETDT           MPR Reporting D
      * Setup key
     C                     Z-ADDP1EPDT    WDETDT           MPR Reporting D
      * Establish starting position
     C           KPSSD     SETLL@E7CPNR                    *
     C                     READ @E7CPNR                  90*
      * Data record not found
     C   90                MOVEL'PRK0975' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** 01/23/2009 LJB FP1009 Write to Purge Library instead of QTEMP
      * ** 08/17/2007 LJB FP1009 write to QTEMP then delete from producti
      * CRT Prior Day Purch Purge - MPR Prior Day Purchased  * 
     C                     EXSR SECRRC
      * Del Prior Day Purch   DL - MPR Prior Day Purchased  * 
     C                     EXSR SFDLRC
     C                     READ @E7CPNR                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * CRT Prior Day Purch Purge - MPR Prior Day Purchased  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E7CPNS
     C                     MOVELWDH8CD    WEH8CD           MPR Identificat
     C                     Z-ADDWDETDT    WEETDT           MPR Reporting D
     C                     Z-ADDWDC2A1    WEC2A1           MPR Reporting T
     C                     MOVELWDIBCD    WEIBCD           MPR Lot Identif
     C                     Z-ADDWDDWA1    WEDWA1           MPR Pur Ownersh
     C                     Z-ADDWDDXA1    WEDXA1           MPR Pur Class C
     C                     Z-ADDWDDYA1    WEDYA1           MPR Pur Purchas
     C                     Z-ADDWDDZA1    WEDZA1           MPR Pur Head
     C                     Z-ADDWDD0A1    WED0A1           MPR Pur Avg Liv
     C                     Z-ADDWDUZPR    WEUZPR           MPR Pur Base Pr
     C                     MOVELWDIDCD    WEIDCD           MPR Origin
     C                     MOVELWDAAVN    WEAAVN           RS User Changed
     C                     Z-ADDWDAADT    WEAADT           RS Date Changed
     C                     Z-ADDWDAMTM    WEAMTM           RS Time Changed
     C                     MOVELWDAJST    WEAJST           RS Record Statu
     C                     MOVELWDAHVN    WEAHVN           RS Job
     C                     MOVELWDAGVN    WEAGVN           RS Program
     C                     MOVELWDABVN    WEABVN           RS User Added
     C                     Z-ADDWDABDT    WEABDT           RS Date Added
     C                     Z-ADDWDABTM    WEABTM           RS Time Added
      *
     C           KLCRSE    KLIST
     C                     KFLD           WEH8CD           MPR Identificat
     C                     KFLD           WEETDT           MPR Reporting D
     C                     KFLD           WEC2A1           MPR Reporting T
     C                     KFLD           WEIBCD           MPR Lot Identif
      * Check for duplicate primary key
     C           KLCRSE    SETLL@E7CPNS                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0976' W0RTN   7
      * Send message 'MPR Prior Day Purchase EX'
     C                     MOVEL'PRK0976' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@E7CPNS                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * Del Prior Day Purch   DL - MPR Prior Day Purchased  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @E7CPGL
     C                     MOVELWDH8CD    WFH8CD           MPR Identificat
     C                     Z-ADDWDETDT    WFETDT           MPR Reporting D
     C                     Z-ADDWDC2A1    WFC2A1           MPR Reporting T
     C                     MOVELWDIBCD    WFIBCD           MPR Lot Identif
      *
     C           KLDLSF    KLIST
     C                     KFLD           WFH8CD           MPR Identificat
     C                     KFLD           WFETDT           MPR Reporting D
     C                     KFLD           WFC2A1           MPR Reporting T
     C                     KFLD           WFIBCD           MPR Lot Identif
     C           KLDLSF    CHAIN@E7CPGL              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE7CPL0'MDACP
     C                     MOVEL'@E7CPGL' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@E7CPGL                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV MPR Prr Dy Sch Purge - MPR Prior Day Sched Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WGETDT           MPR Reporting D
      * Setup key
     C                     Z-ADDP1EPDT    WGETDT           MPR Reporting D
      * Establish starting position
     C           KPSSG     SETLL@FHCPNT                    *
     C                     READ @FHCPNT                  90*
      * Data record not found
     C   90                MOVEL'PRK1008' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** 01/23/2009 LJB FP1009 Write to Purge Library instead of QTEMP
      * ** 08/17/2007 LJB FP1009 write to QTEMP then delete from producti
      * CRT MPR Prr Dy Sch Purge - MPR Prior Day Sched Dtl  * 
     C                     EXSR SHCRRC
      * Delete MPR Prior Day Sche - MPR Prior Day Sched Dtl  * 
     C                     EXSR SIDLRC
     C                     READ @FHCPNT                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * CRT MPR Prr Dy Sch Purge - MPR Prior Day Sched Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FHCPNU
     C                     MOVELWGH8CD    WHH8CD           MPR Identificat
     C                     Z-ADDWGETDT    WHETDT           MPR Reporting D
     C                     Z-ADDWGC2A1    WHC2A1           MPR Reporting T
     C                     Z-ADDWGCQDT    WHCQDT           BOL Kill Date
     C                     Z-ADDWGBNNB    WHBNNB           BOH Buy Order N
     C                     Z-ADDWGBONB    WHBONB           BOL Load Number
     C                     MOVELWGABCD    WHABCD           PD Producer Cod
     C                     MOVELWGAECD    WHAECD           PL Location Cod
     C                     Z-ADDWGBPNB    WHBPNB           BOL Pln Head De
     C                     MOVELWGAAVN    WHAAVN           RS User Changed
     C                     Z-ADDWGAADT    WHAADT           RS Date Changed
     C                     Z-ADDWGAMTM    WHAMTM           RS Time Changed
     C                     MOVELWGAJST    WHAJST           RS Record Statu
     C                     MOVELWGAHVN    WHAHVN           RS Job
     C                     MOVELWGAGVN    WHAGVN           RS Program
     C                     MOVELWGABVN    WHABVN           RS User Added
     C                     Z-ADDWGABDT    WHABDT           RS Date Added
     C                     Z-ADDWGABTM    WHABTM           RS Time Added
      *
     C           KLCRSH    KLIST
     C                     KFLD           WHH8CD           MPR Identificat
     C                     KFLD           WHETDT           MPR Reporting D
     C                     KFLD           WHC2A1           MPR Reporting T
     C                     KFLD           WHCQDT           BOL Kill Date
     C                     KFLD           WHBNNB           BOH Buy Order N
     C                     KFLD           WHBONB           BOL Load Number
     C                     KFLD           WHABCD           PD Producer Cod
     C                     KFLD           WHAECD           PL Location Cod
      * Check for duplicate primary key
     C           KLCRSH    SETLL@FHCPNU                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1009' W0RTN   7
      * Send message 'MPR Prior Day Sched Dt EX'
     C                     MOVEL'PRK1009' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@FHCPNU                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIDLRC    BEGSR
      *================================================================
      * Delete MPR Prior Day Sche - MPR Prior Day Sched Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FHCPHM
     C                     MOVELWGH8CD    WIH8CD           MPR Identificat
     C                     Z-ADDWGETDT    WIETDT           MPR Reporting D
     C                     Z-ADDWGC2A1    WIC2A1           MPR Reporting T
     C                     Z-ADDWGCQDT    WICQDT           BOL Kill Date
     C                     Z-ADDWGBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWGBONB    WIBONB           BOL Load Number
     C                     MOVELWGABCD    WIABCD           PD Producer Cod
     C                     MOVELWGAECD    WIAECD           PL Location Cod
      *
     C           KLDLSI    KLIST
     C                     KFLD           WIH8CD           MPR Identificat
     C                     KFLD           WIETDT           MPR Reporting D
     C                     KFLD           WIC2A1           MPR Reporting T
     C                     KFLD           WICQDT           BOL Kill Date
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WIABCD           PD Producer Cod
     C                     KFLD           WIAECD           PL Location Cod
     C           KLDLSI    CHAIN@FHCPHM              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFHCPL0'MDACP
     C                     MOVEL'@FHCPHM' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FHCPHM                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Prior Day Slg Purge - MPR Prior Day Slaughtered  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WJETDT           MPR Reporting D
      * Setup key
     C                     Z-ADDP1EPDT    WJETDT           MPR Reporting D
      * Establish starting position
     C           KPSSJ     SETLL@E6CPNX                    *
     C                     READ @E6CPNX                  90*
      * Data record not found
     C   90                MOVEL'PRK0973' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** 01/23/2009 LJB FP1009 Write to Purge Library instead of QTEMP
      * ** 08/17/2007 LJB FP1009 write to QTEMP then delete from producti
      * CRT Prior Day Slg Purge - MPR Prior Day Slaughtered  * 
     C                     EXSR SKCRRC
      * Del Prior Day Slg     DL - MPR Prior Day Slaughtered  * 
     C                     EXSR SLDLRC
     C                     READ @E6CPNX                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * CRT Prior Day Slg Purge - MPR Prior Day Slaughtered  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E6CPNY
     C                     MOVELWJH8CD    WKH8CD           MPR Identificat
     C                     Z-ADDWJETDT    WKETDT           MPR Reporting D
     C                     Z-ADDWJC2A1    WKC2A1           MPR Reporting T
     C                     MOVELWJIBCD    WKIBCD           MPR Lot Identif
     C                     Z-ADDWJDOA1    WKDOA1           MPR Slg Class C
     C                     Z-ADDWJDPA1    WKDPA1           MPR Slg Purchas
     C                     Z-ADDWJDQA1    WKDQA1           MPR Slg Head
     C                     Z-ADDWJUUPR    WKUUPR           MPR Slg Base Pr
     C                     Z-ADDWJUVPR    WKUVPR           MPR Slg Avg Net
     C                     Z-ADDWJUWPR    WKUWPR           MPR Slg Low Net
     C                     Z-ADDWJUXPR    WKUXPR           MPR Slg High Ne
     C                     Z-ADDWJDRA1    WKDRA1           MPR Slg Avg Liv
     C                     Z-ADDWJDSA1    WKDSA1           MPR Slg Avg Car
     C                     Z-ADDWJUYPR    WKUYPR           MPR Slg Avg Sor
     C                     Z-ADDWJDTA1    WKDTA1           MPR Slg Avg Bac
     C                     Z-ADDWJDUA1    WKDUA1           MPR Slg Avg Loi
     C                     Z-ADDWJDVA1    WKDVA1           MPR Slg Avg Lea
     C                     MOVELWJAAVN    WKAAVN           RS User Changed
     C                     Z-ADDWJAADT    WKAADT           RS Date Changed
     C                     Z-ADDWJAMTM    WKAMTM           RS Time Changed
     C                     MOVELWJAJST    WKAJST           RS Record Statu
     C                     MOVELWJAHVN    WKAHVN           RS Job
     C                     MOVELWJAGVN    WKAGVN           RS Program
     C                     MOVELWJABVN    WKABVN           RS User Added
     C                     Z-ADDWJABDT    WKABDT           RS Date Added
     C                     Z-ADDWJABTM    WKABTM           RS Time Added
      *
     C           KLCRSK    KLIST
     C                     KFLD           WKH8CD           MPR Identificat
     C                     KFLD           WKETDT           MPR Reporting D
     C                     KFLD           WKC2A1           MPR Reporting T
     C                     KFLD           WKIBCD           MPR Lot Identif
      * Check for duplicate primary key
     C           KLCRSK    SETLL@E6CPNY                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0974' W0RTN   7
      * Send message 'MPR Prior Day Slaughte EX'
     C                     MOVEL'PRK0974' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@E6CPNY                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLDLRC    BEGSR
      *================================================================
      * Del Prior Day Slg     DL - MPR Prior Day Slaughtered  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @E6CPF9
     C                     MOVELWJH8CD    WLH8CD           MPR Identificat
     C                     Z-ADDWJETDT    WLETDT           MPR Reporting D
     C                     Z-ADDWJC2A1    WLC2A1           MPR Reporting T
     C                     MOVELWJIBCD    WLIBCD           MPR Lot Identif
      *
     C           KLDLSL    KLIST
     C                     KFLD           WLH8CD           MPR Identificat
     C                     KFLD           WLETDT           MPR Reporting D
     C                     KFLD           WLC2A1           MPR Reporting T
     C                     KFLD           WLIBCD           MPR Lot Identif
     C           KLDLSL    CHAIN@E6CPF9              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE6CPL0'MDACP
     C                     MOVEL'@E6CPF9' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@E6CPF9                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 11/05/2020 ISE H16853 - Recompiled due to change in Buy Order
      * ** 09/23/2016 RMC R7307 Recompile for purch type increase to 2,0
      * ** 03/13/2009 LJB FP1009 Skip: PKE9CPP, PKE8CPP, PKFACPP, PKD5CPP
      * **   they are either not used or seldom used
      * ** 01/23/2009 LJB FP1009 Write to Purge Library instead of QTEMP
      * ** -*- -*- -*- -*- -*- -*- -*- -* -*- -*- -*- -*- -*- -*- -*- -*-
      * ** Purge date is passed in. Records prior to the purge date are
      * ** written to a file in QTEMP then deleted.  The QTEMP file
      * ** is copied to the "Z" member of the Purge Tape Physical file.
      * ** That member will be saved to tape.
      * ** -*- -*- -*- -*- -*- -*- -*- -* -*- -*- -*- -*- -*- -*- -*- -*-
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WAETDT           MPR Reporting D
     C                     Z-ADD*ZERO     WAC0A1           MPR Purchase Ty
     C                     Z-ADD*ZERO     WAC1A1           MPR Estimated H
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDETDT           MPR Reporting D
     C                     Z-ADD*ZERO     WDC2A1           MPR Reporting T
     C                     Z-ADD*ZERO     WDDWA1           MPR Pur Ownersh
     C                     Z-ADD*ZERO     WDDXA1           MPR Pur Class C
     C                     Z-ADD*ZERO     WDDYA1           MPR Pur Purchas
     C                     Z-ADD*ZERO     WDDZA1           MPR Pur Head
     C                     Z-ADD*ZERO     WDD0A1           MPR Pur Avg Liv
     C                     Z-ADD*ZERO     WDUZPR           MPR Pur Base Pr
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGETDT           MPR Reporting D
     C                     Z-ADD*ZERO     WGC2A1           MPR Reporting T
     C                     Z-ADD*ZERO     WGCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJETDT           MPR Reporting D
     C                     Z-ADD*ZERO     WJC2A1           MPR Reporting T
     C                     Z-ADD*ZERO     WJDOA1           MPR Slg Class C
     C                     Z-ADD*ZERO     WJDPA1           MPR Slg Purchas
     C                     Z-ADD*ZERO     WJDQA1           MPR Slg Head
     C                     Z-ADD*ZERO     WJUUPR           MPR Slg Base Pr
     C                     Z-ADD*ZERO     WJUVPR           MPR Slg Avg Net
     C                     Z-ADD*ZERO     WJUWPR           MPR Slg Low Net
     C                     Z-ADD*ZERO     WJUXPR           MPR Slg High Ne
     C                     Z-ADD*ZERO     WJDRA1           MPR Slg Avg Liv
     C                     Z-ADD*ZERO     WJDSA1           MPR Slg Avg Car
     C                     Z-ADD*ZERO     WJUYPR           MPR Slg Avg Sor
     C                     Z-ADD*ZERO     WJDTA1           MPR Slg Avg Bac
     C                     Z-ADD*ZERO     WJDUA1           MPR Slg Avg Loi
     C                     Z-ADD*ZERO     WJDVA1           MPR Slg Avg Lea
     C                     Z-ADD*ZERO     WJAADT           RS Date Changed
     C                     Z-ADD*ZERO     WJAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WJABDT           RS Date Added
     C                     Z-ADD*ZERO     WJABTM           RS Time Added
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
