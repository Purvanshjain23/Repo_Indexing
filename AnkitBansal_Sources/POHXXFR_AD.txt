// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for POHXXFR
// ?Date: 14.08.2025 Time: 03:37:20
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Documentation / Change Log
DO;

//?5/17/04 RMC PKTR01 - ignore Co logic in this pgm
//?If no co no is passed in, this gets the default co for user &
//?    sets a flag
//?If no load id is passed in, this gets the 1st load for the co &
//?    sets a flag
//?If flag 2 is set *YES, this tells the edit program to clear out the load
//?    ID on the screen.  This is done to avoid the key screen
ENDDO;

// Call program EXC Rtv Status        XF.
CALL PROGRAM(EXC Rtv Status        XF) ('PBXNXFR');
PARAMETER(PAR.Company_Number);
PARAMETER('TMSLDP');
PARAMETER(LCL.Live_with_TPM);

//?Set flag based on whether a load ID was passed in
CASE;

// IF PAR.Company Number EQ WRK.ZERO
IF PAR.Company_Number = WRK.ZERO;

// OR PAR.Load ID EQ WRK.ZERO
OR PAR.Load_ID = WRK.ZERO;

// PAR.Flag 2 = CND.*YES
PAR.Flag_2 = *YES;

//?Set flag based on whether a load ID was passed in
// IF *OTHERWISE
IF *OTHERWISE;

// PAR.Flag 2 = CND.*NO
PAR.Flag_2 = *NO;

ENDIF;

//?If no company passed in, get default company
CASE;

// IF PAR.Company Number EQ WRK.ZERO
IF PAR.Company_Number = WRK.ZERO;

ENDIF;

//?Get first load for company, if none passed in
CASE;

// IF PAR.Load ID EQ WRK.ZERO
IF PAR.Load_ID = WRK.ZERO;

EXECUTE FUNCTION(RTV First Load for Co  RT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC1491269;
PARAMETER(PAR.Load_ID);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 QUIT;

}


ENDIF;

//?save load id to pass back out
// LCL.Load Id 1 = PAR.Load ID
LCL.Load_Id_1 = PAR.Load_ID;

//?Get MG Created load sts  if load passed in
CASE;

// IF PAR.Load ID is Entered
IF PAR.Load_ID <> *ZERO;

// LCL.MG Created Load = CND.Not MG Created Load
LCL.MG_Created_Load = *BLANK;

EXECUTE FUNCTION(RTV MG Created Load   RT) TYPE(RTVOBJ) FILE(OMFJCPP)           AC2124762;
PARAMETER(PAR.Load_ID);
PARAMETER(LCL.MG_Created_Load);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 QUIT;

}


ENDIF;

// PAR.USR Exit Program = CND.no
PAR.USR_Exit_Program = 'N';

// DOW PAR.USR Exit Program is no
DOW PAR.USR_Exit_Program = 'N';

CASE;

// IF LCL.Live with TPM is Yes
IF LCL.Live_with_TPM = 'Y';

// AND LCL.MG Created Load is Yes
AND LCL.MG_Created_Load = 'Y';

// Call program Dsp Cst Srv/TraceClerkDF.
CALL PROGRAM(Dsp Cst Srv/TraceClerkDF) ('PBXSDFR');
PARAMETER(PAR.Load_ID);
PARAMETER(PAR.USR_Exit_Program);

// IF *OTHERWISE
IF *OTHERWISE;

// Call program EDT Cst Srv/TraceClerk EF.
CALL PROGRAM(EDT Cst Srv/TraceClerk EF) ('PDTOEFR');
PARAMETER(PAR.Load_ID);
PARAMETER(PAR.USR_Exit_Program);

ENDIF;

ENDDO;

// PAR.Load ID = LCL.Load Id 1
PAR.Load_ID = LCL.Load_Id_1;

