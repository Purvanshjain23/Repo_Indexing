// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKQ5XFR
// ?Date: 14.08.2025 Time: 02:51:27
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Calculate freight based on the unit of measure
// PAR.BOL Freight Amt = CND.Zeros
PAR.BOL_Freight_Amt = *ZERO;

//?Miles = zeros
EXECUTE FUNCTION(Clc UOM Extension     IF) TYPE(EXCINTFUN)                      AB1143053;
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(PAR.BOL_Head_Received);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(PAR.BOL_Live_Wgt_Received);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(PAR.BOL_Freight_UOM);
PARAMETER(PAR.BOL_Freight_Unit_Amt);
PARAMETER(PAR.BOL_Freight_Amt);
PARAMETER(*BLANK);
PARAMETER(*ZERO);
{
 //?Execute internal function

 //?Extension
 CASE;

 // IF PAR.Trans UOM USR is Flat
 IF PAR.Trans_UOM_USR = 'FL';

 //?* * * * *   FLAT    * * * * *
 //?FLAT
 CASE;

 // IF PAR.Trans UOM USR is Flat
 IF PAR.Trans_UOM_USR = 'FL';

 // PAR.Trans Extended Amt Usr = PAR.Trans Unit Amt Usr * CON.1 *Rounded
 PAR.Trans_Extended_Amt_Usr = PAR.Trans_Unit_Amt_Usr * 1 'H';

 ENDIF;

 //?Extension
 // IF PAR.Trans UOM USR is Head UOM
 IF PAR.Trans_UOM_USR = 'DH'/'RH'/'YH'/'CH'/'KH'/'NH'/'DY'/'RX'/'HM'/'DE';

 //?* * * * *    HEAD   * * * * *
 //?HEAD
 CASE;

 // IF PAR.Trans UOM USR is Received Head
 IF PAR.Trans_UOM_USR = 'RH';

 // PAR.Trans Extended Amt Usr = PAR.TH Head Received * PAR.Trans Unit Amt Usr *Roun
 PAR.Trans_Extended_Amt_Usr = PAR.TH_Head_Received * PAR.Trans_Unit_Amt_Usr 'H';

 //?HEAD
 // IF PAR.Trans UOM USR is Received Hd less Yard Dd
 IF PAR.Trans_UOM_USR = 'RX';

 // WRK.Net Head Usr = PAR.TH Head Received - PAR.TH Yard Deads
 WRK.Net_Head_Usr = PAR.TH_Head_Received - PAR.TH_Yard_Deads;

 // PAR.Trans Extended Amt Usr = WRK.Net Head Usr * PAR.Trans Unit Amt Usr *Rounded
 PAR.Trans_Extended_Amt_Usr = WRK.Net_Head_Usr * PAR.Trans_Unit_Amt_Usr 'H';

 //?HEAD
 // IF PAR.Trans UOM USR is Killed Head
 IF PAR.Trans_UOM_USR = 'KH';

 // PAR.Trans Extended Amt Usr = PAR.TH Head Killed * PAR.Trans Unit Amt Usr *Rounde
 PAR.Trans_Extended_Amt_Usr = PAR.TH_Head_Killed * PAR.Trans_Unit_Amt_Usr 'H';

 //?HEAD
 // IF PAR.Trans UOM USR is Condemned Head
 IF PAR.Trans_UOM_USR = 'CH';

 // PAR.Trans Extended Amt Usr = PAR.TH Head Condemned * PAR.Trans Unit Amt Usr *Rou
 PAR.Trans_Extended_Amt_Usr = PAR.TH_Head_Condemned * PAR.Trans_Unit_Amt_Usr 'H';

 //?HEAD
 // IF PAR.Trans UOM USR is Yard Deads Head
 IF PAR.Trans_UOM_USR = 'YH';

 // PAR.Trans Extended Amt Usr = PAR.TH Yard Deads * PAR.Trans Unit Amt Usr *Rounded
 PAR.Trans_Extended_Amt_Usr = PAR.TH_Yard_Deads * PAR.Trans_Unit_Amt_Usr 'H';

 //?HEAD
 // IF PAR.Trans UOM USR is DOA Head
 IF PAR.Trans_UOM_USR = 'DH';

 // PAR.Trans Extended Amt Usr = PAR.TH Dead On Arrival * PAR.Trans Unit Amt Usr *Ro
 PAR.Trans_Extended_Amt_Usr = PAR.TH_Dead_On_Arrival * PAR.Trans_Unit_Amt_Usr 'H';

 //?HEAD
 // IF PAR.Trans UOM USR is Net Head
 IF PAR.Trans_UOM_USR = 'NH';

 // WRK.Net Head Usr = PAR.TH Head Received
 WRK.Net_Head_Usr = PAR.TH_Head_Received;

 // WRK.Net Head Usr = WRK.Net Head Usr - PAR.TH Yard Deads
 WRK.Net_Head_Usr = WRK.Net_Head_Usr - PAR.TH_Yard_Deads;

 // WRK.Net Head Usr = WRK.Net Head Usr - PAR.TH Head Condemned
 WRK.Net_Head_Usr = WRK.Net_Head_Usr - PAR.TH_Head_Condemned;

 // PAR.Trans Extended Amt Usr = WRK.Net Head Usr * PAR.Trans Unit Amt Usr *Rounded
 PAR.Trans_Extended_Amt_Usr = WRK.Net_Head_Usr * PAR.Trans_Unit_Amt_Usr 'H';

 //?HEAD
 // IF PAR.Trans UOM USR is DOA Head + Yard Dead Head
 IF PAR.Trans_UOM_USR = 'DY';

 // WRK.Net Head Usr = PAR.TH Dead On Arrival + PAR.TH Yard Deads
 WRK.Net_Head_Usr = PAR.TH_Dead_On_Arrival + PAR.TH_Yard_Deads;

 // PAR.Trans Extended Amt Usr = WRK.Net Head Usr * PAR.Trans Unit Amt Usr *Rounded
 PAR.Trans_Extended_Amt_Usr = WRK.Net_Head_Usr * PAR.Trans_Unit_Amt_Usr 'H';

 //?HEAD
 // IF PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
 IF PAR.Trans_UOM_USR = 'DE';

 // WRK.Net Head Usr = PAR.TH Dead On Arrival + PAR.TH Yard Deads
 WRK.Net_Head_Usr = PAR.TH_Dead_On_Arrival + PAR.TH_Yard_Deads;

 // WRK.Net Head Usr = WRK.Net Head Usr + PAR.TH Head EUT/KOA
 WRK.Net_Head_Usr = WRK.Net_Head_Usr + PAR.TH_Head_EUT_KOA;

 // PAR.Trans Extended Amt Usr = WRK.Net Head Usr * PAR.Trans Unit Amt Usr *Rounded
 PAR.Trans_Extended_Amt_Usr = WRK.Net_Head_Usr * PAR.Trans_Unit_Amt_Usr 'H';

 //?HEAD
 // IF PAR.Trans UOM USR is Received Head /100 Miles
 IF PAR.Trans_UOM_USR = 'HM';

 // PAR.Trans Extended Amt Usr =       *
 PAR.Trans_Extended_Amt_Usr = ( PAR.PSM_Miles_to_Company * PAR.TH_Head_Killed 'H' ) * (
 PAR.Trans_Unit_Amt_Usr / 100 'H' ) 'H';

 ENDIF;

 //?Extension
 // IF PAR.Trans UOM USR is Weight UOM
 IF PAR.Trans_UOM_USR = 'CW'/'LW'/'NL'/'SW'/'LX'/'SX';

 //?* * * * *    WEIGHT   * * * * *
 //?WEIGHT
 CASE;

 // IF PAR.Trans UOM USR is Live Hundred Weight
 IF PAR.Trans_UOM_USR = 'LW';

 // Live hundred wgt
 PAR.Trans_Extended_Amt_Usr = ( PAR.TH_Live_Wgt / 100 'H' ) * PAR.Trans_Unit_Amt_Usr 'H';

 //?WEIGHT
 // IF PAR.Trans UOM USR is LW less Yard Dead Wgt
 IF PAR.Trans_UOM_USR = 'LX';

 //? Calc wgt of yard dead based on Th avg live wgt
 // WRK.Yard dead weight      USR = PAR.TH Avg Live Wgt * PAR.TH Yard Deads *
 WRK.Yard_dead_weight_USR = PAR.TH_Avg_Live_Wgt * PAR.TH_Yard_Deads;

 //?  Subtract Yard Dead wgt from Live Wgt
 // WRK.Live Weight           USR = PAR.TH Live Wgt - WRK.Yard dead weight      USR
 WRK.Live_Weight_USR = PAR.TH_Live_Wgt - WRK.Yard_dead_weight_USR;

 // Live hundred wgt less Yd
 PAR.Trans_Extended_Amt_Usr = ( WRK.Live_Weight_USR / 100 'H' ) * PAR.Trans_Unit_Amt_Usr
 'H';

 //?WEIGHT
 // IF PAR.Trans UOM USR is Carcass Hundred Weight
 IF PAR.Trans_UOM_USR = 'CW';

 // Carcass Hundred Wgt
 PAR.Trans_Extended_Amt_Usr = ( PAR.TH_Hot_Wgt / 100 'H' ) * PAR.Trans_Unit_Amt_Usr 'H';

 //?WEIGHT
 // IF PAR.Trans UOM USR is Net Live Weight
 IF PAR.Trans_UOM_USR = 'NL';

 // WRK.Net Head Usr = PAR.TH Head Received
 WRK.Net_Head_Usr = PAR.TH_Head_Received;

 // WRK.Net Head Usr = WRK.Net Head Usr - PAR.TH Yard Deads
 WRK.Net_Head_Usr = WRK.Net_Head_Usr - PAR.TH_Yard_Deads;

 // WRK.Net Head Usr = WRK.Net Head Usr - PAR.TH Head Condemned
 WRK.Net_Head_Usr = WRK.Net_Head_Usr - PAR.TH_Head_Condemned;

 //?* Insert avg live weight
 // WRK.Net Live Weight Usr = WRK.Net Head Usr * PAR.TH Avg Live Wgt *
 WRK.Net_Live_Weight_Usr = WRK.Net_Head_Usr * PAR.TH_Avg_Live_Wgt;

 // Net Live Weight
 PAR.Trans_Extended_Amt_Usr = ( WRK.Net_Live_Weight_Usr / 100 'H' )
 * PAR.Trans_Unit_Amt_Usr 'H';

 //?WEIGHT
 // IF PAR.Trans UOM USR is Shipped Weight - Doa's
 IF PAR.Trans_UOM_USR = 'SW';

 //?  Calc Avg shipped wgt, then calc wgt of DOA'S
 //?This rule was defined on 01/14/97
 //?The Calculations for Avg Shipped Weights are
 //?Head Received should be the live hogs that walk across the scale
 //?Doa's should be the hogs that died either after we collected
 //?      or before we weighed them
 //?Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
 // WRK.Hd Cnt Org Ship Usr = PAR.TH Head Received + PAR.TH Dead On Arrival
 WRK.Hd_Cnt_Org_Ship_Usr = PAR.TH_Head_Received + PAR.TH_Dead_On_Arrival;

 CASE;

 // IF WRK.Hd Cnt Org Ship Usr is *Zeros
 IF WRK.Hd_Cnt_Org_Ship_Usr = *ZERO;

 // WRK.Avg Weight USR = CON.*ZERO
 WRK.Avg_Weight_USR = *ZERO;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // WRK.Avg Weight USR = PAR.TH Shipped Weight / WRK.Hd Cnt Org Ship Usr *
 WRK.Avg_Weight_USR = PAR.TH_Shipped_Weight / WRK.Hd_Cnt_Org_Ship_Usr;

 ENDIF;

 // WRK.Doa's Avg Weight Usr = WRK.Avg Weight USR * PAR.TH Dead On Arrival *
 WRK.Doa_s_Avg_Weight_Usr = WRK.Avg_Weight_USR * PAR.TH_Dead_On_Arrival;

 //?  Subtract doa's from Shipped Wgt
 // WRK.Ship Wgt Tot Usr = PAR.TH Shipped Weight - WRK.Doa's Avg Weight Usr
 WRK.Ship_Wgt_Tot_Usr = PAR.TH_Shipped_Weight - WRK.Doa_s_Avg_Weight_Usr;

 // Shipped Weight Total Ext
 PAR.Trans_Extended_Amt_Usr = ( WRK.Ship_Wgt_Tot_Usr / 100 'H' ) * PAR.Trans_Unit_Amt_Usr
 'H';

 //?WEIGHT
 // IF PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
 IF PAR.Trans_UOM_USR = 'SX';

 //?  Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
 //?This rule was defined on 01/14/97
 //?The Calculations for Avg Shipped Weights are
 //?Head Received should be the live hogs that walk across the scale
 //?Doa's should be the hogs that died either after we collected
 //?      or before we weighed them
 //?Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
 // WRK.Hd Cnt Org Ship Usr = PAR.TH Head Received + PAR.TH Dead On Arrival
 WRK.Hd_Cnt_Org_Ship_Usr = PAR.TH_Head_Received + PAR.TH_Dead_On_Arrival;

 CASE;

 // IF WRK.Hd Cnt Org Ship Usr is *Zeros
 IF WRK.Hd_Cnt_Org_Ship_Usr = *ZERO;

 // WRK.Avg Weight USR = CON.*ZERO
 WRK.Avg_Weight_USR = *ZERO;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // WRK.Avg Weight USR = PAR.TH Shipped Weight / WRK.Hd Cnt Org Ship Usr *
 WRK.Avg_Weight_USR = PAR.TH_Shipped_Weight / WRK.Hd_Cnt_Org_Ship_Usr;

 ENDIF;

 // WRK.Yard dead weight      USR = WRK.Avg Weight USR * PAR.TH Yard Deads *
 WRK.Yard_dead_weight_USR = WRK.Avg_Weight_USR * PAR.TH_Yard_Deads;

 // WRK.Doa's Avg Weight Usr = WRK.Avg Weight USR * PAR.TH Dead On Arrival *
 WRK.Doa_s_Avg_Weight_Usr = WRK.Avg_Weight_USR * PAR.TH_Dead_On_Arrival;

 //?  Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
 // WRK.Ship Wgt Tot Usr = PAR.TH Shipped Weight - WRK.Doa's Avg Weight Usr
 WRK.Ship_Wgt_Tot_Usr = PAR.TH_Shipped_Weight - WRK.Doa_s_Avg_Weight_Usr;

 // WRK.Ship Wgt Tot Usr = WRK.Ship Wgt Tot Usr - WRK.Yard dead weight      USR
 WRK.Ship_Wgt_Tot_Usr = WRK.Ship_Wgt_Tot_Usr - WRK.Yard_dead_weight_USR;

 // Shipped wgt less Yd
 PAR.Trans_Extended_Amt_Usr = ( WRK.Ship_Wgt_Tot_Usr / 100 'H' ) * PAR.Trans_Unit_Amt_Usr
 'H';

 ENDIF;

 //?Extension
 // IF PAR.Trans UOM USR is Value UOM
 IF PAR.Trans_UOM_USR = 'GV'/'BD';

 //?* * * * *    VALUE    * * * * *
 //?VALUE
 CASE;

 // IF PAR.Trans UOM USR is Gross Hundred Value
 IF PAR.Trans_UOM_USR = 'GV';

 // Gross Hundred Value
 PAR.Trans_Extended_Amt_Usr = ( PAR.TH_Payment_Gross / 100 'H' ) * PAR.Trans_Unit_Amt_Usr
 'H';

 //?VALUE
 // IF PAR.Trans UOM USR is Carcass Hundred Weight
 IF PAR.Trans_UOM_USR = 'CW';

 // Carcass Hundred Value
 PAR.Trans_Extended_Amt_Usr = ( PAR.TH_Hot_Wgt / 100 'H' ) * PAR.Trans_Unit_Amt_Usr 'H';

 //?VALUE
 // IF PAR.Trans UOM USR is Base Market Dollars
 IF PAR.Trans_UOM_USR = 'BD';

 // Call program Clc Base Mkt Dollars  XF.
 CALL PROGRAM(Clc Base Mkt Dollars  XF) ('PKBSE01');
 PARAMETER(PAR.BOH_Company_Number);
 PARAMETER(PAR.TH_Purchase_Date);
 PARAMETER(PAR.TH_Live_Wgt);
 PARAMETER(PAR.DED_D_A_Code);
 PARAMETER(WRK.Base_Mkt_Prc_Amt_Tot_USR);

 CASE;

 // IF WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
 IF WRK.Base_Mkt_Prc_Amt_Tot_USR >= WRK.Zero_USR;

 // Base Market Dollars
 PAR.Trans_Extended_Amt_Usr = ( WRK.Base_Mkt_Prc_Amt_Tot_USR / 100 'H' )
 * PAR.Trans_Unit_Amt_Usr 'H';

 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.Trans Extended Amt Usr = CON.*ZERO
 PAR.Trans_Extended_Amt_Usr = *ZERO;

 ENDIF;

 ENDIF;

 //?Extension
 // IF PAR.Trans UOM USR is Percent UOM
 IF PAR.Trans_UOM_USR = *BLANK;

 //?* * * * *    PERCENT   * * * * *
 //?PERCENT
 CASE;

 // IF PAR.Trans UOM USR is Percent of Gross Value
 IF PAR.Trans_UOM_USR = *BLANK;

 // Percent of Gross Value
 PAR.Trans_Extended_Amt_Usr = ( PAR.Trans_Unit_Amt_Usr / 100 'H' ) * PAR.TH_Payment_Gross
 'H';

 ENDIF;

 ENDIF;

}


