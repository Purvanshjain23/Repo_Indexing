     H/TITLE Exc Prc From F0901    XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : E1IDEVMDL
     H* System        : E1IDEVMDL
     H* User name     : ISRCENT
     H* Date          : 04/27/20  Time  : 10:52:31
     H* Copyright     : E1IDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FEZ0901L2  IF   E           K DISK
      * RSQ : Account Master     F0901Z Sel Unprocessed
      *
     FE10901L1  IF   E           K DISK
      * RTV : Account Master     F0901  Rtv-Company/Account ID
      *
     FE10901L0  UF A E           K DISK
      * UPD : Account Master     F0901  Upd-Company/Account ID
      *
     FEZ0901L0  UF   E           K DISK
      * UPD : Account Master     F0901Z Update index
      *
      * Long constants
     D @CN#            S              6    DIM(01)CTDATA PERRCD(1)
     D @CN             S             25    DIM(01) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QE1091        E DS                  EXTNAME(E10901L0)
      * UPD : Account Master     F0901  Upd-Company/Account ID
      * Renamed input format fields
     D  WCCO         E                     EXTFLD(GMCO)
     D  WCAID        E                     EXTFLD(GMAID)
     D  WCMCU        E                     EXTFLD(GMMCU)
     D  WCOBJ        E                     EXTFLD(GMOBJ)
     D  WCSUB        E                     EXTFLD(GMSUB)
     D  WCANS        E                     EXTFLD(GMANS)
     D  WCDL01       E                     EXTFLD(GMDL01)
     D  WCLDA        E                     EXTFLD(GMLDA)
     D  WCBPC        E                     EXTFLD(GMBPC)
     D  WCPEC        E                     EXTFLD(GMPEC)
     D  WCBILL       E                     EXTFLD(GMBILL)
     D  WCCRCD       E                     EXTFLD(GMCRCD)
     D  WCUM         E                     EXTFLD(GMUM)
     D  WCR001       E                     EXTFLD(GMR001)
     D  WCR002       E                     EXTFLD(GMR002)
     D  WCR003       E                     EXTFLD(GMR003)
     D  WCR004       E                     EXTFLD(GMR004)
     D  WCR005       E                     EXTFLD(GMR005)
     D  WCR006       E                     EXTFLD(GMR006)
     D  WCR007       E                     EXTFLD(GMR007)
     D  WCR008       E                     EXTFLD(GMR008)
     D  WCR009       E                     EXTFLD(GMR009)
     D  WCR010       E                     EXTFLD(GMR010)
     D  WCR011       E                     EXTFLD(GMR011)
     D  WCR012       E                     EXTFLD(GMR012)
     D  WCR013       E                     EXTFLD(GMR013)
     D  WCR014       E                     EXTFLD(GMR014)
     D  WCR015       E                     EXTFLD(GMR015)
     D  WCR016       E                     EXTFLD(GMR016)
     D  WCR017       E                     EXTFLD(GMR017)
     D  WCR018       E                     EXTFLD(GMR018)
     D  WCR019       E                     EXTFLD(GMR019)
     D  WCR020       E                     EXTFLD(GMR020)
     D  WCR021       E                     EXTFLD(GMR021)
     D  WCR022       E                     EXTFLD(GMR022)
     D  WCR023       E                     EXTFLD(GMR023)
     D  WCOBJA       E                     EXTFLD(GMOBJA)
     D  WCSUBA       E                     EXTFLD(GMSUBA)
     D  WCWCMP       E                     EXTFLD(GMWCMP)
     D  WCCCT        E                     EXTFLD(GMCCT)
     D  WCERC        E                     EXTFLD(GMERC)
     D  WCHTC        E                     EXTFLD(GMHTC)
     D  WCQLDA       E                     EXTFLD(GMQLDA)
     D  WCCCC        E                     EXTFLD(GMCCC)
     D  WCFMOD       E                     EXTFLD(GMFMOD)
     D  WCUSER       E                     EXTFLD(GMUSER)
     D  WCPID        E                     EXTFLD(GMPID)
     D  WCJOBN       E                     EXTFLD(GMJOBN)
     D  WCUPMJ       E                     EXTFLD(GMUPMJ)
     D  WCUPMT       E                     EXTFLD(GMUPMT)
     D  WCCEC1       E                     EXTFLD(GMCEC1)
     D  WCCEC2       E                     EXTFLD(GMCEC2)
     D  WCCEC3       E                     EXTFLD(GMCEC3)
     D  WCCEC4       E                     EXTFLD(GMCEC4)
     D  WCIEC        E                     EXTFLD(GMIEC)
     D  WCFPEC       E                     EXTFLD(GMFPEC)
     D  WCSTPC       E                     EXTFLD(GMSTPC)
     D  WCTXGL       E                     EXTFLD(GMTXGL)
     D  WCTOBJ       E                     EXTFLD(GMTOBJ)
     D  WCTSUB       E                     EXTFLD(GMTSUB)
     D  WCPRGF       E                     EXTFLD(GMPRGF)
     D  WCTXA1       E                     EXTFLD(GMTXA1)
     D  WCR024       E                     EXTFLD(GMR024)
     D  WCR025       E                     EXTFLD(GMR025)
     D  WCR026       E                     EXTFLD(GMR026)
     D  WCR027       E                     EXTFLD(GMR027)
     D  WCR028       E                     EXTFLD(GMR028)
     D  WCR029       E                     EXTFLD(GMR029)
     D  WCR030       E                     EXTFLD(GMR030)
     D  WCR031       E                     EXTFLD(GMR031)
     D  WCR032       E                     EXTFLD(GMR032)
     D  WCR033       E                     EXTFLD(GMR033)
     D  WCR034       E                     EXTFLD(GMR034)
     D  WCR035       E                     EXTFLD(GMR035)
     D  WCR036       E                     EXTFLD(GMR036)
     D  WCR037       E                     EXTFLD(GMR037)
     D  WCR038       E                     EXTFLD(GMR038)
     D  WCR039       E                     EXTFLD(GMR039)
     D  WCR040       E                     EXTFLD(GMR040)
     D  WCR041       E                     EXTFLD(GMR041)
     D  WCR042       E                     EXTFLD(GMR042)
     D  WCR043       E                     EXTFLD(GMR043)
     D  WCADJE       E                     EXTFLD(GMADJE)
     D  WCUAFL       E                     EXTFLD(GMUAFL)
      *
     D YARDCS          DS           497
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
     D QEZ091        E DS                  EXTNAME(EZ0901L0)
      * UPD : Account Master     F0901Z Update index
      * Renamed input format fields
     D  WDCO         E                     EXTFLD(BACO)
     D  WDAID        E                     EXTFLD(BAAID)
     D  WDACTS       E                     EXTFLD(BAACTS)
     D  WDMCU        E                     EXTFLD(BAMCU)
     D  WDOBJ        E                     EXTFLD(BAOBJ)
     D  WDSUB        E                     EXTFLD(BASUB)
     D  WDANS        E                     EXTFLD(BAANS)
     D  WDDL01       E                     EXTFLD(BADL01)
     D  WDLDA        E                     EXTFLD(BALDA)
     D  WDBPC        E                     EXTFLD(BABPC)
     D  WDPEC        E                     EXTFLD(BAPEC)
     D  WDBILL       E                     EXTFLD(BABILL)
     D  WDCRCD       E                     EXTFLD(BACRCD)
     D  WDUM         E                     EXTFLD(BAUM)
     D  WDR001       E                     EXTFLD(BAR001)
     D  WDR002       E                     EXTFLD(BAR002)
     D  WDR003       E                     EXTFLD(BAR003)
     D  WDR004       E                     EXTFLD(BAR004)
     D  WDR005       E                     EXTFLD(BAR005)
     D  WDR006       E                     EXTFLD(BAR006)
     D  WDR007       E                     EXTFLD(BAR007)
     D  WDR008       E                     EXTFLD(BAR008)
     D  WDR009       E                     EXTFLD(BAR009)
     D  WDR010       E                     EXTFLD(BAR010)
     D  WDR011       E                     EXTFLD(BAR011)
     D  WDR012       E                     EXTFLD(BAR012)
     D  WDR013       E                     EXTFLD(BAR013)
     D  WDR014       E                     EXTFLD(BAR014)
     D  WDR015       E                     EXTFLD(BAR015)
     D  WDR016       E                     EXTFLD(BAR016)
     D  WDR017       E                     EXTFLD(BAR017)
     D  WDR018       E                     EXTFLD(BAR018)
     D  WDR019       E                     EXTFLD(BAR019)
     D  WDR020       E                     EXTFLD(BAR020)
     D  WDR021       E                     EXTFLD(BAR021)
     D  WDR022       E                     EXTFLD(BAR022)
     D  WDR023       E                     EXTFLD(BAR023)
     D  WDOBJA       E                     EXTFLD(BAOBJA)
     D  WDSUBA       E                     EXTFLD(BASUBA)
     D  WDWCMP       E                     EXTFLD(BAWCMP)
     D  WDCCT        E                     EXTFLD(BACCT)
     D  WDERC        E                     EXTFLD(BAERC)
     D  WDHTC        E                     EXTFLD(BAHTC)
     D  WDQLDA       E                     EXTFLD(BAQLDA)
     D  WDCCC        E                     EXTFLD(BACCC)
     D  WDFMOD       E                     EXTFLD(BAFMOD)
     D  WDUSER       E                     EXTFLD(BAUSER)
     D  WDPID        E                     EXTFLD(BAPID)
     D  WDJOBN       E                     EXTFLD(BAJOBN)
     D  WDUPMJ       E                     EXTFLD(BAUPMJ)
     D  WDUPMT       E                     EXTFLD(BAUPMT)
     D  WDCEC1       E                     EXTFLD(BACEC1)
     D  WDCEC2       E                     EXTFLD(BACEC2)
     D  WDCEC3       E                     EXTFLD(BACEC3)
     D  WDCEC4       E                     EXTFLD(BACEC4)
     D  WDIEC        E                     EXTFLD(BAIEC)
     D  WDFPEC       E                     EXTFLD(BAFPEC)
     D  WDSTPC       E                     EXTFLD(BASTPC)
     D  WDTXGL       E                     EXTFLD(BATXGL)
     D  WDTOBJ       E                     EXTFLD(BATOBJ)
     D  WDTSUB       E                     EXTFLD(BATSUB)
     D  WDPRGF       E                     EXTFLD(BAPRGF)
     D  WDTXA1       E                     EXTFLD(BATXA1)
     D  WDR024       E                     EXTFLD(BAR024)
     D  WDR025       E                     EXTFLD(BAR025)
     D  WDR026       E                     EXTFLD(BAR026)
     D  WDR027       E                     EXTFLD(BAR027)
     D  WDR028       E                     EXTFLD(BAR028)
     D  WDR029       E                     EXTFLD(BAR029)
     D  WDR030       E                     EXTFLD(BAR030)
     D  WDR031       E                     EXTFLD(BAR031)
     D  WDR032       E                     EXTFLD(BAR032)
     D  WDR033       E                     EXTFLD(BAR033)
     D  WDR034       E                     EXTFLD(BAR034)
     D  WDR035       E                     EXTFLD(BAR035)
     D  WDR036       E                     EXTFLD(BAR036)
     D  WDR037       E                     EXTFLD(BAR037)
     D  WDR042       E                     EXTFLD(BAR042)
     D  WDR038       E                     EXTFLD(BAR038)
     D  WDR043       E                     EXTFLD(BAR043)
     D  WDADJE       E                     EXTFLD(BAADJE)
     D  WDR039       E                     EXTFLD(BAR039)
     D  WDUAFL       E                     EXTFLD(BAUAFL)
     D  WDR040       E                     EXTFLD(BAR040)
     D  WDR041       E                     EXTFLD(BAR041)
     D  WDIEST       E                     EXTFLD(BAIEST)
     D  WDADDT       E                     EXTFLD(BAADDT)
     D  WDADTM       E                     EXTFLD(BAADTM)
      *
     D YBRDCS          DS           532
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  XDTSDL         S             26
     D  ZADFMF         S             10
     D  YARDC          S              1
     D  YBRDC          S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
     D                 DS
     D  ZAMSDA                 1    132
     I@0901FF
      * Account Master     F0901Z Sel Unprocessed
      * Renamed input format fields
     I              BACO                        WACO
     I              BAAID                       WAAID
     I              BAACTS                      WAACTS
     I              BAMCU                       WAMCU
     I              BAOBJ                       WAOBJ
     I              BASUB                       WASUB
     I              BAANS                       WAANS
     I              BADL01                      WADL01
     I              BALDA                       WALDA
     I              BABPC                       WABPC
     I              BAPEC                       WAPEC
     I              BABILL                      WABILL
     I              BACRCD                      WACRCD
     I              BAUM                        WAUM
     I              BAR001                      WAR001
     I              BAR002                      WAR002
     I              BAR003                      WAR003
     I              BAR004                      WAR004
     I              BAR005                      WAR005
     I              BAR006                      WAR006
     I              BAR007                      WAR007
     I              BAR008                      WAR008
     I              BAR009                      WAR009
     I              BAR010                      WAR010
     I              BAR011                      WAR011
     I              BAR012                      WAR012
     I              BAR013                      WAR013
     I              BAR014                      WAR014
     I              BAR015                      WAR015
     I              BAR016                      WAR016
     I              BAR017                      WAR017
     I              BAR018                      WAR018
     I              BAR019                      WAR019
     I              BAR020                      WAR020
     I              BAR021                      WAR021
     I              BAR022                      WAR022
     I              BAR023                      WAR023
     I              BAOBJA                      WAOBJA
     I              BASUBA                      WASUBA
     I              BAWCMP                      WAWCMP
     I              BACCT                       WACCT
     I              BAERC                       WAERC
     I              BAHTC                       WAHTC
     I              BAQLDA                      WAQLDA
     I              BACCC                       WACCC
     I              BAFMOD                      WAFMOD
     I              BAUSER                      WAUSER
     I              BAPID                       WAPID
     I              BAJOBN                      WAJOBN
     I              BAUPMJ                      WAUPMJ
     I              BAUPMT                      WAUPMT
     I              BACEC1                      WACEC1
     I              BACEC2                      WACEC2
     I              BACEC3                      WACEC3
     I              BACEC4                      WACEC4
     I              BAIEC                       WAIEC
     I              BAFPEC                      WAFPEC
     I              BASTPC                      WASTPC
     I              BATXGL                      WATXGL
     I              BATOBJ                      WATOBJ
     I              BATSUB                      WATSUB
     I              BAPRGF                      WAPRGF
     I              BATXA1                      WATXA1
     I              BAR024                      WAR024
     I              BAR025                      WAR025
     I              BAR026                      WAR026
     I              BAR027                      WAR027
     I              BAR028                      WAR028
     I              BAR029                      WAR029
     I              BAR030                      WAR030
     I              BAR031                      WAR031
     I              BAR032                      WAR032
     I              BAR033                      WAR033
     I              BAR034                      WAR034
     I              BAR035                      WAR035
     I              BAR036                      WAR036
     I              BAR037                      WAR037
     I              BAR042                      WAR042
     I              BAR038                      WAR038
     I              BAR043                      WAR043
     I              BAADJE                      WAADJE
     I              BAR039                      WAR039
     I              BAUAFL                      WAUAFL
     I              BAR040                      WAR040
     I              BAR041                      WAR041
     I              BAIEST                      WAIEST
     I              BAADDT                      WAADDT
     I              BAADTM                      WAADTM
      *
     II0901L1
      * Account Master     F0901  Rtv-Company/Account ID
      * Renamed input format fields
     I              GMCO                        WBCO
     I              GMAID                       WBAID
     I              GMMCU                       WBMCU
     I              GMOBJ                       WBOBJ
     I              GMSUB                       WBSUB
     I              GMANS                       WBANS
     I              GMDL01                      WBDL01
     I              GMLDA                       WBLDA
     I              GMBPC                       WBBPC
     I              GMPEC                       WBPEC
     I              GMBILL                      WBBILL
     I              GMCRCD                      WBCRCD
     I              GMUM                        WBUM
     I              GMR001                      WBR001
     I              GMR002                      WBR002
     I              GMR003                      WBR003
     I              GMR004                      WBR004
     I              GMR005                      WBR005
     I              GMR006                      WBR006
     I              GMR007                      WBR007
     I              GMR008                      WBR008
     I              GMR009                      WBR009
     I              GMR010                      WBR010
     I              GMR011                      WBR011
     I              GMR012                      WBR012
     I              GMR013                      WBR013
     I              GMR014                      WBR014
     I              GMR015                      WBR015
     I              GMR016                      WBR016
     I              GMR017                      WBR017
     I              GMR018                      WBR018
     I              GMR019                      WBR019
     I              GMR020                      WBR020
     I              GMR021                      WBR021
     I              GMR022                      WBR022
     I              GMR023                      WBR023
     I              GMOBJA                      WBOBJA
     I              GMSUBA                      WBSUBA
     I              GMWCMP                      WBWCMP
     I              GMCCT                       WBCCT
     I              GMERC                       WBERC
     I              GMHTC                       WBHTC
     I              GMQLDA                      WBQLDA
     I              GMCCC                       WBCCC
     I              GMFMOD                      WBFMOD
     I              GMUSER                      WBUSER
     I              GMPID                       WBPID
     I              GMJOBN                      WBJOBN
     I              GMUPMJ                      WBUPMJ
     I              GMUPMT                      WBUPMT
     I              GMCEC1                      WBCEC1
     I              GMCEC2                      WBCEC2
     I              GMCEC3                      WBCEC3
     I              GMCEC4                      WBCEC4
     I              GMIEC                       WBIEC
     I              GMFPEC                      WBFPEC
     I              GMSTPC                      WBSTPC
     I              GMTXGL                      WBTXGL
     I              GMTOBJ                      WBTOBJ
     I              GMTSUB                      WBTSUB
     I              GMPRGF                      WBPRGF
     I              GMTXA1                      WBTXA1
     I              GMR024                      WBR024
     I              GMR025                      WBR025
     I              GMR026                      WBR026
     I              GMR027                      WBR027
     I              GMR028                      WBR028
     I              GMR029                      WBR029
     I              GMR030                      WBR030
     I              GMR031                      WBR031
     I              GMR032                      WBR032
     I              GMR033                      WBR033
     I              GMR034                      WBR034
     I              GMR035                      WBR035
     I              GMR036                      WBR036
     I              GMR037                      WBR037
     I              GMR038                      WBR038
     I              GMR039                      WBR039
     I              GMR040                      WBR040
     I              GMR041                      WBR041
     I              GMR042                      WBR042
     I              GMR043                      WBR043
     I              GMADJE                      WBADJE
     I              GMUAFL                      WBUAFL
      *
     II0901L0
      * Account Master     F0901  Upd-Company/Account ID
      * Renamed input format fields
     I              GMCO                        WCCO
     I              GMAID                       WCAID
     I              GMMCU                       WCMCU
     I              GMOBJ                       WCOBJ
     I              GMSUB                       WCSUB
     I              GMANS                       WCANS
     I              GMDL01                      WCDL01
     I              GMLDA                       WCLDA
     I              GMBPC                       WCBPC
     I              GMPEC                       WCPEC
     I              GMBILL                      WCBILL
     I              GMCRCD                      WCCRCD
     I              GMUM                        WCUM
     I              GMR001                      WCR001
     I              GMR002                      WCR002
     I              GMR003                      WCR003
     I              GMR004                      WCR004
     I              GMR005                      WCR005
     I              GMR006                      WCR006
     I              GMR007                      WCR007
     I              GMR008                      WCR008
     I              GMR009                      WCR009
     I              GMR010                      WCR010
     I              GMR011                      WCR011
     I              GMR012                      WCR012
     I              GMR013                      WCR013
     I              GMR014                      WCR014
     I              GMR015                      WCR015
     I              GMR016                      WCR016
     I              GMR017                      WCR017
     I              GMR018                      WCR018
     I              GMR019                      WCR019
     I              GMR020                      WCR020
     I              GMR021                      WCR021
     I              GMR022                      WCR022
     I              GMR023                      WCR023
     I              GMOBJA                      WCOBJA
     I              GMSUBA                      WCSUBA
     I              GMWCMP                      WCWCMP
     I              GMCCT                       WCCCT
     I              GMERC                       WCERC
     I              GMHTC                       WCHTC
     I              GMQLDA                      WCQLDA
     I              GMCCC                       WCCCC
     I              GMFMOD                      WCFMOD
     I              GMUSER                      WCUSER
     I              GMPID                       WCPID
     I              GMJOBN                      WCJOBN
     I              GMUPMJ                      WCUPMJ
     I              GMUPMT                      WCUPMT
     I              GMCEC1                      WCCEC1
     I              GMCEC2                      WCCEC2
     I              GMCEC3                      WCCEC3
     I              GMCEC4                      WCCEC4
     I              GMIEC                       WCIEC
     I              GMFPEC                      WCFPEC
     I              GMSTPC                      WCSTPC
     I              GMTXGL                      WCTXGL
     I              GMTOBJ                      WCTOBJ
     I              GMTSUB                      WCTSUB
     I              GMPRGF                      WCPRGF
     I              GMTXA1                      WCTXA1
     I              GMR024                      WCR024
     I              GMR025                      WCR025
     I              GMR026                      WCR026
     I              GMR027                      WCR027
     I              GMR028                      WCR028
     I              GMR029                      WCR029
     I              GMR030                      WCR030
     I              GMR031                      WCR031
     I              GMR032                      WCR032
     I              GMR033                      WCR033
     I              GMR034                      WCR034
     I              GMR035                      WCR035
     I              GMR036                      WCR036
     I              GMR037                      WCR037
     I              GMR038                      WCR038
     I              GMR039                      WCR039
     I              GMR040                      WCR040
     I              GMR041                      WCR041
     I              GMR042                      WCR042
     I              GMR043                      WCR043
     I              GMADJE                      WCADJE
     I              GMUAFL                      WCUAFL
      *
     I@BACPET
      * Account Master     F0901Z Update index
      * Renamed input format fields
     I              BACO                        WDCO
     I              BAAID                       WDAID
     I              BAACTS                      WDACTS
     I              BAMCU                       WDMCU
     I              BAOBJ                       WDOBJ
     I              BASUB                       WDSUB
     I              BAANS                       WDANS
     I              BADL01                      WDDL01
     I              BALDA                       WDLDA
     I              BABPC                       WDBPC
     I              BAPEC                       WDPEC
     I              BABILL                      WDBILL
     I              BACRCD                      WDCRCD
     I              BAUM                        WDUM
     I              BAR001                      WDR001
     I              BAR002                      WDR002
     I              BAR003                      WDR003
     I              BAR004                      WDR004
     I              BAR005                      WDR005
     I              BAR006                      WDR006
     I              BAR007                      WDR007
     I              BAR008                      WDR008
     I              BAR009                      WDR009
     I              BAR010                      WDR010
     I              BAR011                      WDR011
     I              BAR012                      WDR012
     I              BAR013                      WDR013
     I              BAR014                      WDR014
     I              BAR015                      WDR015
     I              BAR016                      WDR016
     I              BAR017                      WDR017
     I              BAR018                      WDR018
     I              BAR019                      WDR019
     I              BAR020                      WDR020
     I              BAR021                      WDR021
     I              BAR022                      WDR022
     I              BAR023                      WDR023
     I              BAOBJA                      WDOBJA
     I              BASUBA                      WDSUBA
     I              BAWCMP                      WDWCMP
     I              BACCT                       WDCCT
     I              BAERC                       WDERC
     I              BAHTC                       WDHTC
     I              BAQLDA                      WDQLDA
     I              BACCC                       WDCCC
     I              BAFMOD                      WDFMOD
     I              BAUSER                      WDUSER
     I              BAPID                       WDPID
     I              BAJOBN                      WDJOBN
     I              BAUPMJ                      WDUPMJ
     I              BAUPMT                      WDUPMT
     I              BACEC1                      WDCEC1
     I              BACEC2                      WDCEC2
     I              BACEC3                      WDCEC3
     I              BACEC4                      WDCEC4
     I              BAIEC                       WDIEC
     I              BAFPEC                      WDFPEC
     I              BASTPC                      WDSTPC
     I              BATXGL                      WDTXGL
     I              BATOBJ                      WDTOBJ
     I              BATSUB                      WDTSUB
     I              BAPRGF                      WDPRGF
     I              BATXA1                      WDTXA1
     I              BAR024                      WDR024
     I              BAR025                      WDR025
     I              BAR026                      WDR026
     I              BAR027                      WDR027
     I              BAR028                      WDR028
     I              BAR029                      WDR029
     I              BAR030                      WDR030
     I              BAR031                      WDR031
     I              BAR032                      WDR032
     I              BAR033                      WDR033
     I              BAR034                      WDR034
     I              BAR035                      WDR035
     I              BAR036                      WDR036
     I              BAR037                      WDR037
     I              BAR042                      WDR042
     I              BAR038                      WDR038
     I              BAR043                      WDR043
     I              BAADJE                      WDADJE
     I              BAR039                      WDR039
     I              BAUAFL                      WDUAFL
     I              BAR040                      WDR040
     I              BAR041                      WDR041
     I              BAIEST                      WDIEST
     I              BAADDT                      WDADDT
     I              BAADTM                      WDADTM
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Exc Prc From F0901    XF
      * SDN 465 JDE to E1 RMC 4/27/2020
      *   Read staged table from E1 for the address book and update E1IDE
      *    table E10901- process adds/changes sent in the f0901z
      * Rtv Prc From F0901    RT - Account Master     F0901Z  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Rtv Prc From F0901    RT - Account Master     F0901Z  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KPSSA         KLIST
     C                   KFLD                    WACO                           Company
     C                   KFLD                    WAAID                          Account ID
     C                   KFLD                    WAACTS                         Date Time Stamp
      * Initialize key list
     C                   MOVEL     *LOVAL        WACO                           Company
     C                   MOVEL     *LOVAL        WAAID                          Account ID
     C                   MOVEL     XDTSDL        WAACTS                         Date Time Stamp
      * Setup key
      * Establish starting position
     C     KPSSA         SETLL     @0901FF                                      *
     C                   READ      @0901FF                                90    *
      * Data record not found
     C   90              MOVEL     'E1I0149'     W0RTN
      * USER: Process Data record
      * Rtv DelCrt from Stage RT - Account Master     F0901  * 
     C                   DOW       NOT *IN90
     C                   EXSR      SBRVGN
      * Chg F0901Z to Prcd    CH - Account Master     F0901Z  * 
     C                   EXSR      SECHRC
     C                   READ      @0901FF                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Rtv DelCrt from Stage RT - Account Master     F0901  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBCO                           Company
     C                   KFLD                    WBAID                          Account ID
      * Setup key
     C                   MOVEL     WACO          WBCO                           Company
     C                   MOVEL     WAAID         WBAID                          Account ID
      * Establish starting position
     C     KRSSB         CHAIN     I0901L1                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'E1I0096'     W0RTN
      * USER: Processing if Data record not found
      * Crt Account Master - Account Master     F0901  * 
     C                   EXSR      SCCRRC
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * Chg Account Master - Account Master     F0901  * 
     C                   IF        NOT *IN90
     C                   EXSR      SDCHRC
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCCRRC        BEGSR
      *================================================================
      * Crt Account Master - Account Master     F0901  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move all fields to I0901L0
     C                   MOVEL     WACO          WCCO                           Company
     C                   MOVEL     WAAID         WCAID                          Account ID
     C                   MOVEL     WAMCU         WCMCU                          Business Unit/C
     C                   MOVEL     WAOBJ         WCOBJ                          Object Account
     C                   MOVEL     WASUB         WCSUB                          Subsidiary
     C                   MOVEL     WAANS         WCANS                          Account Number
     C                   MOVEL     WADL01        WCDL01                         Description
     C                   MOVEL     WALDA         WCLDA                          Account Level o
     C                   MOVEL     WABPC         WCBPC                          Budget Pattern
     C                   MOVEL     WAPEC         WCPEC                          Posting Edit
     C                   MOVEL     WABILL        WCBILL                         Billable
     C                   MOVEL     WACRCD        WCCRCD                         Currency Code -
     C                   MOVEL     WAUM          WCUM                           Unit of Measure
     C                   MOVEL     WAR001        WCR001                         Catg Code - G/L
     C                   MOVEL     WAR002        WCR002                         Catg Code - G/L
     C                   MOVEL     WAR003        WCR003                         Catg Code - G/L
     C                   MOVEL     WAR004        WCR004                         Catg Code - G/L
     C                   MOVEL     WAR005        WCR005                         Catg Code - G/L
     C                   MOVEL     WAR006        WCR006                         Catg Code - G/L
     C                   MOVEL     WAR007        WCR007                         Catg Code - G/L
     C                   MOVEL     WAR008        WCR008                         Catg Code - G/L
     C                   MOVEL     WAR009        WCR009                         Catg Code - G/L
     C                   MOVEL     WAR010        WCR010                         Catg Code - G/L
     C                   MOVEL     WAR011        WCR011                         Catg Code - G/L
     C                   MOVEL     WAR012        WCR012                         Catg Code - G/L
     C                   MOVEL     WAR013        WCR013                         Catg Code - G/L
     C                   MOVEL     WAR014        WCR014                         Catg Code - G/L
     C                   MOVEL     WAR015        WCR015                         Catg Code - G/L
     C                   MOVEL     WAR016        WCR016                         Catg Code - G/L
     C                   MOVEL     WAR017        WCR017                         Catg Code - G/L
     C                   MOVEL     WAR018        WCR018                         Catg Code - G/L
     C                   MOVEL     WAR019        WCR019                         Catg Code - G/L
     C                   MOVEL     WAR020        WCR020                         Catg Code - G/L
     C                   MOVEL     WAR021        WCR021                         Catg Code - G/L
     C                   MOVEL     WAR022        WCR022                         Catg Code - G/L
     C                   MOVEL     WAR023        WCR023                         Catg Code - G/L
     C                   MOVEL     WAOBJA        WCOBJA                         Object Acct - A
     C                   MOVEL     WASUBA        WCSUBA                         Subsidiary - Al
     C                   MOVEL     WAWCMP        WCWCMP                         Workers Comp In
     C                   MOVEL     WACCT         WCCCT                          Method of Compu
     C                   MOVEL     WAERC         WCERC                          Equipment Rate
     C                   MOVEL     WAHTC         WCHTC                          Header Type Cod
     C                   MOVEL     WAQLDA        WCQLDA                         Quantity Roll-U
     C                   MOVEL     WACCC         WCCCC                          Cost Code Compl
     C                   MOVEL     WAFMOD        WCFMOD                         Model Accts & C
     C                   MOVEL     WAUSER        WCUSER                         User ID
     C                   MOVEL     WAPID         WCPID                          Program ID
     C                   MOVEL     WAJOBN        WCJOBN                         Work Station ID
     C                   Z-ADD     WAUPMJ        WCUPMJ                         Date - Updated
     C                   Z-ADD     WAUPMT        WCUPMT                         Time - Last Upd
     C                   MOVEL     WACEC1        WCCEC1                         Cost Object Edi
     C                   MOVEL     WACEC2        WCCEC2                         Cost Object Edi
     C                   MOVEL     WACEC3        WCCEC3                         Cost Object Edi
     C                   MOVEL     WACEC4        WCCEC4                         Cost Object Edi
     C                   MOVEL     WAIEC         WCIEC                          Item Edit Code
     C                   MOVEL     WAFPEC        WCFPEC                         Fixed Asset Pos
     C                   MOVEL     WASTPC        WCSTPC                         Type Code - Acc
     C                   MOVEL     WATXGL        WCTXGL                         G/L Account Tax
     C                   MOVEL     WATOBJ        WCTOBJ                         Target Object A
     C                   MOVEL     WATSUB        WCTSUB                         Target Subsidia
     C                   MOVEL     WAPRGF        WCPRGF                         Purge Flag
     C                   MOVEL     WATXA1        WCTXA1                         Tax Rate/Area
     C                   MOVEL     WAR024        WCR024                         Catg Code - G/L
     C                   MOVEL     WAR025        WCR025                         Catg Code - G/L
     C                   MOVEL     WAR026        WCR026                         Catg Code - G/L
     C                   MOVEL     WAR027        WCR027                         Catg Code - G/L
     C                   MOVEL     WAR028        WCR028                         Catg Code - G/L
     C                   MOVEL     WAR029        WCR029                         Catg Code - G/L
     C                   MOVEL     WAR030        WCR030                         Catg Code - G/L
     C                   MOVEL     WAR031        WCR031                         Catg Code - G/L
     C                   MOVEL     WAR032        WCR032                         Catg Code - G/L
     C                   MOVEL     WAR033        WCR033                         Catg Code - G/L
     C                   MOVEL     WAR034        WCR034                         Catg Code - G/L
     C                   MOVEL     WAR035        WCR035                         Catg Code - G/L
     C                   MOVEL     WAR036        WCR036                         Catg Code - G/L
     C                   MOVEL     WAR037        WCR037                         Catg Code - G/L
     C                   MOVEL     WAR038        WCR038                         Catg Code - G/L
     C                   MOVEL     WAR039        WCR039                         Catg Code - G/L
     C                   MOVEL     WAR040        WCR040                         Catg Code - G/L
     C                   MOVEL     WAR041        WCR041                         Catg Code - G/L
     C                   MOVEL     WAR042        WCR042                         Catg Code - G/L
     C                   MOVEL     WAR043        WCR043                         Catg Code - G/L
     C                   MOVEL     WAADJE        WCADJE                         Adjustment Entr
     C                   MOVEL     WAUAFL        WCUAFL                         FAR Unallowable
      *
     C     KLCRSC        KLIST
     C                   KFLD                    WCCO                           Company
     C                   KFLD                    WCAID                          Account ID
      * Check for duplicate primary key
     C     KLCRSC        SETLL     I0901L0                                90    *
     C                   IF        *IN90
     C                   MOVEL     'E1I0097'     W0RTN
      * Send message 'Account Master     F09 EX'
     C                   MOVEL     'E1I0097'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
     C                   WRITE     I0901L0                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDCHRC        BEGSR
      *================================================================
      * Chg Account Master - Account Master     F0901  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to I0901L0
     C                   MOVEL(P)  WBCO          WCCO                           Company
     C                   MOVEL(P)  WBAID         WCAID                          Account ID
      *
     C     KLCHSD        KLIST
     C                   KFLD                    WCCO                           Company
     C                   KFLD                    WCAID                          Account ID
     C     KLCHSD        CHAIN     I0901L0                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'E10901L0'    MDACP
     C                   MOVEL     'I0901L0'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QE1091        YARDCS
      * Move non-key fields to I0901L0
     C                   MOVEL(P)  WAMCU         WCMCU                          Business Unit/C
     C                   MOVEL(P)  WAOBJ         WCOBJ                          Object Account
     C                   MOVEL(P)  WASUB         WCSUB                          Subsidiary
     C                   MOVEL(P)  WAANS         WCANS                          Account Number
     C                   MOVEL(P)  WADL01        WCDL01                         Description
     C                   MOVEL(P)  WALDA         WCLDA                          Account Level o
     C                   MOVEL(P)  WABPC         WCBPC                          Budget Pattern
     C                   MOVEL(P)  WAPEC         WCPEC                          Posting Edit
     C                   MOVEL(P)  WABILL        WCBILL                         Billable
     C                   MOVEL(P)  WACRCD        WCCRCD                         Currency Code -
     C                   MOVEL(P)  WAUM          WCUM                           Unit of Measure
     C                   MOVEL(P)  WAR001        WCR001                         Catg Code - G/L
     C                   MOVEL(P)  WAR002        WCR002                         Catg Code - G/L
     C                   MOVEL(P)  WAR003        WCR003                         Catg Code - G/L
     C                   MOVEL(P)  WAR004        WCR004                         Catg Code - G/L
     C                   MOVEL(P)  WAR005        WCR005                         Catg Code - G/L
     C                   MOVEL(P)  WAR006        WCR006                         Catg Code - G/L
     C                   MOVEL(P)  WAR007        WCR007                         Catg Code - G/L
     C                   MOVEL(P)  WAR008        WCR008                         Catg Code - G/L
     C                   MOVEL(P)  WAR009        WCR009                         Catg Code - G/L
     C                   MOVEL(P)  WAR010        WCR010                         Catg Code - G/L
     C                   MOVEL(P)  WAR011        WCR011                         Catg Code - G/L
     C                   MOVEL(P)  WAR012        WCR012                         Catg Code - G/L
     C                   MOVEL(P)  WAR013        WCR013                         Catg Code - G/L
     C                   MOVEL(P)  WAR014        WCR014                         Catg Code - G/L
     C                   MOVEL(P)  WAR015        WCR015                         Catg Code - G/L
     C                   MOVEL(P)  WAR016        WCR016                         Catg Code - G/L
     C                   MOVEL(P)  WAR017        WCR017                         Catg Code - G/L
     C                   MOVEL(P)  WAR018        WCR018                         Catg Code - G/L
     C                   MOVEL(P)  WAR019        WCR019                         Catg Code - G/L
     C                   MOVEL(P)  WAR020        WCR020                         Catg Code - G/L
     C                   MOVEL(P)  WAR021        WCR021                         Catg Code - G/L
     C                   MOVEL(P)  WAR022        WCR022                         Catg Code - G/L
     C                   MOVEL(P)  WAR023        WCR023                         Catg Code - G/L
     C                   MOVEL(P)  WAOBJA        WCOBJA                         Object Acct - A
     C                   MOVEL(P)  WASUBA        WCSUBA                         Subsidiary - Al
     C                   MOVEL(P)  WAWCMP        WCWCMP                         Workers Comp In
     C                   MOVEL(P)  WACCT         WCCCT                          Method of Compu
     C                   MOVEL(P)  WAERC         WCERC                          Equipment Rate
     C                   MOVEL(P)  WAHTC         WCHTC                          Header Type Cod
     C                   MOVEL(P)  WAQLDA        WCQLDA                         Quantity Roll-U
     C                   MOVEL(P)  WACCC         WCCCC                          Cost Code Compl
     C                   MOVEL(P)  WAFMOD        WCFMOD                         Model Accts & C
     C                   MOVEL(P)  WAUSER        WCUSER                         User ID
     C                   MOVEL(P)  WAPID         WCPID                          Program ID
     C                   MOVEL(P)  WAJOBN        WCJOBN                         Work Station ID
     C                   Z-ADD     WAUPMJ        WCUPMJ                         Date - Updated
     C                   Z-ADD     WAUPMT        WCUPMT                         Time - Last Upd
     C                   MOVEL(P)  WACEC1        WCCEC1                         Cost Object Edi
     C                   MOVEL(P)  WACEC2        WCCEC2                         Cost Object Edi
     C                   MOVEL(P)  WACEC3        WCCEC3                         Cost Object Edi
     C                   MOVEL(P)  WACEC4        WCCEC4                         Cost Object Edi
     C                   MOVEL(P)  WAIEC         WCIEC                          Item Edit Code
     C                   MOVEL(P)  WAFPEC        WCFPEC                         Fixed Asset Pos
     C                   MOVEL(P)  WASTPC        WCSTPC                         Type Code - Acc
     C                   MOVEL(P)  WATXGL        WCTXGL                         G/L Account Tax
     C                   MOVEL(P)  WATOBJ        WCTOBJ                         Target Object A
     C                   MOVEL(P)  WATSUB        WCTSUB                         Target Subsidia
     C                   MOVEL(P)  WAPRGF        WCPRGF                         Purge Flag
     C                   MOVEL(P)  WATXA1        WCTXA1                         Tax Rate/Area
     C                   MOVEL(P)  WAR024        WCR024                         Catg Code - G/L
     C                   MOVEL(P)  WAR025        WCR025                         Catg Code - G/L
     C                   MOVEL(P)  WAR026        WCR026                         Catg Code - G/L
     C                   MOVEL(P)  WAR027        WCR027                         Catg Code - G/L
     C                   MOVEL(P)  WAR028        WCR028                         Catg Code - G/L
     C                   MOVEL(P)  WAR029        WCR029                         Catg Code - G/L
     C                   MOVEL(P)  WAR030        WCR030                         Catg Code - G/L
     C                   MOVEL(P)  WAR031        WCR031                         Catg Code - G/L
     C                   MOVEL(P)  WAR032        WCR032                         Catg Code - G/L
     C                   MOVEL(P)  WAR033        WCR033                         Catg Code - G/L
     C                   MOVEL(P)  WAR034        WCR034                         Catg Code - G/L
     C                   MOVEL(P)  WAR035        WCR035                         Catg Code - G/L
     C                   MOVEL(P)  WAR036        WCR036                         Catg Code - G/L
     C                   MOVEL(P)  WAR037        WCR037                         Catg Code - G/L
     C                   MOVEL(P)  WAR038        WCR038                         Catg Code - G/L
     C                   MOVEL(P)  WAR039        WCR039                         Catg Code - G/L
     C                   MOVEL(P)  WAR040        WCR040                         Catg Code - G/L
     C                   MOVEL(P)  WAR041        WCR041                         Catg Code - G/L
     C                   MOVEL(P)  WAR042        WCR042                         Catg Code - G/L
     C                   MOVEL(P)  WAR043        WCR043                         Catg Code - G/L
     C                   MOVEL(P)  WAADJE        WCADJE                         Adjustment Entr
     C                   MOVEL(P)  WAUAFL        WCUAFL                         FAR Unallowable
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QE1091 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    I0901L0                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    E10901L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SECHRC        BEGSR
      *================================================================
      * Chg F0901Z to Prcd    CH - Account Master     F0901Z  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YBRDC = ' '
      *
      * Move key fields to @BACPET
     C                   MOVEL(P)  WACO          WDCO                           Company
     C                   MOVEL(P)  WAAID         WDAID                          Account ID
     C                   MOVEL(P)  WAACTS        WDACTS                         Date Time Stamp
      *
     C     KLCHSE        KLIST
     C                   KFLD                    WDCO                           Company
     C                   KFLD                    WDAID                          Account ID
     C                   KFLD                    WDACTS                         Date Time Stamp
     C     KLCHSE        CHAIN     @BACPET                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'EZ0901L0'    MDACP
     C                   MOVEL     '@BACPET'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL002.
     C                   MOVEL     'LBL002'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QEZ091        YBRDCS
      * Move non-key fields to @BACPET
     C                   MOVEL(P)  WAMCU         WDMCU                          Business Unit/C
     C                   MOVEL(P)  WAOBJ         WDOBJ                          Object Account
     C                   MOVEL(P)  WASUB         WDSUB                          Subsidiary
     C                   MOVEL(P)  WAANS         WDANS                          Account Number
     C                   MOVEL(P)  WADL01        WDDL01                         Description
     C                   MOVEL(P)  WALDA         WDLDA                          Account Level o
     C                   MOVEL(P)  WABPC         WDBPC                          Budget Pattern
     C                   MOVEL(P)  WAPEC         WDPEC                          Posting Edit
     C                   MOVEL(P)  WABILL        WDBILL                         Billable
     C                   MOVEL(P)  WACRCD        WDCRCD                         Currency Code -
     C                   MOVEL(P)  WAUM          WDUM                           Unit of Measure
     C                   MOVEL(P)  WAR001        WDR001                         Catg Code - G/L
     C                   MOVEL(P)  WAR002        WDR002                         Catg Code - G/L
     C                   MOVEL(P)  WAR003        WDR003                         Catg Code - G/L
     C                   MOVEL(P)  WAR004        WDR004                         Catg Code - G/L
     C                   MOVEL(P)  WAR005        WDR005                         Catg Code - G/L
     C                   MOVEL(P)  WAR006        WDR006                         Catg Code - G/L
     C                   MOVEL(P)  WAR007        WDR007                         Catg Code - G/L
     C                   MOVEL(P)  WAR008        WDR008                         Catg Code - G/L
     C                   MOVEL(P)  WAR009        WDR009                         Catg Code - G/L
     C                   MOVEL(P)  WAR010        WDR010                         Catg Code - G/L
     C                   MOVEL(P)  WAR011        WDR011                         Catg Code - G/L
     C                   MOVEL(P)  WAR012        WDR012                         Catg Code - G/L
     C                   MOVEL(P)  WAR013        WDR013                         Catg Code - G/L
     C                   MOVEL(P)  WAR014        WDR014                         Catg Code - G/L
     C                   MOVEL(P)  WAR015        WDR015                         Catg Code - G/L
     C                   MOVEL(P)  WAR016        WDR016                         Catg Code - G/L
     C                   MOVEL(P)  WAR017        WDR017                         Catg Code - G/L
     C                   MOVEL(P)  WAR018        WDR018                         Catg Code - G/L
     C                   MOVEL(P)  WAR019        WDR019                         Catg Code - G/L
     C                   MOVEL(P)  WAR020        WDR020                         Catg Code - G/L
     C                   MOVEL(P)  WAR021        WDR021                         Catg Code - G/L
     C                   MOVEL(P)  WAR022        WDR022                         Catg Code - G/L
     C                   MOVEL(P)  WAR023        WDR023                         Catg Code - G/L
     C                   MOVEL(P)  WAOBJA        WDOBJA                         Object Acct - A
     C                   MOVEL(P)  WASUBA        WDSUBA                         Subsidiary - Al
     C                   MOVEL(P)  WAWCMP        WDWCMP                         Workers Comp In
     C                   MOVEL(P)  WACCT         WDCCT                          Method of Compu
     C                   MOVEL(P)  WAERC         WDERC                          Equipment Rate
     C                   MOVEL(P)  WAHTC         WDHTC                          Header Type Cod
     C                   MOVEL(P)  WAQLDA        WDQLDA                         Quantity Roll-U
     C                   MOVEL(P)  WACCC         WDCCC                          Cost Code Compl
     C                   MOVEL(P)  WAFMOD        WDFMOD                         Model Accts & C
     C                   MOVEL(P)  WAUSER        WDUSER                         User ID
     C                   MOVEL(P)  WAPID         WDPID                          Program ID
     C                   MOVEL(P)  WAJOBN        WDJOBN                         Work Station ID
     C                   Z-ADD     WAUPMJ        WDUPMJ                         Date - Updated
     C                   Z-ADD     WAUPMT        WDUPMT                         Time - Last Upd
     C                   MOVEL(P)  WACEC1        WDCEC1                         Cost Object Edi
     C                   MOVEL(P)  WACEC2        WDCEC2                         Cost Object Edi
     C                   MOVEL(P)  WACEC3        WDCEC3                         Cost Object Edi
     C                   MOVEL(P)  WACEC4        WDCEC4                         Cost Object Edi
     C                   MOVEL(P)  WAIEC         WDIEC                          Item Edit Code
     C                   MOVEL(P)  WAFPEC        WDFPEC                         Fixed Asset Pos
     C                   MOVEL(P)  WASTPC        WDSTPC                         Type Code - Acc
     C                   MOVEL(P)  WATXGL        WDTXGL                         G/L Account Tax
     C                   MOVEL(P)  WATOBJ        WDTOBJ                         Target Object A
     C                   MOVEL(P)  WATSUB        WDTSUB                         Target Subsidia
     C                   MOVEL(P)  WAPRGF        WDPRGF                         Purge Flag
     C                   MOVEL(P)  WATXA1        WDTXA1                         Tax Rate/Area
     C                   MOVEL(P)  WAR024        WDR024                         Catg Code - G/L
     C                   MOVEL(P)  WAR025        WDR025                         Catg Code - G/L
     C                   MOVEL(P)  WAR026        WDR026                         Catg Code - G/L
     C                   MOVEL(P)  WAR027        WDR027                         Catg Code - G/L
     C                   MOVEL(P)  WAR028        WDR028                         Catg Code - G/L
     C                   MOVEL(P)  WAR029        WDR029                         Catg Code - G/L
     C                   MOVEL(P)  WAR030        WDR030                         Catg Code - G/L
     C                   MOVEL(P)  WAR031        WDR031                         Catg Code - G/L
     C                   MOVEL(P)  WAR032        WDR032                         Catg Code - G/L
     C                   MOVEL(P)  WAR033        WDR033                         Catg Code - G/L
     C                   MOVEL(P)  WAR034        WDR034                         Catg Code - G/L
     C                   MOVEL(P)  WAR035        WDR035                         Catg Code - G/L
     C                   MOVEL(P)  WAR036        WDR036                         Catg Code - G/L
     C                   MOVEL(P)  WAR037        WDR037                         Catg Code - G/L
     C                   MOVEL(P)  WAR042        WDR042                         Catg Code - G/L
     C                   MOVEL(P)  WAR038        WDR038                         Catg Code - G/L
     C                   MOVEL(P)  WAR043        WDR043                         Catg Code - G/L
     C                   MOVEL(P)  WAADJE        WDADJE                         Adjustment Entr
     C                   MOVEL(P)  WAR039        WDR039                         Catg Code - G/L
     C                   MOVEL(P)  WAUAFL        WDUAFL                         FAR Unallowable
     C                   MOVEL(P)  WAR040        WDR040                         Catg Code - G/L
     C                   MOVEL(P)  WAR041        WDR041                         Catg Code - G/L
     C                   MOVEL(P)  '1'           WDIEST                         OMS ERP Process
     C                   Z-ADD     ##JDT         WDADDT                         OMS ERP Process
     C                   Z-ADD     ##JTM         WDADTM                         OMS ERP Process
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QEZ091 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YBRDC = 'Y'
     C                   UPDATE    @BACPET                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    EZ0901L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   MOVE(P)   '0'           XDTSDL
     C                   MOVEL     @CN(001)      XDTSDL
     C                   MOVEL     XDTSDL        WAACTS                         Date Time Stamp
     C                   Z-ADD     *ZERO         WAUPMJ                         Date - Updated
     C                   Z-ADD     *ZERO         WAUPMT                         Time - Last Upd
     C                   Z-ADD     *ZERO         WAADDT                         OMS ERP Process
     C                   Z-ADD     *ZERO         WAADTM                         OMS ERP Process
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBUPMJ                         Date - Updated
     C                   Z-ADD     *ZERO         WBUPMT                         Time - Last Upd
      * Obtain default message file
     C     *DTAARA       DEFINE    E1MGFLA       ZADFMF
     C                   IN        ZADFMF
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     'N'           W0PMT
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
