     H/TITLE Ext Count No Dtls Cmb3XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 07/18/22  Time  : 09:40:41
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDMRREL1IF  E           K        DISK
      * RTV : Export Doc Order Hdr      Retrieval index
      *
     FPDMSREL5IF  E           K        DISK
      * RSQ : Export Doc Order Dtl      Co/Ord/Doc/Country/Item
      *
     I@MRREWT
      * Export Doc Order Hdr      Retrieval index
      * Renamed input format fields
     I              MRAIC3                          WAAIC3
     I              MRC4NB                          WAC4NB
     I              MRDGSX                          WADGSX
     I              MRKXCD                          WAKXCD
     I              MRZMCD                          WAZMCD
     I              MRPSTX                          WAPSTX
     I              MRPUTX                          WAPUTX
     I              MRPVTX                          WAPVTX
     I              MRPWTX                          WAPWTX
     I              MRRVTX                          WARVTX
     I              MRPPU1                          WAPPU1
     I              MRZ7AA                          WAZ7AA
     I              MRPDU1                          WAPDU1
     I              MRZ8AA                          WAZ8AA
     I              MRRHTX                          WARHTX
     I              MRRITX                          WARITX
     I              MRRJTX                          WARJTX
     I              MRSCTX                          WASCTX
     I              MRSDTX                          WASDTX
     I              MRAAAB                          WAAAAB
     I              MRPHU1                          WAPHU1
     I              MRABAB                          WAABAB
     I              MRPXTX                          WAPXTX
     I              MRZOCD                          WAZOCD
     I              MRZNCD                          WAZNCD
     I              MRCSSX                          WACSSX
     I              MRCTSX                          WACTSX
     I              MRCUSX                          WACUSX
     I              MRCVSX                          WACVSX
     I              MRPTTX                          WAPTTX
     I              MRORNA                          WAORNA
     I              MRRKTX                          WARKTX
     I              MRPZTX                          WAPZTX
     I              MRRLTX                          WARLTX
     I              MRP0TX                          WAP0TX
     I              MRP1TX                          WAP1TX
     I              MRP2TX                          WAP2TX
     I              MRP3TX                          WAP3TX
     I              MRP4TX                          WAP4TX
     I              MRP5TX                          WAP5TX
     I              MRP6TX                          WAP6TX
     I              MRYHTX                          WAYHTX
     I              MRYITX                          WAYITX
     I              MRCWSX                          WACWSX
     I              MROUNA                          WAOUNA
     I              MRP7TX                          WAP7TX
     I              MRP9TX                          WAP9TX
     I              MROVNA                          WAOVNA
     I              MRQATX                          WAQATX
     I              MRQBTX                          WAQBTX
     I              MRQCTX                          WAQCTX
     I              MROWNA                          WAOWNA
     I              MROXNA                          WAOXNA
     I              MRABNX                          WAABNX
     I              MRACNX                          WAACNX
     I              MRADNX                          WAADNX
     I              MRQDTX                          WAQDTX
     I              MRQETX                          WAQETX
     I              MROYNA                          WAOYNA
     I              MROZNA                          WAOZNA
     I              MRO0NA                          WAO0NA
     I              MRO1NA                          WAO1NA
     I              MRCXSX                          WACXSX
     I              MRCYSX                          WACYSX
     I              MRAGNX                          WAAGNX
     I              MRCZSX                          WACZSX
     I              MRC0SX                          WAC0SX
     I              MRC1SX                          WAC1SX
     I              MRQFTX                          WAQFTX
     I              MRAHNX                          WAAHNX
     I              MRQGTX                          WAQGTX
     I              MRQHTX                          WAQHTX
     I              MRQITX                          WAQITX
     I              MRQJTX                          WAQJTX
     I              MRQKTX                          WAQKTX
     I              MRQMTX                          WAQMTX
     I              MRQNTX                          WAQNTX
     I              MRQOTX                          WAQOTX
     I              MRQPTX                          WAQPTX
     I              MRQQTX                          WAQQTX
     I              MRQRTX                          WAQRTX
     I              MRQSTX                          WAQSTX
     I              MRQTTX                          WAQTTX
     I              MRQUTX                          WAQUTX
     I              MRQVTX                          WAQVTX
     I              MRQYTX                          WAQYTX
     I              MRQWTX                          WAQWTX
     I              MRQZTX                          WAQZTX
     I              MRAINX                          WAAINX
     I              MRQ1TX                          WAQ1TX
     I              MRQ2TX                          WAQ2TX
     I              MRQ3TX                          WAQ3TX
     I              MRQ4TX                          WAQ4TX
     I              MRQ5TX                          WAQ5TX
     I              MRQ6TX                          WAQ6TX
     I              MRQ7TX                          WAQ7TX
     I              MRQ8TX                          WAQ8TX
     I              MRQ9TX                          WAQ9TX
     I              MRSMTX                          WASMTX
     I              MRZQCD                          WAZQCD
     I              MRZRCD                          WAZRCD
     I              MRA7VL                          WAA7VL
     I              MRA8VL                          WAA8VL
     I              MRC2SX                          WAC2SX
     I              MRC8SX                          WAC8SX
     I              MRHRWG                          WAHRWG
     I              MRBIVL                          WABIVL
     I              MRK2QT                          WAK2QT
     I              MRO5NA                          WAO5NA
     I              MRHSWG                          WAHSWG
     I              MRBJVL                          WABJVL
     I              MRRATX                          WARATX
     I              MRRBTX                          WARBTX
     I              MRRCTX                          WARCTX
     I              MRRDTX                          WARDTX
     I              MRRETX                          WARETX
     I              MRC3SX                          WAC3SX
     I              MRC4SX                          WAC4SX
     I              MRC5SX                          WAC5SX
     I              MRC6SX                          WAC6SX
     I              MRC7SX                          WAC7SX
     I              MRMQDT                          WAMQDT
     I              MRMRDT                          WAMRDT
     I              MRMSDT                          WAMSDT
     I              MRAJNX                          WAAJNX
     I              MRYFTX                          WAYFTX
     I              MRX9TX                          WAX9TX
     I              MRYATX                          WAYATX
     I              MRYBTX                          WAYBTX
     I              MRB5AA                          WAB5AA
     I              MRYCTX                          WAYCTX
     I              MRYDTX                          WAYDTX
     I              MRYETX                          WAYETX
     I              MRB6AA                          WAB6AA
     I              MRPADT                          WAPADT
     I              MRPBDT                          WAPBDT
     I              MRPCDT                          WAPCDT
     I              MRPDDT                          WAPDDT
     I              MRPEDT                          WAPEDT
     I              MRO4SX                          WAO4SX
     I              MRO5SX                          WAO5SX
     I              MRC1T1                          WAC1T1
     I              MRC2T1                          WAC2T1
     I              MRLKSC                          WALKSC
     I              MRLLSC                          WALLSC
     I              MRPIU1                          WAPIU1
     I              MRPJU1                          WAPJU1
     I              MRFFNZ                          WAFFNZ
     I              MRBUDX                          WABUDX
     I              MRUVST                          WAUVST
     I              MRUWST                          WAUWST
     I              MRUXST                          WAUXST
     I              MRVSST                          WAVSST
     I              MRAATM                          WAAATM
     I              MRAYNA                          WAAYNA
     I              MRA0NA                          WAA0NA
     I              MRAXDT                          WAAXDT
      *
     I@MSREEM
      * Export Doc Order Dtl      Co/Ord/Doc/Country/Item
      * Renamed input format fields
     I              MSAIC3                          WBAIC3
     I              MSC4NB                          WBC4NB
     I              MSDGSX                          WBDGSX
     I              MSKXCD                          WBKXCD
     I              MSDPNB                          WBDPNB
     I              MSUENB                          WBUENB
     I              MSDIC7                          WBDIC7
     I              MSO3NA                          WBO3NA
     I              MSO4NA                          WBO4NA
     I              MSRMTX                          WBRMTX
     I              MSPTTX                          WBPTTX
     I              MSHJWG                          WBHJWG
     I              MSHKWG                          WBHKWG
     I              MSRNTX                          WBRNTX
     I              MSAONX                          WBAONX
     I              MSROTX                          WBROTX
     I              MSORNA                          WBORNA
     I              MSAMNX                          WBAMNX
     I              MSANNX                          WBANNX
     I              MSAPNX                          WBAPNX
     I              MSDKPR                          WBDKPR
     I              MSA9VL                          WBA9VL
     I              MSC8SX                          WBC8SX
     I              MSRATX                          WBRATX
     I              MSRBTX                          WBRBTX
     I              MSAJNX                          WBAJNX
     I              MSZWTX                          WBZWTX
     I              MSZXTX                          WBZXTX
     I              MSZYTX                          WBZYTX
     I              MSZZTX                          WBZZTX
     I              MSK0U1                          WBK0U1
     I              MSK1U1                          WBK1U1
     I              MSIJSC                          WBIJSC
     I              MSIKSC                          WBIKSC
     I              MSK2U1                          WBK2U1
     I              MSW0DT                          WBW0DT
     I              MSUVST                          WBUVST
     I              MSUWST                          WBUWST
     I              MSUXST                          WBUXST
     I              MSVSST                          WBVSST
     I              MSAATM                          WBAATM
     I              MSAYNA                          WBAYNA
     I              MSA0NA                          WBA0NA
     I              MSAXDT                          WBAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Export Doc Order Dtl
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  ED Export Document Type
     I                                        7   7 P1DGSX
      * I :  Country Code
     I                                        8  13 P1KXCD
     IP2PARM      DS
      * O :  Page Overflow USR
     I                                        1   1 P2H6SC
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1DGSX    PARM           WP0003  1        ED Export Docum
     C           P1KXCD    PARM           WP0004  6        Country Code
     C           P2H6SC    PARM P2H6SC    WP0005  1        Page Overflow U
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Ext Count No Dtls Cmb3XF
      * Rtv Xlate Desc 2/Cntry RT - Export Doc Order Hdr  * 
     C                     EXSR SARVGN
      * Rtv Count No Dtls Cmb3RT - Export Doc Order Dtl  * 
     C                     EXSR SBRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Xlate Desc 2/Cntry RT - Export Doc Order Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           ED Xlate Desc t
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WADGSX           ED Export Docum
     C                     KFLD           WAKXCD           Country Code
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
     C                     MOVELP1DGSX    WADGSX           ED Export Docum
     C                     MOVELP1KXCD    WAKXCD           Country Code
      * Establish starting position
     C           KRSSA     CHAIN@MRREWT              90    *
      * Data record not found
     C   90                MOVEL'USR2743' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWACVSX    YL0001           ED Xlate Desc t
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Count No Dtls Cmb3RT - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       P2H6SC           Page Overflow U
     C                     Z-ADD*ZERO     YL0002           # of Lines Reqd
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSB02           Order Number
     C           *LIKE     DEFN WBDGSX    WQSB03           ED Export Docum
     C           *LIKE     DEFN WBKXCD    WQSB04           Country Code
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
     C                     KFLD           WQSB03           ED Export Docum
     C                     KFLD           WQSB04           Country Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSB01           Company Number
     C                     Z-ADDP1C4NB    WQSB02           Order Number
     C                     MOVELP1DGSX    WQSB03           ED Export Docum
     C                     MOVELP1KXCD    WQSB04           Country Code
      * Establish starting position
     C           KRSSB     SETLL@MSREEM                    *
     C           KRSSB     READE@MSREEM                  90*
      * Data record not found
     C   90                MOVEL'USR2745' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ED Product Net Weight lbs GT WRK.ZERO
     C           WBHJWG    IFGT WUW0NB                     *IF
      * CASE: DB1.ED Item Code NE LCL.ED Item Code
     C           WBDIC7    IFNE YL0003                     *IF
     C                     Z-ADDWBDIC7    YL0003           ED Item Code
     C                     MOVELWBO4NA    YL0004           ED Item Label L
     C                     MOVELWBRBTX    YL0005           ED Language Xla
      * Determine '# of Lines Reqd to Print'.
      * CASE: *OTHERWISE
     C                     ADD  2         YL0002           # of Lines Reqd
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : DB1.ED Language Xlate Desc is Entered
      *   |- c2    : PAR.ED Xlate Desc to Country is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBK1U1    IFNE *BLANK                     *IF
     C           YL0001    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  2         YL0002           # of Lines Reqd
     C                     END                             *FI
      * Set Overflow On if More Than 9 Detail Lines.
      * CASE: LCL.# of Lines Reqd to Print is GT 9
     C           YL0002    IFGT 9                          *IF
     C                     MOVEL'Y'       P2H6SC           Page Overflow U
      * Quit If >= 12.
      * CASE: LCL.# of Lines Reqd to Print is GE 12
     C           YL0002    IFGE 12                         *IF
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@MSREEM                  90*
     C                     ENDDO
      * USER: Exit processing
      * 1st Page Exception to Print 9th Detail Line if No Label Ln2 or Xl
      * CASE: LCL.# of Lines Reqd to Print is 10
     C           YL0002    IFEQ 10                         *IF
      * CASE:
      *  - c1 OR (c2 AND NOTc3)
      *   |- c1    : LCL.ED Item Label Line 2 is Not Entered
      *   |- c2    : LCL.ED Language Xlate Desc 2 is Not Entered
      *   |- c3    : PAR.ED Xlate Desc to Country is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0004    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           YL0005    IFEQ *BLANK                     *IF
     C           YL0001    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       P2H6SC           Page Overflow U
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAABNX           ED Can. Import
     C                     Z-ADD*ZERO     WAACNX           ED Can. Import
     C                     Z-ADD*ZERO     WAADNX           ED Seaboard Pla
     C                     Z-ADD*ZERO     WAAHNX           ED Plant Contac
     C                     Z-ADD*ZERO     WAAINX           ED Nbr of prods
     C                     Z-ADD*ZERO     WAA7VL           ED Total Unit P
     C                     Z-ADD*ZERO     WAA8VL           ED Invoice Tota
     C                     Z-ADD*ZERO     WAHRWG           ED Total Net We
     C                     Z-ADD*ZERO     WABIVL           ED Total Net We
     C                     Z-ADD*ZERO     WAK2QT           ED Nbr of Packa
     C                     Z-ADD*ZERO     WAHSWG           ED Total Gross
     C                     Z-ADD*ZERO     WABJVL           ED Total Gross
     C                     Z-ADD*ZERO     WAMQDT           ED Export Certi
     C                     Z-ADD*ZERO     WAMRDT           ED Sail Date
     C                     Z-ADD*ZERO     WAMSDT           ED Sworn on Dat
     C                     Z-ADD*ZERO     WAAJNX           ED Consignee Ad
     C                     Z-ADD*ZERO     WAPADT           ED Document Dat
     C                     Z-ADD*ZERO     WAPBDT           ED Packing Date
     C                     Z-ADD*ZERO     WAPCDT           ED Expiration D
     C                     Z-ADD*ZERO     WAPDDT           ED Packing Date
     C                     Z-ADD*ZERO     WAPEDT           ED Unused Date
     C                     Z-ADD*ZERO     WAFFNZ           EDOH Unused Num
     C                     Z-ADD*ZERO     WABUDX           EDOH Unused Dat
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBDIC7           ED Item Code
     C                     Z-ADD*ZERO     WBHJWG           ED Product Net
     C                     Z-ADD*ZERO     WBHKWG           ED Product Net
     C                     Z-ADD*ZERO     WBAONX           ED Product Nbr
     C                     Z-ADD*ZERO     WBAMNX           ED Pieces per B
     C                     Z-ADD*ZERO     WBANNX           ED Bags per Uni
     C                     Z-ADD*ZERO     WBAPNX           ED Total Nbr of
     C                     Z-ADD*ZERO     WBDKPR           ED Product Unit
     C                     Z-ADD*ZERO     WBA9VL           ED Producet Ext
     C                     Z-ADD*ZERO     WBAJNX           ED Consignee Ad
     C                     Z-ADD*ZERO     WBW0DT           ED Nbr of Packi
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
     C                     MOVEL'N'       W0PMT   1
      * Define local work field ED Xlate Desc to Country
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field # of Lines Reqd to Print
     C                     Z-ADD*ZERO     YL0002  30
      * Define local work field ED Item Code
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field ED Item Label Line 2
     C                     MOVEL*BLANK    YL0004 32
      * Define local work field ED Language Xlate Desc 2
     C                     MOVEL*BLANK    YL0005 25
      *================================================================
     CSR         ZZEXIT    ENDSR
