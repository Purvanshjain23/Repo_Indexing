     H/TITLE Prt Audit Data f/Ord  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSGOYA
     H* Date          : 04/17/25  Time  : 01:04:39
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FPMAFCPL0IF  E           K        DISK                      A
      * UPD : WF Invoice/Combine Drv    Update index
      *
     FPDJ4CPL0IF  E           K        DISK                      A
      * UPD : WF Invoice List Work      Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                          WBBKC7
     I              NEUFTX                          WBUFTX
     I              NEUGTX                          WBUGTX
     I              NEPFNA                          WBPFNA
     I              NEJ5NX                          WBJ5NX
     I              NEU5TX                          WBU5TX
     I              NEU6TX                          WBU6TX
     I              NEW0TX                          WBW0TX
     I              NEHSSX                          WBHSSX
     I              NEHUSX                          WBHUSX
     I              NEHVSX                          WBHVSX
     I              NEAAC8                          WBAAC8
     I              NEP0SX                          WBP0SX
     I              NEP1SX                          WBP1SX
     I              NEP2SX                          WBP2SX
     I              NEP3SX                          WBP3SX
     I              NEP4SX                          WBP4SX
     I              NEP5SX                          WBP5SX
     I              NEP6SX                          WBP6SX
     I              NEUVST                          WBUVST
     I              NEUWST                          WBUWST
     I              NEUXST                          WBUXST
     I              NEVSST                          WBVSST
     I              NEAATM                          WBAATM
     I              NEAYNA                          WBAYNA
     I              NEA0NA                          WBA0NA
     I              NEAXDT                          WBAXDT
      *
     I@AFCPHT
      * WF Invoice/Combine Drv    Update index
      * Renamed input format fields
     I              AFB2VN                          WCB2VN
     I              AFDJVN                          WCDJVN
     I              AFC4NB                          WCC4NB
     I              AFAETX                          WCAETX
     I              AFJZVA                          WCJZVA
     I              AFA1WG                          WCA1WG
     I              AFBRTX                          WCBRTX
     I              AFRLST                          WCRLST
     I              AFHUSX                          WCHUSX
     I              AFBCNA                          WCBCNA
     I              AFA8TX                          WCA8TX
     I              AFBETX                          WCBETX
     I              AFGNDT                          WCGNDT
     I              AFBKC7                          WCBKC7
     I              AFEMC7                          WCEMC7
     I              AFAIC3                          WCAIC3
     I              AFCONB                          WCCONB
     I              AFCEST                          WCCEST
     I              AFVSST                          WCVSST
     I              AFMJDT                          WCMJDT
     I              AFBETM                          WCBETM
     I              AFCCVN                          WCCCVN
     I              AFCDVN                          WCCDVN
     I              AFMKDT                          WCMKDT
     I              AFBFTM                          WCBFTM
     I              AFCEVN                          WCCEVN
     I              AFCFVN                          WCCFVN
      *
     I@J4CPDG
      * WF Invoice List Work      Update index
      * Renamed input format fields
     I              J4B2VN                          WDB2VN
     I              J4C4NB                          WDC4NB
     I              J4JZVA                          WDJZVA
     I              J4A1WG                          WDA1WG
     I              J4BRTX                          WDBRTX
     I              J4AETX                          WDAETX
     I              J4RLST                          WDRLST
     I              J4CBC7                          WDCBC7
     I              J4BKC7                          WDBKC7
     I              J4AIC3                          WDAIC3
     I              J4CONB                          WDCONB
     I              J4CEST                          WDCEST
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPMAF1    E DSPMAFCPL0
      * UPD : WF Invoice/Combine Drv    Update index
      * Renamed input format fields
     I              AFB2VN                          WCB2VN
     I              AFDJVN                          WCDJVN
     I              AFC4NB                          WCC4NB
     I              AFAETX                          WCAETX
     I              AFJZVA                          WCJZVA
     I              AFA1WG                          WCA1WG
     I              AFBRTX                          WCBRTX
     I              AFRLST                          WCRLST
     I              AFHUSX                          WCHUSX
     I              AFBCNA                          WCBCNA
     I              AFA8TX                          WCA8TX
     I              AFBETX                          WCBETX
     I              AFGNDT                          WCGNDT
     I              AFBKC7                          WCBKC7
     I              AFEMC7                          WCEMC7
     I              AFAIC3                          WCAIC3
     I              AFCONB                          WCCONB
     I              AFCEST                          WCCEST
     I              AFVSST                          WCVSST
     I              AFMJDT                          WCMJDT
     I              AFBETM                          WCBETM
     I              AFCCVN                          WCCCVN
     I              AFCDVN                          WCCDVN
     I              AFMKDT                          WCMKDT
     I              AFBFTM                          WCBFTM
     I              AFCEVN                          WCCEVN
     I              AFCFVN                          WCCFVN
      *
     IQPDJ41    E DSPDJ4CPL0
      * UPD : WF Invoice List Work      Update index
      * Renamed input format fields
     I              J4B2VN                          WDB2VN
     I              J4C4NB                          WDC4NB
     I              J4JZVA                          WDJZVA
     I              J4A1WG                          WDA1WG
     I              J4BRTX                          WDBRTX
     I              J4AETX                          WDAETX
     I              J4RLST                          WDRLST
     I              J4CBC7                          WDCBC7
     I              J4BKC7                          WDBKC7
     I              J4AIC3                          WDAIC3
     I              J4CONB                          WDCONB
     I              J4CEST                          WDCEST
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
     IP2PARM      DS
      * FLD: *Arrays
      * N :  PRT Description
     I                                        1  25 P2G3TX
      * B :  PRT Printer Device
     I                                       26  35 P2WRST
      * B :  PRT Hold Output Sts
     I                                       36  39 P2WSST
      * B :  PRT Save Output Sts
     I                                       40  43 P2WTST
      * B :  PRT Number of Copies
     I                                       44  450P2DYNB
      * B :  PRT Night Queue Run Sts
     I                                       46  46 P2WUST
      * B :  PRT Night Queue
     I                                       47  56 P2BVVN
      * N :  Company Number Pass   USR
     I                                    P  57  645P2AJAA
      * N :  Order Number 1  PASS  USR
     I                                    P  65  725P2AJAE
      * N :  Order Number 2  PASS  USR
     I                                    P  73  805P2AJAF
      * N :  System Value Numeric
     I                                    P  81  885P2M8NB
     IP3PARM      DS
      * N :  Job Number USR
     I                                        1   6 P3HAAA
     IP4PARM      DS
      * N :  Job Name CDE
     I                                        1  10 P4B2VN
     IP5PARM      DS
      * FLD: MPR Wholesale Pork Daily
      * I :  MPR Identification Num
     I                                        1   5 P5PWAA
      * I :  MPR Reporting Date
     I                                    P   6   90P5UTDT
      * I :  MPR Reporting Time
     I                                    P  10  100P5V0NY
      * I :  MPR Lot Identification
     I                                       11  35 P5ZBT1
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P2WRST    PARM P2WRST    WP0003 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WP0004  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WP0005  4        PRT Save Output
     C           P2DYNB    PARM P2DYNB    WP0006  20       PRT Number of C
     C           P2WUST    PARM P2WUST    WP0007  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WP0008 10        PRT Night Queue
     C           P5PWAA    PARM           WP0009  5        MPR Identificat
     C           P5UTDT    PARM           WP0010  70       MPR Reporting D
     C           P5V0NY    PARM           WP0011  10       MPR Reporting T
     C           P5ZBT1    PARM           WP0012 25        MPR Lot Identif
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Audit Data f/Ord  XF
     C                     Z-ADDP2DYNB    P2M8NB           System Value Nu
     C                     Z-ADDP1AIC3    P2AJAA           Company Number
     C                     Z-ADDP1C4NB    P2AJAE           Order Number 1
     C                     Z-ADDP1C4NB    P2AJAF           Order Number 2
      * *** Get all OH fields
      * RTV All Fields         RT - Order Header TRG  * 
     C                     EXSR SARVGN
      * *** Print Order and Price Audit Change Logs
      * *** Print all Accruals for order
      * *** Print MPR Records for order sent in PBAOCPP
      * PRT MPR Ord Audit Dta UP - MPR Wholesale Pork Daily  * 
     C                     CALL 'PBGBUPC'              90  PRT MPR Ord Aud
     C           YL0125    PARM *BLANK    WQ0001  7        Return Code Usr
     C                     PARM P2WRST    WQ0002 10        PRT Printer Dev
     C                     PARM P2WSST    WQ0003  4        PRT Hold Output
     C                     PARM P2WTST    WQ0004  4        PRT Save Output
     C                     PARM P2AJAA    WQ0005 155       Company Number
     C                     PARM P2AJAE    WQ0006 155       Order Number 1
     C                     PARM P2M8NB    WQ0007 155       System Value Nu
     C                     PARM P5PWAA    WQ0008  5        MPR Identificat
     C                     PARM P5UTDT    WQ0009  70       MPR Reporting D
     C                     PARM P5V0NY    WQ0010  10       MPR Reporting T
     C                     PARM P5ZBT1    WQ0011 25        MPR Lot Identif
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBGBUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * E2176 SLM 03/14/2013 due to parms only pass as blanks
      * *** Print Order Ack
      * PRT Acknowledgements UP - Order Header TRG  * 
     C                     CALL 'PDJWPCLP'             90  PRT Acknowledge
     C                     PARM P2AJAA    WQ0012 155       Company Number
     C                     PARM P2AJAE    WQ0013 155       Order Number 1
     C                     PARM P2AJAF    WQ0014 155       Order Number 2
     C                     PARM *ZERO     WQ0015 155       Date 1
     C                     PARM *ZERO     WQ0016 155       Date 2
     C                     PARM *ZERO     WQ0017 155       Thru Date Pass
     C                     PARM *BLANK    WQ0018  2        Order Type_Sale
     C                     PARM YL0055    WQ0019  2        Shipping Method
     C                     PARM '1'       WQ0020  1        Billing Activit
     C                     PARM 'A'       WQ0021  1        Export Sales
     C                     PARM *BLANK    WQ0022  3        USR Warehouse C
     C                     PARM *BLANK    WQ0023  3        USR CDE Parm 1
     C                     PARM *BLANK    WQ0024  3        USR CDE Parm 2
     C                     PARM *BLANK    WQ0025  3        USR CDE Parm 3
     C                     PARM *BLANK    WQ0026  3        USR CDE Parm 4
     C                     PARM *BLANK    WQ0027  3        USR CDE Parm 5
     C                     PARM *BLANK    WQ0028  3        USR CDE Parm 6
     C                     PARM *BLANK    WQ0029  3        USR CDE Parm 7
     C                     PARM *BLANK    WQ0030  3        USR CDE Parm 8
     C                     PARM *BLANK    WQ0031  3        USR CDE Parm 9
     C                     PARM YL0126    WQ0032  1        USR Select/Omit
     C                     PARM P2WRST    WQ0033 10        PRT Printer Dev
     C                     PARM P2WSST    WQ0034  4        PRT Hold Output
     C                     PARM P2WTST    WQ0035  4        PRT Save Output
     C                     PARM P2M8NB    WQ0036 155       System Value Nu
     C                     PARM P2BVVN    WQ0037 10        PRT Night Queue
     C                     PARM *ZERO     WQ0038 155       Date 3
     C                     PARM *BLANK    WQ0039  1        Email To Whs
     C                     PARM *BLANK    WQ0040  3        Email to Wareho
     C                     PARM 'N'       WQ0041  1        Email to Salesp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJWPCLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * *** Print Order Invoice
     C                     MOVEL@CN,001   YL0127           Program name US
     C                     MOVEL'R'       YL0128           Reprint Status
     C                     Z-ADDYL0011    YL0129           A/R Customer Nu
     C                     MOVEL##JOB     P4B2VN           Job Name CDE
      * Rtv One Invoice /PO   RT - Customer EXT  * 
     C                     EXSR SBRVGN
      * Crt Combo or Standard invoice work file record
      * CASE: LCL.One Invoice Per PO is Yes
     C           YL0130    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    P3HAAA           Job Number USR
     C                     MOVEL##JNO     P3HAAA           Job Number USR
      * Crt WF Invoice/Combine CR - WF Invoice/Combine Drv  * 
     C                     EXSR SCCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
     C                     EXSR SDCRRC
     C                     END                             *FI
      * ** Call PDTLUPR PRT Invc/Pre-Invc Reg UP to submit reprint pgm
      * PRT Invc/Pre-Invc Reg  UP - /UT User Programs  * 
     C                     CALL 'PDTLUPR'              90  PRT Invc/Pre-In
     C           W0RTN     PARM *BLANK    WQ0042  7        *Return code
     C                     PARM YL0127    WQ0043 10        Program name US
     C                     PARM P4B2VN    WQ0044 10        Program Name$ U
     C                     PARM 'OMS'     WQ0045  6        Application Cod
     C                     PARM P4B2VN    WQ0046 10        Job Name CDE
     C                     PARM P3HAAA    WQ0047  6        Job Number USR
     C                     PARM YL0082    WQ0048  1        Billing Activit
     C                     PARM @CN,002   WQ0049 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0050 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0051  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0052  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0053  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0054 10        PRT Night Queue
     C                     PARM P2AJAA    WQ0055 155       Company Number
     C                     PARM *ZERO     WQ0056 155       Thru Date Pass
     C                     PARM *ZERO     WQ0057 155       Order Number 1
     C                     PARM P2AJAF    WQ0058 155       Order Number 2
     C           P2M8NB    PARM P2M8NB    WQ0059 155       System Value Nu
     C           YL0128    PARM YL0128    WQ0060  1        USR Active Flag
     C                     PARM 'N'       WQ0061  1        USR Print Pre-I
     C                     PARM 'N'       WQ0062  1        USR Print Pre-I
     C                     PARM 'I'       WQ0063  1        Invoice/Pre-Inv
     C                     PARM YL0129    WQ0064 155       A/R Customer Nu
     C                     PARM 'OR'      WQ0065  2        Process Cust Ty
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTLUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV All Fields         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSA     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Order Type_Sale
     C                     Z-ADD*ZERO     YL0002           AR Customer Num
     C                     Z-ADD*ZERO     YL0003           Ship To Custome
     C                     MOVEL*BLANK    YL0004           Ship To Name
     C                     MOVEL*BLANK    YL0005           Ship To Address
     C                     MOVEL*BLANK    YL0006           Ship To Address
     C                     MOVEL*BLANK    YL0007           Ship To Address
     C                     MOVEL*BLANK    YL0008           Ship To City
     C                     MOVEL*BLANK    YL0009           Ship To State C
     C                     MOVEL*BLANK    YL0010           Ship To Zip_Pos
     C                     Z-ADD*ZERO     YL0011           Bill to Custome
     C                     MOVEL*BLANK    YL0012           Bill to Name
     C                     MOVEL*BLANK    YL0013           Bill to Address
     C                     MOVEL*BLANK    YL0014           Bill to Address
     C                     MOVEL*BLANK    YL0015           Bill to Address
     C                     MOVEL*BLANK    YL0016           Bill to City
     C                     MOVEL*BLANK    YL0017           Bill to State C
     C                     MOVEL*BLANK    YL0018           Bill to Zip_Pos
     C                     MOVEL*BLANK    YL0019           Customer Purcha
     C                     Z-ADD*ZERO     YL0020           Order Date
     C                     Z-ADD*ZERO     YL0021           Requested Ship
     C                     Z-ADD*ZERO     YL0022           Actual Shipped
     C                     Z-ADD*ZERO     YL0023           Cancel Date
     C                     MOVEL*BLANK    YL0024           Terms Code
     C                     MOVEL*BLANK    YL0025           Special Instruc
     C                     MOVEL*BLANK    YL0026           Special Instruc
     C                     MOVEL*BLANK    YL0027           Carrier Code
     C                     MOVEL*BLANK    YL0028           Comment Print A
     C                     MOVEL*BLANK    YL0029           Comment Print I
     C                     MOVEL*BLANK    YL0030           Comment Print P
     C                     MOVEL*BLANK    YL0031           Comment Print S
     C                     MOVEL*BLANK    YL0032           Reason Code
     C                     MOVEL*BLANK    YL0033           Order in Use
     C                     MOVEL*BLANK    YL0034           Header Status
     C                     MOVEL*BLANK    YL0035           Header Status L
     C                     MOVEL*BLANK    YL0036           Order Type Prin
     C                     Z-ADD*ZERO     YL0037           Scheduled Ship
     C                     MOVEL*BLANK    YL0038           User Original E
     C                     Z-ADD*ZERO     YL0039           Date of Origina
     C                     Z-ADD*ZERO     YL0040           Order Value Tot
     C                     Z-ADD*ZERO     YL0041           Order Weight To
     C                     MOVEL*BLANK    YL0042           Credit Hold
     C                     MOVEL*BLANK    YL0043           Production Hold
     C                     MOVEL*BLANK    YL0044           New Customer Ho
     C                     Z-ADD*ZERO     YL0045           Requested Deliv
     C                     Z-ADD*ZERO     YL0046           Requested Deliv
     C                     MOVEL*BLANK    YL0047           Accounts Receiv
     C                     MOVEL*BLANK    YL0048           Accounts Receiv
     C                     Z-ADD*ZERO     YL0049           Load ID
     C                     Z-ADD*ZERO     YL0050           Absorbed Freigh
     C                     Z-ADD*ZERO     YL0051           Rated Freight
     C                     MOVEL*BLANK    YL0052           LTL Flag
     C                     MOVEL*BLANK    YL0053           Price Audit
     C                     MOVEL*BLANK    YL0054           Price Status
     C                     MOVEL*BLANK    YL0055           Shipping Method
     C                     MOVEL*BLANK    YL0056           Export Status
     C                     MOVEL*BLANK    YL0057           Palletize
     C                     MOVEL*BLANK    YL0058           Shrink Wrap
     C                     MOVEL*BLANK    YL0059           Slip Sheet
     C                     MOVEL*BLANK    YL0060           Age Code
     C                     Z-ADD*ZERO     YL0061           Reefer Temperat
     C                     MOVEL*BLANK    YL0062           Load Type
     C                     Z-ADD*ZERO     YL0063           Attach to Invoi
     C                     MOVEL*BLANK    YL0064           Load Plan Order
     C                     MOVEL*BLANK    YL0065           Print Pick Slip
     C                     Z-ADD*ZERO     YL0066           Resell Referenc
     C                     MOVEL*BLANK    YL0067           Special Comment
     C                     MOVEL*BLANK    YL0068           Special Comment
     C                     MOVEL*BLANK    YL0069           Affect Auto Acc
     C                     MOVEL*BLANK    YL0070           Sales Route Cod
     C                     MOVEL*BLANK    YL0071           Manager Level C
     C                     MOVEL*BLANK    YL0072           VP Level Code
     C                     Z-ADD*ZERO     YL0073           Attach to Order
     C                     MOVEL*BLANK    YL0074           Reason for Pric
     C                     Z-ADD*ZERO     YL0075           Invoice Number
     C                     MOVEL*BLANK    YL0076           Invoice Suffix
     C                     Z-ADD*ZERO     YL0077           Invoice Date
     C                     MOVEL*BLANK    YL0078           Event Code
     C                     MOVEL*BLANK    YL0079           Trans Contol AS
     C                     MOVEL*BLANK    YL0080           Modified Flag
     C                     Z-ADD*ZERO     YL0081           A_R order Value
     C                     MOVEL*BLANK    YL0082           Billing Activit
     C                     MOVEL*BLANK    YL0083           Block Order Fla
     C                     MOVEL*BLANK    YL0084           Order Certifica
     C                     Z-ADD*ZERO     YL0085           Invoice Order V
     C                     MOVEL*BLANK    YL0086           Process Sts for
     C                     MOVEL*BLANK    YL0087           Order Conf Fax
     C                     MOVEL*BLANK    YL0088           Manifest Fax St
     C                     MOVEL*BLANK    YL0089           Invoice Fax Sts
     C                     MOVEL*BLANK    YL0090           Transfer in Sto
     C                     MOVEL*BLANK    YL0091           Email Cust On O
     C                     MOVEL*BLANK    YL0092           Order Emailed
     C                     MOVEL*BLANK    YL0093           Export Docs Go
     C                     MOVEL*BLANK    YL0094           Shipping Temp C
     C                     MOVEL*BLANK    YL0095           Broker Order St
     C                     MOVEL*BLANK    YL0096           Air Freight Ord
     C                     MOVEL*BLANK    YL0097           Order Requires
     C                     MOVEL*BLANK    YL0098           OH Load Plan Re
     C                     MOVEL*BLANK    YL0099           Export USDA App
     C                     MOVEL*BLANK    YL0100           HPB Ship to War
     C                     MOVEL*BLANK    YL0101           OH TF Exempt Co
     C                     Z-ADD*ZERO     YL0102           OH Appt Confirm
     C                     Z-ADD*ZERO     YL0103           JPN Invoice Iss
     C                     Z-ADD*ZERO     YL0104           Load Actual Shi
     C                     Z-ADD*ZERO     YL0105           Load BOL Comple
     C                     Z-ADD*ZERO     YL0106           Load Truck Depa
     C                     Z-ADD*ZERO     YL0107           Maximum Gross W
     C                     Z-ADD*ZERO     YL0108           Time of Origina
     C                     Z-ADD*ZERO     YL0109           OH Appt Confirm
     C                     Z-ADD*ZERO     YL0110           Load BOL Comple
     C                     Z-ADD*ZERO     YL0111           Load Truck Depa
     C                     Z-ADD*ZERO     YL0112           Act Frt Referen
     C                     Z-ADD*ZERO     YL0113           Act Non_Ref Frt
     C                     Z-ADD*ZERO     YL0114           OH Fuel Surchar
     C                     Z-ADD*ZERO     YL0115           OH Total Non_Re
     C                     Z-ADD*ZERO     YL0116           OH Total Ref Fr
     C                     Z-ADD*ZERO     YL0117           Claim Number
     C                     MOVEL*BLANK    YL0118           EDI Status 1
     C                     MOVEL*BLANK    YL0119           EDI Status 2
     C                     MOVEL*BLANK    YL0120           EDI Status 3
     C                     Z-ADD*ZERO     YL0121           Job Time
     C                     MOVEL*BLANK    YL0122           User Id
     C                     MOVEL*BLANK    YL0123           Job Name
     C                     Z-ADD*ZERO     YL0124           Job Date
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAJNCD    YL0001           Order Type_Sale
     C                     Z-ADDWAANC7    YL0002           AR Customer Num
     C                     Z-ADDWABKC7    YL0003           Ship To Custome
     C                     MOVELWABRTX    YL0004           Ship To Name
     C                     MOVELWAHMNA    YL0005           Ship To Address
     C                     MOVELWAHONA    YL0006           Ship To Address
     C                     MOVELWAHPNA    YL0007           Ship To Address
     C                     MOVELWAHNNA    YL0008           Ship To City
     C                     MOVELWADBCD    YL0009           Ship To State C
     C                     MOVELWACKTX    YL0010           Ship To Zip_Pos
     C                     Z-ADDWAB0C7    YL0011           Bill to Custome
     C                     MOVELWAAETX    YL0012           Bill to Name
     C                     MOVELWAB1NA    YL0013           Bill to Address
     C                     MOVELWAB3NA    YL0014           Bill to Address
     C                     MOVELWAB4NA    YL0015           Bill to Address
     C                     MOVELWAB2NA    YL0016           Bill to City
     C                     MOVELWABHCD    YL0017           Bill to State C
     C                     MOVELWAC8TX    YL0018           Bill to Zip_Pos
     C                     MOVELWABCNA    YL0019           Customer Purcha
     C                     Z-ADDWAA0DT    YL0020           Order Date
     C                     Z-ADDWAA5DT    YL0021           Requested Ship
     C                     Z-ADDWAGNDT    YL0022           Actual Shipped
     C                     Z-ADDWAACDT    YL0023           Cancel Date
     C                     MOVELWAAQCD    YL0024           Terms Code
     C                     MOVELWAB6NA    YL0025           Special Instruc
     C                     MOVELWABYNA    YL0026           Special Instruc
     C                     MOVELWABZNA    YL0027           Carrier Code
     C                     MOVELWAGTST    YL0028           Comment Print A
     C                     MOVELWAGVST    YL0029           Comment Print I
     C                     MOVELWAGUST    YL0030           Comment Print P
     C                     MOVELWAQFST    YL0031           Comment Print S
     C                     MOVELWACQCD    YL0032           Reason Code
     C                     MOVELWAGJST    YL0033           Order in Use
     C                     MOVELWAGWST    YL0034           Header Status
     C                     MOVELWAGXST    YL0035           Header Status L
     C                     MOVELWAGYST    YL0036           Order Type Prin
     C                     Z-ADDWAAODT    YL0037           Scheduled Ship
     C                     MOVELWAAIVN    YL0038           User Original E
     C                     Z-ADDWACXDT    YL0039           Date of Origina
     C                     Z-ADDWAJZVA    YL0040           Order Value Tot
     C                     Z-ADDWAA1WG    YL0041           Order Weight To
     C                     MOVELWAXIST    YL0042           Credit Hold
     C                     MOVELWAXJST    YL0043           Production Hold
     C                     MOVELWAXKST    YL0044           New Customer Ho
     C                     Z-ADDWAEIDT    YL0045           Requested Deliv
     C                     Z-ADDWAAFTM    YL0046           Requested Deliv
     C                     MOVELWAE8CD    YL0047           Accounts Receiv
     C                     MOVELWAE9CD    YL0048           Accounts Receiv
     C                     Z-ADDWARMNB    YL0049           Load ID
     C                     Z-ADDWATBNB    YL0050           Absorbed Freigh
     C                     Z-ADDWAR1NB    YL0051           Rated Freight
     C                     MOVELWAPJST    YL0052           LTL Flag
     C                     MOVELWAU0ST    YL0053           Price Audit
     C                     MOVELWAU1ST    YL0054           Price Status
     C                     MOVELWAQ2CD    YL0055           Shipping Method
     C                     MOVELWAU2ST    YL0056           Export Status
     C                     MOVELWAVEST    YL0057           Palletize
     C                     MOVELWAVFST    YL0058           Shrink Wrap
     C                     MOVELWAVGST    YL0059           Slip Sheet
     C                     MOVELWARPCD    YL0060           Age Code
     C                     Z-ADDWARNNB    YL0061           Reefer Temperat
     C                     MOVELWAVDST    YL0062           Load Type
     C                     Z-ADDWAATIN    YL0063           Attach to Invoi
     C                     MOVELWAU4ST    YL0064           Load Plan Order
     C                     MOVELWAU5ST    YL0065           Print Pick Slip
     C                     Z-ADDWARSRN    YL0066           Resell Referenc
     C                     MOVELWAMHNA    YL0067           Special Comment
     C                     MOVELWAMINA    YL0068           Special Comment
     C                     MOVELWAWBST    YL0069           Affect Auto Acc
     C                     MOVELWAR4CD    YL0070           Sales Route Cod
     C                     MOVELWABFCD    YL0071           Manager Level C
     C                     MOVELWAQ4CD    YL0072           VP Level Code
     C                     Z-ADDWAT3NB    YL0073           Attach to Order
     C                     MOVELWASICD    YL0074           Reason for Pric
     C                     Z-ADDWACONB    YL0075           Invoice Number
     C                     MOVELWACEST    YL0076           Invoice Suffix
     C                     Z-ADDWAAWDT    YL0077           Invoice Date
     C                     MOVELWAJPCD    YL0078           Event Code
     C                     MOVELWAXUST    YL0079           Trans Contol AS
     C                     MOVELWAZ1ST    YL0080           Modified Flag
     C                     Z-ADDWAVRVA    YL0081           A_R order Value
     C                     MOVELWAOBST    YL0082           Billing Activit
     C                     MOVELWABCST    YL0083           Block Order Fla
     C                     MOVELWABDST    YL0084           Order Certifica
     C                     Z-ADDWAB7VL    YL0085           Invoice Order V
     C                     MOVELWAGASX    YL0086           Process Sts for
     C                     MOVELWAGBSX    YL0087           Order Conf Fax
     C                     MOVELWAGCSX    YL0088           Manifest Fax St
     C                     MOVELWAGDSX    YL0089           Invoice Fax Sts
     C                     MOVELWAFNSX    YL0090           Transfer in Sto
     C                     MOVELWAFOSX    YL0091           Email Cust On O
     C                     MOVELWAFPSX    YL0092           Order Emailed
     C                     MOVELWAFQSX    YL0093           Export Docs Go
     C                     MOVELWAFRSX    YL0094           Shipping Temp C
     C                     MOVELWAFSSX    YL0095           Broker Order St
     C                     MOVELWAFTSX    YL0096           Air Freight Ord
     C                     MOVELWAFUSX    YL0097           Order Requires
     C                     MOVELWAFVSX    YL0098           OH Load Plan Re
     C                     MOVELWAFWSX    YL0099           Export USDA App
     C                     MOVELWAFXSX    YL0100           HPB Ship to War
     C                     MOVELWAFYSX    YL0101           OH TF Exempt Co
     C                     Z-ADDWANODT    YL0102           OH Appt Confirm
     C                     Z-ADDWANPDT    YL0103           JPN Invoice Iss
     C                     Z-ADDWANQDT    YL0104           Load Actual Shi
     C                     Z-ADDWANRDT    YL0105           Load BOL Comple
     C                     Z-ADDWANSDT    YL0106           Load Truck Depa
     C                     Z-ADDWABPTM    YL0107           Maximum Gross W
     C                     Z-ADDWABQTM    YL0108           Time of Origina
     C                     Z-ADDWABRTM    YL0109           OH Appt Confirm
     C                     Z-ADDWABSTM    YL0110           Load BOL Comple
     C                     Z-ADDWABTTM    YL0111           Load Truck Depa
     C                     Z-ADDWAH0NX    YL0112           Act Frt Referen
     C                     Z-ADDWAH1NX    YL0113           Act Non_Ref Frt
     C                     Z-ADDWAH2NX    YL0114           OH Fuel Surchar
     C                     Z-ADDWAH3NX    YL0115           OH Total Non_Re
     C                     Z-ADDWAH4NX    YL0116           OH Total Ref Fr
     C                     Z-ADDWAC0C7    YL0117           Claim Number
     C                     MOVELWAUVST    YL0118           EDI Status 1
     C                     MOVELWAUWST    YL0119           EDI Status 2
     C                     MOVELWAUXST    YL0120           EDI Status 3
     C                     Z-ADDWAAATM    YL0121           Job Time
     C                     MOVELWAAYNA    YL0122           User Id
     C                     MOVELWAA0NA    YL0123           Job Name
     C                     Z-ADDWAAXDT    YL0124           Job Date
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv One Invoice /PO   RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDYL0003    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSB     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0130           One Invoice Per
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBHUSX    YL0130           One Invoice Per
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * Crt WF Invoice/Combine CR - WF Invoice/Combine Drv  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Create Date
     C                     Z-ADD*ZERO     WN0002  60       Create Time
     C                     MOVEL*BLANK    WN0003 10        Create User
     C                     MOVEL*BLANK    WN0004 10        Create Program
     C                     Z-ADD*ZERO     WN0005  70       Change Date
     C                     Z-ADD*ZERO     WN0006  60       Change Time
     C                     MOVEL*BLANK    WN0007 10        Change User
     C                     MOVEL*BLANK    WN0008 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AFCPHT
     C                     MOVELP4B2VN    WCB2VN           Job Name CDE
     C                     MOVELP3HAAA    WCDJVN           Job Number Cde
     C                     Z-ADDP1C4NB    WCC4NB           Order Number
     C                     MOVELYL0012    WCAETX           Bill to Name
     C                     Z-ADDYL0040    WCJZVA           Order Value Tot
     C                     Z-ADDYL0041    WCA1WG           Order Weight To
     C                     MOVELYL0004    WCBRTX           Ship To Name
     C                     MOVEL'N'       WCRLST           Fax Invoice Fla
     C                     MOVELYL0130    WCHUSX           One Invoice Per
     C                     MOVELYL0019    WCBCNA           Customer Purcha
     C                     MOVEL'N'       WCA8TX           Combine Invoice
     C                     MOVELYL0082    WCBETX           WF Inv_Comb Bil
     C                     Z-ADDYL0022    WCGNDT           Actual Shipped
     C                     Z-ADDYL0003    WCBKC7           Ship To Custome
     C                     Z-ADDYL0011    WCEMC7           Bill to Custome
     C                     Z-ADDP1AIC3    WCAIC3           Company Number
     C                     Z-ADDYL0075    WCCONB           Invoice Number
     C                     MOVELYL0076    WCCEST           Invoice Suffix
     C                     MOVEL'A'       WCVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WCVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WCMJDT           Create Date
     C                     Z-ADD##JTM     WCBETM           Create Time
     C                     MOVEL##USR     WCCCVN           Create User
     C                     MOVEL##PGM     WCCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
     C                     MOVEL*BLANK    WCCEVN           Change User
     C                     MOVEL*BLANK    WCCFVN           Change Program
     C           KLCRSC    KLIST
     C                     KFLD           WCB2VN           Job Name CDE
     C                     KFLD           WCDJVN           Job Number Cde
     C                     KFLD           WCC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSC    SETLL@AFCPHT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3672' W0RTN   7
      * Send message 'WF Invoice/Combine Drv EX'
     C                     MOVEL'USR3672' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@AFCPHT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @J4CPDG
     C                     MOVELP4B2VN    WDB2VN           Job Name CDE
     C                     Z-ADDP1C4NB    WDC4NB           Order Number
     C                     Z-ADDYL0040    WDJZVA           Order Value Tot
     C                     Z-ADDYL0041    WDA1WG           Order Weight To
     C                     MOVELYL0004    WDBRTX           Ship To Name
     C                     MOVELYL0012    WDAETX           Bill to Name
     C                     MOVEL'N'       WDRLST           Fax Invoice Fla
     C                     Z-ADDYL0003    WDCBC7           Ship to Custome
     C                     Z-ADDYL0002    WDBKC7           Ship To Custome
     C                     Z-ADDP1AIC3    WDAIC3           Company Number
     C                     Z-ADDYL0075    WDCONB           Invoice Number
     C                     MOVELYL0076    WDCEST           Invoice Suffix
      *
     C           KLCRSD    KLIST
     C                     KFLD           WDB2VN           Job Name CDE
     C                     KFLD           WDC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSD    SETLL@J4CPDG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2069' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@J4CPDG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2G3TX           PRT Description
     C                     Z-ADD*ZERO     P2AJAA           Company Number
     C                     Z-ADD*ZERO     P2AJAE           Order Number 1
     C                     Z-ADD*ZERO     P2AJAF           Order Number 2
     C                     Z-ADD*ZERO     P2M8NB           System Value Nu
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3HAAA           Job Number USR
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4B2VN           Job Name CDE
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A_R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBAAC8           Customer G_L Ve
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WCA1WG           Order Weight To
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCEMC7           Bill to Custome
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDCBC7           Ship to Custome
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Order Type_Sales
     C                     MOVEL*BLANK    YL0001  2
      * Define local work field AR Customer Number
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0004 30
      * Define local work field Ship To Address Line 1
     C                     MOVEL*BLANK    YL0005 30
      * Define local work field Ship To Address Line 2
     C                     MOVEL*BLANK    YL0006 30
      * Define local work field Ship To Address Line 3
     C                     MOVEL*BLANK    YL0007 30
      * Define local work field Ship To City
     C                     MOVEL*BLANK    YL0008 20
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0009  2
      * Define local work field Ship To Zip_Postal Code
     C                     MOVEL*BLANK    YL0010 11
      * Define local work field Bill to Customer
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field Bill to Name
     C                     MOVEL*BLANK    YL0012 30
      * Define local work field Bill to Address Line 1
     C                     MOVEL*BLANK    YL0013 30
      * Define local work field Bill to Address Line 2
     C                     MOVEL*BLANK    YL0014 30
      * Define local work field Bill to Address Line 3
     C                     MOVEL*BLANK    YL0015 30
      * Define local work field Bill to City
     C                     MOVEL*BLANK    YL0016 20
      * Define local work field Bill to State Code
     C                     MOVEL*BLANK    YL0017  2
      * Define local work field Bill to Zip_Postal Code
     C                     MOVEL*BLANK    YL0018 11
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0019 15
      * Define local work field Order Date
     C                     Z-ADD*ZERO     YL0020  70
      * Define local work field Requested Ship Date
     C                     Z-ADD*ZERO     YL0021  70
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0022  70
      * Define local work field Cancel Date
     C                     Z-ADD*ZERO     YL0023  70
      * Define local work field Terms Code
     C                     MOVEL*BLANK    YL0024  2
      * Define local work field Special Instructions
     C                     MOVEL*BLANK    YL0025 40
      * Define local work field Special Instructions 2
     C                     MOVEL*BLANK    YL0026 40
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0027  3
      * Define local work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YL0028  1
      * Define local work field Comment Print Inv_Cr_Memo
     C                     MOVEL*BLANK    YL0029  1
      * Define local work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YL0030  1
      * Define local work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field Reason Code
     C                     MOVEL*BLANK    YL0032  3
      * Define local work field Order in Use
     C                     MOVEL*BLANK    YL0033  1
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0034  1
      * Define local work field Header Status Last
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field Order Type Print Status
     C                     MOVEL*BLANK    YL0036  1
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0037  70
      * Define local work field User Original Entry
     C                     MOVEL*BLANK    YL0038 10
      * Define local work field Date of Original Entry
     C                     Z-ADD*ZERO     YL0039  70
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0040 112
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0041 112
      * Define local work field Credit Hold
     C                     MOVEL*BLANK    YL0042  1
      * Define local work field Production Hold
     C                     MOVEL*BLANK    YL0043  1
      * Define local work field New Customer Hold
     C                     MOVEL*BLANK    YL0044  1
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0045  70
      * Define local work field Requested Delivery Time
     C                     Z-ADD*ZERO     YL0046  40
      * Define local work field Accounts Receiv_Ent 1
     C                     MOVEL*BLANK    YL0047  4
      * Define local work field Accounts Receiv_Ent 2
     C                     MOVEL*BLANK    YL0048 12
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0049  70
      * Define local work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YL0050  52
      * Define local work field Rated Freight
     C                     Z-ADD*ZERO     YL0051 112
      * Define local work field LTL Flag
     C                     MOVEL*BLANK    YL0052  1
      * Define local work field Price Audit
     C                     MOVEL*BLANK    YL0053  1
      * Define local work field Price Status
     C                     MOVEL*BLANK    YL0054  1
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0055  2
      * Define local work field Export Status
     C                     MOVEL*BLANK    YL0056  1
      * Define local work field Palletize
     C                     MOVEL*BLANK    YL0057  1
      * Define local work field Shrink Wrap
     C                     MOVEL*BLANK    YL0058  1
      * Define local work field Slip Sheet
     C                     MOVEL*BLANK    YL0059  1
      * Define local work field Age Code
     C                     MOVEL*BLANK    YL0060  1
      * Define local work field Reefer Temperature
     C                     Z-ADD*ZERO     YL0061  52
      * Define local work field Load Type
     C                     MOVEL*BLANK    YL0062  1
      * Define local work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YL0063  70
      * Define local work field Load Plan Order
     C                     MOVEL*BLANK    YL0064  1
      * Define local work field Print Pick Slip
     C                     MOVEL*BLANK    YL0065  1
      * Define local work field Resell Reference Number
     C                     Z-ADD*ZERO     YL0066  70
      * Define local work field Special Comment 1
     C                     MOVEL*BLANK    YL0067 30
      * Define local work field Special Comment 2
     C                     MOVEL*BLANK    YL0068 30
      * Define local work field Affect Auto Accruals
     C                     MOVEL*BLANK    YL0069  1
      * Define local work field Sales Route Code
     C                     MOVEL*BLANK    YL0070  3
      * Define local work field Manager Level Code
     C                     MOVEL*BLANK    YL0071  2
      * Define local work field VP Level Code
     C                     MOVEL*BLANK    YL0072  3
      * Define local work field Attach to Order Number
     C                     Z-ADD*ZERO     YL0073  70
      * Define local work field Reason for Price Audit
     C                     MOVEL*BLANK    YL0074  3
      * Define local work field Invoice Number
     C                     Z-ADD*ZERO     YL0075  70
      * Define local work field Invoice Suffix
     C                     MOVEL*BLANK    YL0076  2
      * Define local work field Invoice Date
     C                     Z-ADD*ZERO     YL0077  70
      * Define local work field Event Code
     C                     MOVEL*BLANK    YL0078  2
      * Define local work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YL0079  1
      * Define local work field Modified Flag
     C                     MOVEL*BLANK    YL0080  1
      * Define local work field A_R order Value Total
     C                     Z-ADD*ZERO     YL0081 112
      * Define local work field Billing Activity Type
     C                     MOVEL*BLANK    YL0082  1
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0083  1
      * Define local work field Order Certification Flag
     C                     MOVEL*BLANK    YL0084  1
      * Define local work field Invoice Order Value Tot
     C                     Z-ADD*ZERO     YL0085 112
      * Define local work field Process Sts for 3C
     C                     MOVEL*BLANK    YL0086  1
      * Define local work field Order Conf Fax Sts
     C                     MOVEL*BLANK    YL0087  1
      * Define local work field Manifest Fax Sts
     C                     MOVEL*BLANK    YL0088  1
      * Define local work field Invoice Fax Sts
     C                     MOVEL*BLANK    YL0089  1
      * Define local work field Transfer in Storage Ind
     C                     MOVEL*BLANK    YL0090  1
      * Define local work field Email Cust On Order Ship
     C                     MOVEL*BLANK    YL0091  1
      * Define local work field Order Emailed
     C                     MOVEL*BLANK    YL0092  1
      * Define local work field Export Docs Go w_Driver
     C                     MOVEL*BLANK    YL0093  1
      * Define local work field Shipping Temp Code C_F
     C                     MOVEL*BLANK    YL0094  1
      * Define local work field Broker Order Status
     C                     MOVEL*BLANK    YL0095  1
      * Define local work field Air Freight Order
     C                     MOVEL*BLANK    YL0096  1
      * Define local work field Order Requires Review
     C                     MOVEL*BLANK    YL0097  2
      * Define local work field OH Load Plan Ready
     C                     MOVEL*BLANK    YL0098  2
      * Define local work field Export USDA Approved
     C                     MOVEL*BLANK    YL0099  2
      * Define local work field HPB Ship to Warehouse
     C                     MOVEL*BLANK    YL0100  3
      * Define local work field OH TF Exempt Code
     C                     MOVEL*BLANK    YL0101  3
      * Define local work field OH Appt Confirmation Dt
     C                     Z-ADD*ZERO     YL0102  70
      * Define local work field JPN Invoice Issuance Date
     C                     Z-ADD*ZERO     YL0103  70
      * Define local work field Load Actual Shipped Date
     C                     Z-ADD*ZERO     YL0104  70
      * Define local work field Load BOL Complete Date
     C                     Z-ADD*ZERO     YL0105  70
      * Define local work field Load Truck Departure Date
     C                     Z-ADD*ZERO     YL0106  70
      * Define local work field Maximum Gross Weight
     C                     Z-ADD*ZERO     YL0107  60
      * Define local work field Time of Original Entry
     C                     Z-ADD*ZERO     YL0108  60
      * Define local work field OH Appt Confirmation Tm
     C                     Z-ADD*ZERO     YL0109  60
      * Define local work field Load BOL Complete Time
     C                     Z-ADD*ZERO     YL0110  60
      * Define local work field Load Truck Departure Time
     C                     Z-ADD*ZERO     YL0111  60
      * Define local work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     YL0112 112
      * Define local work field Act Non_Ref Frt Amount
     C                     Z-ADD*ZERO     YL0113 112
      * Define local work field OH Fuel Surcharge Amount
     C                     Z-ADD*ZERO     YL0114 112
      * Define local work field OH Total Non_Ref Frt Amt
     C                     Z-ADD*ZERO     YL0115 112
      * Define local work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     YL0116 112
      * Define local work field Claim Number
     C                     Z-ADD*ZERO     YL0117  70
      * Define local work field EDI Status 1
     C                     MOVEL*BLANK    YL0118  1
      * Define local work field EDI Status 2
     C                     MOVEL*BLANK    YL0119  1
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0120  1
      * Define local work field Job Time
     C                     Z-ADD*ZERO     YL0121  60
      * Define local work field User Id
     C                     MOVEL*BLANK    YL0122 10
      * Define local work field Job Name
     C                     MOVEL*BLANK    YL0123 10
      * Define local work field Job Date
     C                     Z-ADD*ZERO     YL0124  70
      * Define local work field Return Code Usr
     C                     MOVEL*BLANK    YL0125  7
      * Define local work field USR Select/Omit Flag
     C                     MOVEL*BLANK    YL0126  1
      * Define local work field Program name USR
     C                     MOVEL*BLANK    YL0127 10
      * Define local work field Reprint Status USR
     C                     MOVEL*BLANK    YL0128  1
      * Define local work field A/R Customer Num Pass USR
     C                     Z-ADD*ZERO     YL0129 155
      * Define local work field One Invoice Per PO
     C                     MOVEL*BLANK    YL0130  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PDR4PCLP
00002 reprint inv
