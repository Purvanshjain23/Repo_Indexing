     H/TITLE WW Repayments         DF  Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Display file
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJMIST
     H* Date          : 01/18/24  Time  : 08:11:42
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPWHRDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Repayments         DF  Display file
      *
     FPKDOREL3IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Tattoo Header Job Sel     Co/BO/BOL/Tattoo/KDte(d)
      *
     FPKC4REL1IF  E           K        DISK
      * RTV : Payment Processing Parms  Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKDOREL1IF  E           K        DISK
      * RTV : Tattoo Header Job Sel     Retrieval index
      *
     FPKC4REL0UF  E           K        DISK
      * UPD : Payment Processing Parms  Update index
      *
     FPKAWCPL0UF  E           K        DISK
      * UPD : Buy Order Header          Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
     FPKDOREL0UF  E           K        DISK
      * UPD : Tattoo Header Job Sel     Update index
      *
     FPKAXCPL1UF  E           K        DISK
      * UPD : Buy Order Load            Update index
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
      * Long constants
     E                    @CN#    1  15  6   @CN    25
     I@C4REO6
      * Payment Processing Parms  Update index
      * Renamed input format fields
     I              C4HONB                          WAHONB
     I              C4CKDT                          WACKDT
     I              C4M1NB                          WAM1NB
     I              C4KHST                          WAKHST
     I              C4KJST                          WAKJST
     I              C4PINB                          WAPINB
     I              C4KKST                          WAKKST
     I              C4AAVN                          WAAAVN
     I              C4AADT                          WAAADT
     I              C4AMTM                          WAAMTM
     I              C4AJST                          WAAJST
     I              C4AHVN                          WAAHVN
     I              C4AGVN                          WAAGVN
     I              C4ABVN                          WAABVN
     I              C4ABDT                          WAABDT
     I              C4ABTM                          WAABTM
      *
     I@DOREU3
      * Tattoo Header Job Sel     Retrieval index
      * Renamed input format fields
     I              DOKLTX                          WBKLTX
     I              DOHMNB                          WBHMNB
     I              DOBNNB                          WBBNNB
     I              DOBONB                          WBBONB
     I              DOCVNB                          WBCVNB
     I              DOB0DT                          WBB0DT
     I              DOKMTX                          WBKMTX
     I              DOM9ST                          WBM9ST
     I              DOABCD                          WBABCD
     I              DOAECD                          WBAECD
     I              DOAAVN                          WBAAVN
     I              DOAADT                          WBAADT
     I              DOAMTM                          WBAMTM
     I              DOAJST                          WBAJST
     I              DOAHVN                          WBAHVN
     I              DOAGVN                          WBAGVN
     I              DOABVN                          WBABVN
     I              DOABDT                          WBABDT
     I              DOABTM                          WBABTM
      *
     I@AWCPAZ
      * Buy Order Header          Update index
      * Renamed input format fields
     I              AWHMNB                          WCHMNB
     I              AWBNNB                          WCBNNB
     I              AWARDT                          WCARDT
     I              AWASDT                          WCASDT
     I              AWA4ST                          WCA4ST
     I              AWA5ST                          WCA5ST
     I              AWAAPR                          WCAAPR
     I              AWA6ST                          WCA6ST
     I              AWA7ST                          WCA7ST
     I              AWB3ST                          WCB3ST
     I              AWALPR                          WCALPR
     I              AWETCD                          WCETCD
     I              AWEUCD                          WCEUCD
     I              AWJ5TX                          WCJ5TX
     I              AWD5DT                          WCD5DT
     I              AWD6DT                          WCD6DT
     I              AWD7DT                          WCD7DT
     I              AWD8DT                          WCD8DT
     I              AWD9DT                          WCD9DT
     I              AWJOEJ                          WCJOEJ
     I              AWKOFF                          WCKOFF
     I              AWKWPE                          WCKWPE
     I              AWIMBF                          WCIMBF
     I              AWOPTR                          WCOPTR
     I              AWOEJD                          WCOEJD
     I              AWIRMF                          WCIRMF
     I              AWJIRM                          WCJIRM
     I              AWJRKF                          WCJRKF
     I              AWKFIR                          WCKFIR
     I              AWUZST                          WCUZST
     I              AWU0ST                          WCU0ST
     I              AWU1ST                          WCU1ST
     I              AWU2ST                          WCU2ST
     I              AWU3ST                          WCU3ST
     I              AWHXNB                          WCHXNB
     I              AWGANB                          WCGANB
     I              AWGBNB                          WCGBNB
     I              AWABCD                          WCABCD
     I              AWAECD                          WCAECD
     I              AWAKCD                          WCAKCD
     I              AWALCD                          WCALCD
     I              AWAGCD                          WCAGCD
     I              AWAICD                          WCAICD
     I              AWAMCD                          WCAMCD
     I              AWACCD                          WCACCD
     I              AWAAVN                          WCAAVN
     I              AWAADT                          WCAADT
     I              AWAMTM                          WCAMTM
     I              AWAJST                          WCAJST
     I              AWAHVN                          WCAHVN
     I              AWAGVN                          WCAGVN
     I              AWABVN                          WCABVN
     I              AWABDT                          WCABDT
     I              AWABTM                          WCABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WDHMNB
     I              A1BNNB                          WDBNNB
     I              A1BONB                          WDBONB
     I              A1CVNB                          WDCVNB
     I              A1B0DT                          WDB0DT
     I              A1AWDT                          WDAWDT
     I              A1BICD                          WDBICD
     I              A1CPST                          WDCPST
     I              A1ACPR                          WDACPR
     I              A1B9PR                          WDB9PR
     I              A1CAPR                          WDCAPR
     I              A1C4ST                          WDC4ST
     I              A1AIPR                          WDAIPR
     I              A1A6DT                          WDA6DT
     I              A1C2ST                          WDC2ST
     I              A1CXNB                          WDCXNB
     I              A1CWNB                          WDCWNB
     I              A1FCNB                          WDFCNB
     I              A1H9NB                          WDH9NB
     I              A1FDNB                          WDFDNB
     I              A1FENB                          WDFENB
     I              A1HENB                          WDHENB
     I              A1HFNB                          WDHFNB
     I              A1CYNB                          WDCYNB
     I              A1LRNB                          WDLRNB
     I              A1E0NB                          WDE0NB
     I              A1A5PC                          WDA5PC
     I              A1FBNB                          WDFBNB
     I              A1A4PC                          WDA4PC
     I              A1F7NB                          WDF7NB
     I              A1HDNB                          WDHDNB
     I              A1F5NB                          WDF5NB
     I              A1F4NB                          WDF4NB
     I              A1F3NB                          WDF3NB
     I              A1F2NB                          WDF2NB
     I              A1AVPC                          WDAVPC
     I              A1AWPC                          WDAWPC
     I              A1CWPC                          WDCWPC
     I              A1A8PC                          WDA8PC
     I              A1A7PC                          WDA7PC
     I              A1B8PR                          WDB8PR
     I              A1AMPR                          WDAMPR
     I              A1ANPR                          WDANPR
     I              A1AYVA                          WDAYVA
     I              A1AWVA                          WDAWVA
     I              A1AOPR                          WDAOPR
     I              A1AXVA                          WDAXVA
     I              A1APPR                          WDAPPR
     I              A1ASPR                          WDASPR
     I              A1A4VA                          WDA4VA
     I              A1ATPR                          WDATPR
     I              A1A5VA                          WDA5VA
     I              A1CBPR                          WDCBPR
     I              A1CCPR                          WDCCPR
     I              A1LPNB                          WDLPNB
     I              A1CDPR                          WDCDPR
     I              A1A7VA                          WDA7VA
     I              A1A2PR                          WDA2PR
     I              A1JWST                          WDJWST
     I              A1CWST                          WDCWST
     I              A1D7ST                          WDD7ST
     I              A1D8ST                          WDD8ST
     I              A1DWST                          WDDWST
     I              A1D6ST                          WDD6ST
     I              A1GHNB                          WDGHNB
     I              A1BYDT                          WDBYDT
     I              A1E0ST                          WDE0ST
     I              A1E1ST                          WDE1ST
     I              A1E2ST                          WDE2ST
     I              A1BSDT                          WDBSDT
     I              A1BTDT                          WDBTDT
     I              A1BUDT                          WDBUDT
     I              A1HGNB                          WDHGNB
     I              A1HHNB                          WDHHNB
     I              A1HINB                          WDHINB
     I              A1A3PR                          WDA3PR
     I              A1A4PR                          WDA4PR
     I              A1A6PR                          WDA6PR
     I              A1J9NB                          WDJ9NB
     I              A1D6PR                          WDD6PR
     I              A1D7PR                          WDD7PR
     I              A1D8PR                          WDD8PR
     I              A1D9PR                          WDD9PR
     I              A1EAPR                          WDEAPR
     I              A1EBPR                          WDEBPR
     I              A1ECPR                          WDECPR
     I              A1EDPR                          WDEDPR
     I              A1EEPR                          WDEEPR
     I              A1EFPR                          WDEFPR
     I              A1EGPR                          WDEGPR
     I              A1EHPR                          WDEHPR
     I              A1KAST                          WDKAST
     I              A1J7ST                          WDJ7ST
     I              A1J9ST                          WDJ9ST
     I              A1OXNB                          WDOXNB
     I              A1LKST                          WDLKST
     I              A1LLST                          WDLLST
     I              A1J8ST                          WDJ8ST
     I              A1LIST                          WDLIST
     I              A1LJST                          WDLJST
     I              A1NZTX                          WDNZTX
     I              A1HJCD                          WDHJCD
     I              A1R4ST                          WDR4ST
     I              A1R5ST                          WDR5ST
     I              A1R6ST                          WDR6ST
     I              A1R7ST                          WDR7ST
     I              A1THWT                          WDTHWT
     I              A1T2WT                          WDT2WT
     I              A1THHD                          WDTHHD
     I              A1T2HD                          WDT2HD
     I              A1OBPR                          WDOBPR
     I              A1KOER                          WDKOER
     I              A1OPIR                          WDOPIR
     I              A1OPEM                          WDOPEM
     I              A1IORP                          WDIORP
     I              A1OWEO                          WDOWEO
     I              A1OQET                          WDOQET
     I              A1URST                          WDURST
     I              A1USST                          WDUSST
     I              A1HHPC                          WDHHPC
     I              A1S9PR                          WDS9PR
     I              A1TAPR                          WDTAPR
     I              A1TBPR                          WDTBPR
     I              A1JFUR                          WDJFUR
     I              A1KRIF                          WDKRIF
     I              A1KORF                          WDKORF
     I              A1KAPR                          WDKAPR
     I              A1KROT                          WDKROT
     I              A1OTJG                          WDOTJG
     I              A1IRJG                          WDIRJG
     I              A1IMJF                          WDIMJF
     I              A1IRGF                          WDIRGF
     I              A1KRJF                          WDKRJF
     I              A1OJRF                          WDOJRF
     I              A1KFOR                          WDKFOR
     I              A1ORJK                          WDORJK
     I              A1OMVJ                          WDOMVJ
     I              A1MVNF                          WDMVNF
     I              A1MCNF                          WDMCNF
     I              A1NCNF                          WDNCNF
     I              A1NCHF                          WDNCHF
     I              A1IGIR                          WDIGIR
     I              A1KFJR                          WDKFJR
     I              A1EADT                          WDEADT
     I              A1EBDT                          WDEBDT
     I              A1ECDT                          WDECDT
     I              A1EDDT                          WDEDDT
     I              A1EEDT                          WDEEDT
     I              A1U4ST                          WDU4ST
     I              A1U5ST                          WDU5ST
     I              A1U6ST                          WDU6ST
     I              A1U7ST                          WDU7ST
     I              A1U8ST                          WDU8ST
     I              A1U9ST                          WDU9ST
     I              A1VAST                          WDVAST
     I              A1VBST                          WDVBST
     I              A1BDCD                          WDBDCD
     I              A1CSCD                          WDCSCD
     I              A1ABCD                          WDABCD
     I              A1AECD                          WDAECD
     I              A1ACCD                          WDACCD
     I              A1AGCD                          WDAGCD
     I              A1BECD                          WDBECD
     I              A1AAVN                          WDAAVN
     I              A1AADT                          WDAADT
     I              A1AMTM                          WDAMTM
     I              A1AJST                          WDAJST
     I              A1AHVN                          WDAHVN
     I              A1AGVN                          WDAGVN
     I              A1ABVN                          WDABVN
     I              A1ABDT                          WDABDT
     I              A1ABTM                          WDABTM
      *
     I@DOREU2
      * Tattoo Header Job Sel     Update index
      * Renamed input format fields
     I              DOKLTX                          WEKLTX
     I              DOHMNB                          WEHMNB
     I              DOBNNB                          WEBNNB
     I              DOBONB                          WEBONB
     I              DOCVNB                          WECVNB
     I              DOB0DT                          WEB0DT
     I              DOKMTX                          WEKMTX
     I              DOM9ST                          WEM9ST
     I              DOABCD                          WEABCD
     I              DOAECD                          WEAECD
     I              DOAAVN                          WEAAVN
     I              DOAADT                          WEAADT
     I              DOAMTM                          WEAMTM
     I              DOAJST                          WEAJST
     I              DOAHVN                          WEAHVN
     I              DOAGVN                          WEAGVN
     I              DOABVN                          WEABVN
     I              DOABDT                          WEABDT
     I              DOABTM                          WEABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IQPKC41    E DSPKC4REL0
      * UPD : Payment Processing Parms  Update index
      * Renamed input format fields
     I              C4HONB                          WAHONB
     I              C4CKDT                          WACKDT
     I              C4M1NB                          WAM1NB
     I              C4KHST                          WAKHST
     I              C4KJST                          WAKJST
     I              C4PINB                          WAPINB
     I              C4KKST                          WAKKST
     I              C4AAVN                          WAAAVN
     I              C4AADT                          WAAADT
     I              C4AMTM                          WAAMTM
     I              C4AJST                          WAAJST
     I              C4AHVN                          WAAHVN
     I              C4AGVN                          WAAGVN
     I              C4ABVN                          WAABVN
     I              C4ABDT                          WAABDT
     I              C4ABTM                          WAABTM
      *
     IYARDCS      DS                             72
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                              2
      * KEY : Payment Processing Parms  Retrieval index
      * I : RST CC Company Number
     I                                    P   1   20PAHONB
      *
     IQPKAW1    E DSPKAWCPL0
      * UPD : Buy Order Header          Update index
      * Renamed input format fields
     I              AWHMNB                          WCHMNB
     I              AWBNNB                          WCBNNB
     I              AWARDT                          WCARDT
     I              AWASDT                          WCASDT
     I              AWA4ST                          WCA4ST
     I              AWA5ST                          WCA5ST
     I              AWAAPR                          WCAAPR
     I              AWA6ST                          WCA6ST
     I              AWA7ST                          WCA7ST
     I              AWB3ST                          WCB3ST
     I              AWALPR                          WCALPR
     I              AWETCD                          WCETCD
     I              AWEUCD                          WCEUCD
     I              AWJ5TX                          WCJ5TX
     I              AWD5DT                          WCD5DT
     I              AWD6DT                          WCD6DT
     I              AWD7DT                          WCD7DT
     I              AWD8DT                          WCD8DT
     I              AWD9DT                          WCD9DT
     I              AWJOEJ                          WCJOEJ
     I              AWKOFF                          WCKOFF
     I              AWKWPE                          WCKWPE
     I              AWIMBF                          WCIMBF
     I              AWOPTR                          WCOPTR
     I              AWOEJD                          WCOEJD
     I              AWIRMF                          WCIRMF
     I              AWJIRM                          WCJIRM
     I              AWJRKF                          WCJRKF
     I              AWKFIR                          WCKFIR
     I              AWUZST                          WCUZST
     I              AWU0ST                          WCU0ST
     I              AWU1ST                          WCU1ST
     I              AWU2ST                          WCU2ST
     I              AWU3ST                          WCU3ST
     I              AWHXNB                          WCHXNB
     I              AWGANB                          WCGANB
     I              AWGBNB                          WCGBNB
     I              AWABCD                          WCABCD
     I              AWAECD                          WCAECD
     I              AWAKCD                          WCAKCD
     I              AWALCD                          WCALCD
     I              AWAGCD                          WCAGCD
     I              AWAICD                          WCAICD
     I              AWAMCD                          WCAMCD
     I              AWACCD                          WCACCD
     I              AWAAVN                          WCAAVN
     I              AWAADT                          WCAADT
     I              AWAMTM                          WCAMTM
     I              AWAJST                          WCAJST
     I              AWAHVN                          WCAHVN
     I              AWAGVN                          WCAGVN
     I              AWABVN                          WCABVN
     I              AWABDT                          WCABDT
     I              AWABTM                          WCABTM
      *
     IYBRDCS      DS                            219
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WDHMNB
     I              A1BNNB                          WDBNNB
     I              A1BONB                          WDBONB
     I              A1CVNB                          WDCVNB
     I              A1B0DT                          WDB0DT
     I              A1AWDT                          WDAWDT
     I              A1BICD                          WDBICD
     I              A1CPST                          WDCPST
     I              A1ACPR                          WDACPR
     I              A1B9PR                          WDB9PR
     I              A1CAPR                          WDCAPR
     I              A1C4ST                          WDC4ST
     I              A1AIPR                          WDAIPR
     I              A1A6DT                          WDA6DT
     I              A1C2ST                          WDC2ST
     I              A1CXNB                          WDCXNB
     I              A1CWNB                          WDCWNB
     I              A1FCNB                          WDFCNB
     I              A1H9NB                          WDH9NB
     I              A1FDNB                          WDFDNB
     I              A1FENB                          WDFENB
     I              A1HENB                          WDHENB
     I              A1HFNB                          WDHFNB
     I              A1CYNB                          WDCYNB
     I              A1LRNB                          WDLRNB
     I              A1E0NB                          WDE0NB
     I              A1A5PC                          WDA5PC
     I              A1FBNB                          WDFBNB
     I              A1A4PC                          WDA4PC
     I              A1F7NB                          WDF7NB
     I              A1HDNB                          WDHDNB
     I              A1F5NB                          WDF5NB
     I              A1F4NB                          WDF4NB
     I              A1F3NB                          WDF3NB
     I              A1F2NB                          WDF2NB
     I              A1AVPC                          WDAVPC
     I              A1AWPC                          WDAWPC
     I              A1CWPC                          WDCWPC
     I              A1A8PC                          WDA8PC
     I              A1A7PC                          WDA7PC
     I              A1B8PR                          WDB8PR
     I              A1AMPR                          WDAMPR
     I              A1ANPR                          WDANPR
     I              A1AYVA                          WDAYVA
     I              A1AWVA                          WDAWVA
     I              A1AOPR                          WDAOPR
     I              A1AXVA                          WDAXVA
     I              A1APPR                          WDAPPR
     I              A1ASPR                          WDASPR
     I              A1A4VA                          WDA4VA
     I              A1ATPR                          WDATPR
     I              A1A5VA                          WDA5VA
     I              A1CBPR                          WDCBPR
     I              A1CCPR                          WDCCPR
     I              A1LPNB                          WDLPNB
     I              A1CDPR                          WDCDPR
     I              A1A7VA                          WDA7VA
     I              A1A2PR                          WDA2PR
     I              A1JWST                          WDJWST
     I              A1CWST                          WDCWST
     I              A1D7ST                          WDD7ST
     I              A1D8ST                          WDD8ST
     I              A1DWST                          WDDWST
     I              A1D6ST                          WDD6ST
     I              A1GHNB                          WDGHNB
     I              A1BYDT                          WDBYDT
     I              A1E0ST                          WDE0ST
     I              A1E1ST                          WDE1ST
     I              A1E2ST                          WDE2ST
     I              A1BSDT                          WDBSDT
     I              A1BTDT                          WDBTDT
     I              A1BUDT                          WDBUDT
     I              A1HGNB                          WDHGNB
     I              A1HHNB                          WDHHNB
     I              A1HINB                          WDHINB
     I              A1A3PR                          WDA3PR
     I              A1A4PR                          WDA4PR
     I              A1A6PR                          WDA6PR
     I              A1J9NB                          WDJ9NB
     I              A1D6PR                          WDD6PR
     I              A1D7PR                          WDD7PR
     I              A1D8PR                          WDD8PR
     I              A1D9PR                          WDD9PR
     I              A1EAPR                          WDEAPR
     I              A1EBPR                          WDEBPR
     I              A1ECPR                          WDECPR
     I              A1EDPR                          WDEDPR
     I              A1EEPR                          WDEEPR
     I              A1EFPR                          WDEFPR
     I              A1EGPR                          WDEGPR
     I              A1EHPR                          WDEHPR
     I              A1KAST                          WDKAST
     I              A1J7ST                          WDJ7ST
     I              A1J9ST                          WDJ9ST
     I              A1OXNB                          WDOXNB
     I              A1LKST                          WDLKST
     I              A1LLST                          WDLLST
     I              A1J8ST                          WDJ8ST
     I              A1LIST                          WDLIST
     I              A1LJST                          WDLJST
     I              A1NZTX                          WDNZTX
     I              A1HJCD                          WDHJCD
     I              A1R4ST                          WDR4ST
     I              A1R5ST                          WDR5ST
     I              A1R6ST                          WDR6ST
     I              A1R7ST                          WDR7ST
     I              A1THWT                          WDTHWT
     I              A1T2WT                          WDT2WT
     I              A1THHD                          WDTHHD
     I              A1T2HD                          WDT2HD
     I              A1OBPR                          WDOBPR
     I              A1KOER                          WDKOER
     I              A1OPIR                          WDOPIR
     I              A1OPEM                          WDOPEM
     I              A1IORP                          WDIORP
     I              A1OWEO                          WDOWEO
     I              A1OQET                          WDOQET
     I              A1URST                          WDURST
     I              A1USST                          WDUSST
     I              A1HHPC                          WDHHPC
     I              A1S9PR                          WDS9PR
     I              A1TAPR                          WDTAPR
     I              A1TBPR                          WDTBPR
     I              A1JFUR                          WDJFUR
     I              A1KRIF                          WDKRIF
     I              A1KORF                          WDKORF
     I              A1KAPR                          WDKAPR
     I              A1KROT                          WDKROT
     I              A1OTJG                          WDOTJG
     I              A1IRJG                          WDIRJG
     I              A1IMJF                          WDIMJF
     I              A1IRGF                          WDIRGF
     I              A1KRJF                          WDKRJF
     I              A1OJRF                          WDOJRF
     I              A1KFOR                          WDKFOR
     I              A1ORJK                          WDORJK
     I              A1OMVJ                          WDOMVJ
     I              A1MVNF                          WDMVNF
     I              A1MCNF                          WDMCNF
     I              A1NCNF                          WDNCNF
     I              A1NCHF                          WDNCHF
     I              A1IGIR                          WDIGIR
     I              A1KFJR                          WDKFJR
     I              A1EADT                          WDEADT
     I              A1EBDT                          WDEBDT
     I              A1ECDT                          WDECDT
     I              A1EDDT                          WDEDDT
     I              A1EEDT                          WDEEDT
     I              A1U4ST                          WDU4ST
     I              A1U5ST                          WDU5ST
     I              A1U6ST                          WDU6ST
     I              A1U7ST                          WDU7ST
     I              A1U8ST                          WDU8ST
     I              A1U9ST                          WDU9ST
     I              A1VAST                          WDVAST
     I              A1VBST                          WDVBST
     I              A1BDCD                          WDBDCD
     I              A1CSCD                          WDCSCD
     I              A1ABCD                          WDABCD
     I              A1AECD                          WDAECD
     I              A1ACCD                          WDACCD
     I              A1AGCD                          WDAGCD
     I              A1BECD                          WDBECD
     I              A1AAVN                          WDAAVN
     I              A1AADT                          WDAADT
     I              A1AMTM                          WDAMTM
     I              A1AJST                          WDAJST
     I              A1AHVN                          WDAHVN
     I              A1AGVN                          WDAGVN
     I              A1ABVN                          WDABVN
     I              A1ABDT                          WDABDT
     I              A1ABTM                          WDABTM
      *
     IYCRDCS      DS                            583
     IQPKDO1    E DSPKDOREL0
      * UPD : Tattoo Header Job Sel     Update index
      * Renamed input format fields
     I              DOKLTX                          WEKLTX
     I              DOHMNB                          WEHMNB
     I              DOBNNB                          WEBNNB
     I              DOBONB                          WEBONB
     I              DOCVNB                          WECVNB
     I              DOB0DT                          WEB0DT
     I              DOKMTX                          WEKMTX
     I              DOM9ST                          WEM9ST
     I              DOABCD                          WEABCD
     I              DOAECD                          WEAECD
     I              DOAAVN                          WEAAVN
     I              DOAADT                          WEAADT
     I              DOAMTM                          WEAMTM
     I              DOAJST                          WEAJST
     I              DOAHVN                          WEAHVN
     I              DOAGVN                          WEAGVN
     I              DOABVN                          WEABVN
     I              DOABDT                          WEABDT
     I              DOABTM                          WEABTM
      *
     IYDRDCS      DS                            121
     IYERDCS      DS                            121
     IYFRDCS      DS                             72
     IYGRDCS      DS                             72
     IYHRDCS      DS                            219
     IYIRDCS      DS                            583
     IYJRDCS      DS                            121
     IYKRDCS      DS                            121
     IYLRDCS      DS                             72
     IYMRDCS      DS                            121
     IQPKAX1    E DSPKAXCPL1
      * UPD : Buy Order Load            Update index
      *
     IYNRDCS      DS                            237
     IYORDCS      DS                            219
     IYPRDCS      DS                            583
     IYQRDCS      DS                            583
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header Job Sel
      * N : RST Tattoo Job Sel Name
     I                                        1  10 P1KLTX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Company Number required'
      * Company Number USR
     I                                    P   1   20ZA0001
      * Message data for 'Repay Records Updated'
      * Repayment Status Desc
     I                                        1   6 ZA0002
      * Count USR
     I                                    P   7   80ZA0003
      * Message data for 'Repay Records Updated'
      * Repayment Status Desc
     I                                        1   6 ZA0004
      * Count USR
     I                                    P   7   80ZA0005
      * Message data for 'Cannot Unpay-Backup NC'
      * *SFLSEL
     I                                        1   1 ZA0006
      * Message data for 'Tattoo is already Unpaid'
      * *SFLSEL
     I                                        1   1 ZA0007
      * Message data for 'Cannot Unpay-Backup NC'
      * *SFLSEL
     I                                        1   1 ZA0008
      * Message data for 'Cannot Unpay-Status'
      * *SFLSEL
     I                                        1   1 ZA0009
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
     C                     MOVE YL0001    #2HMNB           BOH Company Num
      * If First Time, display all records
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0002           First Time Flag
     C                     MOVEL*BLANK    #2M9ST           Repayment Statu
     C                     END                             *FI
      * Rtv Payment Processing RT - Payment Processing Parms  * Date/Step
     C                     EXSR SARVGN
     C                     Z-ADDYL0003    #CCKDT           Pmt Current Pay
      * Retrieve current file backup status
      * CASE: *OTHERWISE
      * Rtv Company Values    XF - STR Order Management Sys  * HPEREPAYBU
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2HMNB    WQ0001  30       BOH Company Num
     C                     PARM @CN,001   WQ0002 10        Company Value C
     C           YL0004    PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Breakout Repayment Backup file values
      * CASE: *OTHERWISE
      * 1. Backup Status (position 1)
     C                     Z-ADD1         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0004:ZQ YL0005    P  90  File Backup Sta
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * 2. Date of Backup (positions 2-8)
     C                     Z-ADD7         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0004:ZQ YL0006    P  90  Date Alpha USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0006    YL0007           Last Run Date
     C                     MOVEL*BLANK    YL0008           Date From Conve
     C                     MOVELYL0007    YL0008           Date From Conve
      * 3. Last file backed up (positions 9 - 18)
     C                     Z-ADD10        YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0004:ZQ YL0009    P  90  File
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Determine screen backup message
      * CASE: LCL.File Backup Status USR is Backup completed
     C           YL0005    IFEQ 'C'                        *IF
      * If Backup Date <> Job Date, files not bakced up
      * CASE: LCL.Last Run Date NE JOB.*Job date
     C           YL0007    IFNE ##JDT                      *IF
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,002   CAT  @CN,003:ZQ#COBTX    P      Text descriptio
     C                     ELSE
      * CASE: LCL.Last Run Date EQ JOB.*Job date
     C           YL0007    IFEQ ##JDT                      *IF
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,004   CAT  'd up.':ZQ#COBTX    P      Text descriptio
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.File Backup Status USR is Backup in progress
     C           YL0005    IFEQ 'P'                        *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,005   CAT  @CN,006:ZQ#COBTX    P      Text descriptio
     C                     Z-ADD1         ZQ      50
     C           #COBTX    CAT  YL0009:ZQ #COBTX    P      Text descriptio
     C                     ELSE
      * CASE: LCL.File Backup Status USR is Error during backup
     C           YL0005    IFEQ 'E'                        *IF
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,007   CAT  @CN,008:ZQ#COBTX    P      Text descriptio
     C                     Z-ADD1         ZQ      50
     C           #COBTX    CAT  YL0009:ZQ #COBTX    P      Text descriptio
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Load Payment Status description
      * CASE: CTL.Tattoo Job Sel Perm/Temp is Not Entered
     C           #2M9ST    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    #CJPTX           Text 10 1 USR
     C                     MOVEL'ALL'     #CJPTX           Text 10 1 USR
     C                     ELSE
      * CASE: CTL.Tattoo Job Sel Perm/Temp is Unpaid
     C           #2M9ST    IFEQ 'U'                        *IF
     C                     MOVEL@CN,009   #CJPTX           Text 10 1 USR
     C                     ELSE
      * CASE: CTL.Tattoo Job Sel Perm/Temp is Repaid
     C           #2M9ST    IFEQ 'R'                        *IF
     C                     MOVEL@CN,010   #CJPTX           Text 10 1 USR
     C                     ELSE
      * CASE: CTL.Tattoo Job Sel Perm/Temp is Paid
     C           #2M9ST    IFEQ 'P'                        *IF
     C                     MOVEL*BLANK    #CJPTX           Text 10 1 USR
     C                     MOVEL'Paid'    #CJPTX           Text 10 1 USR
     C                     ELSE
      * CASE: CTL.Tattoo Job Sel Perm/Temp is Transferred
     C           #2M9ST    IFEQ 'T'                        *IF
     C                     MOVEL@CN,011   #CJPTX           Text 10 1 USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Save the current values of the positioner fields
     C                     Z-ADD#2B0DT    YL0010           Kill Date Usr
     C                     Z-ADD#2BNNB    YL0011           Buy Order Numbe
     C                     Z-ADD#2BONB    YL0012           Load Number
     C                     Z-ADD#2CVNB    YL0013           Tattoo Number U
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           DOKLTX           Tattoo Job Sel
     C                     KFLD           DOHMNB           BOH Company Num
     C                     KFLD           DOBNNB           BOH Buy Order N
     C                     KFLD           DOBONB           BOL Load Number
     C                     KFLD           DOCVNB           TH Tattoo Numbe
     C                     KFLD           DOB0DT           TH Kill Date
      * Setup key
     C                     MOVEL#2KLTX    DOKLTX
     C                     Z-ADD#2HMNB    DOHMNB
     C                     Z-ADD#2BNNB    DOBNNB
     C                     Z-ADD#2BONB    DOBONB
     C                     Z-ADD#2CVNB    DOCVNB
     C           #2B0DT    IFEQ *ZERO
     C                     MOVEL*HIVAL    DOB0DT           TH Kill Date
     C                     ELSE
     C                     Z-ADD#2B0DT    DOB0DT
     C                     ENDIF
     C           KPOS      SETLL@DOREZI
     C           KRST      KLIST
     C                     KFLD           DOKLTX           Tattoo Job Sel
      * Setup key
     C                     MOVEL#2KLTX    DOKLTX
     C           KRST      READE@DOREZI                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2KLTX    WZKLTX
     C                     MOVEL#2KLTX    WZKLTX           Tattoo Job Sel
     C           *LIKE     DEFN #2HMNB    WZHMNB
     C                     MOVEL#2HMNB    WZHMNB           BOH Company Num
     C           *LIKE     DEFN #2BNNB    WZBNNB
     C                     MOVEL#2BNNB    WZBNNB           BOH Buy Order N
     C           *LIKE     DEFN #2BONB    WZBONB
     C                     MOVEL#2BONB    WZBONB           BOL Load Number
     C           *LIKE     DEFN #2CVNB    WZCVNB
     C                     MOVEL#2CVNB    WZCVNB           TH Tattoo Numbe
     C           *LIKE     DEFN #2B0DT    WZB0DT
     C                     MOVEL#2B0DT    WZB0DT           TH Kill Date
     C           *LIKE     DEFN #2M9ST    WZM9ST
     C                     MOVEL#2M9ST    WZM9ST           Repayment Statu
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@DOREZI                  90*
     C  N82                READ @DOREZI                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,35
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2HMNB    IFEQ *ZERO                      BOH Company Num
     C           #2BNNB    IFNE *ZERO                      BOH Buy Order N
     C           DOBNNB    CABNE#2BNNB    BB020            BOH Buy Order N
     C                     END
     C                     END
     C           #2HMNB    IFEQ *ZERO                      BOH Company Num
     C           #2BNNB    OREQ *ZERO                      BOH Buy Order N
     C           #2BONB    IFNE *ZERO                      BOL Load Number
     C           DOBONB    CABNE#2BONB    BB020            BOL Load Number
     C                     END
     C                     END
     C           #2HMNB    IFEQ *ZERO                      BOH Company Num
     C           #2BNNB    OREQ *ZERO                      BOH Buy Order N
     C           #2BONB    OREQ *ZERO                      BOL Load Number
     C           #2CVNB    IFNE *ZERO                      TH Tattoo Numbe
     C           DOCVNB    CABNE#2CVNB    BB020            TH Tattoo Numbe
     C                     END
     C                     END
     C           #2HMNB    IFEQ *ZERO                      BOH Company Num
     C           #2BNNB    OREQ *ZERO                      BOH Buy Order N
     C           #2BONB    OREQ *ZERO                      BOL Load Number
     C           #2CVNB    OREQ *ZERO                      TH Tattoo Numbe
     C           #2B0DT    IFNE *ZERO                      TH Kill Date
     C           DOB0DT    CABNE#2B0DT    BB020            TH Kill Date
     C                     END
     C                     END
     C           #2M9ST    IFNE *BLANK                     Repayment Statu
     C           DOM9ST    CABNE#2M9ST    BB020            Repayment Statu
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * Select records for the current Company Number
      * CASE: RCD.BOH Company Number NE CTL.BOH Company Number
     C           #1HMNB    IFNE #2HMNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv TH for Repayment - Tattoo Header  * Pay Sts/Prdcr/Loc/Process
     C                     EXSR SBRVGN
      * Select record if Payment Sts = Payment Sts selector
      * CASE: Status <> blank AND RCD value <> CTL value
      *  - NOTc1 AND c2
      *   |- c1    : CTL.Tattoo Job Sel Perm/Temp is Not Entered
      *   |- c2    : CTL.Tattoo Job Sel Perm/Temp NE RCD.Tattoo Job Sel P
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2M9ST    IFEQ *BLANK                     *IF
     C                     ELSE
     C           #2M9ST    IFNE #1M9ST                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv BOH Lock Sts      RT - Buy Order Header  * 
     C                     EXSR SCRVGN
      * Load Status Description
      * CASE: RCD.Tattoo Job Sel Perm/Temp is Repaid
     C           #1M9ST    IFEQ 'R'                        *IF
     C                     MOVEL@CN,010   #RJPTX           Text 10 1 USR
     C                     ELSE
      * CASE: RCD.Tattoo Job Sel Perm/Temp is Unpaid
     C           #1M9ST    IFEQ 'U'                        *IF
     C                     MOVEL@CN,009   #RJPTX           Text 10 1 USR
     C                     ELSE
      * CASE: RCD.Tattoo Job Sel Perm/Temp is Paid
     C           #1M9ST    IFEQ 'P'                        *IF
     C                     MOVEL*BLANK    #RJPTX           Text 10 1 USR
     C                     MOVEL'Paid'    #RJPTX           Text 10 1 USR
     C                     ELSE
      * CASE: RCD.Tattoo Job Sel Perm/Temp is Transferred
     C           #1M9ST    IFEQ 'T'                        *IF
     C                     MOVEL@CN,011   #RJPTX           Text 10 1 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #RJPTX           Text 10 1 USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C           KRST      READE@DOREZI                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * PUTOVR unless conditioned fields change
     C                     SETON                     86
     C           *IN81     IFNE CAIN81
     C                     SETOF                     86
     C                     END
     C                     MOVE *IN81     CAIN81  1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate TH Kill Date
      * External date
     C                     Z-ADDV2B0DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     Z-ADDXDINDT    #2B0DT
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZBNNB    CASNE#2BNNB    FBRQRL
     C           WZBONB    CASNE#2BONB    FBRQRL
     C           WZCVNB    CASNE#2CVNB    FBRQRL
     C           WZB0DT    CASNE#2B0DT    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * If Company Number = 0, ERROR; OTHERWISE Check Function Keys
      * CASE: CTL.BOH Company Number is *ZERO
     C           #2HMNB    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#2HMNB    ZA0001           BOH Company Num
      * Send message 'Company Number required'
     C                     MOVEL'PRK0826' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: CTL.Kill Dte OR Buy Order OR Load OR Tattoo change
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : CTL.TH Kill Date NE LCL.Kill Date Usr
      *   |- c2    : CTL.BOH Buy Order Number NE LCL.Buy Order Number USR
      *   |- c3    : CTL.BOL Load Number NE LCL.Load Number
      *   |- c4    : CTL.TH Tattoo Number NE LCL.Tattoo Number USR
      *   '-
     C           #2B0DT    IFNE YL0010                     *IF
     C           #2BNNB    ORNE YL0011                     *OR
     C           #2BONB    ORNE YL0012                     *OR
     C           #2CVNB    ORNE YL0013                     *OR
      * Update CTL values to saved values and set Repayment Status to ALL
     C                     EXSR UASUBR                     Update CTL valu
     C                     ELSE
      * CASE: *OTHERWISE
      * Process Fkeys
      * CASE: CTL.*CMD key is CF05
     C           *IN05     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.*CMD key is CF06
     C           *IN06     IFEQ '1'                        *IF
      * Create new records
     C                     EXSR UBSUBR                     Create new reco
     C                     ELSE
      * CASE: CTL.*CMD key is Toggle
     C           *IN10     IFEQ '1'                        *IF
      * Toggle processing
     C                     EXSR UCSUBR                     Toggle processi
     C                     ELSE
      * CASE: CTL.*CMD key is CF11
     C           *IN11     IFEQ '1'                        *IF
      * Edit User Profile
     C                     EXSR UDSUBR                     Edit User Profi
     C                     ELSE
      * CASE: CTL.*CMD key is CF13
     C           *IN13     IFEQ '1'                        *IF
      * Edit Payment Date and Step
     C                     EXSR UESUBR                     Edit Payment Da
     C                     ELSE
      * CASE: CTL.*CMD key is CF14
     C           *IN14     IFEQ '1'                        *IF
      * Call Payment Edit/Post Process
     C                     EXSR UFSUBR                     Call Payment Ed
     C                     ELSE
      * CASE: CTL.*CMD key is CF15
     C           *IN15     IFEQ '1'                        *IF
      * Show Payment Current Payment Dates
     C                     EXSR UGSUBR                     Show Payment Cu
     C                     ELSE
      * CASE: CTL.*CMD key is CF17
     C           *IN17     IFEQ '1'                        *IF
      * Backup Repayment files
     C                     EXSR UHSUBR                     Backup Repaymen
     C                     ELSE
      * CASE: CTL.*CMD key is CF19
     C           *IN19     IFEQ '1'                        *IF
      * Mark Unpaid records to interim Paid
     C                     EXSR UISUBR                     Mark Unpaid rec
     C                     ELSE
      * CASE: CTL.*CMD key is CF21
     C           *IN21     IFEQ '1'                        *IF
      * Mark interim Paid records to Repaid
     C                     EXSR UJSUBR                     Mark interim Pa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,35
     C                     SETOF                     98    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * USER: Process subfile record (Pre-confirm)
      * CASE: RCD.*SFLSEL is Select Option 5
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
      * Display record
     C                     EXSR UKSUBR                     Display record
     C                     ELSE
      * CASE: RCD.*SFLSEL is Select Option 6
     C           #1SEL     IFEQ '6'                        *IF
     C           #1SEL     OREQ ' 6'
      * Unpay Tattoo
     C                     EXSR ULSUBR                     Unpay Tattoo
     C                     ELSE
      * CASE: RCD.*SFLSEL is Select Option 9
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
      * Mark Trucker as Paid
     C                     EXSR UMSUBR                     Mark Trucker as
     C                     ELSE
      * CASE: RCD.*SFLSEL is Lock
     C           #1SEL     IFEQ 'L'                        *IF
      * Lock Buy Order Header
     C                     EXSR UNSUBR                     Lock Buy Order
     C                     ELSE
      * CASE: RCD.*SFLSEL is Slaughter
     C           #1SEL     IFEQ 'S'                        *IF
      * Mark Tattoo Process Code as Slaughter
     C                     EXSR UOSUBR                     Mark Tattoo Pro
     C                     ELSE
      * CASE: RCD.*SFLSEL is Payment
     C           #1SEL     IFEQ 'P'                        *IF
      * Mark Tattoo Process Code as Payment
     C                     EXSR UPSUBR                     Mark Tattoo Pro
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
      * SFLNXTCHG
     C                     SETON                     84
     C                     ELSE
      * SFLRCD valid
      * SFLNXTCHG
     C                     SETOF                     84
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN79
     C           #RLLST    IFEQ 'R'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @DOREZI fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     MOVELDOKLTX    #1KLTX           Tattoo Job Sel
     C                     Z-ADDDOHMNB    #1HMNB           BOH Company Num
     C                     MOVELDOKMTX    #1KMTX           Tattoo Job Sel
     C                     MOVELDOAECD    #1AECD           PL Location Cod
     C                     MOVELDOAAVN    #1AAVN           RS User Changed
     C                     Z-ADDDOAADT    #1AADT           RS Date Changed
     C                     Z-ADDDOAMTM    #1AMTM           RS Time Changed
     C                     MOVELDOAJST    #1AJST           RS Record Statu
     C                     MOVELDOAHVN    #1AHVN           RS Job
     C                     MOVELDOAGVN    #1AGVN           RS Program
     C                     MOVELDOABVN    #1ABVN           RS User Added
     C                     Z-ADDDOABDT    #1ABDT           RS Date Added
     C                     Z-ADDDOABTM    #1ABTM           RS Time Added
     C                     Z-ADDDOBNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDDOBONB    #1BONB           BOL Load Number
     C                     Z-ADDDOCVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADDDOB0DT    #1B0DT           TH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1B0DT
     C                     MOVELDOABCD    #1ABCD           PD Producer Cod
     C                     MOVELDOM9ST    #1M9ST           Repayment Statu
     C                     MOVEL*BLANK    #RLLST           TH Hog Class Ty
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL*BLANK    #RE1ST           TH Held Over Re
     C                     Z-ADD*ZERO     #RCWNB           TH Head Receive
     C                     MOVEL*BLANK    #RA6ST           BOH Status
     C                     MOVEL*BLANK    #RCWST           TH Payment Sts
     C                     MOVEL*BLANK    #RCSCD           THP Process Cod
     C                     MOVEL*BLANK    #RJPTX           Text 10 1 USR
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVELP1KLTX    #2KLTX           Tattoo Job Sel
     C                     Z-ADD*ZERO     #2HMNB           BOH Company Num
     C                     Z-ADD*ZERO     #CCKDT           Pmt Current Pay
      * Clear external version also
     C                     Z-ADD*ZERO     VCCKDT
     C                     Z-ADD*ZERO     #CMDNB           @Sequence 1.0
     C                     MOVEL*BLANK    #CJPTX           Text 10 1 USR
     C                     MOVEL*BLANK    #COBTX           Text descriptio
     C                     Z-ADD*ZERO     #2BNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     #2BONB           BOL Load Number
     C                     Z-ADD*ZERO     #2CVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     #2B0DT           TH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V2B0DT
     C                     MOVEL*BLANK    #2M9ST           Repayment Statu
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B0DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Pmt Current Payment Date to display format
      * Convert date
     C           1000000   ADD  #CCKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCCKDT
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #2B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2B0DT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Payment Processing RT - Payment Processing Parms  * Date/Ste
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           C4HONB           CC Company Numb
      * Setup key
     C                     Z-ADD#2HMNB    C4HONB           CC Company Numb
      * Establish starting position
     C           KRSSA     CHAIN@C4REO7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0434' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0003           Pmt Current Pay
     C                     Z-ADD*ZERO     #CMDNB           Pmt Current Pay
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDC4CKDT    YL0003           Pmt Current Pay
     C                     Z-ADDC4M1NB    #CMDNB           Pmt Current Pay
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv TH for Repayment - Tattoo Header  * Pay Sts/Prdcr/Loc/Proces
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A1BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSB     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #RCWNB           TH Head Receive
     C                     MOVEL*BLANK    #RCWST           TH Payment Sts
     C                     MOVEL*BLANK    #RE1ST           TH Held Over Re
     C                     MOVEL*BLANK    #RLLST           TH Hog Class Ty
     C                     MOVEL*BLANK    #RCSCD           THP Process Cod
     C                     MOVEL*BLANK    #1ABCD           PD Producer Cod
     C                     MOVEL*BLANK    #1AECD           PL Location Cod
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA1CWNB    #RCWNB           TH Head Receive
     C                     MOVELA1CWST    #RCWST           TH Payment Sts
     C                     MOVELA1E1ST    #RE1ST           TH Held Over Re
     C                     MOVELA1LLST    #RLLST           TH Hog Class Ty
     C                     MOVELA1CSCD    #RCSCD           THP Process Cod
     C                     MOVELA1ABCD    #1ABCD           PD Producer Cod
     C                     MOVELA1AECD    #1AECD           PL Location Cod
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv BOH Lock Sts      RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADD#1HMNB    AWHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSC     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RA6ST           BOH Status
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAWA6ST    #RA6ST           BOH Status
     C                     GOTO SCEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg Pymt Proc Parms   CH - Payment Processing Parms  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 10        RS User Changed
     C                     Z-ADD*ZERO     WN0002  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0003  60       RS Time Changed
     C                     MOVEL*BLANK    WN0004  1        RS Record Statu
     C                     MOVEL*BLANK    WN0005 10        RS Job
     C                     MOVEL*BLANK    WN0006 10        RS Program
     C                     MOVEL*BLANK    WN0007 10        RS User Added
     C                     Z-ADD*ZERO     WN0008  70       RS Date Added
     C                     Z-ADD*ZERO     WN0009  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADD#2HMNB    WAHONB           CC Company Numb
      *
     C           KLCHSD    KLIST
     C                     KFLD           WAHONB           CC Company Numb
     C           KLCHSD    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YARDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADD#CCKDT    WACKDT           Pmt Current Pay
     C                     Z-ADD1         WAM1NB           Pmt Current Pay
     C                     MOVEL'N'       WAKHST    P      PP Commission P
     C                     MOVEL'N'       WAKJST    P      PP Payment Erro
     C                     Z-ADD*ZERO     WAPINB           PP Unused Nbr 1
     C                     MOVEL'Y'       WAKKST    P      PP Repayment St
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WAAAVN           RS User Changed
     C                     Z-ADD##JDT     WAAADT           RS Date Changed
     C                     Z-ADD##JTM     WAAMTM           RS Time Changed
     C                     MOVEL##JOB     WAAHVN           RS Job
     C                     MOVEL##PGM     WAAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Chg Repay Sts     RT - Tattoo Header Job Sel  * Interim Paid
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0017           Count USR
     C                     Z-ADD*ZERO     YL0018           BOH Buy Order N
     C                     MOVEL'Y'       YL0019           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBKLTX    WQSE01           Tattoo Job Sel
     C           *LIKE     DEFN WBHMNB    WQSE02           BOH Company Num
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Tattoo Job Sel
     C                     KFLD           WQSE02           BOH Company Num
      * Setup key
     C                     MOVE *BLANK    WQSE01           Tattoo Job Sel
     C                     MOVEL'REPAY'   WQSE01           Tattoo Job Sel
     C                     Z-ADD#2HMNB    WQSE02           BOH Company Num
      * Establish starting position
     C           KRSSE     SETLL@DOREU3                    *
     C           KRSSE     READE@DOREU3                  90*
      * Data record not found
     C   90                MOVEL'PRK0639' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If request is to change records to interim Paid
      * CASE: PAR.Tattoo Job Sel Perm/Temp is Paid
     C           'P'       IFEQ 'P'                        *IF
      * If Repayment Status is Unpaid, change to Interim Paid
      * CASE: DB1.Tattoo Job Sel Perm/Temp is Unpaid
     C           WBM9ST    IFEQ 'U'                        *IF
      * RTV Tattoo Record     RT - Tattoo Header  * Pymt Sts/Prdcr/Loc
     C                     EXSR SFRVGN
      * Rtv BOH Lock Sts      RT - Buy Order Header  * BOH Sts
     C                     EXSR SGRVGN
      * If record unpaid, mark it as Interim Paid
      * CASE: Pymt Sts=SC, SL, IC, IL AND Process Code <> SLG
      *  - c2 AND NOTc3
      *   |- c2    : LCL.TH Payment Sts is Unpaid Producer
      *   |- c3    : LCL.THP Process Code is Slaughter
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0020    IFEQ 'ML'                       *IF
     C           YL0020    OREQ 'SL'
     C           YL0020    OREQ 'SC'
     C           YL0020    OREQ 'IC'
     C           YL0020    OREQ 'IL'
     C           YL0020    OREQ *BLANK
     C           YL0021    IFEQ 'SLG'                      *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * When Buy Order Number changes value, update Buy Order Header
      * CASE: LCL.BOH Buy Order Number NE DB1.BOH Buy Order Number
     C           YL0018    IFNE WBBNNB                     *IF
      * Update previous Buy Order Header record to Locked
      * Chg BOH Status-Repay  CH - Buy Order Header  * Locked
     C                     EXSR SHCHRC
     C                     Z-ADDWBBNNB    YL0018           BOH Buy Order N
     C                     END                             *FI
      * Determine Payment Sts value
      * CASE: LCL.TH Payment Sts is Select Live
     C           YL0020    IFEQ 'SL'                       *IF
     C                     MOVEL'PL'      YL0020           TH Payment Sts
     C                     ELSE
      * CASE: LCL.TH Payment Sts is Sl Carcass Merit
     C           YL0020    IFEQ 'SC'                       *IF
     C                     MOVEL'PC'      YL0020           TH Payment Sts
     C                     ELSE
      * CASE: LCL.TH Payment Sts is Sl Int Carc
     C           YL0020    IFEQ 'IC'                       *IF
     C                     MOVEL'NC'      YL0020           TH Payment Sts
     C                     ELSE
      * CASE: LCL.TH Payment Sts is Sl Int Live
     C           YL0020    IFEQ 'IL'                       *IF
     C                     MOVEL'NL'      YL0020           TH Payment Sts
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Chg Pay Sts           CH - Tattoo Header  * Paid
     C                     EXSR SICHRC
      * Chg Tattoo Header Job CH - Tattoo Header Job Sel  * Interim Paid
     C                     EXSR SJCHRC
     C                     ADD  1         YL0017           Count USR
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Tattoo Job Sel Perm/Temp is Repaid
     C           'P'       IFEQ 'R'                        *IF
      * If Repayment Status is Interim Paid, change to Repaid
      * CASE: DB1.Tattoo Job Sel Perm/Temp is Paid
     C           WBM9ST    IFEQ 'P'                        *IF
      * Chg Tattoo Header Job CH - Tattoo Header Job Sel  * Set Repay Sts
     C                     EXSR SKCHRC
     C                     ADD  1         YL0017           Count USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@DOREU3                  90*
     C                     ENDDO
      * USER: Exit processing
      * Update the Payment Parms to the current date
      * CASE: Counter > 0 AND Repayment Status = Paid
      *  - c1 AND c2
      *   |- c1    : PAR.Count USR is Greater than 1
      *   |- c2    : PAR.Tattoo Job Sel Perm/Temp is Paid
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFGT 1                          *IF
     C           'P'       IFEQ 'P'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Chg Payment Processing CH - Payment Processing Parms  * 
     C                     EXSR SLCHRC
     C                     END                             *FI
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Tattoo Record     RT - Tattoo Header  * Pymt Sts/Prdcr/Loc
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWBHMNB    A1HMNB           BOH Company Num
     C                     Z-ADDWBBNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    A1BONB           BOL Load Number
     C                     Z-ADDWBCVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSF     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA1CWST    YL0020           TH Payment Sts
     C                     MOVELA1CSCD    YL0021           THP Process Cod
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv BOH Lock Sts      RT - Buy Order Header  * BOH Sts
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWBHMNB    AWHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSG     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0022           BOH Status
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAWA6ST    YL0022           BOH Status
     C                     GOTO SGEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg BOH Status-Repay  CH - Buy Order Header  * Locked
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0010  70       BOH Buy Order D
     C                     Z-ADD*ZERO     WN0011  70       BOH Kill Date
     C                     MOVEL*BLANK    WN0012  1        BOH Payment Typ
     C                     MOVEL*BLANK    WN0013  1        BOH Buy Order T
     C                     Z-ADD*ZERO     WN0014  52       BOH Market Add/
     C                     MOVEL*BLANK    WN0015  1        BOH Delv Plan P
     C                     MOVEL*BLANK    WN0016  2        BOH Quote Price
     C                     Z-ADD*ZERO     WN0017  52       BOH Quoted Base
     C                     MOVEL*BLANK    WN0018  3        BOH Commodity M
     C                     MOVEL*BLANK    WN0019  7        BOH Commodity P
     C                     MOVEL*BLANK    WN0020  3        BOH Market Date
     C                     Z-ADD*ZERO     WN0021  70       BOH MPR Reporti
     C                     Z-ADD*ZERO     WN0022  70       BOH Hedge Date
     C                     Z-ADD*ZERO     WN0023  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0024  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0025  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0026  70       BOH Hedge Head
     C                     Z-ADD*ZERO     WN0027  70       BOH Hedge Refer
     C                     Z-ADD*ZERO     WN0028  70       BOH Hedge Time
     C                     Z-ADD*ZERO     WN0029  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0030  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0031  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0032  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0033 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0034 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0035 112       BOH Unused Nbr
     C                     MOVEL*BLANK    WN0036  1        BOH MPR Reporti
     C                     MOVEL*BLANK    WN0037  1        BOH MPR EST RPT
     C                     MOVEL*BLANK    WN0038  2        BOH MPR Purchas
     C                     MOVEL*BLANK    WN0039  3        BOH Status 4
     C                     MOVEL*BLANK    WN0040  3        BOH Status 5
     C                     Z-ADD*ZERO     WN0041  30       PPWS Company Nu
     C                     Z-ADD*ZERO     WN0042  40       CW Year
     C                     Z-ADD*ZERO     WN0043  20       CW Week Number
     C                     MOVEL*BLANK    WN0044  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0045  6        PL Location Cod
     C                     MOVEL*BLANK    WN0046  5        PC Contract Cod
     C                     MOVEL*BLANK    WN0047  5        PSC Sub-Contrac
     C                     MOVEL*BLANK    WN0048  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0049  3        PO Option Code
     C                     MOVEL*BLANK    WN0050  3        CMP Program Cod
     C                     MOVEL*BLANK    WN0051  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0052 10        RS User Changed
     C                     Z-ADD*ZERO     WN0053  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0054  60       RS Time Changed
     C                     MOVEL*BLANK    WN0055  1        RS Record Statu
     C                     MOVEL*BLANK    WN0056 10        RS Job
     C                     MOVEL*BLANK    WN0057 10        RS Program
     C                     MOVEL*BLANK    WN0058 10        RS User Added
     C                     Z-ADD*ZERO     WN0059  70       RS Date Added
     C                     Z-ADD*ZERO     WN0060  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AWCPAZ
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WCBNNB           BOH Buy Order N
      *
     C           KLCHSH    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C           KLCHSH    CHAIN@AWCPAZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAWCPL0'MDACP
     C                     MOVEL'@AWCPAZ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAW1    YBRDCS
      * Move non-key fields to @AWCPAZ
     C                     MOVEL'L'       WCA6ST    P      BOH Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AWCPAZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAWCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Pay Sts           CH - Tattoo Header  * Paid
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0061  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0062 10        TH Group Refere
     C                     MOVEL*BLANK    WN0063  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0064  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0065  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0066  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0067  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0068  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0069  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0070  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0071  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0072  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0073  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0074  50       TH Held Over
     C                     Z-ADD*ZERO     WN0075  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0076  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0077  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0078  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0079  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0080  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0081  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0082  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0083  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0084  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0085  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0086  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0087  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0088  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0089  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0090  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0091  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0092  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0093  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0094  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0095  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0096  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0097  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0098  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0099  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0100  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0101  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0102  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0103  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0104  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0105  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0106  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0107  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0108  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0109  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0110  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0111  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0112  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0113  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0114  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0115  1        TH Header Error
     C                     MOVEL*BLANK    WN0116  1        TH Detail Error
     C                     MOVEL*BLANK    WN0117  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0118  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0119  80       TH Commission A
     C                     Z-ADD*ZERO     WN0120  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0121  1        TH User Error O
     C                     MOVEL*BLANK    WN0122  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0123  1        TH Sex
     C                     Z-ADD*ZERO     WN0124  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0125  70       TH Commission P
     C                     Z-ADD*ZERO     WN0126  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0127  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0128  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0129  31       TH FFLI
     C                     Z-ADD*ZERO     WN0130  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0131  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0132  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0133  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0134  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0135  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0136  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0137  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0138  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0139  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0140  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0141  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0142  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0143  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0144  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0145  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0146  1        TH Source Type
     C                     MOVEL*BLANK    WN0147  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0148  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0149  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0150  3        TH Source Code
     C                     MOVEL*BLANK    WN0151  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0152  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0153  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0154  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0155  3        TH State
     C                     MOVEL*BLANK    WN0156  3        TH Unused Code
     C                     MOVEL*BLANK    WN0157  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0158  1        TH Commission S
     C                     MOVEL*BLANK    WN0159  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0160  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0161  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0162  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0163  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0164  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0165  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0166  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0167  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0168  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0169  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0170  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0171  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0172  3        TH PHA Average
     C                     MOVEL*BLANK    WN0173  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0174  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0175  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0176  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0177  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0178  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0179  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0180  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0181  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0182  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0183  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0184  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0185  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0186 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0187 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0188 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0189 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0190  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0191  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0192  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0193  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0194  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0195  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0196  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0197  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0198  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0199  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0200  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0201  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0202  70       TH Unused Date
     C                     MOVEL*BLANK    WN0203  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0204  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0205  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0206  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0207  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0208  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0209  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0210  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0211  6        DF Defect Code
     C                     MOVEL*BLANK    WN0212  6        THP Process Cod
     C                     MOVEL*BLANK    WN0213  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0214  6        PL Location Cod
     C                     MOVEL*BLANK    WN0215  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0216  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0217  3        HC Class Code
     C                     MOVEL*BLANK    WN0218 10        RS User Changed
     C                     Z-ADD*ZERO     WN0219  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0220  60       RS Time Changed
     C                     MOVEL*BLANK    WN0221  1        RS Record Statu
     C                     MOVEL*BLANK    WN0222 10        RS Job
     C                     MOVEL*BLANK    WN0223 10        RS Program
     C                     MOVEL*BLANK    WN0224 10        RS User Added
     C                     Z-ADD*ZERO     WN0225  70       RS Date Added
     C                     Z-ADD*ZERO     WN0226  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWBHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WDBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WDB0DT           TH Kill Date
      *
     C           KLCHSI    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLCHSI    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YCRDCS
      * Move non-key fields to @A1CPC5
     C                     MOVELYL0020    WDCWST    P      TH Payment Sts
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Chg/Crt Tatto/Spc Flds IF
      * HPE056 Payment Type
      * 1/10/96  HPE056   Allow payment type to be update based on
      *                   what the payment status is at the time this
      *                   tattoo is being updated
      * Function Description:  If there are any fields that need to be
      * Changed/Created during the Change functions or Create function
      * Presently: Payment Type
      * Add this routine to all of the change objects and create object
      * that update the Payment Type
      * CASE: PAR.TH Payment Sts is Live anything
     C           WDCWST    IFEQ 'ML'                       *IF
     C           WDCWST    OREQ 'PL'
     C           WDCWST    OREQ 'NL'
     C           WDCWST    OREQ 'SL'
     C           WDCWST    OREQ 'IL'
     C                     MOVEL'L'       WDJ9ST           TH Payment Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       WDJ9ST           TH Payment Type
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Tattoo Header Job CH - Tattoo Header Job Sel  * Interim Paid
      *================================================================
      *
     C                     MOVEL*BLANK    WN0227 10        RS User Changed
     C                     Z-ADD*ZERO     WN0228  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0229  60       RS Time Changed
     C                     MOVEL*BLANK    WN0230  1        RS Record Statu
     C                     MOVEL*BLANK    WN0231 10        RS Job
     C                     MOVEL*BLANK    WN0232 10        RS Program
     C                     MOVEL*BLANK    WN0233 10        RS User Added
     C                     Z-ADD*ZERO     WN0234  70       RS Date Added
     C                     Z-ADD*ZERO     WN0235  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @DOREU2
     C                     MOVELWBKLTX    WEKLTX    P      Tattoo Job Sel
     C                     Z-ADDWBHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WEBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WEKLTX           Tattoo Job Sel
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSJ    CHAIN@DOREU2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDOREL0'MDACP
     C                     MOVEL'@DOREU2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDO1    YDRDCS
      * Move non-key fields to @DOREU2
     C                     MOVELWBKMTX    WEKMTX    P      Tattoo Job Sel
     C                     MOVEL'P'       WEM9ST    P      Repayment Statu
     C                     MOVELYL0023    WEABCD    P      PD Producer Cod
     C                     MOVELYL0024    WEAECD    P      PL Location Cod
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDO1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDO1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@DOREU2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDOREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * Chg Tattoo Header Job CH - Tattoo Header Job Sel  * Set Repay St
      *================================================================
      *
     C                     MOVEL*BLANK    WN0236 10        RS User Changed
     C                     Z-ADD*ZERO     WN0237  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0238  60       RS Time Changed
     C                     MOVEL*BLANK    WN0239  1        RS Record Statu
     C                     MOVEL*BLANK    WN0240 10        RS Job
     C                     MOVEL*BLANK    WN0241 10        RS Program
     C                     MOVEL*BLANK    WN0242 10        RS User Added
     C                     Z-ADD*ZERO     WN0243  70       RS Date Added
     C                     Z-ADD*ZERO     WN0244  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @DOREU2
     C                     MOVELWBKLTX    WEKLTX    P      Tattoo Job Sel
     C                     Z-ADDWBHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WEBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSK    KLIST
     C                     KFLD           WEKLTX           Tattoo Job Sel
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSK    CHAIN@DOREU2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDOREL0'MDACP
     C                     MOVEL'@DOREU2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDO1    YERDCS
      * Move non-key fields to @DOREU2
     C                     MOVELWBKMTX    WEKMTX    P      Tattoo Job Sel
     C                     MOVEL'R'       WEM9ST    P      Repayment Statu
     C                     MOVELWBABCD    WEABCD    P      PD Producer Cod
     C                     MOVELWBAECD    WEAECD    P      PL Location Cod
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDO1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDO1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@DOREU2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDOREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Payment Processing CH - Payment Processing Parms  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADD#2HMNB    WAHONB           CC Company Numb
      *
     C           KLCHSL    KLIST
     C                     KFLD           WAHONB           CC Company Numb
     C           KLCHSL    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YFRDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADD##JDT     WACKDT           Pmt Current Pay
     C                     Z-ADD1         WAM1NB           Pmt Current Pay
     C                     MOVEL'N'       WAKHST    P      PP Commission P
     C                     MOVEL'N'       WAKJST    P      PP Payment Erro
     C                     Z-ADD*ZERO     WAPINB           PP Unused Nbr 1
     C                     MOVEL'N'       WAKKST    P      PP Repayment St
     C                     MOVELWBAAVN    WAAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    WAAADT           RS Date Changed
     C                     Z-ADDWBAMTM    WAAMTM           RS Time Changed
     C                     MOVELWBAJST    WAAJST    P      RS Record Statu
     C                     MOVELWBAHVN    WAAHVN    P      RS Job
     C                     MOVELWBAGVN    WAAGVN    P      RS Program
     C                     MOVELWBABVN    WAABVN    P      RS User Added
     C                     Z-ADDWBABDT    WAABDT           RS Date Added
     C                     Z-ADDWBABTM    WAABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Upd Pymt Prc Prm Repay RT - Payment Processing Parms  * Job Date
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           C4HONB           CC Company Numb
      * Setup key
     C                     Z-ADD#2HMNB    C4HONB           CC Company Numb
      * Establish starting position
     C           KRSSM     CHAIN@C4REO7              90    *
      * Data record not found
     C   90                MOVEL'PRK0434' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Pymt Proc Parms   CH - Payment Processing Parms  * 
     C                     EXSR SNCHRC
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Pymt Proc Parms   CH - Payment Processing Parms  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0245 10        RS User Changed
     C                     Z-ADD*ZERO     WN0246  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0247  60       RS Time Changed
     C                     MOVEL*BLANK    WN0248  1        RS Record Statu
     C                     MOVEL*BLANK    WN0249 10        RS Job
     C                     MOVEL*BLANK    WN0250 10        RS Program
     C                     MOVEL*BLANK    WN0251 10        RS User Added
     C                     Z-ADD*ZERO     WN0252  70       RS Date Added
     C                     Z-ADD*ZERO     WN0253  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADDC4HONB    WAHONB           CC Company Numb
      *
     C           KLCHSN    KLIST
     C                     KFLD           WAHONB           CC Company Numb
     C           KLCHSN    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YGRDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADD##JDT     WACKDT           Pmt Current Pay
     C                     Z-ADD1         WAM1NB           Pmt Current Pay
     C                     MOVELC4KHST    WAKHST    P      PP Commission P
     C                     MOVELC4KJST    WAKJST    P      PP Payment Erro
     C                     Z-ADDC4PINB    WAPINB           PP Unused Nbr 1
     C                     MOVEL'N'       WAKKST    P      PP Repayment St
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WAAAVN           RS User Changed
     C                     Z-ADD##JDT     WAAADT           RS Date Changed
     C                     Z-ADD##JTM     WAAMTM           RS Time Changed
     C                     MOVEL##JOB     WAAHVN           RS Job
     C                     MOVEL##PGM     WAAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Chg Repay Sts     RT - Tattoo Header Job Sel  * Set Status=R
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0017           Count USR
     C                     Z-ADD*ZERO     YL0018           BOH Buy Order N
     C                     MOVEL'Y'       YL0019           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBKLTX    WQSO01           Tattoo Job Sel
     C           *LIKE     DEFN WBHMNB    WQSO02           BOH Company Num
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Tattoo Job Sel
     C                     KFLD           WQSO02           BOH Company Num
      * Setup key
     C                     MOVE *BLANK    WQSO01           Tattoo Job Sel
     C                     MOVEL'REPAY'   WQSO01           Tattoo Job Sel
     C                     Z-ADD#2HMNB    WQSO02           BOH Company Num
      * Establish starting position
     C           KRSSO     SETLL@DOREU3                    *
     C           KRSSO     READE@DOREU3                  90*
      * Data record not found
     C   90                MOVEL'PRK0639' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If request is to change records to interim Paid
      * CASE: PAR.Tattoo Job Sel Perm/Temp is Paid
     C           'R'       IFEQ 'P'                        *IF
      * If Repayment Status is Unpaid, change to Interim Paid
      * CASE: DB1.Tattoo Job Sel Perm/Temp is Unpaid
     C           WBM9ST    IFEQ 'U'                        *IF
      * RTV Tattoo Record     RT - Tattoo Header  * Pymt Sts/Prdcr/Loc
     C                     EXSR SPRVGN
      * Rtv BOH Lock Sts      RT - Buy Order Header  * BOH Sts
     C                     EXSR SQRVGN
      * If record unpaid, mark it as Interim Paid
      * CASE: Pymt Sts=SC, SL, IC, IL AND Process Code <> SLG
      *  - c2 AND NOTc3
      *   |- c2    : LCL.TH Payment Sts is Unpaid Producer
      *   |- c3    : LCL.THP Process Code is Slaughter
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0020    IFEQ 'ML'                       *IF
     C           YL0020    OREQ 'SL'
     C           YL0020    OREQ 'SC'
     C           YL0020    OREQ 'IC'
     C           YL0020    OREQ 'IL'
     C           YL0020    OREQ *BLANK
     C           YL0021    IFEQ 'SLG'                      *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * When Buy Order Number changes value, update Buy Order Header
      * CASE: LCL.BOH Buy Order Number NE DB1.BOH Buy Order Number
     C           YL0018    IFNE WBBNNB                     *IF
      * Update previous Buy Order Header record to Locked
      * Chg BOH Status-Repay  CH - Buy Order Header  * Locked
     C                     EXSR SRCHRC
     C                     Z-ADDWBBNNB    YL0018           BOH Buy Order N
     C                     END                             *FI
      * Determine Payment Sts value
      * CASE: LCL.TH Payment Sts is Select Live
     C           YL0020    IFEQ 'SL'                       *IF
     C                     MOVEL'PL'      YL0020           TH Payment Sts
     C                     ELSE
      * CASE: LCL.TH Payment Sts is Sl Carcass Merit
     C           YL0020    IFEQ 'SC'                       *IF
     C                     MOVEL'PC'      YL0020           TH Payment Sts
     C                     ELSE
      * CASE: LCL.TH Payment Sts is Sl Int Carc
     C           YL0020    IFEQ 'IC'                       *IF
     C                     MOVEL'NC'      YL0020           TH Payment Sts
     C                     ELSE
      * CASE: LCL.TH Payment Sts is Sl Int Live
     C           YL0020    IFEQ 'IL'                       *IF
     C                     MOVEL'NL'      YL0020           TH Payment Sts
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Chg Pay Sts           CH - Tattoo Header  * Paid
     C                     EXSR SSCHRC
      * Chg Tattoo Header Job CH - Tattoo Header Job Sel  * Interim Paid
     C                     EXSR STCHRC
     C                     ADD  1         YL0017           Count USR
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Tattoo Job Sel Perm/Temp is Repaid
     C           'R'       IFEQ 'R'                        *IF
      * If Repayment Status is Interim Paid, change to Repaid
      * CASE: DB1.Tattoo Job Sel Perm/Temp is Paid
     C           WBM9ST    IFEQ 'P'                        *IF
      * Chg Tattoo Header Job CH - Tattoo Header Job Sel  * Set Repay Sts
     C                     EXSR SUCHRC
     C                     ADD  1         YL0017           Count USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@DOREU3                  90*
     C                     ENDDO
      * USER: Exit processing
      * Update the Payment Parms to the current date
      * CASE: Counter > 0 AND Repayment Status = Paid
      *  - c1 AND c2
      *   |- c1    : PAR.Count USR is Greater than 1
      *   |- c2    : PAR.Tattoo Job Sel Perm/Temp is Paid
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFGT 1                          *IF
     C           'R'       IFEQ 'P'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Chg Payment Processing CH - Payment Processing Parms  * 
     C                     EXSR SVCHRC
     C                     END                             *FI
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Tattoo Record     RT - Tattoo Header  * Pymt Sts/Prdcr/Loc
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWBHMNB    A1HMNB           BOH Company Num
     C                     Z-ADDWBBNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    A1BONB           BOL Load Number
     C                     Z-ADDWBCVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSP     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA1CWST    YL0020           TH Payment Sts
     C                     MOVELA1CSCD    YL0021           THP Process Cod
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv BOH Lock Sts      RT - Buy Order Header  * BOH Sts
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWBHMNB    AWHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSQ     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0022           BOH Status
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAWA6ST    YL0022           BOH Status
     C                     GOTO SQEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Chg BOH Status-Repay  CH - Buy Order Header  * Locked
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0254  70       BOH Buy Order D
     C                     Z-ADD*ZERO     WN0255  70       BOH Kill Date
     C                     MOVEL*BLANK    WN0256  1        BOH Payment Typ
     C                     MOVEL*BLANK    WN0257  1        BOH Buy Order T
     C                     Z-ADD*ZERO     WN0258  52       BOH Market Add/
     C                     MOVEL*BLANK    WN0259  1        BOH Delv Plan P
     C                     MOVEL*BLANK    WN0260  2        BOH Quote Price
     C                     Z-ADD*ZERO     WN0261  52       BOH Quoted Base
     C                     MOVEL*BLANK    WN0262  3        BOH Commodity M
     C                     MOVEL*BLANK    WN0263  7        BOH Commodity P
     C                     MOVEL*BLANK    WN0264  3        BOH Market Date
     C                     Z-ADD*ZERO     WN0265  70       BOH MPR Reporti
     C                     Z-ADD*ZERO     WN0266  70       BOH Hedge Date
     C                     Z-ADD*ZERO     WN0267  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0268  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0269  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0270  70       BOH Hedge Head
     C                     Z-ADD*ZERO     WN0271  70       BOH Hedge Refer
     C                     Z-ADD*ZERO     WN0272  70       BOH Hedge Time
     C                     Z-ADD*ZERO     WN0273  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0274  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0275  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0276  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0277 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0278 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0279 112       BOH Unused Nbr
     C                     MOVEL*BLANK    WN0280  1        BOH MPR Reporti
     C                     MOVEL*BLANK    WN0281  1        BOH MPR EST RPT
     C                     MOVEL*BLANK    WN0282  2        BOH MPR Purchas
     C                     MOVEL*BLANK    WN0283  3        BOH Status 4
     C                     MOVEL*BLANK    WN0284  3        BOH Status 5
     C                     Z-ADD*ZERO     WN0285  30       PPWS Company Nu
     C                     Z-ADD*ZERO     WN0286  40       CW Year
     C                     Z-ADD*ZERO     WN0287  20       CW Week Number
     C                     MOVEL*BLANK    WN0288  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0289  6        PL Location Cod
     C                     MOVEL*BLANK    WN0290  5        PC Contract Cod
     C                     MOVEL*BLANK    WN0291  5        PSC Sub-Contrac
     C                     MOVEL*BLANK    WN0292  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0293  3        PO Option Code
     C                     MOVEL*BLANK    WN0294  3        CMP Program Cod
     C                     MOVEL*BLANK    WN0295  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0296 10        RS User Changed
     C                     Z-ADD*ZERO     WN0297  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0298  60       RS Time Changed
     C                     MOVEL*BLANK    WN0299  1        RS Record Statu
     C                     MOVEL*BLANK    WN0300 10        RS Job
     C                     MOVEL*BLANK    WN0301 10        RS Program
     C                     MOVEL*BLANK    WN0302 10        RS User Added
     C                     Z-ADD*ZERO     WN0303  70       RS Date Added
     C                     Z-ADD*ZERO     WN0304  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @AWCPAZ
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WCBNNB           BOH Buy Order N
      *
     C           KLCHSR    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C           KLCHSR    CHAIN@AWCPAZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAWCPL0'MDACP
     C                     MOVEL'@AWCPAZ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAW1    YHRDCS
      * Move non-key fields to @AWCPAZ
     C                     MOVEL'L'       WCA6ST    P      BOH Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@AWCPAZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAWCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * Chg Pay Sts           CH - Tattoo Header  * Paid
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0305  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0306 10        TH Group Refere
     C                     MOVEL*BLANK    WN0307  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0308  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0309  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0310  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0311  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0312  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0313  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0314  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0315  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0316  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0317  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0318  50       TH Held Over
     C                     Z-ADD*ZERO     WN0319  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0320  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0321  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0322  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0323  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0324  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0325  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0326  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0327  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0328  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0329  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0330  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0331  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0332  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0333  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0334  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0335  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0336  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0337  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0338  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0339  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0340  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0341  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0342  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0343  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0344  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0345  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0346  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0347  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0348  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0349  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0350  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0351  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0352  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0353  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0354  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0355  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0356  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0357  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0358  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0359  1        TH Header Error
     C                     MOVEL*BLANK    WN0360  1        TH Detail Error
     C                     MOVEL*BLANK    WN0361  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0362  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0363  80       TH Commission A
     C                     Z-ADD*ZERO     WN0364  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0365  1        TH User Error O
     C                     MOVEL*BLANK    WN0366  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0367  1        TH Sex
     C                     Z-ADD*ZERO     WN0368  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0369  70       TH Commission P
     C                     Z-ADD*ZERO     WN0370  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0371  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0372  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0373  31       TH FFLI
     C                     Z-ADD*ZERO     WN0374  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0375  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0376  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0377  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0378  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0379  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0380  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0381  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0382  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0383  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0384  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0385  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0386  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0387  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0388  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0389  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0390  1        TH Source Type
     C                     MOVEL*BLANK    WN0391  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0392  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0393  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0394  3        TH Source Code
     C                     MOVEL*BLANK    WN0395  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0396  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0397  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0398  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0399  3        TH State
     C                     MOVEL*BLANK    WN0400  3        TH Unused Code
     C                     MOVEL*BLANK    WN0401  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0402  1        TH Commission S
     C                     MOVEL*BLANK    WN0403  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0404  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0405  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0406  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0407  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0408  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0409  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0410  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0411  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0412  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0413  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0414  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0415  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0416  3        TH PHA Average
     C                     MOVEL*BLANK    WN0417  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0418  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0419  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0420  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0421  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0422  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0423  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0424  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0425  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0426  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0427  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0428  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0429  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0430 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0431 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0432 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0433 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0434  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0435  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0436  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0437  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0438  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0439  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0440  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0441  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0442  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0443  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0444  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0445  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0446  70       TH Unused Date
     C                     MOVEL*BLANK    WN0447  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0448  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0449  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0450  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0451  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0452  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0453  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0454  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0455  6        DF Defect Code
     C                     MOVEL*BLANK    WN0456  6        THP Process Cod
     C                     MOVEL*BLANK    WN0457  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0458  6        PL Location Cod
     C                     MOVEL*BLANK    WN0459  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0460  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0461  3        HC Class Code
     C                     MOVEL*BLANK    WN0462 10        RS User Changed
     C                     Z-ADD*ZERO     WN0463  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0464  60       RS Time Changed
     C                     MOVEL*BLANK    WN0465  1        RS Record Statu
     C                     MOVEL*BLANK    WN0466 10        RS Job
     C                     MOVEL*BLANK    WN0467 10        RS Program
     C                     MOVEL*BLANK    WN0468 10        RS User Added
     C                     Z-ADD*ZERO     WN0469  70       RS Date Added
     C                     Z-ADD*ZERO     WN0470  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWBHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WDBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WDB0DT           TH Kill Date
      *
     C           KLCHSS    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLCHSS    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YIRDCS
      * Move non-key fields to @A1CPC5
     C                     MOVELYL0020    WDCWST    P      TH Payment Sts
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Chg/Crt Tatto/Spc Flds IF
      * HPE056 Payment Type
      * 1/10/96  HPE056   Allow payment type to be update based on
      *                   what the payment status is at the time this
      *                   tattoo is being updated
      * Function Description:  If there are any fields that need to be
      * Changed/Created during the Change functions or Create function
      * Presently: Payment Type
      * Add this routine to all of the change objects and create object
      * that update the Payment Type
      * CASE: PAR.TH Payment Sts is Live anything
     C           WDCWST    IFEQ 'ML'                       *IF
     C           WDCWST    OREQ 'PL'
     C           WDCWST    OREQ 'NL'
     C           WDCWST    OREQ 'SL'
     C           WDCWST    OREQ 'IL'
     C                     MOVEL'L'       WDJ9ST           TH Payment Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       WDJ9ST           TH Payment Type
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg Tattoo Header Job CH - Tattoo Header Job Sel  * Interim Paid
      *================================================================
      *
     C                     MOVEL*BLANK    WN0471 10        RS User Changed
     C                     Z-ADD*ZERO     WN0472  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0473  60       RS Time Changed
     C                     MOVEL*BLANK    WN0474  1        RS Record Statu
     C                     MOVEL*BLANK    WN0475 10        RS Job
     C                     MOVEL*BLANK    WN0476 10        RS Program
     C                     MOVEL*BLANK    WN0477 10        RS User Added
     C                     Z-ADD*ZERO     WN0478  70       RS Date Added
     C                     Z-ADD*ZERO     WN0479  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @DOREU2
     C                     MOVELWBKLTX    WEKLTX    P      Tattoo Job Sel
     C                     Z-ADDWBHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WEBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHST    KLIST
     C                     KFLD           WEKLTX           Tattoo Job Sel
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHST    CHAIN@DOREU2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDOREL0'MDACP
     C                     MOVEL'@DOREU2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDO1    YJRDCS
      * Move non-key fields to @DOREU2
     C                     MOVELWBKMTX    WEKMTX    P      Tattoo Job Sel
     C                     MOVEL'P'       WEM9ST    P      Repayment Statu
     C                     MOVELYL0023    WEABCD    P      PD Producer Cod
     C                     MOVELYL0024    WEAECD    P      PL Location Cod
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDO1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDO1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@DOREU2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDOREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg Tattoo Header Job CH - Tattoo Header Job Sel  * Set Repay St
      *================================================================
      *
     C                     MOVEL*BLANK    WN0480 10        RS User Changed
     C                     Z-ADD*ZERO     WN0481  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0482  60       RS Time Changed
     C                     MOVEL*BLANK    WN0483  1        RS Record Statu
     C                     MOVEL*BLANK    WN0484 10        RS Job
     C                     MOVEL*BLANK    WN0485 10        RS Program
     C                     MOVEL*BLANK    WN0486 10        RS User Added
     C                     Z-ADD*ZERO     WN0487  70       RS Date Added
     C                     Z-ADD*ZERO     WN0488  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @DOREU2
     C                     MOVELWBKLTX    WEKLTX    P      Tattoo Job Sel
     C                     Z-ADDWBHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WEBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSU    KLIST
     C                     KFLD           WEKLTX           Tattoo Job Sel
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSU    CHAIN@DOREU2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDOREL0'MDACP
     C                     MOVEL'@DOREU2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDO1    YKRDCS
      * Move non-key fields to @DOREU2
     C                     MOVELWBKMTX    WEKMTX    P      Tattoo Job Sel
     C                     MOVEL'R'       WEM9ST    P      Repayment Statu
     C                     MOVELWBABCD    WEABCD    P      PD Producer Cod
     C                     MOVELWBAECD    WEAECD    P      PL Location Cod
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDO1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDO1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@DOREU2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDOREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * Chg Payment Processing CH - Payment Processing Parms  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADD#2HMNB    WAHONB           CC Company Numb
      *
     C           KLCHSV    KLIST
     C                     KFLD           WAHONB           CC Company Numb
     C           KLCHSV    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YLRDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADD##JDT     WACKDT           Pmt Current Pay
     C                     Z-ADD1         WAM1NB           Pmt Current Pay
     C                     MOVEL'N'       WAKHST    P      PP Commission P
     C                     MOVEL'N'       WAKJST    P      PP Payment Erro
     C                     Z-ADD*ZERO     WAPINB           PP Unused Nbr 1
     C                     MOVEL'N'       WAKKST    P      PP Repayment St
     C                     MOVELWBAAVN    WAAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    WAAADT           RS Date Changed
     C                     Z-ADDWBAMTM    WAAMTM           RS Time Changed
     C                     MOVELWBAJST    WAAJST    P      RS Record Statu
     C                     MOVELWBAHVN    WAAHVN    P      RS Job
     C                     MOVELWBAGVN    WAAGVN    P      RS Program
     C                     MOVELWBABVN    WAABVN    P      RS User Added
     C                     Z-ADDWBABDT    WAABDT           RS Date Added
     C                     Z-ADDWBABTM    WAABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Chg Tattoo Hdr JS HO  RT - Tattoo Header Job Sel  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBKLTX    WQSW01           Tattoo Job Sel
     C           *LIKE     DEFN WBHMNB    WQSW02           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSW03           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSW04           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQSW05           TH Tattoo Numbe
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Tattoo Job Sel
     C                     KFLD           WQSW02           BOH Company Num
     C                     KFLD           WQSW03           BOH Buy Order N
     C                     KFLD           WQSW04           BOL Load Number
     C                     KFLD           WQSW05           TH Tattoo Numbe
      * Setup key
     C                     MOVEL#1KLTX    WQSW01           Tattoo Job Sel
     C                     Z-ADD#1HMNB    WQSW02           BOH Company Num
     C                     Z-ADD#1BNNB    WQSW03           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSW04           BOL Load Number
     C                     Z-ADD#1CVNB    WQSW05           TH Tattoo Numbe
      * Establish starting position
     C           KRSSW     SETLL@DOREU3                    *
     C           KRSSW     READE@DOREU3                  90*
      * Data record not found
     C   90                MOVEL'PRK0639' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Tattoo Header Job CH - Tattoo Header Job Sel  * Unpaid
     C                     EXSR SXCHRC
     C           KRSSW     READE@DOREU3                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Chg Tattoo Header Job CH - Tattoo Header Job Sel  * Unpaid
      *================================================================
      *
     C                     MOVEL*BLANK    WN0489 10        RS User Changed
     C                     Z-ADD*ZERO     WN0490  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0491  60       RS Time Changed
     C                     MOVEL*BLANK    WN0492  1        RS Record Statu
     C                     MOVEL*BLANK    WN0493 10        RS Job
     C                     MOVEL*BLANK    WN0494 10        RS Program
     C                     MOVEL*BLANK    WN0495 10        RS User Added
     C                     Z-ADD*ZERO     WN0496  70       RS Date Added
     C                     Z-ADD*ZERO     WN0497  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YMRDC   1
      *
      * Move key fields to @DOREU2
     C                     MOVEL#1KLTX    WEKLTX    P      Tattoo Job Sel
     C                     Z-ADD#1HMNB    WEHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WEBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSX    KLIST
     C                     KFLD           WEKLTX           Tattoo Job Sel
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSX    CHAIN@DOREU2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDOREL0'MDACP
     C                     MOVEL'@DOREU2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDO1    YMRDCS
      * Move non-key fields to @DOREU2
     C                     MOVELWBKMTX    WEKMTX    P      Tattoo Job Sel
     C                     MOVEL'U'       WEM9ST    P      Repayment Statu
     C                     MOVELWBABCD    WEABCD    P      PD Producer Cod
     C                     MOVELWBAECD    WEAECD    P      PL Location Cod
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDO1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDO1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YMRDC     IFEQ 'Y'
     C                     UPDAT@DOREU2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDOREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * Chg Trucker Pymt Sts  CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0498  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0499  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0500  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0501  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0502  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0503  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0504  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0505  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0506  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0507  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0508  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0509  71       BOL Live Wgt Re
     C                     Z-ADD*ZERO     WN0510  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0511  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0512  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0513 11        BOL Trailer
     C                     MOVEL*BLANK    WN0514  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0515  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0516  1        BOL Truck Scale
     C                     Z-ADD*ZERO     WN0517  50       BOL Shipped Hea
     C                     MOVEL*BLANK    WN0518  1        Reported to USD
     C                     MOVEL*BLANK    WN0519  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0520  1        BOL Violated Au
     C                     MOVEL*BLANK    WN0521  2        BOL Status 5
     C                     MOVEL*BLANK    WN0522  2        BOL Status 6
     C                     MOVEL*BLANK    WN0523  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0524  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0525  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0526  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0527  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0528  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0529 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0530 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0531 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0532 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0533 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0534  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0535  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0536  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0537  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0538  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0539  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0540  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0541  6        PL Location Cod
     C                     MOVEL*BLANK    WN0542 10        RS User Changed
     C                     Z-ADD*ZERO     WN0543  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0544  60       RS Time Changed
     C                     MOVEL*BLANK    WN0545  1        RS Record Statu
     C                     MOVEL*BLANK    WN0546 10        RS Job
     C                     MOVEL*BLANK    WN0547 10        RS Program
     C                     MOVEL*BLANK    WN0548 10        RS User Added
     C                     Z-ADD*ZERO     WN0549  70       RS Date Added
     C                     Z-ADD*ZERO     WN0550  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YNRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADD#1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    AXBONB           BOL Load Number
      *
     C           KLCHSY    KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
     C           KLCHSY    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YNRDCS
      * Move non-key fields to @AXCPBY
     C                     MOVEL'PT'      AXCNST    P      BOL Trucker Pay
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     AXAAVN           RS User Changed
     C                     Z-ADD##JDT     AXAADT           RS Date Changed
     C                     Z-ADD##JTM     AXAMTM           RS Time Changed
     C                     MOVEL##JOB     AXAHVN           RS Job
     C                     MOVEL##PGM     AXAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YNRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCHRC    BEGSR
      *================================================================
      * Chg BOH Status-Repay  CH - Buy Order Header  * Locked
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0551  70       BOH Buy Order D
     C                     Z-ADD*ZERO     WN0552  70       BOH Kill Date
     C                     MOVEL*BLANK    WN0553  1        BOH Payment Typ
     C                     MOVEL*BLANK    WN0554  1        BOH Buy Order T
     C                     Z-ADD*ZERO     WN0555  52       BOH Market Add/
     C                     MOVEL*BLANK    WN0556  1        BOH Delv Plan P
     C                     MOVEL*BLANK    WN0557  2        BOH Quote Price
     C                     Z-ADD*ZERO     WN0558  52       BOH Quoted Base
     C                     MOVEL*BLANK    WN0559  3        BOH Commodity M
     C                     MOVEL*BLANK    WN0560  7        BOH Commodity P
     C                     MOVEL*BLANK    WN0561  3        BOH Market Date
     C                     Z-ADD*ZERO     WN0562  70       BOH MPR Reporti
     C                     Z-ADD*ZERO     WN0563  70       BOH Hedge Date
     C                     Z-ADD*ZERO     WN0564  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0565  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0566  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0567  70       BOH Hedge Head
     C                     Z-ADD*ZERO     WN0568  70       BOH Hedge Refer
     C                     Z-ADD*ZERO     WN0569  70       BOH Hedge Time
     C                     Z-ADD*ZERO     WN0570  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0571  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0572  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0573  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0574 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0575 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0576 112       BOH Unused Nbr
     C                     MOVEL*BLANK    WN0577  1        BOH MPR Reporti
     C                     MOVEL*BLANK    WN0578  1        BOH MPR EST RPT
     C                     MOVEL*BLANK    WN0579  2        BOH MPR Purchas
     C                     MOVEL*BLANK    WN0580  3        BOH Status 4
     C                     MOVEL*BLANK    WN0581  3        BOH Status 5
     C                     Z-ADD*ZERO     WN0582  30       PPWS Company Nu
     C                     Z-ADD*ZERO     WN0583  40       CW Year
     C                     Z-ADD*ZERO     WN0584  20       CW Week Number
     C                     MOVEL*BLANK    WN0585  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0586  6        PL Location Cod
     C                     MOVEL*BLANK    WN0587  5        PC Contract Cod
     C                     MOVEL*BLANK    WN0588  5        PSC Sub-Contrac
     C                     MOVEL*BLANK    WN0589  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0590  3        PO Option Code
     C                     MOVEL*BLANK    WN0591  3        CMP Program Cod
     C                     MOVEL*BLANK    WN0592  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0593 10        RS User Changed
     C                     Z-ADD*ZERO     WN0594  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0595  60       RS Time Changed
     C                     MOVEL*BLANK    WN0596  1        RS Record Statu
     C                     MOVEL*BLANK    WN0597 10        RS Job
     C                     MOVEL*BLANK    WN0598 10        RS Program
     C                     MOVEL*BLANK    WN0599 10        RS User Added
     C                     Z-ADD*ZERO     WN0600  70       RS Date Added
     C                     Z-ADD*ZERO     WN0601  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YORDC   1
      *
      * Move key fields to @AWCPAZ
     C                     Z-ADD#1HMNB    WCHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WCBNNB           BOH Buy Order N
      *
     C           KLCHSZ    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C           KLCHSZ    CHAIN@AWCPAZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAWCPL0'MDACP
     C                     MOVEL'@AWCPAZ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAW1    YORDCS
      * Move non-key fields to @AWCPAZ
     C                     MOVEL'L'       WCA6ST    P      BOH Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YORDC     IFEQ 'Y'
     C                     UPDAT@AWCPAZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAWCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACHRC    BEGSR
      *================================================================
      * Chg TH Process Code   CH - Tattoo Header  * Set to Slaughter
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0602  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0603 10        TH Group Refere
     C                     MOVEL*BLANK    WN0604  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0605  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0606  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0607  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0608  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0609  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0610  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0611  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0612  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0613  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0614  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0615  50       TH Held Over
     C                     Z-ADD*ZERO     WN0616  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0617  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0618  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0619  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0620  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0621  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0622  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0623  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0624  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0625  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0626  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0627  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0628  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0629  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0630  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0631  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0632  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0633  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0634  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0635  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0636  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0637  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0638  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0639  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0640  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0641  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0642  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0643  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0644  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0645  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0646  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0647  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0648  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0649  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0650  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0651  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0652  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0653  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0654  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0655  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0656  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0657  1        TH Header Error
     C                     MOVEL*BLANK    WN0658  1        TH Detail Error
     C                     MOVEL*BLANK    WN0659  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0660  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0661  80       TH Commission A
     C                     Z-ADD*ZERO     WN0662  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0663  1        TH User Error O
     C                     MOVEL*BLANK    WN0664  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0665  1        TH Sex
     C                     Z-ADD*ZERO     WN0666  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0667  70       TH Commission P
     C                     Z-ADD*ZERO     WN0668  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0669  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0670  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0671  31       TH FFLI
     C                     Z-ADD*ZERO     WN0672  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0673  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0674  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0675  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0676  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0677  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0678  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0679  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0680  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0681  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0682  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0683  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0684  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0685  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0686  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0687  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0688  1        TH Source Type
     C                     MOVEL*BLANK    WN0689  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0690  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0691  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0692  3        TH Source Code
     C                     MOVEL*BLANK    WN0693  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0694  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0695  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0696  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0697  3        TH State
     C                     MOVEL*BLANK    WN0698  3        TH Unused Code
     C                     MOVEL*BLANK    WN0699  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0700  1        TH Commission S
     C                     MOVEL*BLANK    WN0701  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0702  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0703  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0704  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0705  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0706  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0707  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0708  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0709  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0710  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0711  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0712  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0713  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0714  3        TH PHA Average
     C                     MOVEL*BLANK    WN0715  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0716  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0717  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0718  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0719  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0720  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0721  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0722  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0723  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0724  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0725  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0726  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0727  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0728 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0729 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0730 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0731 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0732  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0733  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0734  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0735  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0736  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0737  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0738  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0739  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0740  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0741  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0742  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0743  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0744  70       TH Unused Date
     C                     MOVEL*BLANK    WN0745  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0746  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0747  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0748  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0749  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0750  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0751  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0752  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0753  6        DF Defect Code
     C                     MOVEL*BLANK    WN0754  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0755  6        PL Location Cod
     C                     MOVEL*BLANK    WN0756  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0757  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0758  3        HC Class Code
     C                     MOVEL*BLANK    WN0759 10        RS User Changed
     C                     Z-ADD*ZERO     WN0760  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0761  60       RS Time Changed
     C                     MOVEL*BLANK    WN0762  1        RS Record Statu
     C                     MOVEL*BLANK    WN0763 10        RS Job
     C                     MOVEL*BLANK    WN0764 10        RS Program
     C                     MOVEL*BLANK    WN0765 10        RS User Added
     C                     Z-ADD*ZERO     WN0766  70       RS Date Added
     C                     Z-ADD*ZERO     WN0767  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YPRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADD#1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WDBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WDB0DT           TH Kill Date
      *
     C           KLCHTA    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLCHTA    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YPRDCS
      * Move non-key fields to @A1CPC5
     C                     MOVEL'SLG'     WDCSCD    P      THP Process Cod
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YPRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCHRC    BEGSR
      *================================================================
      * Chg TH Process Code   CH - Tattoo Header  * Set to Payment
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0768  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0769 10        TH Group Refere
     C                     MOVEL*BLANK    WN0770  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0771  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0772  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0773  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0774  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0775  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0776  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0777  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0778  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0779  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0780  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0781  50       TH Held Over
     C                     Z-ADD*ZERO     WN0782  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0783  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0784  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0785  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0786  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0787  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0788  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0789  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0790  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0791  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0792  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0793  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0794  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0795  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0796  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0797  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0798  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0799  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0800  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0801  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0802  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0803  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0804  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0805  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0806  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0807  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0808  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0809  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0810  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0811  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0812  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0813  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0814  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0815  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0816  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0817  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0818  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0819  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0820  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0821  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0822  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0823  1        TH Header Error
     C                     MOVEL*BLANK    WN0824  1        TH Detail Error
     C                     MOVEL*BLANK    WN0825  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0826  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0827  80       TH Commission A
     C                     Z-ADD*ZERO     WN0828  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0829  1        TH User Error O
     C                     MOVEL*BLANK    WN0830  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0831  1        TH Sex
     C                     Z-ADD*ZERO     WN0832  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0833  70       TH Commission P
     C                     Z-ADD*ZERO     WN0834  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0835  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0836  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0837  31       TH FFLI
     C                     Z-ADD*ZERO     WN0838  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0839  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0840  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0841  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0842  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0843  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0844  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0845  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0846  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0847  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0848  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0849  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0850  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0851  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0852  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0853  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0854  1        TH Source Type
     C                     MOVEL*BLANK    WN0855  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0856  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0857  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0858  3        TH Source Code
     C                     MOVEL*BLANK    WN0859  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0860  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0861  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0862  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0863  3        TH State
     C                     MOVEL*BLANK    WN0864  3        TH Unused Code
     C                     MOVEL*BLANK    WN0865  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0866  1        TH Commission S
     C                     MOVEL*BLANK    WN0867  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0868  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0869  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0870  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0871  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0872  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0873  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0874  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0875  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0876  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0877  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0878  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0879  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0880  3        TH PHA Average
     C                     MOVEL*BLANK    WN0881  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0882  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0883  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0884  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0885  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0886  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0887  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0888  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0889  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0890  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0891  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0892  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0893  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0894 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0895 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0896 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0897 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0898  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0899  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0900  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0901  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0902  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0903  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0904  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0905  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0906  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0907  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0908  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0909  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0910  70       TH Unused Date
     C                     MOVEL*BLANK    WN0911  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0912  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0913  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0914  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0915  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0916  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0917  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0918  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0919  6        DF Defect Code
     C                     MOVEL*BLANK    WN0920  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0921  6        PL Location Cod
     C                     MOVEL*BLANK    WN0922  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0923  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0924  3        HC Class Code
     C                     MOVEL*BLANK    WN0925 10        RS User Changed
     C                     Z-ADD*ZERO     WN0926  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0927  60       RS Time Changed
     C                     MOVEL*BLANK    WN0928  1        RS Record Statu
     C                     MOVEL*BLANK    WN0929 10        RS Job
     C                     MOVEL*BLANK    WN0930 10        RS Program
     C                     MOVEL*BLANK    WN0931 10        RS User Added
     C                     Z-ADD*ZERO     WN0932  70       RS Date Added
     C                     Z-ADD*ZERO     WN0933  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YQRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADD#1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WDBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WDB0DT           TH Kill Date
      *
     C           KLCHTB    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLCHTB    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL017.
     C                     MOVEL'LBL017'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YQRDCS
      * Move non-key fields to @A1CPC5
     C                     MOVEL'PAYMNT'  WDCSCD    P      THP Process Cod
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YQRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Update CTL values to saved values and set Repayment Status to AL
      *================================================================
      * Save the current values of the positioner fields
     C                     Z-ADD#2B0DT    YL0010           Kill Date Usr
     C                     Z-ADD#2BNNB    YL0011           Buy Order Numbe
     C                     Z-ADD#2BONB    YL0012           Load Number
     C                     Z-ADD#2CVNB    YL0013           Tattoo Number U
      * Reset Toggle to ALL records
     C                     MOVEL*BLANK    #2M9ST           Repayment Statu
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Create new records
      *================================================================
     C                     Z-ADD#CCKDT    YL0003           Pmt Current Pay
      * Sel Tattoo Hdr Repay  DF - Tattoo Header  * 
     C                     CALL 'PWIJDFR'              90  Sel Tattoo Hdr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2HMNB    WQ0004  30       BOH Company Num
     C           #2BNNB    PARM #2BNNB    WQ0005  70       BOH Buy Order N
     C           #2BONB    PARM #2BONB    WQ0006  50       BOL Load Number
     C           #2CVNB    PARM #2CVNB    WQ0007  50       TH Tattoo Numbe
     C           #2B0DT    PARM #2B0DT    WQ0008  70       TH Kill Date
     C           YL0014    PARM YL0014    WQ0009  30       Count USR 2
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWIJDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     SETON                     3334  *
     C                     END
      * If counter not zero, set Payment Date and reload subfile
      * CASE: LCL.Count USR 2 is Entered
     C           YL0014    IFNE *ZERO                      *IF
      * Set Parm Payment Date
      * CASE: CTL.Pmt Current Payment Date EQ JOB.*Job date
     C           #CCKDT    IFEQ ##JDT                      *IF
      * If returned Kill Date < Payment Parm Date
      * CASE: CTL.TH Kill Date LT CTL.Pmt Current Payment Date
     C           #2B0DT    IFLT #CCKDT                     *IF
     C                     Z-ADD#2B0DT    #CCKDT           Pmt Current Pay
     C                     END                             *FI
     C                     ELSE
      * CASE: CTL.TH Kill Date GT CTL.Pmt Current Payment Date
     C           #2B0DT    IFGT #CCKDT                     *IF
     C                     Z-ADD#2B0DT    #CCKDT           Pmt Current Pay
     C                     END                             *FI
     C                     END                             *FI
      * Chg Pymt Proc Parms   CH - Payment Processing Parms  * 
     C                     EXSR SDCHRC
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * If returned Kill Date is zero, reset to current payment date
      * CASE: CTL.TH Kill Date is Not Entered
     C           #2B0DT    IFEQ *ZERO                      *IF
     C                     Z-ADDYL0003    #CCKDT           Pmt Current Pay
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Toggle processing
      *================================================================
      * Toggle CTL value
      * CASE: CTL.Tattoo Job Sel Perm/Temp is Not Entered
     C           #2M9ST    IFEQ *BLANK                     *IF
     C                     MOVEL'U'       #2M9ST           Repayment Statu
     C                     ELSE
      * CASE: CTL.Tattoo Job Sel Perm/Temp is Unpaid
     C           #2M9ST    IFEQ 'U'                        *IF
     C                     MOVEL'P'       #2M9ST           Repayment Statu
     C                     ELSE
      * CASE: CTL.Tattoo Job Sel Perm/Temp is Paid
     C           #2M9ST    IFEQ 'P'                        *IF
     C                     MOVEL'R'       #2M9ST           Repayment Statu
     C                     ELSE
      * CASE: CTL.Tattoo Job Sel Perm/Temp is Repaid
     C           #2M9ST    IFEQ 'R'                        *IF
     C                     MOVEL'T'       #2M9ST           Repayment Statu
     C                     ELSE
      * CASE: CTL.Tattoo Job Sel Perm/Temp is Transferred
     C           #2M9ST    IFEQ 'T'                        *IF
     C                     MOVEL*BLANK    #2M9ST           Repayment Statu
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Edit User Profile
      *================================================================
      * EDT User Profile OMS  E1 - STR Order Management Sys  * 
     C                     CALL 'PDZBE1R'              90  EDT User Profil
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0010 10        USER ID
     C                     PARM YL0015    WQ0011 10        User Code Model
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZBE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV Default Co No App XF - STR Order Management Sys  * 
     C                     CALL 'PMD4XFR'              90  RTV Default Co
     C                     PARM *BLANK    W0RTN   7
     C           YL0001    PARM *BLANK    WQ0012  3        Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMD4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVE YL0001    YL0016           BOH Company Num
     C                     MOVE YL0001    #2HMNB           BOH Company Num
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Edit Payment Date and Step
      *================================================================
      * Edt Payment Process   E1 - Payment Processing Parms  * Chg Pymt D
     C                     CLEARPARC
     C                     Z-ADD#2HMNB    PAHONB           CC Company Numb
      *
     C                     CALL 'PKSPE1R'              90  Edt Payment Pro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Payment Pr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKSPE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Call Payment Edit/Post Process
      *================================================================
      * PMT Payment Process   PV - Company Control HPE  * 
     C                     CALL 'PKXAPVR'              90  PMT Payment Pro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0013  50       TRH Repayment I
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXAPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Show Payment Current Payment Dates
      *================================================================
      * Edt Pymt Proc Parms   PV - Payment Processing Parms  * 
     C                     CALL 'PWINPVR'              90  Edt Pymt Proc P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2HMNB    WQ0014  30       CC Company Numb
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWINPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Backup Repayment files
      *================================================================
      * Pmt Repay File Backup PV - STR Batch Processing  * Backup Files
     C                     CALL 'PWHEPVR'              90  Pmt Repay File
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2HMNB    WQ0015  30       BOH Company Num
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWHEPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If Backup submitted, change warning message
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'P'       YL0005           File Backup Sta
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,012   CAT  @CN,013:ZQ#COBTX    P      Text descriptio
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Mark Unpaid records to interim Paid
      *================================================================
      * Note: F19 is used to set the Payment Status to Paid on the Tattoo
      *       Header, set the Buy Order Status to Locked, and set the
      *       Repayment Status to Paid.  After this step is performed, th
      *       user will run the sequel view to attach to the email that i
      *       sent to the requestor to show them that the Tattoo is paid
      *       and the Payment Date/Step has been changed to the current
      *       date and step 1.  Also, the Payment Date and Step will be
      *       changed to the current date and step 1.
      * Rtv Chg Repay Sts     RT - Tattoo Header Job Sel  * Interim Paid
     C                     EXSR SERVGN
      * Setup message data for message
     C                     MOVEL'Paid'    ZA0002           Repayment Statu
     C                     Z-ADDYL0017    ZA0003           Count USR
      * Send message 'Repay Records Updated'
     C                     MOVEL'PRK1534' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * If Count > 0, update repayment status
      * CASE: LCL.Count USR is GT Zero
     C           YL0017    IFGT *ZERO                      *IF
      * Upd Pymt Prc Prm Repay RT - Payment Processing Parms  * Job Date/
     C                     EXSR SMRVGN
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Mark interim Paid records to Repaid
      *================================================================
      * Note: F21 is used to set the Repayment Status to Repaid after
      *       sending the email to the requestor.  This is the last step
      *       in the repayment process.
      * Pmt Sql Warning 4 RepayPV - Tattoo Header Job Sel  * 
     C                     CALL 'PWIZPVR'              90  Pmt Mark Paid t
     C                     PARM *BLANK    W0RTN   7
     C           YL0025    PARM YL0025    WQ0016  1        Select Y/N USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWIZPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Select Y/N USR 1 is Yes
     C           YL0025    IFEQ 'Y'                        *IF
      * Rtv Chg Repay Sts     RT - Tattoo Header Job Sel  * Set Status=R
     C                     EXSR SORVGN
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      * Setup message data for message
     C                     MOVEL@CN,010   ZA0004           Repayment Statu
     C                     Z-ADDYL0017    ZA0005           Count USR
      * Send message 'Repay Records Updated'
     C                     MOVEL'PRK1534' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Display record
      *================================================================
      * Dsp Ttto Hdr Job Sel  PV - Tattoo Header Job Sel  * 
     C                     CALL 'PWIBPVR'              90  Dsp Ttto Hdr Jo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2KLTX    WQ0017 10        Tattoo Job Sel
     C                     PARM #2HMNB    WQ0018  30       BOH Company Num
     C                     PARM #1BNNB    WQ0019  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0020  50       BOL Load Number
     C                     PARM #1CVNB    WQ0021  50       TH Tattoo Numbe
     C                     PARM #1B0DT    WQ0022  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWIBPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Unpay Tattoo
      *================================================================
      * CASE: RCD.Tattoo Job Sel Perm/Temp is Eligible to Unpay
     C           #1M9ST    IFEQ *BLANK                     *IF
     C           #1M9ST    OREQ 'P'
     C           #1M9ST    OREQ 'R'
      * Rtv Company Values    XF - STR Order Management Sys  * HPEREPAYBU
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2HMNB    WQ0023  30       BOH Company Num
     C                     PARM @CN,001   WQ0024 10        Company Value C
     C           YL0004    PARM *BLANK    WQ0025 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Breakout Repayment Backup file values
      * CASE: *OTHERWISE
      * 1. Backup Status (position 1)
     C                     Z-ADD1         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0004:ZQ YL0005    P  90  File Backup Sta
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * 2. Date of Backup (positions 2-8)
     C                     Z-ADD7         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0004:ZQ YL0006    P  90  Date Alpha USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0006    YL0007           Last Run Date
     C                     MOVEL*BLANK    YL0008           Date From Conve
     C                     MOVELYL0007    YL0008           Date From Conve
      * 3. Last file backed up (positions 9 - 18)
     C                     Z-ADD10        YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0004:ZQ YL0009    P  90  File
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Determine screen backup message
      * CASE: LCL.File Backup Status USR is Backup completed
     C           YL0005    IFEQ 'C'                        *IF
      * If Backup Date <> Job Date, files not backed up
      * CASE: LCL.Last Run Date NE JOB.*Job date
     C           YL0007    IFNE ##JDT                      *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0006           *SFLSEL
      * Send message 'Cannot Unpay-Backup NC'
     C                     MOVEL'PRK1519' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
      *
     C                     ELSE
      * CASE: LCL.Last Run Date EQ JOB.*Job date
     C           YL0007    IFEQ ##JDT                      *IF
      * If record is paid, make it unpaid
      * CASE: Payment Status is PC, PL, SC, or SL
      *  - c1 OR c2
      *   |- c1    : RCD.TH Payment Sts is Paid Producer
      *   |- c2    : RCD.TH Payment Sts is Unpaid Producer
      *   '-
     C           #RCWST    IFEQ 'PL'                       *IF
     C           #RCWST    OREQ 'PC'
     C           #RCWST    OREQ 'NC'
     C           #RCWST    OREQ 'NL'
     C           #RCWST    OREQ 'ML'                       *OR
     C           #RCWST    OREQ 'SL'
     C           #RCWST    OREQ 'SC'
     C           #RCWST    OREQ 'IC'
     C           #RCWST    OREQ 'IL'
     C           #RCWST    OREQ *BLANK
      * Pmt Sel Re-Ev/Tattoo  PV - Tattoo Header  * 
     C                     CALL 'PKBAPVR'              90  Pmt Sel Re-Ev/T
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0026  30       BOH Company Num
     C                     PARM #1CVNB    WQ0027  50       TH Tattoo Numbe
     C                     PARM #1B0DT    WQ0028  70       TH Kill Date
     C                     PARM #1B0DT    WQ0029  70       Kill Date 2 USR
     C                     PARM '*NO'     WQ0030  4        Carcass Detail
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBAPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * If F3 pressed, do not reload subfile; ELSE update record
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,014                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     ELSE
      * CASE: *OTHERWISE
      * Use RTVOBJ to update Payment Processing Parms with Date
      * Use RTVOBJ to update held over record if there is one
      * Chg Tattoo Hdr JS HO  RT - Tattoo Header Job Sel  * 
     C                     EXSR SWRVGN
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0007           *SFLSEL
      * Send message 'Tattoo is already Unpaid'
     C                     MOVEL'PRK1516' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0008           *SFLSEL
      * Send message 'Cannot Unpay-Backup NC'
     C                     MOVEL'PRK1519' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0009           *SFLSEL
      * Send message 'Cannot Unpay-Status'
     C                     MOVEL'PRK1528' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
      *
     C                     END                             *FI
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Mark Trucker as Paid
      *================================================================
      * Chg Trucker Pymt Sts  CH - Buy Order Load  * 
     C                     EXSR SYCHRC
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Lock Buy Order Header
      *================================================================
      * Chg BOH Status-Repay  CH - Buy Order Header  * Locked
     C                     EXSR SZCHRC
     C                     MOVEL'L'       #RA6ST           BOH Status
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * Mark Tattoo Process Code as Slaughter
      *================================================================
      * If Unpaid AND Process Code is Payment AND Repayment Sts is Unpaid
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : RCD.TH Payment Sts is Unpaid Producer
      *   |- c2    : RCD.THP Process Code is Payment
      *   |- c3    : RCD.Repayment Status is Unpaid
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RCWST    IFEQ 'ML'                       *IF
     C           #RCWST    OREQ 'SL'
     C           #RCWST    OREQ 'SC'
     C           #RCWST    OREQ 'IC'
     C           #RCWST    OREQ 'IL'
     C           #RCWST    OREQ *BLANK
     C           #RCSCD    IFEQ @CN,015                    *IF
     C           #1M9ST    IFEQ 'U'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Chg TH Process Code   CH - Tattoo Header  * Set to Slaughter
     C                     EXSR TACHRC
     C                     MOVEL*BLANK    #RCSCD           THP Process Cod
     C                     MOVEL'SLG'     #RCSCD           THP Process Cod
     C                     END                             *FI
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * Mark Tattoo Process Code as Payment
      *================================================================
      * If Unpaid AND Process Code is Payment AND Repayment Sts is Unpaid
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : RCD.TH Payment Sts is Unpaid Producer
      *   |- c2    : RCD.THP Process Code is Slaughter
      *   |- c3    : RCD.Repayment Status is Unpaid
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RCWST    IFEQ 'ML'                       *IF
     C           #RCWST    OREQ 'SL'
     C           #RCWST    OREQ 'SC'
     C           #RCWST    OREQ 'IC'
     C           #RCWST    OREQ 'IL'
     C           #RCWST    OREQ *BLANK
     C           #RCSCD    IFEQ 'SLG'                      *IF
     C           #1M9ST    IFEQ 'U'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Chg TH Process Code   CH - Tattoo Header  * Set to Payment
     C                     EXSR TBCHRC
     C                     MOVEL'PAYMNT'  #RCSCD           THP Process Cod
     C                     END                             *FI
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      * 12/28/2023 JM  S000219- Fix unintentional deletion of Carcass Det
      *                         Tattoo Ded/Add.
      *  4/22/2019 JBB E14892 - Set Repayment Status to 'N' when F19
      *                         Use CHGOBJ "Chg Pymt Proc Parms   CH" so
      *                         that the Repayment Status is changed to '
      *  4/17/2019 JBB E14820 - Add Site ID to Tattoo Difference report
      *                         Function modified to input the current
      *                         Company Code into the Display Payment
      *                         Processing Parms function (F15 - PWINPVR)
      *  4/16/2019 JBB E14855 - Fix Payment Date when F6 to select record
      * - Function modified to use the date returned to update the curren
      *   payment date with the most recent Kill Date from the selected
      *   records.
      * 12/12/2018 JBB E14234 - Changes to Repayments Phase 2
      * - Function created.  This work with screen will display records
      *   From the Tattoo Header Job Sel file PKDOREP.  It restricts on t
      *   Company and Name = "REPAY".
      * 11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD11        ZHSTRW  40
     C                     Z-ADD20        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1KLTX           Tattoo Job Sel
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WACKDT           Pmt Current Pay
     C                     Z-ADD*ZERO     WAM1NB           Pmt Current Pay
     C                     Z-ADD*ZERO     WAPINB           PP Unused Nbr 1
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCARDT           BOH Buy Order D
     C                     Z-ADD*ZERO     WCASDT           BOH Kill Date
     C                     Z-ADD*ZERO     WCAAPR           BOH Market Add/
     C                     Z-ADD*ZERO     WCALPR           BOH Quoted Base
     C                     Z-ADD*ZERO     WCD5DT           BOH MPR Reporti
     C                     Z-ADD*ZERO     WCD6DT           BOH Hedge Date
     C                     Z-ADD*ZERO     WCD7DT           BOH Unused Date
     C                     Z-ADD*ZERO     WCD8DT           BOH Unused Date
     C                     Z-ADD*ZERO     WCD9DT           BOH Unused Date
     C                     Z-ADD*ZERO     WCJOEJ           BOH Hedge Head
     C                     Z-ADD*ZERO     WCKOFF           BOH Hedge Refer
     C                     Z-ADD*ZERO     WCKWPE           BOH Hedge Time
     C                     Z-ADD*ZERO     WCIMBF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WCOPTR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WCOEJD           BOH Unused Nbr
     C                     Z-ADD*ZERO     WCIRMF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WCJIRM           BOH Unused Nbr
     C                     Z-ADD*ZERO     WCJRKF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WCKFIR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WCHXNB           PPWS Company Nu
     C                     Z-ADD*ZERO     WCGANB           CW Year
     C                     Z-ADD*ZERO     WCGBNB           CW Week Number
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WDACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WDB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WDCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WDAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WDA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WDCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WDCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WDFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WDH9NB           TH Held Over
     C                     Z-ADD*ZERO     WDFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WDFENB           TH Head Killed
     C                     Z-ADD*ZERO     WDHENB           TH Head Adds
     C                     Z-ADD*ZERO     WDHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WDCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WDLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WDE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WDA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WDFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WDA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WDF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WDHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WDF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WDF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WDF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WDF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WDAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WDAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WDCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WDA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WDA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WDB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WDAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WDAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WDAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WDAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WDAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WDASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WDA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WDATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WDA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WDCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WDCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WDLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WDCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WDA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WDA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WDGHNB           TH Commission A
     C                     Z-ADD*ZERO     WDBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WDBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WDBTDT           TH Commission P
     C                     Z-ADD*ZERO     WDBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WDHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WDHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WDHINB           TH FFLI
     C                     Z-ADD*ZERO     WDA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WDA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WDA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WDJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WDD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WDD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WDD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WDD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WDEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WDEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WDECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WDEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WDEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WDEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WDOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WDTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WDT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WDTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WDT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WDOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WDKOER           TH Head Identif
     C                     Z-ADD*ZERO     WDOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WDOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WDIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WDOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WDHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WDS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WDTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WDTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WDJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WDKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WDKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WDKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WDKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WDOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WDIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WDIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WDIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WDKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WDOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WDKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WDORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WDOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WDMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WDMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WDNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WDNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WDIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WDKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WDEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WDEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WDECDT           TH Head LFT
     C                     Z-ADD*ZERO     WDEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WDEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Company Number Alpha Usr
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field First Time Flag Usr
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Pmt Current Payment Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define null work field PP Commission Paym Error
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field PP Payment Error
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field PP Unused Nbr 1
     C                     Z-ADD*ZERO     YN0003  50
      * Define null work field PP Repayment Status
     C                     MOVEL*BLANK    YN0004  1
      * Define local work field System Value Alpha    USR
     C                     MOVEL*BLANK    YL0004 40
      * Define local work field File Backup Status USR
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Date Alpha USR
     C                     MOVEL*BLANK    YL0006  7
      * Define local work field Last Run Date
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field Date From Convert USR
     C                     MOVEL*BLANK    YL0008 10
      * Define local work field File
     C                     MOVEL*BLANK    YL0009 10
      * Define local work field Kill Date Usr
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field Buy Order Number USR
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field Load Number
     C                     Z-ADD*ZERO     YL0012  50
      * Define local work field Tattoo Number USR
     C                     Z-ADD*ZERO     YL0013  50
      * Define local work field Count USR 2
     C                     Z-ADD*ZERO     YL0014  30
      * Define local work field User Code Model USR
     C                     MOVEL*BLANK    YL0015 10
      * Define local work field BOH Company Number
     C                     Z-ADD*ZERO     YL0016  30
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0017  30
      * Define local work field BOH Buy Order Number
     C                     Z-ADD*ZERO     YL0018  70
      * Define local work field First Time Flag Usr
     C                     MOVEL*BLANK    YL0019  1
      * Define null work field TH Purchase Date
     C                     Z-ADD*ZERO     YN0005  70
      * Define null work field TH Group Reference
     C                     MOVEL*BLANK    YN0006 10
      * Define null work field TH Live Purchase UOM
     C                     MOVEL*BLANK    YN0007  2
      * Define null work field TH Live Purchase Price
     C                     Z-ADD*ZERO     YN0008  52
      * Define null work field TH Resale UOM
     C                     MOVEL*BLANK    YN0009  2
      * Define null work field TH Recalc Live Wgt Yld
     C                     Z-ADD*ZERO     YN0010  52
      * Define null work field TH Pricing Date
     C                     Z-ADD*ZERO     YN0011  70
      * Define null work field TH Resale Spread Sts
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field TH Dead On Arrival
     C                     Z-ADD*ZERO     YN0013  50
      * Define null work field TH Head Received
     C                     Z-ADD*ZERO     YN0014  50
      * Define null work field TH Yard Deads
     C                     Z-ADD*ZERO     YN0015  50
      * Define null work field TH Held Over
     C                     Z-ADD*ZERO     YN0016  50
      * Define null work field TH Head Condemned
     C                     Z-ADD*ZERO     YN0017  50
      * Define null work field TH Head Killed
     C                     Z-ADD*ZERO     YN0018  50
      * Define null work field TH Head Adds
     C                     Z-ADD*ZERO     YN0019  50
      * Define null work field TH Head Accepted
     C                     Z-ADD*ZERO     YN0020  50
      * Define null work field TH Live Wgt
     C                     Z-ADD*ZERO     YN0021  71
      * Define null work field TH Hot Wgt
     C                     Z-ADD*ZERO     YN0022  71
      * Define null work field TH Tot Loin Eye Depth
     C                     Z-ADD*ZERO     YN0023  61
      * Define null work field TH Tot Backfat Inches
     C                     Z-ADD*ZERO     YN0024  61
      * Define null work field TH Tot Light Reflectance
     C                     Z-ADD*ZERO     YN0025  61
      * Define null work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     YN0026  51
      * Define null work field TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YN0027  51
      * Define null work field TH Avg Light Reflectance
     C                     Z-ADD*ZERO     YN0028  31
      * Define null work field TH Avg Lean Percent
     C                     Z-ADD*ZERO     YN0029  31
      * Define null work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     YN0030  31
      * Define null work field TH Avg Backfat
     C                     Z-ADD*ZERO     YN0031  31
      * Define null work field TH Std Yield Percent
     C                     Z-ADD*ZERO     YN0032  52
      * Define null work field TH Actual Yield %
     C                     Z-ADD*ZERO     YN0033  52
      * Define null work field TH Yield Difference
     C                     Z-ADD*ZERO     YN0034  52
      * Define null work field TH Recalc Live Wgt
     C                     Z-ADD*ZERO     YN0035  31
      * Define null work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     YN0036  52
      * Define null work field TH CM Base Mkt Price Amt
     C                     Z-ADD*ZERO     YN0037  72
      * Define null work field TH CM Sort Discount Amt
     C                     Z-ADD*ZERO     YN0038  72
      * Define null work field TH CM Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     YN0039  72
      * Define null work field TH CM Base Carcass Value
     C                     Z-ADD*ZERO     YN0040  72
      * Define null work field TH CM LN AddOn/Deduct Amt
     C                     Z-ADD*ZERO     YN0041  72
      * Define null work field TH CM Carcass Gross Amt
     C                     Z-ADD*ZERO     YN0042  72
      * Define null work field TH Deduction Amt
     C                     Z-ADD*ZERO     YN0043  72
      * Define null work field TH Total Net WO Adds
     C                     Z-ADD*ZERO     YN0044  72
      * Define null work field TH Carcass Net Amt
     C                     Z-ADD*ZERO     YN0045  72
      * Define null work field TH Additions Amt
     C                     Z-ADD*ZERO     YN0046  72
      * Define null work field TH Accrual Amount
     C                     Z-ADD*ZERO     YN0047  72
      * Define null work field TH Fixed Cost Amount
     C                     Z-ADD*ZERO     YN0048  72
      * Define local work field TH Payment Sts
     C                     MOVEL*BLANK    YL0020  2
      * Define null work field TH Header Error Sts
     C                     MOVEL*BLANK    YN0049  1
      * Define null work field TH Detail Error Sts
     C                     MOVEL*BLANK    YN0050  1
      * Define null work field TH Kill Balancing Sts
     C                     MOVEL*BLANK    YN0051  1
      * Define null work field TH Bal to Kill Gen
     C                     MOVEL*BLANK    YN0052  1
      * Define null work field TH Commission A/P Voucher
     C                     Z-ADD*ZERO     YN0053  80
      * Define null work field TH Voucher Payment Date
     C                     Z-ADD*ZERO     YN0054  70
      * Define null work field TH User Error Override
     C                     MOVEL*BLANK    YN0055  1
      * Define null work field TH Held Over Record
     C                     MOVEL*BLANK    YN0056  1
      * Define null work field TH Sex
     C                     MOVEL*BLANK    YN0057  1
      * Define null work field TH Held/Ovr Completed Dte
     C                     Z-ADD*ZERO     YN0058  70
      * Define null work field TH Commission Paid Date
     C                     Z-ADD*ZERO     YN0059  70
      * Define null work field TH Actual Check Date
     C                     Z-ADD*ZERO     YN0060  70
      * Define null work field TH Shipped Weight
     C                     Z-ADD*ZERO     YN0061  71
      * Define null work field TH Avg Hot Wgt EXC/ADD
     C                     Z-ADD*ZERO     YN0062  71
      * Define null work field TH FFLI
     C                     Z-ADD*ZERO     YN0063  31
      * Define null work field TH Kill Product Value
     C                     Z-ADD*ZERO     YN0064  72
      * Define null work field TH Cut Product Value
     C                     Z-ADD*ZERO     YN0065  72
      * Define null work field TH Render Product Value
     C                     Z-ADD*ZERO     YN0066  72
      * Define null work field TH Shift Held Over Head
     C                     Z-ADD*ZERO     YN0067  50
      * Define null work field DF Defect Code
     C                     MOVEL*BLANK    YN0068  6
      * Define local work field THP Process Code
     C                     MOVEL*BLANK    YL0021  6
      * Define null work field HB Buyer Code
     C                     MOVEL*BLANK    YN0069  3
      * Define null work field GN Genetic Code
     C                     MOVEL*BLANK    YN0070  5
      * Define null work field HC Class Code
     C                     MOVEL*BLANK    YN0071  3
      * Define local work field BOH Status
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field PD Producer Code
     C                     MOVEL*BLANK    YL0023  6
      * Define local work field PL Location Code
     C                     MOVEL*BLANK    YL0024  6
      * Define local work field Select Y/N USR 1
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field Text 2 USR
     C                     MOVEL*BLANK    YL0026  2
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD10        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modification history
     C                     EXSR UQSUBR                     Modification hi
     C                     Z-ADD999999    W0SLM            *Scan limit
      * Restrict on Repayment records
     C                     MOVEL*BLANK    P1KLTX           Tattoo Job Sel
     C                     MOVEL'REPAY'   P1KLTX           Tattoo Job Sel
      * Retrieve the default company for the User ID
      * RTV Default Co No App XF - STR Order Management Sys  * 
     C                     CALL 'PMD4XFR'              90  RTV Default Co
     C                     PARM *BLANK    W0RTN   7
     C           YL0001    PARM *BLANK    WQ0031  3        Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMD4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVE YL0001    YL0016           BOH Company Num
      * Default Payment Status to All
     C                     MOVEL'Y'       YL0002           First Time Flag
     C                     MOVEL'TR'      YL0026           Text 2 USR
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** @CN
00001 HPEREPAYBU
00002 Repayment files not backe
00003 d for a repayment today.
00004 Repayment files are backe
00005 Repayment file backup in
00006 progress, step
00007 Error backing up Repaymen
00008 t file
00009 Unpaid
00010 Repaid
00011 Transfer
00012 Repayment files backup su
00013 bmitted.
00014 Y2U9999
00015 PAYMNT
