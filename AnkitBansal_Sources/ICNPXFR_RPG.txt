     H/TITLE Crt Neg. OH Cash Adj.  XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 02/15/06  Time  : 08:09:42
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB7CPLEIF  E           K        DISK
      * RSQ : Item Transaction Detail   Normal KEY Sequence (D)
      *
     FCAB7CPL0IF  E           K        DISK                      A
      * UPD : Item Transaction Detail   Update index
      *
      * Long constants
     E                    @CN#    1   1  6   @CN    25
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WAAIC3
     I              BZHGCD                          WAHGCD
     I              BZAVNA                          WAAVNA
     I              BZAWNA                          WAAWNA
     I              BZL7NA                          WAL7NA
     I              BZL8NA                          WAL8NA
     I              BZL6NA                          WAL6NA
     I              BZMFNA                          WAMFNA
     I              BZADCD                          WAADCD
     I              BZAWPC                          WAAWPC
     I              BZLXST                          WALXST
     I              BZAECD                          WAAECD
     I              BZAXPC                          WAAXPC
     I              BZLYST                          WALYST
     I              BZAFCD                          WAAFCD
     I              BZAICD                          WAAICD
     I              BZAIWG                          WAAIWG
     I              BZHICD                          WAHICD
     I              BZRBCD                          WARBCD
     I              BZFZST                          WAFZST
     I              BZAVST                          WAAVST
     I              BZCZWG                          WACZWG
     I              BZC0WG                          WAC0WG
     I              BZURTN                          WAURTN
     I              BZAJC8                          WAAJC8
     I              BZRINB                          WARINB
     I              BZRHNB                          WARHNB
     I              BZRGNB                          WARGNB
     I              BZLNCD                          WALNCD
     I              BZTFNB                          WATFNB
     I              BZN0CD                          WAN0CD
     I              BZX4ST                          WAX4ST
     I              BZTMVA                          WATMVA
     I              BZTNVA                          WATNVA
     I              BZBLPR                          WABLPR
     I              BZBMPR                          WABMPR
     I              BZLRCD                          WALRCD
     I              BZU9ST                          WAU9ST
     I              BZCMCO                          WACMCO
     I              BZQ1CD                          WAQ1CD
     I              BZQ8CD                          WAQ8CD
     I              BZCHTM                          WACHTM
     I              BZQZCD                          WAQZCD
     I              BZXWST                          WAXWST
     I              BZXXST                          WAXXST
     I              BZVMST                          WAVMST
     I              BZSWGH                          WASWGH
     I              BZPPHE                          WAPPHE
     I              BZR3CD                          WAR3CD
     I              BZSDCD                          WASDCD
     I              BZICN1                          WAICN1
     I              BZSVCD                          WASVCD
     I              BZICN2                          WAICN2
     I              BZSWCD                          WASWCD
     I              BZV2NB                          WAV2NB
     I              BZSXCD                          WASXCD
     I              BZITCN                          WAITCN
     I              BZSYCD                          WASYCD
     I              BZITC5                          WAITC5
     I              BZSZCD                          WASZCD
     I              BZICN6                          WAICN6
     I              BZS0CD                          WAS0CD
     I              BZICN7                          WAICN7
     I              BZS1CD                          WAS1CD
     I              BZICN8                          WAICN8
     I              BZS2CD                          WAS2CD
     I              BZICN9                          WAICN9
     I              BZS3CD                          WAS3CD
     I              BZICN0                          WAICN0
     I              BZS4CD                          WAS4CD
     I              BZSFNB                          WASFNB
     I              BZA3WG                          WAA3WG
     I              BZSJNB                          WASJNB
     I              BZLLCD                          WALLCD
     I              BZLMCD                          WALMCD
     I              BZP3ST                          WAP3ST
     I              BZSKNB                          WASKNB
     I              BZSLNB                          WASLNB
     I              BZSMNB                          WASMNB
     I              BZP4ST                          WAP4ST
     I              BZCFNB                          WACFNB
     I              BZCGNB                          WACGNB
     I              BZILNB                          WAILNB
     I              BZCHNB                          WACHNB
     I              BZCINB                          WACINB
     I              BZCJNB                          WACJNB
     I              BZCMNB                          WACMNB
     I              BZCNNB                          WACNNB
     I              BZCRNB                          WACRNB
     I              BZCSNB                          WACSNB
     I              BZCVNB                          WACVNB
     I              BZCWNB                          WACWNB
     I              BZCXNB                          WACXNB
     I              BZCZNB                          WACZNB
     I              BZC0NB                          WAC0NB
     I              BZN1CD                          WAN1CD
     I              BZB4NB                          WAB4NB
     I              BZB5NB                          WAB5NB
     I              BZX5ST                          WAX5ST
     I              BZX6ST                          WAX6ST
     I              BZX7ST                          WAX7ST
     I              BZPCCT                          WAPCCT
     I              BZBDNB                          WABDNB
     I              BZBJNB                          WABJNB
     I              BZSUST                          WASUST
     I              BZSVST                          WASVST
     I              BZSYST                          WASYST
     I              BZSZST                          WASZST
     I              BZS1ST                          WAS1ST
     I              BZXRCD                          WAXRCD
     I              BZXTCD                          WAXTCD
     I              BZXUCD                          WAXUCD
     I              BZF5WG                          WAF5WG
     I              BZF6WG                          WAF6WG
     I              BZF7WG                          WAF7WG
     I              BZBLNB                          WABLNB
     I              BZBNNB                          WABNNB
     I              BZS2ST                          WAS2ST
     I              BZS4ST                          WAS4ST
     I              BZS5ST                          WAS5ST
     I              BZS6ST                          WAS6ST
     I              BZS8ST                          WAS8ST
     I              BZS9ST                          WAS9ST
     I              BZTCST                          WATCST
     I              BZTDST                          WATDST
     I              BZUVST                          WAUVST
     I              BZUWST                          WAUWST
     I              BZUXST                          WAUXST
     I              BZVSST                          WAVSST
     I              BZAATM                          WAAATM
     I              BZAYNA                          WAAYNA
     I              BZA0NA                          WAA0NA
     I              BZAXDT                          WAAXDT
      *
     I@B7CPZA
      * Item Transaction Detail   Normal KEY Sequence (D)
      * Renamed input format fields
     I              B7AIC3                          WBAIC3
     I              B7HGCD                          WBHGCD
     I              B7AJCD                          WBAJCD
     I              B7W9ST                          WBW9ST
     I              B7BSST                          WBBSST
     I              B7B4DT                          WBB4DT
     I              B7C4NY                          WBC4NY
     I              B7DXNB                          WBDXNB
     I              B7ELDT                          WBELDT
     I              B7HVCD                          WBHVCD
     I              B7F1ST                          WBF1ST
     I              B7AUNA                          WBAUNA
     I              B7A5QT                          WBA5QT
     I              B7AHWG                          WBAHWG
     I              B7AKCS                          WBAKCS
     I              B7CGCD                          WBCGCD
     I              B7AYVA                          WBAYVA
     I              B7BJNA                          WBBJNA
     I              B7CKNB                          WBCKNB
     I              B7BMST                          WBBMST
     I              B7CQCD                          WBCQCD
     I              B7DTCD                          WBDTCD
     I              B7MGNA                          WBMGNA
     I              B7TRBN                          WBTRBN
     I              B7TRBS                          WBTRBS
     I              B7C4NB                          WBC4NB
     I              B7RINB                          WBRINB
     I              B7RHNB                          WBRHNB
     I              B7RGNB                          WBRGNB
     I              B7M3NA                          WBM3NA
     I              B7AWTM                          WBAWTM
     I              B7XLCD                          WBXLCD
     I              B7K7DT                          WBK7DT
     I              B7UVST                          WBUVST
     I              B7UWST                          WBUWST
     I              B7UXST                          WBUXST
     I              B7VSST                          WBVSST
     I              B7AATM                          WBAATM
     I              B7AYNA                          WBAYNA
     I              B7A0NA                          WBA0NA
     I              B7AXDT                          WBAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WCAIC3
     I              B7HGCD                          WCHGCD
     I              B7AJCD                          WCAJCD
     I              B7W9ST                          WCW9ST
     I              B7BSST                          WCBSST
     I              B7B4DT                          WCB4DT
     I              B7C4NY                          WCC4NY
     I              B7DXNB                          WCDXNB
     I              B7ELDT                          WCELDT
     I              B7HVCD                          WCHVCD
     I              B7F1ST                          WCF1ST
     I              B7AUNA                          WCAUNA
     I              B7A5QT                          WCA5QT
     I              B7AHWG                          WCAHWG
     I              B7AKCS                          WCAKCS
     I              B7CGCD                          WCCGCD
     I              B7AYVA                          WCAYVA
     I              B7BJNA                          WCBJNA
     I              B7CKNB                          WCCKNB
     I              B7BMST                          WCBMST
     I              B7CQCD                          WCCQCD
     I              B7DTCD                          WCDTCD
     I              B7MGNA                          WCMGNA
     I              B7TRBN                          WCTRBN
     I              B7TRBS                          WCTRBS
     I              B7C4NB                          WCC4NB
     I              B7RINB                          WCRINB
     I              B7RHNB                          WCRHNB
     I              B7RGNB                          WCRGNB
     I              B7M3NA                          WCM3NA
     I              B7AWTM                          WCAWTM
     I              B7XLCD                          WCXLCD
     I              B7K7DT                          WCK7DT
     I              B7UVST                          WCUVST
     I              B7UWST                          WCUWST
     I              B7UXST                          WCUXST
     I              B7VSST                          WCVSST
     I              B7AATM                          WCAATM
     I              B7AYNA                          WCAYNA
     I              B7A0NA                          WCA0NA
     I              B7AXDT                          WCAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WCAIC3
     I              B7HGCD                          WCHGCD
     I              B7AJCD                          WCAJCD
     I              B7W9ST                          WCW9ST
     I              B7BSST                          WCBSST
     I              B7B4DT                          WCB4DT
     I              B7C4NY                          WCC4NY
     I              B7DXNB                          WCDXNB
     I              B7ELDT                          WCELDT
     I              B7HVCD                          WCHVCD
     I              B7F1ST                          WCF1ST
     I              B7AUNA                          WCAUNA
     I              B7A5QT                          WCA5QT
     I              B7AHWG                          WCAHWG
     I              B7AKCS                          WCAKCS
     I              B7CGCD                          WCCGCD
     I              B7AYVA                          WCAYVA
     I              B7BJNA                          WCBJNA
     I              B7CKNB                          WCCKNB
     I              B7BMST                          WCBMST
     I              B7CQCD                          WCCQCD
     I              B7DTCD                          WCDTCD
     I              B7MGNA                          WCMGNA
     I              B7TRBN                          WCTRBN
     I              B7TRBS                          WCTRBS
     I              B7C4NB                          WCC4NB
     I              B7RINB                          WCRINB
     I              B7RHNB                          WCRHNB
     I              B7RGNB                          WCRGNB
     I              B7M3NA                          WCM3NA
     I              B7AWTM                          WCAWTM
     I              B7XLCD                          WCXLCD
     I              B7K7DT                          WCK7DT
     I              B7UVST                          WCUVST
     I              B7UWST                          WCUWST
     I              B7UXST                          WCUXST
     I              B7VSST                          WCVSST
     I              B7AATM                          WCAATM
     I              B7AYNA                          WCAYNA
     I              B7A0NA                          WCA0NA
     I              B7AXDT                          WCAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Item Transaction Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Item Code
     I                                    P   3   60P1HGCD
      * I :  Warehouse Code
     I                                        7   9 P1AJCD
      * I :  Inventory Trans. ID
     I                                       10  10 P1W9ST
      * I :  Inventory Trans. Type
     I                                       11  12 P1BSST
      * I :  Transaction Date Code
     I                                    P  13  160P1B4DT
      * I :  Production Date
     I                                    P  17  200P1ELDT
      * N : MAP G/L Update Status
     I                                       21  21 P1BMST
      * I :  Shift Number
     I                                       22  22 P1XLCD
      * I :  Label Date
     I                                    P  23  260P1K7DT
     IP2PARM      DS
      * I :  Cost Replace Dollar Var.
     I                                    P   1   62P2JTVA
     IP3PARM      DS
      * FLD: Company Item
      * I :  U/M - Primary
     I                                        1   2 P3ADCD
     IP4PARM      DS
      * FLD: Item Balance
      * I :  Post G/L Status
     I                                        1   1 P4KBST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1HGCD    PARM           WP0002  70       Item Code
     C           P1AJCD    PARM           WP0003  3        Warehouse Code
     C           P1W9ST    PARM           WP0004  1        Inventory Trans
     C           P1BSST    PARM           WP0005  2        Inventory Trans
     C           P1B4DT    PARM           WP0006  70       Transaction Dat
     C           P1ELDT    PARM           WP0007  70       Production Date
     C           P1XLCD    PARM           WP0008  1        Shift Number
     C           P1K7DT    PARM           WP0009  70       Label Date
     C           P2JTVA    PARM           WP0010 112       Cost Replace Do
     C           P3ADCD    PARM           WP0011  2        U/M - Primary
     C           P4KBST    PARM           WP0012  1        Post G/L Status
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Crt Neg. OH Cash Adj.  XF
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
     C                     EXSR SARVGN
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
     C                     EXSR SBRVGN
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
     C                     EXSR SCCRRC
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1HGCD    WAHGCD           Item Code
      * Establish starting position
     C           KRSSA     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWARINB    WURINB           Item Structure
     C                     Z-ADDWARHNB    WURHNB           Item Structure
     C                     Z-ADDWARGNB    WURGNB           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBHGCD    WQSB02           Item Code
     C           *LIKE     DEFN WBAJCD    WQSB03           Warehouse Code
     C           *LIKE     DEFN WBW9ST    WQSB04           Inventory Trans
     C           *LIKE     DEFN WBBSST    WQSB05           Inventory Trans
     C           *LIKE     DEFN WBB4DT    WQSB06           Transaction Dat
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Item Code
     C                     KFLD           WQSB03           Warehouse Code
     C                     KFLD           WQSB04           Inventory Trans
     C                     KFLD           WQSB05           Inventory Trans
     C                     KFLD           WQSB06           Transaction Dat
      * Setup key
     C                     Z-ADDP1AIC3    WQSB01           Company Number
     C                     Z-ADDP1HGCD    WQSB02           Item Code
     C                     MOVELP1AJCD    WQSB03           Warehouse Code
     C                     MOVEL'A'       WQSB04           Inventory Trans
     C                     MOVEL'AC'      WQSB05           Inventory Trans
     C                     Z-ADDP1B4DT    WQSB06           Transaction Dat
      * Establish starting position
     C           KRSSB     SETLL@B7CPZA                    *
     C           KRSSB     READE@B7CPZA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUC4NY           ITD Sequence Nu
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WBC4NY    ADD  1         WUC4NY           ITD Sequence Nu
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@B7CPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  60       Job Time
     C                     MOVEL*BLANK    WN0002 10        User Id
     C                     MOVEL*BLANK    WN0003 10        Job Name
     C                     Z-ADD*ZERO     WN0004  70       Job Date
     C                     Z-ADD*ZERO     WN0005  20       Production Hour
     C                     Z-ADD*ZERO     WN0006 112       Production Weig
     C                     Z-ADD*ZERO     WN0007  50       Production Quan
     C                     Z-ADD*ZERO     WN0008  70       Production Piec
     C                     MOVEL*BLANK    WN0009  1        Export/Domestic
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B7CPJZ
     C                     Z-ADDP1AIC3    WCAIC3           Company Number
     C                     Z-ADDP1HGCD    WCHGCD           Item Code
     C                     MOVELP1AJCD    WCAJCD           Warehouse Code
     C                     MOVEL'A'       WCW9ST           Inventory Trans
     C                     MOVEL'AC'      WCBSST           Inventory Trans
     C                     Z-ADDP1B4DT    WCB4DT           Transaction Dat
     C                     Z-ADDWUC4NY    WCC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WCDXNB           Sequence Number
     C                     Z-ADDP1ELDT    WCELDT           Production Date
     C                     MOVELP3ADCD    WCHVCD           U/M - Transacti
     C                     MOVEL'SG'      WCF1ST           Item Transactio
     C                     MOVEL@CN,01    WCAUNA           Description
     C                     Z-ADD*ZERO     WCA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WCAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WCAKCS           USR Transaction
     C                     MOVELP3ADCD    WCCGCD           U/M - Cost
     C                     Z-ADDP2JTVA    WCAYVA           Extended Amount
     C                     MOVEL*BLANK    WCBJNA           Ticket Number
     C                     Z-ADD*ZERO     WCCKNB           G/L Document Nu
     C                     MOVELP1BMST    WCBMST           G/L Update Stat
     C                     MOVELWUCQCD    WCCQCD           Reason Code
     C                     MOVELWUDTCD    WCDTCD           Reference Numbe
     C                     MOVEL*BLANK    WCMGNA           Lot ID
     C                     Z-ADD*ZERO     WCTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WCTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADDWURINB    WCRINB           Item Structure
     C                     Z-ADDWURHNB    WCRHNB           Item Structure
     C                     Z-ADDWURGNB    WCRGNB           Item Structure
     C                     MOVELWUM3NA    WCM3NA           Employee Badge
     C                     Z-ADD*ZERO     WCAWTM           Production Time
     C                     MOVEL*BLANK    WCXLCD           Shift Number
     C                     Z-ADDP1K7DT    WCK7DT           Label Date
     C                     MOVELWUUVST    WCUVST           EDI Status 1
     C                     MOVELWUUWST    WCUWST           EDI Status 2
     C                     MOVELWUUXST    WCUXST           EDI Status 3
     C                     MOVEL'A'       WCVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
     C           KLCRSC    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCAJCD           Warehouse Code
     C                     KFLD           WCW9ST           Inventory Trans
     C                     KFLD           WCBSST           Inventory Trans
     C                     KFLD           WCB4DT           Transaction Dat
     C                     KFLD           WCC4NY           ITD Sequence Nu
     C                     KFLD           WCDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSC    SETLL@B7CPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0345' W0RTN   7
      * Send message 'Item Transaction Detai EX'
     C                     MOVEL'USR0345' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@B7CPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                     CALL 'POO5XFR'              90  Crt Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCAIC3    WQ0001  30       Company Number
     C                     PARM WCHGCD    WQ0002  70       Item Code
     C                     PARM WCAJCD    WQ0003  3        Warehouse Code
     C                     PARM WCW9ST    WQ0004  1        Inventory Trans
     C                     PARM WCBSST    WQ0005  2        Inventory Trans
     C                     PARM WCB4DT    WQ0006  70       Transaction Dat
     C                     PARM WCDXNB    WQ0007  30       Sequence Number
     C                     PARM WCELDT    WQ0008  70       Production Date
     C                     PARM WCHVCD    WQ0009  2        U/M - Transacti
     C                     PARM WCF1ST    WQ0010  2        Item Transactio
     C                     PARM WCAUNA    WQ0011 30        Description
     C                     PARM WCA5QT    WQ0012 112       Transaction Qua
     C                     PARM WCAHWG    WQ0013 112       Transaction Wei
     C                     PARM WCAKCS    WQ0014 114       USR Transaction
     C                     PARM WCCGCD    WQ0015  2        U/M - Cost
     C                     PARM WCAYVA    WQ0016 112       Extended Amount
     C                     PARM WCBJNA    WQ0017  6        Ticket Number
     C                     PARM WCCKNB    WQ0018  80       G/L Document Nu
     C                     PARM WCBMST    WQ0019  1        G/L Update Stat
     C                     PARM WCCQCD    WQ0020  3        Reason Code
     C                     PARM WCDTCD    WQ0021 15        Reference Numbe
     C                     PARM WCMGNA    WQ0022 10        Lot ID
     C                     PARM WCTRBN    WQ0023  70       Transfer Batch
     C                     PARM WCTRBS    WQ0024  30       Transfer Batch
     C                     PARM WCC4NB    WQ0025  70       Order Number
     C                     PARM WCRINB    WQ0026  30       Item Structure
     C                     PARM WCRHNB    WQ0027  30       Item Structure
     C                     PARM WCRGNB    WQ0028  30       Item Structure
     C                     PARM WCM3NA    WQ0029 10        Employee Badge
     C                     PARM WCAWTM    WQ0030  60       Production Time
     C                     PARM WCXLCD    WQ0031  1        Shift Number
     C                     PARM WCK7DT    WQ0032  70       Label Date
     C                     PARM WCVSST    WQ0033  1        Record Status
     C                     PARM WCAATM    WQ0034  60       Job Time
     C                     PARM WCAXDT    WQ0035  70       Job Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1BMST           G/L Update Stat
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           CI Unused Numbe
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           PM Line Time Ef
     C                     Z-ADD*ZERO     WAILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WACHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           PM Lot Size
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           PM Formula Yiel
     C                     Z-ADD*ZERO     WACWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field ITD Sequence Number
     C                     Z-ADD*ZERO     WUC4NY  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WBC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WBDXNB           Sequence Number
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WBAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WBAKCS           USR Transaction
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WBTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WBTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBAWTM           Production Time
     C                     Z-ADD*ZERO     WBK7DT           Label Date
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Reason Code
     C                     MOVEL*BLANK    WUCQCD  3
      * Define work field Reference Number Code
     C                     MOVEL*BLANK    WUDTCD 15
      * Define work field Employee Badge Number
     C                     MOVEL*BLANK    WUM3NA 10
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field EDI Status 2
     C                     MOVEL*BLANK    WUUWST  1
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Clear all neither parameters
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Receipt Value Adj.
