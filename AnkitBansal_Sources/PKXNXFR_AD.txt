// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKXNXFR
// ?Date: 14.08.2025 Time: 02:50:45
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?MODIFICATIONS
//?11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM 5 TO 7
EXECUTE FUNCTION(HPE096) TYPE(EXCINTFUN)                                        AB1196857;

// Call program Clc Base Mkt Price    XF.
CALL PROGRAM(Clc Base Mkt Price    XF) ('PKJ7XFR');
PARAMETER(PAR.BOH_Market_Add_Deduct);
PARAMETER(PAR.BOH_Quote_Price_Type);
PARAMETER(PAR.BOH_Quoted_Base_Mkt_Price);
PARAMETER(PAR.BOH_Commodity_Market_Code);
PARAMETER(PAR.BOH_Commodity_Price_Group);
PARAMETER(PAR.BOH_Market_Date_Method);
PARAMETER(PAR.PC_Contract_Code);
PARAMETER(PAR.PSC_Sub_Contract_Code);
PARAMETER(PAR.PO_Option_Code);
PARAMETER(PAR.CMP_Program_Code);
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.BOH_Buy_Order_Number);
PARAMETER(PAR.BOL_Load_Number);
PARAMETER(PAR.TH_Tattoo_Number);
PARAMETER(PAR.TH_Kill_Date);
PARAMETER(PAR.TH_Purchase_Date);
PARAMETER(PAR.TH_Live_Wgt);
PARAMETER(PAR.TH_CM_Base_Mkt_Price);
PARAMETER(PAR.PSC_Floor_Price);
PARAMETER(PAR.PSC_Ceiling_Price);
PARAMETER(PAR.PSC_Market_Percent_NU);
PARAMETER(PAR.PSC_Mkt_Percent);
PARAMETER(PAR.Market_Price_USR);
PARAMETER(PAR.Pricing_UOM_USR);
PARAMETER(PAR.Pricing_Date_USR);

CASE;

// IF PAR.Competitors Processing is No
IF PAR.Competitors_Processing = 'N';

//?11/29/05 PKD updating TH CM Market Price with the market price
//?             instead of the base price.
EXECUTE FUNCTION(Chg Market Price      CH) TYPE(CHGOBJ) FILE(PKA1CPP)           AB1140170;
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.BOH_Buy_Order_Number);
PARAMETER(PAR.BOL_Load_Number);
PARAMETER(PAR.TH_Tattoo_Number);
PARAMETER(PAR.TH_Kill_Date);
PARAMETER(PAR.Pricing_Date_USR);
PARAMETER(PAR.Market_Price_USR);
PARAMETER(PAR.TH_CM_Base_Mkt_Price);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
 PARAMETER(DB1.RS_User_Changed);
 PARAMETER(DB1.RS_Date_Changed);
 PARAMETER(DB1.RS_Time_Changed);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 {
  //?Execute internal function

  // PAR.RS User Changed = JOB.*USER
  PAR.RS_User_Changed = JOB.*USER;

  // PAR.RS Date Changed = JOB.*Job date
  PAR.RS_Date_Changed = JOB.*Job_date;

  // PAR.RS Time Changed = JOB.*Job time
  PAR.RS_Time_Changed = JOB.*Job_time;

  // PAR.RS Job = JOB.*JOB
  PAR.RS_Job = JOB.*JOB;

  // PAR.RS Program = JOB.*PROGRAM
  PAR.RS_Program = JOB.*PROGRAM;

 }

}


ENDIF;

//?As of HPE053P -- moved this condition here, so we still get the pric f/Car
CASE;

// IF PAR.TH Head Killed is Not Zero
IF PAR.TH_Head_Killed <> *ZERO;

//?11/29/05 PKD sending the Market Price for the TH CM Market Price
//?             instead of the base price.
// Call program Clc Carcass Analysis  XF.
CALL PROGRAM(Clc Carcass Analysis  XF) ('PKJ8XFR');
PARAMETER(PAR.BOH_Quote_Price_Type);
PARAMETER(PAR.PC_Contract_Code);
PARAMETER(PAR.PSC_Sub_Contract_Code);
PARAMETER(PAR.CMP_Program_Code);
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.BOH_Buy_Order_Number);
PARAMETER(PAR.BOL_Load_Number);
PARAMETER(PAR.TH_Tattoo_Number);
PARAMETER(PAR.TH_Kill_Date);
PARAMETER(PAR.TH_Live_Wgt);
PARAMETER(PAR.TH_Actual_Yield);
PARAMETER(PAR.TH_CM_Base_Mkt_Price);
PARAMETER('PAY');
PARAMETER(PAR.Pricing_UOM_USR);
PARAMETER(PAR.TH_Purchase_Date);
PARAMETER(PAR.TH_Head_Adds);
PARAMETER(PAR.TH_Adj_Actual_Yield);
PARAMETER(PAR.Market_Price_USR);
PARAMETER(PAR.TH_Avg_Hot_Wgt_EXC_ADD);
PARAMETER(PAR.TH_Head_Excluded);
PARAMETER(PAR.TH_Source_Type);
PARAMETER(PAR.TH_Payment_Type);
PARAMETER(PAR.TH_PHA_Lean_Prm_Crc_CWT);
PARAMETER(PAR.TH_VC_Gross_Value_HD);
PARAMETER(PAR.TH_PHA_Sort_Disc_Fctr);
PARAMETER(PAR.Competitors_Processing);
PARAMETER(PAR.CM_Processing_Type_Usr);

ENDIF;

