/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - PRINT SALES REALIZATION REPORT                       */
/*                                                                  */
/*  COMPANY   - SEABOARD COPRORATION                                */
/*  SYSTEM    - ORDER MANAGEMENT                                    */
/*  USER NAME - PEG LYONS                                           */
/*  DATE      - 01/03/96                                            */
/*                                                                  */
/*      PARAMETERS RECEIVED:                                        */
/*                                                                  */
/*          &COMPL      - COMPANY NUMBER                            */
/*          &FDATEL     - FROM DATE                                 */
/*          &TDATEL     - THROUGH DATE                              */
/*          &ITMPASS    - ITEM CODE PASS                            */
/*          &EXPSLS     - EXPORT SALES                              */
/*          &SELRPT     - SELECT REPORT                             */
/*          &SLSPR      - SALESPERSON                               */
/*          &SHPCL      - SHIP TO CUSTOMER                          */
/*          &MKTCODE    - MARKET CODE (USDA)                        */
/*          &ZONE       - SHIPPING ZONE                             */
/*          &ALLPROD    - INCLUDE ALL PRODUCTS                      */
/*          &FLAG       - FLAG                                      */
/*          &OUTQ       - OUTPUT QUEUE                              */
/*          &HOLD       - HOLD PRINT FLAG                           */
/*          &SAVE       - SAVE PRINT FLAG                           */
/*          &COPIESL    - NUMBER OF COPIES                          */
/*          &NIGHTQ     - FORMS TYPE                                */
/********************************************************************/
/* RMC   7/26/00   ADD PARM TO PASS TO PDGEPFR TO CREATE OUTFILE    */
/*                 AND TO FTP TO /DOWNLOAD.PORK                     */
/* RMC   3/22/01   ADD REPORT SEL. 5 FOR NEW SLS RLZ DWNLD          */
/* RMC   2/21/02   ADD WHSE TYPE AND WHSE CODE PARMS                */
/* RMC   3/24/04   ADD BROKER/CUST  RPT 6                           */
/* RMC   3/25/04   ADD BROKER/ITEM  RPT 7                           */
/* SLM   9/28/05   REPORT 1 FOR SPECIFIC COMPANY OR ALL COMPANIES   */
/* SLM   9/28/05   REPORT 1 FOR SPECIFIC COMPANY                    */
/* SLM  10/02/05   PASS ITEM CODE SELECTION -- NOT REQUIR5ED --     */
/* PKD  01/20/09   PASS ACTUAL OR ABSORBED FLAG                     */
/* PIO  06/08/23   REPLACE OPNQRYF WITH OPNSQLF FOR OMHSTPO2 FILE   */
/*                 ADDED NEEDED OVRDBF AROUND THE COMMAND           */
/*                 CHANGE *AND TO AND, *EQ TO =, *GE TO >=, *LE TO  */
/*                 <=, *GT TO > IN &H                               */
/* PIO  06/08/23   REPLACE OPNQRYF WITH OPNSQLF FOR OMHSTPM8 FILE   */
/*                 ADDED NEEDED OVRDBF AROUND THE COMMAND           */
/*                 CHANGE *AND TO AND, *EQ TO =, *GE TO >=, *LE TO  */
/*                 <=, *GT TO > IN &H                               */
/* PIO  06/08/23   REPLACE OPNQRYF WITH OPNSQLF FOR OMHSTPLW FILE   */
/*                 ADDED NEEDED OVRDBF AROUND THE COMMAND           */
/*                 CHANGE *AND TO AND, *EQ TO =, *GE TO >=, *LE TO  */
/*                 <=, *GT TO > IN &H                               */
/* PIO  06/08/23   REPLACE OPNQRYF WITH OPNSQLF FOR OMHSTPLF FILE   */
/*                 ADDED NEEDED OVRDBF AROUND THE COMMAND           */
/*                 CHANGE *AND TO AND, *EQ TO =, *GE TO >=, *LE TO  */
/*                 <=, *GT TO > IN &H                               */
/* PIO  06/08/23   REPLACE OPNQRYF WITH OPNSQLF FOR OMHSTPN2 FILE   */
/*                 ADDED NEEDED OVRDBF AROUND THE COMMAND           */
/*                 CHANGE *AND TO AND, *EQ TO =, *GE TO >=, *LE TO  */
/*                 <=, *GT TO > IN &H                               */
/* PIO  06/08/23   REPLACE OPNQRYF WITH OPNSQLF FOR OMHSTPN6 FILE   */
/*                 ADDED NEEDED OVRDBF AROUND THE COMMAND           */
/*                 CHANGE *AND TO AND, *EQ TO =, *GE TO >=, *LE TO  */
/*                 <=, *GT TO > IN &H                               */
/* PIO  06/08/23   REPLACE OPNQRYF WITH OPNSQLF FOR OMHSTPN7 FILE   */
/*                 ADDED NEEDED OVRDBF AROUND THE COMMAND           */
/*                 CHANGE *AND TO AND, *EQ TO =, *GE TO >=, *LE TO  */
/*                 <=, *GT TO > IN &H                               */
/********************************************************************/

 PDGEPCLP:   PGM        PARM(&COMPL &FDATEL &TDATEL &ITMPASS &EXPSLS +
                          &SELRPT &SLSPR &SHPCL &MKTCODE &ZONE +
                          &OUTQ &HOLD &SAVE &COPIESL &NIGHTQ +
                          &ALLPROD &FLAG &FLAG3 &FTP &DOCUM &WHSTYP +
                          &WHSCOD &ACTABS &BRK)

        DCL    &COMP      *DEC    (3 0)           /*  COMPANY #      */
        DCL    &COMPL     *DEC                    /*  FOR PASSING    */
        DCL    &FDATE     *DEC    (7 0)           /*  FROM DATE      */
        DCL    &FDATEL    *DEC                    /*  FOR PASSING    */
        DCL    &TDATE     *DEC    (7 0)           /*  THROUGH DATE   */
        DCL    &TDATEL    *DEC                    /*  FOR PASSING    */
        DCL    &SHPCS     *DEC    (7 0)           /*  SHIP TO CUST   */
        DCL    &SHPCL     *DEC                    /*  FOR PASSING    */
        DCL    &ITMPASS   *DEC                    /*  ITEM PASS      */
        DCL    &ITMNO     *DEC    (7 0)           /*  ITEM NUMBER    */
        DCL    &EXPSLS    *CHAR    (1)            /*  FOR PASSING    */
        DCL    &SELRPT    *CHAR    (1)            /*  FOR PASSING    */
        DCL    &SLSPR     *CHAR    (3)            /*  SALESPERSON    */
        DCL    &MKTCODE   *CHAR    (3)            /*  FOR PASSING    */
        DCL    &ZONE      *CHAR    (4)            /*  FOR PASSING    */
        DCL    &ALLPROD   *CHAR    (1)            /*  FOR PASSING    */
        DCL    &FLAG      *CHAR    (1)            /*  FOR PASSING    */
        DCL    &COPIES    *DEC    (3 0)           /*  # OF COPIES    */
        DCL    &COPIESL   *DEC                    /*  FOR PASSING    */
        DCL    &OUTQ      *CHAR   10              /*  OUTPUT QUEUE   */
        DCL    &NIGHTQ    *CHAR   10              /*  NIGHT JOB QUEUE*/
        DCL    &HOLD       *CHAR   (4)            /* Hold Status     */
        DCL    &SAVE       *CHAR   (4)            /* Save Status     */
        DCL    &PGM       *CHAR   10              /*  PGM NAME       */
        DCL    &COMPA     *CHAR   3               /*  COMPANY ALPHA  */
        DCL    &TDATEA    *CHAR   7               /*  TO DATE ALPHA  */
        DCL    &FDATEA    *CHAR   7               /*  FROM DT ALPHA  */
        DCL    &SHPCA     *CHAR   7               /*  SHIP TO ALPHA  */
        DCL    &FTP       *CHAR    (1)            /*  FOR PASSING    */
        DCL    &DOCUMENT  *CHAR   (10)
        DCL    &DOCUM     *CHAR    (8)            /*  FOR PASSING    */
        DCL    &WHSTYP    *CHAR   (2)
        DCL    &WHSCOD    *CHAR    (3)            /*  FOR PASSING    */
        DCL    &ACTABS    *CHAR   (1)             /* ACTUAL OR ABSORBED  */
        DCL    &BRK       *CHAR    (3)            /*  FOR PASSING    */
        DCL    &PCFILE    *CHAR   (32)
        DCL    &SEL       *CHAR    (1500)         /*  FOR PASSING    */
        DCL    &COMMAND    *CHAR   (512)

/* SEND PROGRAM MESSAGE PARAMETERS  */

        DCL     &PGMO     *CHAR   10              /*  PRINTER FILE   */
        DCL     &A        *CHAR   20              /* QRY FRM DATE    */
        DCL     &B        *CHAR   25              /* QRY TO DATE     */
        DCL     &C        *CHAR   25              /* QRY COMPANY     */
        DCL     &D        *CHAR   25              /* QRY EXPORT SALES*/
        DCL     &E        *CHAR   25              /* QRY SHIPTO CUST */
        DCL     &F        *CHAR   25              /* QRY SALESPERSON */
        DCL     &G        *CHAR   25              /* QRY SHIP ZONE   */
        DCL     &I        *CHAR   25              /* QRY WHSE CODE   */
        DCL     &J        *CHAR   25              /* QRY BRK CODE   */
        DCL     &H        *CHAR  200              /* QRY ALL         */
        DCL     &DATA     *CHAR   10              /* DATA FILES      */
        DCL     &DATAH    *CHAR   10              /* HIST FILES      */
        DCL     &FLAG3    *CHAR    1              /*MKT CODE         */

             CHGVAR    VAR(&COMP) VALUE(&COMPL) /* Change to length +
                          for print program */
             CHGVAR    VAR(&COMPA) VALUE(&COMP) /* Change to alpha +
                          for message data */
             CHGVAR    VAR(&FDATE) VALUE(&FDATEL) /* Change to length +
                          for print program */
             CHGVAR    VAR(&FDATEA) VALUE(&FDATE) /* Change to alpha +
                          for query data */
             CHGVAR    VAR(&TDATE) VALUE(&TDATEL) /* Change to length +
                          for print program */
             CHGVAR    VAR(&TDATEA) VALUE(&TDATE) /* Change to alpha +
                          for query data */
             CHGVAR    VAR(&SHPCS) VALUE(&SHPCL) /* Change to length +
                          for print program */
             CHGVAR    VAR(&SHPCA) VALUE(&SHPCS) /* Change to alpha +
                          for query data */
             CHGVAR    VAR(&COPIES) VALUE(&COPIESL) /* change to +
                          length for print program */

/********************************************************************/
/* APPEND $ TO THE PROGRAM NAME                                     */
/********************************************************************/
             IF         COND(&SELRPT *EQ '1') THEN(DO)
             CHGVAR     VAR(&PGM)  VALUE('PDGEPFR')
             ENDDO
             IF         COND(&SELRPT *EQ '2') THEN(DO)
             CHGVAR     VAR(&PGM)  VALUE('PDOFPFR')
             ENDDO
             IF         COND(&SELRPT *EQ '3') THEN(DO)
             CHGVAR     VAR(&PGM)  VALUE('PDOEPFR')
             ENDDO
             IF         COND(&SELRPT *EQ '4') THEN(DO)
             CHGVAR     VAR(&PGM)  VALUE('PDC0PFR')
             ENDDO

             IF         COND(&SELRPT *EQ '5') THEN(DO)
             CHGVAR     VAR(&PGM)  VALUE('POJ4PFR')
             ENDDO
             IF         COND(&SELRPT *EQ '6') THEN(DO)
             CHGVAR     VAR(&PGM)  VALUE('PPD3PFR')
             ENDDO
             IF         COND(&SELRPT *EQ '7') THEN(DO)
             CHGVAR     VAR(&PGM)  VALUE('PPD4PFR')
             ENDDO

             CHGVAR     VAR(&PGMO) VALUE(&PGM *TCAT '$')

/*********************************************************************/
/*   CREATE OPEN QUERY FILE TO BE USED FOR REPORT                    */
/*********************************************************************/

  /*PIO      CHGVAR     VAR(&A) VALUE('F4GNDT *GE ' *CAT + +
                         &FDATEA)                         */
  /*PIO*/    CHGVAR     VAR(&A) VALUE('F4GNDT  >= ' *CAT +
                         &FDATEA)

  /*PIO      CHGVAR     VAR(&B) VALUE('*AND F4GNDT *LE ' *CAT + +
                         &TDATEA)                              */
  /*PIO*/    CHGVAR     VAR(&B) VALUE(' AND F4GNDT <=  ' *CAT +
                         &TDATEA)

  /*PIO      CHGVAR     VAR(&C) VALUE('*AND F4AIC3 *EQ ' *CAT + +
                         &COMPA)                               */
  /*PIO*/    CHGVAR     VAR(&C) VALUE(' AND F4AIC3  =  ' *CAT +
                         &COMPA)

             IF         COND(&EXPSLS *EQ 'N') THEN(DO)
 /*PIO       CHGVAR     VAR(&D) VALUE('*AND F4U2ST *NE ' *CAT + +
                         '"Y"')                                */
 /*PIO*/     CHGVAR     VAR(&D) VALUE(' AND F4U2ST <>  ' *CAT +
                         '"Y"')
             ENDDO
             IF         COND(&EXPSLS *EQ 'E') THEN(DO)
 /*PIO       CHGVAR     VAR(&D) VALUE('*AND F4U2ST *EQ ' *CAT + +
                         '"Y"')                                */
 /*PIO*/     CHGVAR     VAR(&D) VALUE(' AND F4U2ST  =  ' *CAT +
                         '"Y"')
             ENDDO

             IF         COND(&SHPCA *NE '0000000') THEN(DO)
 /*PIO       CHGVAR     VAR(&E) VALUE('*AND F4BKC7 *EQ ' *CAT + +
                         &SHPCA)                               */
 /*PIO*/     CHGVAR     VAR(&E) VALUE(' AND F4BKC7  =  ' *CAT +
                         &SHPCA)
             ENDDO

             IF         COND(&SLSPR *NE '   ') THEN(DO)
 /*PIO       CHGVAR     VAR(&F) VALUE('*AND F4R4CD *EQ "' *CAT + +
                         &SLSPR *CAT '"')                       */
 /*PIO*/     CHGVAR     VAR(&F) VALUE(' AND F4R4CD  =  "' *CAT +
                         &SLSPR *CAT '"')
             ENDDO

             IF         COND(&ZONE *NE '    ') THEN(DO)
 /*PIO       CHGVAR     VAR(&G) VALUE('*AND F4X1CD *EQ "' *CAT + +
                         &ZONE *CAT '"')                        */
 /*PIO*/     CHGVAR     VAR(&G) VALUE(' AND F4X1CD  =  "' *CAT +
                         &ZONE *CAT '"')
/*           CHGVAR     VAR(&G) VALUE('*AND F4X1CD *EQ ' *CAT &ZONE) */
             ENDDO

WHSCOD:      IF         COND(&WHSCOD *NE '   ') THEN(DO)
 /*PIO       CHGVAR     VAR(&I) VALUE('*AND F4AJCD *EQ "' *CAT + +
                         &WHSCOD *CAT '"')                      */
 /*PIO*/     CHGVAR     VAR(&I) VALUE(' AND F4AJCD  =  "' *CAT +
                         &WHSCOD *CAT '"')
             ENDDO
BRKCOD:      IF         COND(&BRK *NE '   ') THEN(DO)
 /*PIO       CHGVAR     VAR(&J) VALUE('*AND F4N1CD *EQ "' *CAT + +
                         &BRK *CAT '"')                         */
 /*PIO*/     CHGVAR     VAR(&J) VALUE(' AND F4N1CD  =  "' *CAT +
                         &BRK *CAT '"')
             ENDDO

             IF         COND(&SELRPT *NE '1') THEN(DO)
             CHGVAR     VAR(&H) VALUE(&A *BCAT &B *BCAT &C *BCAT &D +
                         *BCAT &E *BCAT &F *BCAT &G *BCAT &I *BCAT &J)
             ENDDO

/*********************************************************************/
/* Report 1 can be by selecting a specific Company or All Companies  */
/*   &C will have the company number being selected if passed in     */
/*   The only difference is the building of the variable "H"         */
/*   one is with company and the other is without company.           */
/*********************************************************************/
             IF         COND(&SELRPT *EQ '1') THEN(DO)

             IF         COND(&COMPA *NE '000') THEN(DO)
             CHGVAR     VAR(&H) VALUE(&A *BCAT &B *BCAT &C *BCAT &D +
                         *BCAT &E *BCAT &F *BCAT &G *BCAT &I *BCAT &J)
             ENDDO

             IF         COND(&COMPA *EQ '000') THEN(DO)
             CHGVAR     VAR(&H) VALUE(&A *BCAT &B *BCAT &D *BCAT &E +
                          *BCAT &F *BCAT &G *BCAT &I *BCAT &J)

             ENDDO

   /*PIO     OVRDBF     FILE(OMHSTPO2) SHARE(*YES)   +
             OPNQRYF    FILE(OMHSTPO2) +             +
                        QRYSLT(&H) +                 +
                        KEYFLD(*FILE)               */

  /*PIO*/    OVRDBF     FILE(OMHSTPP) TOFILE(OMHSTPP) LVLCHK(*NO)
             OPNSQLF    SQL('Select * from OMHSTPP Where  ' *BCAT &H +
                          *BCAT ' ORDER BY F4RHNB ASC, F4S5NB ASC, +
                          F4AIC3 ASC') OPNID(OMHSTPO2) OPTION(*ALL) +
                          SEQONLY(*NO) RCDFMT(@HSTPEJ) +
                          ALWCPY(*IFRQD) /*PIO*/
  /*PIO*/    OVRDBF     FILE(OMHSTPO2) TOFILE(OMHSTPP) LVLCHK(*NO) +
                          OVRSCOPE(*JOB) SHARE(*YES) OPNSCOPE(*JOB)

             ENDDO
/****                                                             ****/

             IF         COND(&SELRPT *EQ '2') THEN(DO)
 /*PIO       OVRDBF     FILE(OMHSTPM8) SHARE(*YES)    +
             OPNQRYF    FILE(OMHSTPM8) +              +
                        QRYSLT(&H) +                  +
                        KEYFLD(*FILE)                */

 /*PIO*/     OVRDBF     FILE(OMHSTPP) TOFILE(OMHSTPP) LVLCHK(*NO)
             OPNSQLF    SQL('Select * from OMHSTPP Where  ' *BCAT &H +
                          *BCAT ' ORDER BY F4AIC3 ASC, F4CRCD ASC, +
                          F4R4CD ASC, F4S5NB ASC') OPNID(OMHSTPM8) +
                          OPTION(*ALL) SEQONLY(*NO) RCDFMT(@HSTPC2) +
                          ALWCPY(*IFRQD) /*PIO*/
 /*PIO*/     OVRDBF     FILE(OMHSTPM8) TOFILE(OMHSTPP) LVLCHK(*NO) +
                          OVRSCOPE(*JOB) SHARE(*YES) OPNSCOPE(*JOB)

             ENDDO

             IF         COND(&SELRPT *EQ '3') THEN(DO)
 /*PIO       OVRDBF     FILE(OMHSTPLW) SHARE(*YES)  +
             OPNQRYF    FILE(OMHSTPLW) +            +
                        QRYSLT(&H) +                +
                        KEYFLD(*FILE)              */

 /*PIO*/     OVRDBF     FILE(OMHSTPP) TOFILE(OMHSTPP) LVLCHK(*NO)
             OPNSQLF    SQL('Select * from OMHSTPP Where  ' *BCAT &H +
                          *BCAT ' ORDER BY F4AIC3 ASC, F4CRCD ASC, +
                          F4R4CD ASC, F4AQTX ASC, F4ANC7 ASC, +
                          F4BRTX ASC, F4BKC7 ASC, F4S5NB ASC') +
                          OPNID(OMHSTPLW) OPTION(*ALL) SEQONLY(*NO) +
                          RCDFMT(@HSTPRA) ALWCPY(*IFRQD) /*PIO*/
 /*PIO*/     OVRDBF     FILE(OMHSTPLW) TOFILE(OMHSTPP) LVLCHK(*NO) +
                          OVRSCOPE(*JOB) SHARE(*YES) OPNSCOPE(*JOB)

             ENDDO

             IF         COND(&SELRPT *EQ '4') THEN(DO)
 /*PIO       OVRDBF     FILE(OMHSTPLF) SHARE(*YES)   +
             OPNQRYF    FILE(OMHSTPLF) +             +
                        QRYSLT(&H) +                 +
                        KEYFLD(*FILE)              */

 /*PIO*/     OVRDBF     FILE(OMHSTPP) TOFILE(OMHSTPP) LVLCHK(*NO)
             OPNSQLF    SQL('Select * from OMHSTPP Where  ' *BCAT &H +
                          *BCAT ' ORDER BY F4AIC3 ASC, F4CRCD ASC, +
                          F4X1CD ASC, F4RHNB ASC, F4S5NB ASC') +
                          OPNID(OMHSTPLF) OPTION(*ALL) SEQONLY(*NO) +
                          RCDFMT(@HSTPQU) ALWCPY(*IFRQD) /*PIO*/
 /*PIO*/     OVRDBF     FILE(OMHSTPLF) TOFILE(OMHSTPP) LVLCHK(*NO) +
                          OVRSCOPE(*JOB) SHARE(*YES) OPNSCOPE(*JOB)

             ENDDO


             IF         COND(&SELRPT *EQ '5') THEN(DO)
 /*PIO       OVRDBF     FILE(OMHSTPN2) SHARE(*YES)    +
             OPNQRYF    FILE(OMHSTPN2) +              +
                        QRYSLT(&H) +                  +
                        KEYFLD(*FILE)                */

  /*PIO*/    OVRDBF     FILE(OMHSTPP) TOFILE(OMHSTPP) LVLCHK(*NO)
             OPNSQLF    SQL('Select * from OMHSTPP Where  ' *BCAT &H +
                          *BCAT ' ORDER BY F4AIC3 ASC, F4RHNB ASC, +
                          F4S5NB ASC, F4AJCD ASC') OPNID(OMHSTPN2) +
                          OPTION(*ALL) SEQONLY(*NO) RCDFMT(@HSTPJC) +
                          ALWCPY(*IFRQD) /*PIO*/
  /*PIO*/    OVRDBF     FILE(OMHSTPN2) TOFILE(OMHSTPP) LVLCHK(*NO) +
                          OVRSCOPE(*JOB) SHARE(*YES) OPNSCOPE(*JOB)

             ENDDO


             IF         COND(&SELRPT *EQ '6') THEN(DO)
 /*PIO       OVRDBF     FILE(OMHSTPN6) SHARE(*YES)  +
             OPNQRYF    FILE(OMHSTPN6) +            +
                        QRYSLT(&H) +                +
                        KEYFLD(*FILE)              */

 /*PIO*/     OVRDBF     FILE(OMHSTPP) TOFILE(OMHSTPP) LVLCHK(*NO)
             OPNSQLF    SQL('Select * from OMHSTPP Where  ' *BCAT &H +
                          *BCAT ' ORDER BY F4AIC3 ASC, F4CRCD ASC, +
                          F4N1CD ASC, F4AQTX ASC, F4ANC7 ASC, +
                          F4BRTX ASC, F4BKC7 ASC, F4S5NB ASC') +
                          OPNID(OMHSTPN6) OPTION(*ALL) SEQONLY(*NO) +
                          RCDFMT(@HSTPUT) ALWCPY(*IFRQD) /*PIO*/
 /*PIO*/     OVRDBF     FILE(OMHSTPN6) TOFILE(OMHSTPP) LVLCHK(*NO) +
                          OVRSCOPE(*JOB) SHARE(*YES) OPNSCOPE(*JOB)

             ENDDO

             IF         COND(&SELRPT *EQ '7') THEN(DO)
 /*PIO       OVRDBF     FILE(OMHSTPN7) SHARE(*YES)    +
             OPNQRYF    FILE(OMHSTPN7) +              +
                        QRYSLT(&H) +                  +
                        KEYFLD(*FILE)                */

 /*PIO*/     OVRDBF     FILE(OMHSTPP) TOFILE(OMHSTPP) LVLCHK(*NO)
             OPNSQLF    SQL('Select * from OMHSTPP Where  ' *BCAT &H +
                          *BCAT ' ORDER BY F4AIC3 ASC, F4N1CD ASC, +
                          F4S5NB ASC') OPNID(OMHSTPN7) OPTION(*ALL) +
                          SEQONLY(*NO) RCDFMT(@HSTPUM) +
                          ALWCPY(*IFRQD) /*PIO*/
 /*PIO*/     OVRDBF     FILE(OMHSTPN7) TOFILE(OMHSTPP) LVLCHK(*NO) +
                          OVRSCOPE(*JOB) SHARE(*YES) OPNSCOPE(*JOB)

             ENDDO
/********************************************************************/
/* Override printer file with user specified values                 */
/********************************************************************/

             SBDPRTOVR  CMDVAR(&COMMAND) FILE(&PGMO) OUTQ(&OUTQ) +
                          COPIES(&COPIES) HOLD(&HOLD) SAVE(&SAVE)

             CALL       PGM(QCMDEXC) PARM(&COMMAND 512)

/*********************************************************************/
/*   CALL LISTING PROGRAM                                            */
/*********************************************************************/

/*           CALL       PGM(&PGM) PARM('' &COMP &SHPCS &SLSPR &ZONE +
                          &FDATE &TDATE &MKTCODE &EXPSLS &ALLPROD +
                          &FLAG &SELRPT &FLAG3)                      */

             IF         COND(&SELRPT *EQ '1') THEN(DO)
             CALL      PGM(CAQXXFR) PARM(' ' &DATA &DATAH)
             CRTDUPOBJ  OBJ(POAYCPP) FROMLIB(&DATA) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ OBJ(POAYCPL0) FROMLIB(&DATA) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ OBJ(POAYCPL1) FROMLIB(&DATA) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)

             CALL       PGM(&PGM) PARM('' &COMP &SHPCS &SLSPR &ZONE +
                          &FDATE &TDATE &MKTCODE &ITMPASS &EXPSLS +
                          &ALLPROD &FLAG &SELRPT &FTP &FLAG3 +
                          &WHSTYP &WHSCOD &ACTABS)
             CLOF       OPNID(OMHSTPO2)
   /*PIO     DLTOVR     FILE(OMHSTPO2)  */
             DLTOVR     FILE(OMHSTPO2) LVL(*JOB) /*PIO*/
 /*------------------------------------------------*/
   /* RUN SQL TO PUSH document to /DOWNLOAD.PORK    */
 /*------------------------------------------------*/
             IF         COND(&FTP *EQ 'Y') THEN(DO)

             ADDLIBLE LIB(SEQUEL) POSITION(*LAST)
             MONMSG MSGID(CPF2103)
   /*------------------------------------------------*/
   /* EXECUTE SEQUEL TO SELECT THE WORKF FILE AND FTP IT -*/
   /*-----------------------------------------------*/
             CHGVAR     VAR(&SEL) VALUE('SELECT AYAIC3 +
                          COLHDG("Company"), ayncnx colhdg("Date +
                          Range"), ayxvtx colhdg("Select" +
                          "Report"),ayrhnb colHDg("Group"), ays5nb +
                          COLHDG("Product" "Code"), ayxwtx COLHDG(" +
                          "),ayavnA COLHDG("Description"), ayusva +
                          colhdg("FOB" "Price/CWT"), AYCuVL +
                          colhdg("Mkt" "Price/CWT"), aycvvl      +
                          colhdg("Overage" "Achieved"), ayutva +
                          colhdg("Standard" "Overage"), aycwvl +
                          colhdg("Var/CWT"), ayihwg +
                          colhdg("Shipped"), aybsaa COLHDG("UM"), +
                          ayndnx colhdg("Net $"), aycxvl +
                          colhdg("Dollar" "Variance") FROM     +
                          QTEMP/POAYCPP')
             EXECUTE    SQL(&SEL) MBROPT(*REPLACE) NBRRCDS(*ALL) +
                          KEYFLDCNT(*ALL) ALWNULL(*NO) +
                          TOFLR('GUY.IS') TODOC(&DOCUM) +
                          PCFMT(*XLS) REPLACE(*YES) +
                          TEXT('Sales Realization') +
                          OPTIMIZE(*TOTAL) ALWCPY(*YES) MSG(*YES) +
                          UNIQUEKEY(*NONE) IGNDECERR(*NO) +
                          DTSTYLE(*FIELD '/' *FIELD ':')

   /*------------------------------------*/
   /* PUSH documents to /DOWNLOAD.PORK    */
   /*------------------------------------*/
             CHGVAR VAR(&DOCUMENT) VALUE(&DOCUM)
             CHGVAR VAR(&PCFILE)   VALUE(&DOCUM *TCAT '.CSV')
             CALL PGM(FTPTEST) PARM(&DOCUMENT &PCFILE)

             ENDDO
             ENDDO

             IF         COND(&SELRPT *EQ '2') THEN(DO)
             CALL       PGM(&PGM) PARM('' &COMP &SHPCS &SLSPR &ZONE +
                          &FDATE &TDATE &MKTCODE &EXPSLS &ALLPROD +
                          &FLAG &SELRPT &FLAG3 &WHSTYP &WHSCOD)
             CLOF       OPNID(OMHSTPM8)
   /*PIO     DLTOVR     FILE(OMHSTPM8)    */
             DLTOVR     FILE(OMHSTPM8) LVL(*JOB) /*PIO*/
             ENDDO

             IF         COND(&SELRPT *EQ '3')  THEN(DO)
             CALL       PGM(&PGM) PARM('' &COMP &SHPCS &SLSPR &ZONE +
                          &FDATE &TDATE &MKTCODE &EXPSLS &ALLPROD +
                          &FLAG &SELRPT &FLAG3 &WHSTYP &WHSCOD)
             CLOF       OPNID(OMHSTPLW)
   /*PIO     DLTOVR     FILE(OMHSTPLW)  */
             DLTOVR     FILE(OMHSTPLW) LVL(*JOB) /*PIO*/
             ENDDO

             IF         COND(&SELRPT *EQ '4')  THEN(DO)
             CALL       PGM(&PGM) PARM('' &COMP &SHPCS &SLSPR &ZONE +
                          &FDATE &TDATE &MKTCODE &EXPSLS &ALLPROD +
                          &FLAG &SELRPT &FLAG3 &WHSTYP &WHSCOD)
             CLOF       OPNID(OMHSTPLF)
   /*PIO     DLTOVR     FILE(OMHSTPLF)   */
             DLTOVR     FILE(OMHSTPLF) LVL(*JOB) /*PIO*/
             ENDDO

             IF         COND(&SELRPT *EQ '6')  THEN(DO)
             CALL       PGM(&PGM) PARM('' &COMP &SHPCS &SLSPR &BRK &ZONE +
                          &FDATE &TDATE &MKTCODE &EXPSLS &ALLPROD +
                          &FLAG &SELRPT &FLAG3 &WHSTYP &WHSCOD)
             CLOF       OPNID(OMHSTPN6)
   /*PIO     DLTOVR     FILE(OMHSTPN6)      */
             DLTOVR     FILE(OMHSTPN6) LVL(*JOB) /*PIO*/
             ENDDO

             IF         COND(&SELRPT *EQ '7')  THEN(DO)
             CALL       PGM(&PGM) PARM('' &COMP &SHPCS &SLSPR &BRK &ZONE +
                          &FDATE &TDATE &MKTCODE &EXPSLS &ALLPROD +
                          &FLAG &SELRPT &FLAG3 &WHSTYP &WHSCOD)
             CLOF       OPNID(OMHSTPN7)
   /*PIO     DLTOVR     FILE(OMHSTPN7)   */
             DLTOVR     FILE(OMHSTPN7) LVL(*JOB) /*PIO*/
             ENDDO

             IF         COND(&SELRPT *EQ '5') THEN(DO)
             CALL      PGM(CAQXXFR) PARM(' ' &DATA &DATAH)
             CRTDUPOBJ  OBJ(POA6CPP) FROMLIB(&DATA) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ OBJ(POA6CPL0) FROMLIB(&DATA) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ OBJ(POA6CPL1) FROMLIB(&DATA) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)

             CALL       PGM(&PGM) PARM('' &COMP &SHPCS &SLSPR &ZONE +
                          &FDATE &TDATE &MKTCODE &EXPSLS &ALLPROD +
                          &FLAG &SELRPT &FTP &FLAG3 &WHSTYP &WHSCOD)
             CLOF       OPNID(OMHSTPN2)
     /*PIO   DLTOVR     FILE(OMHSTPN2)     */
             DLTOVR     FILE(OMHSTPN2) LVL(*JOB) /*PIO*/
 /*------------------------------------------------*/
   /* RUN SQL TO PUSH document to /DOWNLOAD.PORK    */
 /*------------------------------------------------*/
             IF         COND(&FTP *EQ 'Y') THEN(DO)

             ADDLIBLE LIB(SEQUEL) POSITION(*LAST)
             MONMSG MSGID(CPF2103)
   /*------------------------------------------------*/
   /* EXECUTE SEQUEL TO SELECT THE WORKF FILE AND FTP IT -*/
   /*-----------------------------------------------*/
             CHGVAR     VAR(&SEL) VALUE('SELECT A6AIC3 +
                          COLHDG("Company"), a6ncnx colhdg("Date +
                          Range"), a6xvtx colhdg("Select" +
                          "Report"),a6rhnb colHDg("Group"), a6s5nb +
                          COLHDG("Product" "Code"), a6WPST +
                          COLHDG("Whse" "Type"), A6XWTX COLHDG(" +
                          "),a6usva +
                          colhdg("FOB" "Price/CWT"), A6CuVL +
                          colhdg("Mkt" "Price/CWT"), a6cvvl      +
                          colhdg("Overage" "Achieved"), a6utva +
                          colhdg("Standard" "Overage"), a6cwvl +
                          colhdg("Var/CWT"), a6ihwg +
                          colhdg("Shipped"), a6bsaa COLHDG("UM"), +
                          a6ndnx colhdg("Net $"), a6cxvl +
                          colhdg("Dollar" "Variance") FROM +
                          QTEMP/POA6CPP')
             EXECUTE    SQL(&SEL) MBROPT(*REPLACE) NBRRCDS(*ALL) +
                          KEYFLDCNT(*ALL) ALWNULL(*NO) +
                          TOFLR('GUY.IS') TODOC(&DOCUM) +
                          PCFMT(*DELIMITED) REPLACE(*YES) +
                          TEXT('Sales Realization') +
                          OPTIMIZE(*TOTAL) ALWCPY(*YES) MSG(*YES) +
                          UNIQUEKEY(*NONE) IGNDECERR(*NO) +
                          DTSTYLE(*FIELD '/' *FIELD ':')

   /*------------------------------------*/
   /* PUSH documents to /DOWNLOAD.PORK    */
   /*------------------------------------*/
             CHGVAR VAR(&DOCUMENT) VALUE(&DOCUM)
             CHGVAR VAR(&PCFILE)   VALUE(&DOCUM *TCAT '.CSV')
             CALL PGM(FTPTEST) PARM(&DOCUMENT &PCFILE)

             ENDDO
             ENDDO
 END:        ENDPGM
