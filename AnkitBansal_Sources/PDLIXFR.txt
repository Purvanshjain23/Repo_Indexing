     H/TITLE CLC Age Code for CTL   XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : SYNON/2  Version:  1035
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISJTREM
     H* Date          : 03/18/98  Time  : 08:39:18
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company/Item              Retrieval index       NV
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : IC Item Balance Detail    Retrieval index       NV
      *
     E                    YDOW        7  1               *Days of week
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WAAJCD
     I              ADF8NA                          WAF8NA
     I              ADACNA                          WAACNA
     I              ADADNA                          WAADNA
     I              ADAENA                          WAAENA
     I              ADAJNA                          WAAJNA
     I              ADBTTX                          WABTTX
     I              ADAOCD                          WAAOCD
     I              ADBGCD                          WABGCD
     I              ADVHST                          WAVHST
     I              ADMPNA                          WAMPNA
     I              ADWPST                          WAWPST
     I              ADXUST                          WAXUST
     I              ADT0ST                          WAT0ST
     I              ADT1ST                          WAT1ST
     I              ADDBNB                          WADBNB
     I              ADT2ST                          WAT2ST
     I              ADT3ST                          WAT3ST
     I              ADT4ST                          WAT4ST
     I              ADT6ST                          WAT6ST
     I              ADT7ST                          WAT7ST
     I              ADT8ST                          WAT8ST
     I              ADUVST                          WAUVST
     I              ADUWST                          WAUWST
     I              ADUXST                          WAUXST
     I              ADVSST                          WAVSST
     I              ADAATM                          WAAATM
     I              ADAYNA                          WAAYNA
     I              ADA0NA                          WAA0NA
     I              ADAXDT                          WAAXDT
      *
     I@BZREJU
      * Company/Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WBAIC3
     I              BZHGCD                          WBHGCD
     I              BZAVNA                          WBAVNA
     I              BZAWNA                          WBAWNA
     I              BZL7NA                          WBL7NA
     I              BZL8NA                          WBL8NA
     I              BZL6NA                          WBL6NA
     I              BZMFNA                          WBMFNA
     I              BZADCD                          WBADCD
     I              BZAWPC                          WBAWPC
     I              BZLXST                          WBLXST
     I              BZAECD                          WBAECD
     I              BZAXPC                          WBAXPC
     I              BZLYST                          WBLYST
     I              BZAFCD                          WBAFCD
     I              BZAICD                          WBAICD
     I              BZAIWG                          WBAIWG
     I              BZHICD                          WBHICD
     I              BZRBCD                          WBRBCD
     I              BZFZST                          WBFZST
     I              BZAVST                          WBAVST
     I              BZCZWG                          WBCZWG
     I              BZC0WG                          WBC0WG
     I              BZURTN                          WBURTN
     I              BZAJC8                          WBAJC8
     I              BZRINB                          WBRINB
     I              BZRHNB                          WBRHNB
     I              BZRGNB                          WBRGNB
     I              BZLNCD                          WBLNCD
     I              BZTFNB                          WBTFNB
     I              BZN0CD                          WBN0CD
     I              BZX4ST                          WBX4ST
     I              BZTMVA                          WBTMVA
     I              BZTNVA                          WBTNVA
     I              BZBLPR                          WBBLPR
     I              BZBMPR                          WBBMPR
     I              BZLRCD                          WBLRCD
     I              BZU9ST                          WBU9ST
     I              BZCMCO                          WBCMCO
     I              BZQ1CD                          WBQ1CD
     I              BZQ8CD                          WBQ8CD
     I              BZCHTM                          WBCHTM
     I              BZQZCD                          WBQZCD
     I              BZXWST                          WBXWST
     I              BZXXST                          WBXXST
     I              BZVMST                          WBVMST
     I              BZSWGH                          WBSWGH
     I              BZPPHE                          WBPPHE
     I              BZR3CD                          WBR3CD
     I              BZSDCD                          WBSDCD
     I              BZICN1                          WBICN1
     I              BZSVCD                          WBSVCD
     I              BZICN2                          WBICN2
     I              BZSWCD                          WBSWCD
     I              BZV2NB                          WBV2NB
     I              BZSXCD                          WBSXCD
     I              BZITCN                          WBITCN
     I              BZSYCD                          WBSYCD
     I              BZITC5                          WBITC5
     I              BZSZCD                          WBSZCD
     I              BZICN6                          WBICN6
     I              BZS0CD                          WBS0CD
     I              BZICN7                          WBICN7
     I              BZS1CD                          WBS1CD
     I              BZICN8                          WBICN8
     I              BZS2CD                          WBS2CD
     I              BZICN9                          WBICN9
     I              BZS3CD                          WBS3CD
     I              BZICN0                          WBICN0
     I              BZS4CD                          WBS4CD
     I              BZSFNB                          WBSFNB
     I              BZA3WG                          WBA3WG
     I              BZSJNB                          WBSJNB
     I              BZLLCD                          WBLLCD
     I              BZLMCD                          WBLMCD
     I              BZP3ST                          WBP3ST
     I              BZSKNB                          WBSKNB
     I              BZSLNB                          WBSLNB
     I              BZSMNB                          WBSMNB
     I              BZP4ST                          WBP4ST
     I              BZCFNB                          WBCFNB
     I              BZCGNB                          WBCGNB
     I              BZILNB                          WBILNB
     I              BZCHNB                          WBCHNB
     I              BZCINB                          WBCINB
     I              BZCJNB                          WBCJNB
     I              BZCMNB                          WBCMNB
     I              BZCNNB                          WBCNNB
     I              BZCRNB                          WBCRNB
     I              BZCSNB                          WBCSNB
     I              BZCVNB                          WBCVNB
     I              BZCWNB                          WBCWNB
     I              BZCXNB                          WBCXNB
     I              BZCZNB                          WBCZNB
     I              BZC0NB                          WBC0NB
     I              BZN1CD                          WBN1CD
     I              BZB4NB                          WBB4NB
     I              BZB5NB                          WBB5NB
     I              BZX5ST                          WBX5ST
     I              BZX6ST                          WBX6ST
     I              BZX7ST                          WBX7ST
     I              BZPCCT                          WBPCCT
     I              BZBDNB                          WBBDNB
     I              BZBJNB                          WBBJNB
     I              BZSUST                          WBSUST
     I              BZSVST                          WBSVST
     I              BZSYST                          WBSYST
     I              BZSZST                          WBSZST
     I              BZS1ST                          WBS1ST
     I              BZXRCD                          WBXRCD
     I              BZXTCD                          WBXTCD
     I              BZXUCD                          WBXUCD
     I              BZF5WG                          WBF5WG
     I              BZF6WG                          WBF6WG
     I              BZF7WG                          WBF7WG
     I              BZBLNB                          WBBLNB
     I              BZBNNB                          WBBNNB
     I              BZS2ST                          WBS2ST
     I              BZS4ST                          WBS4ST
     I              BZS5ST                          WBS5ST
     I              BZS6ST                          WBS6ST
     I              BZS8ST                          WBS8ST
     I              BZS9ST                          WBS9ST
     I              BZTCST                          WBTCST
     I              BZTDST                          WBTDST
     I              BZUVST                          WBUVST
     I              BZUWST                          WBUWST
     I              BZUXST                          WBUXST
     I              BZVSST                          WBVSST
     I              BZAATM                          WBAATM
     I              BZAYNA                          WBAYNA
     I              BZA0NA                          WBA0NA
     I              BZAXDT                          WBAXDT
      *
     I@B1REJ0
      * IC Item Balance Detail    Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          WCAIC3
     I              B1HGCD                          WCHGCD
     I              B1AJCD                          WCAJCD
     I              B1ELDT                          WCELDT
     I              B1ABWG                          WCABWG
     I              B1AGQT                          WCAGQT
     I              B1AHQT                          WCAHQT
     I              B1AIQT                          WCAIQT
     I              B1CTST                          WCCTST
     I              B1ACWG                          WCACWG
     I              B1ARQT                          WCARQT
     I              B1ASQT                          WCASQT
     I              B1ATQT                          WCATQT
     I              B1HDQT                          WCHDQT
     I              B1HEQT                          WCHEQT
     I              B1F6ST                          WCF6ST
     I              B1BMWG                          WCBMWG
     I              B1DSQT                          WCDSQT
     I              B1DTQT                          WCDTQT
     I              B1DUQT                          WCDUQT
     I              B1DHDT                          WCDHDT
     I              B1AGCS                          WCAGCS
     I              B1AECS                          WCAECS
     I              B1IDVA                          WCIDVA
     I              B1K7DT                          WCK7DT
     I              B1RINB                          WCRINB
     I              B1RHNB                          WCRHNB
     I              B1RGNB                          WCRGNB
     I              B1UVST                          WCUVST
     I              B1UWST                          WCUWST
     I              B1UXST                          WCUXST
     I              B1VSST                          WCVSST
     I              B1AATM                          WCAATM
     I              B1AYNA                          WCAYNA
     I              B1A0NA                          WCA0NA
     I              B1AXDT                          WCAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      * Outward parameters
     IPARC        DS                             17
      * KEY : PD Order Detail       Co/Itm/Whs/SchShp-D/NtCnl
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Item Code
     I                                    P   3   60PAHGCD
      * I :  Warehouse Code
     I                                        7   9 PAAJCD
      * I :  Scheduled Ship Date
     I                                    P  10  130PAAODT
      * B :  Order Number
     I                                    P  14  170PAC4NB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Warehouse Code
     I                                        1   3 P1AJCD
      * I :  Company Number
     I                                    P   4   50P1AIC3
      * I :  Item Code
     I                                    P   6   90P1HGCD
      * N :  Production Date
     I                                    P  10  130P1ELDT
      * N :  Text 1 Length USR
     I                                       14  14 P1PFTX
      * N :  @Date - ATR
     I                                    P  15  180P1AADT
      * N :  Warehouse Chill Time
     I                                    P  19  212P1DBNB
      * N :  @CTL Nbr 3.0
     I                                    P  22  230P1QWNB
      * N :  Warehouse Std Chill Time
     I                                       24  24 P1T1ST
      * B :  Calc 5,0              USR
     I                                       25  290P1M168
      * B :  Number 5,0            USR
     I                                       30  340P1M178
     IP2PARM      DS
      * N :  Yes/No Selection      USR
     I                                        1   1 P2BLSX
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AJCD    PARM           WP0001  3        Warehouse Code
     C           P1AIC3    PARM           WP0002  30       Company Number
     C           P1HGCD    PARM           WP0003  70       Item Code
     C           P1M168    PARM P1M168    WP0004  50       Calc 5,0
     C           P1M178    PARM P1M178    WP0005  50       Number 5,0
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * CLC Age Code for CTL   XF
      * RTV Type/Std Chil/Chil RT - Warehouse  * 
     C                     EXSR SARVGN
      * Checking that warehouse chill time is set to no, retrieve if true
      * CASE: PAR.Warehouse Std Chill Time is no
     C           P1T1ST    IFEQ 'N'                        *IF
      * Rtv Chill Time        RT - Company/Item  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C                     Z-ADD##JDT     P1AADT           @Date - ATR
     C                     Z-ADD*ZERO     P1ELDT           Production Date
     C                     MOVEL'Y'       P2BLSX           Yes/No Selectio
      * DO WHILE: PAR.Yes/No Selection      USR is Yes
     C           P2BLSX    DOWEQ'Y'                        *DOW
     C                     MOVEL*BLANK    P1PFTX           Text 1 Length U
      * CASE: PAR.Production Date is not entered
     C           P1ELDT    IFEQ *ZERO                      *IF
      * RTV First ProductionDt RT - IC Item Balance Detail  * 
     C                     EXSR SCRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           P1ELDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1ELDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1ELDT
     C                     END
      * RTV Production Date    RT - IC Item Balance Detail  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * PAR.@CTL Nbr 3.0 = PAR.@Date - ATR - PAR.Production Date *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           P1ELDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           P1AADT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     P1QWNB
     C                     ELSE
     C           XDURR     MULT -1        P1QWNB
     C                     END
      * CASE: PAR.@CTL Nbr 3.0 is *GT 7
     C           P1QWNB    IFGT 7                          *IF
     C                     MOVEL'G'       P1PFTX           Text 1 Length U
     C                     ELSE
      * CASE: *OTHERWISE
      * Warehouse Chill Time is equal to 0
      * CASE: PAR.Warehouse Chill Time is *Zero
     C           P1DBNB    IFEQ *ZERO                      *IF
      * CASE: PAR.@CTL Nbr 3.0 is *Six
     C           P1QWNB    IFEQ 6                          *IF
     C                     MOVEL'G'       P1PFTX           Text 1 Length U
     C                     END                             *FI
     C                     END                             *FI
      * Warehouse Chill Time is equal to 1
      * CASE: PAR.Warehouse Chill Time is *One
     C           P1DBNB    IFEQ 1                          *IF
      * CASE: PAR.@CTL Nbr 3.0 is *Seven
     C           P1QWNB    IFEQ 7                          *IF
     C                     MOVEL'G'       P1PFTX           Text 1 Length U
     C                     END                             *FI
     C                     END                             *FI
      * Warehouse Chill Time is equal to 2
      * CASE: PAR.Warehouse Chill Time is *Two
     C           P1DBNB    IFEQ 2                          *IF
      * CASE: PAR.@CTL Nbr 3.0 is *Six
     C           P1QWNB    IFEQ 6                          *IF
     C                     MOVEL'G'       P1PFTX           Text 1 Length U
     C                     END                             *FI
     C                     END                             *FI
      * Warehouse Chill Time is equal to 3
      * CASE: PAR.Warehouse Chill Time is *Three
     C           P1DBNB    IFEQ 3                          *IF
      * CASE: PAR.@CTL Nbr 3.0 is *Five
     C           P1QWNB    IFEQ 5                          *IF
     C                     MOVEL'G'       P1PFTX           Text 1 Length U
     C                     END                             *FI
     C                     END                             *FI
      * Warehouse Chill Time is equal to 4
      * CASE: PAR.Warehouse Chill Time is *Four
     C           P1DBNB    IFEQ 4                          *IF
      * CASE: PAR.@CTL Nbr 3.0 is *Four
     C           P1QWNB    IFEQ 4                          *IF
     C                     MOVEL'G'       P1PFTX           Text 1 Length U
     C                     END                             *FI
     C                     END                             *FI
      * Warehouse Chill Time is equal to 5
      * CASE: PAR.Warehouse Chill Time is *Five
     C           P1DBNB    IFEQ 5                          *IF
      * CASE: PAR.@CTL Nbr 3.0 is *Three
     C           P1QWNB    IFEQ 3                          *IF
     C                     MOVEL'G'       P1PFTX           Text 1 Length U
     C                     END                             *FI
     C                     END                             *FI
      * Warehouse Chill Time is equal to 6
      * CASE: PAR.Warehouse Chill Time is *Six
     C           P1DBNB    IFEQ 6                          *IF
      * CASE: PAR.@CTL Nbr 3.0 is *Two
     C           P1QWNB    IFEQ 2                          *IF
     C                     MOVEL'G'       P1PFTX           Text 1 Length U
     C                     END                             *FI
     C                     END                             *FI
      * Warehouse Chill Time is equal to 7
      * CASE: PAR.Warehouse Chill Time is *Seven
     C           P1DBNB    IFEQ 7                          *IF
      * CASE: PAR.@CTL Nbr 3.0 is 1 Times
     C           P1QWNB    IFEQ 1                          *IF
     C                     MOVEL'G'       P1PFTX           Text 1 Length U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Text 1 Length USR is *Blank
     C           P1PFTX    IFEQ *BLANK                     *IF
      * RTV Open Orders f/CTL  XF - PD Order Detail  * 
     C                     CLEARPARC
     C                     Z-ADDP1AIC3    PAAIC3           Company Number
     C                     Z-ADDP1HGCD    PAHGCD           Item Code
     C                     MOVELP1AJCD    PAAJCD           Warehouse Code
     C                     Z-ADDP1ELDT    PAAODT           Scheduled Ship
     C                     Z-ADDWUC4NB    PAC4NB           Order Number
      *
     C                     CALL 'PDLKXFR'              90  RTV Open Orders
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: PD Order D
     C           WUM168    PARM WUM168    WQ0001 112       Quantity Schedu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     Z-ADDPAC4NB    WUC4NB           Order Number
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ADD  WUM168    P1M168           Calc 5,0
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Open Orders f/CTL  XF - PD Order Detail  * 
     C                     CLEARPARC
     C                     Z-ADDP1AIC3    PAAIC3           Company Number
     C                     Z-ADDP1HGCD    PAHGCD           Item Code
     C                     MOVELP1AJCD    PAAJCD           Warehouse Code
     C                     Z-ADDP1ELDT    PAAODT           Scheduled Ship
     C                     Z-ADDWUC4NB    PAC4NB           Order Number
      *
     C                     CALL 'PDLKXFR'              90  RTV Open Orders
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: PD Order D
     C           WUM178    PARM WUM178    WQ0002 112       Quantity Schedu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     Z-ADDPAC4NB    WUC4NB           Order Number
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ADD  WUM178    P1M178           Number 5,0
     C                     END                             *FI
     C                     END                             *ITR
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Type/Std Chil/Chil RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVELP1AJCD    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSA     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Warehouse Type
     C                     MOVEL*BLANK    P1T1ST           Warehouse Std C
     C                     Z-ADD*ZERO     P1DBNB           Warehouse Chill
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAWPST    WUG0TX           Warehouse Type
     C                     MOVELWAT1ST    P1T1ST           Warehouse Std C
     C                     Z-ADDWADBNB    P1DBNB           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Chill Time        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP1HGCD    WBHGCD           Item Code
      * Establish starting position
     C           KRSSB     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P1DBNB           Fresh Chilling
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBCHTM    P1DBNB           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV First ProductionDt RT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCHGCD    WQSC02           Item Code
     C           *LIKE     DEFN WCAJCD    WQSC03           Warehouse Code
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Item Code
     C                     KFLD           WQSC03           Warehouse Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSC01           Company Number
     C                     Z-ADDP1HGCD    WQSC02           Item Code
     C                     MOVELP1AJCD    WQSC03           Warehouse Code
      * Establish starting position
     C           KRSSC     SETLL@B1REJ0                    *
     C           KRSSC     READE@B1REJ0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       P2BLSX           Yes/No Selectio
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCELDT    P1ELDT           Production Date
     C                     MOVEL'Y'       P2BLSX           Yes/No Selectio
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@B1REJ0                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Production Date    RT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WCHGCD    WQSD02           Item Code
     C           *LIKE     DEFN WCAJCD    WQSD03           Warehouse Code
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Item Code
     C                     KFLD           WQSD03           Warehouse Code
     C                     KFLD           WCELDT           Production Date
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Item Code
     C                     KFLD           WQSD03           Warehouse Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSD01           Company Number
     C                     Z-ADDP1HGCD    WQSD02           Item Code
     C                     MOVELP1AJCD    WQSD03           Warehouse Code
     C                     Z-ADDP1ELDT    WCELDT           Production Date
      * Establish starting position
     C           KPSSD     SETLL@B1REJ0                    *
     C           KRSSD     READE@B1REJ0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       P2BLSX           Yes/No Selectio
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWCELDT    P1ELDT           Production Date
     C                     MOVEL'Y'       P2BLSX           Yes/No Selectio
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@B1REJ0                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109268
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1ELDT           Production Date
     C                     MOVEL*BLANK    P1PFTX           Text 1 Length U
     C                     Z-ADD*ZERO     P1AADT           @Date - ATR
     C                     Z-ADD*ZERO     P1DBNB           Warehouse Chill
     C                     Z-ADD*ZERO     P1QWNB           @CTL Nbr 3.0
     C                     MOVEL*BLANK    P1T1ST           Warehouse Std C
     C                     MOVEL*BLANK    P2BLSX           Yes/No Selectio
      *
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WADBNB  52       Warehouse Chill
     C                     Z-ADD*ZERO     WAAATM  60       Job Time
     C                     Z-ADD*ZERO     WAAXDT  70       Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3  30       Company Number
     C                     Z-ADD*ZERO     WBHGCD  70       Item Code
     C                     Z-ADD*ZERO     WBAWPC  94       Conversion Fact
     C                     Z-ADD*ZERO     WBAXPC  94       Conversion Fact
     C                     Z-ADD*ZERO     WBAIWG 112       Unit Weight
     C                     Z-ADD*ZERO     WBCZWG 112       Minimum Weight
     C                     Z-ADD*ZERO     WBC0WG 112       Maximum Weight
     C                     Z-ADD*ZERO     WBURTN  50       Number Cases On
     C                     Z-ADD*ZERO     WBAJC8  80       Vendor - Item D
     C                     Z-ADD*ZERO     WBRINB  30       Item Structure
     C                     Z-ADD*ZERO     WBRHNB  30       Item Structure
     C                     Z-ADD*ZERO     WBRGNB  30       Item Structure
     C                     Z-ADD*ZERO     WBTFNB  30       Transportation
     C                     Z-ADD*ZERO     WBTMVA 112       Maximum Audit V
     C                     Z-ADD*ZERO     WBTNVA 112       Minimum Audit V
     C                     Z-ADD*ZERO     WBBLPR 114       Market Overage
     C                     Z-ADD*ZERO     WBBMPR 114       Standard Overag
     C                     Z-ADD*ZERO     WBCMCO 114       Item Pricing Co
     C                     Z-ADD*ZERO     WBCHTM  52       Fresh Chilling
     C                     Z-ADD*ZERO     WBSWGH 112       Std Weight/Head
     C                     Z-ADD*ZERO     WBPPHE  70       Pieces Per Head
     C                     Z-ADD*ZERO     WBICN1  20       Item Category N
     C                     Z-ADD*ZERO     WBICN2  20       Item Category N
     C                     Z-ADD*ZERO     WBV2NB  20       Item Category N
     C                     Z-ADD*ZERO     WBITCN  20       Item Category N
     C                     Z-ADD*ZERO     WBITC5  20       Item Category N
     C                     Z-ADD*ZERO     WBICN6  20       Item Category N
     C                     Z-ADD*ZERO     WBICN7  20       Item Category N
     C                     Z-ADD*ZERO     WBICN8  20       Item Category N
     C                     Z-ADD*ZERO     WBICN9  20       Item Category N
     C                     Z-ADD*ZERO     WBICN0  20       Iten Category N
     C                     Z-ADD*ZERO     WBSFNB  52       UnUsed NBR 5.2
     C                     Z-ADD*ZERO     WBA3WG  52       Misc Tare Weigh
     C                     Z-ADD*ZERO     WBSJNB  30       Packages (Trays
     C                     Z-ADD*ZERO     WBSKNB  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB  20       Agrimetrics gra
     C                     Z-ADD*ZERO     WBCFNB 114       PM Pounds per H
     C                     Z-ADD*ZERO     WBCGNB  74       PM Line Time Ef
     C                     Z-ADD*ZERO     WBILNB  74       PM % 2nds Facto
     C                     Z-ADD*ZERO     WBCHNB  30       PM Crew Size
     C                     Z-ADD*ZERO     WBCINB 114       PM Batch Size
     C                     Z-ADD*ZERO     WBCJNB 114       PM Lot Size
     C                     Z-ADD*ZERO     WBCMNB  70       PM BOM Spec Dat
     C                     Z-ADD*ZERO     WBCNNB  70       PM Seaboard Spe
     C                     Z-ADD*ZERO     WBCRNB  70       PM Seaboard Rep
     C                     Z-ADD*ZERO     WBCSNB  92       PM Raw Yield
     C                     Z-ADD*ZERO     WBCVNB  92       PM Formula Yiel
     C                     Z-ADD*ZERO     WBCWNB 114       PM Standard LBS
     C                     Z-ADD*ZERO     WBCXNB 114       PM Raw Meat LBS
     C                     Z-ADD*ZERO     WBCZNB 114       PM Formula LBS/
     C                     Z-ADD*ZERO     WBC0NB 114       PM Finished LBS
     C                     Z-ADD*ZERO     WBB4NB  30       PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB  50       PM Line Number
     C                     Z-ADD*ZERO     WBBDNB  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WBBJNB  70       Bags Per Unit
     C                     Z-ADD*ZERO     WBF5WG 112       CI Unused Wgt 1
     C                     Z-ADD*ZERO     WBF6WG 112       CI Unused Wgt 2
     C                     Z-ADD*ZERO     WBF7WG 112       CI Unused Wgt 3
     C                     Z-ADD*ZERO     WBBLNB  70       CI Unused Nbr 1
     C                     Z-ADD*ZERO     WBBNNB  70       CI Unused Nbr 2
     C                     Z-ADD*ZERO     WBAATM  60       Job Time
     C                     Z-ADD*ZERO     WBAXDT  70       Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3  30       Company Number
     C                     Z-ADD*ZERO     WCHGCD  70       Item Code
     C                     Z-ADD*ZERO     WCELDT  70       Production Date
     C                     Z-ADD*ZERO     WCABWG 112       Physical Count
     C                     Z-ADD*ZERO     WCAGQT 112       Physical Count
     C                     Z-ADD*ZERO     WCAHQT 112       Physical Count
     C                     Z-ADD*ZERO     WCAIQT 112       Physical Count
     C                     Z-ADD*ZERO     WCACWG 112       Quantity on Han
     C                     Z-ADD*ZERO     WCARQT 112       Quantity on Han
     C                     Z-ADD*ZERO     WCASQT 112       Quantity on Han
     C                     Z-ADD*ZERO     WCATQT 112       Quantity on Han
     C                     Z-ADD*ZERO     WCHDQT 112       Quantity In Chi
     C                     Z-ADD*ZERO     WCHEQT 112       Weight In Chill
     C                     Z-ADD*ZERO     WCBMWG 112       Physical Start
     C                     Z-ADD*ZERO     WCDSQT 112       Physical Start
     C                     Z-ADD*ZERO     WCDTQT 112       Physical Start
     C                     Z-ADD*ZERO     WCDUQT 112       Physical Start
     C                     Z-ADD*ZERO     WCDHDT  70       Physical Start
     C                     Z-ADD*ZERO     WCAGCS 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WCAECS 114       Last Cost
     C                     Z-ADD*ZERO     WCIDVA 112       Value of On Han
     C                     Z-ADD*ZERO     WCK7DT  70       Label Date
     C                     Z-ADD*ZERO     WCRINB  30       Item Structure
     C                     Z-ADD*ZERO     WCRHNB  30       Item Structure
     C                     Z-ADD*ZERO     WCRGNB  30       Item Structure
     C                     Z-ADD*ZERO     WCAATM  60       Job Time
     C                     Z-ADD*ZERO     WCAXDT  70       Job Date
      * Define work field Order Number
     C                     Z-ADD*ZERO     WUC4NB  70
      * Define work field Calc 5,0              USR
     C                     Z-ADD*ZERO     WUM168  50
      * Define work field Number 5,0            USR
     C                     Z-ADD*ZERO     WUM178  50
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
