     H/TITLE WW Manifest Detail-HPB EF Edit file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain database file using subfile display
     H* - Existing records may be updated or deleted
     H* - Key changes are not allowed
     H* - New records cannot be added
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Edit file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 04/21/20  Time  : 13:35:38
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPNM9EFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Manifest Detail-HPB EF Edit file
      *
     FOMFNCPL2IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Manifest Detail           RSQ for Order Confirm
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFNCPL1IF  E           K        DISK
      * RTV : Manifest Detail           Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPNGJREL1IF  E           K        DISK
      * RTV : RFS API Volume Corr Table Retrieval index
      *
     FPNFPCPL1IF  E           K        DISK
      * RTV : Manifest Detail RIN Sell  Retrieval index
      *
     FPMDACPL1IF  E           K        DISK
      * RTV : COA Batch Header RIN      Retrieval index
      *
     FCABZRELDIF  E           K        DISK
      * RTV : Company Item              Active Items Only
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMFNCPL0UF  E           K        DISK
      * UPD : Manifest Detail           Update index
      *
     FPNFPCPL0UF  E           K        DISK
      * UPD : Manifest Detail RIN Sell  Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPMAMREL0UF  E           K        DISK                      A
      * UPD : Order Header Extension    Update index
      *
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@FNCPCT
      * Manifest Detail           Retrieval index
      * Renamed input format fields
     I              FNAIC3                          WAAIC3
     I              FNC4NB                          WAC4NB
     I              FNDPNB                          WADPNB
     I              FNUENB                          WAUENB
     I              FNRZNB                          WARZNB
     I              FNFOQT                          WAFOQT
     I              FNR0NB                          WAR0NB
     I              FNPMST                          WAPMST
     I              FNK7DT                          WAK7DT
     I              FNPFNX                          WAPFNX
     I              FNHGCD                          WAHGCD
     I              FNAJCD                          WAAJCD
     I              FNELDT                          WAELDT
     I              FNN5WG                          WAN5WG
     I              FNRZNA                          WARZNA
     I              FNH5NY                          WAH5NY
     I              FNH6NY                          WAH6NY
     I              FNH7NY                          WAH7NY
     I              FNGBTX                          WAGBTX
     I              FNN6WG                          WAN6WG
     I              FNN7WG                          WAN7WG
     I              FNGCTX                          WAGCTX
     I              FNGDTX                          WAGDTX
     I              FNRBDT                          WARBDT
     I              FNITNY                          WAITNY
     I              FNIVNY                          WAIVNY
     I              FNIUNY                          WAIUNY
     I              FNIWNY                          WAIWNY
     I              FNIXNY                          WAIXNY
     I              FNIYNY                          WAIYNY
     I              FNUVST                          WAUVST
     I              FNUWST                          WAUWST
     I              FNUXST                          WAUXST
     I              FNVSST                          WAVSST
     I              FNAATM                          WAAATM
     I              FNAYNA                          WAAYNA
     I              FNA0NA                          WAA0NA
     I              FNAXDT                          WAAXDT
      *
     I@FPCPDO
      * Manifest Detail RIN Sell  Update index
      * Renamed input format fields
     I              FPAIC3                          WBAIC3
     I              FPC4NB                          WBC4NB
     I              FPDPNB                          WBDPNB
     I              FPUENB                          WBUENB
     I              FPRZNB                          WBRZNB
     I              FPL6T1                          WBL6T1
     I              FPI3NY                          WBI3NY
     I              FPJYNY                          WBJYNY
     I              FPQ1NY                          WBQ1NY
     I              FPN6WG                          WBN6WG
     I              FPRCNY                          WBRCNY
     I              FPHJST                          WBHJST
     I              FPVSST                          WBVSST
     I              FPMJDT                          WBMJDT
     I              FPBETM                          WBBETM
     I              FPCCVN                          WBCCVN
     I              FPCDVN                          WBCDVN
     I              FPMKDT                          WBMKDT
     I              FPBFTM                          WBBFTM
     I              FPCEVN                          WBCEVN
     I              FPCFVN                          WBCFVN
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WDAIC3
     I              AMC4NB                          WDC4NB
     I              AMRMNB                          WDRMNB
     I              AMRUNB                          WDRUNB
     I              AMXACD                          WDXACD
     I              AMOANA                          WDOANA
     I              AMHBAA                          WDHBAA
     I              AMJ0T1                          WDJ0T1
     I              AMGENY                          WDGENY
     I              AMJ1T1                          WDJ1T1
     I              AMHCAA                          WDHCAA
     I              AMQWDT                          WDQWDT
     I              AMQXDT                          WDQXDT
     I              AMQYDT                          WDQYDT
     I              AMHDAA                          WDHDAA
     I              AMCCTX                          WDCCTX
     I              AMJ2T1                          WDJ2T1
     I              AMRLNA                          WDRLNA
     I              AMRMNA                          WDRMNA
     I              AMGINY                          WDGINY
     I              AMGFNY                          WDGFNY
     I              AMGGNY                          WDGGNY
     I              AMGHNY                          WDGHNY
     I              AMHEVL                          WDHEVL
     I              AMHFVL                          WDHFVL
     I              AMHGVL                          WDHGVL
     I              AMQZDT                          WDQZDT
     I              AMQ0DT                          WDQ0DT
     I              AMQ1DT                          WDQ1DT
     I              AMQ2DT                          WDQ2DT
     I              AMC2TX                          WDC2TX
     I              AMC3TX                          WDC3TX
     I              AMC6TX                          WDC6TX
     I              AMCHTX                          WDCHTX
     I              AMCITX                          WDCITX
     I              AMCLTX                          WDCLTX
     I              AMB4TX                          WDB4TX
     I              AMCUTX                          WDCUTX
     I              AMCVTX                          WDCVTX
     I              AMB9TX                          WDB9TX
     I              AMJWSC                          WDJWSC
     I              AMITNY                          WDITNY
     I              AMLMT1                          WDLMT1
     I              AMLWAA                          WDLWAA
     I              AMFVST                          WDFVST
     I              AMF0ST                          WDF0ST
     I              AMF2ST                          WDF2ST
     I              AMF3ST                          WDF3ST
     I              AMJUSC                          WDJUSC
     I              AMJVSC                          WDJVSC
     I              AMV3T1                          WDV3T1
     I              AMV4T1                          WDV4T1
     I              AMV5T1                          WDV5T1
     I              AMV6T1                          WDV6T1
     I              AMV7T1                          WDV7T1
     I              AMV8T1                          WDV8T1
     I              AMV9T1                          WDV9T1
     I              AMWAT1                          WDWAT1
     I              AMWBT1                          WDWBT1
     I              AMWCT1                          WDWCT1
     I              AMWDT1                          WDWDT1
     I              AMQJNY                          WDQJNY
     I              AMQKNY                          WDQKNY
     I              AMQLNY                          WDQLNY
     I              AMP8NY                          WDP8NY
     I              AMP9NY                          WDP9NY
     I              AMQANY                          WDQANY
     I              AMQCNY                          WDQCNY
     I              AMQDNY                          WDQDNY
     I              AMQENY                          WDQENY
     I              AMQFNY                          WDQFNY
     I              AMQGNY                          WDQGNY
     I              AMQHNY                          WDQHNY
     I              AMQINY                          WDQINY
     I              AMQMNY                          WDQMNY
     I              AMMYU1                          WDMYU1
     I              AMJXSC                          WDJXSC
     I              AMJYSC                          WDJYSC
     I              AMJZSC                          WDJZSC
     I              AMJ0SC                          WDJ0SC
     I              AMMZU1                          WDMZU1
     I              AMM0U1                          WDM0U1
     I              AMM1U1                          WDM1U1
     I              AMM2U1                          WDM2U1
     I              AMM3U1                          WDM3U1
     I              AMW5DT                          WDW5DT
     I              AMW6DT                          WDW6DT
     I              AMUVST                          WDUVST
     I              AMUWST                          WDUWST
     I              AMUXST                          WDUXST
     I              AMVSST                          WDVSST
     I              AMAATM                          WDAATM
     I              AMAYNA                          WDAYNA
     I              AMA0NA                          WDA0NA
     I              AMAXDT                          WDAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSOMFNCPL0
      * UPD : Manifest Detail           Update index
      * Current/previous master file format fields for change control
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPNFP1    E DSPNFPCPL0
      * UPD : Manifest Detail RIN Sell  Update index
      * Renamed input format fields
     I              FPAIC3                          WBAIC3
     I              FPC4NB                          WBC4NB
     I              FPDPNB                          WBDPNB
     I              FPUENB                          WBUENB
     I              FPRZNB                          WBRZNB
     I              FPL6T1                          WBL6T1
     I              FPI3NY                          WBI3NY
     I              FPJYNY                          WBJYNY
     I              FPQ1NY                          WBQ1NY
     I              FPN6WG                          WBN6WG
     I              FPRCNY                          WBRCNY
     I              FPHJST                          WBHJST
     I              FPVSST                          WBVSST
     I              FPMJDT                          WBMJDT
     I              FPBETM                          WBBETM
     I              FPCCVN                          WBCCVN
     I              FPCDVN                          WBCDVN
     I              FPMKDT                          WBMKDT
     I              FPBFTM                          WBBFTM
     I              FPCEVN                          WBCEVN
     I              FPCFVN                          WBCFVN
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     IYARDCS      DS                            525
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WDAIC3
     I              AMC4NB                          WDC4NB
     I              AMRMNB                          WDRMNB
     I              AMRUNB                          WDRUNB
     I              AMXACD                          WDXACD
     I              AMOANA                          WDOANA
     I              AMHBAA                          WDHBAA
     I              AMJ0T1                          WDJ0T1
     I              AMGENY                          WDGENY
     I              AMJ1T1                          WDJ1T1
     I              AMHCAA                          WDHCAA
     I              AMQWDT                          WDQWDT
     I              AMQXDT                          WDQXDT
     I              AMQYDT                          WDQYDT
     I              AMHDAA                          WDHDAA
     I              AMCCTX                          WDCCTX
     I              AMJ2T1                          WDJ2T1
     I              AMRLNA                          WDRLNA
     I              AMRMNA                          WDRMNA
     I              AMGINY                          WDGINY
     I              AMGFNY                          WDGFNY
     I              AMGGNY                          WDGGNY
     I              AMGHNY                          WDGHNY
     I              AMHEVL                          WDHEVL
     I              AMHFVL                          WDHFVL
     I              AMHGVL                          WDHGVL
     I              AMQZDT                          WDQZDT
     I              AMQ0DT                          WDQ0DT
     I              AMQ1DT                          WDQ1DT
     I              AMQ2DT                          WDQ2DT
     I              AMC2TX                          WDC2TX
     I              AMC3TX                          WDC3TX
     I              AMC6TX                          WDC6TX
     I              AMCHTX                          WDCHTX
     I              AMCITX                          WDCITX
     I              AMCLTX                          WDCLTX
     I              AMB4TX                          WDB4TX
     I              AMCUTX                          WDCUTX
     I              AMCVTX                          WDCVTX
     I              AMB9TX                          WDB9TX
     I              AMJWSC                          WDJWSC
     I              AMITNY                          WDITNY
     I              AMLMT1                          WDLMT1
     I              AMLWAA                          WDLWAA
     I              AMFVST                          WDFVST
     I              AMF0ST                          WDF0ST
     I              AMF2ST                          WDF2ST
     I              AMF3ST                          WDF3ST
     I              AMJUSC                          WDJUSC
     I              AMJVSC                          WDJVSC
     I              AMV3T1                          WDV3T1
     I              AMV4T1                          WDV4T1
     I              AMV5T1                          WDV5T1
     I              AMV6T1                          WDV6T1
     I              AMV7T1                          WDV7T1
     I              AMV8T1                          WDV8T1
     I              AMV9T1                          WDV9T1
     I              AMWAT1                          WDWAT1
     I              AMWBT1                          WDWBT1
     I              AMWCT1                          WDWCT1
     I              AMWDT1                          WDWDT1
     I              AMQJNY                          WDQJNY
     I              AMQKNY                          WDQKNY
     I              AMQLNY                          WDQLNY
     I              AMP8NY                          WDP8NY
     I              AMP9NY                          WDP9NY
     I              AMQANY                          WDQANY
     I              AMQCNY                          WDQCNY
     I              AMQDNY                          WDQDNY
     I              AMQENY                          WDQENY
     I              AMQFNY                          WDQFNY
     I              AMQGNY                          WDQGNY
     I              AMQHNY                          WDQHNY
     I              AMQINY                          WDQINY
     I              AMQMNY                          WDQMNY
     I              AMMYU1                          WDMYU1
     I              AMJXSC                          WDJXSC
     I              AMJYSC                          WDJYSC
     I              AMJZSC                          WDJZSC
     I              AMJ0SC                          WDJ0SC
     I              AMMZU1                          WDMZU1
     I              AMM0U1                          WDM0U1
     I              AMM1U1                          WDM1U1
     I              AMM2U1                          WDM2U1
     I              AMM3U1                          WDM3U1
     I              AMW5DT                          WDW5DT
     I              AMW6DT                          WDW6DT
     I              AMUVST                          WDUVST
     I              AMUWST                          WDUWST
     I              AMUXST                          WDUXST
     I              AMVSST                          WDVSST
     I              AMAATM                          WDAATM
     I              AMAYNA                          WDAYNA
     I              AMA0NA                          WDA0NA
     I              AMAXDT                          WDAXDT
      *
     IYBRDCS      DS                            894
     IYCRDCS      DS                            159
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Manifest Detail
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * I : RST Order Sequence Number
     I                                    P   7   80P1DPNB
      * I : RST Order Secondary Line Seq
     I                                    P   9  100P1UENB
      * N :  Case Sequence Number
     I                                    P  11  130P1RZNB
      * I : MAP Item Code
     I                                    P  14  170P1HGCD
      * I : MAP Warehouse Code
     I                                       18  20 P1AJCD
     IP2PARM      DS
      * FLD: Order Detail
      * N : MAP U/M - Ordered
     I                                        1   2 P2AGCD
      * I : MAP Order Desc. Line One
     I                                        3  32 P2G7NA
      * N :  Catch Weight Status
     I                                       33  33 P2AVST
      * N :  Production Date Control
     I                                       34  34 P2FZST
      * I : MAP Quantity Scheduled
     I                                    P  35  402P2CCQT
      * I : MAP Weight Scheduled
     I                                    P  41  462P2AUWG
      * N :  Unit Weight Ordered U/M
     I                                    P  47  522P2AVWG
     IP3PARM      DS
      * FLD: *Arrays
      * B :  USR Case Quantity
     I                                    P   1   30P3FYQT
      * B :  USR Case Weight
     I                                    P   4   92P3ZPNB
      * N :  USR Update Flag
     I                                       10  10 P3R4ST
      * N :  USR Display field
     I                                       11  11 P3GGST
      * N :  USR Display 1
     I                                       12  12 P3TIST
      * N :  USR Min Weight
     I                                    P  13  160P3MNWT
      * N :  USR Max Weight
     I                                    P  17  200P3MXWT
      * N :  USR Under Min
     I                                       21  21 P3GQST
      * N :  USR Over Max
     I                                       22  22 P3GSST
      * N :  USR Display 2
     I                                       23  23 P3TJST
      * I :  Carrier Broker
     I                                       24  26 P3XCCD
      * B :  COA Temperature Loadout
     I                                    P  27  280P3JENY
     IP4PARM      DS
      * FLD: *Arrays
      * N :  Application Code
     I                                        1   6 P4DNCD
      * N :  Salesperson Code
     I                                        7   9 P4BCCD
      * N :  System Date Format
     I                                       10  12 P4B8NA
      * N :  Allow Multi-Company
     I                                       13  13 P4I6ST
      * N :  Default Printer
     I                                       14  23 P4MPNA
     IP5PARM      DS
      * FLD: Company Item
      * N :  Unit Weight
     I                                    P   1   62P5AIWG
      * N :  Minimum Weight Per Case
     I                                    P   7  122P5CZWG
      * N :  Maximum Weight Per Case
     I                                    P  13  182P5C0WG
     IP6PARM      DS
      * N :  USR Exit Program
     I                                        1   1 P6STYN
     IP7PARM      DS
      * FLD: Order Header TRG
      * I :  Ship To Customer
     I                                    P   1   40P7BKC7
      * I :  Ship To Name
     I                                        5  34 P7BRTX
      * I :  Customer Purchase Order #
     I                                       35  49 P7BCNA
      * I :  Load ID
     I                                    P  50  530P7RMNB
     IP8PARM      DS
      * N :  COA RIN Modified Sts
     I                                        1   1 P8RINS
     IP9PARM      DS
      * N :  Status Flag 1  Y/N
     I                                        1   1 P9Q1ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Qty & Wgt must be 0'
      * USR Case Quantity
     I                                    P   1   30ZA0001
      * USR Case Weight
     I                                    P   4   92ZA0002
      * Message data for 'Quantity and Weight Rqd'
      * Case Quantity
     I                                    P   1   30ZA0003
      * Case Weight
     I                                    P   4   92ZA0004
      * Message data for 'Meter Start must be<end'
      * HPB Meter Start Gallon
     I                                    P   1   50ZA0005
      * HPB Meter Ending Gallon
     I                                    P   6  100ZA0006
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0007
      * Application Code
     I                                       11  16 ZA0008
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0009
      * Application Code
     I                                       11  16 ZA0010
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1DPNB    PARM           WP0003  30       Order Sequence
     C           P1UENB    PARM           WP0004  30       Order Secondary
     C           P1HGCD    PARM           WP0005  70       Item Code
     C           P1AJCD    PARM           WP0006  3        Warehouse Code
     C           P2G7NA    PARM           WP0007 30        Order Desc. Lin
     C           P2CCQT    PARM           WP0008 112       Quantity Schedu
     C           P2AUWG    PARM           WP0009 112       Weight Schedule
     C           P3FYQT    PARM P3FYQT    WP0010  50       USR Case Quanti
     C           P3ZPNB    PARM P3ZPNB    WP0011 112       USR Case Weight
     C           P3XCCD    PARM           WP0012  3        Carrier Broker
     C           P3JENY    PARM P3JENY    WP0013  30       COA Temperature
     C           P7BKC7    PARM           WP0014  70       Ship To Custome
     C           P7BRTX    PARM           WP0015 30        Ship To Name
     C           P7BCNA    PARM           WP0016 15        Customer Purcha
     C           P7RMNB    PARM           WP0017  70       Load ID
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise and load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END
     C                     END
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise & load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile header
      * CASE: CTL.COA Temperature Loadout is Not Entered
     C           #CJENY    IFEQ *ZERO                      *IF
     C                     Z-ADDP3JENY    #CJENY           COA Temperature
     C                     END                             *FI
     C                     MOVELP7BCNA    #CBCNA           Customer Purcha
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SARVGN
     C                     Z-ADDP2CCQT    #PCCQT           Quantity Schedu
     C                     Z-ADDP2AUWG    #PAUWG           Weight Schedule
      * RTV Manifest detail    RT - Order Detail  * 
     C                     EXSR SBRVGN
     C                     Z-ADD#PCCQT    #CIRQT           Quantity Ordere
      * RTV for Ord.Detail     XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDC3XFR'              90  RTV for Ord.Det
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0001  30       Company Number
     C                     PARM #PHGCD    WQ0002  70       Item Code
     C           #CJ2NA    PARM *BLANK    WQ0003 30        Description Lin
     C           WUAWNA    PARM *BLANK    WQ0004 30        Description Lin
     C           WUADCD    PARM *BLANK    WQ0005  2        U/M - Primary
     C           WUAICD    PARM *BLANK    WQ0006  2        U/M - Pricing
     C           P5AIWG    PARM *ZERO     WQ0007 112       Unit Weight
     C           WURBCD    PARM *BLANK    WQ0008  2        Item Level
     C           WUG0TX    PARM *BLANK    WQ0009  1        Production Date
     C           P2AVST    PARM *BLANK    WQ0010  1        Catch Weight St
     C           WURINB    PARM *ZERO     WQ0011  30       Item Structure
     C           WURHNB    PARM *ZERO     WQ0012  30       Item Structure
     C           WURGNB    PARM *ZERO     WQ0013  30       Item Structure
     C           WULNCD    PARM *BLANK    WQ0014  3        Default Commod
     C           WUTFNB    PARM *ZERO     WQ0015  30       Transportation
     C           WUN0CD    PARM *BLANK    WQ0016  3        Item Type Code
     C           WULRCD    PARM *BLANK    WQ0017  7        Commodity Price
     C           WUQ1CD    PARM *BLANK    WQ0018  3        Default Warehou
     C           WUQ8CD    PARM *BLANK    WQ0019  3        Price Method De
     C           #CCHMT    PARM *ZERO     WQ0020  52       Fresh Chilling
     C           WUXWST    PARM *BLANK    WQ0021  1        Variety/Rendere
     C           WUF5WG    PARM *ZERO     WQ0022 112       Item Target Pri
     C           WUECST    PARM *BLANK    WQ0023  1        Error Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDC3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If CW sts not found for item, use what's on order
      * CASE: PAR.Catch Weight Status EQ WRK.BLANK
     C           P2AVST    IFEQ WUGSTX                     *IF
     C                     MOVELWUAVST    P2AVST           Catch Weight St
     C                     END                             *FI
     C                     Z-ADD*ZERO     WURZNB           Case Sequence N
      * RTV Next Key           RT - Manifest Detail  * 
     C                     EXSR SCRVGN
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     Z-ADDP7BKC7    #CBKC7           Ship To Custome
     C                     MOVELP7BRTX    #CBRTX           Ship To Name
      * FP1110 HPB modifications - RMC 11/07/7
      * Rtv HPB fields        RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#PAJCD    WL0001    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0001    P      Production Ware
     C                     MOVELWL0003    YL0002    P      Warehouse Locat
     C                     MOVELWL0004    #CRTSX    P      WHS Req Meter R
      * FP1322 chk for an open tank per prod whse on the order's whse
      * Rtv Acct Co          RT - Warehouse  * 
     C                     EXSR SERVGN
      * E2079 Display Gross Ordered Qty so they can compare to gross ship
     C                     Z-ADD*ZERO     #CFVQT           USR Quantity Ac
      * RTV HPB Gross Gall    RT - Manifest Detail  * 
     C                     EXSR SFRVGN
      * CASE: CTL.COA Temperature Loadout is GT 0
     C           #CJENY    IFGT *ZERO                      *IF
     C                     Z-ADD#CJENY    YL0004           COA Temperature
     C                     Z-ADD#CJENY    YL0005           RFS Loadout Tem
      * Rtv API Vol Cor Fctor RT - RFS API Volume Corr Table  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD30        WL0005           RFS API Gravity
     C                     Z-ADDYL0005    WL0006           RFS Loadout Tem
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    YL0006           RFS API Vol Cor
     C                     Z-ADDYL0006    WUJSNY           HPB Temperature
      * Compute: ctl.gross galls
      * CTL.Gross Gallons        USR =
      *    *COMPUTE (x1/ x2)
      * x1    : CTL.Quantity Ordered 1 USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : WRK.HPB Temperature Adjustmnt
     C           #CIRQT    DIV  WUJSNY    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    #CQQQT           Gross Gallons
     C                     END                             *FI
     C                     END
      *................................................................
      * Position file
     C           KPOS      KLIST
     C                     KFLD           FNAIC3           Company Number
     C                     KFLD           FNC4NB           Order Number
     C                     KFLD           FNDPNB           Order Sequence
     C                     KFLD           FNUENB           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    FNAIC3
     C                     Z-ADD#2C4NB    FNC4NB
     C                     Z-ADD#2DPNB    FNDPNB
     C                     Z-ADD#2UENB    FNUENB
      * 82=EOF
     C           KPOS      SETLL@FNCPE5              82    *
      * 82=EOF
     C           KRST      KLIST
     C                     KFLD           FNAIC3           Company Number
     C                     KFLD           FNC4NB           Order Number
     C                     KFLD           FNDPNB           Order Sequence
     C                     KFLD           FNUENB           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    FNAIC3
     C                     Z-ADD#2C4NB    FNC4NB
     C                     Z-ADD#2DPNB    FNDPNB
     C                     Z-ADD#2UENB    FNUENB
     C  N82      KRST      READE@FNCPE5                9182*
      * Load subfile page
     C                     EXSR BBLDSF
      *................................................................
      * If no records found, display error message
     C   82      ##RR      IFEQ *ZERO                      IF
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
     C                     SETOF                     84    No SFLNXTCHG
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@FNCPE5                  90*
     C  N82                READ @FNCPE5                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVE *ALL'0'   WKIND0  1
     C                     MOVE *ALL'1'   WKIND1  1
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
     C                     Z-ADD*ZERO     ##RROK  50
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next subfile page
     C  N82      ##RROK    DOWLT##SFLN                     DO
     C                     ADD  1         ##RR
     C                     MOVEAWKIND0    *IN,32
     C                     SETOF                     87    *
      * Clear subfile fields
     C                     EXSR MAIZ#1
      * Load SFL fields
     C                     EXSR MBFL#1
      * Record will be selected unless overridden
     C                     MOVEL'Y'       W0RSL   1
      * USER: Initialize subfile record (existing record)
     C                     Z-ADDFNRZNB    WURZNB           Case Sequence N
     C                     Z-ADDWURZNB    #1RZNB           Case Sequence N
      * FP1110
     C                     Z-ADDFNIVNY    #1IVNY           HPB Meter Start
     C                     Z-ADDFNIUNY    #1IUNY           HPB Meter Endin
     C                     Z-ADDFNIWNY    #1IWNY           HPB Meter Total
      * FP1322
      * * Dont show rin any more
      * RTV RIN Sold          RT - Manifest Detail RIN Sell  * 
     C                     EXSR SHRVGN
      * If record dropped...
     C                     SUB  1         ##RR
     C           W0RSL     CABNE'Y'       BB020
     C                     ADD  1         ##RR
      * Validate subfile record and calculate derived fields
     C                     EXSR DFV2RC
      * Output to subfile
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * 82=EOF
     C           KRST      READE@FNCPE5                  82*
     C  N82                END
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile control
      * CASE: CTL.*CMD key is CF06
     C           *IN06     IFEQ '1'                        *IF
      * Dsp Sel RIN for shipmnDF - COA Batch Header RIN  * 
     C                     CALL 'PNOKDFR'              90  Dsp Sel RIN for
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0024  30       Company Number
     C                     PARM #PAJCD    WQ0025  3        COA Ship To War
     C                     PARM #2C4NB    WQ0026  70       Order Number
     C                     PARM #2DPNB    WQ0027  30       Order Sequence
     C                     PARM #2UENB    WQ0028  30       Order Secondary
     C                     PARM #PHGCD    WQ0029  70       Item Code
     C                     PARM #PAJCD    WQ0030  3        Warehouse Code
     C                     PARM P7RMNB    WQ0031  70       Load ID
     C                     PARM P3XCCD    WQ0032  3        Carrier Broker
     C           YL0008    PARM *BLANK    WQ0033  1        Status - Y or N
     C                     PARM #CBCNA    WQ0034 15        Customer Purcha
     C           #CJENY    PARM #CJENY    WQ0035  30       COA Temperature
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNOKDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: LCL.Status - Y or N is yes
     C           YL0008    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       P3R4ST           USR Update Flag
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * recalc gross
      * CASE: CTL.COA Temperature Loadout NE LCL.COA Temperature Loadout
     C           #CJENY    IFNE YL0004                     *IF
     C                     Z-ADD#CJENY    YL0004           COA Temperature
     C                     Z-ADD#CJENY    YL0005           RFS Loadout Tem
      * Rtv API Vol Cor Fctor RT - RFS API Volume Corr Table  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD30        WL0005           RFS API Gravity
     C                     Z-ADDYL0005    WL0006           RFS Loadout Tem
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    YL0006           RFS API Vol Cor
     C                     Z-ADDYL0006    WUJSNY           HPB Temperature
      * Compute: ctl.gross galls
      * CTL.Gross Gallons        USR =
      *    *COMPUTE (x1/ x2)
      * x1    : CTL.Quantity Ordered 1 USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : WRK.HPB Temperature Adjustmnt
     C           #CIRQT    DIV  WUJSNY    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    #CQQQT           Gross Gallons
     C                     END                             *FI
     C                     END
      * Quit if reload requested
     C           W0RSF     CABEQ'Y'       DAEXIT
      *
     C   81                DO
      * No data entered as yet
     C                     MOVEL'N'       WKIPIN  1
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Process subfile records
     C                     EXSR DBPRSF
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * If data entered
     C           WKIPIN    IFEQ 'Y'
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Update DBF from subfile
     C                     EXSR EAPRSF
      * If error during update, exit:
     C           *IN99     CABEQ'1'       DAEXIT
     C                     END                             WKIPIN
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
     C                     EXSR DCPRSR
     C                     SETOF                     87    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,32
      * No errors
     C                     SETOF                     98
      * Data entered
     C                     MOVEL'Y'       WKIPIN
      * SFLNXTCHG
     C                     SETON                     84
      * If delete request, bypass validation
     C           #1SEL     IFEQ '4'
     C                     GOTO DCEXIT
     C                     END
      * Validate subfile record
     C                     EXSR DEV1RC
      * If SFLRCD invalid, note the fact
     C   98N99             Z-ADD##RR      ##SFRC     99    *
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DEV1RC    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record fields
      * Delete Manifest Record
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DEEXIT                     *QUIT
     C                     END                             *FI
      * Compute standard weight for non-catchweight items
      * CASE: PAR.Catch Weight Status is Not Yes
     C           P2AVST    IFEQ *BLANK                     *IF
     C           P2AVST    OREQ 'N'
     C           #1FOQT    MULT P5AIWG    #1R0NB           Case Weight
     C                     END                             *FI
      * If Y is entered for USR edit for Quantity & Weight
      * CASE: RCD.USR Zero Value is Yes
     C           #RUEST    IFEQ 'Y'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Case Quantity is NE *ZERO
      *   |- c2    : RCD.Case Weight is NE *ZERO
      *   '-
     C           #1FOQT    IFNE *ZERO                      *IF
     C           #1R0NB    ORNE *ZERO                      *OR
      * Setup message data for message
     C                     Z-ADD#RFYQT    ZA0001           USR Case Quanti
     C                     Z-ADD#RZPNB    ZA0002           USR Case Weight
      * Send message 'Qty & Wgt must be 0'
     C                     MOVEL'USR1588' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * IF " " Entered for Zero Quantity flag
      * CASE: RCD.USR Zero Value is No
     C           #RUEST    IFEQ *BLANK                     *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Case Quantity is EQ *ZERO
      *   |- c2    : RCD.Case Weight is EQ *ZERO
      *   '-
     C           #1FOQT    IFEQ *ZERO                      *IF
     C           #1R0NB    OREQ *ZERO                      *OR
      * Setup message data for message
     C                     Z-ADD#1FOQT    ZA0003           Case Quantity
     C                     Z-ADD#1R0NB    ZA0004           Case Weight
      * Send message 'Quantity and Weight Rqd'
     C                     MOVEL'USR1325' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * FP1110 HPB project - new validation for meter readings, weight ca
      * CASE: CTL.WHS Req Meter Reading Shp is Yes
     C           #CRTSX    IFEQ 'Y'                        *IF
     C                     Z-ADD#1ITNY    #CI3NY           COA Batch Numbe
      * Calc HPB Net Gallons
      * CASE: RCD.HPB Meter Start Gallon GT RCD.HPB Meter Ending Gallon
     C           #1IVNY    IFGT #1IUNY                     *IF
      * Setup message data for message
     C                     Z-ADD#1IVNY    ZA0005           HPB Meter Start
     C                     Z-ADD#1IUNY    ZA0006           HPB Meter Endin
      * Send message 'Meter Start must be<end'
     C                     MOVEL'USR3843' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RMC -- Round Net Gallons to a whole number per Tom 4/23/08
      * Calc Factor or Use API Table - 7/14/10
      * CASE: LCL.RFS Volume Corr Mthd  USR is Calculate factor per Prop
     C           YL0009    IFEQ 'C'                        *IF
      * New formula - after 6/27/10 -  goes in with RFS2/EMTS    P000579
     C                     Z-ADD-.00045767WUJQNY           COA Temp Conv F
     C                     Z-ADD1.02746025WUJRNY           COA Temp Conv F
      * Compute: rcd.Net gallons
      * WRK.Quantity 7.0 USR =
      *    *COMPUTE (x1* (x2 * x3 +x4))
      * x1    : RCD.HPB Meter Total Gallon
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : WRK.COA Temp Conv Factor 1
      * *     : PGM.*Synon (17,9) work field *
      * x3    : LCL.COA Temperature Loadout
      * +     : PGM.*Synon (17,9) work field
      * x4    : WRK.COA Temp Conv Factor 2
     C           WUJQNY    MULT YL0004    W0WE02           *Synon (17,9) w
     C           W0WE02    ADD  WUJRNY    W0WE01           *Synon (17,9) w
     C           #1IWNY    MULT W0WE01    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUTQTC           Quantity 7.0 US
      * Compute: density ref NEW
      * WRK.COA Density Ref Adj 4 dec =
      *    *COMPUTE ((x1 *x2 +x3) * x5)
      * x1    : WRK.COA Temp Conv Factor 1
      * *     : PGM.*Synon (17,9) work field *
      * x2    : LCL.COA Temperature Loadout
      * +     : PGM.*Synon (17,9) work field
      * x3    : WRK.COA Temp Conv Factor 2
      * *     : PGM.*Synon (17,9) work field *
      * x5    : LCL.COA Density Loadout
     C           WUJQNY    MULT YL0004    W0WE02           *Synon (17,9) w
     C           W0WE02    ADD  WUJRNY    W0WE01           *Synon (17,9) w
     C           W0WE01    MULT YL0010    W0WE00           *Synon (17,9) w
     C                     Z-ADDW0WE00    WULRNY           COA Density Ref
     C                     ELSE
      * CASE: LCL.RFS Volume Corr Mthd  USR is API Volume Corr Table
     C           YL0009    IFEQ 'A'                        *IF
     C                     Z-ADDYL0004    YL0005           RFS Loadout Tem
      * Rtv API Vol Cor Fctor RT - RFS API Volume Corr Table  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD30        WL0005           RFS API Gravity
     C                     Z-ADDYL0005    WL0006           RFS Loadout Tem
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    YL0006           RFS API Vol Cor
     C                     Z-ADDYL0006    WUJSNY           HPB Temperature
      * Compute: rcd.Net gallons
      * WRK.Quantity 7.0 USR =
      *    *COMPUTE (x1* x2)
      * x1    : RCD.HPB Meter Total Gallon
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : WRK.HPB Temperature Adjustmnt
     C           #1IWNY    MULT WUJSNY    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUTQTC           Quantity 7.0 US
      * Compute: density ref NEW
      * WRK.COA Density Ref Adj 4 dec =
      *    *COMPUTE (x1 * x5)
      * x1    : WRK.HPB Temperature Adjustmnt
      * *     : PGM.*Synon (17,5) work field *Rounded
      * x5    : LCL.COA Density Loadout
     C           WUJSNY    MULT YL0010    W0WC00    H      *Synon (17,5) w
     C                     Z-ADDW0WC00    WULRNY           COA Density Ref
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUTQTC    #1N6WG           HPB Meter Net G
     C                     Z-ADDWULRNY    #1IYNY           HPB Density Ref
     C                     END                             *FI
      * Calc Gross weight from density loadout and other factor
      * Compute: Fuel Weight
      * RCD.Case Weight =
      *    *COMPUTE (x1*x2*x3)
      * x1    : RCD.HPB Meter Total Gallon
      * *     : PGM.*Synon (17,7) work field *
      * x2    : LCL.COA Density Loadout
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.8.33
     C           #1IWNY    MULT YL0010    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 8.33      W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    #1R0NB           Case Weight
      * Calc Net weight from density loadout and other factor
      * Compute: Fuel Weight
      * RCD.HPB Meter Net Weight =
      *    *COMPUTE (x1*x2*x3)
      * x1    : RCD.HPB Meter Net Gallon
      * *     : PGM.*Synon (17,7) work field *
      * x2    : LCL.COA Density Loadout
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.8.33
     C           #1N6WG    MULT YL0010    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 8.33      W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    #1IXNY           HPB Meter Net W
     C                     END                             *FI
     C                     ADD  #1FOQT    P3FYQT           USR Case Quanti
     C                     ADD  #1R0NB    P3ZPNB           USR Case Weight
     C                     END
      * Validate subfile record relations
     C                     EXSR DFV2RC
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         DFV2RC    BEGSR
      *================================================================
      * Validate subfile record relations
      *================================================================
      *================================================================
     CSR         DFEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'Y'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * Initialise subfile reload flag
     C                     MOVEL'N'       W0RSF
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
     C                     MOVEL*BLANK    #1SEL
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,32
     C                     SETOF                     98
      *
     C           #1SEL     IFEQ '4'
      * Process delete request
     C                     EXSR EDDLRQ
     C                     ELSE
      * Process change request
     C                     EXSR EECHRQ
     C                     END
      * If error occurred on update, note the fact
     C           *IN98     IFEQ '1'
     C           *IN99     IFEQ '0'
     C                     Z-ADD##RR      ##SFRC     99    *
     C                     END
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EDDLRQ    BEGSR
      *================================================================
      * Process delete request
      *================================================================
      * USER: Delete DBF record
      * DLT Manifest Detl -HPB IF
      * Update selected RIN with not sold sts and take out gallons sold
      * DLT Manifest Detail    DL - Manifest Detail  * 
     C                     EXSR SJDLRC
      * Del Manifest Dtl RIN  DO - Manifest Detail RIN Sell  * 
     C                     EXSR SKDLRC
      * RTV Chg for Confirm    RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0008           Company Number
     C                     Z-ADD#1C4NB    WL0009           Order Number
     C                     Z-ADD#1DPNB    WL0010           Order Sequence
     C                     Z-ADD#1UENB    WL0011           Order Secondary
     C                     Z-ADD#1HGCD    WL0012           Item Code
     C                     Z-ADDYL0013    WL0013           USR Case Quanti
     C                     Z-ADDYL0014    WL0014           USR Case Weight
     C                     MOVELYL0015    WL0015    P      USR Under Min
     C                     MOVELYL0016    WL0016    P      USR Over Max
     C                     MOVELYL0017    WL0017    P      USR Exit Progra
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    YL0013           USR Case Quanti
     C                     Z-ADDWL0014    YL0014           USR Case Weight
     C                     MOVELWL0015    YL0015    P      USR Under Min
     C                     MOVELWL0016    YL0016    P      USR Over Max
     C                     MOVELWL0017    YL0017    P      USR Exit Progra
      * RTV Crt/Chg HPB Batch RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0033           Company Number
     C                     Z-ADD#1C4NB    WL0034           Order Number
     C                     Z-ADDP7RMNB    WL0035           Load ID
     C                     Z-ADD0         WL0036           HPB COA Batch N
     C                     EXSR SPRVGN
     C           W0RTN     IFNE *BLANK
      * Delete unsuccessful
      * Screen errors
     C                     MOVEAWKIND1    *IN,32
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
      * If record altered, reset subfile record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1           IF
     C                     END
     C                     ELSE
      * DBF delete successful
      * Blank out record and protect from entry
     C                     EXSR MAIZ#1
      * disable entry
     C                     SETON                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
      * Reload subfile
     C                     MOVEL'Y'       W0RSF   1
     C                     END
      *================================================================
     CSR         EDEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * CHG OM Manifest Detail CH - Manifest Detail  * 
     C                     EXSR STCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Screen errors
     C                     MOVEAWKIND1    *IN,32
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
      * Reset subfile record if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1           IF
     C                     END
     C                     ELSE
      * DBF update successful
      * Enable entry
     C                     SETOF                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect keys if change mode or updated record
     C                     SETON                     88    *
     C   89N87             SETOF                     88    *
     C                     MOVEL*IN87     *IN77
     C           W0PMD     IFEQ 'ADD'                      *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
     C                     MOVEL'0'       *IN79
     C           #CFVQT    IFNE *ZERO                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           W0PMD     IFEQ 'ADD'                      *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise subfile record
      *================================================================
      * Previous values
     C                     MOVEL*BLANK    #1DBRC
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     Z-ADDP1HGCD    #1HGCD           Item Code
     C                     MOVELP1AJCD    #1AJCD           Warehouse Code
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #RZPNB           USR Case Weight
     C                     Z-ADD*ZERO     #1ELDT           Production Date
     C                     MOVEL*BLANK    #RUEST           USR Zero Value
     C                     MOVEL*BLANK    #1RZNA           Manifest Lot ID
     C                     Z-ADD*ZERO     #1N5WG           Manifest Gross
     C                     Z-ADD*ZERO     #1H5NY           Manifest Total
     C                     Z-ADD*ZERO     #1H6NY           Manifest Co-Par
     C                     Z-ADD*ZERO     #1H7NY           Manifest Pallet
     C                     MOVEL*BLANK    #1GBTX           Manifest Shift
     C                     Z-ADD*ZERO     #1N6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     #1N7WG           Manifest Net We
     C                     MOVEL*BLANK    #1GCTX           Manifest Unused
     C                     MOVEL*BLANK    #1GDTX           Manifest Unused
     C                     Z-ADD*ZERO     #1RBDT           Manifest Unused
     C                     MOVEL*BLANK    #RMTT1           COA Batch RIN
     C                     Z-ADD*ZERO     #1IWNY           HPB Meter Total
     C                     Z-ADD*ZERO     #1IXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     #1IYNY           HPB Density Ref
     C                     Z-ADD*ZERO     #1K7DT           Label Date
     C                     Z-ADD*ZERO     #1PFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     #1RZNB           Case Sequence N
     C                     MOVEL*BLANK    #RH2NA           USR Location Zo
     C                     MOVEL*BLANK    #RH3NA           USR Location Ai
     C                     MOVEL*BLANK    #RH4NA           USR Location Ti
     C                     MOVEL*BLANK    #RH5NA           USR Location Bi
     C                     Z-ADD*ZERO     #RFYQT           USR Case Quanti
     C                     MOVEL*BLANK    #1PMST           Inventory Updat
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
     C                     Z-ADDP1DPNB    #1DPNB           Order Sequence
     C                     Z-ADDP1UENB    #1UENB           Order Secondary
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #1FOQT           Case Quantity
     C                     Z-ADD*ZERO     #1R0NB           Case Weight
     C                     Z-ADD*ZERO     #1ITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     #1IVNY           HPB Meter Start
     C                     Z-ADD*ZERO     #1IUNY           HPB Meter Endin
     C                     MOVEL*BLANK    #RTDNA           COA RIN Custome
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @FNCPE5 fields to subfile
      *================================================================
     C                     Z-ADDFNAIC3    #1AIC3           Company Number
     C                     Z-ADDFNHGCD    #1HGCD           Item Code
     C                     MOVELFNAJCD    #1AJCD           Warehouse Code
     C                     MOVELFNUVST    #1UVST           EDI Status 1
     C                     MOVELFNUWST    #1UWST           EDI Status 2
     C                     MOVELFNUXST    #1UXST           EDI Status 3
     C                     MOVELFNVSST    #1VSST           Record Status
     C                     Z-ADDFNELDT    #1ELDT           Production Date
     C                     MOVELFNRZNA    #1RZNA           Manifest Lot ID
     C                     Z-ADDFNN5WG    #1N5WG           Manifest Gross
     C                     Z-ADDFNH5NY    #1H5NY           Manifest Total
     C                     Z-ADDFNH6NY    #1H6NY           Manifest Co-Par
     C                     Z-ADDFNH7NY    #1H7NY           Manifest Pallet
     C                     MOVELFNGBTX    #1GBTX           Manifest Shift
     C                     Z-ADDFNN6WG    #1N6WG           HPB Meter Net G
     C                     Z-ADDFNN7WG    #1N7WG           Manifest Net We
     C                     MOVELFNGCTX    #1GCTX           Manifest Unused
     C                     MOVELFNGDTX    #1GDTX           Manifest Unused
     C                     Z-ADDFNRBDT    #1RBDT           Manifest Unused
     C                     Z-ADDFNIWNY    #1IWNY           HPB Meter Total
     C                     Z-ADDFNIXNY    #1IXNY           HPB Meter Net W
     C                     Z-ADDFNIYNY    #1IYNY           HPB Density Ref
     C                     Z-ADDFNK7DT    #1K7DT           Label Date
     C                     Z-ADDFNPFNX    #1PFNX           PT Serial Numbe
     C                     Z-ADDFNRZNB    #1RZNB           Case Sequence N
     C                     MOVELFNPMST    #1PMST           Inventory Updat
     C                     Z-ADDFNC4NB    #1C4NB           Order Number
     C                     Z-ADDFNDPNB    #1DPNB           Order Sequence
     C                     Z-ADDFNUENB    #1UENB           Order Secondary
     C                     Z-ADDFNAATM    #1AATM           Job Time
     C                     MOVELFNAYNA    #1AYNA           User Id
     C                     MOVELFNA0NA    #1A0NA           Job Name
     C                     Z-ADDFNAXDT    #1AXDT           Job Date
     C                     Z-ADDFNFOQT    #1FOQT           Case Quantity
     C                     Z-ADDFNR0NB    #1R0NB           Case Weight
     C                     Z-ADDFNITNY    #1ITNY           HPB COA Batch N
     C                     Z-ADDFNIVNY    #1IVNY           HPB Meter Start
     C                     Z-ADDFNIUNY    #1IUNY           HPB Meter Endin
      * Hold current record image for change detection
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADD*ZERO     #CI3NY           COA Batch Numbe
     C                     MOVEL*BLANK    #CRTSX           WHS Req Meter R
     C                     Z-ADD*ZERO     #CCHMT           Chilling Time U
     C                     MOVEL*BLANK    #CJ2NA           USR Item Type D
     C                     Z-ADDP2CCQT    #PCCQT           Quantity Schedu
     C                     Z-ADDP2AUWG    #PAUWG           Weight Schedule
     C                     Z-ADD*ZERO     #CCDWG           USR Weight Accu
     C                     Z-ADDP1DPNB    #2DPNB           Order Sequence
     C                     Z-ADDP1UENB    #2UENB           Order Secondary
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #CAPTX           Company Name
     C                     MOVEL*BLANK    #CBCNA           Customer Purcha
     C                     Z-ADD*ZERO     #CBKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    VCBKC7
     C                     MOVEL*BLANK    #CBRTX           Ship To Name
     C                     Z-ADD*ZERO     #CJENY           COA Temperature
     C                     Z-ADDP1C4NB    #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     Z-ADDP1HGCD    #PHGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    VPHGCD
     C                     MOVELP2G7NA    #PG7NA           Order Desc. Lin
     C                     MOVELP2AGCD    #PAGCD           U/M - Ordered
     C                     MOVELP1AJCD    #PAJCD           Warehouse Code
     C                     Z-ADD*ZERO     #CIRQT           Quantity Ordere
     C                     Z-ADD*ZERO     #CQQQT           Gross Gallons
     C                     Z-ADD*ZERO     #CFVQT           USR Quantity Ac
      * Check restriction within
     C                     EXSR VACKRL
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #CBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#CBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VPHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VPHGCD           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#2AIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CAPTX           Name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    #CAPTX           Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Manifest detail    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3           Company Number
     C                     Z-ADD#2C4NB    OMC4NB           Order Number
     C                     Z-ADD#2DPNB    OMDPNB           Order Sequence
     C                     Z-ADD#2UENB    OMUENB           Order Secondary
      * Establish starting position
     C           KRSSB     CHAIN@BGWKL1              90    *
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELOMAGCD    #PAGCD           U/M - Ordered
     C                     MOVELOMAVST    WUAVST           Catch Weight St
     C                     MOVELOMFZST    P2FZST           Production Date
     C                     Z-ADDOMCCQT    #PCCQT           Quantity Schedu
     C                     Z-ADDOMAUWG    #PAUWG           Weight Schedule
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Next Key           RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSC02           Order Number
     C           *LIKE     DEFN WADPNB    WQSC03           Order Sequence
     C           *LIKE     DEFN WAUENB    WQSC04           Order Secondary
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WQSC03           Order Sequence
     C                     KFLD           WQSC04           Order Secondary
     C                     KFLD           WARZNB           Case Sequence N
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WQSC03           Order Sequence
     C                     KFLD           WQSC04           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    WQSC01           Company Number
     C                     Z-ADD#2C4NB    WQSC02           Order Number
     C                     Z-ADD#2DPNB    WQSC03           Order Sequence
     C                     Z-ADD#2UENB    WQSC04           Order Secondary
     C                     Z-ADDWURZNB    WARZNB           Case Sequence N
      * Establish starting position
     C           KPSSC     SETLL@FNCPCT                    *
     C           KRSSC     READE@FNCPCT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WURZNB           Case Sequence N
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT                     *QUIT
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : PAR.Company Number EQ DB1.Company Number
      *   |- c2    : PAR.Order Number EQ DB1.Order Number
      *   |- c3    : PAR.Order Sequence Number EQ DB1.Order Sequence Numb
      *   |- c4    : PAR.Order Secondary Line Seq EQ DB1.Order Secondary
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2AIC3    IFEQ WAAIC3                     *IF
     C           #2C4NB    IFEQ WAC4NB                     *IF
     C           #2DPNB    IFEQ WADPNB                     *IF
     C           #2UENB    IFEQ WAUENB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWARZNB    WURZNB           Case Sequence N
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSC     READE@FNCPCT                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     ADD  1         WURZNB           Case Sequence N
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv HPB fields        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Production Ware
     C                     MOVEL*BLANK    WL0003           Warehouse Locat
     C                     MOVEL*BLANK    WL0004           WHS Req Meter R
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADAOCD    WL0002           Production Ware
     C                     MOVELADT0ST    WL0003           Warehouse Locat
     C                     MOVELADRTSX    WL0004           WHS Req Meter R
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Acct Co          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELYL0001    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0003           Accounting Comp
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBTC3    YL0003           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV HPB Gross Gall    RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSF02           Order Number
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    WQSF01           Company Number
     C                     Z-ADD#2C4NB    WQSF02           Order Number
     C                     Z-ADD#2DPNB    WADPNB           Order Sequence
     C                     Z-ADD#2UENB    WAUENB           Order Secondary
      * Establish starting position
     C           KPSSF     SETLL@FNCPCT                    *
     C           KRSSF     READE@FNCPCT                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WAFOQT    #CFVQT           Quantity Shippe
     C           KRSSF     READE@FNCPCT                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv API Vol Cor Fctor RT - RFS API Volume Corr Table  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           GJSSNY           RFS API Gravity
     C                     KFLD           GJSTNY           RFS Loadout Tem
      * Setup key
     C                     Z-ADDWL0005    GJSSNY           RFS API Gravity
     C                     Z-ADDWL0006    GJSTNY           RFS Loadout Tem
      * Establish starting position
     C           KRSSG     CHAIN@GJREHH              90    *
      * Data record not found
     C   90                MOVEL'USR4345' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDGJSUNY    WL0007           RFS API Vol Cor
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV RIN Sold          RT - Manifest Detail RIN Sell  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           FPAIC3           Company Number
     C                     KFLD           FPC4NB           Order Number
     C                     KFLD           FPDPNB           Order Sequence
     C                     KFLD           FPUENB           Order Secondary
     C                     KFLD           FPRZNB           Case Sequence N
      * Setup key
     C                     Z-ADD#1AIC3    FPAIC3           Company Number
     C                     Z-ADD#1C4NB    FPC4NB           Order Number
     C                     Z-ADD#1DPNB    FPDPNB           Order Sequence
     C                     Z-ADD#1UENB    FPUENB           Order Secondary
     C                     Z-ADD#1RZNB    FPRZNB           Case Sequence N
      * Establish starting position
     C           KRSSH     CHAIN@FPCPDP              90    *
      * Data record not found
     C   90                MOVEL'USR4210' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv RIN F/Manf Dtl RINRT - COA Batch Header RIN  * 
     C                     EXSR SIRVGN
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv RIN F/Manf Dtl RINRT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           DAAIC3           Company Number
     C                     KFLD           DAL6T1           COA ULSD Compan
     C                     KFLD           DAI3NY           COA Batch Numbe
     C                     KFLD           DAJYNY           COA Batch Heade
     C                     KFLD           DAQ1NY           COA Batch Hdr R
      * Setup key
     C                     Z-ADDFPRCNY    DAAIC3           Company Number
     C                     MOVELFPL6T1    DAL6T1           COA ULSD Compan
     C                     Z-ADDFPI3NY    DAI3NY           COA Batch Numbe
     C                     Z-ADDFPJYNY    DAJYNY           COA Batch Heade
     C                     Z-ADDFPQ1NY    DAQ1NY           COA Batch Hdr R
      * Establish starting position
     C           KRSSI     CHAIN@DACPP6              90    *
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDAMUT1    YL0007           COA Batch Heade
     C                     MOVELDATDNA    #RTDNA           COA RIN Custome
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJDLRC    BEGSR
      *================================================================
      * DLT Manifest Detail    DL - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FNCPCS
     C                     Z-ADD#1AIC3    FNAIC3           Company Number
     C                     Z-ADD#1C4NB    FNC4NB           Order Number
     C                     Z-ADD#1DPNB    FNDPNB           Order Sequence
     C                     Z-ADD#1UENB    FNUENB           Order Secondary
     C                     Z-ADD#1RZNB    FNRZNB           Case Sequence N
      *
     C           KLDLSJ    KLIST
     C                     KFLD           FNAIC3           Company Number
     C                     KFLD           FNC4NB           Order Number
     C                     KFLD           FNDPNB           Order Sequence
     C                     KFLD           FNUENB           Order Secondary
     C                     KFLD           FNRZNB           Case Sequence N
     C           KLDLSJ    CHAIN@FNCPCS              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFNCPL0'MDACP
     C                     MOVEL'@FNCPCS' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FNCPCS                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF delete successful
      * USER: Processing after Data update
     C                     MOVEL'Y'       YL0011           USR Update Flag
     C                     MOVEL'Y'       YL0012           COA RIN Modifie
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKDLRC    BEGSR
      *================================================================
      * Del Manifest Dtl RIN  DO - Manifest Detail RIN Sell  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FPCPDO
     C                     Z-ADD#1AIC3    WBAIC3           Company Number
     C                     Z-ADD#1C4NB    WBC4NB           Order Number
     C                     Z-ADD#1DPNB    WBDPNB           Order Sequence
     C                     Z-ADD#1UENB    WBUENB           Order Secondary
     C                     Z-ADD#1RZNB    WBRZNB           Case Sequence N
      *
     C           KLDLSK    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
     C                     KFLD           WBRZNB           Case Sequence N
     C           KLDLSK    CHAIN@FPCPDO              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PNFPCPL0'MDACP
     C                     MOVEL'@FPCPDO' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FPCPDO                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Chg for Confirm    RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       USR Min Weight
     C                     Z-ADD*ZERO     WN0002  70       USR Max Weight
     C                     Z-ADD*ZERO     WN0003 112       Minimum Weight
     C                     Z-ADD*ZERO     WN0004 112       Maximum Weight
     C                     Z-ADD*ZERO     WN0005 112       HPB Meter Net G
     C                     Z-ADD*ZERO     WN0006  80       HPB Meter Net W
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WL0017           USR Exit Progra
     C                     MOVEL'N'       WL0016           USR Over Max
     C                     MOVEL'N'       WL0015           USR Under Min
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Setup key
     C                     Z-ADDWL0008    OMAIC3           Company Number
     C                     Z-ADDWL0009    OMC4NB           Order Number
     C                     Z-ADDWL0010    OMDPNB           Order Sequence
     C                     Z-ADDWL0011    OMUENB           Order Secondary
      * Establish starting position
     C           KRSSL     CHAIN@BGWKL1              90    *
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Total Confirmed    RT - Manifest Detail  * 
     C                     EXSR SMRVGN
      * Check min/max from the item master
     C                     Z-ADD0         WN0001           USR Min Weight
     C                     Z-ADD0         WN0002           USR Max Weight
      * RTV Qty Min/Max        RT - Company/Item  * 
     C                     EXSR SNRVGN
     C           WN0003    MULT WL0013    WN0001    H      USR Min Weight
     C           WN0004    MULT WL0013    WN0002    H      USR Max Weight
      * Weight entered as shipped is less than Minimum
      * CASE: PAR.USR Case Weight LT PAR.USR Min Weight
     C           WL0014    IFLT WN0001                     *IF
     C                     MOVEL'Y'       WL0015           USR Under Min
     C                     MOVEL'N'       WL0017           USR Exit Progra
      * Exit Prog. No  will set the program back to beginning
     C                     END                             *FI
      * Weight entered is greater than the maxiumum
      * CASE: PAR.USR Case Weight GT PAR.USR Max Weight
     C           WL0014    IFGT WN0002                     *IF
     C                     MOVEL'Y'       WL0016           USR Over Max
     C                     MOVEL'N'       WL0017           USR Exit Progra
      * Exit prog. no will set program back to beginning
     C                     END                             *FI
      * CASE: PAR.USR Case Quantity GT DB1.Quantity Allocated
     C           WL0013    IFGT OMCCQT                     *IF
     C                     MOVEL'O'       WUR0ST           Work Over/Short
     C                     END                             *FI
      * CASE: PAR.USR Case Quantity LT DB1.Quantity Allocated
     C           WL0013    IFLT OMCCQT                     *IF
     C                     MOVEL'S'       WUR0ST           Work Over/Short
     C                     END                             *FI
     C                     MOVEL'R'       WUGMST           Detail Line Sta
     C                     MOVELOMGMST    WUGNST           Detail Line Sta
      * FP1110 HPB ONLY 4/14/08 Output net gallons and net weight to Ord
      *   if Warehouse is Req Meter Readings is YES.
      *   Every other warehouse puts out the gross from manifest dtl
      * Rtv HPB fields        RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELOMAJCD    WL0001    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0018    P      Production Ware
     C                     MOVELWL0003    YL0019    P      Warehouse Locat
     C                     MOVELWL0004    YL0020    P      WHS Req Meter R
      * CASE: LCL.WHS Req Meter Reading Shp is Yes
     C           YL0020    IFEQ 'Y'                        *IF
      * CHG Confirmed Qty      CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0018           Company Number
     C                     Z-ADDOMC4NB    WL0019           Order Number
     C                     Z-ADDOMDPNB    WL0020           Order Sequence
     C                     Z-ADDOMUENB    WL0021           Order Secondary
     C                     MOVELWUGMST    WL0022    P      Detail Line Sta
     C                     MOVELWUGNST    WL0023    P      Detail Line Sta
     C                     MOVEL'P'       WL0024    P      Work Confirm St
     C                     MOVELWUR0ST    WL0025    P      Work Over/Short
     C                     Z-ADDWN0005    WL0026           Quantity Shippe
     C                     Z-ADDWN0006    WL0027           Weight Shipped
     C                     Z-ADDOMAODT    WL0028           Scheduled Ship
     C                     Z-ADDOMGNDT    WL0029           Actual Shipped
     C                     MOVELOMZ1ST    WL0030    P      Modified Flag
     C                     MOVELOMZ3ST    WL0031    P      Substituted Fla
     C                     MOVELOMZ4ST    WL0032    P      OD Schedule Ove
     C                     EXSR SOCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Confirmed Qty      CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0018           Company Number
     C                     Z-ADDOMC4NB    WL0019           Order Number
     C                     Z-ADDOMDPNB    WL0020           Order Sequence
     C                     Z-ADDOMUENB    WL0021           Order Secondary
     C                     MOVELWUGMST    WL0022    P      Detail Line Sta
     C                     MOVELWUGNST    WL0023    P      Detail Line Sta
     C                     MOVEL'P'       WL0024    P      Work Confirm St
     C                     MOVELWUR0ST    WL0025    P      Work Over/Short
     C                     Z-ADDWL0013    WL0026           Quantity Shippe
     C                     Z-ADDWL0014    WL0027           Weight Shipped
     C                     Z-ADDOMAODT    WL0028           Scheduled Ship
     C                     Z-ADDOMGNDT    WL0029           Actual Shipped
     C                     MOVELOMZ1ST    WL0030    P      Modified Flag
     C                     MOVELOMZ3ST    WL0031    P      Substituted Fla
     C                     MOVELOMZ4ST    WL0032    P      OD Schedule Ove
     C                     EXSR SOCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Total Confirmed    RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WL0013           USR Case Quanti
     C                     Z-ADD0         WL0014           USR Case Weight
     C                     Z-ADD0         WN0005           HPB Meter Net G
     C                     Z-ADD0         WN0006           HPB Meter Net W
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSM02           Order Number
     C           *LIKE     DEFN WADPNB    WQSM03           Order Sequence
     C           *LIKE     DEFN WAUENB    WQSM04           Order Secondary
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
     C                     KFLD           WQSM03           Order Sequence
     C                     KFLD           WQSM04           Order Secondary
     C                     KFLD           WARZNB           Case Sequence N
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
     C                     KFLD           WQSM03           Order Sequence
     C                     KFLD           WQSM04           Order Secondary
      * Setup key
     C                     Z-ADDOMAIC3    WQSM01           Company Number
     C                     Z-ADDOMC4NB    WQSM02           Order Number
     C                     Z-ADDOMDPNB    WQSM03           Order Sequence
     C                     Z-ADDOMUENB    WQSM04           Order Secondary
     C                     Z-ADD0         WARZNB           Case Sequence N
      * Establish starting position
     C           KPSSM     SETLL@FNCPCT                    *
     C           KRSSM     READE@FNCPCT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WAFOQT    WL0013           USR Case Quanti
     C                     ADD  WAR0NB    WL0014           USR Case Weight
      * Only HPB will have these   4/14/08
     C                     ADD  WAN6WG    WN0005           HPB Meter Net G
     C                     ADD  WAIXNY    WN0006           HPB Meter Net W
     C           KRSSM     READE@FNCPCT                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Qty Min/Max        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0008    BZAIC3           Company Number
     C                     Z-ADDWL0012    BZHGCD           Item Code
      * Establish starting position
     C           KRSSN     CHAIN@BZREZG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZCZWG    WN0003           Minimum Weight
     C                     Z-ADDBZC0WG    WN0004           Maximum Weight
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * CHG Confirmed Qty      CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0007  70       Item Code
     C                     MOVEL*BLANK    WN0008  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0009  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0010  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0011 112       Billing Detail
     C                     Z-ADD*ZERO     WN0012 112       Billing Detail
     C                     Z-ADD*ZERO     WN0013 112       Billing Detail
     C                     Z-ADD*ZERO     WN0014 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0015  1        Comment Print A
     C                     MOVEL*BLANK    WN0016  1        Comment Print I
     C                     MOVEL*BLANK    WN0017  1        Comment Print P
     C                     MOVEL*BLANK    WN0018  1        Comment Print S
     C                     Z-ADD*ZERO     WN0019 112       Extended Amount
     C                     Z-ADD*ZERO     WN0020  70       Market Pricing
     C                     MOVEL*BLANK    WN0021  3        Commodity Marke
     C                     MOVEL*BLANK    WN0022  3        Date Method Cod
     C                     MOVEL*BLANK    WN0023  3        Price Method Co
     C                     Z-ADD*ZERO     WN0024 114       Price Overage O
     C                     Z-ADD*ZERO     WN0025  70       Contract Number
     C                     MOVEL*BLANK    WN0026  1        Price Status
     C                     Z-ADD*ZERO     WN0027  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0028  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0029  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0030  1        OD Production P
     C                     MOVEL*BLANK    WN0031 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0032 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0033  1        Age Code
     C                     MOVEL*BLANK    WN0034  1        Palletize
     C                     MOVEL*BLANK    WN0035  1        Slip Sheet
     C                     MOVEL*BLANK    WN0036  1        Catch Weight St
     C                     MOVEL*BLANK    WN0037  1        Price Audit
     C                     MOVEL*BLANK    WN0038  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0039  1        Production Date
     C                     Z-ADD*ZERO     WN0040 112       Rated Freight
     C                     Z-ADD*ZERO     WN0041 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0042 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0043 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0044 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0045 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0046 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0047 114       Unit Price
     C                     Z-ADD*ZERO     WN0048 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0049 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0050 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0051 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0052  70       Requested Ship
     C                     MOVEL*BLANK    WN0053  1        Affect Inventor
     C                     MOVEL*BLANK    WN0054  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0055  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0056  30       Item Structure
     C                     Z-ADD*ZERO     WN0057  30       Item Structure
     C                     Z-ADD*ZERO     WN0058  30       Item Structure
     C                     MOVEL*BLANK    WN0059  2        Item Level
     C                     MOVEL*BLANK    WN0060  2        Quality Level
     C                     MOVEL*BLANK    WN0061  2        Pricing Product
     C                     MOVEL*BLANK    WN0062  2        Season Product
     C                     Z-ADD*ZERO     WN0063  70       Date of Origina
     C                     MOVEL*BLANK    WN0064 10        User Profile Na
     C                     MOVEL*BLANK    WN0065  6        Country Code
     C                     MOVEL*BLANK    WN0066  2        Event Code
     C                     MOVEL*BLANK    WN0067  3        Reason Code
     C                     MOVEL*BLANK    WN0068  3        Sales Route Cod
     C                     Z-ADD*ZERO     WN0069 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0070 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0071  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0072  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0073  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0074  1        Affect Commissi
     C                     MOVEL*BLANK    WN0075  1        Affect Pricing
     C                     MOVEL*BLANK    WN0076  1        Released by Use
     C                     MOVEL*BLANK    WN0077  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0078  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0079  3        Production Ware
     C                     MOVEL*BLANK    WN0080  3        OD Price Type
     C                     Z-ADD*ZERO     WN0081  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0082  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0083  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0084  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0085  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0086  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0087  60       Price Code
     C                     Z-ADD*ZERO     WN0088  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0089  60       Substitution Li
     C                     Z-ADD*ZERO     WN0090  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0091 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0092 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0093 112       OD Item Target
     C                     Z-ADD*ZERO     WN0094 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0095 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0096 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0097 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0098 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0099 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0100 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0101 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0102 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0103 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0104  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0105  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0106  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0107 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0108  40       Item Age Days
     C                     Z-ADD*ZERO     WN0109  70       Production Ovr
     C                     Z-ADD*ZERO     WN0110  70       Production Ovr
     C                     MOVEL*BLANK    WN0111  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0112  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0113  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0114  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0115  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0116  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0117  1        EDI Status 1
     C                     MOVEL*BLANK    WN0118  1        EDI Status 2
     C                     MOVEL*BLANK    WN0119  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0120  60       Job Time
     C                     MOVEL*BLANK    WN0121 10        User Id
     C                     MOVEL*BLANK    WN0122 10        Job Name
     C                     Z-ADD*ZERO     WN0123  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0018    WCAIC3           Company Number
     C                     Z-ADDWL0019    WCC4NB           Order Number
     C                     Z-ADDWL0020    WCDPNB           Order Sequence
     C                     Z-ADDWL0021    WCUENB           Order Secondary
      *
     C           KLCHSO    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
     C           KLCHSO    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0022    WCGMST    P      Detail Line Sta
     C                     MOVELWL0023    WCGNST    P      Detail Line Sta
     C                     MOVELWL0024    WCRZST    P      Work Confirm St
     C                     MOVELWL0025    WCR0ST    P      Work Over/Short
     C                     Z-ADDWL0026    WCCBQT           Quantity Shippe
     C                     Z-ADDWL0027    WCATWG           Weight Shipped
     C                     Z-ADDWL0028    WCAODT           Scheduled Ship
     C                     Z-ADDWL0029    WCGNDT           Actual Shipped
     C                     MOVELWL0030    WCZ1ST    P      Modified Flag
     C                     MOVELWL0031    WCZ3ST    P      Substituted Fla
     C                     MOVELWL0032    WCZ4ST    P      OD Schedule Ove
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Crt/Chg HPB Batch RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0033    AMAIC3           Company Number
     C                     Z-ADDWL0034    AMC4NB           Order Number
      * Establish starting position
     C           KRSSP     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * RTV Stop Drop Seq     RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0035    WL0037           Load ID
     C                     Z-ADDWL0034    WL0039           Order Number
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0038    YL0021           Stop/Drop Seque
      * CRT Existing OHE       CR - Order Header Extension  * 
     C                     EXSR SRCRRC
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Load ID is Blank
     C           AMRMNB    IFEQ 0                          *IF
     C                     Z-ADDWL0035    YL0046           Load ID
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDAMRMNB    YL0046           Load ID
     C                     END                             *FI
      * CASE: DB1.Stop/Drop Sequence Number is Not Entered
     C           AMRUNB    IFEQ 0                          *IF
      * RTV Stop Drop Seq     RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0035    WL0037           Load ID
     C                     Z-ADDWL0034    WL0039           Order Number
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0038    YL0021           Stop/Drop Seque
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDAMRUNB    YL0021           Stop/Drop Seque
     C                     END                             *FI
      * CHG HPB Batch/Load    CH - Order Header Extension  * 
     C                     EXSR SSCHRC
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Stop Drop Seq     RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0038           Stop/Drop Seque
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSQ02           Load ID
     C           *LIKE     DEFN FLC4NB    WQSQ03           Order Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ02           Load ID
     C                     KFLD           WQSQ03           Order Number
      * Setup key
     C                     Z-ADDWL0037    WQSQ02           Load ID
     C                     Z-ADDWL0039    WQSQ03           Order Number
      * Establish starting position
     C           KRSSQ     SETLL@FLCPKF                    *
     C           KRSSQ     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFLRUNB    WL0038           Stop/Drop Seque
     C           KRSSQ     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCRRC    BEGSR
      *================================================================
      * CRT Existing OHE       CR - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AMREJE
     C                     Z-ADDWL0033    WDAIC3           Company Number
     C                     Z-ADDWL0034    WDC4NB           Order Number
     C                     Z-ADDWL0035    WDRMNB           Load ID
     C                     Z-ADDYL0021    WDRUNB           Stop/Drop Seque
     C                     MOVEL*BLANK    WDXACD           Shipping Line
     C                     MOVEL*BLANK    WDOANA           Port Delv Termi
     C                     MOVEL*BLANK    WDHBAA           OHE City
     C                     MOVEL*BLANK    WDJ0T1           OHE Vessel/Airl
     C                     MOVEL*BLANK    WDGENY           OHE Voyage/Flig
     C                     MOVEL*BLANK    WDJ1T1           OHE Booking Num
     C                     MOVEL*BLANK    WDHCAA           OHE Discharge P
     C                     Z-ADD0         WDQWDT           OHE Sail/Flight
     C                     Z-ADD0         WDQXDT           OHE Port Cut Da
     C                     Z-ADD0         WDQYDT           OHE Arrival Dat
     C                     MOVEL*BLANK    WDHDAA           OHE Late Delive
     C                     MOVEL'R'       WDCCTX           OHE Ship Status
     C                     MOVEL*BLANK    WDJ2T1           OHE Container N
     C                     MOVEL*BLANK    WDRLNA           OHE Comment 1
     C                     MOVEL*BLANK    WDRMNA           OHE Comment 2
     C                     Z-ADD0         WDGINY           OHE Unused Numb
     C                     Z-ADD0         WDGFNY           OHE Unused Numb
     C                     Z-ADD0         WDGGNY           OHE Unused Numb
     C                     Z-ADD0         WDGHNY           OHE Unused Numb
     C                     Z-ADD0         WDHEVL           OHE HPB RIN Equ
     C                     Z-ADD0         WDHFVL           OHE HPB RIN Pri
     C                     Z-ADD0         WDHGVL           Transload Termi
     C                     Z-ADD0         WDQZDT           OHE Est Arrv at
     C                     Z-ADD0         WDQ0DT           OHE Backhaul ET
     C                     Z-ADD0         WDQ1DT           OHE Port/Pier P
     C                     Z-ADD0         WDQ2DT           OHE Actual Ship
     C                     MOVELYL0022    WDC2TX           OHE Carrier SCA
     C                     MOVELYL0023    WDC3TX           OHE Spot Buy
     C                     MOVELYL0024    WDC6TX           OHE PO ACK Flag
     C                     MOVELYL0025    WDCHTX           OHE Override Ty
     C                     MOVELYL0026    WDCITX           OHE Backhaul St
     C                     MOVELYL0027    WDCLTX           OHE Backhaul ET
     C                     MOVELYL0028    WDB4TX           OHE Load Haul T
     C                     MOVELYL0029    WDCUTX           OHE Backhaul Ca
     C                     MOVELYL0030    WDCVTX           OHE Bookings Co
     C                     MOVELYL0031    WDB9TX           OHE EDI Error R
     C                     MOVELYL0032    WDJWSC           OHE EDI Error R
     C                     Z-ADDWL0036    WDITNY           HPB COA Batch N
     C                     MOVEL*BLANK    WDLMT1           Delivery P.O. N
     C                     MOVEL*BLANK    WDLWAA           OHE Intended fo
     C                     MOVELYL0033    WDFVST           OHE EDI 943 Act
     C                     MOVELYL0034    WDF0ST           OHE EDI 944 Act
     C                     MOVELYL0035    WDF2ST           OHE EDI 940 Act
     C                     MOVELYL0036    WDF3ST           OHE EDI 945 Act
     C                     MOVELYL0037    WDJUSC           OHE EDI 856 Act
     C                     MOVELYL0038    WDJVSC           OHE EDI 824 Act
     C                     MOVEL*BLANK    WDV3T1           OHE Transload S
     C                     MOVEL*BLANK    WDV4T1           OHE Abs Rate Ov
     C                     MOVEL*BLANK    WDV5T1           OHE Appt Confir
     C                     MOVEL*BLANK    WDV6T1           OHE Backhaul Co
     C                     MOVEL*BLANK    WDV7T1           OHE Backhaul Ch
     C                     MOVEL*BLANK    WDV8T1           OHE Transload C
     C                     MOVEL*BLANK    WDV9T1           OHE Pier Pass I
     C                     MOVEL*BLANK    WDWAT1           OHE Carrier Nm
     C                     MOVEL*BLANK    WDWBT1           OHE Appt Confir
     C                     MOVEL*BLANK    WDWCT1           OHE Backhaul Co
     C                     MOVEL*BLANK    WDWDT1           Letter of Credi
     C                     Z-ADD0         WDQJNY           OHE Backhaul Re
     C                     Z-ADD0         WDQKNY           LD Stop/Drop
     C                     Z-ADD0         WDQLNY           OHE Unused Numb
     C                     Z-ADD0         WDP8NY           OHE Pier Pass F
     C                     Z-ADD0         WDP9NY           OHE Port Check
     C                     Z-ADD0         WDQANY           OHE Port Cut Ti
     C                     Z-ADD0         WDQCNY           OHE Backhaul Tr
     C                     Z-ADD0         WDQDNY           OHE Load Sched
     C                     Z-ADD0         WDQENY           Original Appoin
     C                     Z-ADD0         WDQFNY           Original Appoin
     C                     Z-ADD0         WDQGNY           OHE PowerPro Lo
     C                     Z-ADD0         WDQHNY           OHE PowerPro Lo
     C                     Z-ADD0         WDQINY           OHE Unused Nume
     C                     Z-ADD0         WDQMNY           OHE Orig ABS Fr
     C                     MOVEL*BLANK    WDMYU1           OHE Genset Numb
     C                     MOVELYL0039    WDJXSC           OHE Email BOL/S
     C                     MOVELYL0040    WDJYSC           OHE Unused Stat
     C                     MOVELYL0041    WDJZSC           OHE Unused Stat
     C                     MOVELYL0042    WDJ0SC           OHE Unused Stat
     C                     MOVEL*BLANK    WDMZU1           OHE Unused Text
     C                     MOVEL*BLANK    WDM0U1           OHE Unused Text
     C                     MOVEL*BLANK    WDM1U1           OHE Unused Text
     C                     MOVEL*BLANK    WDM2U1           OHE Unused Text
     C                     MOVEL*BLANK    WDM3U1           OHE Unused Text
     C                     Z-ADD0         WDW5DT           OHE Unused Date
     C                     Z-ADD0         WDW6DT           OHE Unused Date
     C                     MOVELYL0043    WDUVST           EDI Status 1
     C                     MOVELYL0044    WDUWST           EDI Status 2
     C                     MOVELYL0045    WDUXST           EDI Status 3
     C                     MOVEL'A'       WDVSST           Record Status
     C                     Z-ADD0         WDAATM           Job Time
     C                     MOVEL*BLANK    WDAYNA           User Id
     C                     MOVEL*BLANK    WDA0NA           Job Name
     C                     Z-ADD0         WDAXDT           Job Date
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     MOVEL##USR     WDAYNA           User Id
     C           KLCRSR    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSR    SETLL@AMREJE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3698' W0RTN   7
      * Send message 'Order Header Extension EX'
     C                     MOVEL'USR3698' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C                     WRITE@AMREJE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * CHG HPB Batch/Load    CH - Order Header Extension  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0124  3        Shipping Line
     C                     MOVEL*BLANK    WN0125 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0126 25        OHE City
     C                     MOVEL*BLANK    WN0127 30        OHE Vessel/Airl
     C                     MOVEL*BLANK    WN0128 15        OHE Voyage/Flig
     C                     MOVEL*BLANK    WN0129 15        OHE Booking Num
     C                     MOVEL*BLANK    WN0130 20        OHE Discharge P
     C                     Z-ADD*ZERO     WN0131  70       OHE Sail/Flight
     C                     Z-ADD*ZERO     WN0132  70       OHE Port Cut Da
     C                     Z-ADD*ZERO     WN0133  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN0134  3        OHE Late Delive
     C                     MOVEL*BLANK    WN0135  1        OHE Ship Status
     C                     MOVEL*BLANK    WN0136 12        OHE Container N
     C                     MOVEL*BLANK    WN0137 35        OHE Comment 1
     C                     MOVEL*BLANK    WN0138 75        OHE Comment 2
     C                     Z-ADD*ZERO     WN0139 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0140 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0141 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0142 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0143 112       OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WN0144 112       OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WN0145 112       Transload Termi
     C                     Z-ADD*ZERO     WN0146  70       OHE Est Arrv at
     C                     Z-ADD*ZERO     WN0147  70       OHE Backhaul ET
     C                     Z-ADD*ZERO     WN0148  70       OHE Port/Pier P
     C                     Z-ADD*ZERO     WN0149  70       OHE Actual Ship
     C                     MOVEL*BLANK    WN0150  4        OHE Carrier SCA
     C                     MOVEL*BLANK    WN0151  4        OHE Spot Buy
     C                     MOVEL*BLANK    WN0152  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN0153  2        OHE Override Ty
     C                     MOVEL*BLANK    WN0154  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN0155  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN0156  3        OHE Load Haul T
     C                     MOVEL*BLANK    WN0157  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN0158  3        OHE Bookings Co
     C                     MOVEL*BLANK    WN0159  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN0160  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN0161 38        Delivery P.O. N
     C                     MOVEL*BLANK    WN0162  6        OHE Intended fo
     C                     MOVEL*BLANK    WN0163  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN0164  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN0165  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN0166  6        OHE EDI 945 Act
     C                     MOVEL*BLANK    WN0167  1        OHE EDI 856 Act
     C                     MOVEL*BLANK    WN0168  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN0169 10        OHE Transload S
     C                     MOVEL*BLANK    WN0170 10        OHE Abs Rate Ov
     C                     MOVEL*BLANK    WN0171 10        OHE Appt Confir
     C                     MOVEL*BLANK    WN0172 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0173 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN0174 15        OHE Transload C
     C                     MOVEL*BLANK    WN0175 30        OHE Pier Pass I
     C                     MOVEL*BLANK    WN0176 30        OHE Carrier Nm
     C                     MOVEL*BLANK    WN0177 30        OHE Appt Confir
     C                     MOVEL*BLANK    WN0178 50        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0179 50        Letter of Credi
     C                     Z-ADD*ZERO     WN0180  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN0181  30       LD Stop/Drop
     C                     Z-ADD*ZERO     WN0182  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0183  52       OHE Pier Pass F
     C                     Z-ADD*ZERO     WN0184  52       OHE Port Check
     C                     Z-ADD*ZERO     WN0185  50       OHE Port Cut Ti
     C                     Z-ADD*ZERO     WN0186  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN0187  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN0188  60       Original Appoin
     C                     Z-ADD*ZERO     WN0189  60       Original Appoin
     C                     Z-ADD*ZERO     WN0190  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0191  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0192  90       OHE Unused Nume
     C                     Z-ADD*ZERO     WN0193  96       OHE Orig ABS Fr
     C                     MOVEL*BLANK    WN0194 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN0195  1        OHE Email BOL/S
     C                     MOVEL*BLANK    WN0196  1        OHE Unused Stat
     C                     MOVEL*BLANK    WN0197  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0198  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0199  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0200  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0201 15        OHE Unused Text
     C                     MOVEL*BLANK    WN0202 15        OHE Unused Text
     C                     MOVEL*BLANK    WN0203 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN0204  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN0205  70       OHE Unused Date
     C                     MOVEL*BLANK    WN0206  1        EDI Status 1
     C                     MOVEL*BLANK    WN0207  1        EDI Status 2
     C                     MOVEL*BLANK    WN0208  1        EDI Status 3
     C                     MOVEL*BLANK    WN0209  1        Record Status
     C                     Z-ADD*ZERO     WN0210  60       Job Time
     C                     MOVEL*BLANK    WN0211 10        User Id
     C                     MOVEL*BLANK    WN0212 10        Job Name
     C                     Z-ADD*ZERO     WN0213  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDWL0033    WDAIC3           Company Number
     C                     Z-ADDWL0034    WDC4NB           Order Number
      *
     C           KLCHSS    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C           KLCHSS    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YBRDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADDYL0046    WDRMNB           Load ID
     C                     Z-ADDYL0021    WDRUNB           Stop/Drop Seque
     C                     Z-ADDWL0036    WDITNY           HPB COA Batch N
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     MOVEL##USR     WDAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * CHG OM Manifest Detail CH - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FNCPCS
     C                     Z-ADD#1AIC3    FNAIC3           Company Number
     C                     Z-ADD#1C4NB    FNC4NB           Order Number
     C                     Z-ADD#1DPNB    FNDPNB           Order Sequence
     C                     Z-ADD#1UENB    FNUENB           Order Secondary
     C                     Z-ADD#1RZNB    FNRZNB           Case Sequence N
      *
     C           KLCHST    KLIST
     C                     KFLD           FNAIC3           Company Number
     C                     KFLD           FNC4NB           Order Number
     C                     KFLD           FNDPNB           Order Sequence
     C                     KFLD           FNUENB           Order Secondary
     C                     KFLD           FNRZNB           Case Sequence N
     C           KLCHST    CHAIN@FNCPCS              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFNCPL0'MDACP
     C                     MOVEL'@FNCPCS' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKOMFNCPL0               91  *
     C                     GOTO STEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YCRDCS
      * Move non-key fields to @FNCPCS
     C                     Z-ADD#1FOQT    FNFOQT           Case Quantity
     C                     Z-ADD#1R0NB    FNR0NB           Case Weight
     C                     MOVEL#1PMST    FNPMST    P      Inventory Updat
     C                     Z-ADD#1K7DT    FNK7DT           Label Date
     C                     Z-ADD#1PFNX    FNPFNX           PT Serial Numbe
     C                     Z-ADD#1HGCD    FNHGCD           Item Code
     C                     MOVEL#1AJCD    FNAJCD    P      Warehouse Code
     C                     Z-ADD#1ELDT    FNELDT           Production Date
     C                     Z-ADD#1N5WG    FNN5WG           Manifest Gross
     C                     MOVEL#1RZNA    FNRZNA    P      Manifest Lot ID
     C                     Z-ADD#1H5NY    FNH5NY           Manifest Total
     C                     Z-ADD#1H6NY    FNH6NY           Manifest Co-Par
     C                     Z-ADD#1H7NY    FNH7NY           Manifest Pallet
     C                     MOVEL#1GBTX    FNGBTX    P      Manifest Shift
     C                     Z-ADD#1N6WG    FNN6WG           HPB Meter Net G
     C                     Z-ADD#1N7WG    FNN7WG           Manifest Net We
     C                     MOVEL#1GCTX    FNGCTX    P      Manifest Unused
     C                     MOVEL#1GDTX    FNGDTX    P      Manifest Unused
     C                     Z-ADD#1RBDT    FNRBDT           Manifest Unused
     C                     Z-ADD#1ITNY    FNITNY           HPB COA Batch N
     C                     Z-ADD#1IVNY    FNIVNY           HPB Meter Start
     C                     Z-ADD#1IUNY    FNIUNY           HPB Meter Endin
     C                     Z-ADD#1IWNY    FNIWNY           HPB Meter Total
     C                     Z-ADD#1IXNY    FNIXNY           HPB Meter Net W
     C                     Z-ADD#1IYNY    FNIYNY           HPB Density Ref
     C                     MOVEL#1UVST    FNUVST    P      EDI Status 1
     C                     MOVEL#1UWST    FNUWST    P      EDI Status 2
     C                     MOVEL#1UXST    FNUXST    P      EDI Status 3
     C                     MOVEL#1VSST    FNVSST    P      Record Status
     C                     Z-ADD#1AATM    FNAATM           Job Time
     C                     MOVEL#1AYNA    FNAYNA    P      User Id
     C                     MOVEL#1A0NA    FNA0NA    P      Job Name
     C                     Z-ADD#1AXDT    FNAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) FNAATM' defaulted for 'Job Time'.
      * Field '(DB1) FNAYNA' defaulted for 'User Id'.
      * Field '(DB1) FNA0NA' defaulted for 'Job Name'.
      * Field '(DB1) FNAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     FNAATM           Job Time
     C                     MOVEL##USR     FNAYNA           User Id
     C                     MOVEL##JOB     FNA0NA           Job Name
     C                     Z-ADD##JDT     FNAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FNCPCS                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
      * USER: Processing after Data update
     C                     MOVEL'Y'       P3R4ST           USR Update Flag
     C                     MOVEL'Y'       P8RINS           COA RIN Modifie
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0214    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSU     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P4I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P4MPNA           Default Printer
     C                     MOVELDRBCCD    P4BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0049           Company Number
     C                     MOVELDRBUVN    WN0215           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0040    DTAJVN           User Profile Na
     C                     MOVELWL0041    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSV     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0042           Company Number
     C                     MOVELDTAJCD    WL0043           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSW01           Application Cod
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSW01           Application Cod
     C                     MOVEL'OMS'     WQSW01           Application Cod
      * Establish starting position
     C           KRSSW     SETLL@DNRESF                    *
     C           KRSSW     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
     C           KRSSW     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSX01           Application Cod
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSX01           Application Cod
      * Establish starting position
     C           KRSSX     SETLL@DNRESF                    *
     C           KRSSX     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSX     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV2AIC3    WK1X01  1
     C                     MOVELV2C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#2AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#2C4NB'
     C           YPMTFD    OREQ '#2DPNB'
     C           YPMTFD    OREQ '#2UENB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2AIC3' defaulted for 'Company Number'.
      * Field '(CTL) #2C4NB' defaulted for 'Order Number'.
      * Field '(CTL) #2DPNB' defaulted for 'Order Sequence Number'.
      * Field '(CTL) #2UENB' defaulted for 'Order Secondary Line Seq'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #PHGCD' defaulted for 'Item Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0047' defaulted for 'Price Overage Override'.
      * Field '(LCL) YL0048' defaulted for 'Record Selected       USR'.
     C                     CALL 'POKJSRR'              90  Sel Item f/Pric
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0036  30       Company Number
     C           #2C4NB    PARM #2C4NB    WQ0037  70       Order Number
     C           #2DPNB    PARM *ZERO     WQ0038  30       Order Sequence
     C           #2UENB    PARM *ZERO     WQ0039  30       Order Secondary
     C           #PHGCD    PARM #PHGCD    WQ0040  70       Item Code
     C           YL0047    PARM *ZERO     WQ0041 114       Price Overage O
     C           YL0048    PARM YL0048    WQ0042  1        Record Selected
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POKJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2DPNB    IFNE *ZERO                      Order Sequence
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2UENB    IFNE *ZERO                      Order Secondary
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VA999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVAOM    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3
     C                     Z-ADD#2C4NB    OMC4NB
     C                     Z-ADD#2DPNB    OMDPNB
     C                     Z-ADD#2UENB    OMUENB
     C           KLVAOM    CHAIN@BGWKL1              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
     C           VA999     TAG
      * Restrictor relation not satisfied
      * Send message 'Order Detail           NF'
     C                     MOVEL'USR1309' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR1309' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD15        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
      *
     C           YPMRRN    IFGT *ZERO
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
     C                     END
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1RZNB           Case Sequence N
     C                     MOVEL*BLANK    P2AGCD           U/M - Ordered
     C                     MOVEL*BLANK    P2AVST           Catch Weight St
     C                     MOVEL*BLANK    P2FZST           Production Date
     C                     Z-ADD*ZERO     P2AVWG           Unit Weight Ord
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     MOVEL*BLANK    P3GGST           USR Display fie
     C                     MOVEL*BLANK    P3TIST           USR Display 1
     C                     Z-ADD*ZERO     P3MNWT           USR Min Weight
     C                     Z-ADD*ZERO     P3MXWT           USR Max Weight
     C                     MOVEL*BLANK    P3GQST           USR Under Min
     C                     MOVEL*BLANK    P3GSST           USR Over Max
     C                     MOVEL*BLANK    P3TJST           USR Display 2
     C                     MOVEL*BLANK    P4DNCD           Application Cod
     C                     MOVEL*BLANK    P4BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P4B8NA           System Date For
     C                     MOVEL*BLANK    P4I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P4MPNA           Default Printer
     C                     Z-ADD*ZERO     P5AIWG           Unit Weight
     C                     Z-ADD*ZERO     P5CZWG           Minimum Weight
     C                     Z-ADD*ZERO     P5C0WG           Maximum Weight
     C                     MOVEL*BLANK    P6STYN           USR Exit Progra
     C                     MOVEL*BLANK    P8RINS           COA RIN Modifie
     C                     MOVEL*BLANK    P9Q1ST           Status Flag 1
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Catch Weight Status
     C                     MOVEL*BLANK    WUAVST  1
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field U/M - Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Define work field Item Level
     C                     MOVEL*BLANK    WURBCD  2
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Default Commod Mark basis
     C                     MOVEL*BLANK    WULNCD  3
      * Define work field Transportation Temp
     C                     Z-ADD*ZERO     WUTFNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Commodity Price Group
     C                     MOVEL*BLANK    WULRCD  7
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Price Method Default
     C                     MOVEL*BLANK    WUQ8CD  3
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Item Target Price
     C                     Z-ADD*ZERO     WUF5WG 112
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Case Sequence Number
     C                     Z-ADD*ZERO     WURZNB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WARZNB           Case Sequence N
     C                     Z-ADD*ZERO     WAFOQT           Case Quantity
     C                     Z-ADD*ZERO     WAR0NB           Case Weight
     C                     Z-ADD*ZERO     WAK7DT           Label Date
     C                     Z-ADD*ZERO     WAPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAELDT           Production Date
     C                     Z-ADD*ZERO     WAN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WAH5NY           Manifest Total
     C                     Z-ADD*ZERO     WAH6NY           Manifest Co-Par
     C                     Z-ADD*ZERO     WAH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WAN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WAN7WG           Manifest Net We
     C                     Z-ADD*ZERO     WARBDT           Manifest Unused
     C                     Z-ADD*ZERO     WAITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WAIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WAIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WAIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WAIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WAIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field HPB Temperature Adjustmnt
     C                     Z-ADD*ZERO     WUJSNY  96
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field COA Temp Conv Factor 1
     C                     Z-ADD*ZERO     WUJQNY 118
      * Define work field COA Temp Conv Factor 2
     C                     Z-ADD*ZERO     WUJRNY 118
      * Define work field Quantity 7.0 USR
     C                     Z-ADD*ZERO     WUTQTC  70
      * Define work field COA Density Ref Adj 4 dec
     C                     Z-ADD*ZERO     WULRNY  64
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WBI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WBJYNY           COA Batch Heade
     C                     Z-ADD*ZERO     WBQ1NY           COA Batch Hdr R
     C                     Z-ADD*ZERO     WBN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WBRCNY           COA Batch Compa
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Define work field Work Over/Short Status
     C                     MOVEL*BLANK    WUR0ST  1
      * Define work field Detail Line Status
     C                     MOVEL*BLANK    WUGMST  1
      * Define work field Detail Line Status Last
     C                     MOVEL*BLANK    WUGNST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WCDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WCDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WCDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WCDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WCGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Item Age Days
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WCTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WCTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WDQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WDQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WDQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WDGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WDHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WDHGVL           Transload Termi
     C                     Z-ADD*ZERO     WDQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WDQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WDQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WDQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WDITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WDQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WDQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WDQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WDP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WDQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WDQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WDQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WDQENY           Original Appoin
     C                     Z-ADD*ZERO     WDQFNY           Original Appoin
     C                     Z-ADD*ZERO     WDQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WDQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WDQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WDQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WDW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WDW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WE02 179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WE01 179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WE00 179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WC00 175       *Synon (17,5) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  3
     C                     MOVEL*BLANK    WL0003  1
     C                     MOVEL*BLANK    WL0004  1
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0005  41
     C                     Z-ADD*ZERO     WL0006  41
     C                     Z-ADD*ZERO     WL0007  54
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  50
     C                     Z-ADD*ZERO     WL0014 112
     C                     MOVEL*BLANK    WL0015  1
     C                     MOVEL*BLANK    WL0016  1
     C                     MOVEL*BLANK    WL0017  1
      * Define local variables for subroutine SOCHRC.
     C                     Z-ADD*ZERO     WL0018  30
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  30
     C                     Z-ADD*ZERO     WL0021  30
     C                     MOVEL*BLANK    WL0022  1
     C                     MOVEL*BLANK    WL0023  1
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     Z-ADD*ZERO     WL0026 112
     C                     Z-ADD*ZERO     WL0027 112
     C                     Z-ADD*ZERO     WL0028  70
     C                     Z-ADD*ZERO     WL0029  70
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0033  30
     C                     Z-ADD*ZERO     WL0034  70
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036  50
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0037  70
     C                     Z-ADD*ZERO     WL0038  50
     C                     Z-ADD*ZERO     WL0039  70
      * Define local variables for subroutine SVRVGN.
     C                     MOVEL*BLANK    WL0040 10
     C                     MOVEL*BLANK    WL0041  6
     C                     Z-ADD*ZERO     WL0042  30
     C                     MOVEL*BLANK    WL0043  3
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field COA Temperature Loadout
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field RFS Loadout Temperature
     C                     Z-ADD*ZERO     YL0005  41
      * Define local work field RFS API Vol Corr Factor
     C                     Z-ADD*ZERO     YL0006  54
      * Define local work field COA Batch RIN
     C                     MOVEL*BLANK    YL0007 38
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field RFS Volume Corr Mthd  USR
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field COA Density Loadout
     C                     Z-ADD*ZERO     YL0010  75
      * Define local work field USR Update Flag
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field COA RIN Modified Sts
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Case Quantity
     C                     Z-ADD*ZERO     YL0013  50
      * Define local work field Case Weight
     C                     Z-ADD*ZERO     YL0014 112
      * Define local work field USR Under Min
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field USR Over Max
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field USR Exit Program
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0018  3
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field Stop/Drop Sequence Number
     C                     Z-ADD*ZERO     YL0021  50
      * Define local work field OHE Carrier SCAC Code
     C                     MOVEL*BLANK    YL0022  4
      * Define local work field OHE Spot Buy
     C                     MOVEL*BLANK    YL0023  4
      * Define local work field OHE PO ACK Flag
     C                     MOVEL*BLANK    YL0024  4
      * Define local work field OHE Override Type Code
     C                     MOVEL*BLANK    YL0025  2
      * Define local work field OHE Backhaul Status
     C                     MOVEL*BLANK    YL0026  2
      * Define local work field OHE Backhaul ETA AM/PM
     C                     MOVEL*BLANK    YL0027  2
      * Define local work field OHE Load Haul Type
     C                     MOVEL*BLANK    YL0028  3
      * Define local work field OHE Backhaul Carrier Code
     C                     MOVEL*BLANK    YL0029  3
      * Define local work field OHE Bookings Confirmed
     C                     MOVEL*BLANK    YL0030  3
      * Define local work field OHE EDI Error Reasons
     C                     MOVEL*BLANK    YL0031  5
      * Define local work field OHE EDI Error Reasons 2
     C                     MOVEL*BLANK    YL0032  5
      * Define local work field OHE EDI 943 Action
     C                     MOVEL*BLANK    YL0033  6
      * Define local work field OHE EDI 944 Action
     C                     MOVEL*BLANK    YL0034  6
      * Define local work field OHE EDI 940 Action
     C                     MOVEL*BLANK    YL0035  6
      * Define local work field OHE EDI 945 Action
     C                     MOVEL*BLANK    YL0036  6
      * Define local work field OHE EDI 856 Action
     C                     MOVEL*BLANK    YL0037  1
      * Define local work field OHE EDI 824 Action
     C                     MOVEL*BLANK    YL0038  1
      * Define local work field OHE Email BOL/Sent
     C                     MOVEL*BLANK    YL0039  1
      * Define local work field OHE Unused Status 2
     C                     MOVEL*BLANK    YL0040  1
      * Define local work field OHE Unused Status 3
     C                     MOVEL*BLANK    YL0041  2
      * Define local work field OHE Unused Status 4
     C                     MOVEL*BLANK    YL0042  2
      * Define local work field EDI Status 1
     C                     MOVEL*BLANK    YL0043  1
      * Define local work field EDI Status 2
     C                     MOVEL*BLANK    YL0044  1
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0045  1
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0046  70
      * Define local work field Price Overage Override
     C                     Z-ADD*ZERO     YL0047 114
      * Define local work field Record Selected       USR
     C                     MOVEL*BLANK    YL0048  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0049  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0050  3
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      *
     C                     Z-ADD07        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0214 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0214           User Profile Na
      *
     C                     MOVEL*BLANK    WN0215 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SURVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0214    ZA0007           User Profile Na
     C                     MOVEL'OMS'     ZA0008           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0215    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0214    WL0040    P      User Profile Na
     C                     MOVEL'OMS'     WL0041    P      Application Cod
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0042    WUAIC3           Company Number
     C                     MOVELWL0043    YL0050    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0215    WL0040    P      User Profile Na
     C                     MOVEL'OMS'     WL0041    P      Application Cod
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0042    WUAIC3           Company Number
     C                     MOVELWL0043    YL0050    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0050    WUAJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0214    ZA0009           User Profile Na
     C                     MOVEL'OMS'     ZA0010           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0049    IFNE 0                          *IF
     C                     Z-ADDYL0049    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0050    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           WUAJCD    PARM *BLANK    WQ0043  3        Warehouse Code
     C                     PARM YL0049    WQ0044  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SWRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     Z-ADD*ZERO     P3FYQT           USR Case Quanti
     C                     Z-ADD*ZERO     P3ZPNB           USR Case Weight
     C                     MOVEL'Y'       P3GGST           USR Display fie
     C                     MOVEL'Y'       P3TIST           USR Display 1
     C                     MOVEL'Y'       P3TJST           USR Display 2
     C                     MOVEL'A'       YL0009           RFS Volume Corr
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
