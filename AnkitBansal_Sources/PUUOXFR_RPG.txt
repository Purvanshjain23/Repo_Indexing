     H/TITLE Cnv Upd Sls Route Info XF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 11/02/21  Time  : 17:04:00
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     Fshp253    uf   e           k disk
     FOMFJCPMA  IF   E           K DISK
      * RSQ : Load Header             JobDte/Ld Invoiced  -COG
      *
     FOMFLCPL2  IF   E           K DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOPBFCPLG  IF   E           K DISK
      * RSQ : Order Header TRG          Load Id/Order Num
      *
     FPDJEREL1  IF   E           K DISK
      * RTV : Sales Route               Retrieval index
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  WQSB02         S                   LIKE(WBRMNB)
     D  YL0001         S              7  0
     D  YL0002         S              3
     D  WQSC02         S                   LIKE(WCRMNB)
     D  WQSC03         S                   LIKE(WCC4NB)
     D  YL0003         S             30
     D  W0PMT          S              1
     D k_CoOrg         s              1    inz('S')
     D k_LoadID        s              7  0
     D k_StopDrop      s              5  0
     D k_STC           s              8  0
     D w_SlsRoute      s              3
     D w_SlsRouteDsc   s             30
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: Order Detail
      * N : MAP Company Number
     D  P1AIC3                 1      2P 0
      * N : MAP Order Number
     D  P1C4NB                 3      6P 0
      * N : MAP Item Code
     D  P1HGCD                 7     10P 0
      * N : MAP Item Age Days
     D  P1RINY                11     13P 0
     I@FJCPWC
      * Load Header             JobDte/Ld Invoiced  -COG
      * Renamed input format fields
     I              FJRMNB                      WARMNB
     I              FJAIC3                      WAAIC3
     I              FJAODT                      WAAODT
     I              FJPJST                      WAPJST
     I              FJPKST                      WAPKST
     I              FJRNNB                      WARNNB
     I              FJDMTX                      WADMTX
     I              FJDNTX                      WADNTX
     I              FJDOTX                      WADOTX
     I              FJWTTX                      WAWTTX
     I              FJWUTX                      WAWUTX
     I              FJRPNB                      WARPNB
     I              FJFLAM                      WAFLAM
     I              FJXQST                      WAXQST
     I              FJRRNB                      WARRNB
     I              FJDXTX                      WADXTX
     I              FJDYTX                      WADYTX
     I              FJSBNB                      WASBNB
     I              FJBZNA                      WABZNA
     I              FJRONB                      WARONB
     I              FJSQNB                      WASQNB
     I              FJR1NB                      WAR1NB
     I              FJVCST                      WAVCST
     I              FJVDST                      WAVDST
     I              FJSDNB                      WASDNB
     I              FJPAOU                      WAPAOU
     I              FJDGWG                      WADGWG
     I              FJSXNB                      WASXNB
     I              FJHADT                      WAHADT
     I              FJAART                      WAAART
     I              FJDHWG                      WADHWG
     I              FJDIWG                      WADIWG
     I              FJAQDT                      WAAQDT
     I              FJS6NB                      WAS6NB
     I              FJT4NB                      WAT4NB
     I              FJPRTM                      WAPRTM
     I              FJNPSV                      WANPSV
     I              FJJ8TX                      WAJ8TX
     I              FJTLMI                      WATLMI
     I              FJJ9TX                      WAJ9TX
     I              FJQ2CD                      WAQ2CD
     I              FJVPCD                      WAVPCD
     I              FJDBCD                      WADBCD
     I              FJGRWE                      WAGRWE
     I              FJXCCD                      WAXCCD
     I              FJU2ST                      WAU2ST
     I              FJF9DT                      WAF9DT
     I              FJONTM                      WAONTM
     I              FJJ4DT                      WAJ4DT
     I              FJTRTM                      WATRTM
     I              FJJ5DT                      WAJ5DT
     I              FJSPTM                      WASPTM
     I              FJJ6DT                      WAJ6DT
     I              FJLFTM                      WALFTM
     I              FJJ7DT                      WAJ7DT
     I              FJBOTM                      WABOTM
     I              FJJ8DT                      WAJ8DT
     I              FJBLTM                      WABLTM
     I              FJKIDT                      WAKIDT
     I              FJASTM                      WAASTM
     I              FJKADT                      WAKADT
     I              FJAJCM                      WAAJCM
     I              FJXACD                      WAXACD
     I              FJOANA                      WAOANA
     I              FJK4TX                      WAK4TX
     I              FJVOAG                      WAVOAG
     I              FJKBDT                      WAKBDT
     I              FJNBBO                      WANBBO
     I              FJW4CD                      WAW4CD
     I              FJEFDT                      WAEFDT
     I              FJCNTN                      WACNTN
     I              FJKCDT                      WAKCDT
     I              FJTMIN                      WATMIN
     I              FJKDDT                      WAKDDT
     I              FJVMNB                      WAVMNB
     I              FJOCFR                      WAOCFR
     I              FJKJDT                      WAKJDT
     I              FJATTM                      WAATTM
     I              FJOTRS                      WAOTRS
     I              FJRNST                      WARNST
     I              FJBRBK                      WABRBK
     I              FJEIDT                      WAEIDT
     I              FJRMST                      WARMST
     I              FJAJCD                      WAAJCD
     I              FJKKDT                      WAKKDT
     I              FJAVTM                      WAAVTM
     I              FJKZDT                      WAKZDT
     I              FJAXTM                      WAAXTM
     I              FJLHOS                      WALHOS
     I              FJLHOR                      WALHOR
     I              FJWNTX                      WAWNTX
     I              FJOITX                      WAOITX
     I              FJOJTX                      WAOJTX
     I              FJLLDT                      WALLDT
     I              FJLSHG                      WALSHG
     I              FJYPST                      WAYPST
     I              FJK0DT                      WAK0DT
     I              FJAYTM                      WAAYTM
     I              FJKNNX                      WAKNNX
     I              FJICWG                      WAICWG
     I              FJIDWG                      WAIDWG
     I              FJH9SX                      WAH9SX
     I              FJWOTX                      WAWOTX
     I              FJK1DT                      WAK1DT
     I              FJAZTM                      WAAZTM
     I              FJK2DT                      WAK2DT
     I              FJA0TM                      WAA0TM
     I              FJROST                      WAROST
     I              FJRPST                      WARPST
     I              FJRQST                      WARQST
     I              FJRRST                      WARRST
     I              FJZBVA                      WAZBVA
     I              FJWPTX                      WAWPTX
     I              FJWQTX                      WAWQTX
     I              FJWRTX                      WAWRTX
     I              FJWSTX                      WAWSTX
     I              FJRVSX                      WARVSX
     I              FJRUSX                      WARUSX
     I              FJRWSX                      WARWSX
     I              FJRXSX                      WARXSX
     I              FJRYSX                      WARYSX
     I              FJRZSX                      WARZSX
     I              FJR0SX                      WAR0SX
     I              FJR1SX                      WAR1SX
     I              FJR2SX                      WAR2SX
     I              FJR3SX                      WAR3SX
     I              FJR4SX                      WAR4SX
     I              FJPYDT                      WAPYDT
     I              FJCKTM                      WACKTM
     I              FJPZDT                      WAPZDT
     I              FJCLTM                      WACLTM
     I              FJP0DT                      WAP0DT
     I              FJCMTM                      WACMTM
     I              FJP1DT                      WAP1DT
     I              FJCNTM                      WACNTM
     I              FJP2DT                      WAP2DT
     I              FJCOTM                      WACOTM
     I              FJP3DT                      WAP3DT
     I              FJCQTM                      WACQTM
     I              FJUVST                      WAUVST
     I              FJUWST                      WAUWST
     I              FJUXST                      WAUXST
     I              FJAATM                      WAAATM
     I              FJAYNA                      WAAYNA
     I              FJA0NA                      WAA0NA
     I              FJAXDT                      WAAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                      WBRMNB
     I              FLRUNB                      WBRUNB
     I              FLRVNB                      WBRVNB
     I              FLDQTX                      WBDQTX
     I              FLRWNB                      WBRWNB
     I              FLRXNB                      WBRXNB
     I              FLSQNB                      WBSQNB
     I              FLT0NB                      WBT0NB
     I              FLT1NB                      WBT1NB
     I              FLR1NB                      WBR1NB
     I              FLAIC3                      WBAIC3
     I              FLC4NB                      WBC4NB
     I              FLVCST                      WBVCST
     I              FLKEDT                      WBKEDT
     I              FLSXNB                      WBSXNB
     I              FLKFDT                      WBKFDT
     I              FLACTM                      WBACTM
     I              FLK5TX                      WBK5TX
     I              FLW5CD                      WBW5CD
     I              FLEJDT                      WBEJDT
     I              FLAGTM                      WBAGTM
     I              FLKJDT                      WBKJDT
     I              FLATTM                      WBATTM
     I              FLHDDT                      WBHDDT
     I              FLAUTM                      WBAUTM
     I              FLKKDT                      WBKKDT
     I              FLAVTM                      WBAVTM
     I              FLZ4NB                      WBZ4NB
     I              FLY7ST                      WBY7ST
     I              FLY2ST                      WBY2ST
     I              FLWHTX                      WBWHTX
     I              FLWITX                      WBWITX
     I              FLWJTX                      WBWJTX
     I              FLWKTX                      WBWKTX
     I              FLWLTX                      WBWLTX
     I              FLN7DT                      WBN7DT
     I              FLN8DT                      WBN8DT
     I              FLN9DT                      WBN9DT
     I              FLB3TM                      WBB3TM
     I              FLB4TM                      WBB4TM
     I              FLB5TM                      WBB5TM
     I              FLIASX                      WBIASX
     I              FLIBSX                      WBIBSX
     I              FLICSX                      WBICSX
     I              FLWVTX                      WBWVTX
     I              FLWWTX                      WBWWTX
     I              FLWXTX                      WBWXTX
     I              FLUVST                      WBUVST
     I              FLUWST                      WBUWST
     I              FLUXST                      WBUXST
     I              FLAATM                      WBAATM
     I              FLAYNA                      WBAYNA
     I              FLA0NA                      WBA0NA
     I              FLAXDT                      WBAXDT
      *
     I@BFCPRQ
      * Order Header TRG          Load Id/Order Num
      * Renamed input format fields
     I              BEAIC3                      WCAIC3
     I              BEC4NB                      WCC4NB
     I              BEJNCD                      WCJNCD
     I              BEANC7                      WCANC7
     I              BEBKC7                      WCBKC7
     I              BEBRTX                      WCBRTX
     I              BEHMNA                      WCHMNA
     I              BEHONA                      WCHONA
     I              BEHPNA                      WCHPNA
     I              BEHNNA                      WCHNNA
     I              BEDBCD                      WCDBCD
     I              BECKTX                      WCCKTX
     I              BEB0C7                      WCB0C7
     I              BEAETX                      WCAETX
     I              BEB1NA                      WCB1NA
     I              BEB3NA                      WCB3NA
     I              BEB4NA                      WCB4NA
     I              BEB2NA                      WCB2NA
     I              BEBHCD                      WCBHCD
     I              BEC8TX                      WCC8TX
     I              BEBCNA                      WCBCNA
     I              BEA0DT                      WCA0DT
     I              BEA5DT                      WCA5DT
     I              BEGNDT                      WCGNDT
     I              BEACDT                      WCACDT
     I              BEAQCD                      WCAQCD
     I              BEB6NA                      WCB6NA
     I              BEBYNA                      WCBYNA
     I              BEBZNA                      WCBZNA
     I              BEGTST                      WCGTST
     I              BEGVST                      WCGVST
     I              BEGUST                      WCGUST
     I              BEQFST                      WCQFST
     I              BECQCD                      WCCQCD
     I              BEGJST                      WCGJST
     I              BEGWST                      WCGWST
     I              BEGXST                      WCGXST
     I              BEGYST                      WCGYST
     I              BEAODT                      WCAODT
     I              BEAIVN                      WCAIVN
     I              BECXDT                      WCCXDT
     I              BEJZVA                      WCJZVA
     I              BEA1WG                      WCA1WG
     I              BEXIST                      WCXIST
     I              BEXJST                      WCXJST
     I              BEXKST                      WCXKST
     I              BEEIDT                      WCEIDT
     I              BEAFTM                      WCAFTM
     I              BEE8CD                      WCE8CD
     I              BEE9CD                      WCE9CD
     I              BERMNB                      WCRMNB
     I              BETBNB                      WCTBNB
     I              BER1NB                      WCR1NB
     I              BEPJST                      WCPJST
     I              BEU0ST                      WCU0ST
     I              BEU1ST                      WCU1ST
     I              BEQ2CD                      WCQ2CD
     I              BEU2ST                      WCU2ST
     I              BEVEST                      WCVEST
     I              BEVFST                      WCVFST
     I              BEVGST                      WCVGST
     I              BERPCD                      WCRPCD
     I              BERNNB                      WCRNNB
     I              BEVDST                      WCVDST
     I              BEATIN                      WCATIN
     I              BEU4ST                      WCU4ST
     I              BEU5ST                      WCU5ST
     I              BERSRN                      WCRSRN
     I              BEMHNA                      WCMHNA
     I              BEMINA                      WCMINA
     I              BEWBST                      WCWBST
     I              BER4CD                      WCR4CD
     I              BEBFCD                      WCBFCD
     I              BEQ4CD                      WCQ4CD
     I              BET3NB                      WCT3NB
     I              BESICD                      WCSICD
     I              BECONB                      WCCONB
     I              BECEST                      WCCEST
     I              BEAWDT                      WCAWDT
     I              BEJPCD                      WCJPCD
     I              BEXUST                      WCXUST
     I              BEZ1ST                      WCZ1ST
     I              BEVRVA                      WCVRVA
     I              BEOBST                      WCOBST
     I              BEBCST                      WCBCST
     I              BEBDST                      WCBDST
     I              BEB7VL                      WCB7VL
     I              BEGASX                      WCGASX
     I              BEGBSX                      WCGBSX
     I              BEGCSX                      WCGCSX
     I              BEGDSX                      WCGDSX
     I              BEFNSX                      WCFNSX
     I              BEFOSX                      WCFOSX
     I              BEFPSX                      WCFPSX
     I              BEFQSX                      WCFQSX
     I              BEFRSX                      WCFRSX
     I              BEFSSX                      WCFSSX
     I              BEFTSX                      WCFTSX
     I              BEFUSX                      WCFUSX
     I              BEFVSX                      WCFVSX
     I              BEFWSX                      WCFWSX
     I              BEFXSX                      WCFXSX
     I              BEFYSX                      WCFYSX
     I              BENODT                      WCNODT
     I              BENPDT                      WCNPDT
     I              BENQDT                      WCNQDT
     I              BENRDT                      WCNRDT
     I              BENSDT                      WCNSDT
     I              BEBPTM                      WCBPTM
     I              BEBQTM                      WCBQTM
     I              BEBRTM                      WCBRTM
     I              BEBSTM                      WCBSTM
     I              BEBTTM                      WCBTTM
     I              BEH0NX                      WCH0NX
     I              BEH1NX                      WCH1NX
     I              BEH2NX                      WCH2NX
     I              BEH3NX                      WCH3NX
     I              BEH4NX                      WCH4NX
     I              BEC0C7                      WCC0C7
     I              BEUVST                      WCUVST
     I              BEUWST                      WCUWST
     I              BEUXST                      WCUXST
     I              BEAATM                      WCAATM
     I              BEAYNA                      WCAYNA
     I              BEA0NA                      WCA0NA
     I              BEAXDT                      WCAXDT
      *
     I@JEREWF
      * Sales Route               Retrieval index
      * Renamed input format fields
     I              JER4CD                      WDR4CD
     I              JEMZNA                      WDMZNA
     I              JEBCCD                      WDBCCD
     I              JEBFCD                      WDBFCD
     I              JEQ4CD                      WDQ4CD
     I              JEWOST                      WDWOST
     I              JER8CD                      WDR8CD
     I              JEUVST                      WDUVST
     I              JEUWST                      WDUWST
     I              JEUXST                      WDUXST
     I              JEVSST                      WDVSST
     I              JEAATM                      WDAATM
     I              JEAYNA                      WDAYNA
     I              JEA0NA                      WDA0NA
     I              JEAXDT                      WDAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Cnv Upd Sls Route Info XF
      * Cnv SHP253 File Spec  US - /UT User Source  * 
      *
      *
      * Access Path SELECTS only 'I'nvoiced Loads Only.
      * Cnv Upd Sls Route Info RT - Load Header  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Cnv Upd Sls Route Info RT - Load Header  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KPSSA         KLIST
     C                   KFLD                    WAAXDT                         Job Date
      * Setup key
     C                   Z-ADD     1200101       WAAXDT                         Job Date
      * Establish starting position
     C     KPSSA         SETLL     @FJCPWC                                      *
     C                   READ      @FJCPWC                                90    *
      * Data record not found
     C   90              MOVEL     'USR1188'     W0RTN
      * USER: Process Data record
      * Cnv Upd Sls Route Info RT - Load Detail  * 
     C                   DOW       NOT *IN90
     C                   EXSR      SBRVGN
     C                   READ      @FJCPWC                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Cnv Upd Sls Route Info RT - Load Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WQSB02                         Load ID
      * Setup key
     C                   Z-ADD     WARMNB        WQSB02                         Load ID
      * Establish starting position
     C     KRSSB         SETLL     @FLCPEB                                      *
     C     KRSSB         READE     @FLCPEB                                90    *
      * Data record not found
     C   90              MOVEL     'USR1192'     W0RTN
      * USER: Process Data record
      * Rtv STC/Sales Route   RT - Order Header TRG  * 
     C                   DOW       NOT *IN90
     C                   EXSR      SCRVGN
      * RTV Description        RT - Sales Route  * 
     C                   EXSR      SDRVGN
      * CASE: PGM.*Return code is *Normal
      * Cnv SHP253 Upd Sls Rte US - /UT User Source  * 
     C                   IF        W0RTN = ' '
      *
      *
      *
     C                   eval      k_LoadID = WBRMNB                            Load ID
     C                   eval      k_StopDrop = WBRVNB                          Stop/Drop
     C                   eval      k_STC = YL0001                               Ship To Cust
     C                   eval      w_SlsRoute = YL0002                          Sls Route
     C                   eval      w_SlsRouteDsc = YL0003                       Sls Route Dsc
      *
     C     key01         klist
     C                   kfld                    k_CoOrg                        Co Org
     C                   kfld                    k_LoadID                       Load ID
     C                   kfld                    k_StopDrop                     Stop/Drop
     C                   kfld                    k_STC                          Ship To Cust
      *
     C**   key01         setll     SHP253
     C**                 dou       *in91 = *on                                  Do load detail
     C**   key01         reade     SHP253                                 91
     C**                 if        *in91 = *off                                 If not eof
     C     key01         chain     SHP253
     C                   if        %Found(SHP253)
      *
      * If Sales Route is Blank then Proceed to Update.
     C                   if        LSSRCD = *Blank
     C                   eval      LSSRCD = w_SlsRoute                          Sls Route
     C                   eval      LSSLSRTNM = w_SlsRouteDsc                    Sls Route Dsc
      *
     C                   update    LSREC
      *
     C                   endif
      *
     C                   endif
      *
     C                   END                                                    *FI
     C     KRSSB         READE     @FLCPEB                                90    *
     C                   ENDDO
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * Rtv STC/Sales Route   RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   Z-ADD     *ZERO         YL0001                         Ship To Custome
     C                   EVAL      YL0002 = ' '                                 Sales Route Cod
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSC         KLIST
     C                   KFLD                    WQSC02                         Load ID
     C                   KFLD                    WQSC03                         Order Number
      * Setup key
     C                   Z-ADD     WBRMNB        WQSC02                         Load ID
     C                   Z-ADD     WBC4NB        WQSC03                         Order Number
      * Establish starting position
     C     KRSSC         SETLL     @BFCPRQ                                      *
     C     KRSSC         READE     @BFCPRQ                                90    *
      * Data record not found
     C   90              MOVEL     'USR0176'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   DOW       NOT *IN90
     C                   Z-ADD     WCBKC7        YL0001                         Ship To Custome
     C                   MOVEL     WCR4CD        YL0002                         Sales Route Cod
     C     KRSSC         READE     @BFCPRQ                                90    *
     C                   ENDDO
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * RTV Description        RT - Sales Route  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSD         KLIST
     C                   KFLD                    WDR4CD                         Sales Route Cod
      * Setup key
     C                   MOVEL     YL0002        WDR4CD                         Sales Route Cod
      * Establish starting position
     C     KRSSD         CHAIN     @JEREWF                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1800'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0003 = ' '                                 Sales Route Des
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WDMZNA        YL0003                         Sales Route Des
     C                   ENDIF
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Clear all neither parameters
     C                   Z-ADD     *ZERO         P1AIC3                         Company Number
     C                   Z-ADD     *ZERO         P1C4NB                         Order Number
     C                   Z-ADD     *ZERO         P1HGCD                         Item Code
     C                   Z-ADD     *ZERO         P1RINY                         Item Age Days
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WARMNB                         Load ID
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WARNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WARPNB                         Total Load Orde
     C                   Z-ADD     *ZERO         WAFLAM                         Flat Amount
     C                   Z-ADD     *ZERO         WARRNB                         Total Stops
     C                   Z-ADD     *ZERO         WASBNB                         BOL Time
     C                   Z-ADD     *ZERO         WASQNB                         Ld Hdr/Ld Dtl U
     C                   Z-ADD     *ZERO         WAR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WASDNB                         Number Pallets
     C                   Z-ADD     *ZERO         WAPAOU                         Number Pallets
     C                   Z-ADD     *ZERO         WADGWG                         Load Carrier Pa
     C                   Z-ADD     *ZERO         WASXNB                         Estimated Arriv
     C                   Z-ADD     *ZERO         WAHADT                         Actual Arrival
     C                   Z-ADD     *ZERO         WAAART                         Actual Arrival
     C                   Z-ADD     *ZERO         WADHWG                         Trailer IN Weig
     C                   Z-ADD     *ZERO         WADIWG                         Trailer OUT Wei
     C                   Z-ADD     *ZERO         WAAQDT                         Actual Departur
     C                   Z-ADD     *ZERO         WAS6NB                         Departure Time
     C                   Z-ADD     *ZERO         WAT4NB                         Schedule Sequen
     C                   Z-ADD     *ZERO         WAPRTM                         Product Tempera
     C                   Z-ADD     *ZERO         WANPSV                         Number Spacers
     C                   Z-ADD     *ZERO         WATLMI                         Total Load Mile
     C                   Z-ADD     *ZERO         WAGRWE                         Gross Weight
     C                   Z-ADD     *ZERO         WAF9DT                         Actual Ship Dat
     C                   Z-ADD     *ZERO         WAJ4DT                         Truck Ready Dat
     C                   Z-ADD     *ZERO         WATRTM                         Truck Ready Tim
     C                   Z-ADD     *ZERO         WAJ5DT                         Spotted Date
     C                   Z-ADD     *ZERO         WASPTM                         Spotted Time
     C                   Z-ADD     *ZERO         WAJ6DT                         Load Finished D
     C                   Z-ADD     *ZERO         WALFTM                         Load Finished T
     C                   Z-ADD     *ZERO         WAJ7DT                         BOL Complete Da
     C                   Z-ADD     *ZERO         WABOTM                         BOL Complete Ti
     C                   Z-ADD     *ZERO         WAJ8DT                         BOL Received Da
     C                   Z-ADD     *ZERO         WABLTM                         BOL Received Ti
     C                   Z-ADD     *ZERO         WAKIDT                         Truck Departure
     C                   Z-ADD     *ZERO         WAASTM                         Truck Departure
     C                   Z-ADD     *ZERO         WAKADT                         Adjusted Depart
     C                   Z-ADD     *ZERO         WAAJCM                         Adjusted Depart
     C                   Z-ADD     *ZERO         WAVOAG                         Voyage
     C                   Z-ADD     *ZERO         WAKBDT                         Sail Date
     C                   Z-ADD     *ZERO         WAEFDT                         Arrival Date
     C                   Z-ADD     *ZERO         WAKCDT                         Date In
     C                   Z-ADD     *ZERO         WATMIN                         Time In
     C                   Z-ADD     *ZERO         WAKDDT                         Date Out
     C                   Z-ADD     *ZERO         WAVMNB                         Time Out
     C                   Z-ADD     *ZERO         WAOCFR                         Load Total Frei
     C                   Z-ADD     *ZERO         WAKJDT                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WAATTM                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WABRBK                         Bring Back Mile
     C                   Z-ADD     *ZERO         WAEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WAKKDT                         On Yard Date
     C                   Z-ADD     *ZERO         WAAVTM                         On Yard Time
     C                   Z-ADD     *ZERO         WAKZDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WAAXTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WALLDT                         Express Mail Da
     C                   Z-ADD     *ZERO         WAK0DT                         Product Complet
     C                   Z-ADD     *ZERO         WAAYTM                         Product Complet
     C                   Z-ADD     *ZERO         WAKNNX                         Pallets Loaded
     C                   Z-ADD     *ZERO         WAICWG                         Avg Pallet Tare
     C                   Z-ADD     *ZERO         WAIDWG                         Tot Pallet Tare
     C                   Z-ADD     *ZERO         WAK1DT                         Load Confirmati
     C                   Z-ADD     *ZERO         WAAZTM                         Load Door 1
     C                   Z-ADD     *ZERO         WAK2DT                         Override Total
     C                   Z-ADD     *ZERO         WAA0TM                         Load Door 2
     C                   Z-ADD     *ZERO         WAZBVA                         Load Actual Fre
     C                   Z-ADD     *ZERO         WAPYDT                         LH Carrier Paid
     C                   Z-ADD     *ZERO         WACKTM                         LH Carrier Paid
     C                   Z-ADD     *ZERO         WAPZDT                         LH Last Combo P
     C                   Z-ADD     *ZERO         WACLTM                         LH Last Combo P
     C                   Z-ADD     *ZERO         WAP0DT                         LPT Load Plan S
     C                   Z-ADD     *ZERO         WACMTM                         LPT Load Plan S
     C                   Z-ADD     *ZERO         WAP1DT                         TPM Planned Shi
     C                   Z-ADD     *ZERO         WACNTM                         LH Unused Time
     C                   Z-ADD     *ZERO         WAP2DT                         LH Unused Date
     C                   Z-ADD     *ZERO         WACOTM                         LH Unused Time
     C                   Z-ADD     *ZERO         WAP3DT                         LH Unused Date
     C                   Z-ADD     *ZERO         WACQTM                         LH Unused Time
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBRMNB                         Load ID
     C                   Z-ADD     *ZERO         WBRUNB                         Stop/Drop Seque
     C                   Z-ADD     *ZERO         WBRVNB                         Stop/Drop
     C                   Z-ADD     *ZERO         WBRWNB                         Miles to next s
     C                   Z-ADD     *ZERO         WBRXNB                         Freight Charge
     C                   Z-ADD     *ZERO         WBSQNB                         Ld Hdr/Ld Dtl U
     C                   Z-ADD     *ZERO         WBT0NB                         Freight Misc. C
     C                   Z-ADD     *ZERO         WBT1NB                         Freight Stop Ch
     C                   Z-ADD     *ZERO         WBR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WBAIC3                         Company Number
     C                   Z-ADD     *ZERO         WBC4NB                         Order Number
     C                   Z-ADD     *ZERO         WBKEDT                         Estimated Arriv
     C                   Z-ADD     *ZERO         WBSXNB                         Estimated Arriv
     C                   Z-ADD     *ZERO         WBKFDT                         Appointment Con
     C                   Z-ADD     *ZERO         WBACTM                         Appointment Con
     C                   Z-ADD     *ZERO         WBEJDT                         Actual Delivery
     C                   Z-ADD     *ZERO         WBAGTM                         Actual Delivery
     C                   Z-ADD     *ZERO         WBKJDT                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WBATTM                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WBHDDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WBAUTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WBKKDT                         On Yard Date
     C                   Z-ADD     *ZERO         WBAVTM                         On Yard Time
     C                   Z-ADD     *ZERO         WBZ4NB                         MPC Number
     C                   Z-ADD     *ZERO         WBN7DT                         LD Carrier Appt
     C                   Z-ADD     *ZERO         WBN8DT                         LD Unused Date
     C                   Z-ADD     *ZERO         WBN9DT                         LD Unused Date
     C                   Z-ADD     *ZERO         WBB3TM                         LD Carrier Appt
     C                   Z-ADD     *ZERO         WBB4TM                         LD Unused Time
     C                   Z-ADD     *ZERO         WBB5TM                         LD Unused Time
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCAIC3                         Company Number
     C                   Z-ADD     *ZERO         WCC4NB                         Order Number
     C                   Z-ADD     *ZERO         WCANC7                         A/R Customer Nu
     C                   Z-ADD     *ZERO         WCBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WCB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WCA0DT                         Order Date
     C                   Z-ADD     *ZERO         WCA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WCGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WCACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WCAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WCCXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WCJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         WCA1WG                         Order Weight To
     C                   Z-ADD     *ZERO         WCEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WCAFTM                         Requested Deliv
     C                   Z-ADD     *ZERO         WCRMNB                         Load ID
     C                   Z-ADD     *ZERO         WCTBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WCR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WCRNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WCATIN                         Attach to Invoi
     C                   Z-ADD     *ZERO         WCRSRN                         Resell Referenc
     C                   Z-ADD     *ZERO         WCT3NB                         Attach to Order
     C                   Z-ADD     *ZERO         WCCONB                         Invoice Number
     C                   Z-ADD     *ZERO         WCAWDT                         Invoice Date
     C                   Z-ADD     *ZERO         WCVRVA                         A/R order Value
     C                   Z-ADD     *ZERO         WCB7VL                         Invoice Order V
     C                   Z-ADD     *ZERO         WCNODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WCNPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WCNQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         WCNRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         WCNSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         WCBPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         WCBQTM                         Time of Origina
     C                   Z-ADD     *ZERO         WCBRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WCBSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         WCBTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         WCH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         WCH1NX                         Act Non-Ref Frt
     C                   Z-ADD     *ZERO         WCH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WCH3NX                         OH Total Non-Re
     C                   Z-ADD     *ZERO         WCH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WCC0C7                         Claim Number
     C                   Z-ADD     *ZERO         WCAATM                         Job Time
     C                   Z-ADD     *ZERO         WCAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WDAATM                         Job Time
     C                   Z-ADD     *ZERO         WDAXDT                         Job Date
     C                   MOVEL     'N'           W0PMT
      * Define local work field Ship To Customer
     C                   Z-ADD     *ZERO         YL0001
      * Define local work field Sales Route Code
     C                   EVAL      YL0002 = ' '
      * Define local work field Sales Route Description
     C                   EVAL      YL0003 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
