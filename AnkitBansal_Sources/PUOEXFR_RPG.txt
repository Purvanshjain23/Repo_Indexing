     H/TITLE Exc Upd CIR 2 Product XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 02/18/25  Time  : 10:31:35
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FECP004L6IF  E           K        DISK
      * RSQ : EDI Purchase Order Header Order Date (desc)
      *
     FECP004L1IF  E           K        DISK
      * RTV : EDI Purchase Order Header Retrieval index
      *
     FECP006L1IF  E           K        DISK
      * RTV : EDI Purchase Order Name   Retrieval index
      *
     FPDNERELBIF  E           K        DISK
      * RSQ : Customer EXT              EDI Duns/ShpTo
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer Master           Retrieval index       NV
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FECP005L3IF  E           K        DISK
      * RSQ : EDI Purchase Order Detail ST02-TRANS SET Ctl/Seq
      *
     FPOBIREL1IF  E           K        DISK
      * RTV : Customer Item Reference   Retrieval index
      *
     FPOBIREL2IF  E           K        DISK
      * RSQ : Customer Item Reference   Ship to, CIR Resource
      *
     FPUBQREL1IF  E           K        DISK
      * RTV : Customer Item Ref for EDI Retrieval index
      *
     FPUBQREL0UF  E           K        DISK                      A
      * UPD : Customer Item Ref for EDI Update index
      *
     FPOBIREL0IF  E           K        DISK                      A
      * UPD : Customer Item Reference   Update index
      *
     FPUBSCPL0IF  E           K        DISK                      A
      * UPD : WF EDI PO Detail          Update index
      *
     E                    A1         07  1
     E                    A2         07  1
     I@P004N4
      * EDI Purchase Order Header Order Date (desc)
      * Renamed input format fields
     I              BQTSCN                          WATSCN
     I              BQL3SX                          WAL3SX
     I              BQOSDT                          WAOSDT
     I              BQPONO                          WAPONO
     I              BQDKAA                          WADKAA
     I              BQNAME                          WANAME
     I              BQCQLF                          WACQLF
     I              BQCNUM                          WACNUM
     I              BQINRF                          WAINRF
     I              BQGNTX                          WAGNTX
     I              BQHUAA                          WAHUAA
     I              BQHUVL                          WAHUVL
     I              BQHVAA                          WAHVAA
     I              BQX8T1                          WAX8T1
     I              BQJ2AA                          WAJ2AA
     I              BQT6DT                          WAT6DT
     I              BQQLFX                          WAQLFX
     I              BQDELV                          WADELV
     I              BQSHMT                          WASHMT
     I              BQMTTY                          WAMTTY
     I              BQPLEX                          WAPLEX
     I              BQLDOP                          WALDOP
     I              BQROUT                          WAROUT
     I              BQFOBP                          WAFOBP
     I              BQD3VL                          WAD3VL
     I              BQUNIT                          WAUNIT
     I              BQD4VL                          WAD4VL
     I              BQAMTX                          WAAMTX
     I              BQDSTS                          WADSTS
     I              BQSRAA                          WASRAA
     I              BQBRU1                          WABRU1
     I              BQSSAA                          WASSAA
     I              BQBSU1                          WABSU1
     I              BQSTAA                          WASTAA
     I              BQBTU1                          WABTU1
     I              BQSUAA                          WASUAA
     I              BQBUU1                          WABUU1
     I              BQSVAA                          WASVAA
     I              BQBVU1                          WABVU1
     I              BQSWAA                          WASWAA
     I              BQBWU1                          WABWU1
     I              BQSXAA                          WASXAA
     I              BQBXU1                          WABXU1
     I              BQYDT1                          WAYDT1
     I              BQNLST                          WANLST
     I              BQUFDT                          WAUFDT
     I              BQOJAA                          WAOJAA
     I              BQJ5NX                          WAJ5NX
      *
     I@P004LA
      * EDI Purchase Order Header Retrieval index
      * Renamed input format fields
     I              BQTSCN                          WBTSCN
     I              BQL3SX                          WBL3SX
     I              BQOSDT                          WBOSDT
     I              BQPONO                          WBPONO
     I              BQDKAA                          WBDKAA
     I              BQNAME                          WBNAME
     I              BQCQLF                          WBCQLF
     I              BQCNUM                          WBCNUM
     I              BQINRF                          WBINRF
     I              BQGNTX                          WBGNTX
     I              BQHUAA                          WBHUAA
     I              BQHUVL                          WBHUVL
     I              BQHVAA                          WBHVAA
     I              BQX8T1                          WBX8T1
     I              BQJ2AA                          WBJ2AA
     I              BQT6DT                          WBT6DT
     I              BQQLFX                          WBQLFX
     I              BQDELV                          WBDELV
     I              BQSHMT                          WBSHMT
     I              BQMTTY                          WBMTTY
     I              BQPLEX                          WBPLEX
     I              BQLDOP                          WBLDOP
     I              BQROUT                          WBROUT
     I              BQFOBP                          WBFOBP
     I              BQD3VL                          WBD3VL
     I              BQUNIT                          WBUNIT
     I              BQD4VL                          WBD4VL
     I              BQAMTX                          WBAMTX
     I              BQDSTS                          WBDSTS
     I              BQSRAA                          WBSRAA
     I              BQBRU1                          WBBRU1
     I              BQSSAA                          WBSSAA
     I              BQBSU1                          WBBSU1
     I              BQSTAA                          WBSTAA
     I              BQBTU1                          WBBTU1
     I              BQSUAA                          WBSUAA
     I              BQBUU1                          WBBUU1
     I              BQSVAA                          WBSVAA
     I              BQBVU1                          WBBVU1
     I              BQSWAA                          WBSWAA
     I              BQBWU1                          WBBWU1
     I              BQSXAA                          WBSXAA
     I              BQBXU1                          WBBXU1
     I              BQYDT1                          WBYDT1
     I              BQNLST                          WBNLST
     I              BQUFDT                          WBUFDT
     I              BQOJAA                          WBOJAA
     I              BQJ5NX                          WBJ5NX
      *
     I@P006LC
      * EDI Purchase Order Name   Retrieval index
      * Renamed input format fields
     I              BSTSCN                          WCTSCN
     I              BSTYPC                          WCTYPC
     I              BSAMEX                          WCAMEX
     I              BSDCDQ                          WCDCDQ
     I              BSDCDE                          WCDCDE
     I              BSAME1                          WCAME1
     I              BSAME2                          WCAME2
     I              BSDD1X                          WCDD1X
     I              BSDD2X                          WCDD2X
     I              BSITYX                          WCITYX
     I              BSTATE                          WCTATE
     I              BSIPXX                          WCIPXX
      *
     I@NEREA8
      * Customer EXT              EDI Duns/ShpTo
      * Renamed input format fields
     I              NEBKC7                          WDBKC7
     I              NEUFTX                          WDUFTX
     I              NEUGTX                          WDUGTX
     I              NEPFNA                          WDPFNA
     I              NEJ5NX                          WDJ5NX
     I              NEU5TX                          WDU5TX
     I              NEU6TX                          WDU6TX
     I              NEW0TX                          WDW0TX
     I              NEHSSX                          WDHSSX
     I              NEHUSX                          WDHUSX
     I              NEHVSX                          WDHVSX
     I              NEAAC8                          WDAAC8
     I              NEP0SX                          WDP0SX
     I              NEP1SX                          WDP1SX
     I              NEP2SX                          WDP2SX
     I              NEP3SX                          WDP3SX
     I              NEP4SX                          WDP4SX
     I              NEP5SX                          WDP5SX
     I              NEP6SX                          WDP6SX
     I              NEUVST                          WDUVST
     I              NEUWST                          WDUWST
     I              NEUXST                          WDUXST
     I              NEVSST                          WDVSST
     I              NEAATM                          WDAATM
     I              NEAYNA                          WDAYNA
     I              NEA0NA                          WDA0NA
     I              NEAXDT                          WDAXDT
      *
     I@BBREE9
      * Customer Master           Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WEBKC7
     I              BBAYTX                          WEAYTX
     I              BBACNA                          WEACNA
     I              BBADNA                          WEADNA
     I              BBAENA                          WEAENA
     I              BBAJNA                          WEAJNA
     I              BBBGCD                          WEBGCD
     I              BBG5CD                          WEG5CD
     I              BBBTTX                          WEBTTX
     I              BBBVTX                          WEBVTX
     I              BBBWTX                          WEBWTX
     I              BBABTX                          WEABTX
     I              BBA2NA                          WEA2NA
     I              BBCBST                          WECBST
     I              BBB0NA                          WEB0NA
     I              BBP3NB                          WEP3NB
     I              BBAXNA                          WEAXNA
     I              BBI6DT                          WEI6DT
     I              BBAYDT                          WEAYDT
     I              BBANC7                          WEANC7
     I              BBBTC7                          WEBTC7
     I              BBK6ST                          WEK6ST
     I              BBUZST                          WEUZST
     I              BBKXCD                          WEKXCD
     I              BBLTCD                          WELTCD
     I              BBQNST                          WEQNST
     I              BBS2NB                          WES2NB
     I              BBVHVA                          WEVHVA
     I              BBI7DT                          WEI7DT
     I              BBRJST                          WERJST
     I              BBRKST                          WERKST
     I              BBQWST                          WEQWST
     I              BBQXST                          WEQXST
     I              BBQYST                          WEQYST
     I              BBUNCS                          WEUNCS
     I              BBUVST                          WEUVST
     I              BBUWST                          WEUWST
     I              BBUXST                          WEUXST
     I              BBVSST                          WEVSST
     I              BBAATM                          WEAATM
     I              BBAYNA                          WEAYNA
     I              BBA0NA                          WEA0NA
     I              BBAXDT                          WEAXDT
      *
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                          WFBKC7
     I              NEUFTX                          WFUFTX
     I              NEUGTX                          WFUGTX
     I              NEPFNA                          WFPFNA
     I              NEJ5NX                          WFJ5NX
     I              NEU5TX                          WFU5TX
     I              NEU6TX                          WFU6TX
     I              NEW0TX                          WFW0TX
     I              NEHSSX                          WFHSSX
     I              NEHUSX                          WFHUSX
     I              NEHVSX                          WFHVSX
     I              NEAAC8                          WFAAC8
     I              NEP0SX                          WFP0SX
     I              NEP1SX                          WFP1SX
     I              NEP2SX                          WFP2SX
     I              NEP3SX                          WFP3SX
     I              NEP4SX                          WFP4SX
     I              NEP5SX                          WFP5SX
     I              NEP6SX                          WFP6SX
     I              NEUVST                          WFUVST
     I              NEUWST                          WFUWST
     I              NEUXST                          WFUXST
     I              NEVSST                          WFVSST
     I              NEAATM                          WFAATM
     I              NEAYNA                          WFAYNA
     I              NEA0NA                          WFA0NA
     I              NEAXDT                          WFAXDT
      *
     I@P005O1
      * EDI Purchase Order Detail ST02-TRANS SET Ctl/Seq
      * Renamed input format fields
     I              BRTSCN                          WGTSCN
     I              BRSEQX                          WGSEQX
     I              BRLEST                          WGLEST
     I              BRS2NY                          WGS2NY
     I              BRD5VL                          WGD5VL
     I              BRUNIT                          WGUNIT
     I              BRPRCX                          WGPRCX
     I              BRUPCX                          WGUPCX
     I              BRPRQL                          WGPRQL
     I              BRPRID                          WGPRID
     I              BRDESC                          WGDESC
     I              BRR2AA                          WGR2AA
     I              BRAOU1                          WGAOU1
     I              BRR4AA                          WGR4AA
     I              BRAQU1                          WGAQU1
     I              BRR3AA                          WGR3AA
     I              BRAPU1                          WGAPU1
     I              BRYCT1                          WGYCT1
     I              BRNKST                          WGNKST
     I              BRUEDT                          WGUEDT
     I              BROIAA                          WGOIAA
     I              BRMJVL                          WGMJVL
     I              BRUINY                          WGUINY
      *
     I@BIREKY
      * Customer Item Reference   Retrieval index
      * Renamed input format fields
     I              BIBKC7                          WHBKC7
     I              BIHGCD                          WHHGCD
     I              BICOAA                          WHCOAA
     I              BICPAA                          WHCPAA
     I              BIPSNA                          WHPSNA
     I              BIPTNA                          WHPTNA
     I              BIPUNA                          WHPUNA
     I              BILBSX                          WHLBSX
     I              BILCSX                          WHLCSX
     I              BILDSX                          WHLDSX
     I              BILESX                          WHLESX
     I              BILFSX                          WHLFSX
     I              BIVSST                          WHVSST
     I              BIMJDT                          WHMJDT
     I              BIBETM                          WHBETM
     I              BICCVN                          WHCCVN
     I              BICDVN                          WHCDVN
     I              BIMKDT                          WHMKDT
     I              BIBFTM                          WHBFTM
     I              BICEVN                          WHCEVN
     I              BICFVN                          WHCFVN
      *
     I@BIRECZ
      * Customer Item Reference   Ship to, CIR Resource
      * Renamed input format fields
     I              BIBKC7                          WIBKC7
     I              BIHGCD                          WIHGCD
     I              BICOAA                          WICOAA
     I              BICPAA                          WICPAA
     I              BIPSNA                          WIPSNA
     I              BIPTNA                          WIPTNA
     I              BIPUNA                          WIPUNA
     I              BILBSX                          WILBSX
     I              BILCSX                          WILCSX
     I              BILDSX                          WILDSX
     I              BILESX                          WILESX
     I              BILFSX                          WILFSX
     I              BIVSST                          WIVSST
     I              BIMJDT                          WIMJDT
     I              BIBETM                          WIBETM
     I              BICCVN                          WICCVN
     I              BICDVN                          WICDVN
     I              BIMKDT                          WIMKDT
     I              BIBFTM                          WIBFTM
     I              BICEVN                          WICEVN
     I              BICFVN                          WICFVN
      *
     I@BQREF3
      * Customer Item Ref for EDI Retrieval index
      * Renamed input format fields
     I              BQJ5NX                          WJJ5NX
     I              BQHGCD                          WJHGCD
     I              BQLDSX                          WJLDSX
     I              BQCPAA                          WJCPAA
     I              BQCOAA                          WJCOAA
     I              BQVLNA                          WJVLNA
     I              BQPTNA                          WJPTNA
     I              BQPUNA                          WJPUNA
     I              BQLBSX                          WJLBSX
     I              BQLCSX                          WJLCSX
     I              BQLESX                          WJLESX
     I              BQLFSX                          WJLFSX
     I              BQVSST                          WJVSST
     I              BQMJDT                          WJMJDT
     I              BQBETM                          WJBETM
     I              BQCCVN                          WJCCVN
     I              BQCDVN                          WJCDVN
     I              BQMKDT                          WJMKDT
     I              BQBFTM                          WJBFTM
     I              BQCEVN                          WJCEVN
     I              BQCFVN                          WJCFVN
      *
     I@BQREF2
      * Customer Item Ref for EDI Update index
      * Renamed input format fields
     I              BQJ5NX                          WKJ5NX
     I              BQHGCD                          WKHGCD
     I              BQLDSX                          WKLDSX
     I              BQCPAA                          WKCPAA
     I              BQCOAA                          WKCOAA
     I              BQVLNA                          WKVLNA
     I              BQPTNA                          WKPTNA
     I              BQPUNA                          WKPUNA
     I              BQLBSX                          WKLBSX
     I              BQLCSX                          WKLCSX
     I              BQLESX                          WKLESX
     I              BQLFSX                          WKLFSX
     I              BQVSST                          WKVSST
     I              BQMJDT                          WKMJDT
     I              BQBETM                          WKBETM
     I              BQCCVN                          WKCCVN
     I              BQCDVN                          WKCDVN
     I              BQMKDT                          WKMKDT
     I              BQBFTM                          WKBFTM
     I              BQCEVN                          WKCEVN
     I              BQCFVN                          WKCFVN
      *
     I@BIREKX
      * Customer Item Reference   Update index
      * Renamed input format fields
     I              BIBKC7                          WLBKC7
     I              BIHGCD                          WLHGCD
     I              BICOAA                          WLCOAA
     I              BICPAA                          WLCPAA
     I              BIPSNA                          WLPSNA
     I              BIPTNA                          WLPTNA
     I              BIPUNA                          WLPUNA
     I              BILBSX                          WLLBSX
     I              BILCSX                          WLLCSX
     I              BILDSX                          WLLDSX
     I              BILESX                          WLLESX
     I              BILFSX                          WLLFSX
     I              BIVSST                          WLVSST
     I              BIMJDT                          WLMJDT
     I              BIBETM                          WLBETM
     I              BICCVN                          WLCCVN
     I              BICDVN                          WLCDVN
     I              BIMKDT                          WLMKDT
     I              BIBFTM                          WLBFTM
     I              BICEVN                          WLCEVN
     I              BICFVN                          WLCFVN
      *
     I@BSCPGI
      * WF EDI PO Detail          Update index
      * Renamed input format fields
     I              BSE3NZ                          WME3NZ
     I              BSSEQX                          WMSEQX
     I              BSJ5NX                          WMJ5NX
     I              BSPONO                          WMPONO
     I              BSOSDT                          WMOSDT
     I              BSUPCX                          WMUPCX
     I              BSDESC                          WMDESC
     I              BSPRQL                          WMPRQL
     I              BSPRID                          WMPRID
     I              BSR2AA                          WMR2AA
     I              BSAOU1                          WMAOU1
     I              BSR4AA                          WMR4AA
     I              BSAQU1                          WMAQU1
     I              BSR3AA                          WMR3AA
     I              BSAPU1                          WMAPU1
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPUBQ1    E DSPUBQREL0
      * UPD : Customer Item Ref for EDI Update index
      * Renamed input format fields
     I              BQJ5NX                          WKJ5NX
     I              BQHGCD                          WKHGCD
     I              BQLDSX                          WKLDSX
     I              BQCPAA                          WKCPAA
     I              BQCOAA                          WKCOAA
     I              BQVLNA                          WKVLNA
     I              BQPTNA                          WKPTNA
     I              BQPUNA                          WKPUNA
     I              BQLBSX                          WKLBSX
     I              BQLCSX                          WKLCSX
     I              BQLESX                          WKLESX
     I              BQLFSX                          WKLFSX
     I              BQVSST                          WKVSST
     I              BQMJDT                          WKMJDT
     I              BQBETM                          WKBETM
     I              BQCCVN                          WKCCVN
     I              BQCDVN                          WKCDVN
     I              BQMKDT                          WKMKDT
     I              BQBFTM                          WKBFTM
     I              BQCEVN                          WKCEVN
     I              BQCFVN                          WKCFVN
      *
     IYARDCS      DS                            190
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPOBI1    E DSPOBIREL0
      * UPD : Customer Item Reference   Update index
      * Renamed input format fields
     I              BIBKC7                          WLBKC7
     I              BIHGCD                          WLHGCD
     I              BICOAA                          WLCOAA
     I              BICPAA                          WLCPAA
     I              BIPSNA                          WLPSNA
     I              BIPTNA                          WLPTNA
     I              BIPUNA                          WLPUNA
     I              BILBSX                          WLLBSX
     I              BILCSX                          WLLCSX
     I              BILDSX                          WLLDSX
     I              BILESX                          WLLESX
     I              BILFSX                          WLLFSX
     I              BIVSST                          WLVSST
     I              BIMJDT                          WLMJDT
     I              BIBETM                          WLBETM
     I              BICCVN                          WLCCVN
     I              BICDVN                          WLCDVN
     I              BIMKDT                          WLMKDT
     I              BIBFTM                          WLBFTM
     I              BICEVN                          WLCEVN
     I              BICFVN                          WLCFVN
      *
     IQPUBS1    E DSPUBSCPL0
      * UPD : WF EDI PO Detail          Update index
      * Renamed input format fields
     I              BSE3NZ                          WME3NZ
     I              BSSEQX                          WMSEQX
     I              BSJ5NX                          WMJ5NX
     I              BSPONO                          WMPONO
     I              BSOSDT                          WMOSDT
     I              BSUPCX                          WMUPCX
     I              BSDESC                          WMDESC
     I              BSPRQL                          WMPRQL
     I              BSPRID                          WMPRID
     I              BSR2AA                          WMR2AA
     I              BSAOU1                          WMAOU1
     I              BSR4AA                          WMR4AA
     I              BSAQU1                          WMAQU1
     I              BSR3AA                          WMR3AA
     I              BSAPU1                          WMAPU1
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  G5002-ORDER DATE
     I                                    P   1   40P1OSDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1OSDT    PARM           WP0001  70       G5002-ORDER DAT
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Upd CIR 2 Product XF
      * ***NOTE: Similar logic also exist in PUS4XFR. Any logic changes
      *          here should also consider changing in PUS4XFR. ***
      * Update new CIR for EDI from POs that come in -- daily
      * Create WF record if order's item cant be determined
      * CASE: PAR.G5002-ORDER DATE EQ WRK.Blank Date            USR
     C           P1OSDT    IFEQ WUNKDT                     *IF
     C                     Z-ADD##JDT     YL0001           G5002-ORDER DAT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1OSDT    YL0001           G5002-ORDER DAT
     C                     END                             *FI
      * Rtv Upd CIR 2 Product RT - EDI Purchase Order Header  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Upd CIR 2 Product RT - EDI Purchase Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0002           First Time Flag
     C                     Z-ADD1190101   WUOSDT           G5002-ORDER DAT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAOSDT    WQSA01           G5002-ORDER DAT
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           G5002-ORDER DAT
      * Setup key
     C                     Z-ADDYL0001    WQSA01           G5002-ORDER DAT
      * Establish starting position
     C           KRSSA     SETLL@P004N4                    *
     C           KRSSA     READE@P004N4                  90*
      * Data record not found
     C   90                MOVEL'USR3103' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * every time
      * CASE: LCL.First Time Flag is Yes
     C           YL0002    IFEQ 'Y'                        *IF
      * Rtv All Hdr by Control RT - EDI Purchase Order Header  * 
     C                     EXSR SBRVGN
      * * Get Duns Number for Ship To customer
      * Rtv All info by type  RT - EDI Purchase Order Name  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATSCN    WL0001           ST02-TRANS SET
     C                     MOVEL'ST'      WL0002    P      N101-NAME TYPE
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0015    P      N102-NAME
     C                     MOVELWL0004    YL0016    P      N103-ID CODE QU
     C                     MOVELWL0005    YL0017    P      N104-ID CODE
     C                     MOVELWL0006    YN0036    P      N201-NAME
     C                     MOVELWL0007    YN0037    P      N202-NAME
     C                     MOVELWL0008    YL0018    P      N301-ADD
     C                     MOVELWL0009    YN0038    P      N302-ADDRESS
     C                     MOVELWL0010    YL0019    P      N401-CITY
     C                     MOVELWL0011    YL0020    P      N402-STATE
     C                     MOVELWL0012    YN0039    P      N403-POSTAL COD
      * CASE: LCL.EDI Shipto Duns Number is Not Found
     C           YL0017    IFEQ *BLANK                     *IF
      * Rtv All info by type  RT - EDI Purchase Order Name  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATSCN    WL0001           ST02-TRANS SET
     C                     MOVEL'BS'      WL0002    P      N101-NAME TYPE
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0015    P      N102-NAME
     C                     MOVELWL0004    YL0016    P      N103-ID CODE QU
     C                     MOVELWL0005    YL0017    P      N104-ID CODE
     C                     MOVELWL0006    YN0036    P      N201-NAME
     C                     MOVELWL0007    YN0037    P      N202-NAME
     C                     MOVELWL0008    YL0018    P      N301-ADD
     C                     MOVELWL0009    YN0038    P      N302-ADDRESS
     C                     MOVELWL0010    YL0019    P      N401-CITY
     C                     MOVELWL0011    YL0020    P      N402-STATE
     C                     MOVELWL0012    YN0039    P      N403-POSTAL COD
     C                     END                             *FI
      * CASE: LCL.EDI Shipto Duns Number is Not Found
     C           YL0017    IFEQ *BLANK                     *IF
      * Rtv All info by type  RT - EDI Purchase Order Name  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATSCN    WL0001           ST02-TRANS SET
     C                     MOVEL'BY'      WL0002    P      N101-NAME TYPE
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0015    P      N102-NAME
     C                     MOVELWL0004    YL0016    P      N103-ID CODE QU
     C                     MOVELWL0005    YL0017    P      N104-ID CODE
     C                     MOVELWL0006    YN0036    P      N201-NAME
     C                     MOVELWL0007    YN0037    P      N202-NAME
     C                     MOVELWL0008    YL0018    P      N301-ADD
     C                     MOVELWL0009    YN0038    P      N302-ADDRESS
     C                     MOVELWL0010    YL0019    P      N401-CITY
     C                     MOVELWL0011    YL0020    P      N402-STATE
     C                     MOVELWL0012    YN0039    P      N403-POSTAL COD
     C                     END                             *FI
      * * Get Ship To customer for Duns Number
      * 02/22/21 DN R17040-Changed to Check that EDI Trading Partner # ma
      *    Changed EDI Trading Partner No. Parm from output to input.
      * Rtv EDI ST by EDI Duns RT - Customer EXT  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * RTV Upd CIR 2 Product RT - EDI Purchase Order Detail  * 
     C                     EXSR SGRVGN
     C           KRSSA     READE@P004N4                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv All Hdr by Control RT - EDI Purchase Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBTSCN           ST02-TRANS SET
      * Setup key
     C                     Z-ADDWATSCN    WBTSCN           ST02-TRANS SET
      * Establish starting position
     C           KRSSB     CHAIN@P004LA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3103' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0003           G5002-ORDER DAT
     C                     MOVEL*BLANK    YL0004           G5003-PURCHASE
     C                     MOVEL*BLANK    YL0005           DTM01-Ship Date
     C                     Z-ADD*ZERO     YL0006           G6202 Ship Date
     C                     MOVEL*BLANK    YL0007           G6201-DATE QUAL
     C                     Z-ADD*ZERO     YL0008           G6202-DELIVERY
     C                     MOVEL*BLANK    YL0009           G6601-SHIPMENT
     C                     Z-ADD*ZERO     YL0010           G7601-QUANTITY
     C                     Z-ADD*ZERO     YL0011           G7603-WEIGHT OR
     C                     MOVEL*BLANK    YL0012           OH Order Number
     C                     MOVEL*BLANK    YL0013           Don't Create Or
     C                     MOVEL*BLANK    YL0014           EDI Trading Par
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBOSDT    YL0003           G5002-ORDER DAT
     C                     MOVELWBPONO    YL0004           G5003-PURCHASE
     C                     MOVELWBJ2AA    YL0005           DTM01-Ship Date
     C                     Z-ADDWBT6DT    YL0006           G6202 Ship Date
     C                     MOVELWBQLFX    YL0007           G6201-DATE QUAL
     C                     Z-ADDWBDELV    YL0008           G6202-DELIVERY
     C                     MOVELWBSHMT    YL0009           G6601-SHIPMENT
     C                     Z-ADDWBD3VL    YL0010           G7601-QUANTITY
     C                     Z-ADDWBD4VL    YL0011           G7603-WEIGHT OR
     C                     MOVELWBBXU1    YL0012           OH Order Number
     C                     MOVELWBNLST    YL0013           Don't Create Or
     C                     MOVELWBJ5NX    YL0014           EDI Trading Par
     C                     GOTO SBEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv All info by type  RT - EDI Purchase Order Name  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCTSCN           ST02-TRANS SET
     C                     KFLD           WCTYPC           N101-NAME TYPE
      * Setup key
     C                     Z-ADDWL0001    WCTSCN           ST02-TRANS SET
     C                     MOVELWL0002    WCTYPC           N101-NAME TYPE
      * Establish starting position
     C           KRSSC     CHAIN@P006LC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           N102-NAME
     C                     MOVEL*BLANK    WL0004           N103-ID CODE QU
     C                     MOVEL*BLANK    WL0005           N104-ID CODE
     C                     MOVEL*BLANK    WL0006           N201-NAME
     C                     MOVEL*BLANK    WL0007           N202-NAME
     C                     MOVEL*BLANK    WL0008           N301-ADD
     C                     MOVEL*BLANK    WL0009           N302-ADDRESS
     C                     MOVEL*BLANK    WL0010           N401-CITY
     C                     MOVEL*BLANK    WL0011           N402-STATE
     C                     MOVEL*BLANK    WL0012           N403-POSTAL COD
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCAMEX    WL0003           N102-NAME
     C                     MOVELWCDCDQ    WL0004           N103-ID CODE QU
     C                     MOVELWCDCDE    WL0005           N104-ID CODE
     C                     MOVELWCAME1    WL0006           N201-NAME
     C                     MOVELWCAME2    WL0007           N202-NAME
     C                     MOVELWCDD1X    WL0008           N301-ADD
     C                     MOVELWCDD2X    WL0009           N302-ADDRESS
     C                     MOVELWCITYX    WL0010           N401-CITY
     C                     MOVELWCTATE    WL0011           N402-STATE
     C                     MOVELWCIPXX    WL0012           N403-POSTAL COD
     C                     GOTO SCEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv EDI ST by EDI Duns RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0021           Ship To Custome
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDU5TX    WQSD01           EDI Cust Duns N
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           EDI Cust Duns N
      * Setup key
     C                     MOVELYL0017    WQSD01           EDI Cust Duns N
      * Establish starting position
     C           KRSSD     SETLL@NEREA8                    *
     C           KRSSD     READE@NEREA8                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0021           Ship To Custome
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 02/22/21 DN R17040-Old Logic. Commented Out.
      * ***NOTE: Any changes made here, should consider changes to
      *          'Rtv Sales Rte-1st ShToRT - Customer EXT',
      *          'PRT BT Cust by DUNS   PO - Customer EXT' &
      *          'PRT ST Cust by DUNS   PO - Customer EXT' functions as
      *          well. BOTH functions share the same Business Logic to ge
      *          the correct EDI Ship To Customer #. ***
      * 03/01/21 DN R17040-New Logic: Get 1st Active STC# by DUNS#/Trade
      * CASE: DB1.Record Status is Active
     C           WDVSST    IFEQ 'A'                        *IF
      * Get Ship To Cust Flag & Bill To Customer #.
      * Rtv ShpTo Info/AR Cst RT - Customer  * 
     C                     EXSR SERVGN
      * Must Be Use as Ship To Customer.
      * CASE: LCL.Ship To Customer Flag is Allow Use as Ship To Cust
     C           YL0023    IFEQ 'Y'                        *IF
      * Rtv Trading Partner   RT - Customer EXT  * Get TP for Bill To Cus
     C                     EXSR SFRVGN
      * Match by Trading Partner for Bill To Customer.
      * CASE: PAR.EDI Trading Partner No. EQ LCL.EDI Trading Partner No.
     C           WAJ5NX    IFEQ YL0024                     *IF
      * PAR = DB1 By name
     C                     Z-ADDWDBKC7    YL0021           Ship To Custome
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@NEREA8                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv ShpTo Info/AR Cst RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWDBKC7    WEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSE     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEANC7    YL0022           AR Customer Num
     C                     MOVELWERJST    YL0023           Ship To Custome
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Trading Partner   RT - Customer EXT  * Get TP for Bill To Cu
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0024           EDI Trading Par
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDYL0022    WFBKC7           Ship To Custome
      * Establish starting position
     C           KRSSF     CHAIN@NEREAT              90    *
      * Data record not found
     C   90                MOVEL'USR2880' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFJ5NX    YL0024           EDI Trading Par
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Upd CIR 2 Product RT - EDI Purchase Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        CIR Resource No
     C                     MOVEL*BLANK    WN0002 14        CIR Resource No
     C                     Z-ADD*ZERO     WN0003  70       Item Code Numbe
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * WI 458 RMC 1/25/2021 add resource "IN" (Walmrt sends it)
      *   sent in G6807/PO110 Prod ID Qual
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGTSCN    WQSG01           ST02-TRANS SET
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           ST02-TRANS SET
     C                     KFLD           WGSEQX           ITEM SEQUENCE N
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           ST02-TRANS SET
      * Setup key
     C                     Z-ADDWATSCN    WQSG01           ST02-TRANS SET
     C                     Z-ADD0         WGSEQX           ITEM SEQUENCE N
      * Establish starting position
     C           KPSSG     SETLL@P005O1                    *
     C           KRSSG     READE@P005O1                  90*
      * Data record not found
     C   90                MOVEL'USR3105' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * W103972 DN 07/19/22-Initialize.
     C                     MOVEL'N'       YL0025           Crt Cust Item R
      * Get Seaboard Item code
     C                     MOVEL*BLANK    YL0026           CIR Resource No
     C                     Z-ADD*ZERO     WN0003           Item Code Numbe
      * CASE: DB1.POD SBD Item Number is Entered
     C           WGMJVL    IFNE 0                          *IF
     C                     Z-ADDWGMJVL    WN0003           Item Code Numbe
     C                     MOVEL'Y'       YL0027           Item Code Exist
     C                     END                             *FI
      * CASE: PAR.Item Code Number 7.0  USR is Not Entered
     C           WN0003    IFEQ 0                          *IF
      * G6805 check
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.G6805/P108 PROD ID QUAL is Vendor Product
      *   |- c2    : DB1.G6805/P108 PROD ID QUAL is Vendor Product 2
      *   |- c3    : DB1.G6805/P108 PROD ID QUAL is Manufacturer Part Num
      *   '-
     C           WGPRQL    IFEQ 'VP'                       *IF
     C           WGPRQL    OREQ 'VN'                       *OR
     C           WGPRQL    OREQ 'MG'                       *OR
     C                     MOVELWGPRID    WUY8TX           Text USR 7
      * RTV Right Just  7 Alph US - /UT User Source  * 
     C                     MOVEAWUY8TX    A1
     C                     MOVEA*BLANKS   A2
     C                     MOVE 07        C1      20
     C                     MOVE 07        C2      20
     C           C1        DOWGT0
     C           A1,C1     IFNE ' '
     C                     MOVE A1,C1     A2,C2
     C           C2        SUB  1         C2
     C                     END
     C           C1        SUB  1         C1
     C                     END
     C                     MOVEAA2        WUZ3TX
     C                     MOVE WUZ3TX    YL0028           USR Item Code 7
     C                     Z-ADDYL0028    YL0029           Item Code Numbe
      * Rtv CIR Resource      RT - Customer Item Reference  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0021    WL0013           Ship To Custome
     C                     Z-ADDYL0029    WL0014           Item Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0015    YL0026    P      CIR Resource No
      * CASE: LCL.CIR Resource No is Entered
     C           YL0026    IFNE *BLANK                     *IF
     C                     Z-ADDYL0029    WN0003           Item Code Numbe
     C                     MOVEL'Y'       YL0027           Item Code Exist
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0029           Item Code Numbe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * G6807 check
      * CASE: PAR.Item Code Number 7.0  USR is Not Entered
     C           WN0003    IFEQ 0                          *IF
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : DB1.G6807/PO110 Prod ID Qual is Vendor Product 1
      *   |- c2    : DB1.G6807/PO110 Prod ID Qual is Vendor Product 2
      *   |- c3    : DB1.G6807/PO110 Prod ID Qual is Manufacturer Part Nu
      *   |- c4    : DB1.G6807/PO110 Prod ID Qual is GTIN/UPC Code
      *   '-
     C           WGR2AA    IFEQ 'VP'                       *IF
     C           WGR2AA    OREQ 'VN'                       *OR
     C           WGR2AA    OREQ 'MG'                       *OR
     C           WGR2AA    OREQ 'UK'                       *OR
      * S17059 DN 04/28/21-Added 'GTIN/UPC Code' (UK) Condition c4.
     C                     MOVELWGAOU1    WUY8TX           Text USR 7
      * RTV Right Just  7 Alph US - /UT User Source  * 
     C                     MOVEAWUY8TX    A1
     C                     MOVEA*BLANKS   A2
     C                     MOVE 07        C1      20
     C                     MOVE 07        C2      20
     C           C1        DOWGT0
     C           A1,C1     IFNE ' '
     C                     MOVE A1,C1     A2,C2
     C           C2        SUB  1         C2
     C                     END
     C           C1        SUB  1         C1
     C                     END
     C                     MOVEAA2        WUZ3TX
     C                     MOVE WUZ3TX    YL0028           USR Item Code 7
     C                     Z-ADDYL0028    YL0029           Item Code Numbe
      * Rtv CIR Resource      RT - Customer Item Reference  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0021    WL0013           Ship To Custome
     C                     Z-ADDYL0029    WL0014           Item Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0015    YL0026    P      CIR Resource No
      * CASE: LCL.CIR Resource No is Entered
     C           YL0026    IFNE *BLANK                     *IF
     C                     Z-ADDYL0029    WN0003           Item Code Numbe
     C                     MOVEL'Y'       YL0027           Item Code Exist
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0003           Item Code Numbe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 11/30/22 DN W108770-Removed 'UK' Qualifier. Check IDUPC Field Ins
      *   Commented out & moved 'UK' check below.
      * IT = purch item code
      * CASE: PAR.Item Code Number 7.0  USR is Not Entered
     C           WN0003    IFEQ 0                          *IF
      * CASE: DB1.G6807/PO110 Prod ID Qual is Purchaser Product 3
     C           WGR2AA    IFEQ 'IT'                       *IF
      * CASE: DB1.G6808/PO111 Prod ID is Entered
     C           WGAOU1    IFNE *BLANK                     *IF
      * Rtv CIR Ref item      RT - Customer Item Reference  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0021    WL0016           Ship To Custome
     C                     MOVELWGAOU1    WL0018    P      CIR Resource No
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    YL0030           Item Code
     C                     MOVELWL0019    YN0050    P      CIR UM Base Pri
      * CASE: LCL.Item Code is Entered
     C           YL0030    IFNE 0                          *IF
     C                     Z-ADDYL0030    WN0003           Item Code Numbe
     C                     MOVEL'Y'       YL0027           Item Code Exist
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Catchall
      * CASE: PAR.Item Code Number 7.0  USR is Not Entered
     C           WN0003    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     YL0030           Item Code
      * CASE: DB1.G6806/P109 PRODUCT ID is Not Blank
     C           WGPRID    IFNE *BLANK                     *IF
      * Rtv CIR Ref item      RT - Customer Item Reference  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0021    WL0016           Ship To Custome
     C                     MOVELWGPRID    WL0018    P      CIR Resource No
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    YL0030           Item Code
     C                     MOVELWL0019    YN0050    P      CIR UM Base Pri
      * CASE: LCL.Item Code is Entered
     C           YL0030    IFNE 0                          *IF
     C                     Z-ADDYL0030    WN0003           Item Code Numbe
     C                     MOVEL'Y'       YL0027           Item Code Exist
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Item Code is Not Entered
     C           YL0030    IFEQ 0                          *IF
      * CASE: DB1.G6808/PO111 Prod ID is Entered
     C           WGAOU1    IFNE *BLANK                     *IF
      * Rtv CIR Ref item      RT - Customer Item Reference  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0021    WL0016           Ship To Custome
     C                     MOVELWGAOU1    WL0018    P      CIR Resource No
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    YL0030           Item Code
     C                     MOVELWL0019    YN0050    P      CIR UM Base Pri
      * CASE: LCL.Item Code is Entered
     C           YL0030    IFNE 0                          *IF
     C                     Z-ADDYL0030    WN0003           Item Code Numbe
     C                     MOVELWGAOU1    YL0026           CIR Resource No
     C                     MOVEL'Y'       YL0027           Item Code Exist
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If no product id then zero out SBD item number
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Item Code Number 7.0  USR is Not Entered
      *   |- c2    : LCL.Item Code Exist USR is No
      *   '-
     C           WN0003    IFEQ 0                          *IF
     C           YL0027    OREQ 'N'                        *OR
     C                     Z-ADD*ZERO     WN0003           Item Code Numbe
     C                     END                             *FI
     C                     MOVELYL0026    WN0002           CIR Resource No
      * CASE: PAR.Item Code Number 7.0  USR is Entered
     C           WN0003    IFNE 0                          *IF
      * UPC
      * CASE: DB1.POD Unused GTIN is Entered
     C           WGAPU1    IFNE *BLANK                     *IF
     C                     MOVEL'UP'      WN0001           CIR Resource No
     C                     MOVELWGAPU1    WN0002           CIR Resource No
      * Rtv Chg/Ct CIR EDI    RT - Customer Item Ref for EDI  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAJ5NX    WL0020    P      EDI Trading Par
     C                     Z-ADDWN0003    WL0021           Item Code
     C                     MOVELWN0001    WL0022    P      CIR Resource No
     C                     MOVELWN0002    WL0023    P      CIR Resource No
     C                     MOVELWGDESC    WL0024    P      CIR Description
     C                     EXSR SJRVGN
     C                     END                             *FI
      * VP/VN/MF/UA/PI G807
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6
      *   |- c1    : DB1.G6807/PO110 Prod ID Qual is Vendor Product 1
      *   |- c2    : DB1.G6807/PO110 Prod ID Qual is Vendor Product 2
      *   |- c3    : DB1.G6807/PO110 Prod ID Qual is Manufacturer Part Nu
      *   |- c4    : DB1.G6807/PO110 Prod ID Qual is Purchaser Product 1
      *   |- c5    : DB1.G6807/PO110 Prod ID Qual is UA
      *   |- c6    : DB1.G6807/PO110 Prod ID Qual is Purchaser Product 2
      *   '-
     C           WGR2AA    IFEQ 'VP'                       *IF
     C           WGR2AA    OREQ 'VN'                       *OR
     C           WGR2AA    OREQ 'MG'                       *OR
     C           WGR2AA    OREQ 'PI'                       *OR
     C           WGR2AA    OREQ 'UA'                       *OR
     C           WGR2AA    OREQ 'IN'                       *OR
      * CASE: DB1.G6807/PO110 Prod ID Qual is UA
     C           WGR2AA    IFEQ 'UA'                       *IF
     C                     MOVEL'PI'      WN0001           CIR Resource No
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWGR2AA    WN0001           CIR Resource No
     C                     END                             *FI
     C                     MOVELWGAOU1    WN0002           CIR Resource No
      * Rtv Chg/Ct CIR EDI    RT - Customer Item Ref for EDI  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAJ5NX    WL0020    P      EDI Trading Par
     C                     Z-ADDWN0003    WL0021           Item Code
     C                     MOVELWN0001    WL0022    P      CIR Resource No
     C                     MOVELWN0002    WL0023    P      CIR Resource No
     C                     MOVELWGDESC    WL0024    P      CIR Description
     C                     EXSR SJRVGN
     C                     END                             *FI
      * VP  G805
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : DB1.G6805/P108 PROD ID QUAL is Vendor Product
      *   |- c2    : DB1.G6805/P108 PROD ID QUAL is Vendor Product 2
      *   |- c3    : DB1.G6805/P108 PROD ID QUAL is Manufacturer Part Num
      *   |- c4    : DB1.G6805/P108 PROD ID QUAL is Purchaser Product 1
      *   '-
     C           WGPRQL    IFEQ 'VP'                       *IF
     C           WGPRQL    OREQ 'VN'                       *OR
     C           WGPRQL    OREQ 'MG'                       *OR
     C           WGPRQL    OREQ 'PI'                       *OR
     C                     MOVELWGPRQL    WN0001           CIR Resource No
     C                     MOVEL*BLANK    WN0002           CIR Resource No
     C                     MOVELWGPRID    WN0002           CIR Resource No
      * Rtv Chg/Ct CIR EDI    RT - Customer Item Ref for EDI  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAJ5NX    WL0020    P      EDI Trading Par
     C                     Z-ADDWN0003    WL0021           Item Code
     C                     MOVELWN0001    WL0022    P      CIR Resource No
     C                     MOVELWN0002    WL0023    P      CIR Resource No
     C                     MOVELWGDESC    WL0024    P      CIR Description
     C                     EXSR SJRVGN
     C                     END                             *FI
      * SK = SKU
      * CASE: DB1.G6807/PO110 Prod ID Qual is Sku
     C           WGR2AA    IFEQ 'SK'                       *IF
     C                     MOVEL'SK'      WN0001           CIR Resource No
     C                     MOVELWGAOU1    WN0002           CIR Resource No
      * Rtv Chg/Ct CIR EDI    RT - Customer Item Ref for EDI  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAJ5NX    WL0020    P      EDI Trading Par
     C                     Z-ADDWN0003    WL0021           Item Code
     C                     MOVELWN0001    WL0022    P      CIR Resource No
     C                     MOVELWN0002    WL0023    P      CIR Resource No
     C                     MOVELWGDESC    WL0024    P      CIR Description
     C                     EXSR SJRVGN
     C                     END                             *FI
      * UP = consumer pkg code
      * CASE: DB1.G6807/PO110 Prod ID Qual is UPC Comsumer Pkg Code
     C           WGR2AA    IFEQ 'UP'                       *IF
     C                     MOVEL'UP'      WN0001           CIR Resource No
     C                     MOVELWGAOU1    WN0002           CIR Resource No
      * Rtv Chg/Ct CIR EDI    RT - Customer Item Ref for EDI  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAJ5NX    WL0020    P      EDI Trading Par
     C                     Z-ADDWN0003    WL0021           Item Code
     C                     MOVELWN0001    WL0022    P      CIR Resource No
     C                     MOVELWN0002    WL0023    P      CIR Resource No
     C                     MOVELWGDESC    WL0024    P      CIR Description
     C                     EXSR SJRVGN
     C                     END                             *FI
      * IT = item code
      * CASE: DB1.G6807/PO110 Prod ID Qual is Purchaser Product 3
     C           WGR2AA    IFEQ 'IT'                       *IF
     C                     MOVEL'IT'      WN0001           CIR Resource No
     C                     MOVELWGAOU1    WN0002           CIR Resource No
      * Rtv Chg/Ct CIR EDI    RT - Customer Item Ref for EDI  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAJ5NX    WL0020    P      EDI Trading Par
     C                     Z-ADDWN0003    WL0021           Item Code
     C                     MOVELWN0001    WL0022    P      CIR Resource No
     C                     MOVELWN0002    WL0023    P      CIR Resource No
     C                     MOVELWGDESC    WL0024    P      CIR Description
     C                     EXSR SJRVGN
     C                     END                             *FI
      * 07/19/22 DN W103972-Add Additional Resource Type to Process Here.
      * CASE: *OTHERWISE
      * CB = Buyer Catalog Number
      * CASE: DB1.G6807/PO110 Prod ID Qual is Buyer Catalog Number
     C           WGR2AA    IFEQ 'CB'                       *IF
     C                     MOVEL'CB'      WN0001           CIR Resource No
     C                     MOVELWGAOU1    WN0002           CIR Resource No
     C                     MOVEL'Y'       YL0025           Crt Cust Item R
     C                     END                             *FI
      * BP = Buyer Part Nbr
      * CASE: DB1.G6807/PO110 Prod ID Qual is Buyer Part Nbr
     C           WGR2AA    IFEQ 'BP'                       *IF
     C                     MOVEL'BP'      WN0001           CIR Resource No
     C                     MOVELWGAOU1    WN0002           CIR Resource No
     C                     MOVEL'Y'       YL0025           Crt Cust Item R
     C                     END                             *FI
      * Create Customer Item Ref for EDI Record?
      * CASE: LCL.Crt Cust Item Ref for EDI is Yes
     C           YL0025    IFEQ 'Y'                        *IF
      * Rtv Chg/Ct CIR EDI    RT - Customer Item Ref for EDI  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAJ5NX    WL0020    P      EDI Trading Par
     C                     Z-ADDWN0003    WL0021           Item Code
     C                     MOVELWN0001    WL0022    P      CIR Resource No
     C                     MOVELWN0002    WL0023    P      CIR Resource No
     C                     MOVELWGDESC    WL0024    P      CIR Description
     C                     EXSR SJRVGN
     C                     END                             *FI
      * UP = UP Case code     rmc added 3/26/21
      * CASE: DB1.P106 UPC/GTIN QUAL is UPC Package Code
     C           WGR3AA    IFEQ 'UP'                       *IF
     C                     MOVEL'UP'      WN0001           CIR Resource No
     C                     MOVELWGAPU1    WN0002           CIR Resource No
      * Rtv Chg/Ct CIR EDI    RT - Customer Item Ref for EDI  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAJ5NX    WL0020    P      EDI Trading Par
     C                     Z-ADDWN0003    WL0021           Item Code
     C                     MOVELWN0001    WL0022    P      CIR Resource No
     C                     MOVELWN0002    WL0023    P      CIR Resource No
     C                     MOVELWGDESC    WL0024    P      CIR Description
     C                     EXSR SJRVGN
     C                     END                             *FI
      * GTIN = UK                                    12/07/22 DN W108770
      * CASE: DB1.G6804/P107 UPC/GTIN CODE is Entered
     C           WGUPCX    IFNE *BLANK                     *IF
      * Val UK Val Data Length XF - EDI Purchase Order Detail  * 
     C                     CALL 'PUXVXFR'              90  Val UK Val Data
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGUPCX    WQ0001 15        G6804/P107 UPC/
     C           YL0036    PARM *BLANK    WQ0002  1        Validation Pass
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUXVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 'UK' Data Value Length is 14, Then Proceed.
      * CASE: LCL.Validation Pass USR is Yes
     C           YL0036    IFEQ 'Y'                        *IF
     C                     MOVEL'UK'      WN0001           CIR Resource No
     C                     MOVELWGUPCX    WN0002           CIR Resource No
      * Rtv Chg/Ct CIR EDI    RT - Customer Item Ref for EDI  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAJ5NX    WL0020    P      EDI Trading Par
     C                     Z-ADDWN0003    WL0021           Item Code
     C                     MOVELWN0001    WL0022    P      CIR Resource No
     C                     MOVELWN0002    WL0023    P      CIR Resource No
     C                     MOVELWGDESC    WL0024    P      CIR Description
     C                     EXSR SJRVGN
     C                     END                             *FI
     C                     END                             *FI
      * S17059 DN 04/26/21-Create Customer Item Reference Record if Not F
      * CASE: DB1.G6807/PO110 Prod ID Qual is Entered
     C           WGR2AA    IFNE *BLANK                     *IF
      * W100147 DN 05/27/22-Added 'CIR UM Base Price' as Input Parm.
      * Upd Crt Cust Item Ref  RT - Customer Item Reference  * 
     C                     EXSR SMRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt WF EDI PO Detail  CR - WF EDI PO Detail  * 
     C                     EXSR SOCRRC
     C                     END                             *FI
     C           KRSSG     READE@P005O1                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv CIR Resource      RT - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHBKC7           Ship To Custome
     C                     KFLD           WHHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0013    WHBKC7           Ship To Custome
     C                     Z-ADDWL0014    WHHGCD           Item Code
      * Establish starting position
     C           KRSSH     CHAIN@BIREKY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3081' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0015           CIR Resource No
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHCOAA    WL0015           CIR Resource No
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv CIR Ref item      RT - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIBKC7    WQSI01           Ship To Custome
     C           *LIKE     DEFN WICOAA    WQSI02           CIR Resource No
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Ship To Custome
     C                     KFLD           WQSI02           CIR Resource No
      * Setup key
     C                     Z-ADDWL0016    WQSI01           Ship To Custome
     C                     MOVELWL0018    WQSI02           CIR Resource No
      * Establish starting position
     C           KRSSI     SETLL@BIRECZ                    *
     C           KRSSI     READE@BIRECZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3081' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0017           Item Code
     C                     MOVEL*BLANK    WL0019           CIR UM Base Pri
     C                     GOTO SIEXIT                     *QUIT
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWIHGCD    WL0017           Item Code
     C                     MOVELWILESX    WL0019           CIR UM Base Pri
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@BIRECZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Chg/Ct CIR EDI    RT - Customer Item Ref for EDI  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WJJ5NX           EDI Trading Par
     C                     KFLD           WJHGCD           Item Code
     C                     KFLD           WJLDSX           CIR Resource No
      * Setup key
     C                     MOVELWL0020    WJJ5NX           EDI Trading Par
     C                     Z-ADDWL0021    WJHGCD           Item Code
     C                     MOVELWL0022    WJLDSX           CIR Resource No
      * Establish starting position
     C           KRSSJ     CHAIN@BQREF3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR5150' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Customer Item Ref  CR - Customer Item Ref for EDI  * 
     C                     EXSR SKCRRC
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.CIR Resource No NE PAR.CIR Resource No
     C           WJCOAA    IFNE WL0023                     *IF
      * Chg Customer Item Ref CH - Customer Item Ref for EDI  * 
     C                     EXSR SLCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt Customer Item Ref  CR - Customer Item Ref for EDI  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BQREF2
     C                     MOVELWL0020    WKJ5NX           EDI Trading Par
     C                     Z-ADDWL0021    WKHGCD           Item Code
     C                     MOVELWL0022    WKLDSX           CIR Resource No
     C                     MOVEL*BLANK    WKCPAA           CIR Item No
     C                     MOVELWL0023    WKCOAA           CIR Resource No
     C                     MOVEL*BLANK    WKVLNA           CIR Description
     C                     MOVEL*BLANK    WKPTNA           CIR Description
     C                     MOVEL*BLANK    WKPUNA           CIR Description
     C                     MOVELYL0031    WKLBSX           CIR Unused Stat
     C                     MOVELYL0032    WKLCSX           CIR Unused Stat
     C                     MOVELYL0033    WKLESX           CIR UM Base Pri
     C                     MOVELYL0034    WKLFSX           CIR Unused Stat
     C                     MOVELYL0035    WKVSST           Record Status
     C                     Z-ADD*ZERO     WKMJDT           Create Date
     C                     Z-ADD*ZERO     WKBETM           Create Time
     C                     MOVEL*BLANK    WKCCVN           Create User
     C                     MOVEL*BLANK    WKCDVN           Create Program
     C                     Z-ADD*ZERO     WKMKDT           Change Date
     C                     Z-ADD*ZERO     WKBFTM           Change Time
     C                     MOVEL*BLANK    WKCEVN           Change User
     C                     MOVEL*BLANK    WKCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WKVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WKMJDT           Create Date
     C                     Z-ADD##JTM     WKBETM           Create Time
     C                     MOVEL##USR     WKCCVN           Create User
     C                     MOVEL##PGM     WKCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WKMKDT           Change Date
     C                     Z-ADD*ZERO     WKBFTM           Change Time
     C                     MOVEL*BLANK    WKCEVN           Change User
     C                     MOVEL*BLANK    WKCFVN           Change Program
     C           KLCRSK    KLIST
     C                     KFLD           WKJ5NX           EDI Trading Par
     C                     KFLD           WKHGCD           Item Code
     C                     KFLD           WKLDSX           CIR Resource No
      * Check for duplicate primary key
     C           KLCRSK    SETLL@BQREF2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR5151' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@BQREF2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Customer Item Ref CH - Customer Item Ref for EDI  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BQREF2
     C                     MOVELWJJ5NX    WKJ5NX    P      EDI Trading Par
     C                     Z-ADDWJHGCD    WKHGCD           Item Code
     C                     MOVELWJLDSX    WKLDSX    P      CIR Resource No
      *
     C           KLCHSL    KLIST
     C                     KFLD           WKJ5NX           EDI Trading Par
     C                     KFLD           WKHGCD           Item Code
     C                     KFLD           WKLDSX           CIR Resource No
     C           KLCHSL    CHAIN@BQREF2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PUBQREL0'MDACP
     C                     MOVEL'@BQREF2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPUBQ1    YARDCS
      * Move non-key fields to @BQREF2
     C                     MOVELWJCPAA    WKCPAA    P      CIR Item No
     C                     MOVELWL0023    WKCOAA    P      CIR Resource No
     C                     MOVELWJVLNA    WKVLNA    P      CIR Description
     C                     MOVELWJPTNA    WKPTNA    P      CIR Description
     C                     MOVELWJPUNA    WKPUNA    P      CIR Description
     C                     MOVELWJLBSX    WKLBSX    P      CIR Unused Stat
     C                     MOVELWJLCSX    WKLCSX    P      CIR Unused Stat
     C                     MOVELWJLESX    WKLESX    P      CIR UM Base Pri
     C                     MOVELWJLFSX    WKLFSX    P      CIR Unused Stat
     C                     MOVELWJVSST    WKVSST    P      Record Status
     C                     Z-ADD*ZERO     WKMJDT           Create Date
     C                     Z-ADD*ZERO     WKBETM           Create Time
     C                     MOVEL*BLANK    WKCCVN    P      Create User
     C                     MOVEL*BLANK    WKCDVN    P      Create Program
     C                     Z-ADD*ZERO     WKMKDT           Change Date
     C                     Z-ADD*ZERO     WKBFTM           Change Time
     C                     MOVEL*BLANK    WKCEVN    P      Change User
     C                     MOVEL*BLANK    WKCFVN    P      Change Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPUBQ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WKMKDT           Change Date
     C                     Z-ADD##JTM     WKBFTM           Change Time
     C                     MOVEL##USR     WKCEVN           Change User
     C                     MOVEL##PGM     WKCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPUBQ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BQREF2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPUBQREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Upd Crt Cust Item Ref  RT - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WHBKC7           Ship To Custome
     C                     KFLD           WHHGCD           Item Code
      * Setup key
     C                     Z-ADDYL0021    WHBKC7           Ship To Custome
     C                     Z-ADDWN0003    WHHGCD           Item Code
      * Establish starting position
     C           KRSSM     CHAIN@BIREKY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3081' W0RTN   7
      * USER: Processing if Data record not found
      * W100147 DN 05/27/22-Added 'CIR UM Base Price' for Update.
      * Crt Cust Item Ref     CR - Customer Item Reference  * 
     C                     EXSR SNCRRC
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCRRC    BEGSR
      *================================================================
      * Crt Cust Item Ref     CR - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BIREKX
     C                     Z-ADDYL0021    WLBKC7           Ship To Custome
     C                     Z-ADDWN0003    WLHGCD           Item Code
     C                     MOVELWGAOU1    WLCOAA           CIR Resource No
     C                     MOVEL*BLANK    WLCPAA           CIR Item No
     C                     MOVEL*BLANK    WLPSNA           CIR Description
     C                     MOVEL*BLANK    WLPTNA           CIR Description
     C                     MOVEL*BLANK    WLPUNA           CIR Description
     C                     MOVELYL0037    WLLBSX           CIR Unused Stat
     C                     MOVELYL0037    WLLCSX           CIR Unused Stat
     C                     MOVELWGR2AA    WLLDSX           CIR Resource No
     C                     MOVELWGOIAA    WLLESX           CIR UM Base Pri
     C                     MOVELYL0037    WLLFSX           CIR Unused Stat
     C                     MOVEL'A'       WLVSST           Record Status
     C                     Z-ADD##JDT     WLMJDT           Create Date
     C                     Z-ADD##JTM     WLBETM           Create Time
     C                     MOVEL##USR     WLCCVN           Create User
     C                     MOVEL##PGM     WLCDVN           Create Program
     C                     Z-ADD*ZERO     WLMKDT           Change Date
     C                     Z-ADD*ZERO     WLBFTM           Change Time
     C                     MOVEL*BLANK    WLCEVN           Change User
     C                     MOVEL*BLANK    WLCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WLVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WLMJDT           Create Date
     C                     Z-ADD##JTM     WLBETM           Create Time
     C                     MOVEL##USR     WLCCVN           Create User
     C                     MOVEL##PGM     WLCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WLMKDT           Change Date
     C                     Z-ADD*ZERO     WLBFTM           Change Time
     C                     MOVEL*BLANK    WLCEVN           Change User
     C                     MOVEL*BLANK    WLCFVN           Change Program
     C           KLCRSN    KLIST
     C                     KFLD           WLBKC7           Ship To Custome
     C                     KFLD           WLHGCD           Item Code
      * Check for duplicate primary key
     C           KLCRSN    SETLL@BIREKX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3082' W0RTN   7
      * Send message 'Customer Item Referenc EX'
     C                     MOVEL'USR3082' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C                     WRITE@BIREKX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * Crt WF EDI PO Detail  CR - WF EDI PO Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BSCPGI
     C                     Z-ADDWGTSCN    WME3NZ           ST02-TRANS SET
     C                     Z-ADDWGSEQX    WMSEQX           ITEM SEQUENCE N
     C                     MOVELWAJ5NX    WMJ5NX           EDI Trading Par
     C                     MOVELWAPONO    WMPONO           G5003-PURCHASE
     C                     Z-ADDWAOSDT    WMOSDT           G5002-ORDER DAT
     C                     MOVELWGUPCX    WMUPCX           G6804/P107 UPC/
     C                     MOVELWGDESC    WMDESC           G6901-ITEM DESC
     C                     MOVELWGPRQL    WMPRQL           G6805/P108 PROD
     C                     MOVELWGPRID    WMPRID           G6806/P109 PROD
     C                     MOVELWGR2AA    WMR2AA           G6807/PO110 Pro
     C                     MOVELWGAOU1    WMAOU1           G6808/PO111 Pro
     C                     MOVELWGR4AA    WMR4AA           PO112 Prod ID Q
     C                     MOVELWGAQU1    WMAQU1           PO113 Prod ID
     C                     MOVELWGR3AA    WMR3AA           P106 UPC/GTIN Q
     C                     MOVELWGAPU1    WMAPU1           POD Unused GTIN
      *
     C           KLCRSO    KLIST
     C                     KFLD           WME3NZ           ST02-TRANS SET
     C                     KFLD           WMSEQX           ITEM SEQUENCE N
      * Check for duplicate primary key
     C           KLCRSO    SETLL@BSCPGI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR5159' W0RTN   7
      * Send message 'WF EDI PO Detail       EX'
     C                     MOVEL'USR5159' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@BSCPGI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Blank Date            USR
     C                     Z-ADD*ZERO     WUNKDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WATSCN           ST02-TRANS SET
     C                     Z-ADD*ZERO     WAOSDT           G5002-ORDER DAT
     C                     Z-ADD*ZERO     WAHUVL           SAC05-$$ AMT OF
     C                     Z-ADD*ZERO     WAT6DT           G6202 Ship Date
     C                     Z-ADD*ZERO     WADELV           G6202-DELIVERY
     C                     Z-ADD*ZERO     WAD3VL           G7601-QUANTITY
     C                     Z-ADD*ZERO     WAD4VL           G7603-WEIGHT OR
     C                     Z-ADD*ZERO     WAAMTX           G7608-ORDER AMO
     C                     Z-ADD*ZERO     WAUFDT           POH Date Stamp
      * Define work field G5002-ORDER DATE
     C                     Z-ADD*ZERO     WUOSDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCTSCN           ST02-TRANS SET
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDAAC8           Customer G_L Ve
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEP3NB           D_B Number
     C                     Z-ADD*ZERO     WEI6DT           Date of D_B Rat
     C                     Z-ADD*ZERO     WEAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WEANC7           AR Customer Num
     C                     Z-ADD*ZERO     WEBTC7           Parent Customer
     C                     Z-ADD*ZERO     WES2NB           Parent Credit L
     C                     Z-ADD*ZERO     WEVHVA           AR Credit Limit
     C                     Z-ADD*ZERO     WEI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGTSCN           ST02-TRANS SET
     C                     Z-ADD*ZERO     WGSEQX           ITEM SEQUENCE N
     C                     Z-ADD*ZERO     WGS2NY           POD Item Age Da
     C                     Z-ADD*ZERO     WGD5VL           G6801-QUANTITY
     C                     Z-ADD*ZERO     WGPRCX           G6803-ITEM LIST
     C                     Z-ADD*ZERO     WGUEDT           POD unused date
     C                     Z-ADD*ZERO     WGMJVL           POD SBD Item Nu
     C                     Z-ADD*ZERO     WGUINY           POD Pack Qty
      * Define work field Text USR 7
     C                     MOVEL*BLANK    WUY8TX  7
      * Define work field Text 7 Alpha Usr
     C                     MOVEL*BLANK    WUZ3TX  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHMJDT           Create Date
     C                     Z-ADD*ZERO     WHBETM           Create Time
     C                     Z-ADD*ZERO     WHMKDT           Change Date
     C                     Z-ADD*ZERO     WHBFTM           Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  90
     C                     MOVEL*BLANK    WL0002  3
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004  2
     C                     MOVEL*BLANK    WL0005 20
     C                     MOVEL*BLANK    WL0006 60
     C                     MOVEL*BLANK    WL0007 60
     C                     MOVEL*BLANK    WL0008 55
     C                     MOVEL*BLANK    WL0009 55
     C                     MOVEL*BLANK    WL0010 20
     C                     MOVEL*BLANK    WL0011  2
     C                     MOVEL*BLANK    WL0012 15
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  70
     C                     MOVEL*BLANK    WL0015 14
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  70
     C                     MOVEL*BLANK    WL0018 14
     C                     MOVEL*BLANK    WL0019  2
      * Define local variables for subroutine SJRVGN.
     C                     MOVEL*BLANK    WL0020  6
     C                     Z-ADD*ZERO     WL0021  70
     C                     MOVEL*BLANK    WL0022  2
     C                     MOVEL*BLANK    WL0023 14
     C                     MOVEL*BLANK    WL0024 30
      * Define local work field G5002-ORDER DATE
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0002  1
      * Define null work field G5001-ORDER STATUS CODE
     C                     MOVEL*BLANK    YN0001  2
      * Define local work field Order Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field G5003-PURCHASE ORDER NUMB
     C                     MOVEL*BLANK    YL0004 22
      * Define null work field G6101-CONTACT FUNCTION CO
     C                     MOVEL*BLANK    YN0002  2
      * Define null work field G6102-CONTACT NAME
     C                     MOVEL*BLANK    YN0003 60
      * Define null work field G6103-COMM NUM QUALIFIER
     C                     MOVEL*BLANK    YN0004  2
      * Define null work field G6104-COMM NUMBER
     C                     MOVEL*BLANK    YN0005 15
      * Define null work field G6105-INQUIRY REFERENCE
     C                     MOVEL*BLANK    YN0006 20
      * Define null work field SAC01-ALLOW OR CHG INDICA
     C                     MOVEL*BLANK    YN0007  1
      * Define null work field SAC02-SERV PROMO ALLO OR
     C                     MOVEL*BLANK    YN0008  4
      * Define null work field SAC05-$$ AMT OF ALLOW/CHG
     C                     Z-ADD*ZERO     YN0009 152
      * Define null work field SAC12-ALLOW/CHG CODE
     C                     MOVEL*BLANK    YN0010  2
      * Define null work field SAC15-Description
     C                     MOVEL*BLANK    YN0011 25
      * Define local work field DTM01-Ship Date Qualifier
     C                     MOVEL*BLANK    YL0005  3
      * Define local work field Requested Ship Date
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field G6201-DATE QUALIFIER
     C                     MOVEL*BLANK    YL0007  3
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field G6601-SHIPMENT METHOD
     C                     MOVEL*BLANK    YL0009  2
      * Define null work field G6602-METHOD TYPE CODE
     C                     MOVEL*BLANK    YN0012  2
      * Define null work field G6603-PALLET EXCHANGE COD
     C                     MOVEL*BLANK    YN0013  2
      * Define null work field G6604-UNIT LOAD OPTION CO
     C                     MOVEL*BLANK    YN0014  2
      * Define null work field G6605-ROUTING
     C                     MOVEL*BLANK    YN0015 30
      * Define null work field G6606-FOB POINT CODE
     C                     MOVEL*BLANK    YN0016  2
      * Define local work field G7601-QUANTITY ORDERED
     C                     Z-ADD*ZERO     YL0010 114
      * Define null work field G6802-BASIS FOR MEASUREME
     C                     MOVEL*BLANK    YN0017  2
      * Define local work field G7603-WEIGHT ORDERED
     C                     Z-ADD*ZERO     YL0011 112
      * Define null work field G7608-ORDER AMOUNT
     C                     Z-ADD*ZERO     YN0018 112
      * Define null work field EDI RECORD STATUS
     C                     MOVEL*BLANK    YN0019  1
      * Define null work field Customer Ref ID Qualifier
     C                     MOVEL*BLANK    YN0020  3
      * Define null work field Customer Ref ID
     C                     MOVEL*BLANK    YN0021 30
      * Define null work field Internal Ord ID Qualifier
     C                     MOVEL*BLANK    YN0022  3
      * Define null work field Internal Order number
     C                     MOVEL*BLANK    YN0023 30
      * Define null work field Buyer ID Qualifier
     C                     MOVEL*BLANK    YN0024  3
      * Define null work field Buyer Identification
     C                     MOVEL*BLANK    YN0025 30
      * Define null work field Reference Vs Nbr ID Qual
     C                     MOVEL*BLANK    YN0026  3
      * Define null work field Ref Version Nbr
     C                     MOVEL*BLANK    YN0027 30
      * Define null work field Revision Nbr ID Qualifier
     C                     MOVEL*BLANK    YN0028  3
      * Define null work field Revision Nbr
     C                     MOVEL*BLANK    YN0029 30
      * Define null work field Ref ID Qualifier 01
     C                     MOVEL*BLANK    YN0030  3
      * Define null work field Reference 01
     C                     MOVEL*BLANK    YN0031 30
      * Define null work field Ref ID Qualifier 02
     C                     MOVEL*BLANK    YN0032  3
      * Define local work field OH Order Number
     C                     MOVEL*BLANK    YL0012 30
      * Define null work field Delivery PO Number
     C                     MOVEL*BLANK    YN0033 25
      * Define local work field Don't Create Order Reason
     C                     MOVEL*BLANK    YL0013  1
      * Define null work field POH Date Stamp received
     C                     Z-ADD*ZERO     YN0034  70
      * Define null work field POH PO Purpose cde-OO
     C                     MOVEL*BLANK    YN0035  2
      * Define local work field EDI Trading Partner No
     C                     MOVEL*BLANK    YL0014  6
      * Define local work field N102-NAME
     C                     MOVEL*BLANK    YL0015 30
      * Define local work field N103-ID CODE QUALIFIER
     C                     MOVEL*BLANK    YL0016  2
      * Define local work field EDI Shipto Duns Number
     C                     MOVEL*BLANK    YL0017 20
      * Define null work field N201-NAME
     C                     MOVEL*BLANK    YN0036 60
      * Define null work field N202-NAME
     C                     MOVEL*BLANK    YN0037 60
      * Define local work field N301-ADD
     C                     MOVEL*BLANK    YL0018 55
      * Define null work field N302-ADDRESS
     C                     MOVEL*BLANK    YN0038 55
      * Define local work field N401-CITY
     C                     MOVEL*BLANK    YL0019 20
      * Define local work field N402-STATE
     C                     MOVEL*BLANK    YL0020  2
      * Define null work field N403-POSTAL CODE
     C                     MOVEL*BLANK    YN0039 15
      * Define local work field Customer Number NBR
     C                     Z-ADD*ZERO     YL0021  70
      * Define null work field Cust Shipping Temp C_F
     C                     MOVEL*BLANK    YN0040  1
      * Define null work field Customer Name
     C                     MOVEL*BLANK    YN0041 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0042 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0043 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0044 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0045 20
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0046  2
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0047 11
      * Define null work field Telephone Number FF
     C                     MOVEL*BLANK    YN0048 25
      * Define local work field AR Customer Number
     C                     Z-ADD*ZERO     YL0022  70
      * Define null work field Order Entry Hold
     C                     MOVEL*BLANK    YN0049  1
      * Define local work field Ship To Customer Flag
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field EDI Trading Partner No
     C                     MOVEL*BLANK    YL0024  6
      * Define local work field Crt Cust Item Ref for EDI
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field CIR Resource No
     C                     MOVEL*BLANK    YL0026 14
      * Define local work field Item Code Exist USR
     C                     MOVEL*BLANK    YL0027  1
      * Define local work field USR Item Code 7,0 signed
     C                     Z-ADD*ZERO     YL0028  70
      * Define local work field Item Code Number 7.0  USR
     C                     Z-ADD*ZERO     YL0029  70
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0030  70
      * Define null work field CIR UM Base Price
     C                     MOVEL*BLANK    YN0050  2
      * Define local work field CIR Unused Status 1
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field CIR Unused Status 2
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field CIR UM Base Price
     C                     MOVEL*BLANK    YL0033  2
      * Define local work field CIR Unused Status 5
     C                     MOVEL*BLANK    YL0034  3
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field Validation Pass USR
     C                     MOVEL*BLANK    YL0036  1
      * Define local work field Blank 1 USR
     C                     MOVEL*BLANK    YL0037  1
      *================================================================
     CSR         ZZEXIT    ENDSR
