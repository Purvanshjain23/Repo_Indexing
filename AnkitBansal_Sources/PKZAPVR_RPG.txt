     H/TITLE Pmt Crt Subject Ttt   PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Prompt & validate record
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJBADE
     H* Date          : 04/19/21  Time  : 16:34:29
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPKZAPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Pmt Crt Subject Ttt   PV  Prompt & validate record
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKA8REL1IF  E           K        DISK
      * RTV : Hog Classification        Retrieval index
      *
     FPKA2CPL8IF  E           K        DISK
      * RSQ : Tattoo Detail             Co/Pen
      *
     FPKA3REL1IF  E           K        DISK
      * RTV : Pen                       Retrieval index
      *
     FPKAIREL0IF  E           K        DISK
      * RTV : Genetic                   Retrieval index
      *
     FPKA2CPL1IF  E           K        DISK
      * RTV : Tattoo Detail             Retrieval index
      *
     FPKA3REL5IF  E           K        DISK
      * RSQ : Pen                       Co/Pen/Open
      *
     FPKA7REL1IF  E           K        DISK
      * RTV : Hog Defect                Retrieval index
      *
     FPKBXREL1IF  E           K        DISK
      * RTV : Tattoo Detail Process     Retrieval index
      *
     FPKA8REL4IF  E           K        DISK
      * RSQ : Hog Classification        Hog Class Type Qualified
      *
     FPKA1CPL1UF  E           K        DISK                      A
      * UPD : Tattoo Header             Update index
      *
     FPKA3REL0UF  E           K        DISK
      * UPD : Pen                       Update index
      *
     FPKA2CPL0UF  E           K        DISK
      * UPD : Tattoo Detail             Update index
      *
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 013  5 0A
     E                    W0END   7 013  5 0A
     E                    W0NAM   7 013 10
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WAHMNB
     I              A1BNNB                          WABNNB
     I              A1BONB                          WABONB
     I              A1CVNB                          WACVNB
     I              A1B0DT                          WAB0DT
     I              A1AWDT                          WAAWDT
     I              A1BICD                          WABICD
     I              A1CPST                          WACPST
     I              A1ACPR                          WAACPR
     I              A1B9PR                          WAB9PR
     I              A1CAPR                          WACAPR
     I              A1C4ST                          WAC4ST
     I              A1AIPR                          WAAIPR
     I              A1A6DT                          WAA6DT
     I              A1C2ST                          WAC2ST
     I              A1CXNB                          WACXNB
     I              A1CWNB                          WACWNB
     I              A1FCNB                          WAFCNB
     I              A1H9NB                          WAH9NB
     I              A1FDNB                          WAFDNB
     I              A1FENB                          WAFENB
     I              A1HENB                          WAHENB
     I              A1HFNB                          WAHFNB
     I              A1CYNB                          WACYNB
     I              A1LRNB                          WALRNB
     I              A1E0NB                          WAE0NB
     I              A1A5PC                          WAA5PC
     I              A1FBNB                          WAFBNB
     I              A1A4PC                          WAA4PC
     I              A1F7NB                          WAF7NB
     I              A1HDNB                          WAHDNB
     I              A1F5NB                          WAF5NB
     I              A1F4NB                          WAF4NB
     I              A1F3NB                          WAF3NB
     I              A1F2NB                          WAF2NB
     I              A1AVPC                          WAAVPC
     I              A1AWPC                          WAAWPC
     I              A1CWPC                          WACWPC
     I              A1A8PC                          WAA8PC
     I              A1A7PC                          WAA7PC
     I              A1B8PR                          WAB8PR
     I              A1AMPR                          WAAMPR
     I              A1ANPR                          WAANPR
     I              A1AYVA                          WAAYVA
     I              A1AWVA                          WAAWVA
     I              A1AOPR                          WAAOPR
     I              A1AXVA                          WAAXVA
     I              A1APPR                          WAAPPR
     I              A1ASPR                          WAASPR
     I              A1A4VA                          WAA4VA
     I              A1ATPR                          WAATPR
     I              A1A5VA                          WAA5VA
     I              A1CBPR                          WACBPR
     I              A1CCPR                          WACCPR
     I              A1LPNB                          WALPNB
     I              A1CDPR                          WACDPR
     I              A1A7VA                          WAA7VA
     I              A1A2PR                          WAA2PR
     I              A1JWST                          WAJWST
     I              A1CWST                          WACWST
     I              A1D7ST                          WAD7ST
     I              A1D8ST                          WAD8ST
     I              A1DWST                          WADWST
     I              A1D6ST                          WAD6ST
     I              A1GHNB                          WAGHNB
     I              A1BYDT                          WABYDT
     I              A1E0ST                          WAE0ST
     I              A1E1ST                          WAE1ST
     I              A1E2ST                          WAE2ST
     I              A1BSDT                          WABSDT
     I              A1BTDT                          WABTDT
     I              A1BUDT                          WABUDT
     I              A1HGNB                          WAHGNB
     I              A1HHNB                          WAHHNB
     I              A1HINB                          WAHINB
     I              A1A3PR                          WAA3PR
     I              A1A4PR                          WAA4PR
     I              A1A6PR                          WAA6PR
     I              A1J9NB                          WAJ9NB
     I              A1D6PR                          WAD6PR
     I              A1D7PR                          WAD7PR
     I              A1D8PR                          WAD8PR
     I              A1D9PR                          WAD9PR
     I              A1EAPR                          WAEAPR
     I              A1EBPR                          WAEBPR
     I              A1ECPR                          WAECPR
     I              A1EDPR                          WAEDPR
     I              A1EEPR                          WAEEPR
     I              A1EFPR                          WAEFPR
     I              A1EGPR                          WAEGPR
     I              A1EHPR                          WAEHPR
     I              A1KAST                          WAKAST
     I              A1J7ST                          WAJ7ST
     I              A1J9ST                          WAJ9ST
     I              A1OXNB                          WAOXNB
     I              A1LKST                          WALKST
     I              A1LLST                          WALLST
     I              A1J8ST                          WAJ8ST
     I              A1LIST                          WALIST
     I              A1LJST                          WALJST
     I              A1NZTX                          WANZTX
     I              A1HJCD                          WAHJCD
     I              A1R4ST                          WAR4ST
     I              A1R5ST                          WAR5ST
     I              A1R6ST                          WAR6ST
     I              A1R7ST                          WAR7ST
     I              A1THWT                          WATHWT
     I              A1T2WT                          WAT2WT
     I              A1THHD                          WATHHD
     I              A1T2HD                          WAT2HD
     I              A1OBPR                          WAOBPR
     I              A1KOER                          WAKOER
     I              A1OPIR                          WAOPIR
     I              A1OPEM                          WAOPEM
     I              A1IORP                          WAIORP
     I              A1OWEO                          WAOWEO
     I              A1OQET                          WAOQET
     I              A1URST                          WAURST
     I              A1USST                          WAUSST
     I              A1HHPC                          WAHHPC
     I              A1S9PR                          WAS9PR
     I              A1TAPR                          WATAPR
     I              A1TBPR                          WATBPR
     I              A1JFUR                          WAJFUR
     I              A1KRIF                          WAKRIF
     I              A1KORF                          WAKORF
     I              A1KAPR                          WAKAPR
     I              A1KROT                          WAKROT
     I              A1OTJG                          WAOTJG
     I              A1IRJG                          WAIRJG
     I              A1IMJF                          WAIMJF
     I              A1IRGF                          WAIRGF
     I              A1KRJF                          WAKRJF
     I              A1OJRF                          WAOJRF
     I              A1KFOR                          WAKFOR
     I              A1ORJK                          WAORJK
     I              A1OMVJ                          WAOMVJ
     I              A1MVNF                          WAMVNF
     I              A1MCNF                          WAMCNF
     I              A1NCNF                          WANCNF
     I              A1NCHF                          WANCHF
     I              A1IGIR                          WAIGIR
     I              A1KFJR                          WAKFJR
     I              A1EADT                          WAEADT
     I              A1EBDT                          WAEBDT
     I              A1ECDT                          WAECDT
     I              A1EDDT                          WAEDDT
     I              A1EEDT                          WAEEDT
     I              A1U4ST                          WAU4ST
     I              A1U5ST                          WAU5ST
     I              A1U6ST                          WAU6ST
     I              A1U7ST                          WAU7ST
     I              A1U8ST                          WAU8ST
     I              A1U9ST                          WAU9ST
     I              A1VAST                          WAVAST
     I              A1VBST                          WAVBST
     I              A1BDCD                          WABDCD
     I              A1CSCD                          WACSCD
     I              A1ABCD                          WAABCD
     I              A1AECD                          WAAECD
     I              A1ACCD                          WAACCD
     I              A1AGCD                          WAAGCD
     I              A1BECD                          WABECD
     I              A1AAVN                          WAAAVN
     I              A1AADT                          WAAADT
     I              A1AMTM                          WAAMTM
     I              A1AJST                          WAAJST
     I              A1AHVN                          WAAHVN
     I              A1AGVN                          WAAGVN
     I              A1ABVN                          WAABVN
     I              A1ABDT                          WAABDT
     I              A1ABTM                          WAABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     I@A8REDA
      * Hog Classification        Retrieval index
      * Renamed input format fields
     I              A8BECD                          WCBECD
     I              A8BDTX                          WCBDTX
     I              A8BXST                          WCBXST
     I              A8BYST                          WCBYST
     I              A8BITX                          WCBITX
     I              A8B0ST                          WCB0ST
     I              A8FBST                          WCFBST
     I              A8AAVN                          WCAAVN
     I              A8AADT                          WCAADT
     I              A8AMTM                          WCAMTM
     I              A8AJST                          WCAJST
     I              A8AHVN                          WCAHVN
     I              A8AGVN                          WCAGVN
     I              A8ABVN                          WCABVN
     I              A8ABDT                          WCABDT
     I              A8ABTM                          WCABTM
      *
     I@A2CPKE
      * Tattoo Detail             Co/Pen
      * Renamed input format fields
     I              A2HMNB                          WDHMNB
     I              A2BNNB                          WDBNNB
     I              A2BONB                          WDBONB
     I              A2CVNB                          WDCVNB
     I              A2B0DT                          WDB0DT
     I              A2C2NB                          WDC2NB
     I              A2CZNB                          WDCZNB
     I              A2C0NB                          WDC0NB
     I              A2D8NB                          WDD8NB
     I              A2H7NB                          WDH7NB
     I              A2GGST                          WDGGST
     I              A2AJTM                          WDAJTM
     I              A2JEA1                          WDJEA1
     I              A2B7CD                          WDB7CD
     I              A2D7NB                          WDD7NB
     I              A2D9ST                          WDD9ST
     I              A2E3ST                          WDE3ST
     I              A2E4ST                          WDE4ST
     I              A2E5ST                          WDE5ST
     I              A2BVDT                          WDBVDT
     I              A2BWDT                          WDBWDT
     I              A2BXDT                          WDBXDT
     I              A2HVNB                          WDHVNB
     I              A2CMCD                          WDCMCD
     I              A2B9CD                          WDB9CD
     I              A2H8NB                          WDH8NB
     I              A2CYCD                          WDCYCD
     I              A2AAVN                          WDAAVN
     I              A2AADT                          WDAADT
     I              A2AMTM                          WDAMTM
     I              A2AJST                          WDAJST
     I              A2AHVN                          WDAHVN
     I              A2AGVN                          WDAGVN
     I              A2ABVN                          WDABVN
     I              A2ABDT                          WDABDT
     I              A2ABTM                          WDABTM
      *
     I@A3REDD
      * Pen                       Retrieval index
      * Renamed input format fields
     I              A3HVNB                          WEHVNB
     I              A3CMCD                          WECMCD
     I              A3BBTX                          WEBBTX
     I              A3CTNB                          WECTNB
     I              A3D6NB                          WED6NB
     I              A3B6CD                          WEB6CD
     I              A3DGST                          WEDGST
     I              A3EBNB                          WEEBNB
     I              A3FWST                          WEFWST
     I              A3HBNB                          WEHBNB
     I              A3AGCD                          WEAGCD
     I              A3AAVN                          WEAAVN
     I              A3AADT                          WEAADT
     I              A3AMTM                          WEAMTM
     I              A3AJST                          WEAJST
     I              A3AHVN                          WEAHVN
     I              A3AGVN                          WEAGVN
     I              A3ABVN                          WEABVN
     I              A3ABDT                          WEABDT
     I              A3ABTM                          WEABTM
      *
     I@A3REDC
      * Pen                       Update index
      * Renamed input format fields
     I              A3HVNB                          WFHVNB
     I              A3CMCD                          WFCMCD
     I              A3BBTX                          WFBBTX
     I              A3CTNB                          WFCTNB
     I              A3D6NB                          WFD6NB
     I              A3B6CD                          WFB6CD
     I              A3DGST                          WFDGST
     I              A3EBNB                          WFEBNB
     I              A3FWST                          WFFWST
     I              A3HBNB                          WFHBNB
     I              A3AGCD                          WFAGCD
     I              A3AAVN                          WFAAVN
     I              A3AADT                          WFAADT
     I              A3AMTM                          WFAMTM
     I              A3AJST                          WFAJST
     I              A3AHVN                          WFAHVN
     I              A3AGVN                          WFAGVN
     I              A3ABVN                          WFABVN
     I              A3ABDT                          WFABDT
     I              A3ABTM                          WFABTM
      *
     I@AIREA9
      * Genetic                   Retrieval index
      * Renamed input format fields
     I              AIAGCD                          WGAGCD
     I              AIAWTX                          WGAWTX
     I              AIAAVN                          WGAAVN
     I              AIAADT                          WGAADT
     I              AIAMTM                          WGAMTM
     I              AIAJST                          WGAJST
     I              AIAHVN                          WGAHVN
     I              AIAGVN                          WGAGVN
     I              AIABVN                          WGABVN
     I              AIABDT                          WGABDT
     I              AIABTM                          WGABTM
      *
     I@A2CPDG
      * Tattoo Detail             Retrieval index
      * Renamed input format fields
     I              A2HMNB                          WHHMNB
     I              A2BNNB                          WHBNNB
     I              A2BONB                          WHBONB
     I              A2CVNB                          WHCVNB
     I              A2B0DT                          WHB0DT
     I              A2C2NB                          WHC2NB
     I              A2CZNB                          WHCZNB
     I              A2C0NB                          WHC0NB
     I              A2D8NB                          WHD8NB
     I              A2H7NB                          WHH7NB
     I              A2GGST                          WHGGST
     I              A2AJTM                          WHAJTM
     I              A2JEA1                          WHJEA1
     I              A2B7CD                          WHB7CD
     I              A2D7NB                          WHD7NB
     I              A2D9ST                          WHD9ST
     I              A2E3ST                          WHE3ST
     I              A2E4ST                          WHE4ST
     I              A2E5ST                          WHE5ST
     I              A2BVDT                          WHBVDT
     I              A2BWDT                          WHBWDT
     I              A2BXDT                          WHBXDT
     I              A2HVNB                          WHHVNB
     I              A2CMCD                          WHCMCD
     I              A2B9CD                          WHB9CD
     I              A2H8NB                          WHH8NB
     I              A2CYCD                          WHCYCD
     I              A2AAVN                          WHAAVN
     I              A2AADT                          WHAADT
     I              A2AMTM                          WHAMTM
     I              A2AJST                          WHAJST
     I              A2AHVN                          WHAHVN
     I              A2AGVN                          WHAGVN
     I              A2ABVN                          WHABVN
     I              A2ABDT                          WHABDT
     I              A2ABTM                          WHABTM
      *
     I@A2CPDF
      * Tattoo Detail             Update index
      * Renamed input format fields
     I              A2HMNB                          WIHMNB
     I              A2BNNB                          WIBNNB
     I              A2BONB                          WIBONB
     I              A2CVNB                          WICVNB
     I              A2B0DT                          WIB0DT
     I              A2C2NB                          WIC2NB
     I              A2CZNB                          WICZNB
     I              A2C0NB                          WIC0NB
     I              A2D8NB                          WID8NB
     I              A2H7NB                          WIH7NB
     I              A2GGST                          WIGGST
     I              A2AJTM                          WIAJTM
     I              A2JEA1                          WIJEA1
     I              A2B7CD                          WIB7CD
     I              A2D7NB                          WID7NB
     I              A2D9ST                          WID9ST
     I              A2E3ST                          WIE3ST
     I              A2E4ST                          WIE4ST
     I              A2E5ST                          WIE5ST
     I              A2BVDT                          WIBVDT
     I              A2BWDT                          WIBWDT
     I              A2BXDT                          WIBXDT
     I              A2HVNB                          WIHVNB
     I              A2CMCD                          WICMCD
     I              A2B9CD                          WIB9CD
     I              A2H8NB                          WIH8NB
     I              A2CYCD                          WICYCD
     I              A2AAVN                          WIAAVN
     I              A2AADT                          WIAADT
     I              A2AMTM                          WIAMTM
     I              A2AJST                          WIAJST
     I              A2AHVN                          WIAHVN
     I              A2AGVN                          WIAGVN
     I              A2ABVN                          WIABVN
     I              A2ABDT                          WIABDT
     I              A2ABTM                          WIABTM
      *
     I@A3REKF
      * Pen                       Co/Pen/Open
      * Renamed input format fields
     I              A3HVNB                          WJHVNB
     I              A3CMCD                          WJCMCD
     I              A3BBTX                          WJBBTX
     I              A3CTNB                          WJCTNB
     I              A3D6NB                          WJD6NB
     I              A3B6CD                          WJB6CD
     I              A3DGST                          WJDGST
     I              A3EBNB                          WJEBNB
     I              A3FWST                          WJFWST
     I              A3HBNB                          WJHBNB
     I              A3AGCD                          WJAGCD
     I              A3AAVN                          WJAAVN
     I              A3AADT                          WJAADT
     I              A3AMTM                          WJAMTM
     I              A3AJST                          WJAJST
     I              A3AHVN                          WJAHVN
     I              A3AGVN                          WJAGVN
     I              A3ABVN                          WJABVN
     I              A3ABDT                          WJABDT
     I              A3ABTM                          WJABTM
      *
     I@A7REC1
      * Hog Defect                Retrieval index
      * Renamed input format fields
     I              A7BDCD                          WKBDCD
     I              A7BCTX                          WKBCTX
     I              A7RXST                          WKRXST
     I              A7R2ST                          WKR2ST
     I              A7RYST                          WKRYST
     I              A7RZST                          WKRZST
     I              A7R0ST                          WKR0ST
     I              A7R1ST                          WKR1ST
     I              A7HYCD                          WKHYCD
     I              A7HZCD                          WKHZCD
     I              A7VYST                          WKVYST
     I              A7AEA1                          WKAEA1
     I              A7UOPR                          WKUOPR
     I              A7UPPR                          WKUPPR
     I              A7UQPR                          WKUQPR
     I              A7AAVN                          WKAAVN
     I              A7AADT                          WKAADT
     I              A7AMTM                          WKAMTM
     I              A7AJST                          WKAJST
     I              A7AHVN                          WKAHVN
     I              A7AGVN                          WKAGVN
     I              A7ABVN                          WKABVN
     I              A7ABDT                          WKABDT
     I              A7ABTM                          WKABTM
      *
     I@BXREGA
      * Tattoo Detail Process     Retrieval index
      * Renamed input format fields
     I              BXB9CD                          WLB9CD
     I              BXB3TX                          WLB3TX
     I              BXAAVN                          WLAAVN
     I              BXAADT                          WLAADT
     I              BXAMTM                          WLAMTM
     I              BXAJST                          WLAJST
     I              BXAHVN                          WLAHVN
     I              BXAGVN                          WLAGVN
     I              BXABVN                          WLABVN
     I              BXABDT                          WLABDT
     I              BXABTM                          WLABTM
      *
     I@A8RESC
      * Hog Classification        Hog Class Type Qualified
      * Renamed input format fields
     I              A8BECD                          WMBECD
     I              A8BDTX                          WMBDTX
     I              A8BXST                          WMBXST
     I              A8BYST                          WMBYST
     I              A8BITX                          WMBITX
     I              A8B0ST                          WMB0ST
     I              A8FBST                          WMFBST
     I              A8AAVN                          WMAAVN
     I              A8AADT                          WMAADT
     I              A8AMTM                          WMAMTM
     I              A8AJST                          WMAJST
     I              A8AHVN                          WMAHVN
     I              A8AGVN                          WMAGVN
     I              A8ABVN                          WMABVN
     I              A8ABDT                          WMABDT
     I              A8ABTM                          WMABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     IYARDCS      DS                            583
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKA31    E DSPKA3REL0
      * UPD : Pen                       Update index
      * Renamed input format fields
     I              A3HVNB                          WFHVNB
     I              A3CMCD                          WFCMCD
     I              A3BBTX                          WFBBTX
     I              A3CTNB                          WFCTNB
     I              A3D6NB                          WFD6NB
     I              A3B6CD                          WFB6CD
     I              A3DGST                          WFDGST
     I              A3EBNB                          WFEBNB
     I              A3FWST                          WFFWST
     I              A3HBNB                          WFHBNB
     I              A3AGCD                          WFAGCD
     I              A3AAVN                          WFAAVN
     I              A3AADT                          WFAADT
     I              A3AMTM                          WFAMTM
     I              A3AJST                          WFAJST
     I              A3AHVN                          WFAHVN
     I              A3AGVN                          WFAGVN
     I              A3ABVN                          WFABVN
     I              A3ABDT                          WFABDT
     I              A3ABTM                          WFABTM
      *
     IYBRDCS      DS                            107
     IYCRDCS      DS                            107
     IYDRDCS      DS                            107
     IYERDCS      DS                            107
     IQPKA21    E DSPKA2CPL0
      * UPD : Tattoo Detail             Update index
      * Renamed input format fields
     I              A2HMNB                          WIHMNB
     I              A2BNNB                          WIBNNB
     I              A2BONB                          WIBONB
     I              A2CVNB                          WICVNB
     I              A2B0DT                          WIB0DT
     I              A2C2NB                          WIC2NB
     I              A2CZNB                          WICZNB
     I              A2C0NB                          WIC0NB
     I              A2D8NB                          WID8NB
     I              A2H7NB                          WIH7NB
     I              A2GGST                          WIGGST
     I              A2AJTM                          WIAJTM
     I              A2JEA1                          WIJEA1
     I              A2B7CD                          WIB7CD
     I              A2D7NB                          WID7NB
     I              A2D9ST                          WID9ST
     I              A2E3ST                          WIE3ST
     I              A2E4ST                          WIE4ST
     I              A2E5ST                          WIE5ST
     I              A2BVDT                          WIBVDT
     I              A2BWDT                          WIBWDT
     I              A2BXDT                          WIBXDT
     I              A2HVNB                          WIHVNB
     I              A2CMCD                          WICMCD
     I              A2B9CD                          WIB9CD
     I              A2H8NB                          WIH8NB
     I              A2CYCD                          WICYCD
     I              A2AAVN                          WIAAVN
     I              A2AADT                          WIAADT
     I              A2AMTM                          WIAMTM
     I              A2AJST                          WIAJST
     I              A2AHVN                          WIAHVN
     I              A2AGVN                          WIAGVN
     I              A2ABVN                          WIABVN
     I              A2ABDT                          WIABDT
     I              A2ABTM                          WIABTM
      *
     IYFRDCS      DS                            133
     IYGRDCS      DS                            107
     IYHRDCS      DS                            107
     IYIRDCS      DS                            107
     IYJRDCS      DS                            107
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Detail
      * I : MAP BOH Company Number
     I                                    P   1   20P1HMNB
      * I : MAP BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I : MAP BOL Load Number
     I                                    P   7   90P1BONB
      * I : MAP TH Tattoo Number
     I                                    P  10  120P1CVNB
      * I : MAP TH Kill Date
     I                                    P  13  160P1B0DT
      * I : MAP TD Sequence Number
     I                                    P  17  190P1C2NB
      * I : MAP TD Live Wgt
     I                                    P  20  231P1CZNB
      * I : MAP TD Pen Head
     I                                    P  24  260P1C0NB
      * I : MAP TD Yard Dead
     I                                    P  27  290P1D8NB
      * I : MAP TD Held Over
     I                                    P  30  320P1H7NB
      * I :  TD Held Over Status
     I                                       33  33 P1GGST
      * I :  TD Drive Time
     I                                    P  34  370P1AJTM
      * I : MAP TD Drive Card Number
     I                                    P  38  390P1B7CD
      * I : MAP TD Avg Live Wgt
     I                                    P  40  421P1D7NB
      * I :  TD Gen Bal To Kill
     I                                       43  43 P1D9ST
      * I :  TD Recs Created for HO
     I                                       44  44 P1E3ST
      * I :  TD User Status 2
     I                                       45  45 P1E4ST
      * I :  TD User Status 3
     I                                       46  46 P1E5ST
      * I :  TD User Date 1
     I                                    P  47  500P1BVDT
      * I :  TD User Date 2
     I                                    P  51  540P1BWDT
      * I :  TD Drive Date
     I                                    P  55  580P1BXDT
      * I : MAP Pen Company Number
     I                                    P  59  600P1HVNB
      * I : MAP Pen Number
     I                                       61  63 P1CMCD
      * I :  TDP Process Code
     I                                       64  69 P1B9CD
      * I :  Held Over Pen Company Num
     I                                    P  70  710P1H8NB
      * I :  Held Over Pen Number
     I                                       72  74 P1CYCD
      * I :  RS User Changed
     I                                       75  84 P1AAVN
      * I :  RS Date Changed
     I                                    P  85  880P1AADT
      * I :  RS Time Changed
     I                                    P  89  920P1AMTM
      * I :  RS Record Status
     I                                       93  93 P1AJST
      * I :  RS Job
     I                                       94 103 P1AHVN
      * I :  RS Program
     I                                      104 113 P1AGVN
      * I :  RS User Added
     I                                      114 123 P1ABVN
      * I :  RS Date Added
     I                                    P 124 1270P1ABDT
      * I :  RS Time Added
     I                                    P 128 1310P1ABTM
     IP2PARM      DS
      * I :  Oms System Value Alpha
     I                                        1  40 P2EVTX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Pen &1 invalid f/subject'
      * Pen Usr
     I                                        1   3 ZA0001
      * Message data for 'Defect not allowd f/class'
      * DF Defect Code
     I                                        1   6 ZA0002
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BNNB    PARM           WP0002  70       BOH Buy Order N
     C           P1BONB    PARM           WP0003  50       BOL Load Number
     C           P1CVNB    PARM           WP0004  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0005  70       TH Kill Date
     C           P1C2NB    PARM           WP0006  50       TD Sequence Num
     C           P1CZNB    PARM           WP0007  71       TD Live Wgt
     C           P1C0NB    PARM           WP0008  50       TD Pen Head
     C           P1D8NB    PARM           WP0009  50       TD Yard Dead
     C           P1H7NB    PARM           WP0010  50       TD Held Over
     C           P1GGST    PARM           WP0011  1        TD Held Over St
     C           P1AJTM    PARM           WP0012  60       TD Drive Time
     C           P1B7CD    PARM           WP0013  30       TD Drive Card N
     C           P1D7NB    PARM           WP0014  51       TD Avg Live Wgt
     C           P1D9ST    PARM           WP0015  1        TD Gen Bal To K
     C           P1E3ST    PARM           WP0016  1        TD Recs Created
     C           P1E4ST    PARM           WP0017  1        TD User Status
     C           P1E5ST    PARM           WP0018  1        TD User Status
     C           P1BVDT    PARM           WP0019  70       TD User Date 1
     C           P1BWDT    PARM           WP0020  70       TD User Date 2
     C           P1BXDT    PARM           WP0021  70       TD Drive Date
     C           P1HVNB    PARM           WP0022  30       Pen Company Num
     C           P1CMCD    PARM           WP0023  3        Pen Number
     C           P1B9CD    PARM           WP0024  6        TDP Process Cod
     C           P1H8NB    PARM           WP0025  30       Held Over Pen C
     C           P1CYCD    PARM           WP0026  3        Held Over Pen N
     C           P1AAVN    PARM           WP0027 10        RS User Changed
     C           P1AADT    PARM           WP0028  70       RS Date Changed
     C           P1AMTM    PARM           WP0029  60       RS Time Changed
     C           P1AJST    PARM           WP0030  1        RS Record Statu
     C           P1AHVN    PARM           WP0031 10        RS Job
     C           P1AGVN    PARM           WP0032 10        RS Program
     C           P1ABVN    PARM           WP0033 10        RS User Added
     C           P1ABDT    PARM           WP0034  70       RS Date Added
     C           P1ABTM    PARM           WP0035  60       RS Time Added
     C           P2EVTX    PARM           WP0036 40        Oms System Valu
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Enable PUTOVR
     C                     SETON                     86
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
      * * User Defined * Prompts
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.Pen Usr
     C           W0CFL     IFEQ '#DCBCD'                   *IF
      * Sel Pen               SR - Pen  * 
     C                     CALL 'PKJ0SRR'              90  Sel Pen
     C                     PARM *BLANK    W0RTN   7
     C           #1HVNB    PARM #1HVNB    WQ0001  30       Pen Company Num
     C           #DCBCD    PARM #DCBCD    WQ0002  3        Pen Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.Defect Code Usr
     C           W0CFL     IFEQ '#DCTCD'                   *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DCTCD    PARM #DCTCD    WQ0003  6        DF Defect Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.HC Class Code
     C           W0CFL     IFEQ '#DBECD'                   *IF
      * Sel Hog Classifctn    SR - Hog Classification  * 
     C                     CALL 'PKC0SRR'              90  Sel Hog Classif
     C                     PARM *BLANK    W0RTN   7
     C           #DBECD    PARM #DBECD    WQ0004  3        HC Class Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKC0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      * Create New Subject tattoo and update original.
      * CASE: DTL.Head Total USR NE WRK.Zero USR
     C           #DB5NB    IFNE WUE9NB                     *IF
     C                     Z-ADD#1CZNB    WUDCNB           TD Live Weight
      * Subject To Tattoo #
     C                     MOVEL*BLANK    WUDDCD           Tattoo Nbr Alph
     C                     MOVEL#DGENB    WUDDCD           Tattoo Nbr Alph
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0005  30       BOH Company Num
     C                     PARM P1BNNB    WQ0006  70       BOH Buy Order N
     C                     PARM P1BONB    WQ0007  50       BOL Load Number
     C                     PARM P1CVNB    WQ0008  50       TH Tattoo Numbe
     C                     PARM P1B0DT    WQ0009  70       TH Kill Date
     C                     PARM *ZERO     WQ0010  50       TH Head Receive
     C                     PARM *ZERO     WQ0011  50       TH Held Over
     C                     PARM *ZERO     WQ0012  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0013  70       TH Voucher Paym
     C                     PARM 'ST'      WQ0014  2        Tattoo Action U
     C                     PARM WUDDCD    WQ0015  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           P1D7NB    MULT #DB5NB    WUCZNB           TD Live Wgt
      * Create Tattoo dtl with new tattoo, pen, head, live wgt
      * Crt Tattoo Dtl        XF - Tattoo Detail  * 
     C                     CALL 'PKZXXFR'              90  Crt Tattoo Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0016  30       BOH Company Num
     C                     PARM P1BNNB    WQ0017  70       BOH Buy Order N
     C                     PARM P1BONB    WQ0018  50       BOL Load Number
     C                     PARM P1B0DT    WQ0019  70       TH Kill Date
     C                     PARM P1D7NB    WQ0020  51       TD Avg Live Wgt
     C                     PARM P1D9ST    WQ0021  1        TD Gen Bal To K
     C                     PARM P1E3ST    WQ0022  1        TD Recs Created
     C                     PARM P1E4ST    WQ0023  1        TD User Status
     C                     PARM P1E5ST    WQ0024  1        TD User Status
     C                     PARM P1BVDT    WQ0025  70       TD User Date 1
     C                     PARM P1BWDT    WQ0026  70       TD User Date 2
     C                     PARM P1BXDT    WQ0027  70       TD Drive Date
     C                     PARM P1HVNB    WQ0028  30       Pen Company Num
     C                     PARM #DGENB    WQ0029  50       Tattoo Number N
     C                     PARM WUCZNB    WQ0030  71       Live Wgt Tot US
     C                     PARM #DB5NB    WQ0031  70       Head Total USR
     C                     PARM #DCBCD    WQ0032  3        Pen Usr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKZXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993231*
     C                     END
      * Reduce hd rcvd by the subject head/Update org,
      *   AND Create new Subject Header
      * Try to use same routine for subject
      * Rtv/Chg Hd Subject Rvd RT - Tattoo Header  * 
     C                     EXSR SARVGN
      * Recount Subject Pen Head and Chg the Pen
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
     C                     EXSR SERVGN
      * Reduce pen head & recal live wgt in original Ttt Dtl
     C                     SUB  #DB5NB    #1C0NB           TD Pen Head
     C           WUDCNB    SUB  WUCZNB    #1CZNB           TD Live Wgt
      * Rtv/Chg TttDtl hd,wgt RT - Tattoo Detail  * 
     C                     EXSR SORVGN
      * Recount Original Pen Head and Chg the Pen
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
     C                     EXSR SQRVGN
      * Subject from Tattoo #
     C                     MOVEL*BLANK    WUDDCD           Tattoo Nbr Alph
     C                     MOVELP1CVNB    WUDDCD           Tattoo Nbr Alph
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0046  30       BOH Company Num
     C                     PARM P1BNNB    WQ0047  70       BOH Buy Order N
     C                     PARM P1BONB    WQ0048  50       BOL Load Number
     C                     PARM #DGENB    WQ0049  50       TH Tattoo Numbe
     C                     PARM P1B0DT    WQ0050  70       TH Kill Date
     C                     PARM *ZERO     WQ0051  50       TH Head Receive
     C                     PARM *ZERO     WQ0052  50       TH Held Over
     C                     PARM *ZERO     WQ0053  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0054  70       TH Voucher Paym
     C                     PARM 'SF'      WQ0055  2        Tattoo Action U
     C                     PARM WUDDCD    WQ0056  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Update Last Tattoo number in OMS
     C                     Z-ADD#DGENB    WUVCNB           System Value Nu
      * Upd Lst Tattoo Nbrs   XF - STR Order Management Sys  * 
     C                     CALL 'PDHFXFR'              90  RTV/Chg Co Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0057  30       BOH Company Num
     C                     PARM WUFACD    WQ0058 10        Company Value C
     C                     PARM WUVCNB    WQ0059 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * The subject pen must have an open status.
      * Rtv Val Pen-no parms  RT - Pen  * 
     C                     EXSR TARVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCBCD    ZA0001           Pen Usr
      * Send message 'Pen &1 invalid f/subject'
     C                     MOVEL'PRK0229' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * Subject Head must be <= # head in TD but not 0.
      * CASE: DTL.Head Total USR GT PAR.TD Pen Head
     C           #DB5NB    IFGT P1C0NB                     *IF
      * Send message 'Subject hd must <= pen hd'
     C                     MOVEL'PRK0230' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Head Total USR EQ WRK.Zero USR
     C           #DB5NB    IFEQ WUE9NB                     *IF
      * Send message 'Subject hd cant be 0'
     C                     MOVEL'PRK0236' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Hog Defect
      * CASE: DTL.Defect Code Usr NE WRK.Blank USR
     C           #DCTCD    IFNE WUCRTX                     *IF
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR TBRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Hog Defect             NF'
     C                     MOVEL'PRK0073' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Hog Classification code
      * CASE: DTL.HC Class Code EQ WRK.Blank USR
     C           #DBECD    IFEQ WUCRTX                     *IF
      * Send message 'Class required for subjct'
     C                     MOVEL'PRK0366' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Hog Class         RT - Hog Classification  * 
     C                     EXSR TCRVGN
      * CASE: WRK.HC Class Type is Subject
     C           WUFBST    IFEQ 'S'                        *IF
      * CASE: WRK.HC Defect Required is Yes
     C           WUBXST    IFEQ 'Y'                        *IF
      * CASE: DTL.Defect Code Usr EQ WRK.Blank USR
     C           #DCTCD    IFEQ WUCRTX                     *IF
      * Send message 'Defect required for class'
     C                     MOVEL'PRK0357' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Defect Code Usr NE WRK.Blank USR
     C           #DCTCD    IFNE WUCRTX                     *IF
      * Setup message data for message
     C                     MOVEL#DCTCD    ZA0002           Defect Code Usr
      * Send message 'Defect not allowd f/class'
     C                     MOVEL'PRK0356' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Class must be a Subject'
     C                     MOVEL'PRK0367' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Check reference to Tattoo Header
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Pen
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Tattoo Detail Process
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Pen
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Pen Usr required
     C           #DCBCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Head Total USR required
     C           #DB5NB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Defect Code Usr required
     C           #DCTCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * HC Class Code required
     C           #DBECD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9934  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Update screen time
     C                     TIME           ##TME
      * Enable PUTOVR
     C                     SETON                         86*
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADDP1HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    #1BONB           BOL Load Number
     C                     Z-ADDP1C2NB    #1C2NB           TD Sequence Num
     C                     Z-ADDP1CZNB    #1CZNB           TD Live Wgt
     C                     MOVEL*BLANK    #1GGST           TD Held Over St
     C                     Z-ADD*ZERO     #1AJTM           TD Drive Time
     C                     Z-ADD*ZERO     #1JEA1           TD Drive Hour
     C                     Z-ADDP1D7NB    #1D7NB           TD Avg Live Wgt
     C                     MOVEL*BLANK    #1D9ST           TD Gen Bal To K
     C                     MOVEL*BLANK    #1E3ST           TD Recs Created
     C                     MOVEL*BLANK    #1E4ST           TD User Status
     C                     MOVEL*BLANK    #1E5ST           TD User Status
     C                     Z-ADD*ZERO     #1BVDT           TD User Date 1
     C                     Z-ADD*ZERO     #1BWDT           TD User Date 2
     C                     Z-ADD*ZERO     #1BXDT           TD Drive Date
     C                     Z-ADDP1HVNB    #1HVNB           Pen Company Num
     C                     Z-ADDP1B0DT    #1B0DT           TH Kill Date
     C                     MOVEL*BLANK    #1B9CD           TDP Process Cod
     C                     Z-ADD*ZERO     #1H8NB           Held Over Pen C
     C                     MOVEL*BLANK    #1CYCD           Held Over Pen N
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     Z-ADDP1B7CD    #1B7CD           TD Drive Card N
     C                     MOVELP1CMCD    #1CMCD           Pen Number
     C                     Z-ADDP1CVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADDP1C0NB    #1C0NB           TD Pen Head
     C                     Z-ADDP1D8NB    #1D8NB           TD Yard Dead
     C                     Z-ADDP1H7NB    #1H7NB           TD Held Over
     C                     Z-ADD*ZERO     #DGENB           Tattoo Number N
     C                     MOVEL*BLANK    #DCBCD           Pen Usr
     C                     Z-ADD*ZERO     #DB5NB           Head Total USR
     C                     MOVEL*BLANK    #DCTCD           Defect Code Usr
     C                     MOVEL*BLANK    #DBCTX           DF Description
     C                     MOVEL*BLANK    #DBECD           HC Class Code
     C                     MOVEL*BLANK    #DBDTX           HC Description
      * USER: Load screen
      * RTV Next Tattoo Nbrs  XF - Tattoo Header  * 
     C                     CALL 'PKY4XFR'              90  RTV Next Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0064  30       BOH Company Num
     C                     PARM YL0001    WQ0065  1        HC Class Type
     C           YL0002    PARM YL0002    WQ0066  50       Tattoo Number U
     C           YL0003    PARM YL0003    WQ0067 10        Company Value C
     C                     PARM YL0004    WQ0068  1        Creation Point
     C                     PARM #1B0DT    WQ0069  70       TH Kill Date
     C           YL0005    PARM YL0005    WQ0070  7        Return Code USR
     C                     PARM YL0006    WQ0071  1        SR Type
     C                     PARM YL0007    WQ0072  1        SBD Top Load St
     C                     PARM YL0008    WQ0073  1        Tattoo Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Hog Class Qualify RT - Hog Classification  * 
     C                     EXSR TDRVGN
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv/Chg Hd Subject Rvd RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
     C                     KFLD           WACVNB           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WAHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WABNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WABONB           BOL Load Number
     C                     Z-ADDP1CVNB    WACVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WAB0DT           TH Kill Date
      * Establish starting position
     C           KRSSA     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWACYNB    WUX1NB           TH Live Wgt Org
     C           WACWNB    SUB  #DB5NB    WUCWNB           TH Head Receive
      * Subject live weight
     C           WAF7NB    MULT #DB5NB    WUOONB           Live Weight
      * Org net live weight
     C           WUX1NB    SUB  WUOONB    WUCYNB           TH Live Wgt
      * Load variables per the live uom for the recalc amts formula
      * CASE: DB1.TH Live Purchase UOM is Live Hundred Weight
     C           WACPST    IFEQ 'LW'                       *IF
     C           WACYNB    DIV  100       WUOLNB           Head/Wt Variabl
     C           WUCYNB    DIV  100       WUOMNB           Head/Wt Variabl
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWACWNB    WUOLNB           Head/Wt Variabl
     C                     Z-ADDWUCWNB    WUOMNB           Head/Wt Variabl
     C                     END                             *FI
      * Recalculate payment gross, ded, add, and net amounts
      * CASE: WRK.Head/Wt Variable Old  USR NE WRK.Zero USR
     C           WUOLNB    IFNE WUE9NB                     *IF
     C           WAASPR    DIV  WUOLNB    WUWD             *Synon (17,7) w
     C           WUWD      MULT WUOMNB    WUASPR    H      TH Deduction Am
     C           WAASPR    SUB  WUASPR    WUOENB           Hld Ovr Deducti
     C           WAA4VA    DIV  WUOLNB    WUWD             *Synon (17,7) w
     C           WUWD      MULT WUOMNB    WUA4VA    H      TH Total Net WO
     C           WAA4VA    SUB  WUA4VA    WUONNB           Hld Ovr Tt Net
     C           WAA5VA    DIV  WUOLNB    WUWD             *Synon (17,7) w
     C           WUWD      MULT WUOMNB    WUA5VA    H      TH Additions Am
     C           WAA5VA    SUB  WUA5VA    WUOFNB           Hld Ovr Additio
     C           WACBPR    DIV  WUOLNB    WUWD             *Synon (17,7) w
     C           WUWD      MULT WUOMNB    WUCBPR    H      TH Payment Gros
     C           WACBPR    SUB  WUCBPR    WUOGNB           Hld Ovr Paym Gr
     C           WACCPR    DIV  WUOLNB    WUWD             *Synon (17,7) w
     C           WUWD      MULT WUOMNB    WUCCPR    H      Th Payment Net
     C           WACCPR    SUB  WUCCPR    WUOHNB           Hld Ovr Paym Ne
      * Freight Amount
     C           WACDPR    DIV  WUOLNB    WUWD             *Synon (17,7) w
     C           WUWD      MULT WUOMNB    WUCDPR    H      TH Freight Amou
     C           WACDPR    SUB  WUCDPR    WUOINB           Hld Ovr Freight
     C           WAB9PR    DIV  WUOLNB    WUWD             *Synon (17,7) w
     C           WUWD      MULT WUOMNB    WUB9PR    H      TH Live Gross A
     C           WAB9PR    SUB  WUB9PR    WUOJNB           Hld Ovr Live Gr
     C           WACAPR    DIV  WUOLNB    WUWD             *Synon (17,7) w
     C           WUWD      MULT WUOMNB    WUCAPR    H      TH LIve Net Amt
     C           WACAPR    SUB  WUCAPR    WUOKNB           Hld Ovr Live Ne
      * Shipped Weight
     C           WAHGNB    DIV  WUOLNB    WUWD             *Synon (17,7) w
     C           WUWD      MULT WUOMNB    WUHGNB    H      TH Shipped Weig
     C           WAHGNB    SUB  WUHGNB    WUZ5NB           Hld Ovr Shipped
      * Accrual Amount
     C           WAA7VA    DIV  WUOLNB    WUWD             *Synon (17,7) w
     C           WUWD      MULT WUOMNB    WUA7VA    H      TH Accrual Amou
     C           WAA7VA    SUB  WUA7VA    WUMGPR           Hld Ovr Accrual
     C                     END                             *FI
      * ** OLD:  Chg Tattoo Header   CH * Tattoo Header ** (PKP)
     C                     Z-ADDWUA7VA    WUL8PR           Th Accruals Amt
     C                     Z-ADDWUCDPR    WUMEPR           Freight Cur Amo
      * Chg Hd Subject Rvd    CH - Tattoo Header  * 
     C                     EXSR SBCHRC
      * Change payment to sl if not already paid
      * CASE: DB1.TH Payment Sts is Paid
     C           WACWST    IFEQ 'PL'                       *IF
     C           WACWST    OREQ 'PC'
     C           WACWST    OREQ 'NC'
     C           WACWST    OREQ 'NL'
     C                     MOVELWACWST    WUCWST           TH Payment Sts
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.TH Source Type is External
     C           WAKAST    IFEQ 'E'                        *IF
     C                     MOVEL'SL'      WUCWST           TH Payment Sts
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'IL'      WUCWST           TH Payment Sts
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUOINB    WUMFPR           Freight Nxt Amo
      * Crt Tto Hdr Subj hogs CR - Tattoo Header  * 
     C                     EXSR SCCRRC
      * Recalc TH D/As and calc new Subject TH D/As
      * CASE: DB1.TH Payment Sts is Paid Anything
     C           WACWST    IFEQ 'PL'                       *IF
     C           WACWST    OREQ 'PC'
     C           WACWST    OREQ 'NC'
     C           WACWST    OREQ 'NL'
      * Clc D/A for Subj AfPd XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKFQXFR'              90  Clc D/A for Sub
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0033  30       BOH Company Num
     C                     PARM WABNNB    WQ0034  70       BOH Buy Order N
     C                     PARM WABONB    WQ0035  50       BOL Load Number
     C                     PARM WACVNB    WQ0036  50       TH Tattoo Numbe
     C                     PARM WAB0DT    WQ0037  70       TH Kill Date
     C                     PARM WAAWDT    WQ0038  70       TH Purchase Dat
     C                     PARM WUASPR    WQ0039  72       TH Deduction Am
     C                     PARM WUA5VA    WQ0040  72       TH Additions Am
     C                     PARM WACWST    WQ0041  2        TH Payment Sts
     C                     PARM #DGENB    WQ0042  50       Tattoo Number N
     C                     PARM WUMEPR    WQ0043  72       Freight Cur Amo
     C                     PARM WUMFPR    WQ0044  72       Freight Nxt Amo
     C                     PARM WUL8PR    WQ0045  72       Th Accruals Amt
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKFQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * Chg Hd Subject Rvd    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0002 10        TH Group Refere
     C                     MOVEL*BLANK    WN0003  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0004  52       TH Live Purchas
     C                     MOVEL*BLANK    WN0005  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0006  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0007  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0008  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0009  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0010  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0011  50       TH Held Over
     C                     Z-ADD*ZERO     WN0012  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0013  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0014  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0015  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0016  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0017  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0018  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0019  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0020  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0021  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0022  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0023  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0024  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0025  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0026  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0027  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0028  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0029  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0030  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0031  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0032  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0033  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0034  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0035  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0036  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0037  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0038  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0039  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0040  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0041  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0042  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0043  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0044  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0045  1        TH Header Error
     C                     MOVEL*BLANK    WN0046  1        TH Detail Error
     C                     MOVEL*BLANK    WN0047  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0048  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0049  80       TH Commission A
     C                     Z-ADD*ZERO     WN0050  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0051  1        TH User Error O
     C                     MOVEL*BLANK    WN0052  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0053  1        TH Sex
     C                     Z-ADD*ZERO     WN0054  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0055  70       TH Commission P
     C                     Z-ADD*ZERO     WN0056  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0057  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0058  31       TH FFLI
     C                     Z-ADD*ZERO     WN0059  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0060  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0061  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0062  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0063  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0064  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0065  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0066  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0067  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0068  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0069  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0070  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0071  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0072  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0073  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0074  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0075  1        TH Source Type
     C                     MOVEL*BLANK    WN0076  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0077  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0078  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0079  3        TH Source Code
     C                     MOVEL*BLANK    WN0080  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0081  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0082  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0083  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0084  3        TH State
     C                     MOVEL*BLANK    WN0085  3        TH Unused Code
     C                     MOVEL*BLANK    WN0086  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0087  1        TH Commission S
     C                     MOVEL*BLANK    WN0088  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0089  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0090  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0091  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0092  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0093  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0094  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0095  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0096  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0097  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0098  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0099  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0100  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0101  3        TH PHA Average
     C                     MOVEL*BLANK    WN0102  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0103  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0104  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0105  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0106  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0107  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0108  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0109  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0110  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0111  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0112  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0113  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0114  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0115 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0116 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0117 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0118 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0119  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0120  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0121  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0122  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0123  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0124  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0125  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0126  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0127  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0128  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0129  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0130  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0131  70       TH Unused Date
     C                     MOVEL*BLANK    WN0132  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0133  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0134  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0135  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0136  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0137  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0138  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0139  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0140  6        DF Defect Code
     C                     MOVEL*BLANK    WN0141  6        THP Process Cod
     C                     MOVEL*BLANK    WN0142  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0143  6        PL Location Cod
     C                     MOVEL*BLANK    WN0144  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0145  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0146  3        HC Class Code
     C                     MOVEL*BLANK    WN0147 10        RS User Changed
     C                     Z-ADD*ZERO     WN0148  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0149  60       RS Time Changed
     C                     MOVEL*BLANK    WN0150  1        RS Record Statu
     C                     MOVEL*BLANK    WN0151 10        RS Job
     C                     MOVEL*BLANK    WN0152 10        RS Program
     C                     MOVEL*BLANK    WN0153 10        RS User Added
     C                     Z-ADD*ZERO     WN0154  70       RS Date Added
     C                     Z-ADD*ZERO     WN0155  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWAHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WBBONB           BOL Load Number
     C                     Z-ADDWACVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WBB0DT           TH Kill Date
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
     C           KLCHSB    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YARDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWUB9PR    WBB9PR           TH Live Gross A
     C                     Z-ADDWUCAPR    WBCAPR           TH LIve Net Amt
     C                     Z-ADDWUCWNB    WBCWNB           TH Head Receive
     C                     Z-ADDWUCYNB    WBCYNB           TH Live Wgt
     C                     Z-ADDWUASPR    WBASPR           TH Deduction Am
     C                     Z-ADDWUA4VA    WBA4VA           TH Total Net WO
     C                     Z-ADDWUA5VA    WBA5VA           TH Additions Am
     C                     Z-ADDWUCBPR    WBCBPR           TH Payment Gros
     C                     Z-ADDWUCCPR    WBCCPR           Th Payment Net
     C                     Z-ADDWUCDPR    WBCDPR           TH Freight Amou
     C                     Z-ADDWUA7VA    WBA7VA           TH Accrual Amou
     C                     Z-ADDWUHGNB    WBHGNB           TH Shipped Weig
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WBAAVN           RS User Changed
     C                     Z-ADD##JDT     WBAADT           RS Date Changed
     C                     Z-ADD##JTM     WBAMTM           RS Time Changed
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * Crt Tto Hdr Subj hogs CR - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @A1CPC5
     C                     Z-ADDWAHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WBBONB           BOL Load Number
     C                     Z-ADD#DGENB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WBB0DT           TH Kill Date
     C                     Z-ADDWAAWDT    WBAWDT           TH Purchase Dat
     C                     MOVELWABICD    WBBICD           TH Group Refere
     C                     MOVELWACPST    WBCPST           TH Live Purchas
     C                     Z-ADDWAACPR    WBACPR           TH Live Purchas
     C                     Z-ADDWUOJNB    WBB9PR           TH Live Gross A
     C                     Z-ADDWUOKNB    WBCAPR           TH LIve Net Amt
     C                     MOVELWAC4ST    WBC4ST           TH Resale UOM
     C                     Z-ADD*ZERO     WBAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WBA6DT           TH Pricing Date
     C                     MOVEL*BLANK    WBC2ST           TH Resale Sprea
     C                     Z-ADD*ZERO     WBCXNB           TH Dead On Arri
     C                     Z-ADD#DB5NB    WBCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WBFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WBH9NB           TH Held Over
     C                     Z-ADD*ZERO     WBFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WBFENB           TH Head Killed
     C                     Z-ADD*ZERO     WBHENB           TH Head Adds
     C                     Z-ADD*ZERO     WBHFNB           TH Head Accepte
     C                     Z-ADDWUOONB    WBCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WBLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WBE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WBA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WBFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WBA4PC           TH Tot Light Re
     C                     Z-ADDWAF7NB    WBF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WBHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WBF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WBF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WBAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WBAWPC           TH Actual Yield
     C                     Z-ADDWACWPC    WBCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WBA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WBA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WBB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WBAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WBAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WBAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WBAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WBAPPR           TH CM Carcass G
     C                     Z-ADDWUOENB    WBASPR           TH Deduction Am
     C                     Z-ADDWUONNB    WBA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WBATPR           TH Carcass Net
     C                     Z-ADDWUOFNB    WBA5VA           TH Additions Am
     C                     Z-ADDWUOGNB    WBCBPR           TH Payment Gros
     C                     Z-ADDWUOHNB    WBCCPR           Th Payment Net
     C                     Z-ADDWALPNB    WBLPNB           TH AP Voucher/D
     C                     Z-ADDWUOINB    WBCDPR           TH Freight Amou
     C                     Z-ADDWUMGPR    WBA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WBA2PR           TH Fixed Cost A
     C                     MOVELWAJWST    WBJWST           TH Calc Net Sts
     C                     MOVELWUCWST    WBCWST           TH Payment Sts
     C                     MOVEL*BLANK    WBD7ST           TH Header Error
     C                     MOVEL'N'       WBD8ST           TH Detail Error
     C                     MOVEL*BLANK    WBDWST           TH Kill Balanci
     C                     MOVEL*BLANK    WBD6ST           TH Bal to Kill
     C                     Z-ADDWAGHNB    WBGHNB           TH Commission A
     C                     Z-ADDWABYDT    WBBYDT           TH Voucher Paym
     C                     MOVEL'N'       WBE0ST           TH User Error O
     C                     MOVEL'N'       WBE1ST           TH Held Over Re
     C                     MOVELWAE2ST    WBE2ST           TH Sex
     C                     Z-ADDWABSDT    WBBSDT           TH Held/Ovr Com
     C                     Z-ADDWABTDT    WBBTDT           TH Commission P
     C                     Z-ADDWABUDT    WBBUDT           TH Actual Check
     C                     Z-ADDWUZ5NB    WBHGNB           TH Shipped Weig
     C                     Z-ADDWAHHNB    WBHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBHINB           TH FFLI
     C                     Z-ADD*ZERO     WBA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WBA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WBA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WBJ9NB           TH Head Exclude
     C                     Z-ADDWAD6PR    WBD6PR           TH CM Bse Mkt L
     C                     Z-ADDWAD7PR    WBD7PR           TH CM Bse Mkt C
     C                     Z-ADDWAD8PR    WBD8PR           TH CM Srt Dsc L
     C                     Z-ADDWAD9PR    WBD9PR           TH CM Srt Dsc C
     C                     Z-ADDWAEAPR    WBEAPR           TH CM Yld G/L L
     C                     Z-ADDWAEBPR    WBEBPR           TH CM Yld G/L C
     C                     Z-ADDWAECPR    WBECPR           TH CM Crc Val L
     C                     Z-ADDWAEDPR    WBEDPR           TH CM Crc Val C
     C                     Z-ADDWAEEPR    WBEEPR           TH CM Lean Prem
     C                     Z-ADDWAEFPR    WBEFPR           TH CM Lean Prem
     C                     Z-ADDWAEGPR    WBEGPR           TH CM Gross Liv
     C                     Z-ADDWAEHPR    WBEHPR           TH CM Gross Car
     C                     MOVELWAKAST    WBKAST           TH Source Type
     C                     MOVELWAJ7ST    WBJ7ST           TH Scale Ticket
     C                     MOVELWAJ9ST    WBJ9ST           TH Payment Type
     C                     Z-ADDWAOXNB    WBOXNB           TH HPS Movement
     C                     MOVELWALKST    WBLKST           TH Source Code
     C                     MOVELWALLST    WBLLST           TH Hog Class Ty
     C                     MOVELWAJ8ST    WBJ8ST           TH Posted to HP
     C                     MOVELWALIST    WBLIST           TH Schedule Kil
     C                     MOVELWALJST    WBLJST           TH Shift Held O
     C                     MOVELWANZTX    WBNZTX           TH State
     C                     MOVELWAHJCD    WBHJCD           TH Unused Code
     C                     MOVELWAR4ST    WBR4ST           TH Unused Sts 2
     C                     MOVELWAR5ST    WBR5ST           TH Commission S
     C                     MOVELWAR6ST    WBR6ST           TH Paid 2 Week
     C                     MOVELWAR7ST    WBR7ST           TH Unused Sts 1
     C                     Z-ADDWATHWT    WBTHWT           TH DOA Weight
     C                     Z-ADDWAT2WT    WBT2WT           TH Avg Lean % E
     C                     Z-ADDWATHHD    WBTHHD           TH HPS Farm Sit
     C                     Z-ADDWAT2HD    WBT2HD           TH Shift Held O
     C                     Z-ADDWAOBPR    WBOBPR           TH Sorting Amou
     C                     Z-ADDWAKOER    WBKOER           TH Head Identif
     C                     Z-ADDWAOPIR    WBOPIR           TH Percent Iden
     C                     Z-ADDWAOPEM    WBOPEM           TH Percent Acce
     C                     Z-ADDWAIORP    WBIORP           TH Head Adjuste
     C                     Z-ADDWAOWEO    WBOWEO           TH PHA Head Add
     C                     MOVELWAOQET    WBOQET           TH PHA Add Type
     C                     MOVELWAURST    WBURST           TH PHA Average
     C                     MOVELWAUSST    WBUSST           TH PHA Add Reas
     C                     Z-ADDWAHHPC    WBHHPC           TH PHA Yield Pe
     C                     Z-ADDWAS9PR    WBS9PR           TH PHA Lean Prm
     C                     Z-ADDWATAPR    WBTAPR           TH VC Gross Val
     C                     Z-ADDWATBPR    WBTBPR           TH Excluded Gro
     C                     Z-ADDWAJFUR    WBJFUR           TH Avg Lean %
     C                     Z-ADDWAKRIF    WBKRIF           TH Broken Back
     C                     Z-ADDWAKORF    WBKORF           TH Hot Scl Uplo
     C                     Z-ADDWAKAPR    WBKAPR           TH Unused Nbr 4
     C                     Z-ADDWAKROT    WBKROT           TH Excluded Car
     C                     Z-ADDWAOTJG    WBOTJG           TH Excluded Pre
     C                     Z-ADDWAIRJG    WBIRJG           TH Unused Nbr 7
     C                     Z-ADDWAIMJF    WBIMJF           TH Unused Nbr 8
     C                     Z-ADDWAIRGF    WBIRGF           TH Unused Nbr 9
     C                     Z-ADDWAKRJF    WBKRJF           TH Unused Nbr 1
     C                     Z-ADDWAOJRF    WBOJRF           TH Break Even P
     C                     Z-ADDWAKFOR    WBKFOR           TH Meat Value F
     C                     Z-ADDWAORJK    WBORJK           TH Yld Parm Adj
     C                     Z-ADDWAOMVJ    WBOMVJ           TH PHA Sort Dis
     C                     Z-ADDWAMVNF    WBMVNF           TH Avg Loin Eye
     C                     Z-ADDWAMCNF    WBMCNF           TH Avg Backfat
     C                     Z-ADDWANCNF    WBNCNF           TH HITCH Old Pa
     C                     Z-ADDWANCHF    WBNCHF           TH MPR Sort Los
     C                     Z-ADDWAIGIR    WBIGIR           TH Unused Nbr 1
     C                     Z-ADDWAKFJR    WBKFJR           TH Unused Nbr 2
     C                     Z-ADDWAEADT    WBEADT           TH Cold Scl Upl
     C                     Z-ADDWAEBDT    WBEBDT           TH Cold Scl Upl
     C                     Z-ADDWAECDT    WBECDT           TH Head LFT
     C                     Z-ADDWAEDDT    WBEDDT           TH Head EUT/KOA
     C                     Z-ADDWAEEDT    WBEEDT           TH Unused Date
     C                     MOVELWAU4ST    WBU4ST           TH Unused Sts 1
     C                     MOVELWAU5ST    WBU5ST           TH Unused Sts 2
     C                     MOVELWAU6ST    WBU6ST           TH Unused Sts 3
     C                     MOVELWAU7ST    WBU7ST           TH Unused Sts 4
     C                     MOVELWAU8ST    WBU8ST           TH Unused Sts 5
     C                     MOVELWAU9ST    WBU9ST           TH Unused Sts 6
     C                     MOVELWAVAST    WBVAST           TH Unused Sts 7
     C                     MOVELWAVBST    WBVBST           TH Unused Sts 8
     C                     MOVEL#DCTCD    WBBDCD           DF Defect Code
     C                     MOVELWACSCD    WBCSCD           THP Process Cod
     C                     MOVELWAABCD    WBABCD           PD Producer Cod
     C                     MOVELWAAECD    WBAECD           PL Location Cod
     C                     MOVELWAACCD    WBACCD           HB Buyer Code
     C                     MOVELWAAGCD    WBAGCD           GN Genetic Code
     C                     MOVEL#DBECD    WBBECD           HC Class Code
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * HPE056 Payment Type
      * 1/10/96  HPE056   Allow payment type to be update based on
      *                   what the payment status is at the time this
      *                   tattoo is being updated
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
      * Rtv Hog Class Type    RT - Hog Classification  * 
     C                     EXSR SDRVGN
      * Chg/Crt Tatto/Spc Flds IF
      * HPE056 Payment Type
      * 1/10/96  HPE056   Allow payment type to be update based on
      *                   what the payment status is at the time this
      *                   tattoo is being updated
      * Function Description:  If there are any fields that need to be
      * Changed/Created during the Change functions or Create function
      * Presently: Payment Type
      * Add this routine to all of the change objects and create object
      * that update the Payment Type
      * CASE: PAR.TH Payment Sts is Live anything
     C           WBCWST    IFEQ 'ML'                       *IF
     C           WBCWST    OREQ 'PL'
     C           WBCWST    OREQ 'NL'
     C           WBCWST    OREQ 'SL'
     C           WBCWST    OREQ 'IL'
     C                     MOVEL'L'       WBJ9ST           TH Payment Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       WBJ9ST           TH Payment Type
     C                     END                             *FI
     C           KLCRSC    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRSC    SETLL@A1CPC5                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0062' W0RTN   7
      * Send message 'Tattoo Header          EX'
     C                     MOVEL'PRK0062' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@A1CPC5                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Hog Class Type    RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WCBECD           HC Class Code
      * Setup key
     C                     MOVEL#DBECD    WCBECD           HC Class Code
      * Establish starting position
     C           KRSSD     CHAIN@A8REDA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0075' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUBDTX           HC Description
     C                     MOVEL*BLANK    WBLLST           HC Class Type
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCBDTX    WUBDTX           HC Description
     C                     MOVELWCFBST    WBLLST           HC Class Type
     C                     GOTO SDEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Set Pen Totals to Zeros - Pen  * 
     C                     EXSR SFRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSE01           BOH Company Num
     C           *LIKE     DEFN WDCMCD    WQSE02           Pen Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           BOH Company Num
     C                     KFLD           WQSE02           Pen Number
      * Setup key
     C                     Z-ADD#1HVNB    WQSE01           BOH Company Num
     C                     MOVEL#DCBCD    WQSE02           Pen Number
      * Establish starting position
     C           KRSSE     SETLL@A2CPKE                    *
     C           KRSSE     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR SHCHRC
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv/Chg Pen Totals    RT - Pen  * 
     C                     EXSR SIRVGN
     C           KRSSE     READE@A2CPKE                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
     C                     EXSR SKRVGN
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR SNCHRC
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Set Pen Totals to Zeros - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEHVNB           Pen Company Num
     C                     KFLD           WECMCD           Pen Number
      * Setup key
     C                     Z-ADD#1HVNB    WEHVNB           Pen Company Num
     C                     MOVEL#DCBCD    WECMCD           Pen Number
      * Establish starting position
     C           KRSSF     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Pen               CH - Pen  * 
     C                     EXSR SGCHRC
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWEHVNB    WFHVNB           Pen Company Num
     C                     MOVELWECMCD    WFCMCD    P      Pen Number
      *
     C           KLCHSG    KLIST
     C                     KFLD           WFHVNB           Pen Company Num
     C                     KFLD           WFCMCD           Pen Number
     C           KLCHSG    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YBRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUCRTX    WFBBTX    P      Pen Description
     C                     Z-ADDWECTNB    WFCTNB           Pen Maximun Cap
     C                     Z-ADD*ZERO     WFD6NB           Pen Current Hea
     C                     Z-ADDWEB6CD    WFB6CD           Pen Current Dri
     C                     MOVELWEDGST    WFDGST    P      Pen Sts
     C                     Z-ADDWEEBNB    WFEBNB           Pen Drive Seque
     C                     MOVELWEFWST    WFFWST    P      Pen Type
     C                     Z-ADDWEHBNB    WFHBNB           Pen Adjustment
     C                     MOVELWUCRTX    WFAGCD    P      GN Genetic Code
     C                     MOVELWEAAVN    WFAAVN    P      RS User Changed
     C                     Z-ADDWEAADT    WFAADT           RS Date Changed
     C                     Z-ADDWEAMTM    WFAMTM           RS Time Changed
     C                     MOVELWEAJST    WFAJST    P      RS Record Statu
     C                     MOVELWEAHVN    WFAHVN    P      RS Job
     C                     MOVELWEAGVN    WFAGVN    P      RS Program
     C                     MOVELWEABVN    WFABVN    P      RS User Added
     C                     Z-ADDWEABDT    WFABDT           RS Date Added
     C                     Z-ADDWEABTM    WFABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0156  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0157  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0158  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0159  1        Pen Sts
     C                     Z-ADD*ZERO     WN0160  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0161  1        Pen Type
     C                     Z-ADD*ZERO     WN0162  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0163 10        RS User Changed
     C                     Z-ADD*ZERO     WN0164  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0165  60       RS Time Changed
     C                     MOVEL*BLANK    WN0166  1        RS Record Statu
     C                     MOVEL*BLANK    WN0167 10        RS Job
     C                     MOVEL*BLANK    WN0168 10        RS Program
     C                     MOVEL*BLANK    WN0169 10        RS User Added
     C                     Z-ADD*ZERO     WN0170  70       RS Date Added
     C                     Z-ADD*ZERO     WN0171  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADD#1HVNB    WFHVNB           Pen Company Num
     C                     MOVEL#DCBCD    WFCMCD    P      Pen Number
      *
     C           KLCHSH    KLIST
     C                     KFLD           WFHVNB           Pen Company Num
     C                     KFLD           WFCMCD           Pen Number
     C           KLCHSH    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YCRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WFBBTX    P      Pen Description
     C                     MOVELWUAGCD    WFAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv/Chg Pen Totals    RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WEHVNB           Pen Company Num
     C                     KFLD           WECMCD           Pen Number
      * Setup key
     C                     Z-ADDWDHMNB    WEHVNB           Pen Company Num
     C                     MOVELWDCMCD    WECMCD           Pen Number
      * Establish starting position
     C           KRSSI     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WDC0NB    ADD  WED6NB    WUD6NB           Pen Current Hea
     C                     SUB  WDD8NB    WUD6NB           Pen Current Hea
      * Chg Pen               CH - Pen  * 
     C                     EXSR SJCHRC
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWEHVNB    WFHVNB           Pen Company Num
     C                     MOVELWECMCD    WFCMCD    P      Pen Number
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WFHVNB           Pen Company Num
     C                     KFLD           WFCMCD           Pen Number
     C           KLCHSJ    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YDRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWEBBTX    WFBBTX    P      Pen Description
     C                     Z-ADDWECTNB    WFCTNB           Pen Maximun Cap
     C                     Z-ADDWUD6NB    WFD6NB           Pen Current Hea
     C                     Z-ADDWEB6CD    WFB6CD           Pen Current Dri
     C                     MOVELWEDGST    WFDGST    P      Pen Sts
     C                     Z-ADDWEEBNB    WFEBNB           Pen Drive Seque
     C                     MOVELWEFWST    WFFWST    P      Pen Type
     C                     Z-ADDWEHBNB    WFHBNB           Pen Adjustment
     C                     MOVELWEAGCD    WFAGCD    P      GN Genetic Code
     C                     MOVELWEAAVN    WFAAVN    P      RS User Changed
     C                     Z-ADDWEAADT    WFAADT           RS Date Changed
     C                     Z-ADDWEAMTM    WFAMTM           RS Time Changed
     C                     MOVELWEAJST    WFAJST    P      RS Record Statu
     C                     MOVELWEAHVN    WFAHVN    P      RS Job
     C                     MOVELWEAGVN    WFAGVN    P      RS Program
     C                     MOVELWEABVN    WFABVN    P      RS User Added
     C                     Z-ADDWEABDT    WFABDT           RS Date Added
     C                     Z-ADDWEABTM    WFABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSK01           BOH Company Num
     C           *LIKE     DEFN WDCMCD    WQSK02           Pen Number
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           BOH Company Num
     C                     KFLD           WQSK02           Pen Number
      * Setup key
     C                     Z-ADDWDHMNB    WQSK01           BOH Company Num
     C                     MOVELWDCMCD    WQSK02           Pen Number
      * Establish starting position
     C           KRSSK     SETLL@A2CPKE                    *
     C           KRSSK     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TDP Process Code is Drive Card Printed
      *   |- c2    : DB1.TDP Process Code is Open
      *   '-
     C           WDB9CD    IFEQ 'D'                        *IF
     C           WDB9CD    OREQ 'O'                        *OR
      * Rtv Tattoo GENETICS - Tattoo Header  * 
     C                     EXSR SLRVGN
      * CASE: PAR.GN Genetic Code is BLANKS
     C           WUAGCD    IFEQ *BLANK                     *IF
     C                     MOVELWUA1CD    WUAGCD           GN Genetic Code
     C                     MOVELWUJTTX    WUBBTX           Pen Description
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Genetic Code USR NE PAR.GN Genetic Code
     C           WUA1CD    IFNE WUAGCD                     *IF
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL'MIXED'   WUBBTX           Pen Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSK     READE@A2CPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Tattoo GENETICS - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSL01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQSL02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQSL03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQSL04           TH Tattoo Numbe
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           BOH Company Num
     C                     KFLD           WQSL02           BOH Buy Order N
     C                     KFLD           WQSL03           BOL Load Number
     C                     KFLD           WQSL04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWDHMNB    WQSL01           BOH Company Num
     C                     Z-ADDWDBNNB    WQSL02           BOH Buy Order N
     C                     Z-ADDWDBONB    WQSL03           BOL Load Number
     C                     Z-ADDWDCVNB    WQSL04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSL     SETLL@A1CPC4                    *
     C           KRSSL     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUA1CD           GN Genetic Code
     C                     MOVEL*BLANK    WUJTTX           Pen Description
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELWAAGCD    WUA1CD           GN Genetic Code
      * Rtv Genetic Record    RT - Genetic  * 
     C                     EXSR SMRVGN
     C           KRSSL     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Genetic Record    RT - Genetic  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WGAGCD           GN Genetic Code
      * Setup key
     C                     MOVELWAAGCD    WGAGCD           GN Genetic Code
      * Establish starting position
     C           KRSSM     CHAIN@AIREA9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0021' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUJTTX           GN Description
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGAWTX    WUJTTX           GN Description
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0172  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0173  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0174  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0175  1        Pen Sts
     C                     Z-ADD*ZERO     WN0176  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0177  1        Pen Type
     C                     Z-ADD*ZERO     WN0178  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0179 10        RS User Changed
     C                     Z-ADD*ZERO     WN0180  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0181  60       RS Time Changed
     C                     MOVEL*BLANK    WN0182  1        RS Record Statu
     C                     MOVEL*BLANK    WN0183 10        RS Job
     C                     MOVEL*BLANK    WN0184 10        RS Program
     C                     MOVEL*BLANK    WN0185 10        RS User Added
     C                     Z-ADD*ZERO     WN0186  70       RS Date Added
     C                     Z-ADD*ZERO     WN0187  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADD#1HVNB    WFHVNB           Pen Company Num
     C                     MOVEL#DCBCD    WFCMCD    P      Pen Number
      *
     C           KLCHSN    KLIST
     C                     KFLD           WFHVNB           Pen Company Num
     C                     KFLD           WFCMCD           Pen Number
     C           KLCHSN    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YERDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WFBBTX    P      Pen Description
     C                     MOVELWUAGCD    WFAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv/Chg TttDtl hd,wgt RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WHHMNB           BOH Company Num
     C                     KFLD           WHBNNB           BOH Buy Order N
     C                     KFLD           WHBONB           BOL Load Number
     C                     KFLD           WHCVNB           TH Tattoo Numbe
     C                     KFLD           WHB0DT           TH Kill Date
     C                     KFLD           WHC2NB           TD Sequence Num
      * Setup key
     C                     Z-ADD#1HMNB    WHHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WHBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WHBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WHCVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WHB0DT           TH Kill Date
     C                     Z-ADD#1C2NB    WHC2NB           TD Sequence Num
      * Establish starting position
     C           KRSSO     CHAIN@A2CPDG              90    *
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Tattoo Detail     CH - Tattoo Detail  * 
     C                     EXSR SPCHRC
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * Chg Tattoo Detail     CH - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @A2CPDF
     C                     Z-ADDWHHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWHBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWHBONB    WIBONB           BOL Load Number
     C                     Z-ADDWHCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWHB0DT    WIB0DT           TH Kill Date
     C                     Z-ADDWHC2NB    WIC2NB           TD Sequence Num
      *
     C           KLCHSP    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIC2NB           TD Sequence Num
     C           KLCHSP    CHAIN@A2CPDF              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA2CPL0'MDACP
     C                     MOVEL'@A2CPDF' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA21    YFRDCS
      * Move non-key fields to @A2CPDF
     C                     Z-ADD#1CZNB    WICZNB           TD Live Wgt
     C                     Z-ADD#1C0NB    WIC0NB           TD Pen Head
     C                     Z-ADDWHD8NB    WID8NB           TD Yard Dead
     C                     Z-ADDWHH7NB    WIH7NB           TD Held Over
     C                     MOVELWHGGST    WIGGST    P      TD Held Over St
     C                     Z-ADDWHAJTM    WIAJTM           TD Drive Time
     C                     Z-ADDWHJEA1    WIJEA1           TD Drive Hour
     C                     Z-ADDWHB7CD    WIB7CD           TD Drive Card N
     C                     Z-ADDWHD7NB    WID7NB           TD Avg Live Wgt
     C                     MOVELWHD9ST    WID9ST    P      TD Gen Bal To K
     C                     MOVELWHE3ST    WIE3ST    P      TD Recs Created
     C                     MOVELWHE4ST    WIE4ST    P      TD User Status
     C                     MOVELWHE5ST    WIE5ST    P      TD User Status
     C                     Z-ADDWHBVDT    WIBVDT           TD User Date 1
     C                     Z-ADDWHBWDT    WIBWDT           TD User Date 2
     C                     Z-ADDWHBXDT    WIBXDT           TD Drive Date
     C                     Z-ADDWHHVNB    WIHVNB           Pen Company Num
     C                     MOVELWHCMCD    WICMCD    P      Pen Number
     C                     MOVELWHB9CD    WIB9CD    P      TDP Process Cod
     C                     Z-ADDWHH8NB    WIH8NB           Held Over Pen C
     C                     MOVELWHCYCD    WICYCD    P      Held Over Pen N
     C                     MOVELWHAAVN    WIAAVN    P      RS User Changed
     C                     Z-ADDWHAADT    WIAADT           RS Date Changed
     C                     Z-ADDWHAMTM    WIAMTM           RS Time Changed
     C                     MOVELWHAJST    WIAJST    P      RS Record Statu
     C                     MOVELWHAHVN    WIAHVN    P      RS Job
     C                     MOVELWHAGVN    WIAGVN    P      RS Program
     C                     MOVELWHABVN    WIABVN    P      RS User Added
     C                     Z-ADDWHABDT    WIABDT           RS Date Added
     C                     Z-ADDWHABTM    WIABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA21    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WIAAVN           RS User Changed
     C                     Z-ADD##JDT     WIAADT           RS Date Changed
     C                     Z-ADD##JTM     WIAMTM           RS Time Changed
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA21    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@A2CPDF                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Set Pen Totals to Zeros - Pen  * 
     C                     EXSR SRRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSQ01           BOH Company Num
     C           *LIKE     DEFN WDCMCD    WQSQ02           Pen Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           BOH Company Num
     C                     KFLD           WQSQ02           Pen Number
      * Setup key
     C                     Z-ADDP1HVNB    WQSQ01           BOH Company Num
     C                     MOVELP1CMCD    WQSQ02           Pen Number
      * Establish starting position
     C           KRSSQ     SETLL@A2CPKE                    *
     C           KRSSQ     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR STCHRC
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv/Chg Pen Totals    RT - Pen  * 
     C                     EXSR SURVGN
     C           KRSSQ     READE@A2CPKE                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
     C                     EXSR SWRVGN
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR SZCHRC
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Set Pen Totals to Zeros - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WEHVNB           Pen Company Num
     C                     KFLD           WECMCD           Pen Number
      * Setup key
     C                     Z-ADDP1HVNB    WEHVNB           Pen Company Num
     C                     MOVELP1CMCD    WECMCD           Pen Number
      * Establish starting position
     C           KRSSR     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Pen               CH - Pen  * 
     C                     EXSR SSCHRC
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWEHVNB    WFHVNB           Pen Company Num
     C                     MOVELWECMCD    WFCMCD    P      Pen Number
      *
     C           KLCHSS    KLIST
     C                     KFLD           WFHVNB           Pen Company Num
     C                     KFLD           WFCMCD           Pen Number
     C           KLCHSS    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YGRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUCRTX    WFBBTX    P      Pen Description
     C                     Z-ADDWECTNB    WFCTNB           Pen Maximun Cap
     C                     Z-ADD*ZERO     WFD6NB           Pen Current Hea
     C                     Z-ADDWEB6CD    WFB6CD           Pen Current Dri
     C                     MOVELWEDGST    WFDGST    P      Pen Sts
     C                     Z-ADDWEEBNB    WFEBNB           Pen Drive Seque
     C                     MOVELWEFWST    WFFWST    P      Pen Type
     C                     Z-ADDWEHBNB    WFHBNB           Pen Adjustment
     C                     MOVELWUCRTX    WFAGCD    P      GN Genetic Code
     C                     MOVELWEAAVN    WFAAVN    P      RS User Changed
     C                     Z-ADDWEAADT    WFAADT           RS Date Changed
     C                     Z-ADDWEAMTM    WFAMTM           RS Time Changed
     C                     MOVELWEAJST    WFAJST    P      RS Record Statu
     C                     MOVELWEAHVN    WFAHVN    P      RS Job
     C                     MOVELWEAGVN    WFAGVN    P      RS Program
     C                     MOVELWEABVN    WFABVN    P      RS User Added
     C                     Z-ADDWEABDT    WFABDT           RS Date Added
     C                     Z-ADDWEABTM    WFABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0188  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0189  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0190  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0191  1        Pen Sts
     C                     Z-ADD*ZERO     WN0192  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0193  1        Pen Type
     C                     Z-ADD*ZERO     WN0194  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0195 10        RS User Changed
     C                     Z-ADD*ZERO     WN0196  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0197  60       RS Time Changed
     C                     MOVEL*BLANK    WN0198  1        RS Record Statu
     C                     MOVEL*BLANK    WN0199 10        RS Job
     C                     MOVEL*BLANK    WN0200 10        RS Program
     C                     MOVEL*BLANK    WN0201 10        RS User Added
     C                     Z-ADD*ZERO     WN0202  70       RS Date Added
     C                     Z-ADD*ZERO     WN0203  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDP1HVNB    WFHVNB           Pen Company Num
     C                     MOVELP1CMCD    WFCMCD    P      Pen Number
      *
     C           KLCHST    KLIST
     C                     KFLD           WFHVNB           Pen Company Num
     C                     KFLD           WFCMCD           Pen Number
     C           KLCHST    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YHRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WFBBTX    P      Pen Description
     C                     MOVELWUAGCD    WFAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv/Chg Pen Totals    RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WEHVNB           Pen Company Num
     C                     KFLD           WECMCD           Pen Number
      * Setup key
     C                     Z-ADDWDHMNB    WEHVNB           Pen Company Num
     C                     MOVELWDCMCD    WECMCD           Pen Number
      * Establish starting position
     C           KRSSU     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WDC0NB    ADD  WED6NB    WUD6NB           Pen Current Hea
     C                     SUB  WDD8NB    WUD6NB           Pen Current Hea
      * Chg Pen               CH - Pen  * 
     C                     EXSR SVCHRC
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWEHVNB    WFHVNB           Pen Company Num
     C                     MOVELWECMCD    WFCMCD    P      Pen Number
      *
     C           KLCHSV    KLIST
     C                     KFLD           WFHVNB           Pen Company Num
     C                     KFLD           WFCMCD           Pen Number
     C           KLCHSV    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YIRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWEBBTX    WFBBTX    P      Pen Description
     C                     Z-ADDWECTNB    WFCTNB           Pen Maximun Cap
     C                     Z-ADDWUD6NB    WFD6NB           Pen Current Hea
     C                     Z-ADDWEB6CD    WFB6CD           Pen Current Dri
     C                     MOVELWEDGST    WFDGST    P      Pen Sts
     C                     Z-ADDWEEBNB    WFEBNB           Pen Drive Seque
     C                     MOVELWEFWST    WFFWST    P      Pen Type
     C                     Z-ADDWEHBNB    WFHBNB           Pen Adjustment
     C                     MOVELWEAGCD    WFAGCD    P      GN Genetic Code
     C                     MOVELWEAAVN    WFAAVN    P      RS User Changed
     C                     Z-ADDWEAADT    WFAADT           RS Date Changed
     C                     Z-ADDWEAMTM    WFAMTM           RS Time Changed
     C                     MOVELWEAJST    WFAJST    P      RS Record Statu
     C                     MOVELWEAHVN    WFAHVN    P      RS Job
     C                     MOVELWEAGVN    WFAGVN    P      RS Program
     C                     MOVELWEABVN    WFABVN    P      RS User Added
     C                     Z-ADDWEABDT    WFABDT           RS Date Added
     C                     Z-ADDWEABTM    WFABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSW01           BOH Company Num
     C           *LIKE     DEFN WDCMCD    WQSW02           Pen Number
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           BOH Company Num
     C                     KFLD           WQSW02           Pen Number
      * Setup key
     C                     Z-ADDWDHMNB    WQSW01           BOH Company Num
     C                     MOVELWDCMCD    WQSW02           Pen Number
      * Establish starting position
     C           KRSSW     SETLL@A2CPKE                    *
     C           KRSSW     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TDP Process Code is Drive Card Printed
      *   |- c2    : DB1.TDP Process Code is Open
      *   '-
     C           WDB9CD    IFEQ 'D'                        *IF
     C           WDB9CD    OREQ 'O'                        *OR
      * Rtv Tattoo GENETICS - Tattoo Header  * 
     C                     EXSR SXRVGN
      * CASE: PAR.GN Genetic Code is BLANKS
     C           WUAGCD    IFEQ *BLANK                     *IF
     C                     MOVELWUA1CD    WUAGCD           GN Genetic Code
     C                     MOVELWUJTTX    WUBBTX           Pen Description
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Genetic Code USR NE PAR.GN Genetic Code
     C           WUA1CD    IFNE WUAGCD                     *IF
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL'MIXED'   WUBBTX           Pen Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSW     READE@A2CPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Tattoo GENETICS - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSX01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQSX02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQSX03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQSX04           TH Tattoo Numbe
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           BOH Company Num
     C                     KFLD           WQSX02           BOH Buy Order N
     C                     KFLD           WQSX03           BOL Load Number
     C                     KFLD           WQSX04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWDHMNB    WQSX01           BOH Company Num
     C                     Z-ADDWDBNNB    WQSX02           BOH Buy Order N
     C                     Z-ADDWDBONB    WQSX03           BOL Load Number
     C                     Z-ADDWDCVNB    WQSX04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSX     SETLL@A1CPC4                    *
     C           KRSSX     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUA1CD           GN Genetic Code
     C                     MOVEL*BLANK    WUJTTX           Pen Description
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELWAAGCD    WUA1CD           GN Genetic Code
      * Rtv Genetic Record    RT - Genetic  * 
     C                     EXSR SYRVGN
     C           KRSSX     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Genetic Record    RT - Genetic  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WGAGCD           GN Genetic Code
      * Setup key
     C                     MOVELWAAGCD    WGAGCD           GN Genetic Code
      * Establish starting position
     C           KRSSY     CHAIN@AIREA9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0021' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUJTTX           GN Description
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGAWTX    WUJTTX           GN Description
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0204  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0205  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0206  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0207  1        Pen Sts
     C                     Z-ADD*ZERO     WN0208  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0209  1        Pen Type
     C                     Z-ADD*ZERO     WN0210  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0211 10        RS User Changed
     C                     Z-ADD*ZERO     WN0212  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0213  60       RS Time Changed
     C                     MOVEL*BLANK    WN0214  1        RS Record Statu
     C                     MOVEL*BLANK    WN0215 10        RS Job
     C                     MOVEL*BLANK    WN0216 10        RS Program
     C                     MOVEL*BLANK    WN0217 10        RS User Added
     C                     Z-ADD*ZERO     WN0218  70       RS Date Added
     C                     Z-ADD*ZERO     WN0219  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDP1HVNB    WFHVNB           Pen Company Num
     C                     MOVELP1CMCD    WFCMCD    P      Pen Number
      *
     C           KLCHSZ    KLIST
     C                     KFLD           WFHVNB           Pen Company Num
     C                     KFLD           WFCMCD           Pen Number
     C           KLCHSZ    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YJRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WFBBTX    P      Pen Description
     C                     MOVELWUAGCD    WFAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Val Pen-no parms  RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJHVNB    WQTA01           Pen Company Num
     C           *LIKE     DEFN WJCMCD    WQTA02           Pen Number
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Pen Company Num
     C                     KFLD           WQTA02           Pen Number
      * Setup key
     C                     Z-ADD#1HVNB    WQTA01           Pen Company Num
     C                     MOVEL#DCBCD    WQTA02           Pen Number
      * Establish starting position
     C           KRSTA     SETLL@A3REKF                    *
     C           KRSTA     READE@A3REKF                  90*
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WKBDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DCTCD    WKBDCD           DF Defect Code
      * Establish starting position
     C           KRSTB     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    #DBCTX           DF Description
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKBCTX    #DBCTX           DF Description
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Hog Class         RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WCBECD           HC Class Code
      * Setup key
     C                     MOVEL#DBECD    WCBECD           HC Class Code
      * Establish starting position
     C           KRSTC     CHAIN@A8REDA              90    *
      * Data record not found
     C   90                MOVEL'PRK0075' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCBDTX    WUBDTX           HC Description
     C                     MOVELWCBXST    WUBXST           HC Defect Requi
     C                     MOVELWCBYST    WUBYST           HC Price Requir
     C                     MOVELWCBITX    WUBITX           HC Resolution
     C                     MOVELWCB0ST    WUB0ST           HC Qualificatio
     C                     MOVELWCFBST    WUFBST           HC Class Type
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Hog Class Qualify RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMFBST    WQTD01           HC Class Type
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           HC Class Type
      * Setup key
     C                     MOVEL'S'       WQTD01           HC Class Type
      * Establish starting position
     C           KRSTD     SETLL@A8RESC                    *
     C           KRSTD     READE@A8RESC                  90*
      * Data record not found
     C   90                MOVEL'PRK0075' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMBECD    #DBECD           HC Class Code
     C                     MOVELWMBDTX    #DBDTX           HC Description
     C                     GOTO TDEXIT                     *QUIT
     C           KRSTD     READE@A8RESC                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Tattoo Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1HMNB    IFEQ *ZERO                      BOH Company Num
     C           #1BNNB    ANDEQ*ZERO                      BOH Buy Order N
     C           #1BONB    ANDEQ*ZERO                      BOL Load Number
     C           #1CVNB    ANDEQ*ZERO                      TH Tattoo Numbe
     C           #1B0DT    ANDEQ*ZERO                      TH Kill Date
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAWA    KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
     C                     KFLD           WACVNB           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    WAHMNB
     C                     Z-ADD#1BNNB    WABNNB
     C                     Z-ADD#1BONB    WABONB
     C                     Z-ADD#1CVNB    WACVNB
     C                     Z-ADD#1B0DT    WAB0DT
     C           KLVAWA    CHAIN@A1CPC4              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Tattoo Header          NF'
     C                     MOVEL'PRK0061' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0061' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Pen
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CMCD    WK1X02  1
     C           YPMTFD    IFEQ '#1HVNB'
     C           WK1X02    OREQ '?'                        Pen Number
     C           YPMTFD    OREQ '#1CMCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HVNB' defaulted for 'Pen Company Number'.
      * Field '(DTL) #1CMCD' defaulted for 'Pen Number'.
     C                     CALL 'PKJ0SRR'              90  Sel Pen
     C                     PARM *BLANK    W0RTN   7
     C           #1HVNB    PARM #1HVNB    WQ0060  30       Pen Company Num
     C           #1CMCD    PARM #1CMCD    WQ0061  3        Pen Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HVNB    IFNE *ZERO                      Pen Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1CMCD    IFNE *BLANK                     Pen Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HVNB    IFEQ *ZERO                      Pen Company Num
     C           #1CMCD    ANDEQ*BLANK                     Pen Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWE    KLIST
     C                     KFLD           WEHVNB           Pen Company Num
     C                     KFLD           WECMCD           Pen Number
      * Setup key
     C                     Z-ADD#1HVNB    WEHVNB
     C                     MOVEL#1CMCD    WECMCD
     C           KLVBWE    CHAIN@A3REDD              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Pen                    NF'
     C                     MOVEL'PRK0065' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0065' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Tattoo Detail Process
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1B9CD    IFEQ *BLANK                     TDP Process Cod
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWL    KLIST
     C                     KFLD           WLB9CD           TDP Process Cod
      * Setup key
     C                     MOVEL#1B9CD    WLB9CD
     C           KLVCWL    CHAIN@BXREGA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Tattoo Detail Process  NF'
     C                     MOVEL'PRK0128' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0128' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Pen
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CYCD    WK1X02  1
     C           YPMTFD    IFEQ '#1H8NB'
     C           WK1X02    OREQ '?'                        Pen Number
     C           YPMTFD    OREQ '#1CYCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1H8NB' defaulted for 'Held Over Pen Company Num'.
      * Field '(DTL) #1CYCD' defaulted for 'Held Over Pen Number'.
     C                     CALL 'PKJ0SRR'              90  Sel Pen
     C                     PARM *BLANK    W0RTN   7
     C           #1H8NB    PARM #1H8NB    WQ0062  30       Pen Company Num
     C           #1CYCD    PARM #1CYCD    WQ0063  3        Pen Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1H8NB    IFNE *ZERO                      Pen Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1CYCD    IFNE *BLANK                     Pen Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1H8NB    IFEQ *ZERO                      Pen Company Num
     C           #1CYCD    ANDEQ*BLANK                     Pen Number
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWE    KLIST
     C                     KFLD           WEHVNB           Pen Company Num
     C                     KFLD           WECMCD           Pen Number
      * Setup key
     C                     Z-ADD#1H8NB    WEHVNB
     C                     MOVEL#1CYCD    WECMCD
     C           KLVDWE    CHAIN@A3REDD              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Pen                    NF'
     C                     MOVEL'PRK0065' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0065' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field TD Live Weight Org Usr
     C                     Z-ADD*ZERO     WUDCNB  71
      * Define work field Tattoo Nbr Alpha Usr
     C                     MOVEL*BLANK    WUDDCD  5
      * Define work field TD Live Wgt
     C                     Z-ADD*ZERO     WUCZNB  71
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WAACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WAB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WACAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WAAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WAA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WACXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WACWNB           TH Head Receive
     C                     Z-ADD*ZERO     WAFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WAH9NB           TH Held Over
     C                     Z-ADD*ZERO     WAFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WAFENB           TH Head Killed
     C                     Z-ADD*ZERO     WAHENB           TH Head Adds
     C                     Z-ADD*ZERO     WAHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WACYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WALRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WAE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WAA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WAFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WAA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WAF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WAHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WAF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WAF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WAAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WAAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WACWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WAA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WAA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WAB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WAAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WAAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WAAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WAAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WAAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WAASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WAA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WAATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WAA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WACBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WACCPR           Th Payment Net
     C                     Z-ADD*ZERO     WALPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WACDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WAA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WAA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WAGHNB           TH Commission A
     C                     Z-ADD*ZERO     WABYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WABSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WABTDT           TH Commission P
     C                     Z-ADD*ZERO     WABUDT           TH Actual Check
     C                     Z-ADD*ZERO     WAHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WAHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAHINB           TH FFLI
     C                     Z-ADD*ZERO     WAA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WAA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WAA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WAJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WAD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WAD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WAD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WAD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WAEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WAEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WAECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WAEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WAEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WAEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WAOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WATHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WAT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WATHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WAT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WAOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WAKOER           TH Head Identif
     C                     Z-ADD*ZERO     WAOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WAOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WAIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WAOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WAHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WAS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WATAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WATBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WAJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WAKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WAKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WAKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WAKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WAOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WAIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WAIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WAIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WAKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WAKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WAORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WAOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WAMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WANCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WANCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WAIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WAEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAECDT           TH Head LFT
     C                     Z-ADD*ZERO     WAEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WAEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field TH Live Wgt Org Usr
     C                     Z-ADD*ZERO     WUX1NB  71
      * Define work field TH Head Received
     C                     Z-ADD*ZERO     WUCWNB  50
      * Define work field Live Weight           USR
     C                     Z-ADD*ZERO     WUOONB  71
      * Define work field TH Live Wgt
     C                     Z-ADD*ZERO     WUCYNB  71
      * Define work field Head/Wt Variable Old  USR
     C                     Z-ADD*ZERO     WUOLNB  71
      * Define work field Head/Wt Variable New  USR
     C                     Z-ADD*ZERO     WUOMNB  71
      * Define work field *Synon (17,7) work field
     C                     Z-ADD*ZERO     WUWD   177
      * Define work field TH Deduction Amt
     C                     Z-ADD*ZERO     WUASPR  72
      * Define work field Hld Ovr Deduction amt USR
     C                     Z-ADD*ZERO     WUOENB  72
      * Define work field TH Total Net WO Adds
     C                     Z-ADD*ZERO     WUA4VA  72
      * Define work field Hld Ovr Tt Net wo AddsUSR
     C                     Z-ADD*ZERO     WUONNB  72
      * Define work field TH Additions Amt
     C                     Z-ADD*ZERO     WUA5VA  72
      * Define work field Hld Ovr Additions Amt USR
     C                     Z-ADD*ZERO     WUOFNB  72
      * Define work field TH Payment Gross
     C                     Z-ADD*ZERO     WUCBPR  72
      * Define work field Hld Ovr Paym Gross    USR
     C                     Z-ADD*ZERO     WUOGNB  72
      * Define work field Th Payment Net Amt
     C                     Z-ADD*ZERO     WUCCPR  72
      * Define work field Hld Ovr Paym Net Amt  USR
     C                     Z-ADD*ZERO     WUOHNB  72
      * Define work field TH Freight Amount
     C                     Z-ADD*ZERO     WUCDPR  72
      * Define work field Hld Ovr Freight Amt   USR
     C                     Z-ADD*ZERO     WUOINB  72
      * Define work field TH Live Gross Amt
     C                     Z-ADD*ZERO     WUB9PR  72
      * Define work field Hld Ovr Live Gross    USR
     C                     Z-ADD*ZERO     WUOJNB  72
      * Define work field TH LIve Net Amt
     C                     Z-ADD*ZERO     WUCAPR  72
      * Define work field Hld Ovr Live Net Amt  USR
     C                     Z-ADD*ZERO     WUOKNB  72
      * Define work field TH Shipped Weight
     C                     Z-ADD*ZERO     WUHGNB  71
      * Define work field Hld Ovr Shipped Wght Usr
     C                     Z-ADD*ZERO     WUZ5NB  71
      * Define work field TH Accrual Amount
     C                     Z-ADD*ZERO     WUA7VA  72
      * Define work field Hld Ovr Accrual Amt Usr
     C                     Z-ADD*ZERO     WUMGPR  72
      * Define work field Th Accruals Amt Org Usr
     C                     Z-ADD*ZERO     WUL8PR  72
      * Define work field Freight Cur Amount Usr
     C                     Z-ADD*ZERO     WUMEPR  72
      * Define work field TH Payment Sts
     C                     MOVEL*BLANK    WUCWST  2
      * Define work field Freight Nxt Amount Usr
     C                     Z-ADD*ZERO     WUMFPR  72
      * Define work field HC Description
     C                     MOVEL*BLANK    WUBDTX 25
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDC2NB           TD Sequence Num
     C                     Z-ADD*ZERO     WDCZNB           TD Live Wgt
     C                     Z-ADD*ZERO     WDC0NB           TD Pen Head
     C                     Z-ADD*ZERO     WDD8NB           TD Yard Dead
     C                     Z-ADD*ZERO     WDH7NB           TD Held Over
     C                     Z-ADD*ZERO     WDAJTM           TD Drive Time
     C                     Z-ADD*ZERO     WDJEA1           TD Drive Hour
     C                     Z-ADD*ZERO     WDB7CD           TD Drive Card N
     C                     Z-ADD*ZERO     WDD7NB           TD Avg Live Wgt
     C                     Z-ADD*ZERO     WDBVDT           TD User Date 1
     C                     Z-ADD*ZERO     WDBWDT           TD User Date 2
     C                     Z-ADD*ZERO     WDBXDT           TD Drive Date
     C                     Z-ADD*ZERO     WDHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WDH8NB           Held Over Pen C
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WECTNB           Pen Maximun Cap
     C                     Z-ADD*ZERO     WED6NB           Pen Current Hea
     C                     Z-ADD*ZERO     WEB6CD           Pen Current Dri
     C                     Z-ADD*ZERO     WEEBNB           Pen Drive Seque
     C                     Z-ADD*ZERO     WEHBNB           Pen Adjustment
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field Pen Description
     C                     MOVEL*BLANK    WUBBTX 25
      * Define work field GN Genetic Code
     C                     MOVEL*BLANK    WUAGCD  5
      * Define work field Pen Current Head
     C                     Z-ADD*ZERO     WUD6NB  50
      * Define work field Genetic Code USR
     C                     MOVEL*BLANK    WUA1CD  5
      * Define work field Pen Desc              USR
     C                     MOVEL*BLANK    WUJTTX 25
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field System Value Numeric  USR
     C                     Z-ADD*ZERO     WUVCNB 155
      * Define work field Company Value Code    USR
     C                     MOVEL*BLANK    WUFACD 10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAEA1           DF Market Perce
     C                     Z-ADD*ZERO     WKUOPR           DF Unused Price
     C                     Z-ADD*ZERO     WKUPPR           DF Unused Price
     C                     Z-ADD*ZERO     WKUQPR           DF Unused Price
     C                     Z-ADD*ZERO     WKAADT           RS Date Changed
     C                     Z-ADD*ZERO     WKAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WKABDT           RS Date Added
     C                     Z-ADD*ZERO     WKABTM           RS Time Added
      * Define work field HC Defect Required
     C                     MOVEL*BLANK    WUBXST  1
      * Define work field HC Price Required
     C                     MOVEL*BLANK    WUBYST  1
      * Define work field HC Resolution
     C                     MOVEL*BLANK    WUBITX 60
      * Define work field HC Qualification
     C                     MOVEL*BLANK    WUB0ST  1
      * Define work field HC Class Type
     C                     MOVEL*BLANK    WUFBST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WLABDT           RS Date Added
     C                     Z-ADD*ZERO     WLABTM           RS Time Added
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'Y'       W0PMT   1
      * Define local work field HC Class Type
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Tattoo Number USR
     C                     Z-ADD*ZERO     YL0002  50
      * Define local work field Company Value Code    USR
     C                     MOVEL*BLANK    YL0003 10
      * Define local work field Creation Point of Ttt USR
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Return Code USR
     C                     MOVEL*BLANK    YL0005  7
      * Define local work field SR Type
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field SBD Top Load Sts
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Tattoo Type USR
     C                     MOVEL*BLANK    YL0008  1
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * MODIFICATIONS
      * 11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP2EVTX    ##CMP
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
01309015650182102333025890284503357
036130386904125041350438104391
** W0END
01311015670182502337025930284903361
036150387504130041590438304415
** W0NAM
#1B7CD    #1CMCD    #1CVNB    #1C0NB    #1D8NB    #1H7NB    #DGENB
#DCBCD    #DB5NB    #DCTCD    #DBCTX    #DBECD    #DBDTX
