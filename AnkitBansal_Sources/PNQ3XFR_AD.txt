// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PNQ3XFR
// ?Date: 14.08.2025 Time: 03:46:14
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?--------- CIFRTO: Customer Item Freight Overage ----------
// PAR.Error Return = WRK.BLANK
PAR.Error_Return = WRK.BLANK;

//?* Retrieve the Rate and UOM from the Customer Price Element
EXECUTE FUNCTION(Rtv CustItem Prc Elem RT) TYPE(RTVOBJ) FILE(PNF8REP)           AC1981910;
PARAMETER(PAR.Ship_To_Customer);
PARAMETER(PAR.Item_Code);
PARAMETER('CIFRTO');
PARAMETER(PAR.CPE_Rate);
PARAMETER(PAR.CPE_Rate_UOM);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?* Convert the Rate to CWT
CASE;

// IF PAR.CPE Rate is Not Zeros
IF PAR.CPE_Rate <> *ZERO;

EXECUTE FUNCTION(Cvt Rate to CWT       IF) TYPE(EXCINTFUN)                      AC1978860;
PARAMETER(PAR.Pricing_Retrieved_Amount);
PARAMETER(PAR.CPE_Rate);
PARAMETER(PAR.CPE_Rate_UOM);
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Item_Code);
{
 //?Execute internal function

 //?Convert Rate to /CWT
 CASE;

 // IF PAR.IPE Rate UOM is Hundred Weight
 IF PAR.IPE_Rate_UOM = 'CW';

 // PAR.Price = PAR.IPE Rate
 PAR.Price = PAR.IPE_Rate;

 //?Convert Rate to /CWT
 // IF PAR.IPE Rate UOM is Pounds
 IF PAR.IPE_Rate_UOM = 'LB';

 // PAR.Price
 PAR.Price = PAR.IPE_Rate * 100 'H';

 //?Convert Rate to /CWT
 // IF PAR.IPE Rate UOM is Cases
 IF PAR.IPE_Rate_UOM = 'CS';

 EXECUTE FUNCTION(RTV Item Price Struct  RT) TYPE(RTVOBJ) FILE(CABZREP)          AC1230472;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Item_Code);
 PARAMETER(LCL.UOM_Primary);
 PARAMETER(LCL.Conversion_Factor_1);
 PARAMETER(LCL.Operation_Factor_1);
 PARAMETER(LCL.UOM_Second);
 PARAMETER(LCL.Conversion_Factor_2);
 PARAMETER(LCL.Operation_Factor_2);
 PARAMETER(LCL.UOM_Third);
 PARAMETER(LCL.UOM_Pricing);
 PARAMETER(LCL.Unit_Weight);
 PARAMETER(LCL.Market_Overage);
 PARAMETER(LCL.Standard_Overage_Underage);
 PARAMETER(LCL.Commodity_Price_Group);
 PARAMETER(LCL.Item_Pricing_Operation);
 PARAMETER(LCL.Item_Pricing_Constant);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // PAR.Price
 PAR.Price = ( PAR.IPE_Rate / LCL.Unit_Weight 'H' ) * 100 'H';

 ENDIF;

}


// IF *OTHERWISE
IF *OTHERWISE;

// PAR.Pricing Retrieved Amount = CON.*ZERO
PAR.Pricing_Retrieved_Amount = *ZERO;

ENDIF;

