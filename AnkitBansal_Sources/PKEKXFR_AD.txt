// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKEKXFR
// ?Date: 14.08.2025 Time: 02:51:30
// ?------------------------------------------------------------------------------------------------

//?Execute user function

// Call program Val Application/User  XF.
CALL PROGRAM(Val Application/User  XF) ('PDGXXFR');
PARAMETER(PAR.Oms_Warehouse_Code);
PARAMETER(PAR.CC_Company_Number);
PARAMETER('HPE');
PARAMETER(PAR.Oms_SalesPerson_Code);
PARAMETER(PAR.Oms_Allow_Multi_Company);
PARAMETER(PAR.Oms_Default_Printer);
PARAMETER(PAR.Oms_Name);
PARAMETER(PAR.Oms_System_Value_Alpha);
PARAMETER(PAR.Oms_Access_Denied_Y_N);

EXECUTE FUNCTION(Rtv/Chg Pen Drive Seq RT) TYPE(RTVOBJ) FILE(PKA3REP)           AB1184216;
PARAMETER(PAR.CC_Company_Number);
{
 //?USER: Initialize routine

 // WRK.Pen Drive Sequence = CON.-4
 WRK.Pen_Drive_Sequence = -4;

 //?USER: Process Data record

 //?Seq the pens with hogs starting at 1 then 5, 10, 15 ...
 CASE;

 // IF WRK.Pen Drive Sequence is One
 IF WRK.Pen_Drive_Sequence = 1;

 // WRK.Pen Drive Sequence = CON.5
 WRK.Pen_Drive_Sequence = 5;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // WRK.Pen Drive Sequence = WRK.Pen Drive Sequence + CON.5
 WRK.Pen_Drive_Sequence = WRK.Pen_Drive_Sequence + 5;

 ENDIF;

 EXECUTE FUNCTION(Chg Pen               CH) TYPE(CHGOBJ) FILE(PKA3REP)           AB1102758;
 PARAMETER(DB1.Pen_Company_Number);
 PARAMETER(DB1.Pen_Number);
 PARAMETER(DB1.Pen_Description);
 PARAMETER(DB1.Pen_Maximun_Capacity);
 PARAMETER(DB1.Pen_Current_Head);
 PARAMETER(DB1.Pen_Current_Drive_Card_No);
 PARAMETER(DB1.Pen_Sts);
 PARAMETER(WRK.Pen_Drive_Sequence);
 PARAMETER(DB1.Pen_Type);
 PARAMETER(DB1.Pen_Adjustment);
 PARAMETER(DB1.GN_Genetic_Code);
 PARAMETER(DB1.RS_User_Changed);
 PARAMETER(DB1.RS_Date_Changed);
 PARAMETER(DB1.RS_Time_Changed);
 PARAMETER(DB1.RS_Record_Status);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 PARAMETER(DB1.RS_User_Added);
 PARAMETER(DB1.RS_Date_Added);
 PARAMETER(DB1.RS_Time_Added);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // PAR.RS Date Changed = JOB.*Job date
   PAR.RS_Date_Changed = JOB.*Job_date;

   // PAR.RS Time Changed = JOB.*Job time
   PAR.RS_Time_Changed = JOB.*Job_time;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

}


