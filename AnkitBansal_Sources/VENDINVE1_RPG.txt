     H/TITLE Chk for Vndr/Inv E1   XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : E1IDEVMDL
     H* System        : E1IDEVMDL
     H* User name     : ISJBADE
     H* Date          : 08/14/20  Time  : 16:58:23
     H* Copyright     : E1IDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FE10411LD  IF   E           K DISK
      * RSQ : Run Log Vchr Dtl   F0411  Addr#/Inv#/InvDte
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              8  0
     D  WP0002         S             25
     D  WP0003         S              1
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  WQSA01         S                   LIKE(WAAN8)
     D  WQSA02         S                   LIKE(WAVINV)
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * I :  Address Number
     D  P1AN8                  1      8  0
     D P2PARM          DS
      * I :  Supplier Invoice Number
     D  P2VINV                 1     25
     D P3PARM          DS
      * O :  Exists (Y/N)
     D  P3J9ST                 1      1
     II0411LD
      * Run Log Vchr Dtl   F0411  Addr#/Inv#/InvDte
      * Renamed input format fields
     I              ELEDUS                      WAEDUS
     I              ELEDBT                      WAEDBT
     I              ELEDTN                      WAEDTN
     I              ELEDLN                      WAEDLN
     I              ELEDTY                      WAEDTY
     I              ELEDSQ                      WAEDSQ
     I              ELEDCT                      WAEDCT
     I              ELEDTS                      WAEDTS
     I              ELEDFT                      WAEDFT
     I              ELEDDT                      WAEDDT
     I              ELEDER                      WAEDER
     I              ELEDDL                      WAEDDL
     I              ELEDSP                      WAEDSP
     I              ELEDTC                      WAEDTC
     I              ELEDTR                      WAEDTR
     I              ELEDGL                      WAEDGL
     I              ELEDDH                      WAEDDH
     I              ELEDAN                      WAEDAN
     I              ELKCO                       WAKCO
     I              ELDOC                       WADOC
     I              ELDCT                       WADCT
     I              ELSFX                       WASFX
     I              ELSFXE                      WASFXE
     I              ELDCTA                      WADCTA
     I              ELAN8                       WAAN8
     I              ELPYE                       WAPYE
     I              ELSNTO                      WASNTO
     I              ELDIVJ                      WADIVJ
     I              ELDSVJ                      WADSVJ
     I              ELDDJ                       WADDJ
     I              ELDDNJ                      WADDNJ
     I              ELDGJ                       WADGJ
     I              ELFY                        WAFY
     I              ELCTRY                      WACTRY
     I              ELPN                        WAPN
     I              ELCO                        WACO
     I              ELICU                       WAICU
     I              ELICUT                      WAICUT
     I              ELDICJ                      WADICJ
     I              ELBALJ                      WABALJ
     I              ELPSTC                      WAPSTC
     I              ELAG                        WAAG
     I              ELAAP                       WAAAP
     I              ELADSC                      WAADSC
     I              ELADSA                      WAADSA
     I              ELATXA                      WAATXA
     I              ELATXN                      WAATXN
     I              ELSTAM                      WASTAM
     I              ELTXA1                      WATXA1
     I              ELEXR1                      WAEXR1
     I              ELCRRM                      WACRRM
     I              ELCRCD                      WACRCD
     I              ELCRR                       WACRR
     I              ELACR                       WAACR
     I              ELFAP                       WAFAP
     I              ELCDS                       WACDS
     I              ELCDSA                      WACDSA
     I              ELCTXA                      WACTXA
     I              ELCTXN                      WACTXN
     I              ELCTAM                      WACTAM
     I              ELGLC                       WAGLC
     I              ELGLBA                      WAGLBA
     I              ELPOST                      WAPOST
     I              ELAM                        WAAM
     I              ELAID2                      WAAID2
     I              ELMCU                       WAMCU
     I              ELOBJ                       WAOBJ
     I              ELSUB                       WASUB
     I              ELSBLT                      WASBLT
     I              ELSBL                       WASBL
     I              ELBAID                      WABAID
     I              ELPTC                       WAPTC
     I              ELVOD                       WAVOD
     I              ELOKCO                      WAOKCO
     I              ELODCT                      WAODCT
     I              ELODOC                      WAODOC
     I              ELOSFX                      WAOSFX
     I              ELCRC                       WACRC
     I              ELVINV                      WAVINV
     I              ELPKCO                      WAPKCO
     I              ELPO                        WAPO
     I              ELPDCT                      WAPDCT
     I              ELLNID                      WALNID
     I              ELSFXO                      WASFXO
     I              ELOPSQ                      WAOPSQ
     I              ELVR01                      WAVR01
     I              ELUNIT                      WAUNIT
     I              ELMCU2                      WAMCU2
     I              ELRMK                       WARMK
     I              ELRF                        WARF
     I              ELDRF                       WADRF
     I              ELCTL                       WACTL
     I              ELFNLP                      WAFNLP
     I              ELU                         WAU
     I              ELUM                        WAUM
     I              ELPYIN                      WAPYIN
     I              ELTXA3                      WATXA3
     I              ELEXR3                      WAEXR3
     I              ELRP1                       WARP1
     I              ELRP2                       WARP2
     I              ELRP3                       WARP3
     I              ELAC07                      WAAC07
     I              ELTNN                       WATNN
     I              ELDMCD                      WADMCD
     I              ELITM                       WAITM
     I              ELHCRR                      WAHCRR
     I              ELHDGJ                      WAHDGJ
     I              ELURCD                      WAURCD
     I              ELURDT                      WAURDT
     I              ELURAT                      WAURAT
     I              ELURAB                      WAURAB
     I              ELURRF                      WAURRF
     I              ELTORG                      WATORG
     I              ELUSER                      WAUSER
     I              ELPID                       WAPID
     I              ELUPMJ                      WAUPMJ
     I              ELUPMT                      WAUPMT
     I              ELJOBN                      WAJOBN
     I              ELDIM                       WADIM
     I              ELDID                       WADID
     I              ELDIY                       WADIY
     I              ELDI#                       WADI#
     I              ELDSVM                      WADSVM
     I              ELDSVD                      WADSVD
     I              ELDSVY                      WADSVY
     I              ELDSV#                      WADSV#
     I              ELDDM                       WADDM
     I              ELDDDA                      WADDDA
     I              ELDDY                       WADDY
     I              ELDD#                       WADD#
     I              ELDDNM                      WADDNM
     I              ELDDND                      WADDND
     I              ELDDNY                      WADDNY
     I              ELDDN#                      WADDN#
     I              ELDGM                       WADGM
     I              ELDGD                       WADGD
     I              ELDGY                       WADGY
     I              ELDG#                       WADG#
     I              ELDICM                      WADICM
     I              ELDICD                      WADICD
     I              ELDICY                      WADICY
     I              ELDIC#                      WADIC#
     I              ELHDGM                      WAHDGM
     I              ELHDGD                      WAHDGD
     I              ELHDGY                      WAHDGY
     I              ELHDG#                      WAHDG#
     I              ELDOCM                      WADOCM
     I              ELTNST                      WATNST
     I              ELYC01                      WAYC01
     I              ELYC02                      WAYC02
     I              ELYC03                      WAYC03
     I              ELYC04                      WAYC04
     I              ELYC05                      WAYC05
     I              ELYC06                      WAYC06
     I              ELYC07                      WAYC07
     I              ELYC08                      WAYC08
     I              ELYC09                      WAYC09
     I              ELYC10                      WAYC10
     I              ELDTXS                      WADTXS
     I              ELBCRC                      WABCRC
     I              ELATAD                      WAATAD
     I              ELCTAD                      WACTAD
     I              ELNRTA                      WANRTA
     I              ELFNRT                      WAFNRT
     I              ELTAXP                      WATAXP
     I              ELPRGF                      WAPRGF
     I              ELGFL5                      WAGFL5
     I              ELGFL6                      WAGFL6
     I              ELGAM1                      WAGAM1
     I              ELGAM2                      WAGAM2
     I              ELGEN4                      WAGEN4
     I              ELGEN5                      WAGEN5
     I              ELWTAD                      WAWTAD
     I              ELWTAF                      WAWTAF
     I              ELSMMF                      WASMMF
     I              ELPYWP                      WAPYWP
     I              ELPWPG                      WAPWPG
     I              ELNETS                      WANETS
     I              ELATFL                      WAATFL
     I              ELATRL                      WAATRL
     I              ELJOBS                      WAJOBS
     I              ELPSTE                      WAPSTE
     I              ELDWST                      WADWST
     I              ELABDT                      WAABDT
     I              ELABTM                      WAABTM
     I              ELAJVN                      WAAJVN
     I              ELAKVN                      WAAKVN
     I              ELACDT                      WAACDT
     I              ELACTM                      WAACTM
     I              ELALVN                      WAALVN
     I              ELAMVN                      WAAMVN
     I              ELO6TX                      WAO6TX
     I              ELO7TX                      WAO7TX
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1AN8         PARM                    WP0001                         Address Number
     C     P2VINV        PARM                    WP0002                         Supplier Invoic
     C     P3J9ST        PARM      P3J9ST        WP0003                         Exists (Y/N)
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Chk for Vndr/Inv E1   XF
      * Chk for Vndr/Inv E1   RT - Run Log Vchr Dtl   F0411  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Chk for Vndr/Inv E1   RT - Run Log Vchr Dtl   F0411  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WQSA01                         Address Number
     C                   KFLD                    WQSA02                         Supplier Invoic
      * Setup key
     C                   Z-ADD     P1AN8         WQSA01                         Address Number
     C                   MOVEL     P2VINV        WQSA02                         Supplier Invoic
      * Establish starting position
     C     KRSSA         SETLL     I0411LD                                      *
     C     KRSSA         READE     I0411LD                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'E1I0074'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'N'           P3J9ST                         Exists (Y/N)
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   MOVEL     'Y'           P3J9ST                         Exists (Y/N)
     C     KRSSA         READE     I0411LD                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAEDLN                         EDI - Line Numb
     C                   Z-ADD     *ZERO         WAEDSQ                         Record Sequence
     C                   Z-ADD     *ZERO         WAEDDT                         EDI - Transmiss
     C                   Z-ADD     *ZERO         WAEDDL                         EDI - Dtl Lines
     C                   Z-ADD     *ZERO         WAEDAN                         User Address nu
     C                   Z-ADD     *ZERO         WADOC                          Document Number
     C                   Z-ADD     *ZERO         WASFXE                         Pay Item Extens
     C                   Z-ADD     *ZERO         WAAN8                          Address Number
     C                   Z-ADD     *ZERO         WAPYE                          Payee Address N
     C                   Z-ADD     *ZERO         WASNTO                         Address Number
     C                   Z-ADD     *ZERO         WADIVJ                         Invoice Date -
     C                   Z-ADD     *ZERO         WADSVJ                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WADDJ                          Date - Net Due
     C                   Z-ADD     *ZERO         WADDNJ                         Discount Due Da
     C                   Z-ADD     *ZERO         WADGJ                          G/L Date
     C                   Z-ADD     *ZERO         WAFY                           Fiscal Year
     C                   Z-ADD     *ZERO         WACTRY                         Century
     C                   Z-ADD     *ZERO         WAPN                           Period Number -
     C                   Z-ADD     *ZERO         WAICU                          Batch Number
     C                   Z-ADD     *ZERO         WADICJ                         Batch Date
     C                   Z-ADD     *ZERO         WAAG                           Gross Amount
     C                   Z-ADD     *ZERO         WAAAP                          Open Amount
     C                   Z-ADD     *ZERO         WAADSC                         Discount Availa
     C                   Z-ADD     *ZERO         WAADSA                         Discount Taken
     C                   Z-ADD     *ZERO         WAATXA                         Taxable Amount
     C                   Z-ADD     *ZERO         WAATXN                         Non-Taxable Amo
     C                   Z-ADD     *ZERO         WASTAM                         Tax Amount
     C                   Z-ADD     *ZERO         WACRR                          Currency Conver
     C                   Z-ADD     *ZERO         WAACR                          Currency Amount
     C                   Z-ADD     *ZERO         WAFAP                          Foreign Open Am
     C                   Z-ADD     *ZERO         WACDS                          Foreign Disc Av
     C                   Z-ADD     *ZERO         WACDSA                         Foreign Disc Ta
     C                   Z-ADD     *ZERO         WACTXA                         Foreign Taxable
     C                   Z-ADD     *ZERO         WACTXN                         Foreign Non-Tax
     C                   Z-ADD     *ZERO         WACTAM                         Foreign Tax Amo
     C                   Z-ADD     *ZERO         WAODOC                         Document - Orig
     C                   Z-ADD     *ZERO         WALNID                         Line number
     C                   Z-ADD     *ZERO         WAOPSQ                         Sequence Nbr -
     C                   Z-ADD     *ZERO         WADRF                          Recurring Freq
     C                   Z-ADD     *ZERO         WAU                            Units
     C                   Z-ADD     *ZERO         WAITM                          Item Number - S
     C                   Z-ADD     *ZERO         WAHCRR                         Historical Curr
     C                   Z-ADD     *ZERO         WAHDGJ                         Historical Date
     C                   Z-ADD     *ZERO         WAURDT                         User Reserved D
     C                   Z-ADD     *ZERO         WAURAT                         User Reserved A
     C                   Z-ADD     *ZERO         WAURAB                         User Reserved N
     C                   Z-ADD     *ZERO         WAUPMJ                         Date - Updated
     C                   Z-ADD     *ZERO         WAUPMT                         Time - Last Upd
     C                   Z-ADD     *ZERO         WADIM                          Invoice Date -
     C                   Z-ADD     *ZERO         WADID                          Invoice Date -
     C                   Z-ADD     *ZERO         WADIY                          Invoice Date -
     C                   Z-ADD     *ZERO         WADI#                          Invoice Date -
     C                   Z-ADD     *ZERO         WADSVM                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WADSVD                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WADSVY                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WADSV#                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WADDM                          Net Due Date -
     C                   Z-ADD     *ZERO         WADDDA                         Net Due Date -
     C                   Z-ADD     *ZERO         WADDY                          Net Due Date -
     C                   Z-ADD     *ZERO         WADD#                          Net Due Date -
     C                   Z-ADD     *ZERO         WADDNM                         Discount Due Da
     C                   Z-ADD     *ZERO         WADDND                         Discount Due Da
     C                   Z-ADD     *ZERO         WADDNY                         Discount Due Da
     C                   Z-ADD     *ZERO         WADDN#                         Discount Due Da
     C                   Z-ADD     *ZERO         WADGM                          G/L Date - MO
     C                   Z-ADD     *ZERO         WADGD                          G/L Date - DA
     C                   Z-ADD     *ZERO         WADGY                          G/L Date - YR
     C                   Z-ADD     *ZERO         WADG#                          G/L Date - CTRY
     C                   Z-ADD     *ZERO         WADICM                         Batch Date - MO
     C                   Z-ADD     *ZERO         WADICD                         Batch Date - DA
     C                   Z-ADD     *ZERO         WADICY                         Batch Date - YR
     C                   Z-ADD     *ZERO         WADIC#                         Batch Date - CT
     C                   Z-ADD     *ZERO         WAHDGM                         Historical Date
     C                   Z-ADD     *ZERO         WAHDGD                         Historical Date
     C                   Z-ADD     *ZERO         WAHDGY                         Historical Date
     C                   Z-ADD     *ZERO         WAHDG#                         Historical Date
     C                   Z-ADD     *ZERO         WADOCM                         Document Matchi
     C                   Z-ADD     *ZERO         WAATAD                         Amount To Distr
     C                   Z-ADD     *ZERO         WACTAD                         Currency to Dis
     C                   Z-ADD     *ZERO         WANRTA                         Non-Recoverable
     C                   Z-ADD     *ZERO         WAFNRT                         Non-Recoverable
     C                   Z-ADD     *ZERO         WAGAM1                         Generic Amount
     C                   Z-ADD     *ZERO         WAGAM2                         Generic Amount
     C                   Z-ADD     *ZERO         WAWTAD                         Future W/H Tax
     C                   Z-ADD     *ZERO         WAWTAF                         Future W/H Tax
     C                   Z-ADD     *ZERO         WAPWPG                         Pay When Paid G
     C                   Z-ADD     *ZERO         WAJOBS                         Job Number
     C                   Z-ADD     *ZERO         WAABDT                         Create Date
     C                   Z-ADD     *ZERO         WAABTM                         Create Time
     C                   Z-ADD     *ZERO         WAACDT                         Change Date
     C                   Z-ADD     *ZERO         WAACTM                         Change Time
     C                   MOVEL     'N'           W0PMT
      *================================================================
     CSR   ZZEXIT        ENDSR
