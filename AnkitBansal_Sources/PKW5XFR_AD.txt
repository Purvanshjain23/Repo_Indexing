// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKW5XFR
// ?Date: 14.08.2025 Time: 02:50:43
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?H16853 ISE 11/05/2020-Recompiled due to change in Buy Order Number
// WRK.BOH Company Number = CON.360
WRK.BOH_Company_Number = 360;

EXECUTE FUNCTION(Rtv Bo Header Crt Test RT) TYPE(RTVOBJ) FILE(PKAWCPP)          AB1164981;
PARAMETER(WRK.BOH_Company_Number);
{
 //?USER: Process Data record

 CASE;

 // IF DB1.BOH Buy Order Type is Contract or Internal
 IF DB1.BOH_Buy_Order_Type = 'C'/'I';

 EXECUTE FUNCTION(Rtv Sub-Contract Info RT) TYPE(RTVOBJ) FILE(PKAQCPP)           AB1110451;
 PARAMETER(DB1.PC_Contract_Code);
 PARAMETER(DB1.PSC_Sub_Contract_Code);
 PARAMETER(WRK.PSC_Sub_Contract_Type);
 PARAMETER(WRK.PSC_Commodity_Market_Code);
 PARAMETER(WRK.PSC_Commodity_Price_Group);
 PARAMETER(WRK.PSC_Mkt_+_or);
 PARAMETER(WRK.PSC_Market_Date_Method);
 PARAMETER(WRK.GN_Genetic_Code);
 PARAMETER(WRK.PO_Option_Code);
 PARAMETER(WRK.CMP_Program_Code);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // WRK.BOH Market Add/Deduct = WRK.PSC Mkt + or -
 WRK.BOH_Market_Add_Deduct = WRK.PSC_Mkt_+_or;

 // WRK.BOH Commodity Market Code = WRK.PSC Commodity Market Code
 WRK.BOH_Commodity_Market_Code = WRK.PSC_Commodity_Market_Code;

 // WRK.BOH Commodity Price Group = WRK.PSC Commodity Price Group
 WRK.BOH_Commodity_Price_Group = WRK.PSC_Commodity_Price_Group;

 // WRK.BOH Market Date Method = WRK.PSC Market Date Method
 WRK.BOH_Market_Date_Method = WRK.PSC_Market_Date_Method;

 EXECUTE FUNCTION(Chg Buy Order mkt/Prc CH) TYPE(CHGOBJ) FILE(PKAWCPP)           AB1164982;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(WRK.BOH_Market_Add_Deduct);
 PARAMETER(WRK.BOH_Commodity_Market_Code);
 PARAMETER(WRK.BOH_Commodity_Price_Group);
 PARAMETER(WRK.BOH_Market_Date_Method);
 PARAMETER(WRK.GN_Genetic_Code);
 PARAMETER(WRK.PO_Option_Code);
 PARAMETER(WRK.CMP_Program_Code);
 {
  //?USER: Processing before Data read

  CASE;

  // IF PAR.BOH Status is Locked
  IF PAR.BOH_Status = 'L';

  QUIT;

  ENDIF;

  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // PAR.RS Date Changed = JOB.*Job date
   PAR.RS_Date_Changed = JOB.*Job_date;

   // PAR.RS Time Changed = JOB.*Job time
   PAR.RS_Time_Changed = JOB.*Job_time;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

 // IF *OTHERWISE
 IF *OTHERWISE;

 ENDIF;

}


