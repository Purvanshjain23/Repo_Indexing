/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - CL PROGRAM FOR SENDING THE MPR STATUS MESSAGES       */
/*                                                                  */
/*                                                                  */
/*  NOTE  ***** MUST BE COMPILED USER PROFILE(*OWNER)   *****       */
/*                                                                  */
/*  SYSTEM    - HOG PROCUREMENT AND EVALUATION                      */
/*  DATE      - 04/03/01                                            */
/*  DEVELOPER - ROSE CENTONZE                                       */
/*                                                                  */
/********************************************************************/
/* MODIFICATIONS:                                                   */
/*  RMC 8/15/02   USE SNDPGRMSG A LIEU SNDDST                       */
/*  RMC 11/18/05  PASS CO PARM AND SEND IN MSG, CHG DIST PER COMPANY */
/*  RMC 11/16/11  NOW, UNDO IS STEP 2 AND SEND FILES IS STEP 3     */
/*  RMC 06/07/16  ADDED MSG 8 FOR WHEN LS118A ONLY SENT           */
/*  JBB 02/16/17  ADDED DISTRIBUTION NAME FOR COMPANY 440           */
/********************************************************************/
             PGM        PARM(&MSGNBR &PLTCO)
/* WORK FIELDS */
             DCL        VAR(&USRCLS) TYPE(*CHAR) LEN(10)
             DCL        VAR(&DIST) TYPE(*CHAR) LEN(10)
             DCL        VAR(&RPTDTE) TYPE(*CHAR) LEN(6)  /*REPORTING D AY STS */
             DCL        VAR(&TIME)   TYPE(*CHAR) LEN(6)   /*SYSTEM TIME       */
             DCL        VAR(&MSGNBR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&MSG) TYPE(*CHAR) LEN(132)
             DCL        VAR(&PLTCO) TYPE(*CHAR) LEN(3)
/*-----------------------------------------------------------------*/
/* INITILIZATION                                                   */
/*-----------------------------------------------------------------*/
/* RETREIVE USER CLASS */
             RTVUSRPRF  USRCLS(&USRCLS)
             IF COND(&USRCLS *EQ '*PGMR') THEN(DO)
                CHGVAR VAR(&DIST) VALUE('PRKDEV2')
                ENDDO
                  ELSE IF COND(&PLTCO *EQ '360')  +
               THEN(CHGVAR VAR(&DIST) VALUE('PRKMPR'))
                  ELSE IF COND(&PLTCO *EQ '440')  +
               THEN(CHGVAR VAR(&DIST) VALUE('PRKMPRSP'))
                  ELSE IF COND(&PLTCO *EQ '960')  +
               THEN(CHGVAR VAR(&DIST) VALUE('PRKMPRTF'))

/*-----------------------------------------------------------------*/
/* MAINLINE                                                        */
/*-----------------------------------------------------------------*/
             /* SET UP DATE AND TIME */
             RTVSYSVAL  SYSVAL(QDATE) RTNVAR(&RPTDTE)
             RTVSYSVAL  SYSVAL(QTIME) RTNVAR(&TIME)
             IF COND(&MSGNBR *EQ '1') THEN(DO)
             CHGVAR     VAR(&MSG) VALUE('MPR - Prior Day Job has +
               started' *BCAT &PLTCO *BCAT &RPTDTE *BCAT &TIME)
                          ENDDO
             IF COND(&MSGNBR *EQ '2') THEN(DO)
             CHGVAR     VAR(&MSG) VALUE('MPR - Prior Day Job has +
                 completed normally' *BCAT &PLTCO *BCAT &RPTDTE *BCAT +
                          &TIME)
                          ENDDO
             IF COND(&MSGNBR *EQ '3') THEN(DO)
             CHGVAR     VAR(&MSG) VALUE('MPR - Morning Purchase Job +
                  has completed normally' *BCAT &PLTCO *BCAT &RPTDTE +
                          *BCAT &TIME)
                          ENDDO
             IF COND(&MSGNBR *EQ '4') THEN(DO)
             CHGVAR     VAR(&MSG) VALUE('MPR - Afternoon Purchase +
                Job has completed normally' *BCAT &PLTCO *BCAT &RPTDTE +
                          *BCAT &TIME)
                          ENDDO
             IF COND(&MSGNBR *EQ '5') THEN(DO)
             CHGVAR     VAR(&MSG) VALUE('MPR - 1. Payment Edit +
                  completed normally' *BCAT &PLTCO *BCAT &RPTDTE *BCAT +
                          &TIME)
                          ENDDO
             IF COND(&MSGNBR *EQ '6') THEN(DO)
             CHGVAR     VAR(&MSG) VALUE('MPR - 2. Undo Payment Edit +
                          completed normally' *BCAT &PLTCO *BCAT &RPTDTE *BCAT +
                          &TIME)
                          ENDDO
             IF COND(&MSGNBR *EQ '7') THEN(DO)
             CHGVAR     VAR(&MSG) VALUE('MPR - 3. Files have been +
                  sent to the USDA normally' *BCAT &PLTCO *BCAT &RPTDTE +
                          *BCAT &TIME)
                          ENDDO
             IF COND(&MSGNBR *EQ '8') THEN(DO)
             CHGVAR     VAR(&MSG) VALUE('MPR - LS118A Prior Day +
                          Scheduled sent to the USDA normally' +
                          *BCAT &PLTCO *BCAT &RPTDTE *BCAT &TIME)
                          ENDDO
             IF COND(&MSGNBR *EQ 'T') THEN(DO)
             CHGVAR     VAR(&MSG) VALUE('TESTING. LOGON')
                          ENDDO
             SNDPGRMSG  TOPGR(&DIST) MSG(&MSG) CONFMSG(*NO)

/*-----------------------------------------------------------------*/
/* END PROGRAM                                                     */
/*-----------------------------------------------------------------*/
 ENDPGM:

             ENDPGM
