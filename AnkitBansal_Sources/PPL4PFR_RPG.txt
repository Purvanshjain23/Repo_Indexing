     H/TITLE Prt Claim-Claim       PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 06/07/23  Time  : 15:28:21
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDMKCPL1IF  E           K        DISK
      * RTV : AR Claim Header           Retrieval index
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOMHSTPL1IF  E           K        DISK
      * RTV : Sales History             Retrieval index
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FOMFLCPL8IF  E           K        DISK
      * RSQ : Load Detail               Co/Order
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FPDMNCPL2IF  E           K        DISK
      * RTV : AR Claim Explanation      Retrieval Index Expl Onl
      *
     FPDMOCPL1IF  E           K        DISK
      * RTV : AR Claim Product          Retrieval index
      *
     FPDMPCPL1IF  E           K        DISK
      * RTV : AR Claim Resale Product   Retrieval index
      *
     FPPA1CPL1IF  E           K        DISK
      * RTV : AR Claim Expense          Retrieval index
      *
     FPPA2CPL1IF  E           K        DISK
      * RTV : AR Claim Expense Com      Retrieval index
      *
     FPDMNCPL7IF  E           K        DISK
      * RSQ : AR Claim Explanation      Claim Exp/Clm/OpenAction
      *
     FPDMNCPL5IF  E           K        DISK
      * RSQ : AR Claim Explanation      By Notedate/Usr Seq#/Seq
      *
     FPPL4PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Claim-Claim       PF  Print file
      *
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  03  6   @CN    25
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@MNCPSP
      * AR Claim Explanation      Claim Exp/Clm/OpenAction
      * Renamed input format fields
     I              MNC0C7                          WBC0C7
     I              MNAANX                          WBAANX
     I              MNPYTX                          WBPYTX
     I              MNLGNY                          WBLGNY
     I              MNRRDT                          WBRRDT
     I              MNL1TX                          WBL1TX
     I              MNN7T1                          WBN7T1
     I              MNRSDT                          WBRSDT
     I              MNC9TM                          WBC9TM
     I              MNL2TX                          WBL2TX
     I              MNVSST                          WBVSST
     I              MNMJDT                          WBMJDT
     I              MNBETM                          WBBETM
     I              MNCCVN                          WBCCVN
     I              MNCDVN                          WBCDVN
     I              MNMKDT                          WBMKDT
     I              MNBFTM                          WBBFTM
     I              MNCEVN                          WBCEVN
     I              MNCFVN                          WBCFVN
      *
     I@MNCPSI
      * AR Claim Explanation      By Notedate/Usr Seq#/Seq
      * Renamed input format fields
     I              MNC0C7                          WCC0C7
     I              MNAANX                          WCAANX
     I              MNPYTX                          WCPYTX
     I              MNLGNY                          WCLGNY
     I              MNRRDT                          WCRRDT
     I              MNL1TX                          WCL1TX
     I              MNN7T1                          WCN7T1
     I              MNRSDT                          WCRSDT
     I              MNC9TM                          WCC9TM
     I              MNL2TX                          WCL2TX
     I              MNVSST                          WCVSST
     I              MNMJDT                          WCMJDT
     I              MNBETM                          WCBETM
     I              MNCCVN                          WCCCVN
     I              MNCDVN                          WCCDVN
     I              MNMKDT                          WCMKDT
     I              MNBFTM                          WCBFTM
     I              MNCEVN                          WCCEVN
     I              MNCFVN                          WCCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: AR Claim Header
      * I : RST Claim Number
     I                                    P   1   40P1C0C7
      * N :  Salesperson to Rvw Claim
     I                                        5   7 P1ZLCD
      * I : MAP Claim Company Number
     I                                    P   8   90P1BIC3
      * N :  Claim Order Number
     I                                    P  10  130P1ALNX
      * N :  Load ID
     I                                    P  14  170P1RMNB
      * N :  Claim Ship to Customer
     I                                    P  18  210P1C3C7
      * N :  Claim Customer Name
     I                                       22  51 P1RFTX
      * N :  Claim Type
     I                                       52  53 P1CHSX
      * N :  Claim Status
     I                                       54  54 P1CJSX
      * N :  Claim Amount
     I                                    P  55  602P1AYVL
      * N :  Claim Net Loss
     I                                    P  61  662P1AZVL
      * N :  Claim Approved Amount
     I                                    P  67  722P1A0VL
      * N :  Claim Contact Name
     I                                       73 102 P1PQTX
      * N : MAP Claim Resolution Explan.
     I                                      103 142 P1TBTX
     IP2PARM      DS
      * FLD: *Arrays
      * I :  Claim Audit Selection Usr
     I                                        1   1 P2L9TX
      * I :  Claim Audit Co Value Usr
     I                                        2  11 P2JDAA
      * I :  Approval Claim Audit Eml
     I                                       12  61 P2N9T1
      * I :  Claim Prt AuditNotes  USR
     I                                       62  65 P2METX
      * I :  Claim Prt IntrlNotes  USR
     I                                       66  69 P2L3TX
      * I :  Claim Print Type
     I                                       70  70 P2MGTX
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1C0C7    PARM           WP0001  70       Claim Number
     C           P1BIC3    PARM           WP0002  30       Claim Company N
     C           P2L9TX    PARM           WP0003  1        Claim Audit Sel
     C           P2JDAA    PARM           WP0004 10        Claim Audit Co
     C           P2N9T1    PARM           WP0005 50        Approval Claim
     C           P2METX    PARM           WP0006  4        Claim Prt Audit
     C           P2L3TX    PARM           WP0007  4        Claim Prt Intrl
     C           P2MGTX    PARM           WP0008  1        Claim Print Typ
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Claim-Claim       PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$YENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Claim-Claim       PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN MKC0C7    WQKA01           Claim Number
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Claim Number
      * Setup key
     C                     Z-ADDP1C0C7    WQKA01           Claim Number
      * Establish starting position
     C           KRSA      SETLL@MKCPWB                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDMKBIC3    $DBIC3           Claim Company N
     C                     Z-ADDMKC0C7    $DC0C7           Claim Number
     C                     MOVEL*BLANK    $DFCT1           Claim Type Desc
     C                     MOVEL*BLANK    $DRQTX           Claim Status De
     C                     Z-ADDMKC3C7    $DC3C7           Claim Ship to C
     C                     MOVELMKRFTX    $DRFTX           Claim Customer
     C                     MOVEL*BLANK    $DCEST           Invoice Suffix
     C                     MOVEL*BLANK    $DBVTX           Telephone Numbe
     C                     MOVEL*BLANK    $DBCNA           Customer Purcha
     C                     Z-ADDMKEQVL    $DEQVL           FPR ID
     C                     Z-ADD*ZERO     $DAHNZ           FPR ID USR
     C                     MOVELMKZLCD    $DZLCD           Salesperson to
     C                     MOVEL*BLANK    $DALTX           Salesperson Nam
     C                     Z-ADDMKAYVL    $DAYVL           Claim Amount
     C                     Z-ADDMKAZVL    $DAZVL           Claim Net Loss
     C                     MOVELMKCHSX    $DCHSX           Claim Type
     C                     Z-ADDMKALNX    $DALNX           Claim Order Num
     C                     Z-ADDMKRMNB    $DRMNB           Load ID
     C                     Z-ADD*ZERO     $DCONB           Invoice Number
     C                     Z-ADD*ZERO     $DF9DT           Actual Ship Dat
     C                     Z-ADDMKEJDT    $DEJDT           Actual Delivery
     C                     MOVELMKUASX    $DUASX           AC Shipping Met
     C                     MOVEL*BLANK    $DDGU1           ACR Shipping Me
     C                     MOVELMKUBSX    $DUBSX           AC Full Return
     C                     MOVELMKO2NA    $DO2NA           Resale Purchase
     C                     MOVELMKCJSX    $DCJSX           Claim Status
     C                     MOVELMKPQTX    $DPQTX           Claim Contact N
     C                     MOVEL*BLANK    $DF8NA           Warehouse Descr
     C                     MOVEL*BLANK    $DDXTX           Trailer Id
     C                     MOVEL*BLANK    $DBZNA           Carrier Code
     C                     MOVELMKCNSX    $DCNSX           Product Inspect
     C                     MOVELMKPLTX    $DPLTX           Product Inspect
     C                     MOVELMKCOSX    $DCOSX           Rep Inspection
     C                     MOVELMKPMTX    $DPMTX           Rep Inspection
     C                     MOVELMKCPSX    $DCPSX           Lab Fee Involve
     C                     Z-ADDMKA1VL    $DA1VL           Lab Fee
     C                     MOVELMKPNTX    $DPNTX           Driver Name
     C                     MOVELMKPOTX    $DPOTX           Lab Name
     C                     Z-ADDMKMLDT    $DMLDT           Resolve Claim b
     C                     MOVELMKCQSX    $DCQSX           Claim Called in
     C                     MOVEL*BLANK    $DRRTX           Called in desc
     C                     MOVELMKPPTX    $DPPTX           Claim Called in
     C                     Z-ADDMKMMDT    $DMMDT           Claim Called in
     C                     MOVELMKCGVN    $DCGVN           Claim Entry Use
     C                     Z-ADDMKMNDT    $DMNDT           Claim Entry Dat
     C                     Z-ADDMKA0VL    $DA0VL           Claim Approved
     C                     Z-ADDMKBGTM    $DBGTM           Claim Entry Tim
     C                     Z-ADDMKC4C7    $DC4C7           Resale Ship to
     C                     Z-ADDMKNFDT    $DNFDT           Sales Approved
     C                     Z-ADDMKBJTM    $DBJTM           Sales Approved
     C                     MOVELMKCQVN    $DCQVN           Sales Approved
     C                     Z-ADDMKMODT    $DMODT           Approved/Denied
     C                     Z-ADDMKBHTM    $DBHTM           Approved/Denied
     C                     MOVELMKCHVN    $DCHVN           Approved/Denied
     C                     MOVELMKCRSX    $DCRSX           Memo Created
     C                     Z-ADDMKMPDT    $DMPDT           Memo Created Da
     C                     Z-ADDMKBITM    $DBITM           Memo Created Ti
     C                     MOVELMKCIVN    $DCIVN           Memo Created Us
     C                     MOVELMKTBTX    $DTBTX           Claim Resolutio
     C                     Z-ADDMKEOVL    $DEOVL           Approved Net Lo
     C                     Z-ADDMKEPVL    $DEPVL           Total Expense A
     C                     Z-ADDMKP6DT    $DP6DT           Memo Post Date
     C                     Z-ADDMKCRTM    $DCRTM           Memo Post Time
     C                     Z-ADDMKYSNX    $DYSNX           TFS Batch Numbe
     C                     MOVELMKT5SX    $DT5SX           TFS Process Sta
     C                     Z-ADDMKF7PC    $DF7PC           Avg TF Responsi
     C                     Z-ADDMKF8PC    $DF8PC           Avg SBF Respons
     C                     Z-ADDMKF9PC    $DF9PC           STF Responsibil
     C                     Z-ADDMKERVL    $DERVL           AC Unused Value
     C                     Z-ADDMKESVL    $DESVL           AC Unused Value
     C                     Z-ADDMKETVL    $DETVL           AC Unused Value
     C                     MOVELMKT7SX    $DT7SX           Claim Prod Affe
     C                     MOVELMKT8SX    $DT8SX           ARC Unused Stat
     C                     MOVELMKT9SX    $DT9SX           ARC Unused Stat
     C                     Z-ADDMKGAPC    $DGAPC           AC Unused Pct 1
     C                     Z-ADDMKGBPC    $DGBPC           AC Unused Pct 2
     C                     MOVELMKVSST    $DVSST           Record Status
     C                     Z-ADDMKMJDT    $DMJDT           Create Date
     C                     Z-ADDMKBETM    $DBETM           Create Time
     C                     MOVELMKCCVN    $DCCVN           Create User
     C                     MOVELMKCDVN    $DCDVN           Create Program
     C                     Z-ADDMKMKDT    $DMKDT           Change Date
     C                     Z-ADDMKBFTM    $DBFTM           Change Time
     C                     MOVELMKCEVN    $DCEVN           Change User
     C                     MOVELMKCFVN    $DCFVN           Change Program
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Claim-Comment
     C                     EXSR UGSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Claim-Products    PO
     C                     EXSR UHSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : PRT Claim-Resale Prd  PO
     C                     EXSR UISUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Claim-Expense     PO
     C                     EXSR UKSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@MKCPWB                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     ELSE
      * Next record - Detect level breaks
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EOFA    IFEQ '1'
      * Mention hidden format
     C   99N99             WRITE$UFINTTL
      * PRTOBJ calls after print of final totals format
      * Embedded PRTOBJ : Prt Claim-Comm System PO
     C                     EXSR UMSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Claim-Comm Intrl  PO
     C                     EXSR UNSUBR                     Embedded PRTOBJ
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt Claim-Comm Expl   PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN MNC0C7    WQKB01           Claim Number
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Claim Number
      * Setup key
     C                     Z-ADD$DC0C7    WQKB01           Claim Number
      * Establish starting position
     C           KRSB      SETLL@MNCPSE                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Claim Number
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDMNC0C7    $EC0C7           Claim Number
     C                     Z-ADDMNAANX    $EAANX           Claim Explanati
     C                     MOVELMNPYTX    $EPYTX           Claim Explanati
     C                     MOVELMNVSST    $EVSST           Record Status
     C                     Z-ADDMNMJDT    $EMJDT           Create Date
     C                     Z-ADDMNBETM    $EBETM           Create Time
     C                     MOVELMNCCVN    $ECCVN           Create User
     C                     MOVELMNCDVN    $ECDVN           Create Program
     C                     Z-ADDMNMKDT    $EMKDT           Change Date
     C                     Z-ADDMNBFTM    $EBFTM           Change Time
     C                     MOVELMNCEVN    $ECEVN           Change User
     C                     MOVELMNCFVN    $ECFVN           Change Program
      * Load related totals format
     C                     Z-ADDMNC0C7    $GC0C7           Claim Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDMNC0C7    $FC0C7           Claim Number
     C                     Z-ADDMNAANX    $FAANX           Claim Explanati
     C                     MOVELMNPYTX    $FPYTX           Claim Explanati
     C                     Z-ADDMNLGNY    $FLGNY           Claim Exp Usr S
     C                     Z-ADDMNRRDT    $FRRDT           Claim Expl Note
     C                     MOVELMNL1TX    $FL1TX           Claim Expl Type
     C                     MOVELMNN7T1    $FN7T1           Claim Expl Acti
     C                     Z-ADDMNRSDT    $FRSDT           Claim Expl Acti
     C                     Z-ADDMNC9TM    $FC9TM           Claim Expl Acti
     C                     MOVELMNL2TX    $FL2TX           Claim Departmen
     C                     MOVELMNVSST    $FVSST           Record Status
     C                     Z-ADDMNMJDT    $FMJDT           Create Date
     C                     Z-ADDMNBETM    $FBETM           Create Time
     C                     MOVELMNCCVN    $FCCVN           Create User
     C                     MOVELMNCDVN    $FCDVN           Create Program
     C                     Z-ADDMNMKDT    $FMKDT           Change Date
     C                     Z-ADDMNBFTM    $FBFTM           Change Time
     C                     MOVELMNCEVN    $FCEVN           Change User
     C                     MOVELMNCFVN    $FCFVN           Change Program
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN MNC0C7    WZB001           Claim Number
     C                     Z-ADDMNC0C7    WZB001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@MNCPSE                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Claim Number
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Claim Number
     C                     ELSE
      * Next record - Detect level breaks
     C           MNC0C7    IFNE WZB001                     Claim Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL00    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$GKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt Claim-Products    PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN MOC0C7    WQKC01           Claim Number
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Claim Number
      * Setup key
     C                     Z-ADD$DC0C7    WQKC01           Claim Number
      * Establish starting position
     C           KRSC      SETLL@MOCPWK                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Claim Number
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDMOC0C7    $HC0C7           Claim Number
     C                     Z-ADDMOAFNX    $HAFNX           Claim Item Line
     C                     Z-ADDMOBIC3    $HBIC3           Claim Company N
     C                     Z-ADDMOC1C7    $HC1C7           Claim Item Code
     C                     MOVELMOCQCD    $HCQCD           Reason Code
     C                     MOVELMOHHCD    $HHHCD           UOM Primary Dft
     C                     MOVELMOCISX    $HCISX           Responsible Dep
     C                     MOVELMOFUAA    $HFUAA           Claim Departmen
     C                     Z-ADDMODPNB    $HDPNB           Order Sequence
     C                     Z-ADDMOUENB    $HUENB           Order Secondary
     C                     Z-ADDMOKUQT    $HKUQT           Claim Item Quan
     C                     Z-ADDMOHHWG    $HHHWG           Claim Item Weig
     C                     Z-ADDMODIPR    $HDIPR           Claim Item Unit
     C                     Z-ADDMOBNVL    $HBNVL           Claim Item Amou
     C                     MOVELMOF0SX    $HF0SX           Affect Trade Fu
     C                     MOVELMOF1SX    $HF1SX           Affect Commissi
     C                     MOVELMOF2SX    $HF2SX           Affect Pricing
     C                     Z-ADDMOFXPR    $HFXPR           Inventory Value
     C                     MOVELMOAMST    $HAMST           Affect Inventor
     C                     MOVELMOANST    $HANST           Affect Sales Do
     C                     MOVELMOVAST    $HVAST           Affect Sales Pn
     C                     MOVELMOTNSX    $HTNSX           Claim Responsib
     C                     Z-ADDMOALNX    $HALNX           Claim Order Num
     C                     Z-ADDMORMNB    $HRMNB           Load ID
     C                     Z-ADDMOYTNX    $HYTNX           Claim Memo Numb
     C                     MOVELMON0CD    $HN0CD           Item Type Code
     C                     MOVELMOQYSX    $HQYSX           Claim Product R
     C                     MOVELMOQZSX    $HQZSX           CP Require CM A
     C                     MOVELMOQ0SX    $HQ0SX           Clm Item TF Exe
     C                     MOVELMOUCSX    $HUCSX           CP Unused Sts 4
     C                     MOVELMOUDSX    $HUDSX           CP Unused Sts 5
     C                     MOVELMOUESX    $HUESX           CP Unused Sts 6
     C                     Z-ADDMOFYPR    $HFYPR           CP Unused Price
     C                     Z-ADDMOFZPR    $HFZPR           CP Unused Price
     C                     Z-ADDMOF0PR    $HF0PR           CP Unused Price
     C                     Z-ADDMOF1PR    $HF1PR           CP Unused Price
     C                     Z-ADDMOF2PR    $HF2PR           CP Unused Price
     C                     Z-ADDMOEUVL    $HEUVL           CP Unused Value
     C                     Z-ADDMOEVVL    $HEVVL           CP Unused Value
     C                     Z-ADDMOEWVL    $HEWVL           CP Unused Value
     C                     Z-ADDMOEXVL    $HEXVL           CP Unused Value
     C                     Z-ADDMOEYVL    $HEYVL           CP Unused Value
     C                     MOVELMOVSST    $HVSST           Record Status
     C                     Z-ADDMOMJDT    $HMJDT           Create Date
     C                     Z-ADDMOBETM    $HBETM           Create Time
     C                     MOVELMOCCVN    $HCCVN           Create User
     C                     MOVELMOCDVN    $HCDVN           Create Program
     C                     Z-ADDMOMKDT    $HMKDT           Change Date
     C                     Z-ADDMOBFTM    $HBFTM           Change Time
     C                     MOVELMOCEVN    $HCEVN           Change User
     C                     MOVELMOCFVN    $HCFVN           Change Program
      * Load related totals format
     C                     Z-ADD*ZERO     $JF0VL           Total Trans Amo
     C                     Z-ADDMOC0C7    $JC0C7           Claim Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDMOC0C7    $IC0C7           Claim Number
     C                     Z-ADDMOAFNX    $IAFNX           Claim Item Line
     C                     Z-ADDMOBIC3    $IBIC3           Claim Company N
     C                     Z-ADDMOC1C7    $IC1C7           Claim Item Code
     C                     MOVELMOCISX    $ICISX           Responsible Dep
     C                     MOVELMOFUAA    $IFUAA           Claim Departmen
     C                     MOVELMOCQCD    $ICQCD           Reason Code
     C                     MOVELMOTNSX    $ITNSX           Claim Responsib
     C                     Z-ADDMODPNB    $IDPNB           Order Sequence
     C                     Z-ADDMOUENB    $IUENB           Order Secondary
     C                     Z-ADDMOKUQT    $IKUQT           Claim Item Quan
     C                     Z-ADD*ZERO     $IRUQT           Claim Item Quan
     C                     Z-ADDMOHHWG    $IHHWG           Claim Item Weig
     C                     MOVELMOVAST    $IVAST           Affect Sales Pn
     C                     Z-ADDMODIPR    $IDIPR           Claim Item Unit
     C                     MOVELMOHHCD    $IHHCD           UOM Primary Dft
     C                     MOVELMOANST    $IANST           Affect Sales Do
     C                     Z-ADDMOBNVL    $IBNVL           Claim Item Amou
     C                     MOVELMOF0SX    $IF0SX           Affect Trade Fu
     C                     MOVELMOF1SX    $IF1SX           Affect Commissi
     C                     MOVELMOF2SX    $IF2SX           Affect Pricing
     C                     Z-ADDMOFXPR    $IFXPR           Inventory Value
     C                     MOVELMOAMST    $IAMST           Affect Inventor
     C                     Z-ADDMOALNX    $IALNX           Claim Order Num
     C                     Z-ADDMORMNB    $IRMNB           Load ID
     C                     Z-ADDMOYTNX    $IYTNX           Claim Memo Numb
     C                     MOVELMON0CD    $IN0CD           Item Type Code
     C                     MOVELMOQYSX    $IQYSX           Claim Product R
     C                     MOVELMOQZSX    $IQZSX           CP Require CM A
     C                     MOVELMOQ0SX    $IQ0SX           Clm Item TF Exe
     C                     MOVELMOUCSX    $IUCSX           CP Unused Sts 4
     C                     MOVELMOUDSX    $IUDSX           CP Unused Sts 5
     C                     MOVELMOUESX    $IUESX           CP Unused Sts 6
     C                     Z-ADDMOFYPR    $IFYPR           CP Unused Price
     C                     Z-ADDMOFZPR    $IFZPR           CP Unused Price
     C                     Z-ADDMOF0PR    $IF0PR           CP Unused Price
     C                     Z-ADDMOF1PR    $IF1PR           CP Unused Price
     C                     Z-ADDMOF2PR    $IF2PR           CP Unused Price
     C                     Z-ADDMOEUVL    $IEUVL           CP Unused Value
     C                     Z-ADDMOEVVL    $IEVVL           CP Unused Value
     C                     Z-ADDMOEWVL    $IEWVL           CP Unused Value
     C                     Z-ADDMOEXVL    $IEXVL           CP Unused Value
     C                     Z-ADDMOEYVL    $IEYVL           CP Unused Value
     C                     MOVELMOVSST    $IVSST           Record Status
     C                     Z-ADDMOMJDT    $IMJDT           Create Date
     C                     Z-ADDMOBETM    $IBETM           Create Time
     C                     MOVELMOCCVN    $ICCVN           Create User
     C                     MOVELMOCDVN    $ICDVN           Create Program
     C                     Z-ADDMOMKDT    $IMKDT           Change Date
     C                     Z-ADDMOBFTM    $IBFTM           Change Time
     C                     MOVELMOCEVN    $ICEVN           Change User
     C                     MOVELMOCFVN    $ICFVN           Change Program
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     ADD  $IBNVL    $JF0VL           Total Trans Amo
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN MOC0C7    WZC001           Claim Number
     C                     Z-ADDMOC0C7    WZC001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@MOCPWK                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Claim Number
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Claim Number
     C                     ELSE
      * Next record - Detect level breaks
     C           MOC0C7    IFNE WZC001                     Claim Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL00    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$JKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * PRT Claim-Resale Prd  PO: Mainline
      *================================================================
      * PRT Claim-Resale Prd  PO: Initialise
     C                     EXSR ZDINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN MPC0C7    WQKD01           Claim Number
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           Claim Number
      * Setup key
     C                     Z-ADD$DC0C7    WQKD01           Claim Number
      * Establish starting position
     C           KRSD      SETLL@MPCPWQ                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        Claim Number
     C                     MOVEL'Y'       W0DL01  1        Ship To Custome
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDMPC0C7    $KC0C7           Claim Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDMPC0C7    $LC0C7           Claim Number
     C                     Z-ADDMPBKC7    $LBKC7           Ship To Custome
     C                     MOVEL*BLANK    $LD6C7           Customer Name D
     C                     MOVEL*BLANK    $LPGNA           Ship to City
     C                     MOVEL*BLANK    $LBDAA           Ship to State C
     C                     Z-ADDMPAKNX    $LAKNX           Resale Item Lin
     C                     Z-ADDMPBHC3    $LBHC3           Resale Company
     C                     Z-ADDMPC5C7    $LC5C7           Resale Item Cod
     C                     MOVELMPCQCD    $LCQCD           Reason Code
     C                     MOVELMPHHCD    $LHHCD           UOM Primary Dft
     C                     MOVELMPCISX    $LCISX           Responsible Dep
     C                     MOVELMPFUAA    $LFUAA           Claim Departmen
     C                     Z-ADDMPDPNB    $LDPNB           Order Sequence
     C                     Z-ADDMPUENB    $LUENB           Order Secondary
     C                     Z-ADDMPKVQT    $LKVQT           Resale Item Qua
     C                     Z-ADDMPHIWG    $LHIWG           Resale Item Wei
     C                     Z-ADDMPDJPR    $LDJPR           Resale Item Uni
     C                     Z-ADDMPBOVL    $LBOVL           Resale Item Amo
     C                     MOVELMPO2NA    $LO2NA           Resale Purchase
     C                     MOVELMPF0SX    $LF0SX           Affect Trade Fu
     C                     MOVELMPF1SX    $LF1SX           Affect Commissi
     C                     MOVELMPF2SX    $LF2SX           Affect Pricing
     C                     MOVELMPAMST    $LAMST           Affect Inventor
     C                     MOVELMPANST    $LANST           Affect Sales Do
     C                     MOVELMPVAST    $LVAST           Affect Sales Pn
     C                     MOVELMPUFSX    $LUFSX           Resale Responsi
     C                     MOVELMPQVSX    $LQVSX           Resale Prod Rea
     C                     MOVELMPQWSX    $LQWSX           CRP Require CM
     C                     MOVELMPQXSX    $LQXSX           Clm Resale TF E
     C                     MOVELMPVSST    $LVSST           Record Status
     C                     Z-ADDMPMJDT    $LMJDT           Create Date
     C                     Z-ADDMPBETM    $LBETM           Create Time
     C                     MOVELMPCCVN    $LCCVN           Create User
     C                     MOVELMPCDVN    $LCDVN           Create Program
     C                     Z-ADDMPMKDT    $LMKDT           Change Date
     C                     Z-ADDMPBFTM    $LBFTM           Change Time
     C                     MOVELMPCEVN    $LCEVN           Change User
     C                     MOVELMPCFVN    $LCFVN           Change Program
      * Load related totals format
     C                     Z-ADD*ZERO     $NY4VA           Total Transacti
     C                     Z-ADD*ZERO     $NF1VL           Total Trans Amo
     C                     Z-ADDMPC0C7    $NC0C7           Claim Number
     C                     Z-ADDMPBKC7    $NBKC7           Ship To Custome
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDMPC0C7    $MC0C7           Claim Number
     C                     Z-ADDMPBKC7    $MBKC7           Ship To Custome
     C                     Z-ADDMPAKNX    $MAKNX           Resale Item Lin
     C                     Z-ADDMPBHC3    $MBHC3           Resale Company
     C                     Z-ADDMPC5C7    $MC5C7           Resale Item Cod
     C                     MOVELMPCISX    $MCISX           Responsible Dep
     C                     MOVELMPFUAA    $MFUAA           Claim Departmen
     C                     MOVELMPCQCD    $MCQCD           Reason Code
     C                     MOVELMPUFSX    $MUFSX           Resale Responsi
     C                     Z-ADDMPDPNB    $MDPNB           Order Sequence
     C                     Z-ADDMPUENB    $MUENB           Order Secondary
     C                     Z-ADDMPKVQT    $MKVQT           Resale Item Qua
     C                     Z-ADD*ZERO     $MRVQT           Resale Item Qua
     C                     Z-ADDMPHIWG    $MHIWG           Resale Item Wei
     C                     MOVELMPVAST    $MVAST           Affect Sales Pn
     C                     Z-ADDMPDJPR    $MDJPR           Resale Item Uni
     C                     MOVELMPHHCD    $MHHCD           UOM Primary Dft
     C                     MOVELMPANST    $MANST           Affect Sales Do
     C                     Z-ADDMPBOVL    $MBOVL           Resale Item Amo
     C                     MOVELMPO2NA    $MO2NA           Resale Purchase
     C                     MOVELMPF0SX    $MF0SX           Affect Trade Fu
     C                     MOVELMPF1SX    $MF1SX           Affect Commissi
     C                     MOVELMPF2SX    $MF2SX           Affect Pricing
     C                     MOVELMPAMST    $MAMST           Affect Inventor
     C                     MOVELMPQVSX    $MQVSX           Resale Prod Rea
     C                     MOVELMPQWSX    $MQWSX           CRP Require CM
     C                     MOVELMPQXSX    $MQXSX           Clm Resale TF E
     C                     MOVELMPVSST    $MVSST           Record Status
     C                     Z-ADDMPMJDT    $MMJDT           Create Date
     C                     Z-ADDMPBETM    $MBETM           Create Time
     C                     MOVELMPCCVN    $MCCVN           Create User
     C                     MOVELMPCDVN    $MCDVN           Create Program
     C                     Z-ADDMPMKDT    $MMKDT           Change Date
     C                     Z-ADDMPBFTM    $MBFTM           Change Time
     C                     MOVELMPCEVN    $MCEVN           Change User
     C                     MOVELMPCFVN    $MCFVN           Change Program
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     ADD  $MBOVL    $NF1VL           Total Trans Amo
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN MPC0C7    WZD001           Claim Number
     C                     Z-ADDMPC0C7    WZD001
     C           *LIKE     DEFN MPBKC7    WZD002           Ship To Custome
     C                     Z-ADDMPBKC7    WZD002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@MPCPWQ                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: DB1.Resale Item Amount is equal to zero
     C           MPBOVL    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        Claim Number
     C                     MOVEL*BLANK    W0DL01  1        Ship To Custome
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        Claim Number
     C                     MOVEL'Y'       W0DL01  1        Ship To Custome
     C                     ELSE
      * Next record - Detect level breaks
     C           MPC0C7    IFNE WZD001                     Claim Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           MPBKC7    IFNE WZD002                     Ship To Custome
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL01    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$NKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         E0MAIN    BEGSR
      *================================================================
      * Prt Claim-Expense     PO: Mainline
      *================================================================
      * Prt Claim-Expense     PO: Initialise
     C                     EXSR ZEINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1C0C7    WQKE01           Claim Number
      * Define keylist
     C           KRSE      KLIST
     C                     KFLD           WQKE01           Claim Number
      * Setup key
     C                     Z-ADD$DC0C7    WQKE01           Claim Number
      * Establish starting position
     C           KRSE      SETLL@A1CPXK                    *
      * Read first record with user selection
     C                     EXSR E3READ
     C           W0EOFE    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0EL1P  1        First page
     C                     MOVEL'Y'       W0EL00  1        Claim Number
     C                     MOVEL'Y'       W0EL01  1        Expense Code
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      * Print report body
     C           W0EOFE    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR E1PHDR
      * Print report detail line
     C                     EXSR E2PDTL
      * Read next record with user selection
     C                     EXSR E3READ
      * Print totals
     C                     EXSR E4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         E0EXIT    ENDSR
      /EJECT
     CSR         E1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0EL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $TENVL           Net Loss Amount
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP1P  1
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1C0C7    $OC0C7           Claim Number
      * Load related totals format
     C                     Z-ADDA1C0C7    $SC0C7           Claim Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP00  1
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP01  1
     C                     END
      *
      *================================================================
     CSR         E1EXIT    ENDSR
      /EJECT
     CSR         E2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDA1C0C7    $PC0C7           Claim Number
     C                     MOVELA1F1AA    $PF1AA           Expense Code
     C                     Z-ADDA1DXNB    $PDXNB           Sequence Number
     C                     MOVELA1TXSX    $PTXSX           Expense Respons
     C                     MOVELA1Z4SX    $PZ4SX           Expense Status
     C                     MOVELA1T5SX    $PT5SX           TFS Process Sta
     C                     Z-ADDA1YSNX    $PYSNX           TFS Batch Numbe
     C                     Z-ADDA1EMVL    $PEMVL           Expense Amount
     C                     Z-ADDA1E1VL    $PE1VL           TFS Claim Expen
     C                     MOVELA1VSST    $PVSST           Record Status
     C                     Z-ADDA1MJDT    $PMJDT           Create Date
     C                     Z-ADDA1BETM    $PBETM           Create Time
     C                     MOVELA1CCVN    $PCCVN           Create User
     C                     MOVELA1CDVN    $PCDVN           Create Program
     C                     Z-ADDA1MKDT    $PMKDT           Change Date
     C                     Z-ADDA1BFTM    $PBFTM           Change Time
     C                     MOVELA1CEVN    $PCEVN           Change User
     C                     MOVELA1CFVN    $PCFVN           Change Program
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Claim-Expense Com PO
     C                     EXSR ULSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         E2EXIT    ENDSR
      /EJECT
     CSR         E3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A1C0C7    WZE001           Claim Number
     C                     Z-ADDA1C0C7    WZE001
     C           *LIKE     DEFN A1F1AA    WZE002           Expense Code
     C                     MOVELA1F1AA    WZE002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFE    OREQ '1'
     C           KRSE      READE@A1CPXK                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFE  1
      * Quit if no record read
     C           W0EOFE    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0EL00  1        Claim Number
     C                     MOVEL*BLANK    W0EL01  1        Expense Code
     C           W0EOFE    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0EL00  1        Claim Number
     C                     MOVEL'Y'       W0EL01  1        Expense Code
     C                     ELSE
      * Next record - Detect level breaks
     C           A1C0C7    IFNE WZE001                     Claim Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL00
     C                     END
     C           A1F1AA    IFNE WZE002                     Expense Code
     C           W0EL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL01
     C                     END
     C                     END
      *================================================================
     CSR         E3EXIT    ENDSR
      /EJECT
     CSR         E4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP01
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$SKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP00
     C                     END
      *
     C           W0EOFE    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
     C                     Z-ADDYL0007    $TENVL           Net Loss Amount
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$TFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         E4EXIT    ENDSR
      /EJECT
     CSR         F0MAIN    BEGSR
      *================================================================
      * Prt Claim-Expense Com PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A2C0C7    WQKF01           Claim Number
     C           *LIKE     DEFN A2F1AA    WQKF02           Expense Code
     C           *LIKE     DEFN A2DXNB    WQKF03           Sequence Number
      * Define keylist
     C           KRSF      KLIST
     C                     KFLD           WQKF01           Claim Number
     C                     KFLD           WQKF02           Expense Code
     C                     KFLD           WQKF03           Sequence Number
      * Setup key
     C                     Z-ADD$DC0C7    WQKF01           Claim Number
     C                     MOVEL$PF1AA    WQKF02           Expense Code
     C                     Z-ADD$PDXNB    WQKF03           Sequence Number
      * Establish starting position
     C           KRSF      SETLL@A2CPXX                    *
      * Read first record with user selection
     C                     EXSR F3READ
     C           W0EOFF    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0FL1P  1        First page
     C                     MOVEL'Y'       W0FL00  1        Claim Number
     C                     MOVEL'Y'       W0FL01  1        Expense Code
     C                     MOVEL'Y'       W0FL02  1        Sequence Number
      * Set column headings flag
     C                     MOVE 'Y'       W0FCDT
      * Print report body
     C           W0EOFF    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR F1PHDR
      * Print report detail line
     C                     EXSR F2PDTL
      * Read next record with user selection
     C                     EXSR F3READ
      * Print totals
     C                     EXSR F4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         F0EXIT    ENDSR
      /EJECT
     CSR         F1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0FL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP1P  1
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP00  1
     C                     END
      *
     C           W0FL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP01  1
     C                     END
      *
     C           W0FL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP02  1
     C                     END
      *
      *================================================================
     CSR         F1EXIT    ENDSR
      /EJECT
     CSR         F2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDA2C0C7    $QC0C7           Claim Number
     C                     MOVELA2F1AA    $QF1AA           Expense Code
     C                     Z-ADDA2DXNB    $QDXNB           Sequence Number
     C                     Z-ADDA2YVNX    $QYVNX           Sequence Number
     C                     MOVELA2RANA    $QRANA           Claim Expense C
     C                     MOVELA2VSST    $QVSST           Record Status
     C                     Z-ADDA2MJDT    $QMJDT           Create Date
     C                     Z-ADDA2BETM    $QBETM           Create Time
     C                     MOVELA2CCVN    $QCCVN           Create User
     C                     MOVELA2CDVN    $QCDVN           Create Program
     C                     Z-ADDA2MKDT    $QMKDT           Change Date
     C                     Z-ADDA2BFTM    $QBFTM           Change Time
     C                     MOVELA2CEVN    $QCEVN           Change User
     C                     MOVELA2CFVN    $QCFVN           Change Program
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         F2EXIT    ENDSR
      /EJECT
     CSR         F3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A2C0C7    WZF001           Claim Number
     C                     Z-ADDA2C0C7    WZF001
     C           *LIKE     DEFN A2F1AA    WZF002           Expense Code
     C                     MOVELA2F1AA    WZF002
     C           *LIKE     DEFN A2DXNB    WZF003           Sequence Number
     C                     Z-ADDA2DXNB    WZF003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFF    OREQ '1'
     C           KRSF      READE@A2CPXX                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFF  1
      * Quit if no record read
     C           W0EOFF    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0FL00  1        Claim Number
     C                     MOVEL*BLANK    W0FL01  1        Expense Code
     C                     MOVEL*BLANK    W0FL02  1        Sequence Number
     C           W0EOFF    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0FL00  1        Claim Number
     C                     MOVEL'Y'       W0FL01  1        Expense Code
     C                     MOVEL'Y'       W0FL02  1        Sequence Number
     C                     ELSE
      * Next record - Detect level breaks
     C           A2C0C7    IFNE WZF001                     Claim Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL00
     C                     END
     C           A2F1AA    IFNE WZF002                     Expense Code
     C           W0FL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL01
     C                     END
     C           A2DXNB    IFNE WZF003                     Sequence Number
     C           W0FL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL02
     C                     END
     C                     END
      *================================================================
     CSR         F3EXIT    ENDSR
      /EJECT
     CSR         F4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0FL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP02
     C                     END
      *
     C           W0FL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP01
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP00
     C                     END
      *
     C           W0EOFF    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$RFINTTL
     C                     END
      *
      *================================================================
     CSR         F4EXIT    ENDSR
      /EJECT
     CSR         G0MAIN    BEGSR
      *================================================================
      * Prt Claim-Comm ChgAct PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBC0C7    WQKG01           Claim Number
     C           *LIKE     DEFN WBN7T1    WQKG02           Claim Expl Acti
      * Define keylist
     C           KRSG      KLIST
     C                     KFLD           WQKG01           Claim Number
     C                     KFLD           WQKG02           Claim Expl Acti
      * Setup key
     C                     Z-ADDP1C0C7    WQKG01           Claim Number
     C                     MOVELYL0008    WQKG02           Claim Expl Acti
      * Establish starting position
     C           KRSG      SETLL@MNCPSP                    *
      * Read first record with user selection
     C                     EXSR G3READ
     C           W0EOFG    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0GL1P  1        First page
     C                     MOVEL'Y'       W0GL00  1        Claim Number
     C                     MOVEL'Y'       W0GL01  1        Claim Expl Acti
     C                     MOVEL'Y'       W0GL02  1        Claim Explanati
      * Set column headings flag
     C                     MOVE 'Y'       W0GCDT
      * Print report body
     C           W0EOFG    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR G1PHDR
      * Print report detail line
     C                     EXSR G2PDTL
      * Read next record with user selection
     C                     EXSR G3READ
      * Print totals
     C                     EXSR G4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         G0EXIT    ENDSR
      /EJECT
     CSR         G1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0GL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP1P  1
     C                     END
      *
     C           W0GL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP00  1
     C                     END
      *
     C           W0GL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP01  1
     C                     END
      *
     C           W0GL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP02  1
     C                     END
      *
      *================================================================
     CSR         G1EXIT    ENDSR
      /EJECT
     CSR         G2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWBC0C7    $VC0C7           Claim Number
     C                     Z-ADDWBAANX    $VAANX           Claim Explanati
     C                     MOVELWBPYTX    $VPYTX           Claim Explanati
     C                     Z-ADDWBLGNY    $VLGNY           Claim Exp Usr S
     C                     Z-ADDWBRRDT    $VRRDT           Claim Expl Note
     C                     MOVELWBL1TX    $VL1TX           Claim Expl Type
     C                     MOVELWBN7T1    $VN7T1           Claim Expl Acti
     C                     Z-ADDWBRSDT    $VRSDT           Claim Expl Acti
     C                     Z-ADDWBC9TM    $VC9TM           Claim Expl Acti
     C                     MOVELWBL2TX    $VL2TX           Claim Departmen
     C                     MOVELWBVSST    $VVSST           Record Status
     C                     Z-ADDWBMJDT    $VMJDT           Create Date
     C                     Z-ADDWBBETM    $VBETM           Create Time
     C                     MOVELWBCCVN    $VCCVN           Create User
     C                     MOVELWBCDVN    $VCDVN           Create Program
     C                     Z-ADDWBMKDT    $VMKDT           Change Date
     C                     Z-ADDWBBFTM    $VBFTM           Change Time
     C                     MOVELWBCEVN    $VCEVN           Change User
     C                     MOVELWBCFVN    $VCFVN           Change Program
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         G2EXIT    ENDSR
      /EJECT
     CSR         G3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WBC0C7    WZG001           Claim Number
     C                     Z-ADDWBC0C7    WZG001
     C           *LIKE     DEFN WBN7T1    WZG002           Claim Expl Acti
     C                     MOVELWBN7T1    WZG002
     C           *LIKE     DEFN WBAANX    WZG003           Claim Explanati
     C                     Z-ADDWBAANX    WZG003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFG    OREQ '1'
     C           KRSG      READE@MNCPSP                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFG  1
      * Quit if no record read
     C           W0EOFG    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0GL00  1        Claim Number
     C                     MOVEL*BLANK    W0GL01  1        Claim Expl Acti
     C                     MOVEL*BLANK    W0GL02  1        Claim Explanati
     C           W0EOFG    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0GL00  1        Claim Number
     C                     MOVEL'Y'       W0GL01  1        Claim Expl Acti
     C                     MOVEL'Y'       W0GL02  1        Claim Explanati
     C                     ELSE
      * Next record - Detect level breaks
     C           WBC0C7    IFNE WZG001                     Claim Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL00
     C                     END
     C           WBN7T1    IFNE WZG002                     Claim Expl Acti
     C           W0GL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL01
     C                     END
     C           WBAANX    IFNE WZG003                     Claim Explanati
     C           W0GL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL02
     C                     END
     C                     END
      *================================================================
     CSR         G3EXIT    ENDSR
      /EJECT
     CSR         G4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0GL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP02
     C                     END
      *
     C           W0GL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP01
     C                     END
      *
     C           W0GL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP00
     C                     END
      *
     C           W0EOFG    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         G4EXIT    ENDSR
      /EJECT
     CSR         H0MAIN    BEGSR
      *================================================================
      * Prt Claim-Comm Intrl  PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCC0C7    WQKH01           Claim Number
      * Define keylist
     C           KRSH      KLIST
     C                     KFLD           WQKH01           Claim Number
      * Setup key
     C                     Z-ADDP1C0C7    WQKH01           Claim Number
      * Establish starting position
     C           KRSH      SETLL@MNCPSI                    *
      * Read first record with user selection
     C                     EXSR H3READ
     C           W0EOFH    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0HL1P  1        First page
     C                     MOVEL'Y'       W0HL00  1        Claim Number
     C                     MOVEL'Y'       W0HL01  1        Claim Expl Note
     C                     MOVEL'Y'       W0HL02  1        Claim Exp Usr S
     C                     MOVEL'Y'       W0HL03  1        Claim Explanati
      * Set column headings flag
     C                     MOVE 'Y'       W0HCDT
      * Print report body
     C           W0EOFH    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR H1PHDR
      * Print report detail line
     C                     EXSR H2PDTL
      * Read next record with user selection
     C                     EXSR H3READ
      * Print totals
     C                     EXSR H4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         H0EXIT    ENDSR
      /EJECT
     CSR         H1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0HL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP1P  1
     C                     END
      *
     C           W0HL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWCC0C7    $WC0C7           Claim Number
     C                     Z-ADDWCAANX    $WAANX           Claim Explanati
     C                     MOVELWCPYTX    $WPYTX           Claim Explanati
     C                     MOVELWCVSST    $WVSST           Record Status
     C                     Z-ADDWCMJDT    $WMJDT           Create Date
     C                     Z-ADDWCBETM    $WBETM           Create Time
     C                     MOVELWCCCVN    $WCCVN           Create User
     C                     MOVELWCCDVN    $WCDVN           Create Program
     C                     Z-ADDWCMKDT    $WMKDT           Change Date
     C                     Z-ADDWCBFTM    $WBFTM           Change Time
     C                     MOVELWCCEVN    $WCEVN           Change User
     C                     MOVELWCCFVN    $WCFVN           Change Program
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP00  1
     C                     END
      *
     C           W0HL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP01  1
     C                     END
      *
     C           W0HL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP02  1
     C                     END
      *
     C           W0HL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP03  1
     C                     END
      *
      *================================================================
     CSR         H1EXIT    ENDSR
      /EJECT
     CSR         H2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWCC0C7    $XC0C7           Claim Number
     C                     Z-ADDWCAANX    $XAANX           Claim Explanati
     C                     Z-ADDWCRRDT    $XRRDT           Claim Expl Note
     C                     MOVELWCPYTX    $XPYTX           Claim Explanati
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         H2EXIT    ENDSR
      /EJECT
     CSR         H3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WCC0C7    WZH001           Claim Number
     C                     Z-ADDWCC0C7    WZH001
     C           *LIKE     DEFN WCRRDT    WZH002           Claim Expl Note
     C                     Z-ADDWCRRDT    WZH002
     C           *LIKE     DEFN WCLGNY    WZH003           Claim Exp Usr S
     C                     Z-ADDWCLGNY    WZH003
     C           *LIKE     DEFN WCAANX    WZH004           Claim Explanati
     C                     Z-ADDWCAANX    WZH004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFH    OREQ '1'
     C           KRSH      READE@MNCPSI                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFH  1
      * Quit if no record read
     C           W0EOFH    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0HL00  1        Claim Number
     C                     MOVEL*BLANK    W0HL01  1        Claim Expl Note
     C                     MOVEL*BLANK    W0HL02  1        Claim Exp Usr S
     C                     MOVEL*BLANK    W0HL03  1        Claim Explanati
     C           W0EOFH    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0HL00  1        Claim Number
     C                     MOVEL'Y'       W0HL01  1        Claim Expl Note
     C                     MOVEL'Y'       W0HL02  1        Claim Exp Usr S
     C                     MOVEL'Y'       W0HL03  1        Claim Explanati
     C                     ELSE
      * Next record - Detect level breaks
     C           WCC0C7    IFNE WZH001                     Claim Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL00
     C                     END
     C           WCRRDT    IFNE WZH002                     Claim Expl Note
     C           W0HL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL01
     C                     END
     C           WCLGNY    IFNE WZH003                     Claim Exp Usr S
     C           W0HL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL02
     C                     END
     C           WCAANX    IFNE WZH004                     Claim Explanati
     C           W0HL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL03
     C                     END
     C                     END
      *================================================================
     CSR         H3EXIT    ENDSR
      /EJECT
     CSR         H4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0HL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP03
     C                     END
      *
     C           W0HL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP02
     C                     END
      *
     C           W0HL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP01
     C                     END
      *
     C           W0HL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP00
     C                     END
      *
     C           W0EOFH    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         H4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Claim-Claim       PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Claim-Claim       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Print format
     C                     WRITE$C1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Detail line. of Prt Claim-Claim       PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CUR.Claim Type Descr Usr = Condition name of DB1.Claim Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1523228   Y2LSNO  70       List number
     C                     PARM MKCHSX    W0INVL 25        Claim Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $DFCT1    PARM           W0CNNM 25        Claim Type Desc
      *
      * CUR.Claim Status Desc     USR = Condition name of DB1.Claim Statu
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1523237   Y2LSNO  70       List number
     C                     PARM MKCJSX    W0INVL 25        Claim Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $DRQTX    PARM           W0CNNM 25        Claim Status De
      *
      * Get History/Order Info.
     C                     EXSR UASUBR                     Get History/Ord
      * Get Customer Phone Number.
     C                     EXSR UBSUBR                     Get Customer Ph
      * Get Warehouse Description.
     C                     EXSR UCSUBR                     Get Warehouse D
      * Get Salesperson Name.
     C                     EXSR UDSUBR                     Get Salesperson
      * Get Trailer Id.
     C                     EXSR UESUBR                     Get Trailer Id.
      * Get Salesperson Approved Name.
     C                     EXSR UFSUBR                     Get Salesperson
     C                     MOVEL*BLANK    $DDGU1           ACR Shipping Me
      * ACR Shipping Method DRV
      * PAR.ACR Shipping Method DRV = Condition name of PAR.ACR Shipping
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM $DUASX    W0INVL 25        ACR Shipping Me
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $DDGU1    PARM           W0CNNM 25        ACR Shipping Me
      *
      * T10560 DN  05/18/17-Added FPR ID to report.
     C                     Z-ADDMKEQVL    $DAHNZ           FPR ID USR
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Claim Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DC0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DC0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDC0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDC0C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Claim Ship to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DC3C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DC3C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDC3C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDC3C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Claim Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DALNX    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DALNX    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDALNX           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDALNX           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Actual Ship Date to display format
      * Convert date
     C           1000000   ADD  $DF9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDF9DT
      * Convert Actual Delivery Date to display format
      * Convert date
     C           1000000   ADD  $DEJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDEJDT
      * Convert Claim Called in by Date to display format
      * Convert date
     C           1000000   ADD  $DMMDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDMMDT
      * Convert Claim Entry Date to display format
      * Convert date
     C           1000000   ADD  $DMNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDMNDT
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$DCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$DDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Prt Claim-Comm Expl   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Claim Number of Prt Claim-Comm Expl   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Print format
     C                     WRITE$EKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Detail line. of Prt Claim-Comm Expl   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$FDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt Claim-Products    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Claim Number of Prt Claim-Products    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Print format
     C                     WRITE$HKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Detail line. of Prt Claim-Products    PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * E0457 JJH 04/21/15 - Change Quantity from 11.2 to 9.2
     C                     Z-ADD$IKUQT    $IRUQT           Claim Item Quan
     C                     ADD  $IBNVL    YL0005           Total Trans Amo
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Claim Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $IC1C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$IC1C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VIC1C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VIC1C7           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$ICOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$IDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of PRT Claim-Resale Prd  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print Claim Number of PRT Claim-Resale Prd  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Print format
     C                     WRITE$KKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print Ship To Customer of PRT Claim-Resale Prd  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Ship To Customer format
     C                     MOVEL*BLANK    $LD6C7           Customer Name D
      * Customer Name DRV
      * RTV Customer Name      RT - Customer  * 
     C                     EXSR SORVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $LBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$LBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VLBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VLBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$LKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print Detail line. of PRT Claim-Resale Prd  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * E4057 JJH 04/21/15 - Shorten Resale Item Quantity from 11.2 to 9.
     C                     Z-ADD$MKVQT    $MRVQT           Resale Item Qua
     C                     ADD  $MBOVL    YL0006           Total Trans Amo
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Resale Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $MC5C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$MC5C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VMC5C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VMC5C7           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$MCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$MDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Print First Page Format of Prt Claim-Expense     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0EL1P
     C                     END                             FI
      * Print Claim Number of Prt Claim-Expense     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP00    ANDEQ'P'
      * Print format
     C                     WRITE$OKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EP00
     C                     END                             FI
      * Print Expense Code of Prt Claim-Expense     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP01
     C                     END                             FI
      * Print Detail line. of Prt Claim-Expense     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ECDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     SUB  $PEMVL    YL0007           Net Loss Amount
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Print column headings if required
     C           W0ECDT    IFEQ 'Y'
     C                     WRITE$PCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ECDT
     C                     END                             FI
      * Print format
     C                     WRITE$PDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EPDT
     C                     END                             FI
      * Print First Page Format of Prt Claim-Expense Com PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0FL1P
     C                     END                             FI
      * Print Claim Number of Prt Claim-Expense Com PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP00
     C                     END                             FI
      * Print Expense Code of Prt Claim-Expense Com PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP01
     C                     END                             FI
      * Print Sequence Number of Prt Claim-Expense Com PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP02
     C                     END                             FI
      * Print Detail line. of Prt Claim-Expense Com PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0FCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FPDT    ANDEQ'P'
      * Print column headings if required
     C           W0FCDT    IFEQ 'Y'
     C                     WRITE$QCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0FCDT
     C                     END                             FI
      * Print format
     C                     WRITE$QDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0FPDT
     C                     END                             FI
      * Print First Page Format of Prt Claim-Comm ChgAct PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0GL1P
     C                     END                             FI
      * Print Claim Number of Prt Claim-Comm ChgAct PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP00
     C                     END                             FI
      * Print Claim Expl Action of Prt Claim-Comm ChgAct PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP01
     C                     END                             FI
      * Print Claim Explanation Line No of Prt Claim-Comm ChgAct PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP02
     C                     END                             FI
      * Print Detail line. of Prt Claim-Comm ChgAct PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0GCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GPDT    ANDEQ'P'
      * Print column headings if required
     C           W0GCDT    IFEQ 'Y'
     C                     WRITE$VCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0GCDT
     C                     END                             FI
      * Print format
     C                     WRITE$VDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0GPDT
     C                     END                             FI
      * Print First Page Format of Prt Claim-Comm Intrl  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0HL1P
     C                     END                             FI
      * Print Claim Number of Prt Claim-Comm Intrl  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP00    ANDEQ'P'
      * Convert fields to external form
      * Convert Claim Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $WC0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$WC0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VWC0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VWC0C7           CD7 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$WKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0HCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0HP00
     C                     END                             FI
      * Print Claim Expl Note Date of Prt Claim-Comm Intrl  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP01
     C                     END                             FI
      * Print Claim Exp Usr Seq Number of Prt Claim-Comm Intrl  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP02
     C                     END                             FI
      * Print Claim Explanation Line No of Prt Claim-Comm Intrl  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP03
     C                     END                             FI
      * Print Detail line. of Prt Claim-Comm Intrl  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0HCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HPDT    ANDEQ'P'
      * Convert fields to external form
      * Convert Claim Expl Note Date to display format
      * Convert date
     C           1000000   ADD  $XRRDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VXRRDT
      * Print column headings if required
     C           W0HCDT    IFEQ 'Y'
     C                     WRITE$XCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0HCDT
     C                     END                             FI
      * Print format
     C                     WRITE$XDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0HPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Claim-Claim       PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  1         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Claim-Claim       PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD19        W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Claim-Comm Expl   PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Claim Number of Prt Claim-Comm Expl   PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Claim-Comm Expl   PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Claim-Products    PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Claim Number of Prt Claim-Products    PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  1         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Claim-Products    PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD3         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Claim-Resale Prd  PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Claim Number of PRT Claim-Resale Prd  PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  1         W0FSUM
     C                     END                             FI
      *
      * * Ship To Customer of PRT Claim-Resale Prd  PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Claim-Resale Prd  PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD3         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Claim-Expense     PO
     C           W0EP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Claim Number of Prt Claim-Expense     PO
     C           W0EP00    IFEQ 'Y'
     C                     ADD  1         W0FSUM
     C                     END                             FI
      *
      * * Expense Code of Prt Claim-Expense     PO
     C           W0EP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Claim-Expense     PO
     C           W0EPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ECDT    IFEQ 'Y'
     C                     Z-ADD3         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Claim-Expense Com PO
     C           W0FP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Claim Number of Prt Claim-Expense Com PO
     C           W0FP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Expense Code of Prt Claim-Expense Com PO
     C           W0FP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Sequence Number of Prt Claim-Expense Com PO
     C           W0FP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Claim-Expense Com PO
     C           W0FPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0FCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Claim-Comm ChgAct PO
     C           W0GP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Claim Number of Prt Claim-Comm ChgAct PO
     C           W0GP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Claim Expl Action of Prt Claim-Comm ChgAct PO
     C           W0GP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Claim Explanation Line No of Prt Claim-Comm ChgAct PO
     C           W0GP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Claim-Comm ChgAct PO
     C           W0GPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0GCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Claim-Comm Intrl  PO
     C           W0HP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Claim Number of Prt Claim-Comm Intrl  PO
     C           W0HP00    IFEQ 'Y'
     C                     ADD  4         W0FSUM
     C                     END                             FI
      *
      * * Claim Expl Note Date of Prt Claim-Comm Intrl  PO
     C           W0HP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Claim Exp Usr Seq Number of Prt Claim-Comm Intrl  PO
     C           W0HP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Claim Explanation Line No of Prt Claim-Comm Intrl  PO
     C           W0HP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Claim-Comm Intrl  PO
     C           W0HPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0HCDT    IFEQ 'Y'
     C                     Z-ADD2         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * Rtv Claim Status      RT - A/R Claim  * 
     C                     EXSR SARVGN
     C                     MOVEL$BTBTX    P1TBTX           Claim Resolutio
      * TOP.Claim Status Desc     USR = Condition name of TOP.Claim Statu
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1523237   Y2LSNO  70       List number
     C                     PARM $B        W0INVL 25        Claim Status Rt
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BRQTX    PARM           W0CNNM 25        Claim Status De
      *
     C                     MOVEL*BLANK    $BSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SBRVGN
     C                     Z-ADDP1BIC3    $BBIC3           Claim Company N
     C                     Z-ADDP1C0C7    $BC0C7           Claim Number
      * ** If change type is passed in, put the name in the explanation t
      * CASE: PAR.Claim Print Type is Regular Claim
     C           P2MGTX    IFEQ 'R'                        *IF
     C                     MOVEL*BLANK    $BHETX           Explaination Te
     C                     ELSE
      * CASE: PAR.Claim Print Type is Audit Notes
     C           P2MGTX    IFEQ 'A'                        *IF
     C                     MOVEL*BLANK    $BHETX           Explaination Te
     C                     MOVEL@CN,001   $BHETX           Explaination Te
     C                     ELSE
      * CASE: PAR.Claim Print Type is Internal Notes
     C           P2MGTX    IFEQ 'I'                        *IF
     C                     MOVEL*BLANK    $BHETX           Explaination Te
     C                     MOVEL@CN,002   $BHETX           Explaination Te
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BHETX           Explaination Te
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * WI592 DN 06/07/23-Get Warehouse & Accounting Company.
      * CASE: *OTHERWISE
      * RTV 1st Warehouse 2    RT - Order Detail  * 
     C                     EXSR SCRVGN
      * Rtv Acct Co          RT - Warehouse Codes  * 
     C                     EXSR SDRVGN
      * Convert fields to external form
      * Convert Claim Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BBIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BBIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBBIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBBIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Accounting Company to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BBTC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BBTC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBBTC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBBTC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Claim Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $BC0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$BC0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VBC0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBC0C7           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           P1TBTX    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Claim Status      RT - A/R Claim  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    $B               Claim Status
     C                     MOVEL*BLANK    $BTBTX           Claim Resolutio
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           MKC0C7           Claim Number
      * Setup key
     C                     Z-ADDP1C0C7    MKC0C7           Claim Number
      * Establish starting position
     C           KRSSA     CHAIN@MKCPWB              90    *
      * Data record not found
     C   90                MOVEL'USR2729' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELMKCJSX    $B               Claim Status
     C                     MOVELMKTBTX    $BTBTX           Claim Resolutio
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDP1BIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSB     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BSQTX           Name
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $BSQTX           Name
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse 2    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Warehouse Code
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSC01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSC02           Order Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDMKBIC3    WQSC01           Company Number
     C                     Z-ADDMKALNX    WQSC02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSC     SETLL@BGWKAE                    *
     C           KRSSC     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELOMAJCD    YL0001           Warehouse Code
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Acct Co          RT - Warehouse Codes  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELYL0001    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $BBTC3           Accounting Comp
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBTC3    $BBTC3           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Claim Order Info   RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN F4AIC3    WQSE01           Company Number
     C           *LIKE     DEFN F4C4NB    WQSE02           Order Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
      * Setup key
     C                     Z-ADD$DBIC3    WQSE01           Company Number
     C                     Z-ADD$DALNX    WQSE02           Order Number
      * Establish starting position
     C           KRSSE     SETLL@FHSTD3                    *
     C           KRSSE     READE@FHSTD3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1241' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUY4CD           Ship To Custome
     C                     MOVEL*BLANK    WUOSTX           Ship To Name
     C                     MOVEL*BLANK    $DBCNA           Customer Purcha
     C                     MOVEL*BLANK    $DBZNA           Carrier Code
     C                     MOVEL*BLANK    YL0001           Warehouse Code
     C                     Z-ADD*ZERO     WUMTDT           Invoice Date
     C                     Z-ADD*ZERO     $DCONB           Invoice Number
     C                     MOVEL*BLANK    $DCEST           Invoice Suffix
     C                     Z-ADD*ZERO     $DF9DT           Actual Shipped
     C                     Z-ADD*ZERO     $DRMNB           Load ID
     C                     MOVEL*BLANK    WUOSTX           Salesperson to
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDF4BKC7    WUY4CD           Ship To Custome
     C                     MOVELF4BRTX    WUOSTX           Ship To Name
     C                     MOVELF4BCNA    $DBCNA           Customer Purcha
     C                     MOVELF4BZNA    $DBZNA           Carrier Code
     C                     MOVELF4AJCD    YL0001           Warehouse Code
     C                     Z-ADDF4AWDT    WUMTDT           Invoice Date
     C                     Z-ADDF4CONB    $DCONB           Invoice Number
     C                     MOVELF4CEST    $DCEST           Invoice Suffix
     C                     Z-ADDF4GNDT    $DF9DT           Actual Shipped
     C                     Z-ADDF4RMNB    $DRMNB           Load ID
      * RTV Salesman Code      RT - Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELF4R4CD    WL0001    P      Sales Route Cod
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WUOSTX    P      Salesperson Cod
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@FHSTD3                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Salesman Code      RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVELWL0001    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSF     CHAIN@JEREWS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Salesperson Cod
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEBCCD    WL0002           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Claim Order Info   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD$DBIC3    BEAIC3           Company Number
     C                     Z-ADD$DALNX    BEC4NB           Order Number
      * Establish starting position
     C           KRSSG     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUBKC7           Ship To Custome
     C                     MOVEL*BLANK    WUBRTX           Ship To Name
     C                     MOVEL*BLANK    $DBCNA           Customer Purcha
     C                     Z-ADD*ZERO     $DF9DT           Actual Shipped
     C                     MOVEL*BLANK    $DBZNA           Carrier Code
     C                     Z-ADD*ZERO     $DRMNB           Load ID
     C                     Z-ADD*ZERO     $DCONB           Invoice Number
     C                     MOVEL*BLANK    $DCEST           Invoice Suffix
     C                     Z-ADD*ZERO     YL0002           Invoice Date
     C                     MOVEL*BLANK    YL0003           Salesperson to
     C                     MOVEL*BLANK    YL0001           Warehouse Code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEBKC7    WUBKC7           Ship To Custome
     C                     MOVELBEBRTX    WUBRTX           Ship To Name
     C                     MOVELBEBCNA    $DBCNA           Customer Purcha
     C                     Z-ADDBEGNDT    $DF9DT           Actual Shipped
     C                     MOVELBEBZNA    $DBZNA           Carrier Code
     C                     Z-ADDBERMNB    $DRMNB           Load ID
     C                     Z-ADDBECONB    $DCONB           Invoice Number
     C                     MOVELBECEST    $DCEST           Invoice Suffix
     C                     Z-ADDBEAWDT    YL0002           Invoice Date
      * RTV Whse/Non Cancelled RT - Order Detail  * 
     C                     EXSR SHRVGN
      * RTV Salesman Code      RT - PD Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELBER4CD    WL0001    P      Sales Route Cod
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0003    P      Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Whse/Non Cancelled RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSH02           Order Number
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSH01           Company Number
     C                     Z-ADDBEC4NB    WQSH02           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
      * Establish starting position
     C           KPSSH     SETLL@BGWKL1                    *
     C           KRSSH     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Warehouse Code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           WAGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELWAAJCD    YL0001           Warehouse Code
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSH     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Customer Telephone RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$DC3C7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBBVTX    $DBVTX           Telephone Numbe
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Warehouse          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELYL0001    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    $DF8NA           Warehouse Descr
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    $DF8NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Salesperson        RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           APBCCD           Salesperson Cod
      * Setup key
     C                     MOVEL$DZLCD    APBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSK     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DALTX           Salesperson Nam
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAPALTX    $DALTX           Salesperson Nam
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Claim Load Info    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Template version identifier - Edit to reflect current version.
      * Template version identifier - Edit to reflect current version.
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLAIC3    WQSL01           Company Number
     C           *LIKE     DEFN FLC4NB    WQSL02           Order Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
      * Setup key
     C                     Z-ADD$DBIC3    WQSL01           Company Number
     C                     Z-ADD$DALNX    WQSL02           Order Number
      * Establish starting position
     C           KRSSL     SETLL@FLCPW9                    *
     C           KRSSL     READE@FLCPW9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DDXTX           Trailer Id
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
      * RTV Claim Load Info    RT - OM Load Header  * 
     C                     EXSR SMRVGN
     C           KRSSL     READE@FLCPW9                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Claim Load Info    RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDFLRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSM     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DDXTX           Trailer Id
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJDXTX    $DDXTX           Trailer Id
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Profile Desc.      RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL$DCQVN    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSN     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0004           Description
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRAUNA    YL0004           Description
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$LBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSO     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $LD6C7           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    $LD6C7           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Get History/Order Info.
      *================================================================
      * RTV Claim Order Info   RT - Sales History  * 
     C                     EXSR SERVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Claim Order Info   RT - Order Header TRG  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Get Customer Phone Number.
      *================================================================
      * RTV Customer Telephone RT - Customer  * 
     C                     EXSR SIRVGN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Get Warehouse Description.
      *================================================================
      * RTV Warehouse          RT - Warehouse  * 
     C                     EXSR SJRVGN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Get Salesperson Name.
      *================================================================
      * RTV Salesperson        RT - Salesperson  * 
     C                     EXSR SKRVGN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Get Trailer Id.
      *================================================================
      * RTV Claim Load Info    RT - Load Detail  * 
     C                     EXSR SLRVGN
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Get Salesperson Approved Name.
      *================================================================
      * RTV Profile Desc.      RT - User Profile Control  * 
     C                     EXSR SNRVGN
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Claim-Comment
      *================================================================
      * Prt Claim-Comm Expl   PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Claim-Products    PO
      *================================================================
     C                     Z-ADD*ZERO     YL0005           Total Trans Amo
      * Prt Claim-Products    PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Claim-Resale Prd  PO
      *================================================================
     C                     Z-ADD*ZERO     YL0006           Total Trans Amo
      *
     C                     MOVEL*BLANK    WN0001  3        Salesperson to
     C                     Z-ADD*ZERO     WN0002  30       Claim Company N
     C                     Z-ADD*ZERO     WN0003  70       Claim Order Num
     C                     Z-ADD*ZERO     WN0004  70       Load ID
     C                     Z-ADD*ZERO     WN0005  70       Claim Ship to C
     C                     MOVEL*BLANK    WN0006 30        Claim Customer
     C                     MOVEL*BLANK    WN0007  2        Claim Type
     C                     MOVEL*BLANK    WN0008  1        Claim Status
      *
      * PRT Claim-Resale Prd  PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E4057 JJH 04/21/15 - Price Credit Fixes
      * - Print Resale Sales Dollar Status
      * - Shorten Resale Item Quantity from 11.2 to 9.2
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Claim-Expense     PO
      *================================================================
      *
     C                     MOVEL*BLANK    WN0009  3        Salesperson to
     C                     Z-ADD*ZERO     WN0010  30       Claim Company N
     C                     Z-ADD*ZERO     WN0011  70       Claim Order Num
     C                     Z-ADD*ZERO     WN0012  70       Load ID
     C                     Z-ADD*ZERO     WN0013  70       Claim Ship to C
     C                     MOVEL*BLANK    WN0014 30        Claim Customer
     C                     MOVEL*BLANK    WN0015  2        Claim Type
      *
      * Prt Claim-Expense     PO: Mainline
     C                     EXSR E0MAIN
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Claim-Expense Com PO
      *================================================================
      *
     C                     MOVEL*BLANK    WN0016  3        Salesperson to
     C                     Z-ADD*ZERO     WN0017  30       Claim Company N
     C                     Z-ADD*ZERO     WN0018  70       Claim Order Num
     C                     Z-ADD*ZERO     WN0019  70       Load ID
     C                     Z-ADD*ZERO     WN0020  70       Claim Ship to C
     C                     MOVEL*BLANK    WN0021 30        Claim Customer
     C                     MOVEL*BLANK    WN0022  2        Claim Type
     C                     MOVEL*BLANK    WN0023  1        Claim Status
      *
      * Prt Claim-Expense Com PO: Mainline
     C                     EXSR F0MAIN
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Claim-Comm System PO
      *================================================================
      * CASE: PAR.Claim Prt AuditNotes  USR is *YES
     C           P2METX    IFEQ '*YES'                     *IF
     C                     MOVEL@CN,003   YL0008           Claim Expl Acti
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0008           Claim Expl Acti
      * QUIT
     C                     GOTO UMEXIT                     *QUIT
     C                     END                             *FI
      * Prt Claim-Comm ChgAct PO: Mainline
     C                     EXSR G0MAIN
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Claim-Comm Intrl  PO
      *================================================================
      * CASE: PAR.Claim Prt IntrlNotes  USR is *YES
     C           P2L3TX    IFEQ '*YES'                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO UNEXIT                     *QUIT
     C                     END                             *FI
      * Prt Claim-Comm Intrl  PO: Mainline
     C                     EXSR H0MAIN
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZDINIT    BEGSR
      *================================================================
      * PRT Claim-Resale Prd  PO: Initialise
      *================================================================
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UJSUBR                     Modifications a
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZEINIT    BEGSR
      *================================================================
      * Prt Claim-Expense     PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     Z-ADD$DAZVL    YL0007           Net Loss Amount
      *================================================================
     CSR         ZEEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1ZLCD           Salesperson to
     C                     Z-ADD*ZERO     P1ALNX           Claim Order Num
     C                     Z-ADD*ZERO     P1RMNB           Load ID
     C                     Z-ADD*ZERO     P1C3C7           Claim Ship to C
     C                     MOVEL*BLANK    P1RFTX           Claim Customer
     C                     MOVEL*BLANK    P1CHSX           Claim Type
     C                     MOVEL*BLANK    P1CJSX           Claim Status
     C                     Z-ADD*ZERO     P1AYVL           Claim Amount
     C                     Z-ADD*ZERO     P1AZVL           Claim Net Loss
     C                     Z-ADD*ZERO     P1A0VL           Claim Approved
     C                     MOVEL*BLANK    P1PQTX           Claim Contact N
     C                     MOVEL*BLANK    P1TBTX           Claim Resolutio
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    MKC0C7           Claim Number
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Unused Parm - CD7     USR
     C                     Z-ADD*ZERO     WUY4CD  70
      * Define work field Unused Parm - Text    USR
     C                     MOVEL*BLANK    WUOSTX 25
      * Define work field Unused Parm - Date    USR
     C                     Z-ADD*ZERO     WUMTDT  70
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Firm Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WADWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WADXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WADYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WADZPR           OD Original Ord
     C                     Z-ADD*ZERO     WAGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD Market Begin
     C                     Z-ADD*ZERO     WATLDT           OD Market Endin
     C                     Z-ADD*ZERO     WATMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    MNC0C7           Claim Number
     C                     MOVEL*LOVAL    MNAANX           Claim Explanati
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    MOC0C7           Claim Number
     C                     MOVEL*LOVAL    MOAFNX           Claim Item Line
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    MPC0C7           Claim Number
     C                     MOVEL*LOVAL    MPBKC7           Ship To Custome
     C                     MOVEL*LOVAL    MPAKNX           Resale Item Lin
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A1C0C7           Claim Number
     C                     MOVEL*LOVAL    A1F1AA           Expense Code
     C                     MOVEL*LOVAL    A1DXNB           Sequence Number
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A2C0C7           Claim Number
     C                     MOVEL*LOVAL    A2F1AA           Expense Code
     C                     MOVEL*LOVAL    A2DXNB           Sequence Number
     C                     MOVEL*LOVAL    A2YVNX           Sequence Number
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAANX           Claim Explanati
     C                     Z-ADD*ZERO     WBLGNY           Claim Exp Usr S
     C                     Z-ADD*ZERO     WBRRDT           Claim Expl Note
     C                     Z-ADD*ZERO     WBRSDT           Claim Expl Acti
     C                     Z-ADD*ZERO     WBC9TM           Claim Expl Acti
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WBC0C7           Claim Number
     C                     MOVEL*LOVAL    WBN7T1           Claim Expl Acti
     C                     MOVEL*LOVAL    WBAANX           Claim Explanati
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WCC0C7           Claim Number
     C                     MOVEL*HIVAL    WCRRDT           Claim Expl Note
     C                     MOVEL*LOVAL    WCLGNY           Claim Exp Usr S
     C                     MOVEL*LOVAL    WCAANX           Claim Explanati
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  3
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field Invoice Date
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Salesperson to Rvw Claim
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field Text USR 23
     C                     MOVEL*BLANK    YL0004 23
      * Define local work field Total Trans Amount 1 Usr
     C                     Z-ADD*ZERO     YL0005 132
      * Define local work field Total Trans Amount 2 Usr
     C                     Z-ADD*ZERO     YL0006 132
      * Define local work field Net Loss Amount
     C                     Z-ADD*ZERO     YL0007 112
      * Define local work field Claim Expl Action
     C                     MOVEL*BLANK    YL0008 10
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Change on Claim
00002 Claim with Internal Notes
00003 CLMCHANGE
