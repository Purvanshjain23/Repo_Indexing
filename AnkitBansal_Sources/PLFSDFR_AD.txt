// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PLFSDFR
// ?Date: 14.08.2025 Time: 02:54:08
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?Modifications and Comments
DO;

//?R7522 JJH 02/17/17 - Inactivate Producer Site Mileage
//?- Display Record Status of Producer Site Mileage in Subfile Record
//?- Display Record Status of Producer Site in Subfile Control
//?E3814 JJH 10/05/15 - Display PS Premsises ID from Producer Site
ENDDO;

// Execute function Mov ApplN to Company  US.
EXECUTE FUNCTION(Mov ApplN to Company  US) TYPE(EXCUSRSRC) ('PKMFUFR');
PARAMETER(PAR.Oms_System_Value_Alpha);
{
 C***   MOVE USER SOURCE                      ***
 C                     MOVEL#IEVTX    ##CMP
}


// LCL.First Time Flag Usr = CND.Yes
LCL.First_Time_Flag_Usr = 'Y';

//?USER: Initialize subfile control

EXECUTE FUNCTION(Producer Name         DRV) TYPE(DRVFLD)                        AB1100361;
PARAMETER(CTL.Producer_Name_DRV);
PARAMETER(PAR.PD_Producer_Code);
{
 //?Calculate derived field

 EXECUTE FUNCTION(Rtv Producer Name     RT) TYPE(RTVOBJ) FILE(PKACREP)           AB1101542;
 PARAMETER(PAR.PD_Producer_Code);
 PARAMETER(PAR.Producer_Name_DRV);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

}


//?E3814 JJH 10/05/15 - Display PS Premises ID
//?R7522 JJH 02/17/17 - Display Records Status of Producer Site
EXECUTE FUNCTION(Rtv PrdSite Inform    RT) TYPE(RTVOBJ) FILE(PLATREP)           AB1273272;
PARAMETER(CTL.PD_Producer_Code);
PARAMETER(CTL.PS_Site_ID);
PARAMETER(CTL.PS_Site_Name);
PARAMETER(LCL.PS_Manager);
PARAMETER(LCL.PS_Address);
PARAMETER(CTL.PS_City);
PARAMETER(CTL.PS_State);
PARAMETER(CTL.PS_Zip_Code);
PARAMETER(LCL.PS_Latitude);
PARAMETER(LCL.PS_Longitude);
PARAMETER(LCL.PS_User_Mileage_1);
PARAMETER(LCL.PS_User_Mileage_2);
PARAMETER(LCL.PS_Facility_Type_County);
PARAMETER(LCL.PS_Status_1);
PARAMETER(LCL.PS_Status_2);
PARAMETER(LCL.PS_Status_3);
PARAMETER(LCL.PS_Trace_Sequence_#);
PARAMETER(LCL.PS_Veterinarian);
PARAMETER(LCL.PS_Nutritionist);
PARAMETER(CTL.PS_Premises_ID);
PARAMETER(CTL.RS_Record_Status_Prd_Site);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


CASE;

// IF LCL.First Time Flag Usr is Yes
IF LCL.First_Time_Flag_Usr = 'Y';

// CTL.RS Record Status = CND.Active
CTL.RS_Record_Status = 'A';

// LCL.First Time Flag Usr = CND.No
LCL.First_Time_Flag_Usr = 'N';

ENDIF;

//?CALC: Subfile control function fields

EXECUTE FUNCTION(Producer Name         DRV) TYPE(DRVFLD)                        AB1100361;
PARAMETER(CTL.Producer_Name_DRV);
PARAMETER(CTL.PD_Producer_Code);
{
 //?Calculate derived field

 EXECUTE FUNCTION(Rtv Producer Name     RT) TYPE(RTVOBJ) FILE(PKACREP)           AB1101542;
 PARAMETER(PAR.PD_Producer_Code);
 PARAMETER(PAR.Producer_Name_DRV);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

}


