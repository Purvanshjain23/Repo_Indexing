     H/TITLE Upd Tto/Prd Lean Dist XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:50:28
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKC0CPL3IF  E           K        DISK
      * RSQ : Crc Sum Prd Lean Dst YTD  Co/Kldte(d)/Prd/Ln%
      *
     FPKCZCPL2IF  E           K        DISK
      * RSQ : Crc Sum Prd          YTD  Co/KlDte(d)/Prd
      *
     FPKA1CPLLIF  E           K        DISK
      * RSQ : Tattoo Header             Co/VchrDte/Vchr/Tto
      *
     FPKA1CPM4IF  E           K        DISK
      * RSQ : Tattoo Header             Ttto Live/Kill Dte only
      *
     FPKB1CPL6IF  E           K        DISK
      * RSQ : Carcass Detail            Co/KDte/Tto/Ln%
      *
     FPKC8CPL1IF  E           K        DISK
      * RTV : Hog Population Dist       Retrieval index
      *
     FPKC0CPL0IF  E           K        DISK                      A
      * UPD : Crc Sum Prd Lean Dst YTD  Update index
      *
     FPKCZCPL0IF  E           K        DISK                      A
      * UPD : Crc Sum Prd          YTD  Update index
      *
     FPKB1CPL0UF  E           K        DISK
      * UPD : Carcass Detail            Update index
      *
     FPKC8CPL0UF  E           K        DISK                      A
      * UPD : Hog Population Dist       Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@C0CPPA
      * Crc Sum Prd Lean Dst YTD  Co/Kldte(d)/Prd/Ln%
      * Renamed input format fields
     I              C0HONB                          WAHONB
     I              C0ABCD                          WAABCD
     I              C0CHDT                          WACHDT
     I              C0BZPC                          WABZPC
     I              C0MGNB                          WAMGNB
     I              C0AAVN                          WAAAVN
     I              C0AADT                          WAAADT
     I              C0AMTM                          WAAMTM
     I              C0AJST                          WAAJST
     I              C0AHVN                          WAAHVN
     I              C0AGVN                          WAAGVN
     I              C0ABVN                          WAABVN
     I              C0ABDT                          WAABDT
     I              C0ABTM                          WAABTM
      *
     I@C0CPO3
      * Crc Sum Prd Lean Dst YTD  Update index
      * Renamed input format fields
     I              C0HONB                          WBHONB
     I              C0ABCD                          WBABCD
     I              C0CHDT                          WBCHDT
     I              C0BZPC                          WBBZPC
     I              C0MGNB                          WBMGNB
     I              C0AAVN                          WBAAVN
     I              C0AADT                          WBAADT
     I              C0AMTM                          WBAMTM
     I              C0AJST                          WBAJST
     I              C0AHVN                          WBAHVN
     I              C0AGVN                          WBAGVN
     I              C0ABVN                          WBABVN
     I              C0ABDT                          WBABDT
     I              C0ABTM                          WBABTM
      *
     I@CZCPPB
      * Crc Sum Prd          YTD  Co/KlDte(d)/Prd
      * Renamed input format fields
     I              CZHONB                          WCHONB
     I              CZABCD                          WCABCD
     I              CZCHDT                          WCCHDT
     I              CZN4NB                          WCN4NB
     I              CZMFNB                          WCMFNB
     I              CZN2NB                          WCN2NB
     I              CZN3NB                          WCN3NB
     I              CZBGVA                          WCBGVA
     I              CZBHVA                          WCBHVA
     I              CZN1NB                          WCN1NB
     I              CZDXPC                          WCDXPC
     I              CZDYPC                          WCDYPC
     I              CZERPR                          WCERPR
     I              CZESPR                          WCESPR
     I              CZU7NB                          WCU7NB
     I              CZU8NB                          WCU8NB
     I              CZFJPC                          WCFJPC
     I              CZAAVN                          WCAAVN
     I              CZAADT                          WCAADT
     I              CZAMTM                          WCAMTM
     I              CZAJST                          WCAJST
     I              CZAHVN                          WCAHVN
     I              CZAGVN                          WCAGVN
     I              CZABVN                          WCABVN
     I              CZABDT                          WCABDT
     I              CZABTM                          WCABTM
      *
     I@CZCPO0
      * Crc Sum Prd          YTD  Update index
      * Renamed input format fields
     I              CZHONB                          WDHONB
     I              CZABCD                          WDABCD
     I              CZCHDT                          WDCHDT
     I              CZN4NB                          WDN4NB
     I              CZMFNB                          WDMFNB
     I              CZN2NB                          WDN2NB
     I              CZN3NB                          WDN3NB
     I              CZBGVA                          WDBGVA
     I              CZBHVA                          WDBHVA
     I              CZN1NB                          WDN1NB
     I              CZDXPC                          WDDXPC
     I              CZDYPC                          WDDYPC
     I              CZERPR                          WDERPR
     I              CZESPR                          WDESPR
     I              CZU7NB                          WDU7NB
     I              CZU8NB                          WDU8NB
     I              CZFJPC                          WDFJPC
     I              CZAAVN                          WDAAVN
     I              CZAADT                          WDAADT
     I              CZAMTM                          WDAMTM
     I              CZAJST                          WDAJST
     I              CZAHVN                          WDAHVN
     I              CZAGVN                          WDAGVN
     I              CZABVN                          WDABVN
     I              CZABDT                          WDABDT
     I              CZABTM                          WDABTM
      *
     I@A1CPPF
      * Tattoo Header             Co/VchrDte/Vchr/Tto
      * Renamed input format fields
     I              A1HMNB                          WEHMNB
     I              A1BNNB                          WEBNNB
     I              A1BONB                          WEBONB
     I              A1CVNB                          WECVNB
     I              A1B0DT                          WEB0DT
     I              A1AWDT                          WEAWDT
     I              A1BICD                          WEBICD
     I              A1CPST                          WECPST
     I              A1ACPR                          WEACPR
     I              A1B9PR                          WEB9PR
     I              A1CAPR                          WECAPR
     I              A1C4ST                          WEC4ST
     I              A1AIPR                          WEAIPR
     I              A1A6DT                          WEA6DT
     I              A1C2ST                          WEC2ST
     I              A1CXNB                          WECXNB
     I              A1CWNB                          WECWNB
     I              A1FCNB                          WEFCNB
     I              A1H9NB                          WEH9NB
     I              A1FDNB                          WEFDNB
     I              A1FENB                          WEFENB
     I              A1HENB                          WEHENB
     I              A1HFNB                          WEHFNB
     I              A1CYNB                          WECYNB
     I              A1LRNB                          WELRNB
     I              A1E0NB                          WEE0NB
     I              A1A5PC                          WEA5PC
     I              A1FBNB                          WEFBNB
     I              A1A4PC                          WEA4PC
     I              A1F7NB                          WEF7NB
     I              A1HDNB                          WEHDNB
     I              A1F5NB                          WEF5NB
     I              A1F4NB                          WEF4NB
     I              A1F3NB                          WEF3NB
     I              A1F2NB                          WEF2NB
     I              A1AVPC                          WEAVPC
     I              A1AWPC                          WEAWPC
     I              A1CWPC                          WECWPC
     I              A1A8PC                          WEA8PC
     I              A1A7PC                          WEA7PC
     I              A1B8PR                          WEB8PR
     I              A1AMPR                          WEAMPR
     I              A1ANPR                          WEANPR
     I              A1AYVA                          WEAYVA
     I              A1AWVA                          WEAWVA
     I              A1AOPR                          WEAOPR
     I              A1AXVA                          WEAXVA
     I              A1APPR                          WEAPPR
     I              A1ASPR                          WEASPR
     I              A1A4VA                          WEA4VA
     I              A1ATPR                          WEATPR
     I              A1A5VA                          WEA5VA
     I              A1CBPR                          WECBPR
     I              A1CCPR                          WECCPR
     I              A1LPNB                          WELPNB
     I              A1CDPR                          WECDPR
     I              A1A7VA                          WEA7VA
     I              A1A2PR                          WEA2PR
     I              A1JWST                          WEJWST
     I              A1CWST                          WECWST
     I              A1D7ST                          WED7ST
     I              A1D8ST                          WED8ST
     I              A1DWST                          WEDWST
     I              A1D6ST                          WED6ST
     I              A1GHNB                          WEGHNB
     I              A1BYDT                          WEBYDT
     I              A1E0ST                          WEE0ST
     I              A1E1ST                          WEE1ST
     I              A1E2ST                          WEE2ST
     I              A1BSDT                          WEBSDT
     I              A1BTDT                          WEBTDT
     I              A1BUDT                          WEBUDT
     I              A1HGNB                          WEHGNB
     I              A1HHNB                          WEHHNB
     I              A1HINB                          WEHINB
     I              A1A3PR                          WEA3PR
     I              A1A4PR                          WEA4PR
     I              A1A6PR                          WEA6PR
     I              A1J9NB                          WEJ9NB
     I              A1D6PR                          WED6PR
     I              A1D7PR                          WED7PR
     I              A1D8PR                          WED8PR
     I              A1D9PR                          WED9PR
     I              A1EAPR                          WEEAPR
     I              A1EBPR                          WEEBPR
     I              A1ECPR                          WEECPR
     I              A1EDPR                          WEEDPR
     I              A1EEPR                          WEEEPR
     I              A1EFPR                          WEEFPR
     I              A1EGPR                          WEEGPR
     I              A1EHPR                          WEEHPR
     I              A1KAST                          WEKAST
     I              A1J7ST                          WEJ7ST
     I              A1J9ST                          WEJ9ST
     I              A1OXNB                          WEOXNB
     I              A1LKST                          WELKST
     I              A1LLST                          WELLST
     I              A1J8ST                          WEJ8ST
     I              A1LIST                          WELIST
     I              A1LJST                          WELJST
     I              A1NZTX                          WENZTX
     I              A1HJCD                          WEHJCD
     I              A1R4ST                          WER4ST
     I              A1R5ST                          WER5ST
     I              A1R6ST                          WER6ST
     I              A1R7ST                          WER7ST
     I              A1THWT                          WETHWT
     I              A1T2WT                          WET2WT
     I              A1THHD                          WETHHD
     I              A1T2HD                          WET2HD
     I              A1OBPR                          WEOBPR
     I              A1KOER                          WEKOER
     I              A1OPIR                          WEOPIR
     I              A1OPEM                          WEOPEM
     I              A1IORP                          WEIORP
     I              A1OWEO                          WEOWEO
     I              A1OQET                          WEOQET
     I              A1URST                          WEURST
     I              A1USST                          WEUSST
     I              A1HHPC                          WEHHPC
     I              A1S9PR                          WES9PR
     I              A1TAPR                          WETAPR
     I              A1TBPR                          WETBPR
     I              A1JFUR                          WEJFUR
     I              A1KRIF                          WEKRIF
     I              A1KORF                          WEKORF
     I              A1KAPR                          WEKAPR
     I              A1KROT                          WEKROT
     I              A1OTJG                          WEOTJG
     I              A1IRJG                          WEIRJG
     I              A1IMJF                          WEIMJF
     I              A1IRGF                          WEIRGF
     I              A1KRJF                          WEKRJF
     I              A1OJRF                          WEOJRF
     I              A1KFOR                          WEKFOR
     I              A1ORJK                          WEORJK
     I              A1OMVJ                          WEOMVJ
     I              A1MVNF                          WEMVNF
     I              A1MCNF                          WEMCNF
     I              A1NCNF                          WENCNF
     I              A1NCHF                          WENCHF
     I              A1IGIR                          WEIGIR
     I              A1KFJR                          WEKFJR
     I              A1EADT                          WEEADT
     I              A1EBDT                          WEEBDT
     I              A1ECDT                          WEECDT
     I              A1EDDT                          WEEDDT
     I              A1EEDT                          WEEEDT
     I              A1U4ST                          WEU4ST
     I              A1U5ST                          WEU5ST
     I              A1U6ST                          WEU6ST
     I              A1U7ST                          WEU7ST
     I              A1U8ST                          WEU8ST
     I              A1U9ST                          WEU9ST
     I              A1VAST                          WEVAST
     I              A1VBST                          WEVBST
     I              A1BDCD                          WEBDCD
     I              A1CSCD                          WECSCD
     I              A1ABCD                          WEABCD
     I              A1AECD                          WEAECD
     I              A1ACCD                          WEACCD
     I              A1AGCD                          WEAGCD
     I              A1BECD                          WEBECD
     I              A1AAVN                          WEAAVN
     I              A1AADT                          WEAADT
     I              A1AMTM                          WEAMTM
     I              A1AJST                          WEAJST
     I              A1AHVN                          WEAHVN
     I              A1AGVN                          WEAGVN
     I              A1ABVN                          WEABVN
     I              A1ABDT                          WEABDT
     I              A1ABTM                          WEABTM
      *
     I@A1CPT5
      * Tattoo Header             Ttto Live/Kill Dte only
      * Renamed input format fields
     I              A1HMNB                          WFHMNB
     I              A1BNNB                          WFBNNB
     I              A1BONB                          WFBONB
     I              A1CVNB                          WFCVNB
     I              A1B0DT                          WFB0DT
     I              A1AWDT                          WFAWDT
     I              A1BICD                          WFBICD
     I              A1CPST                          WFCPST
     I              A1ACPR                          WFACPR
     I              A1B9PR                          WFB9PR
     I              A1CAPR                          WFCAPR
     I              A1C4ST                          WFC4ST
     I              A1AIPR                          WFAIPR
     I              A1A6DT                          WFA6DT
     I              A1C2ST                          WFC2ST
     I              A1CXNB                          WFCXNB
     I              A1CWNB                          WFCWNB
     I              A1FCNB                          WFFCNB
     I              A1H9NB                          WFH9NB
     I              A1FDNB                          WFFDNB
     I              A1FENB                          WFFENB
     I              A1HENB                          WFHENB
     I              A1HFNB                          WFHFNB
     I              A1CYNB                          WFCYNB
     I              A1LRNB                          WFLRNB
     I              A1E0NB                          WFE0NB
     I              A1A5PC                          WFA5PC
     I              A1FBNB                          WFFBNB
     I              A1A4PC                          WFA4PC
     I              A1F7NB                          WFF7NB
     I              A1HDNB                          WFHDNB
     I              A1F5NB                          WFF5NB
     I              A1F4NB                          WFF4NB
     I              A1F3NB                          WFF3NB
     I              A1F2NB                          WFF2NB
     I              A1AVPC                          WFAVPC
     I              A1AWPC                          WFAWPC
     I              A1CWPC                          WFCWPC
     I              A1A8PC                          WFA8PC
     I              A1A7PC                          WFA7PC
     I              A1B8PR                          WFB8PR
     I              A1AMPR                          WFAMPR
     I              A1ANPR                          WFANPR
     I              A1AYVA                          WFAYVA
     I              A1AWVA                          WFAWVA
     I              A1AOPR                          WFAOPR
     I              A1AXVA                          WFAXVA
     I              A1APPR                          WFAPPR
     I              A1ASPR                          WFASPR
     I              A1A4VA                          WFA4VA
     I              A1ATPR                          WFATPR
     I              A1A5VA                          WFA5VA
     I              A1CBPR                          WFCBPR
     I              A1CCPR                          WFCCPR
     I              A1LPNB                          WFLPNB
     I              A1CDPR                          WFCDPR
     I              A1A7VA                          WFA7VA
     I              A1A2PR                          WFA2PR
     I              A1JWST                          WFJWST
     I              A1CWST                          WFCWST
     I              A1D7ST                          WFD7ST
     I              A1D8ST                          WFD8ST
     I              A1DWST                          WFDWST
     I              A1D6ST                          WFD6ST
     I              A1GHNB                          WFGHNB
     I              A1BYDT                          WFBYDT
     I              A1E0ST                          WFE0ST
     I              A1E1ST                          WFE1ST
     I              A1E2ST                          WFE2ST
     I              A1BSDT                          WFBSDT
     I              A1BTDT                          WFBTDT
     I              A1BUDT                          WFBUDT
     I              A1HGNB                          WFHGNB
     I              A1HHNB                          WFHHNB
     I              A1HINB                          WFHINB
     I              A1A3PR                          WFA3PR
     I              A1A4PR                          WFA4PR
     I              A1A6PR                          WFA6PR
     I              A1J9NB                          WFJ9NB
     I              A1D6PR                          WFD6PR
     I              A1D7PR                          WFD7PR
     I              A1D8PR                          WFD8PR
     I              A1D9PR                          WFD9PR
     I              A1EAPR                          WFEAPR
     I              A1EBPR                          WFEBPR
     I              A1ECPR                          WFECPR
     I              A1EDPR                          WFEDPR
     I              A1EEPR                          WFEEPR
     I              A1EFPR                          WFEFPR
     I              A1EGPR                          WFEGPR
     I              A1EHPR                          WFEHPR
     I              A1KAST                          WFKAST
     I              A1J7ST                          WFJ7ST
     I              A1J9ST                          WFJ9ST
     I              A1OXNB                          WFOXNB
     I              A1LKST                          WFLKST
     I              A1LLST                          WFLLST
     I              A1J8ST                          WFJ8ST
     I              A1LIST                          WFLIST
     I              A1LJST                          WFLJST
     I              A1NZTX                          WFNZTX
     I              A1HJCD                          WFHJCD
     I              A1R4ST                          WFR4ST
     I              A1R5ST                          WFR5ST
     I              A1R6ST                          WFR6ST
     I              A1R7ST                          WFR7ST
     I              A1THWT                          WFTHWT
     I              A1T2WT                          WFT2WT
     I              A1THHD                          WFTHHD
     I              A1T2HD                          WFT2HD
     I              A1OBPR                          WFOBPR
     I              A1KOER                          WFKOER
     I              A1OPIR                          WFOPIR
     I              A1OPEM                          WFOPEM
     I              A1IORP                          WFIORP
     I              A1OWEO                          WFOWEO
     I              A1OQET                          WFOQET
     I              A1URST                          WFURST
     I              A1USST                          WFUSST
     I              A1HHPC                          WFHHPC
     I              A1S9PR                          WFS9PR
     I              A1TAPR                          WFTAPR
     I              A1TBPR                          WFTBPR
     I              A1JFUR                          WFJFUR
     I              A1KRIF                          WFKRIF
     I              A1KORF                          WFKORF
     I              A1KAPR                          WFKAPR
     I              A1KROT                          WFKROT
     I              A1OTJG                          WFOTJG
     I              A1IRJG                          WFIRJG
     I              A1IMJF                          WFIMJF
     I              A1IRGF                          WFIRGF
     I              A1KRJF                          WFKRJF
     I              A1OJRF                          WFOJRF
     I              A1KFOR                          WFKFOR
     I              A1ORJK                          WFORJK
     I              A1OMVJ                          WFOMVJ
     I              A1MVNF                          WFMVNF
     I              A1MCNF                          WFMCNF
     I              A1NCNF                          WFNCNF
     I              A1NCHF                          WFNCHF
     I              A1IGIR                          WFIGIR
     I              A1KFJR                          WFKFJR
     I              A1EADT                          WFEADT
     I              A1EBDT                          WFEBDT
     I              A1ECDT                          WFECDT
     I              A1EDDT                          WFEDDT
     I              A1EEDT                          WFEEDT
     I              A1U4ST                          WFU4ST
     I              A1U5ST                          WFU5ST
     I              A1U6ST                          WFU6ST
     I              A1U7ST                          WFU7ST
     I              A1U8ST                          WFU8ST
     I              A1U9ST                          WFU9ST
     I              A1VAST                          WFVAST
     I              A1VBST                          WFVBST
     I              A1BDCD                          WFBDCD
     I              A1CSCD                          WFCSCD
     I              A1ABCD                          WFABCD
     I              A1AECD                          WFAECD
     I              A1ACCD                          WFACCD
     I              A1AGCD                          WFAGCD
     I              A1BECD                          WFBECD
     I              A1AAVN                          WFAAVN
     I              A1AADT                          WFAADT
     I              A1AMTM                          WFAMTM
     I              A1AJST                          WFAJST
     I              A1AHVN                          WFAHVN
     I              A1AGVN                          WFAGVN
     I              A1ABVN                          WFABVN
     I              A1ABDT                          WFABDT
     I              A1ABTM                          WFABTM
      *
     I@B1CPO8
      * Carcass Detail            Co/KDte/Tto/Ln%
      * Renamed input format fields
     I              B1HMNB                          WGHMNB
     I              B1BNNB                          WGBNNB
     I              B1BONB                          WGBONB
     I              B1CVNB                          WGCVNB
     I              B1B0DT                          WGB0DT
     I              B1LGNB                          WGLGNB
     I              B1EUNB                          WGEUNB
     I              B1LHNB                          WGLHNB
     I              B1INST                          WGINST
     I              B1BEPR                          WGBEPR
     I              B1ASPC                          WGASPC
     I              B1EWNB                          WGEWNB
     I              B1B4PR                          WGB4PR
     I              B1EYNB                          WGEYNB
     I              B1B1PR                          WGB1PR
     I              B1AVPR                          WGAVPR
     I              B1AUPC                          WGAUPC
     I              B1AWPR                          WGAWPR
     I              B1AXPR                          WGAXPR
     I              B1EZNB                          WGEZNB
     I              B1AYPR                          WGAYPR
     I              B1BBDT                          WGBBDT
     I              B1AKTM                          WGAKTM
     I              B1IQST                          WGIQST
     I              B1EFST                          WGEFST
     I              B1H6NB                          WGH6NB
     I              B1BEPC                          WGBEPC
     I              B1GCST                          WGGCST
     I              B1GDST                          WGGDST
     I              B1GEST                          WGGEST
     I              B1BHPC                          WGBHPC
     I              B1IOST                          WGIOST
     I              B1IPST                          WGIPST
     I              B1LTNB                          WGLTNB
     I              B1JNST                          WGJNST
     I              B1X4NB                          WGX4NB
     I              B1FNPC                          WGFNPC
     I              B1FOPC                          WGFOPC
     I              B1FPPC                          WGFPPC
     I              B1K2ST                          WGK2ST
     I              B1K3ST                          WGK3ST
     I              B1JWPR                          WGJWPR
     I              B1F5PC                          WGF5PC
     I              B1JXPR                          WGJXPR
     I              B1JYPR                          WGJYPR
     I              B1JZPR                          WGJZPR
     I              B1J0PR                          WGJ0PR
     I              B1J1PR                          WGJ1PR
     I              B1J2PR                          WGJ2PR
     I              B1J3PR                          WGJ3PR
     I              B1J4PR                          WGJ4PR
     I              B1UTST                          WGUTST
     I              B1HVCD                          WGHVCD
     I              B1DKJR                          WGDKJR
     I              B1ITJF                          WGITJF
     I              B1IJGR                          WGIJGR
     I              B1ORJE                          WGORJE
     I              B1OTJR                          WGOTJR
     I              B1PEIR                          WGPEIR
     I              B1IEUF                          WGIEUF
     I              B1ORUE                          WGORUE
     I              B1IUTR                          WGIUTR
     I              B1IJRR                          WGIJRR
     I              B1VCST                          WGVCST
     I              B1VDST                          WGVDST
     I              B1VEST                          WGVEST
     I              B1VFST                          WGVFST
     I              B1VGST                          WGVGST
     I              B1ABCD                          WGABCD
     I              B1AACD                          WGAACD
     I              B1AAVN                          WGAAVN
     I              B1AADT                          WGAADT
     I              B1AMTM                          WGAMTM
     I              B1AJST                          WGAJST
     I              B1AHVN                          WGAHVN
     I              B1AGVN                          WGAGVN
     I              B1ABVN                          WGABVN
     I              B1ABDT                          WGABDT
     I              B1ABTM                          WGABTM
      *
     I@B1CPG6
      * Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WHHMNB
     I              B1BNNB                          WHBNNB
     I              B1BONB                          WHBONB
     I              B1CVNB                          WHCVNB
     I              B1B0DT                          WHB0DT
     I              B1LGNB                          WHLGNB
     I              B1EUNB                          WHEUNB
     I              B1LHNB                          WHLHNB
     I              B1INST                          WHINST
     I              B1BEPR                          WHBEPR
     I              B1ASPC                          WHASPC
     I              B1EWNB                          WHEWNB
     I              B1B4PR                          WHB4PR
     I              B1EYNB                          WHEYNB
     I              B1B1PR                          WHB1PR
     I              B1AVPR                          WHAVPR
     I              B1AUPC                          WHAUPC
     I              B1AWPR                          WHAWPR
     I              B1AXPR                          WHAXPR
     I              B1EZNB                          WHEZNB
     I              B1AYPR                          WHAYPR
     I              B1BBDT                          WHBBDT
     I              B1AKTM                          WHAKTM
     I              B1IQST                          WHIQST
     I              B1EFST                          WHEFST
     I              B1H6NB                          WHH6NB
     I              B1BEPC                          WHBEPC
     I              B1GCST                          WHGCST
     I              B1GDST                          WHGDST
     I              B1GEST                          WHGEST
     I              B1BHPC                          WHBHPC
     I              B1IOST                          WHIOST
     I              B1IPST                          WHIPST
     I              B1LTNB                          WHLTNB
     I              B1JNST                          WHJNST
     I              B1X4NB                          WHX4NB
     I              B1FNPC                          WHFNPC
     I              B1FOPC                          WHFOPC
     I              B1FPPC                          WHFPPC
     I              B1K2ST                          WHK2ST
     I              B1K3ST                          WHK3ST
     I              B1JWPR                          WHJWPR
     I              B1F5PC                          WHF5PC
     I              B1JXPR                          WHJXPR
     I              B1JYPR                          WHJYPR
     I              B1JZPR                          WHJZPR
     I              B1J0PR                          WHJ0PR
     I              B1J1PR                          WHJ1PR
     I              B1J2PR                          WHJ2PR
     I              B1J3PR                          WHJ3PR
     I              B1J4PR                          WHJ4PR
     I              B1UTST                          WHUTST
     I              B1HVCD                          WHHVCD
     I              B1DKJR                          WHDKJR
     I              B1ITJF                          WHITJF
     I              B1IJGR                          WHIJGR
     I              B1ORJE                          WHORJE
     I              B1OTJR                          WHOTJR
     I              B1PEIR                          WHPEIR
     I              B1IEUF                          WHIEUF
     I              B1ORUE                          WHORUE
     I              B1IUTR                          WHIUTR
     I              B1IJRR                          WHIJRR
     I              B1VCST                          WHVCST
     I              B1VDST                          WHVDST
     I              B1VEST                          WHVEST
     I              B1VFST                          WHVFST
     I              B1VGST                          WHVGST
     I              B1ABCD                          WHABCD
     I              B1AACD                          WHAACD
     I              B1AAVN                          WHAAVN
     I              B1AADT                          WHAADT
     I              B1AMTM                          WHAMTM
     I              B1AJST                          WHAJST
     I              B1AHVN                          WHAHVN
     I              B1AGVN                          WHAGVN
     I              B1ABVN                          WHABVN
     I              B1ABDT                          WHABDT
     I              B1ABTM                          WHABTM
      *
     I@C8CPQQ
      * Hog Population Dist       Retrieval index
      * Renamed input format fields
     I              C8QPNB                          WIQPNB
     I              C8CLDT                          WICLDT
     I              C8ENCD                          WIENCD
     I              C8EMCD                          WIEMCD
     I              C8HSCD                          WIHSCD
     I              C8KUST                          WIKUST
     I              C8KVST                          WIKVST
     I              C8QQNB                          WIQQNB
     I              C8QRNB                          WIQRNB
     I              C8KXST                          WIKXST
     I              C8EPNB                          WIEPNB
     I              C8TMST                          WITMST
     I              C8QTNB                          WIQTNB
     I              C8AAVN                          WIAAVN
     I              C8AADT                          WIAADT
     I              C8AMTM                          WIAMTM
     I              C8AJST                          WIAJST
     I              C8AHVN                          WIAHVN
     I              C8AGVN                          WIAGVN
     I              C8ABVN                          WIABVN
     I              C8ABDT                          WIABDT
     I              C8ABTM                          WIABTM
      *
     I@C8CPQP
      * Hog Population Dist       Update index
      * Renamed input format fields
     I              C8QPNB                          WJQPNB
     I              C8CLDT                          WJCLDT
     I              C8ENCD                          WJENCD
     I              C8EMCD                          WJEMCD
     I              C8HSCD                          WJHSCD
     I              C8KUST                          WJKUST
     I              C8KVST                          WJKVST
     I              C8QQNB                          WJQQNB
     I              C8QRNB                          WJQRNB
     I              C8KXST                          WJKXST
     I              C8EPNB                          WJEPNB
     I              C8TMST                          WJTMST
     I              C8QTNB                          WJQTNB
     I              C8AAVN                          WJAAVN
     I              C8AADT                          WJAADT
     I              C8AMTM                          WJAMTM
     I              C8AJST                          WJAJST
     I              C8AHVN                          WJAHVN
     I              C8AGVN                          WJAGVN
     I              C8ABVN                          WJABVN
     I              C8ABDT                          WJABDT
     I              C8ABTM                          WJABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKC01    E DSPKC0CPL0
      * UPD : Crc Sum Prd Lean Dst YTD  Update index
      * Renamed input format fields
     I              C0HONB                          WBHONB
     I              C0ABCD                          WBABCD
     I              C0CHDT                          WBCHDT
     I              C0BZPC                          WBBZPC
     I              C0MGNB                          WBMGNB
     I              C0AAVN                          WBAAVN
     I              C0AADT                          WBAADT
     I              C0AMTM                          WBAMTM
     I              C0AJST                          WBAJST
     I              C0AHVN                          WBAHVN
     I              C0AGVN                          WBAGVN
     I              C0ABVN                          WBABVN
     I              C0ABDT                          WBABDT
     I              C0ABTM                          WBABTM
      *
     IQPKCZ1    E DSPKCZCPL0
      * UPD : Crc Sum Prd          YTD  Update index
      * Renamed input format fields
     I              CZHONB                          WDHONB
     I              CZABCD                          WDABCD
     I              CZCHDT                          WDCHDT
     I              CZN4NB                          WDN4NB
     I              CZMFNB                          WDMFNB
     I              CZN2NB                          WDN2NB
     I              CZN3NB                          WDN3NB
     I              CZBGVA                          WDBGVA
     I              CZBHVA                          WDBHVA
     I              CZN1NB                          WDN1NB
     I              CZDXPC                          WDDXPC
     I              CZDYPC                          WDDYPC
     I              CZERPR                          WDERPR
     I              CZESPR                          WDESPR
     I              CZU7NB                          WDU7NB
     I              CZU8NB                          WDU8NB
     I              CZFJPC                          WDFJPC
     I              CZAAVN                          WDAAVN
     I              CZAADT                          WDAADT
     I              CZAMTM                          WDAMTM
     I              CZAJST                          WDAJST
     I              CZAHVN                          WDAHVN
     I              CZAGVN                          WDAGVN
     I              CZABVN                          WDABVN
     I              CZABDT                          WDABDT
     I              CZABTM                          WDABTM
      *
     IQPKB11    E DSPKB1CPL0
      * UPD : Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WHHMNB
     I              B1BNNB                          WHBNNB
     I              B1BONB                          WHBONB
     I              B1CVNB                          WHCVNB
     I              B1B0DT                          WHB0DT
     I              B1LGNB                          WHLGNB
     I              B1EUNB                          WHEUNB
     I              B1LHNB                          WHLHNB
     I              B1INST                          WHINST
     I              B1BEPR                          WHBEPR
     I              B1ASPC                          WHASPC
     I              B1EWNB                          WHEWNB
     I              B1B4PR                          WHB4PR
     I              B1EYNB                          WHEYNB
     I              B1B1PR                          WHB1PR
     I              B1AVPR                          WHAVPR
     I              B1AUPC                          WHAUPC
     I              B1AWPR                          WHAWPR
     I              B1AXPR                          WHAXPR
     I              B1EZNB                          WHEZNB
     I              B1AYPR                          WHAYPR
     I              B1BBDT                          WHBBDT
     I              B1AKTM                          WHAKTM
     I              B1IQST                          WHIQST
     I              B1EFST                          WHEFST
     I              B1H6NB                          WHH6NB
     I              B1BEPC                          WHBEPC
     I              B1GCST                          WHGCST
     I              B1GDST                          WHGDST
     I              B1GEST                          WHGEST
     I              B1BHPC                          WHBHPC
     I              B1IOST                          WHIOST
     I              B1IPST                          WHIPST
     I              B1LTNB                          WHLTNB
     I              B1JNST                          WHJNST
     I              B1X4NB                          WHX4NB
     I              B1FNPC                          WHFNPC
     I              B1FOPC                          WHFOPC
     I              B1FPPC                          WHFPPC
     I              B1K2ST                          WHK2ST
     I              B1K3ST                          WHK3ST
     I              B1JWPR                          WHJWPR
     I              B1F5PC                          WHF5PC
     I              B1JXPR                          WHJXPR
     I              B1JYPR                          WHJYPR
     I              B1JZPR                          WHJZPR
     I              B1J0PR                          WHJ0PR
     I              B1J1PR                          WHJ1PR
     I              B1J2PR                          WHJ2PR
     I              B1J3PR                          WHJ3PR
     I              B1J4PR                          WHJ4PR
     I              B1UTST                          WHUTST
     I              B1HVCD                          WHHVCD
     I              B1DKJR                          WHDKJR
     I              B1ITJF                          WHITJF
     I              B1IJGR                          WHIJGR
     I              B1ORJE                          WHORJE
     I              B1OTJR                          WHOTJR
     I              B1PEIR                          WHPEIR
     I              B1IEUF                          WHIEUF
     I              B1ORUE                          WHORUE
     I              B1IUTR                          WHIUTR
     I              B1IJRR                          WHIJRR
     I              B1VCST                          WHVCST
     I              B1VDST                          WHVDST
     I              B1VEST                          WHVEST
     I              B1VFST                          WHVFST
     I              B1VGST                          WHVGST
     I              B1ABCD                          WHABCD
     I              B1AACD                          WHAACD
     I              B1AAVN                          WHAAVN
     I              B1AADT                          WHAADT
     I              B1AMTM                          WHAMTM
     I              B1AJST                          WHAJST
     I              B1AHVN                          WHAHVN
     I              B1AGVN                          WHAGVN
     I              B1ABVN                          WHABVN
     I              B1ABDT                          WHABDT
     I              B1ABTM                          WHABTM
      *
     IYARDCS      DS                            267
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKC81    E DSPKC8CPL0
      * UPD : Hog Population Dist       Update index
      * Renamed input format fields
     I              C8QPNB                          WJQPNB
     I              C8CLDT                          WJCLDT
     I              C8ENCD                          WJENCD
     I              C8EMCD                          WJEMCD
     I              C8HSCD                          WJHSCD
     I              C8KUST                          WJKUST
     I              C8KVST                          WJKVST
     I              C8QQNB                          WJQQNB
     I              C8QRNB                          WJQRNB
     I              C8KXST                          WJKXST
     I              C8EPNB                          WJEPNB
     I              C8TMST                          WJTMST
     I              C8QTNB                          WJQTNB
     I              C8AAVN                          WJAAVN
     I              C8AADT                          WJAADT
     I              C8AMTM                          WJAMTM
     I              C8AJST                          WJAJST
     I              C8AHVN                          WJAHVN
     I              C8AGVN                          WJAGVN
     I              C8ABVN                          WJABVN
     I              C8ABDT                          WJABDT
     I              C8ABTM                          WJABTM
      *
     IYBRDCS      DS                             94
     IYCRDCS      DS                             94
     IYDRDCS      DS                             94
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I :  BOH Company Number
     I                                    P   1   20P1HMNB
      * I : MAP TH Voucher Payment Date
     I                                    P   3   60P1BYDT
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Del Spool File'
      * Program Object USR
     I                                        1  10 ZA0001
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BYDT    PARM           WP0002  70       TH Voucher Paym
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Upd Tto/Prd Lean Dist XF
      * MODIFICATIONS
      * 11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM
      * HPE085
      * Hog Pop by farm site
      * Cpy to Curr Kill Date RT - Crc Sum Prd Lean Dst YTD  * 
     C                     EXSR SARVGN
      * Cpy to Curr Kill Date RT - Crc Sum Prd          YTD  * 
     C                     EXSR SCRVGN
      * Upd Tto/Prd Lean Dist RT - Tattoo Header  * Pay Type = Carcass Me
     C                     EXSR SERVGN
      * Upd Tto/Prd Ln Dst Lv RT - Tattoo Header  * Pay Type = Live
     C                     EXSR SFRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Cpy to Curr Kill Date RT - Crc Sum Prd Lean Dst YTD  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUHBST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHONB    WQSA01           CC Company Numb
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           CC Company Numb
     C                     KFLD           WACHDT           PY As of Kill D
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           CC Company Numb
      * Setup key
     C                     Z-ADDP1HMNB    WQSA01           CC Company Numb
     C                     Z-ADDP1BYDT    WACHDT           PY As of Kill D
      * Establish starting position
     C           KPSSA     SETLL@C0CPPA                    *
     C           KRSSA     READE@C0CPPA                  90*
      * Data record not found
     C   90                MOVEL'PRK0426' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.First Time Flag Usr is Yes
     C           WUHBST    IFEQ 'Y'                        *IF
     C                     Z-ADDWACHDT    WUCHDT           PY As of Kill D
     C                     MOVEL'N'       WUHBST           First Time Flag
     C                     END                             *FI
      * Quit if Par and Wrk are same.
      * CASE: WRK.PY As of Kill Date EQ PAR.PY As of Kill Date
     C           WUCHDT    IFEQ P1BYDT                     *IF
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
      * Quit if the date changes.
      * CASE: DB1.PY As of Kill Date NE WRK.PY As of Kill Date
     C           WACHDT    IFNE WUCHDT                     *IF
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
      * Crt CrcSum Prd Ln Dst CR - Crc Sum Prd Lean Dst YTD  * 
     C                     EXSR SBCRRC
     C           KRSSA     READE@C0CPPA                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Crt CrcSum Prd Ln Dst CR - Crc Sum Prd Lean Dst YTD  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @C0CPO3
     C                     Z-ADDWAHONB    WBHONB           CC Company Numb
     C                     MOVELWAABCD    WBABCD           PD Producer Cod
     C                     Z-ADDP1BYDT    WBCHDT           PY As of Kill D
     C                     Z-ADDWABZPC    WBBZPC           PLDY Lean %
     C                     Z-ADDWAMGNB    WBMGNB           PLDY Head Kille
     C                     MOVELWAAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWAAADT    WBAADT           RS Date Changed
     C                     Z-ADDWAAMTM    WBAMTM           RS Time Changed
     C                     MOVELWAAJST    WBAJST           RS Record Statu
     C                     MOVELWAAHVN    WBAHVN           RS Job
     C                     MOVELWAAGVN    WBAGVN           RS Program
     C                     MOVELWAABVN    WBABVN           RS User Added
     C                     Z-ADDWAABDT    WBABDT           RS Date Added
     C                     Z-ADDWAABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSB    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBABCD           PD Producer Cod
     C                     KFLD           WBCHDT           PY As of Kill D
     C                     KFLD           WBBZPC           PLDY Lean %
      * Check for duplicate primary key
     C           KLCRSB    SETLL@C0CPO3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0427' W0RTN   7
      * Send message 'Crc Sum Prd Lean Dst Y EX'
     C                     MOVEL'PRK0427' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@C0CPO3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Cpy to Curr Kill Date RT - Crc Sum Prd          YTD  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUHBST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHONB    WQSC01           CC Company Numb
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           CC Company Numb
     C                     KFLD           WCCHDT           PY As of Kill D
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           CC Company Numb
      * Setup key
     C                     Z-ADDP1HMNB    WQSC01           CC Company Numb
     C                     Z-ADDP1BYDT    WCCHDT           PY As of Kill D
      * Establish starting position
     C           KPSSC     SETLL@CZCPPB                    *
     C           KRSSC     READE@CZCPPB                  90*
      * Data record not found
     C   90                MOVEL'PRK0424' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.First Time Flag Usr is Yes
     C           WUHBST    IFEQ 'Y'                        *IF
     C                     Z-ADDWCCHDT    WUCHDT           PY As of Kill D
     C                     MOVEL'N'       WUHBST           First Time Flag
     C                     END                             *FI
      * Quit if WRK = PAR
      * CASE: WRK.PY As of Kill Date EQ PAR.PY As of Kill Date
     C           WUCHDT    IFEQ P1BYDT                     *IF
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
      * Quit if date changes
      * CASE: WRK.PY As of Kill Date NE DB1.PY As of Kill Date
     C           WUCHDT    IFNE WCCHDT                     *IF
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
      * Crt Crc Sum Prd YTD   CR - Crc Sum Prd          YTD  * 
     C                     EXSR SDCRRC
     C           KRSSC     READE@CZCPPB                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt Crc Sum Prd YTD   CR - Crc Sum Prd          YTD  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CZCPO0
     C                     Z-ADDWCHONB    WDHONB           CC Company Numb
     C                     MOVELWCABCD    WDABCD           PD Producer Cod
     C                     Z-ADDP1BYDT    WDCHDT           PY As of Kill D
     C                     Z-ADDWCN4NB    WDN4NB           PY Head Receive
     C                     Z-ADDWCMFNB    WDMFNB           PY Head Killed
     C                     Z-ADDWCN2NB    WDN2NB           PY Live Wgt
     C                     Z-ADDWCN3NB    WDN3NB           PY Hot Wgt
     C                     Z-ADDWCBGVA    WDBGVA           PY Lean Prem/De
     C                     Z-ADDWCBHVA    WDBHVA           PY Sort Discoun
     C                     Z-ADDWCN1NB    WDN1NB           PY Avg Live Wgt
     C                     Z-ADDWCDXPC    WDDXPC           PY Actual Yield
     C                     Z-ADDWCDYPC    WDDYPC           PY Avg Lean %
     C                     Z-ADDWCERPR    WDERPR           PY Lean Prem/De
     C                     Z-ADDWCESPR    WDESPR           PY Sort Discoun
     C                     Z-ADDWCU7NB    WDU7NB           PY Adj Live Wei
     C                     Z-ADDWCU8NB    WDU8NB           PY Adj Avg Live
     C                     Z-ADDWCFJPC    WDFJPC           PY Adj Actual Y
     C                     MOVELWCAAVN    WDAAVN           RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST           RS Record Statu
     C                     MOVELWCAHVN    WDAHVN           RS Job
     C                     MOVELWCAGVN    WDAGVN           RS Program
     C                     MOVELWCABVN    WDABVN           RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRSD    KLIST
     C                     KFLD           WDHONB           CC Company Numb
     C                     KFLD           WDABCD           PD Producer Cod
     C                     KFLD           WDCHDT           PY As of Kill D
      * Check for duplicate primary key
     C           KLCRSD    SETLL@CZCPO0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0425' W0RTN   7
      * Send message 'Crc Sum Prd          Y EX'
     C                     MOVEL'PRK0425' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@CZCPO0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Upd Tto/Prd Lean Dist RT - Tattoo Header  * Pay Type = Carcass M
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * HPE085
      * Hog Pop by farm site
      *  -- RTV farm site to send to PF and RTV to output to HogPopDist
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UASUBR                     Get the MTech L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEHMNB    WQSE01           BOH Company Num
     C           *LIKE     DEFN WEBYDT    WQSE02           TH Voucher Paym
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           BOH Company Num
     C                     KFLD           WQSE02           TH Voucher Paym
      * Setup key
     C                     Z-ADDP1HMNB    WQSE01           BOH Company Num
     C                     Z-ADDP1BYDT    WQSE02           TH Voucher Paym
      * Establish starting position
     C           KRSSE     SETLL@A1CPPF                    *
     C           KRSSE     READE@A1CPPF                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WUETNB           Farm Site USR
      * For internal , get farm site from HPS
      * CASE: DB1.TH Source Type is Internal
     C           WEKAST    IFEQ 'I'                        *IF
      * CASE: WRK.MTech Live Yes or No is No MTech not Live
     C           WUFKSS    IFEQ 'N'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0004  7        *Return code
     C                     PARM WEOXNB    WQ0005  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0006 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0007  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0008  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0009  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: WRK.MTech Live Yes or No is Yes MTech is Live
     C           WUFKSS    IFEQ 'Y'                        *IF
     C                     Z-ADDWETHHD    WUETNB           Farm Site USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.TH Payment Type is Carcass Merit
     C           WEJ9ST    IFEQ 'C'                        *IF
      * Upd Cr/Tto/Prd Ln Dist PF - Carcass Detail  * 
     C                     CALL 'PKSKPFR'              90  Upd Cr/Tto/Prd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEHMNB    WQ0010  30       BOH Company Num
     C                     PARM WEBNNB    WQ0011  70       BOH Buy Order N
     C                     PARM WEBONB    WQ0012  50       BOL Load Number
     C                     PARM WECVNB    WQ0013  50       TH Tattoo Numbe
     C                     PARM WEB0DT    WQ0014  70       TH Kill Date
     C                     PARM WEKAST    WQ0015  1        CD Source Type
     C                     PARM WEJ9ST    WQ0016  1        CD Payment Type
     C                     PARM WEABCD    WQ0017  6        PD Producer Cod
     C                     PARM WELKST    WQ0018  3        SR Source Code
     C                     PARM P1BYDT    WQ0019  70       TH Voucher Paym
     C                     PARM WUETNB    WQ0020  50       Farm Site USR
     C                     PARM WEAECD    WQ0021  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKSKPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Setup message data for message
     C                     MOVEL@CN,002   ZA0001           Program Object
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0450' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
     C           KRSSE     READE@A1CPPF                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Upd Tto/Prd Ln Dst Lv RT - Tattoo Header  * Pay Type = Live
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UBSUBR                     Get the MTech L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFB0DT    WQSF01           TH Kill Date
     C           *LIKE     DEFN WFHMNB    WQSF02           BOH Company Num
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           TH Kill Date
     C                     KFLD           WQSF02           BOH Company Num
      * Setup key
     C                     Z-ADDP1BYDT    WQSF01           TH Kill Date
     C                     Z-ADDP1HMNB    WQSF02           BOH Company Num
      * Establish starting position
     C           KRSSF     SETLL@A1CPT5                    *
     C           KRSSF     READE@A1CPT5                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WUETNB           Farm Site USR
      * For internal , get farm site from HPS
      * CASE: DB1.TH Source Type is Internal
     C           WFKAST    IFEQ 'I'                        *IF
      * CASE: WRK.MTech Live Yes or No is No MTech not Live
     C           WUFKSS    IFEQ 'N'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0025  7        *Return code
     C                     PARM WFOXNB    WQ0026  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0027 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0028  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0029  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0030  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: WRK.MTech Live Yes or No is Yes MTech is Live
     C           WUFKSS    IFEQ 'Y'                        *IF
     C                     Z-ADDWFTHHD    WUETNB           Farm Site USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.TH Hog Class Type is Not Resale
     C           WFLLST    IFEQ 'M'                        *IF
     C           WFLLST    OREQ 'S'
      * Upd Cr Pay Info       RT - Carcass Detail  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
     C           KRSSF     READE@A1CPT5                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Upd Cr Pay Info       RT - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQSG01           BOH Company Num
     C           *LIKE     DEFN WGB0DT    WQSG02           TH Kill Date
     C           *LIKE     DEFN WGCVNB    WQSG03           TH Tattoo Numbe
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           BOH Company Num
     C                     KFLD           WQSG02           TH Kill Date
     C                     KFLD           WQSG03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWFHMNB    WQSG01           BOH Company Num
     C                     Z-ADDWFB0DT    WQSG02           TH Kill Date
     C                     Z-ADDWFCVNB    WQSG03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSG     SETLL@B1CPO8                    *
     C           KRSSG     READE@B1CPO8                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     EXSR UCSUBR
     C           KRSSG     READE@B1CPO8                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg Carc Dtl Paymnt   CH - Carcass Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        CD Record Add/D
     C                     Z-ADD*ZERO     WN0002  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0003  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0004  51       CD Carcass/Hot
     C                     Z-ADD*ZERO     WN0005  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0006  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0007  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0008  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0009  31       CD Lean Percent
     C                     Z-ADD*ZERO     WN0010  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0011  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0012  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0013  72       CD Gross Value
     C                     Z-ADD*ZERO     WN0014  70       CD Kill Date
     C                     Z-ADD*ZERO     WN0015  60       CD Kill Time
     C                     MOVEL*BLANK    WN0016  1        CD Shift
     C                     MOVEL*BLANK    WN0017  1        CD Carcass Acti
     C                     Z-ADD*ZERO     WN0018  31       CD Backfat Thic
     C                     Z-ADD*ZERO     WN0019  31       CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0020  31       CD Light Reflec
     C                     MOVEL*BLANK    WN0021  1        CD Trim Area
     C                     MOVEL*BLANK    WN0022  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0023  31       CD FFLI
     C                     MOVEL*BLANK    WN0024  1        CD Record Creat
     C                     MOVEL*BLANK    WN0025  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0026  50       CD LOT
     C                     MOVEL*BLANK    WN0027  1        CD User Error O
     C                     Z-ADD*ZERO     WN0028  31       CD Backfat Thic
     C                     Z-ADD*ZERO     WN0029  31       CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0030  31       CD Light Reflec
     C                     Z-ADD*ZERO     WN0031  31       CD Lean Percent
     C                     MOVEL*BLANK    WN0032  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0033  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0034  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0035  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0036  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0037  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0038  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0039  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0040  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0041  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0042  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0043  72       CD Gross Before
     C                     MOVEL*BLANK    WN0044  1        CD Broken Back
     C                     MOVEL*BLANK    WN0045  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0046  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0047  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0048  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0049 10        RS User Changed
     C                     Z-ADD*ZERO     WN0050  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0051  60       RS Time Changed
     C                     MOVEL*BLANK    WN0052  1        RS Record Statu
     C                     MOVEL*BLANK    WN0053 10        RS Job
     C                     MOVEL*BLANK    WN0054 10        RS Program
     C                     MOVEL*BLANK    WN0055 10        RS User Added
     C                     Z-ADD*ZERO     WN0056  70       RS Date Added
     C                     Z-ADD*ZERO     WN0057  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B1CPG6
     C                     Z-ADDWGHMNB    WHHMNB           BOH Company Num
     C                     Z-ADDWGBNNB    WHBNNB           BOH Buy Order N
     C                     Z-ADDWGBONB    WHBONB           BOL Load Number
     C                     Z-ADDWGCVNB    WHCVNB           TH Tattoo Numbe
     C                     Z-ADDWGB0DT    WHB0DT           TH Kill Date
     C                     Z-ADDWGLGNB    WHLGNB           CD Scale Sequen
     C                     Z-ADDWGEUNB    WHEUNB           CD Carcass Numb
     C                     Z-ADDWGLHNB    WHLHNB           CD Carcass Numb
      *
     C           KLCHSH    KLIST
     C                     KFLD           WHHMNB           BOH Company Num
     C                     KFLD           WHBNNB           BOH Buy Order N
     C                     KFLD           WHBONB           BOL Load Number
     C                     KFLD           WHCVNB           TH Tattoo Numbe
     C                     KFLD           WHB0DT           TH Kill Date
     C                     KFLD           WHLGNB           CD Scale Sequen
     C                     KFLD           WHEUNB           CD Carcass Numb
     C                     KFLD           WHLHNB           CD Carcass Numb
     C           KLCHSH    CHAIN@B1CPG6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKB1CPL0'MDACP
     C                     MOVEL'@B1CPG6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKB11    YARDCS
      * USER: Processing after Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WHAAVN           RS User Changed
     C                     Z-ADD##JDT     WHAADT           RS Date Changed
     C                     Z-ADD##JTM     WHAMTM           RS Time Changed
     C                     MOVEL##JOB     WHAHVN           RS Job
     C                     MOVEL##PGM     WHAGVN           RS Program
      * Move non-key fields to @B1CPG6
     C                     MOVELWFKAST    WHK2ST    P      CD Source Type
     C                     MOVELWFJ9ST    WHK3ST    P      CD Payment Type
     C                     Z-ADDWGJWPR    WHJWPR           CD CA Sort Loss
     C                     Z-ADDWGF5PC    WHF5PC           CD CA Std Yield
     C                     Z-ADDWGJXPR    WHJXPR           CD CA Base Carc
     C                     Z-ADDWGJYPR    WHJYPR           CD CA Crc Value
     C                     Z-ADDWGJZPR    WHJZPR           CD CA Base Carc
     C                     Z-ADDWGJ0PR    WHJ0PR           CD CA Crc Value
     C                     Z-ADDWGJ1PR    WHJ1PR           CD CA Lean Prem
     C                     Z-ADDWGJ2PR    WHJ2PR           CD CA Lean Prem
     C                     Z-ADDWGJ3PR    WHJ3PR           CD CA Gross Val
     C                     Z-ADDWGJ4PR    WHJ4PR           CD CA Gross Val
     C                     MOVELWFABCD    WHABCD    P      PD Producer Cod
     C                     MOVELWFLKST    WHAACD    P      SR Source Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B1CPG6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKB1CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Upd Hog Pop Dist      RT - Hog Population Dist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WIQPNB           HPD Company Num
     C                     KFLD           WICLDT           HPD Kill Date
     C                     KFLD           WIENCD           HPD Source Code
     C                     KFLD           WIEMCD           HPD Producer Co
     C                     KFLD           WIHSCD           HPD Pdcr Locati
     C                     KFLD           WIKUST           HPD Source Type
     C                     KFLD           WIKVST           HPD Payment Typ
     C                     KFLD           WIQQNB           HPD Carcass Wei
     C                     KFLD           WIQRNB           HPD Distributio
     C                     KFLD           WIKXST           HPD Type of Rec
     C                     KFLD           WIEPNB           HPD Farm Site
     C                     KFLD           WITMST           HPD Kill Shift
      * Setup key
     C                     Z-ADDWGHMNB    WIQPNB           HPD Company Num
     C                     Z-ADDWGB0DT    WICLDT           HPD Kill Date
     C                     MOVELWFLKST    WIENCD           HPD Source Code
     C                     MOVELWFABCD    WIEMCD           HPD Producer Co
     C                     MOVELWFAECD    WIHSCD           HPD Pdcr Locati
     C                     MOVELWFKAST    WIKUST           HPD Source Type
     C                     MOVELWFJ9ST    WIKVST           HPD Payment Typ
     C                     Z-ADDWUQQNB    WIQQNB           HPD Carcass Wei
     C                     Z-ADDWGH6NB    WIQRNB           HPD Distributio
     C                     MOVEL'B'       WIKXST           HPD Type of Rec
     C                     Z-ADDWUETNB    WIEPNB           HPD Farm Site
     C                     MOVELWGIQST    WITMST           HPD Kill Shift
      * Establish starting position
     C           KRSSI     CHAIN@C8CPQQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0474' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUQTNB           HPD No of Carca
      * Crt Hog Ppltn Dist    CR - Hog Population Dist  * 
     C                     EXSR SJCRRC
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WIQTNB    ADD  1         WUQTNB           HPD No of Carca
      * Chg Hog Ppltn Dist    CH - Hog Population Dist  * 
     C                     EXSR SKCHRC
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt Hog Ppltn Dist    CR - Hog Population Dist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @C8CPQP
     C                     Z-ADDWGHMNB    WJQPNB           HPD Company Num
     C                     Z-ADDWGB0DT    WJCLDT           HPD Kill Date
     C                     MOVELWFLKST    WJENCD           HPD Source Code
     C                     MOVELWFABCD    WJEMCD           HPD Producer Co
     C                     MOVELWFAECD    WJHSCD           HPD Pdcr Locati
     C                     MOVELWFKAST    WJKUST           HPD Source Type
     C                     MOVELWFJ9ST    WJKVST           HPD Payment Typ
     C                     Z-ADDWUQQNB    WJQQNB           HPD Carcass Wei
     C                     Z-ADDWGH6NB    WJQRNB           HPD Distributio
     C                     MOVEL'B'       WJKXST           HPD Type of Rec
     C                     Z-ADDWUETNB    WJEPNB           HPD Farm Site
     C                     MOVELWGIQST    WJTMST           HPD Kill Shift
     C                     Z-ADDWUQTNB    WJQTNB           HPD No of Carca
     C                     MOVEL*BLANK    WJAAVN           RS User Changed
     C                     Z-ADD*ZERO     WJAADT           RS Date Changed
     C                     Z-ADD*ZERO     WJAMTM           RS Time Changed
     C                     MOVEL'A'       WJAJST           RS Record Statu
     C                     MOVEL*BLANK    WJAHVN           RS Job
     C                     MOVEL*BLANK    WJAGVN           RS Program
     C                     MOVEL*BLANK    WJABVN           RS User Added
     C                     Z-ADD*ZERO     WJABDT           RS Date Added
     C                     Z-ADD*ZERO     WJABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WJAJST           RS Record Statu
     C                     MOVEL##USR     WJABVN           RS User Added
     C                     Z-ADD##JDT     WJABDT           RS Date Added
     C                     Z-ADD##JTM     WJABTM           RS Time Added
     C                     MOVEL##PGM     WJAGVN           RS Program
     C                     MOVEL##JOB     WJAHVN           RS Job
     C           KLCRSJ    KLIST
     C                     KFLD           WJQPNB           HPD Company Num
     C                     KFLD           WJCLDT           HPD Kill Date
     C                     KFLD           WJENCD           HPD Source Code
     C                     KFLD           WJEMCD           HPD Producer Co
     C                     KFLD           WJHSCD           HPD Pdcr Locati
     C                     KFLD           WJKUST           HPD Source Type
     C                     KFLD           WJKVST           HPD Payment Typ
     C                     KFLD           WJQQNB           HPD Carcass Wei
     C                     KFLD           WJQRNB           HPD Distributio
     C                     KFLD           WJKXST           HPD Type of Rec
     C                     KFLD           WJEPNB           HPD Farm Site
     C                     KFLD           WJTMST           HPD Kill Shift
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@C8CPQP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0475' W0RTN   7
      * Send message 'Hog Population Dist    EX'
     C                     MOVEL'PRK0475' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@C8CPQP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Dist    CH - Hog Population Dist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @C8CPQP
     C                     Z-ADDWIQPNB    WJQPNB           HPD Company Num
     C                     Z-ADDWICLDT    WJCLDT           HPD Kill Date
     C                     MOVELWIENCD    WJENCD    P      HPD Source Code
     C                     MOVELWIEMCD    WJEMCD    P      HPD Producer Co
     C                     MOVELWIHSCD    WJHSCD    P      HPD Pdcr Locati
     C                     MOVELWIKUST    WJKUST    P      HPD Source Type
     C                     MOVELWIKVST    WJKVST    P      HPD Payment Typ
     C                     Z-ADDWIQQNB    WJQQNB           HPD Carcass Wei
     C                     Z-ADDWIQRNB    WJQRNB           HPD Distributio
     C                     MOVELWIKXST    WJKXST    P      HPD Type of Rec
     C                     Z-ADDWIEPNB    WJEPNB           HPD Farm Site
     C                     MOVELWITMST    WJTMST    P      HPD Kill Shift
      *
     C           KLCHSK    KLIST
     C                     KFLD           WJQPNB           HPD Company Num
     C                     KFLD           WJCLDT           HPD Kill Date
     C                     KFLD           WJENCD           HPD Source Code
     C                     KFLD           WJEMCD           HPD Producer Co
     C                     KFLD           WJHSCD           HPD Pdcr Locati
     C                     KFLD           WJKUST           HPD Source Type
     C                     KFLD           WJKVST           HPD Payment Typ
     C                     KFLD           WJQQNB           HPD Carcass Wei
     C                     KFLD           WJQRNB           HPD Distributio
     C                     KFLD           WJKXST           HPD Type of Rec
     C                     KFLD           WJEPNB           HPD Farm Site
     C                     KFLD           WJTMST           HPD Kill Shift
     C           KLCHSK    CHAIN@C8CPQP              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC8CPL0'MDACP
     C                     MOVEL'@C8CPQP' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC81    YBRDCS
      * Move non-key fields to @C8CPQP
     C                     Z-ADDWUQTNB    WJQTNB           HPD No of Carca
     C                     MOVELWIAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWIAADT    WJAADT           RS Date Changed
     C                     Z-ADDWIAMTM    WJAMTM           RS Time Changed
     C                     MOVELWIAJST    WJAJST    P      RS Record Statu
     C                     MOVELWIAHVN    WJAHVN    P      RS Job
     C                     MOVELWIAGVN    WJAGVN    P      RS Program
     C                     MOVELWIABVN    WJABVN    P      RS User Added
     C                     Z-ADDWIABDT    WJABDT           RS Date Added
     C                     Z-ADDWIABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC81    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKC81    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@C8CPQP                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Upd Hog Pop Dist      RT - Hog Population Dist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WIQPNB           HPD Company Num
     C                     KFLD           WICLDT           HPD Kill Date
     C                     KFLD           WIENCD           HPD Source Code
     C                     KFLD           WIEMCD           HPD Producer Co
     C                     KFLD           WIHSCD           HPD Pdcr Locati
     C                     KFLD           WIKUST           HPD Source Type
     C                     KFLD           WIKVST           HPD Payment Typ
     C                     KFLD           WIQQNB           HPD Carcass Wei
     C                     KFLD           WIQRNB           HPD Distributio
     C                     KFLD           WIKXST           HPD Type of Rec
     C                     KFLD           WIEPNB           HPD Farm Site
     C                     KFLD           WITMST           HPD Kill Shift
      * Setup key
     C                     Z-ADDWGHMNB    WIQPNB           HPD Company Num
     C                     Z-ADDWGB0DT    WICLDT           HPD Kill Date
     C                     MOVELWFLKST    WIENCD           HPD Source Code
     C                     MOVELWFABCD    WIEMCD           HPD Producer Co
     C                     MOVELWFAECD    WIHSCD           HPD Pdcr Locati
     C                     MOVELWFKAST    WIKUST           HPD Source Type
     C                     MOVELWFJ9ST    WIKVST           HPD Payment Typ
     C                     Z-ADDWUQQNB    WIQQNB           HPD Carcass Wei
     C                     Z-ADDWGBEPC    WIQRNB           HPD Distributio
     C                     MOVEL'E'       WIKXST           HPD Type of Rec
     C                     Z-ADDWUETNB    WIEPNB           HPD Farm Site
     C                     MOVELWGIQST    WITMST           HPD Kill Shift
      * Establish starting position
     C           KRSSL     CHAIN@C8CPQQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0474' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUQTNB           HPD No of Carca
      * Crt Hog Ppltn Dist    CR - Hog Population Dist  * 
     C                     EXSR SMCRRC
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WIQTNB    ADD  1         WUQTNB           HPD No of Carca
      * Chg Hog Ppltn Dist    CH - Hog Population Dist  * 
     C                     EXSR SNCHRC
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Crt Hog Ppltn Dist    CR - Hog Population Dist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @C8CPQP
     C                     Z-ADDWGHMNB    WJQPNB           HPD Company Num
     C                     Z-ADDWGB0DT    WJCLDT           HPD Kill Date
     C                     MOVELWFLKST    WJENCD           HPD Source Code
     C                     MOVELWFABCD    WJEMCD           HPD Producer Co
     C                     MOVELWFAECD    WJHSCD           HPD Pdcr Locati
     C                     MOVELWFKAST    WJKUST           HPD Source Type
     C                     MOVELWFJ9ST    WJKVST           HPD Payment Typ
     C                     Z-ADDWUQQNB    WJQQNB           HPD Carcass Wei
     C                     Z-ADDWGBEPC    WJQRNB           HPD Distributio
     C                     MOVEL'E'       WJKXST           HPD Type of Rec
     C                     Z-ADDWUETNB    WJEPNB           HPD Farm Site
     C                     MOVELWGIQST    WJTMST           HPD Kill Shift
     C                     Z-ADDWUQTNB    WJQTNB           HPD No of Carca
     C                     MOVEL*BLANK    WJAAVN           RS User Changed
     C                     Z-ADD*ZERO     WJAADT           RS Date Changed
     C                     Z-ADD*ZERO     WJAMTM           RS Time Changed
     C                     MOVEL'A'       WJAJST           RS Record Statu
     C                     MOVEL*BLANK    WJAHVN           RS Job
     C                     MOVEL*BLANK    WJAGVN           RS Program
     C                     MOVEL*BLANK    WJABVN           RS User Added
     C                     Z-ADD*ZERO     WJABDT           RS Date Added
     C                     Z-ADD*ZERO     WJABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WJAJST           RS Record Statu
     C                     MOVEL##USR     WJABVN           RS User Added
     C                     Z-ADD##JDT     WJABDT           RS Date Added
     C                     Z-ADD##JTM     WJABTM           RS Time Added
     C                     MOVEL##PGM     WJAGVN           RS Program
     C                     MOVEL##JOB     WJAHVN           RS Job
     C           KLCRSM    KLIST
     C                     KFLD           WJQPNB           HPD Company Num
     C                     KFLD           WJCLDT           HPD Kill Date
     C                     KFLD           WJENCD           HPD Source Code
     C                     KFLD           WJEMCD           HPD Producer Co
     C                     KFLD           WJHSCD           HPD Pdcr Locati
     C                     KFLD           WJKUST           HPD Source Type
     C                     KFLD           WJKVST           HPD Payment Typ
     C                     KFLD           WJQQNB           HPD Carcass Wei
     C                     KFLD           WJQRNB           HPD Distributio
     C                     KFLD           WJKXST           HPD Type of Rec
     C                     KFLD           WJEPNB           HPD Farm Site
     C                     KFLD           WJTMST           HPD Kill Shift
      * Check for duplicate primary key
     C           KLCRSM    SETLL@C8CPQP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0475' W0RTN   7
      * Send message 'Hog Population Dist    EX'
     C                     MOVEL'PRK0475' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@C8CPQP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Dist    CH - Hog Population Dist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @C8CPQP
     C                     Z-ADDWIQPNB    WJQPNB           HPD Company Num
     C                     Z-ADDWICLDT    WJCLDT           HPD Kill Date
     C                     MOVELWIENCD    WJENCD    P      HPD Source Code
     C                     MOVELWIEMCD    WJEMCD    P      HPD Producer Co
     C                     MOVELWIHSCD    WJHSCD    P      HPD Pdcr Locati
     C                     MOVELWIKUST    WJKUST    P      HPD Source Type
     C                     MOVELWIKVST    WJKVST    P      HPD Payment Typ
     C                     Z-ADDWIQQNB    WJQQNB           HPD Carcass Wei
     C                     Z-ADDWIQRNB    WJQRNB           HPD Distributio
     C                     MOVELWIKXST    WJKXST    P      HPD Type of Rec
     C                     Z-ADDWIEPNB    WJEPNB           HPD Farm Site
     C                     MOVELWITMST    WJTMST    P      HPD Kill Shift
      *
     C           KLCHSN    KLIST
     C                     KFLD           WJQPNB           HPD Company Num
     C                     KFLD           WJCLDT           HPD Kill Date
     C                     KFLD           WJENCD           HPD Source Code
     C                     KFLD           WJEMCD           HPD Producer Co
     C                     KFLD           WJHSCD           HPD Pdcr Locati
     C                     KFLD           WJKUST           HPD Source Type
     C                     KFLD           WJKVST           HPD Payment Typ
     C                     KFLD           WJQQNB           HPD Carcass Wei
     C                     KFLD           WJQRNB           HPD Distributio
     C                     KFLD           WJKXST           HPD Type of Rec
     C                     KFLD           WJEPNB           HPD Farm Site
     C                     KFLD           WJTMST           HPD Kill Shift
     C           KLCHSN    CHAIN@C8CPQP              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC8CPL0'MDACP
     C                     MOVEL'@C8CPQP' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC81    YCRDCS
      * Move non-key fields to @C8CPQP
     C                     Z-ADDWUQTNB    WJQTNB           HPD No of Carca
     C                     MOVELWIAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWIAADT    WJAADT           RS Date Changed
     C                     Z-ADDWIAMTM    WJAMTM           RS Time Changed
     C                     MOVELWIAJST    WJAJST    P      RS Record Statu
     C                     MOVELWIAHVN    WJAHVN    P      RS Job
     C                     MOVELWIAGVN    WJAGVN    P      RS Program
     C                     MOVELWIABVN    WJABVN    P      RS User Added
     C                     Z-ADDWIABDT    WJABDT           RS Date Added
     C                     Z-ADDWIABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC81    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKC81    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@C8CPQP                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Upd Hog Pop Dist      RT - Hog Population Dist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WIQPNB           HPD Company Num
     C                     KFLD           WICLDT           HPD Kill Date
     C                     KFLD           WIENCD           HPD Source Code
     C                     KFLD           WIEMCD           HPD Producer Co
     C                     KFLD           WIHSCD           HPD Pdcr Locati
     C                     KFLD           WIKUST           HPD Source Type
     C                     KFLD           WIKVST           HPD Payment Typ
     C                     KFLD           WIQQNB           HPD Carcass Wei
     C                     KFLD           WIQRNB           HPD Distributio
     C                     KFLD           WIKXST           HPD Type of Rec
     C                     KFLD           WIEPNB           HPD Farm Site
     C                     KFLD           WITMST           HPD Kill Shift
      * Setup key
     C                     Z-ADDWGHMNB    WIQPNB           HPD Company Num
     C                     Z-ADDWGB0DT    WICLDT           HPD Kill Date
     C                     MOVELWFLKST    WIENCD           HPD Source Code
     C                     MOVELWFABCD    WIEMCD           HPD Producer Co
     C                     MOVELWFAECD    WIHSCD           HPD Pdcr Locati
     C                     MOVELWFKAST    WIKUST           HPD Source Type
     C                     MOVELWFJ9ST    WIKVST           HPD Payment Typ
     C                     Z-ADDWUQQNB    WIQQNB           HPD Carcass Wei
     C                     Z-ADDWGAUPC    WIQRNB           HPD Distributio
     C                     MOVEL'P'       WIKXST           HPD Type of Rec
     C                     Z-ADDWUETNB    WIEPNB           HPD Farm Site
     C                     MOVELWGIQST    WITMST           HPD Kill Shift
      * Establish starting position
     C           KRSSO     CHAIN@C8CPQQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0474' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUQTNB           HPD No of Carca
      * Crt Hog Ppltn Dist    CR - Hog Population Dist  * 
     C                     EXSR SPCRRC
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WIQTNB    ADD  1         WUQTNB           HPD No of Carca
      * Chg Hog Ppltn Dist    CH - Hog Population Dist  * 
     C                     EXSR SQCHRC
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * Crt Hog Ppltn Dist    CR - Hog Population Dist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @C8CPQP
     C                     Z-ADDWGHMNB    WJQPNB           HPD Company Num
     C                     Z-ADDWGB0DT    WJCLDT           HPD Kill Date
     C                     MOVELWFLKST    WJENCD           HPD Source Code
     C                     MOVELWFABCD    WJEMCD           HPD Producer Co
     C                     MOVELWFAECD    WJHSCD           HPD Pdcr Locati
     C                     MOVELWFKAST    WJKUST           HPD Source Type
     C                     MOVELWFJ9ST    WJKVST           HPD Payment Typ
     C                     Z-ADDWUQQNB    WJQQNB           HPD Carcass Wei
     C                     Z-ADDWGAUPC    WJQRNB           HPD Distributio
     C                     MOVEL'P'       WJKXST           HPD Type of Rec
     C                     Z-ADDWUETNB    WJEPNB           HPD Farm Site
     C                     MOVELWGIQST    WJTMST           HPD Kill Shift
     C                     Z-ADDWUQTNB    WJQTNB           HPD No of Carca
     C                     MOVEL*BLANK    WJAAVN           RS User Changed
     C                     Z-ADD*ZERO     WJAADT           RS Date Changed
     C                     Z-ADD*ZERO     WJAMTM           RS Time Changed
     C                     MOVEL'A'       WJAJST           RS Record Statu
     C                     MOVEL*BLANK    WJAHVN           RS Job
     C                     MOVEL*BLANK    WJAGVN           RS Program
     C                     MOVEL*BLANK    WJABVN           RS User Added
     C                     Z-ADD*ZERO     WJABDT           RS Date Added
     C                     Z-ADD*ZERO     WJABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WJAJST           RS Record Statu
     C                     MOVEL##USR     WJABVN           RS User Added
     C                     Z-ADD##JDT     WJABDT           RS Date Added
     C                     Z-ADD##JTM     WJABTM           RS Time Added
     C                     MOVEL##PGM     WJAGVN           RS Program
     C                     MOVEL##JOB     WJAHVN           RS Job
     C           KLCRSP    KLIST
     C                     KFLD           WJQPNB           HPD Company Num
     C                     KFLD           WJCLDT           HPD Kill Date
     C                     KFLD           WJENCD           HPD Source Code
     C                     KFLD           WJEMCD           HPD Producer Co
     C                     KFLD           WJHSCD           HPD Pdcr Locati
     C                     KFLD           WJKUST           HPD Source Type
     C                     KFLD           WJKVST           HPD Payment Typ
     C                     KFLD           WJQQNB           HPD Carcass Wei
     C                     KFLD           WJQRNB           HPD Distributio
     C                     KFLD           WJKXST           HPD Type of Rec
     C                     KFLD           WJEPNB           HPD Farm Site
     C                     KFLD           WJTMST           HPD Kill Shift
      * Check for duplicate primary key
     C           KLCRSP    SETLL@C8CPQP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0475' W0RTN   7
      * Send message 'Hog Population Dist    EX'
     C                     MOVEL'PRK0475' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@C8CPQP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Dist    CH - Hog Population Dist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @C8CPQP
     C                     Z-ADDWIQPNB    WJQPNB           HPD Company Num
     C                     Z-ADDWICLDT    WJCLDT           HPD Kill Date
     C                     MOVELWIENCD    WJENCD    P      HPD Source Code
     C                     MOVELWIEMCD    WJEMCD    P      HPD Producer Co
     C                     MOVELWIHSCD    WJHSCD    P      HPD Pdcr Locati
     C                     MOVELWIKUST    WJKUST    P      HPD Source Type
     C                     MOVELWIKVST    WJKVST    P      HPD Payment Typ
     C                     Z-ADDWIQQNB    WJQQNB           HPD Carcass Wei
     C                     Z-ADDWIQRNB    WJQRNB           HPD Distributio
     C                     MOVELWIKXST    WJKXST    P      HPD Type of Rec
     C                     Z-ADDWIEPNB    WJEPNB           HPD Farm Site
     C                     MOVELWITMST    WJTMST    P      HPD Kill Shift
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WJQPNB           HPD Company Num
     C                     KFLD           WJCLDT           HPD Kill Date
     C                     KFLD           WJENCD           HPD Source Code
     C                     KFLD           WJEMCD           HPD Producer Co
     C                     KFLD           WJHSCD           HPD Pdcr Locati
     C                     KFLD           WJKUST           HPD Source Type
     C                     KFLD           WJKVST           HPD Payment Typ
     C                     KFLD           WJQQNB           HPD Carcass Wei
     C                     KFLD           WJQRNB           HPD Distributio
     C                     KFLD           WJKXST           HPD Type of Rec
     C                     KFLD           WJEPNB           HPD Farm Site
     C                     KFLD           WJTMST           HPD Kill Shift
     C           KLCHSQ    CHAIN@C8CPQP              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC8CPL0'MDACP
     C                     MOVEL'@C8CPQP' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC81    YDRDCS
      * Move non-key fields to @C8CPQP
     C                     Z-ADDWUQTNB    WJQTNB           HPD No of Carca
     C                     MOVELWIAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWIAADT    WJAADT           RS Date Changed
     C                     Z-ADDWIAMTM    WJAMTM           RS Time Changed
     C                     MOVELWIAJST    WJAJST    P      RS Record Statu
     C                     MOVELWIAHVN    WJAHVN    P      RS Job
     C                     MOVELWIAGVN    WJAGVN    P      RS Program
     C                     MOVELWIABVN    WJABVN    P      RS User Added
     C                     Z-ADDWIABDT    WJABDT           RS Date Added
     C                     Z-ADDWIABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC81    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKC81    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@C8CPQP                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0001  30       BOH Company Num
     C                     PARM @CN,001   WQ0002 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0001           MTech Live Yes
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0022  30       BOH Company Num
     C                     PARM @CN,001   WQ0023 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0024 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0002           MTech Live Yes
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      *
      *================================================================
      * Chg Carc Dtl Paymnt   CH - Carcass Detail  * 
     C                     EXSR SHCHRC
      * CASE: DB1.CD Record Add/Del Sts is Delete
     C           WGINST    IFEQ 'D'                        *IF
     C                     ELSE
      * CASE: DB1.RS Record Status is Flag for Purge
     C           WGAJST    IFEQ 'D'                        *IF
     C                     ELSE
      * CASE: DB1.RS Record Status is InActive
     C           WGAJST    IFEQ 'I'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WGEWNB    MULT 1         WUQQNB    H      HPD Carcass Wei
      * Back fat record
      * Upd Hog Pop Dist      RT - Hog Population Dist  * 
     C                     EXSR SIRVGN
      * Loin Eye
      * Upd Hog Pop Dist      RT - Hog Population Dist  * 
     C                     EXSR SLRVGN
      * Lean %
      * Upd Hog Pop Dist      RT - Hog Population Dist  * 
     C                     EXSR SORVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WACHDT           PY As of Kill D
     C                     Z-ADD*ZERO     WABZPC           PLDY Lean %
     C                     Z-ADD*ZERO     WAMGNB           PLDY Head Kille
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
      * Define work field PY As of Kill Date
     C                     Z-ADD*ZERO     WUCHDT  70
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHONB           CC Company Numb
     C                     Z-ADD*ZERO     WCCHDT           PY As of Kill D
     C                     Z-ADD*ZERO     WCN4NB           PY Head Receive
     C                     Z-ADD*ZERO     WCMFNB           PY Head Killed
     C                     Z-ADD*ZERO     WCN2NB           PY Live Wgt
     C                     Z-ADD*ZERO     WCN3NB           PY Hot Wgt
     C                     Z-ADD*ZERO     WCBGVA           PY Lean Prem/De
     C                     Z-ADD*ZERO     WCBHVA           PY Sort Discoun
     C                     Z-ADD*ZERO     WCN1NB           PY Avg Live Wgt
     C                     Z-ADD*ZERO     WCDXPC           PY Actual Yield
     C                     Z-ADD*ZERO     WCDYPC           PY Avg Lean %
     C                     Z-ADD*ZERO     WCERPR           PY Lean Prem/De
     C                     Z-ADD*ZERO     WCESPR           PY Sort Discoun
     C                     Z-ADD*ZERO     WCU7NB           PY Adj Live Wei
     C                     Z-ADD*ZERO     WCU8NB           PY Adj Avg Live
     C                     Z-ADD*ZERO     WCFJPC           PY Adj Actual Y
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WEBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WEBONB           BOL Load Number
     C                     Z-ADD*ZERO     WECVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WEB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WEAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WEACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WEB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WECAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WEAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WEA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WECXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WECWNB           TH Head Receive
     C                     Z-ADD*ZERO     WEFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WEH9NB           TH Held Over
     C                     Z-ADD*ZERO     WEFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WEFENB           TH Head Killed
     C                     Z-ADD*ZERO     WEHENB           TH Head Adds
     C                     Z-ADD*ZERO     WEHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WECYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WELRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WEE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WEA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WEFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WEA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WEF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WEHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WEF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WEF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WEF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WEF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WEAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WEAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WECWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WEA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WEA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WEB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WEAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WEANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WEAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WEAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WEAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WEAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WEAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WEASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WEA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WEATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WEA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WECBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WECCPR           Th Payment Net
     C                     Z-ADD*ZERO     WELPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WECDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WEA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WEA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WEGHNB           TH Commission A
     C                     Z-ADD*ZERO     WEBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WEBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WEBTDT           TH Commission P
     C                     Z-ADD*ZERO     WEBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WEHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WEHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WEHINB           TH FFLI
     C                     Z-ADD*ZERO     WEA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WEA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WEA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WEJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WED6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WED7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WED8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WED9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WEEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WEEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WEECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WEEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WEEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WEEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WEEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WEEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WEOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WETHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WET2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WETHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WET2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WEOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WEKOER           TH Head Identif
     C                     Z-ADD*ZERO     WEOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WEOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WEIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WEOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WEHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WES9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WETAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WETBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WEJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WEKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WEKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WEKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WEKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WEOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WEIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WEIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WEIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WEKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WEOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WEKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WEORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WEOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WEMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WEMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WENCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WENCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WEIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WEKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WEEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WEEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WEECDT           TH Head LFT
     C                     Z-ADD*ZERO     WEEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WEEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field System Value Alpha    USR
     C                     MOVEL*BLANK    WUKBTX 40
      * Define work field Farm Site USR
     C                     Z-ADD*ZERO     WUETNB  50
      * Define work field MTech Live Yes or No
     C                     MOVEL*BLANK    WUFKSS  1
      * Define work field Farm site Name f/ HPS USR
     C                     MOVEL*BLANK    WUKQTX 25
      * Define work field HPS FS Comp Relation USR
     C                     MOVEL*BLANK    WUG4CD  5
      * Define work field State
     C                     MOVEL*BLANK    WUDRTX  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WGB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WGLGNB           CD Scale Sequen
     C                     Z-ADD*ZERO     WGEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WGLHNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WGBEPR           CD Sort Loss
     C                     Z-ADD*ZERO     WGASPC           CD STD Yield
     C                     Z-ADD*ZERO     WGEWNB           CD Carcass/Hot
     C                     Z-ADD*ZERO     WGB4PR           CD Base Carcass
     C                     Z-ADD*ZERO     WGEYNB           CD Crc Value Pe
     C                     Z-ADD*ZERO     WGB1PR           CD Base Carc Va
     C                     Z-ADD*ZERO     WGAVPR           CD Crc Value $
     C                     Z-ADD*ZERO     WGAUPC           CD Lean Percent
     C                     Z-ADD*ZERO     WGAWPR           CD Lean Premium
     C                     Z-ADD*ZERO     WGAXPR           CD Lean Premium
     C                     Z-ADD*ZERO     WGEZNB           CD Gross Value
     C                     Z-ADD*ZERO     WGAYPR           CD Gross Value
     C                     Z-ADD*ZERO     WGBBDT           CD Kill Date
     C                     Z-ADD*ZERO     WGAKTM           CD Kill Time
     C                     Z-ADD*ZERO     WGH6NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WGBEPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WGGCST           CD Light Reflec
     C                     Z-ADD*ZERO     WGBHPC           CD FFLI
     C                     Z-ADD*ZERO     WGLTNB           CD LOT
     C                     Z-ADD*ZERO     WGX4NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WGFNPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WGFOPC           CD Light Reflec
     C                     Z-ADD*ZERO     WGFPPC           CD Lean Percent
     C                     Z-ADD*ZERO     WGJWPR           CD CA Sort Loss
     C                     Z-ADD*ZERO     WGF5PC           CD CA Std Yield
     C                     Z-ADD*ZERO     WGJXPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WGJYPR           CD CA Crc Value
     C                     Z-ADD*ZERO     WGJZPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WGJ0PR           CD CA Crc Value
     C                     Z-ADD*ZERO     WGJ1PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WGJ2PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WGJ3PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WGJ4PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WGDKJR           CD Loin Eye Inc
     C                     Z-ADD*ZERO     WGITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WGIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WGORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WGOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WGPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WGIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WGORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WGIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WGIJRR           CD Gross Before
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field HPD Carcass Weight
     C                     Z-ADD*ZERO     WUQQNB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIQPNB           HPD Company Num
     C                     Z-ADD*ZERO     WICLDT           HPD Kill Date
     C                     Z-ADD*ZERO     WIQQNB           HPD Carcass Wei
     C                     Z-ADD*ZERO     WIQRNB           HPD Distributio
     C                     Z-ADD*ZERO     WIEPNB           HPD Farm Site
     C                     Z-ADD*ZERO     WIQTNB           HPD No of Carca
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Define work field HPD No of Carcass
     C                     Z-ADD*ZERO     WUQTNB  70
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0002  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 MTECHLIVE
00002 PKSKPFR$
