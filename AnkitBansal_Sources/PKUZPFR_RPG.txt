     H/TITLE Prt Hog Popltn Rpt    PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:57:01
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKDACPL1IF  E           K        DISK
      * RTV : Hog Population Rpt Hdr    Retrieval index
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKA1CPLAIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Kill/Tattoo Active
      *
     FPKC9CPL1IF  E           K        DISK
      * RTV : Hog Population Rpt Dtl    Retrieval index
      *
     FPKE0CPL0IF  E           K        DISK                      A
      * UPD : Hog Population Hdr OUTF   Update index
      *
     FPKEZCPL0IF  E           K        DISK                      A
      * UPD : Hog Population Dtl OUTF   Update index
      *
     FPKUZPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Hog Popltn Rpt    PF  Print file
      *
      * Long constants
     E                    @CN#    1  05  6   @CN    25
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPKE01    E DSPKE0CPL0
      * UPD : Hog Population Hdr OUTF   Update index
      *
     IQPKEZ1    E DSPKEZCPL0
      * UPD : Hog Population Dtl OUTF   Update index
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Oms Application Code
     I                                        1   6 P1C7CD
     IP2PARM      DS
      * I : MAP Report Type Usr
     I                                        1   1 P2K9ST
     IP3PARM      DS
      * FLD: Hog Population Rpt Hdr
      * I : MAP HRH Type Of Distribution
     I                                        1   1 P3K1ST
      * I : MAP HRH Company Number
     I                                    P   2   30P3QYNB
      * I : MAP HRH Source Type
     I                                        4   4 P3KZST
      * I : MAP HRH Payment Type
     I                                        5   5 P3K0ST
      * I : MAP HRH Tattoo Number
     I                                    P   6   80P3R6NB
      * I : MAP HRH From Kill Date
     I                                    P   9  120P3CMDT
      * I : MAP HRH To Kill Date
     I                                    P  13  160P3CODT
      * I : MAP HRH Farm Site
     I                                    P  17  190P3ENNB
      * I : MAP HRH Kill Shift
     I                                       20  20 P3TNST
     IP4PARM      DS
      * I :  TH Source Code-X18 USR
     I                                        1  18 P4DRT1
     IP5PARM      DS
      * I : MAP PD Producer Code
     I                                        1   6 P5ABCD
     IP6PARM      DS
      * I : MAP HRH Prdcr Location Code
     I                                        1   6 P6HTCD
     IP7PARM      DS
      * FLD: *Arrays
      * I :  Cutout Matrix Code USR
     I                                        1   6 P7C9CD
      * I :  Effective Month/Day USR
     I                                    P   7   90P7KLNB
     IP8PARM      DS
      * I : MAP Type of Popltn Rpt    USR
     I                                        1   1 P8NBST
     IP9PARM      DS
      * I :  Create Outfile USR
     I                                        1   1 P9T9ST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1C7CD    PARM           WP0001  6        Oms Application
     C           P2K9ST    PARM           WP0002  1        Report Type Usr
     C           P3K1ST    PARM           WP0003  1        HRH Type Of Dis
     C           P3QYNB    PARM           WP0004  30       HRH Company Num
     C           P3KZST    PARM           WP0005  1        HRH Source Type
     C           P3K0ST    PARM           WP0006  1        HRH Payment Typ
     C           P3R6NB    PARM           WP0007  50       HRH Tattoo Numb
     C           P3CMDT    PARM           WP0008  70       HRH From Kill D
     C           P3CODT    PARM           WP0009  70       HRH To Kill Dat
     C           P3ENNB    PARM           WP0010  50       HRH Farm Site
     C           P3TNST    PARM           WP0011  1        HRH Kill Shift
     C           P4DRT1    PARM           WP0012 18        TH Source Code-
     C           P5ABCD    PARM           WP0013  6        PD Producer Cod
     C           P6HTCD    PARM           WP0014  6        HRH Prdcr Locat
     C           P7C9CD    PARM           WP0015  6        Cutout Matrix C
     C           P7KLNB    PARM           WP0016  40       Effective Month
     C           P8NBST    PARM           WP0017  1        Type of Popltn
     C           P9T9ST    PARM           WP0018  1        Create Outfile
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Hog Popltn Rpt    PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$LENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Hog Popltn Rpt    PF: Mainline
      *================================================================
      * Establish starting position
     C           *LOVAL    SETLL@DACPQW                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        HRH Type Of Dis
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $CQYNB           HRH Company Num
     C                     MOVEL*BLANK    $CBSTX           Name USR
     C                     Z-ADD*ZERO     $CCMDT           HRH From Kill D
     C                     Z-ADD*ZERO     $CCODT           HRH To Kill Dat
     C                     MOVEL*BLANK    $CC9CD           Cutout Matrix C
     C                     MOVEL*BLANK    $CKKTX           Description 30
     C                     Z-ADD*ZERO     $CKLNB           Effective Month
     C                     MOVEL*BLANK    $CK9ST           Report Type Usr
     C                     MOVEL*BLANK    $CJJTX           Report Type Des
     C                     MOVEL*BLANK    $CK1ST           HRH Type Of Dis
     C                     MOVEL*BLANK    $CJDTX           Type of Dist De
     C                     MOVEL*BLANK    $CNBST           Type of Popltn
     C                     MOVEL*BLANK    $CKOTX           Type of Popltn
     C                     MOVEL*BLANK    $CKZST           HRH Source Type
     C                     MOVEL*BLANK    $CISTX           SR Type Desc
     C                     MOVEL*BLANK    $CSHCD           TH Source Code-
     C                     MOVEL*BLANK    $CSICD           TH Source Code-
     C                     MOVEL*BLANK    $CSJCD           TH Source Code-
     C                     MOVEL*BLANK    $CSKCD           TH Source Code-
     C                     MOVEL*BLANK    $CSLCD           TH Source Code-
     C                     MOVEL*BLANK    $CSMCD           TH Source Code-
     C                     MOVEL*BLANK    $CABCD           PD Producer Cod
     C                     MOVEL*BLANK    $CCPTX           Name Producer D
     C                     MOVEL*BLANK    $CHTCD           HRH Prdcr Locat
     C                     MOVEL*BLANK    $CA9TX           Pdctn Loc Name
     C                     MOVEL*BLANK    $CK0ST           HRH Payment Typ
     C                     MOVEL*BLANK    $CHDTX           Payment Type De
     C                     Z-ADD*ZERO     $CR6NB           HRH Tattoo Numb
     C                     MOVEL*BLANK    $CJFTX           All Text
     C                     Z-ADD*ZERO     $CENNB           HRH Farm Site
     C                     MOVEL*BLANK    $CKQTX           Farm site Name
     C                     MOVEL*BLANK    $CTNST           HRH Kill Shift
     C                     MOVEL*BLANK    $CI1TX           Condition Name
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELDAK1ST    $DK1ST           HRH Type Of Dis
     C                     MOVELDAJCTX    $DJCTX           HRH Report Brea
     C                     MOVEL*BLANK    $DJJTX           Report Type Des
     C                     Z-ADDDAR3NB    $DR3NB           HRH Head Killed
     C                     MOVEL*BLANK    $DOBTX           Text descriptio
     C                     Z-ADDDAR7NB    $DR7NB           HRH AVG Hot Wei
     C                     Z-ADDDAEONB    $DEONB           HRH Avg Live Wg
     C                     Z-ADDDAEYPC    $DEYPC           HRH Avg Lean %
     C                     Z-ADDDAR4NB    $DR4NB           HRH Avg Back Fa
     C                     Z-ADDDAEXPC    $DEXPC           HRH Avg Loin Ey
     C                     Z-ADDDAEWPC    $DEWPC           HRH Avg Light R
     C                     Z-ADDDAE0PC    $DE0PC           HRH % Adjusted
     C                     MOVEL*BLANK    $DKPTX           Text 5
     C                     MOVEL*BLANK    $DKUTX           Text 5   2
     C                     Z-ADDDAQYNB    $DQYNB           HRH Company Num
     C                     MOVELDAKZST    $DKZST           HRH Source Type
     C                     MOVELDAK0ST    $DK0ST           HRH Payment Typ
     C                     Z-ADDDAR6NB    $DR6NB           HRH Tattoo Numb
     C                     Z-ADDDACMDT    $DCMDT           HRH From Kill D
     C                     Z-ADDDACODT    $DCODT           HRH To Kill Dat
     C                     Z-ADDDAENNB    $DENNB           HRH Farm Site
     C                     MOVELDATNST    $DTNST           HRH Kill Shift
     C                     Z-ADDDARKNB    $DRKNB           HRH Carcass Hdr
     C                     Z-ADDDARLNB    $DRLNB           HRH Carcass Hdr
     C                     Z-ADDDARMNB    $DRMNB           HRH Carcass Hdr
     C                     Z-ADDDARNNB    $DRNNB           HRH Carcass Hdr
     C                     Z-ADDDARONB    $DRONB           HRH Carcass Hdr
     C                     Z-ADDDARPNB    $DRPNB           HRH Carcass Hdr
     C                     Z-ADDDARQNB    $DRQNB           HRH Carcass Hdr
     C                     Z-ADDDARRNB    $DRRNB           HRH Carcass Hdr
     C                     Z-ADDDARSNB    $DRSNB           HRH Carcass Hdr
     C                     Z-ADDDARTNB    $DRTNB           HRH Carcass Hdr
     C                     Z-ADDDARUNB    $DRUNB           HRH Carcass Hdr
     C                     Z-ADDDARVNB    $DRVNB           HRH Carcass Hdr
     C                     Z-ADDDARWNB    $DRWNB           HRH Carcass Hdr
     C                     Z-ADDDARXNB    $DRXNB           HRH Carcass Hdr
     C                     Z-ADDDARYNB    $DRYNB           HRH Carcass Hdr
     C                     Z-ADDDARZNB    $DRZNB           HRH Carcass Hdr
     C                     Z-ADDDAR0NB    $DR0NB           HRH Carcass Hdr
     C                     Z-ADDDAR1NB    $DR1NB           HRH Carcass Hdr
     C                     Z-ADDDAR2NB    $DR2NB           HRH Carcass Hdr
     C                     MOVELDAAACD    $DAACD           SR Source Code
     C                     MOVELDAABCD    $DABCD           PD Producer Cod
     C                     MOVELDAHTCD    $DHTCD           HRH Prdcr Locat
     C                     MOVELDAAAVN    $DAAVN           RS User Changed
     C                     Z-ADDDAAADT    $DAADT           RS Date Changed
     C                     Z-ADDDAAMTM    $DAMTM           RS Time Changed
     C                     MOVELDAAJST    $DAJST           RS Record Statu
     C                     MOVELDAAHVN    $DAHVN           RS Job
     C                     MOVELDAAGVN    $DAGVN           RS Program
     C                     MOVELDAABVN    $DABVN           RS User Added
     C                     Z-ADDDAABDT    $DABDT           RS Date Added
     C                     Z-ADDDAABTM    $DABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Hog Population Rpt PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Hog Pop Rpt- %     PO
     C                     EXSR UDSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Hog Pop Rpt- % Wt  PO
     C                     EXSR UESUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN DAK1ST    WZA001           HRH Type Of Dis
     C                     MOVELDAK1ST    WZA001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C                     READ @DACPQW                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        HRH Type Of Dis
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        HRH Type Of Dis
     C                     ELSE
      * Next record - Detect level breaks
     C           DAK1ST    IFNE WZA001                     HRH Type Of Dis
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
      * Mention hidden format
     C   99N99             WRITE$KFINTTL
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt Hog Population Rpt PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN C9K1ST    WQKB01           HRH Type Of Dis
     C           *LIKE     DEFN C9JCTX    WQKB02           HRH Report Brea
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           HRH Type Of Dis
     C                     KFLD           WQKB02           HRH Report Brea
      * Setup key
     C                     MOVEL$DK1ST    WQKB01           HRH Type Of Dis
     C                     MOVEL$DJCTX    WQKB02           HRH Report Brea
      * Establish starting position
     C           KRSB      SETLL@C9CPQT                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        HRH Type Of Dis
     C                     MOVEL'Y'       W0BL01  1        HRH Report Brea
     C                     MOVEL'Y'       W0BL02  1        HRD Min Carcass
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $FSVNB           Carcass Cnt Tot
     C                     Z-ADD*ZERO     $FSWNB           Percent Total
     C                     Z-ADD*ZERO     $FSCNB           Carcass Tot 1
     C                     Z-ADD*ZERO     $FSDNB           Carcass Tot 2
     C                     Z-ADD*ZERO     $FSENB           Carcass Tot 3
     C                     Z-ADD*ZERO     $FSFNB           Carcass Tot 4
     C                     Z-ADD*ZERO     $FSGNB           Carcass Tot 5
     C                     Z-ADD*ZERO     $FSHNB           Carcass Tot 6
     C                     Z-ADD*ZERO     $FSINB           Carcass Tot 7
     C                     Z-ADD*ZERO     $FSJNB           Carcass Tot 8
     C                     Z-ADD*ZERO     $FSKNB           Carcass Tot 9
     C                     Z-ADD*ZERO     $FSLNB           Carcass Tot 10
     C                     Z-ADD*ZERO     $FSMNB           Carcass Tot 11
     C                     Z-ADD*ZERO     $FSNNB           Carcass Tot 12
     C                     Z-ADD*ZERO     $FSONB           Carcass Tot 13
     C                     Z-ADD*ZERO     $FSPNB           Carcass Tot 14
     C                     Z-ADD*ZERO     $FSQNB           Carcass Tot 15
     C                     Z-ADD*ZERO     $FSRNB           Carcass Tot 16
     C                     Z-ADD*ZERO     $FSSNB           Carcass Tot 17
     C                     Z-ADD*ZERO     $FSTNB           Carcass Tot 18
     C                     Z-ADD*ZERO     $FSUNB           Carcass Tot 19
     C                     MOVELC9K1ST    $FK1ST           HRH Type Of Dis
     C                     MOVELC9JCTX    $FJCTX           HRH Report Brea
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELC9K1ST    $EK1ST           HRH Type Of Dis
     C                     MOVELC9JCTX    $EJCTX           HRH Report Brea
     C                     Z-ADDC9QUNB    $EQUNB           HRD Min Carcass
     C                     Z-ADD*ZERO     $ESANB           Min Carcass Wei
     C                     Z-ADD*ZERO     $ER8NB           Max Carcass Wei
     C                     Z-ADD*ZERO     $ESBNB           Min Live Weight
     C                     Z-ADD*ZERO     $ER9NB           Max Live Weight
     C                     Z-ADDC9RINB    $ERINB           HRD Dist Carcas
     C                     Z-ADD*ZERO     $ES2NB           Percent Total D
     C                     Z-ADDC9QVNB    $EQVNB           HRD Max Carcass
     C                     Z-ADDC9QWNB    $EQWNB           HRD Min Live We
     C                     Z-ADDC9QXNB    $EQXNB           HRD Max Live We
     C                     Z-ADDC9QZNB    $EQZNB           HRD Dist Carcas
     C                     Z-ADDC9Q0NB    $EQ0NB           HRD Dist Carcas
     C                     Z-ADDC9Q1NB    $EQ1NB           HRD Dist Carcas
     C                     Z-ADDC9Q2NB    $EQ2NB           HRD Dist Carcas
     C                     Z-ADDC9Q3NB    $EQ3NB           HRD Dist Carcas
     C                     Z-ADDC9Q4NB    $EQ4NB           HRD Dist Carcas
     C                     Z-ADDC9Q5NB    $EQ5NB           HRD Dist Carcas
     C                     Z-ADDC9Q6NB    $EQ6NB           HRD Dist Carcas
     C                     Z-ADDC9Q7NB    $EQ7NB           HRD Dist Carcas
     C                     Z-ADDC9Q8NB    $EQ8NB           HRD Dist Carcas
     C                     Z-ADDC9Q9NB    $EQ9NB           HRD Dist Carcas
     C                     Z-ADDC9RANB    $ERANB           HRD Dist Carcas
     C                     Z-ADDC9RBNB    $ERBNB           HRD Dist Carcas
     C                     Z-ADDC9RCNB    $ERCNB           HRD Dist Carcas
     C                     Z-ADDC9RDNB    $ERDNB           HRD Dist Carcas
     C                     Z-ADDC9RENB    $ERENB           HRD Dist Carcas
     C                     Z-ADDC9RFNB    $ERFNB           HRD Dist Carcas
     C                     Z-ADDC9RGNB    $ERGNB           HRD Dist Carcas
     C                     Z-ADDC9RHNB    $ERHNB           HRD Dist Carcas
     C                     Z-ADDC9RJNB    $ERJNB           HRD Percent Tot
     C                     Z-ADDC9LMPR    $ELMPR           HRD Dist Hot Wt
     C                     Z-ADDC9LNPR    $ELNPR           HRD Dist Hot Wt
     C                     Z-ADDC9LOPR    $ELOPR           HRD Dist Hot Wt
     C                     Z-ADDC9LPPR    $ELPPR           HRD Dist Hot Wt
     C                     Z-ADDC9LQPR    $ELQPR           HRD Dist Hot Wt
     C                     Z-ADDC9LRPR    $ELRPR           HRD Dist Hot Wt
     C                     Z-ADDC9LSPR    $ELSPR           HRD Dist Hot Wt
     C                     Z-ADDC9LTPR    $ELTPR           HRD Dist Hot Wt
     C                     Z-ADDC9LUPR    $ELUPR           HRD Dist Hot Wt
     C                     Z-ADDC9L0PR    $EL0PR           HRD Dist Hot Wt
     C                     Z-ADDC9LVPR    $ELVPR           HRD Dist Hot Wt
     C                     Z-ADDC9LWPR    $ELWPR           HRD Dist Hot Wt
     C                     Z-ADDC9LXPR    $ELXPR           HRD Dist Hot Wt
     C                     Z-ADDC9LYPR    $ELYPR           HRD Dist Hot Wt
     C                     Z-ADDC9LZPR    $ELZPR           HRD Dist Hot Wt
     C                     Z-ADDC9L1PR    $EL1PR           HRD Dist Hot Wt
     C                     Z-ADDC9L2PR    $EL2PR           HRD Dist Hot Wt
     C                     Z-ADDC9L3PR    $EL3PR           HRD Dist Hot Wt
     C                     Z-ADDC9L4PR    $EL4PR           HRD Dist Hot Wt
     C                     Z-ADDC9L5PR    $EL5PR           HRD Dist Hot Wt
     C                     MOVELC9AAVN    $EAAVN           RS User Changed
     C                     Z-ADDC9AADT    $EAADT           RS Date Changed
     C                     Z-ADDC9AMTM    $EAMTM           RS Time Changed
     C                     MOVELC9AJST    $EAJST           RS Record Statu
     C                     MOVELC9AHVN    $EAHVN           RS Job
     C                     MOVELC9AGVN    $EAGVN           RS Program
     C                     MOVELC9ABVN    $EABVN           RS User Added
     C                     Z-ADDC9ABDT    $EABDT           RS Date Added
     C                     Z-ADDC9ABTM    $EABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * CASE: PAR.Create Outfile USR is Yes
     C           P9T9ST    IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Tattoo Number is NE Zero
     C           $DR6NB    IFNE *ZERO                      *IF
      * Crt Hog Pop Dtl OUTF  CR - Hog Population Dtl OUTF  * 
     C                     EXSR SGCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  $EQZNB    $FSCNB           Carcass Tot 1
     C                     ADD  $EQ0NB    $FSDNB           Carcass Tot 2
     C                     ADD  $EQ1NB    $FSENB           Carcass Tot 3
     C                     ADD  $EQ2NB    $FSFNB           Carcass Tot 4
     C                     ADD  $EQ3NB    $FSGNB           Carcass Tot 5
     C                     ADD  $EQ4NB    $FSHNB           Carcass Tot 6
     C                     ADD  $EQ5NB    $FSINB           Carcass Tot 7
     C                     ADD  $EQ6NB    $FSJNB           Carcass Tot 8
     C                     ADD  $EQ7NB    $FSKNB           Carcass Tot 9
     C                     ADD  $EQ8NB    $FSLNB           Carcass Tot 10
     C                     ADD  $EQ9NB    $FSMNB           Carcass Tot 11
     C                     ADD  $ERANB    $FSNNB           Carcass Tot 12
     C                     ADD  $ERBNB    $FSONB           Carcass Tot 13
     C                     ADD  $ERCNB    $FSPNB           Carcass Tot 14
     C                     ADD  $ERDNB    $FSQNB           Carcass Tot 15
     C                     ADD  $ERENB    $FSRNB           Carcass Tot 16
     C                     ADD  $ERFNB    $FSSNB           Carcass Tot 17
     C                     ADD  $ERGNB    $FSTNB           Carcass Tot 18
     C                     ADD  $ERHNB    $FSUNB           Carcass Tot 19
     C                     ADD  $ERINB    $FSVNB           Carcass Cnt Tot
     C                     ADD  $ES2NB    $FSWNB           Percent Total
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN C9K1ST    WZB001           HRH Type Of Dis
     C                     MOVELC9K1ST    WZB001
     C           *LIKE     DEFN C9JCTX    WZB002           HRH Report Brea
     C                     MOVELC9JCTX    WZB002
     C           *LIKE     DEFN C9QUNB    WZB003           HRD Min Carcass
     C                     Z-ADDC9QUNB    WZB003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@C9CPQT                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        HRH Type Of Dis
     C                     MOVEL*BLANK    W0BL01  1        HRH Report Brea
     C                     MOVEL*BLANK    W0BL02  1        HRD Min Carcass
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        HRH Type Of Dis
     C                     MOVEL'Y'       W0BL01  1        HRH Report Brea
     C                     MOVEL'Y'       W0BL02  1        HRD Min Carcass
     C                     ELSE
      * Next record - Detect level breaks
     C           C9K1ST    IFNE WZB001                     HRH Type Of Dis
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           C9JCTX    IFNE WZB002                     HRH Report Brea
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           C9QUNB    IFNE WZB003                     HRD Min Carcass
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$FKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt Hog Pop Rpt- %     PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN C9K1ST    WQKC01           HRH Type Of Dis
     C           *LIKE     DEFN C9JCTX    WQKC02           HRH Report Brea
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           HRH Type Of Dis
     C                     KFLD           WQKC02           HRH Report Brea
      * Setup key
     C                     MOVEL$DK1ST    WQKC01           HRH Type Of Dis
     C                     MOVEL$DJCTX    WQKC02           HRH Report Brea
      * Establish starting position
     C           KRSC      SETLL@C9CPQT                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        HRH Type Of Dis
     C                     MOVEL'Y'       W0CL01  1        HRH Report Brea
     C                     MOVEL'Y'       W0CL02  1        HRD Min Carcass
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $HZXNB           Percent Tot Dtl
     C                     Z-ADD*ZERO     $HZCNB           Percent of hd k
     C                     Z-ADD*ZERO     $HZDNB           Percent of hd k
     C                     Z-ADD*ZERO     $HZENB           Percent of hd k
     C                     Z-ADD*ZERO     $HZFNB           Percent of hd k
     C                     Z-ADD*ZERO     $HZGNB           Percent of hd k
     C                     Z-ADD*ZERO     $HZHNB           Percent of hd k
     C                     Z-ADD*ZERO     $HZINB           Percent of hd k
     C                     Z-ADD*ZERO     $HZJNB           Percent of hd k
     C                     Z-ADD*ZERO     $HZKNB           Percent of hd k
     C                     Z-ADD*ZERO     $HZLNB           Percent of hd k
     C                     Z-ADD*ZERO     $HZMNB           Percent of hd k
     C                     Z-ADD*ZERO     $HZNNB           Percent of hd k
     C                     Z-ADD*ZERO     $HZONB           Percent of hd k
     C                     Z-ADD*ZERO     $HZPNB           Percent of hd k
     C                     Z-ADD*ZERO     $HZQNB           Percent of hd k
     C                     Z-ADD*ZERO     $HZRNB           Percent of hd k
     C                     Z-ADD*ZERO     $HZSNB           Percent of hd k
     C                     Z-ADD*ZERO     $HZTNB           Percent of hd k
     C                     Z-ADD*ZERO     $HZUNB           Percent of hd k
     C                     Z-ADD*ZERO     $HSCNB           Carcass Tot 1
     C                     Z-ADD*ZERO     $HSDNB           Carcass Tot 2
     C                     Z-ADD*ZERO     $HSENB           Carcass Tot 3
     C                     Z-ADD*ZERO     $HSFNB           Carcass Tot 4
     C                     Z-ADD*ZERO     $HSGNB           Carcass Tot 5
     C                     Z-ADD*ZERO     $HSHNB           Carcass Tot 6
     C                     Z-ADD*ZERO     $HSINB           Carcass Tot 7
     C                     Z-ADD*ZERO     $HSJNB           Carcass Tot 8
     C                     Z-ADD*ZERO     $HSKNB           Carcass Tot 9
     C                     Z-ADD*ZERO     $HSLNB           Carcass Tot 10
     C                     Z-ADD*ZERO     $HSMNB           Carcass Tot 11
     C                     Z-ADD*ZERO     $HSNNB           Carcass Tot 12
     C                     Z-ADD*ZERO     $HSONB           Carcass Tot 13
     C                     Z-ADD*ZERO     $HSPNB           Carcass Tot 14
     C                     Z-ADD*ZERO     $HSQNB           Carcass Tot 15
     C                     Z-ADD*ZERO     $HSRNB           Carcass Tot 16
     C                     Z-ADD*ZERO     $HSSNB           Carcass Tot 17
     C                     Z-ADD*ZERO     $HSTNB           Carcass Tot 18
     C                     Z-ADD*ZERO     $HSUNB           Carcass Tot 19
     C                     Z-ADD*ZERO     $HSVNB           Carcass Cnt Tot
     C                     Z-ADD*ZERO     $HSWNB           Percent Total
     C                     MOVELC9K1ST    $HK1ST           HRH Type Of Dis
     C                     MOVELC9JCTX    $HJCTX           HRH Report Brea
     C                     Z-ADDC9RJNB    $HRJNB           HRD Percent Tot
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELC9K1ST    $GK1ST           HRH Type Of Dis
     C                     MOVELC9JCTX    $GJCTX           HRH Report Brea
     C                     Z-ADDC9QUNB    $GQUNB           HRD Min Carcass
     C                     Z-ADD*ZERO     $GSANB           Min Carcass Wei
     C                     Z-ADD*ZERO     $GR8NB           Max Carcass Wei
     C                     Z-ADD*ZERO     $GSBNB           Min Live Weight
     C                     Z-ADD*ZERO     $GR9NB           Max Live Weight
     C                     Z-ADD*ZERO     $GZVNB           Percent Tot Dtl
     C                     Z-ADD*ZERO     $GZCNB           Percent of hd k
     C                     Z-ADD*ZERO     $GZDNB           Percent of hd k
     C                     Z-ADD*ZERO     $GZENB           Percent of hd k
     C                     Z-ADD*ZERO     $GZFNB           Percent of hd k
     C                     Z-ADD*ZERO     $GZGNB           Percent of hd k
     C                     Z-ADD*ZERO     $GZHNB           Percent of hd k
     C                     Z-ADD*ZERO     $GZINB           Percent of hd k
     C                     Z-ADD*ZERO     $GZJNB           Percent of hd k
     C                     Z-ADD*ZERO     $GZKNB           Percent of hd k
     C                     Z-ADD*ZERO     $GZLNB           Percent of hd k
     C                     Z-ADD*ZERO     $GZMNB           Percent of hd k
     C                     Z-ADD*ZERO     $GZNNB           Percent of hd k
     C                     Z-ADD*ZERO     $GZONB           Percent of hd k
     C                     Z-ADD*ZERO     $GZPNB           Percent of hd k
     C                     Z-ADD*ZERO     $GZQNB           Percent of hd k
     C                     Z-ADD*ZERO     $GZRNB           Percent of hd k
     C                     Z-ADD*ZERO     $GZSNB           Percent of hd k
     C                     Z-ADD*ZERO     $GZTNB           Percent of hd k
     C                     Z-ADD*ZERO     $GZUNB           Percent of hd k
     C                     Z-ADDC9QVNB    $GQVNB           HRD Max Carcass
     C                     Z-ADDC9QWNB    $GQWNB           HRD Min Live We
     C                     Z-ADDC9QXNB    $GQXNB           HRD Max Live We
     C                     Z-ADDC9QZNB    $GQZNB           HRD Dist Carcas
     C                     Z-ADDC9Q0NB    $GQ0NB           HRD Dist Carcas
     C                     Z-ADDC9Q1NB    $GQ1NB           HRD Dist Carcas
     C                     Z-ADDC9Q2NB    $GQ2NB           HRD Dist Carcas
     C                     Z-ADDC9Q3NB    $GQ3NB           HRD Dist Carcas
     C                     Z-ADDC9Q4NB    $GQ4NB           HRD Dist Carcas
     C                     Z-ADDC9Q5NB    $GQ5NB           HRD Dist Carcas
     C                     Z-ADDC9Q6NB    $GQ6NB           HRD Dist Carcas
     C                     Z-ADDC9Q7NB    $GQ7NB           HRD Dist Carcas
     C                     Z-ADDC9Q8NB    $GQ8NB           HRD Dist Carcas
     C                     Z-ADDC9Q9NB    $GQ9NB           HRD Dist Carcas
     C                     Z-ADDC9RANB    $GRANB           HRD Dist Carcas
     C                     Z-ADDC9RBNB    $GRBNB           HRD Dist Carcas
     C                     Z-ADDC9RCNB    $GRCNB           HRD Dist Carcas
     C                     Z-ADDC9RDNB    $GRDNB           HRD Dist Carcas
     C                     Z-ADDC9RENB    $GRENB           HRD Dist Carcas
     C                     Z-ADDC9RFNB    $GRFNB           HRD Dist Carcas
     C                     Z-ADDC9RGNB    $GRGNB           HRD Dist Carcas
     C                     Z-ADDC9RHNB    $GRHNB           HRD Dist Carcas
     C                     Z-ADDC9RINB    $GRINB           HRD Dist Carcas
     C                     Z-ADDC9RJNB    $GRJNB           HRD Percent Tot
     C                     Z-ADDC9LMPR    $GLMPR           HRD Dist Hot Wt
     C                     Z-ADDC9LNPR    $GLNPR           HRD Dist Hot Wt
     C                     Z-ADDC9LOPR    $GLOPR           HRD Dist Hot Wt
     C                     Z-ADDC9LPPR    $GLPPR           HRD Dist Hot Wt
     C                     Z-ADDC9LQPR    $GLQPR           HRD Dist Hot Wt
     C                     Z-ADDC9LRPR    $GLRPR           HRD Dist Hot Wt
     C                     Z-ADDC9LSPR    $GLSPR           HRD Dist Hot Wt
     C                     Z-ADDC9LTPR    $GLTPR           HRD Dist Hot Wt
     C                     Z-ADDC9LUPR    $GLUPR           HRD Dist Hot Wt
     C                     Z-ADDC9L0PR    $GL0PR           HRD Dist Hot Wt
     C                     Z-ADDC9LVPR    $GLVPR           HRD Dist Hot Wt
     C                     Z-ADDC9LWPR    $GLWPR           HRD Dist Hot Wt
     C                     Z-ADDC9LXPR    $GLXPR           HRD Dist Hot Wt
     C                     Z-ADDC9LYPR    $GLYPR           HRD Dist Hot Wt
     C                     Z-ADDC9LZPR    $GLZPR           HRD Dist Hot Wt
     C                     Z-ADDC9L1PR    $GL1PR           HRD Dist Hot Wt
     C                     Z-ADDC9L2PR    $GL2PR           HRD Dist Hot Wt
     C                     Z-ADDC9L3PR    $GL3PR           HRD Dist Hot Wt
     C                     Z-ADDC9L4PR    $GL4PR           HRD Dist Hot Wt
     C                     Z-ADDC9L5PR    $GL5PR           HRD Dist Hot Wt
     C                     MOVELC9AAVN    $GAAVN           RS User Changed
     C                     Z-ADDC9AADT    $GAADT           RS Date Changed
     C                     Z-ADDC9AMTM    $GAMTM           RS Time Changed
     C                     MOVELC9AJST    $GAJST           RS Record Statu
     C                     MOVELC9AHVN    $GAHVN           RS Job
     C                     MOVELC9AGVN    $GAGVN           RS Program
     C                     MOVELC9ABVN    $GABVN           RS User Added
     C                     Z-ADDC9ABDT    $GABDT           RS Date Added
     C                     Z-ADDC9ABTM    $GABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     ADD  $GQZNB    $HSCNB           Carcass Tot 1
     C                     ADD  $GQ0NB    $HSDNB           Carcass Tot 2
     C                     ADD  $GQ1NB    $HSENB           Carcass Tot 3
     C                     ADD  $GQ2NB    $HSFNB           Carcass Tot 4
     C                     ADD  $GQ3NB    $HSGNB           Carcass Tot 5
     C                     ADD  $GQ4NB    $HSHNB           Carcass Tot 6
     C                     ADD  $GQ5NB    $HSINB           Carcass Tot 7
     C                     ADD  $GQ6NB    $HSJNB           Carcass Tot 8
     C                     ADD  $GQ7NB    $HSKNB           Carcass Tot 9
     C                     ADD  $GQ8NB    $HSLNB           Carcass Tot 10
     C                     ADD  $GQ9NB    $HSMNB           Carcass Tot 11
     C                     ADD  $GRANB    $HSNNB           Carcass Tot 12
     C                     ADD  $GRBNB    $HSONB           Carcass Tot 13
     C                     ADD  $GRCNB    $HSPNB           Carcass Tot 14
     C                     ADD  $GRDNB    $HSQNB           Carcass Tot 15
     C                     ADD  $GRENB    $HSRNB           Carcass Tot 16
     C                     ADD  $GRFNB    $HSSNB           Carcass Tot 17
     C                     ADD  $GRGNB    $HSTNB           Carcass Tot 18
     C                     ADD  $GRHNB    $HSUNB           Carcass Tot 19
     C                     ADD  $GRINB    $HSVNB           Carcass Cnt Tot
     C                     ADD  $GZVNB    $HZXNB           Percent Tot Dtl
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN C9K1ST    WZC001           HRH Type Of Dis
     C                     MOVELC9K1ST    WZC001
     C           *LIKE     DEFN C9JCTX    WZC002           HRH Report Brea
     C                     MOVELC9JCTX    WZC002
     C           *LIKE     DEFN C9QUNB    WZC003           HRD Min Carcass
     C                     Z-ADDC9QUNB    WZC003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@C9CPQT                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        HRH Type Of Dis
     C                     MOVEL*BLANK    W0CL01  1        HRH Report Brea
     C                     MOVEL*BLANK    W0CL02  1        HRD Min Carcass
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        HRH Type Of Dis
     C                     MOVEL'Y'       W0CL01  1        HRH Report Brea
     C                     MOVEL'Y'       W0CL02  1        HRD Min Carcass
     C                     ELSE
      * Next record - Detect level breaks
     C           C9K1ST    IFNE WZC001                     HRH Type Of Dis
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           C9JCTX    IFNE WZC002                     HRH Report Brea
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           C9QUNB    IFNE WZC003                     HRD Min Carcass
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of HRH Report Break format
      * Calculate Percent of Head Killed for each column.
      * CASE: WRK.HRH Head Killed is Not 0
     C           WUR3NB    IFNE *ZERO                      *IF
     C           $HSCNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZCNB    H      Percent of hd k
     C           $HSDNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZDNB    H      Percent of hd k
     C           $HSENB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZENB    H      Percent of hd k
     C           $HSFNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZFNB    H      Percent of hd k
     C           $HSGNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZGNB    H      Percent of hd k
     C           $HSHNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZHNB    H      Percent of hd k
     C           $HSINB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZINB    H      Percent of hd k
     C           $HSJNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZJNB    H      Percent of hd k
     C           $HSKNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZKNB    H      Percent of hd k
     C           $HSLNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZLNB    H      Percent of hd k
     C           $HSMNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZMNB    H      Percent of hd k
     C           $HSNNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZNNB    H      Percent of hd k
     C           $HSONB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZONB    H      Percent of hd k
     C           $HSPNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZPNB    H      Percent of hd k
     C           $HSQNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZQNB    H      Percent of hd k
     C           $HSRNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZRNB    H      Percent of hd k
     C           $HSSNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZSNB    H      Percent of hd k
     C           $HSTNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZTNB    H      Percent of hd k
     C           $HSUNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $HZUNB    H      Percent of hd k
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$HKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * Prt Hog Pop Rpt- % Wt  PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN C9K1ST    WQKD01           HRH Type Of Dis
     C           *LIKE     DEFN C9JCTX    WQKD02           HRH Report Brea
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           HRH Type Of Dis
     C                     KFLD           WQKD02           HRH Report Brea
      * Setup key
     C                     MOVEL$DK1ST    WQKD01           HRH Type Of Dis
     C                     MOVEL$DJCTX    WQKD02           HRH Report Brea
      * Establish starting position
     C           KRSD      SETLL@C9CPQT                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        HRH Type Of Dis
     C                     MOVEL'Y'       W0DL01  1        HRH Report Brea
     C                     MOVEL'Y'       W0DL02  1        HRD Min Carcass
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDC9RJNB    $JRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     $JR3NB           HRH Head Killed
     C                     Z-ADD*ZERO     $JZCNB           Percent of hd k
     C                     Z-ADD*ZERO     $JZDNB           Percent of hd k
     C                     Z-ADD*ZERO     $JZENB           Percent of hd k
     C                     Z-ADD*ZERO     $JZFNB           Percent of hd k
     C                     Z-ADD*ZERO     $JZGNB           Percent of hd k
     C                     Z-ADD*ZERO     $JZHNB           Percent of hd k
     C                     Z-ADD*ZERO     $JZINB           Percent of hd k
     C                     Z-ADD*ZERO     $JZJNB           Percent of hd k
     C                     Z-ADD*ZERO     $JZKNB           Percent of hd k
     C                     Z-ADD*ZERO     $JZLNB           Percent of hd k
     C                     Z-ADD*ZERO     $JZMNB           Percent of hd k
     C                     Z-ADD*ZERO     $JZNNB           Percent of hd k
     C                     Z-ADD*ZERO     $JZONB           Percent of hd k
     C                     Z-ADD*ZERO     $JZPNB           Percent of hd k
     C                     Z-ADD*ZERO     $JZQNB           Percent of hd k
     C                     Z-ADD*ZERO     $JZRNB           Percent of hd k
     C                     Z-ADD*ZERO     $JZSNB           Percent of hd k
     C                     Z-ADD*ZERO     $JZTNB           Percent of hd k
     C                     Z-ADD*ZERO     $JZUNB           Percent of hd k
     C                     Z-ADD*ZERO     $JZXNB           Percent Tot Dtl
     C                     Z-ADD*ZERO     $JSCNB           Carcass Tot 1
     C                     Z-ADD*ZERO     $JSDNB           Carcass Tot 2
     C                     Z-ADD*ZERO     $JSENB           Carcass Tot 3
     C                     Z-ADD*ZERO     $JSFNB           Carcass Tot 4
     C                     Z-ADD*ZERO     $JSGNB           Carcass Tot 5
     C                     Z-ADD*ZERO     $JSHNB           Carcass Tot 6
     C                     Z-ADD*ZERO     $JSINB           Carcass Tot 7
     C                     Z-ADD*ZERO     $JSJNB           Carcass Tot 8
     C                     Z-ADD*ZERO     $JSKNB           Carcass Tot 9
     C                     Z-ADD*ZERO     $JSLNB           Carcass Tot 10
     C                     Z-ADD*ZERO     $JSMNB           Carcass Tot 11
     C                     Z-ADD*ZERO     $JSNNB           Carcass Tot 12
     C                     Z-ADD*ZERO     $JSONB           Carcass Tot 13
     C                     Z-ADD*ZERO     $JSPNB           Carcass Tot 14
     C                     Z-ADD*ZERO     $JSQNB           Carcass Tot 15
     C                     Z-ADD*ZERO     $JSRNB           Carcass Tot 16
     C                     Z-ADD*ZERO     $JSSNB           Carcass Tot 17
     C                     Z-ADD*ZERO     $JSTNB           Carcass Tot 18
     C                     Z-ADD*ZERO     $JSUNB           Carcass Tot 19
     C                     Z-ADD*ZERO     $JSVNB           Carcass Cnt Tot
     C                     Z-ADD*ZERO     $JSWNB           Percent Total
     C                     MOVELC9K1ST    $JK1ST           HRH Type Of Dis
     C                     MOVELC9JCTX    $JJCTX           HRH Report Brea
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP02  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELC9K1ST    $IK1ST           HRH Type Of Dis
     C                     MOVELC9JCTX    $IJCTX           HRH Report Brea
     C                     Z-ADDC9QUNB    $IQUNB           HRD Min Carcass
     C                     Z-ADD*ZERO     $ISANB           Min Carcass Wei
     C                     Z-ADD*ZERO     $IR8NB           Max Carcass Wei
     C                     Z-ADD*ZERO     $ISBNB           Min Live Weight
     C                     Z-ADD*ZERO     $IR9NB           Max Live Weight
     C                     Z-ADDC9RINB    $IRINB           HRD Dist Carcas
     C                     Z-ADD*ZERO     $IZCNB           Percent of hd k
     C                     Z-ADD*ZERO     $IZDNB           Percent of hd k
     C                     Z-ADD*ZERO     $IZENB           Percent of hd k
     C                     Z-ADD*ZERO     $IZFNB           Percent of hd k
     C                     Z-ADD*ZERO     $IZGNB           Percent of hd k
     C                     Z-ADD*ZERO     $IZHNB           Percent of hd k
     C                     Z-ADD*ZERO     $IZINB           Percent of hd k
     C                     Z-ADD*ZERO     $IZJNB           Percent of hd k
     C                     Z-ADD*ZERO     $IZKNB           Percent of hd k
     C                     Z-ADD*ZERO     $IZLNB           Percent of hd k
     C                     Z-ADD*ZERO     $IZMNB           Percent of hd k
     C                     Z-ADD*ZERO     $IZNNB           Percent of hd k
     C                     Z-ADD*ZERO     $IZONB           Percent of hd k
     C                     Z-ADD*ZERO     $IZPNB           Percent of hd k
     C                     Z-ADD*ZERO     $IZQNB           Percent of hd k
     C                     Z-ADD*ZERO     $IZRNB           Percent of hd k
     C                     Z-ADD*ZERO     $IZSNB           Percent of hd k
     C                     Z-ADD*ZERO     $IZTNB           Percent of hd k
     C                     Z-ADD*ZERO     $IZUNB           Percent of hd k
     C                     Z-ADDC9QVNB    $IQVNB           HRD Max Carcass
     C                     Z-ADDC9QWNB    $IQWNB           HRD Min Live We
     C                     Z-ADDC9QXNB    $IQXNB           HRD Max Live We
     C                     Z-ADDC9QZNB    $IQZNB           HRD Dist Carcas
     C                     Z-ADDC9Q0NB    $IQ0NB           HRD Dist Carcas
     C                     Z-ADDC9Q1NB    $IQ1NB           HRD Dist Carcas
     C                     Z-ADDC9Q2NB    $IQ2NB           HRD Dist Carcas
     C                     Z-ADDC9Q3NB    $IQ3NB           HRD Dist Carcas
     C                     Z-ADDC9Q4NB    $IQ4NB           HRD Dist Carcas
     C                     Z-ADDC9Q5NB    $IQ5NB           HRD Dist Carcas
     C                     Z-ADDC9Q6NB    $IQ6NB           HRD Dist Carcas
     C                     Z-ADDC9Q7NB    $IQ7NB           HRD Dist Carcas
     C                     Z-ADDC9Q8NB    $IQ8NB           HRD Dist Carcas
     C                     Z-ADDC9Q9NB    $IQ9NB           HRD Dist Carcas
     C                     Z-ADDC9RANB    $IRANB           HRD Dist Carcas
     C                     Z-ADDC9RBNB    $IRBNB           HRD Dist Carcas
     C                     Z-ADDC9RCNB    $IRCNB           HRD Dist Carcas
     C                     Z-ADDC9RDNB    $IRDNB           HRD Dist Carcas
     C                     Z-ADDC9RENB    $IRENB           HRD Dist Carcas
     C                     Z-ADDC9RFNB    $IRFNB           HRD Dist Carcas
     C                     Z-ADDC9RGNB    $IRGNB           HRD Dist Carcas
     C                     Z-ADDC9RHNB    $IRHNB           HRD Dist Carcas
     C                     Z-ADDC9RJNB    $IRJNB           HRD Percent Tot
     C                     Z-ADDC9LMPR    $ILMPR           HRD Dist Hot Wt
     C                     Z-ADDC9LNPR    $ILNPR           HRD Dist Hot Wt
     C                     Z-ADDC9LOPR    $ILOPR           HRD Dist Hot Wt
     C                     Z-ADDC9LPPR    $ILPPR           HRD Dist Hot Wt
     C                     Z-ADDC9LQPR    $ILQPR           HRD Dist Hot Wt
     C                     Z-ADDC9LRPR    $ILRPR           HRD Dist Hot Wt
     C                     Z-ADDC9LSPR    $ILSPR           HRD Dist Hot Wt
     C                     Z-ADDC9LTPR    $ILTPR           HRD Dist Hot Wt
     C                     Z-ADDC9LUPR    $ILUPR           HRD Dist Hot Wt
     C                     Z-ADDC9L0PR    $IL0PR           HRD Dist Hot Wt
     C                     Z-ADDC9LVPR    $ILVPR           HRD Dist Hot Wt
     C                     Z-ADDC9LWPR    $ILWPR           HRD Dist Hot Wt
     C                     Z-ADDC9LXPR    $ILXPR           HRD Dist Hot Wt
     C                     Z-ADDC9LYPR    $ILYPR           HRD Dist Hot Wt
     C                     Z-ADDC9LZPR    $ILZPR           HRD Dist Hot Wt
     C                     Z-ADDC9L1PR    $IL1PR           HRD Dist Hot Wt
     C                     Z-ADDC9L2PR    $IL2PR           HRD Dist Hot Wt
     C                     Z-ADDC9L3PR    $IL3PR           HRD Dist Hot Wt
     C                     Z-ADDC9L4PR    $IL4PR           HRD Dist Hot Wt
     C                     Z-ADDC9L5PR    $IL5PR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     $IZVNB           Percent Tot Dtl
     C                     MOVELC9AAVN    $IAAVN           RS User Changed
     C                     Z-ADDC9AADT    $IAADT           RS Date Changed
     C                     Z-ADDC9AMTM    $IAMTM           RS Time Changed
     C                     MOVELC9AJST    $IAJST           RS Record Statu
     C                     MOVELC9AHVN    $IAHVN           RS Job
     C                     MOVELC9AGVN    $IAGVN           RS Program
     C                     MOVELC9ABVN    $IABVN           RS User Added
     C                     Z-ADDC9ABDT    $IABDT           RS Date Added
     C                     Z-ADDC9ABTM    $IABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     ADD  $IQZNB    $JSCNB           Carcass Tot 1
     C                     ADD  $IQ0NB    $JSDNB           Carcass Tot 2
     C                     ADD  $IQ1NB    $JSENB           Carcass Tot 3
     C                     ADD  $IQ2NB    $JSFNB           Carcass Tot 4
     C                     ADD  $IQ3NB    $JSGNB           Carcass Tot 5
     C                     ADD  $IQ4NB    $JSHNB           Carcass Tot 6
     C                     ADD  $IQ5NB    $JSINB           Carcass Tot 7
     C                     ADD  $IQ6NB    $JSJNB           Carcass Tot 8
     C                     ADD  $IQ7NB    $JSKNB           Carcass Tot 9
     C                     ADD  $IQ8NB    $JSLNB           Carcass Tot 10
     C                     ADD  $IQ9NB    $JSMNB           Carcass Tot 11
     C                     ADD  $IRANB    $JSNNB           Carcass Tot 12
     C                     ADD  $IRBNB    $JSONB           Carcass Tot 13
     C                     ADD  $IRCNB    $JSPNB           Carcass Tot 14
     C                     ADD  $IRDNB    $JSQNB           Carcass Tot 15
     C                     ADD  $IRENB    $JSRNB           Carcass Tot 16
     C                     ADD  $IRFNB    $JSSNB           Carcass Tot 17
     C                     ADD  $IRGNB    $JSTNB           Carcass Tot 18
     C                     ADD  $IRHNB    $JSUNB           Carcass Tot 19
     C                     ADD  $IRINB    $JSVNB           Carcass Cnt Tot
     C                     ADD  $IZVNB    $JZXNB           Percent Tot Dtl
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN C9K1ST    WZD001           HRH Type Of Dis
     C                     MOVELC9K1ST    WZD001
     C           *LIKE     DEFN C9JCTX    WZD002           HRH Report Brea
     C                     MOVELC9JCTX    WZD002
     C           *LIKE     DEFN C9QUNB    WZD003           HRD Min Carcass
     C                     Z-ADDC9QUNB    WZD003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@C9CPQT                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        HRH Type Of Dis
     C                     MOVEL*BLANK    W0DL01  1        HRH Report Brea
     C                     MOVEL*BLANK    W0DL02  1        HRD Min Carcass
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        HRH Type Of Dis
     C                     MOVEL'Y'       W0DL01  1        HRH Report Brea
     C                     MOVEL'Y'       W0DL02  1        HRD Min Carcass
     C                     ELSE
      * Next record - Detect level breaks
     C           C9K1ST    IFNE WZD001                     HRH Type Of Dis
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           C9JCTX    IFNE WZD002                     HRH Report Brea
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C           C9QUNB    IFNE WZD003                     HRD Min Carcass
     C           W0DL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL02
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP02
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of HRH Report Break format
      * Calculate Percent of Head Killed for each column.
      * CASE: WRK.HRH Head Killed is Not 0
     C           WUR3NB    IFNE *ZERO                      *IF
     C           $JSCNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZCNB    H      Percent of hd k
     C           $JSDNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZDNB    H      Percent of hd k
     C           $JSENB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZENB    H      Percent of hd k
     C           $JSFNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZFNB    H      Percent of hd k
     C           $JSGNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZGNB    H      Percent of hd k
     C           $JSHNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZHNB    H      Percent of hd k
     C           $JSINB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZINB    H      Percent of hd k
     C           $JSJNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZJNB    H      Percent of hd k
     C           $JSKNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZKNB    H      Percent of hd k
     C           $JSLNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZLNB    H      Percent of hd k
     C           $JSMNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZMNB    H      Percent of hd k
     C           $JSNNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZNNB    H      Percent of hd k
     C           $JSONB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZONB    H      Percent of hd k
     C           $JSPNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZPNB    H      Percent of hd k
     C           $JSQNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZQNB    H      Percent of hd k
     C           $JSRNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZRNB    H      Percent of hd k
     C           $JSSNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZSNB    H      Percent of hd k
     C           $JSTNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZTNB    H      Percent of hd k
     C           $JSUNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $JZUNB    H      Percent of hd k
     C                     END                             *FI
     C                     Z-ADDWUR3NB    $JR3NB           HRH Head Killed
      * COMP:Total % for wt range
      * CUR.HRD Percent Total =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9+x10+x11+
      *    x12+x13+x14+x15+x16+x17+x18+x  19)
      * x1    : CUR.Percent of hd klld 1  USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Percent of hd klld 2  USR
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Percent of hd klld 3  USR
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Percent of hd klld 4  USR
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Percent of hd klld 5  USR
      * +     : PGM.*Synon (17,7) work field
      * x6    : CUR.Percent of hd klld 6  USR
      * +     : PGM.*Synon (17,7) work field
      * x7    : CUR.Percent of hd klld 7  USR
      * +     : PGM.*Synon (17,7) work field
      * x8    : CUR.Percent of hd klld 8  USR
      * +     : PGM.*Synon (17,7) work field
      * x9    : CUR.Percent of hd klld 9  USR
      * +     : PGM.*Synon (17,7) work field
      * x10   : CUR.Percent of hd klld 10 USR
      * +     : PGM.*Synon (17,7) work field
      * x11   : CUR.Percent of hd klld 11 USR
      * +     : PGM.*Synon (17,7) work field
      * x12   : CUR.Percent of hd klld 12 USR
      * +     : PGM.*Synon (17,7) work field
      * x13   : CUR.Percent of hd klld 13 USR
      * +     : PGM.*Synon (17,7) work field
      * x14   : CUR.Percent of hd klld 14 USR
      * +     : PGM.*Synon (17,7) work field
      * x15   : CUR.Percent of hd klld 15 USR
      * +     : PGM.*Synon (17,7) work field
      * x16   : CUR.Percent of hd klld 16 USR
      * +     : PGM.*Synon (17,7) work field
      * x17   : CUR.Percent of hd klld 17 USR
      * +     : PGM.*Synon (17,7) work field
      * x18   : CUR.Percent of hd klld 18 USR
      * +     : PGM.*Synon (17,7) work field
     C           $JZCNB    ADD  $JZDNB    W0WD17           *Synon (17,7) w
     C           W0WD17    ADD  $JZENB    W0WD16           *Synon (17,7) w
     C           W0WD16    ADD  $JZFNB    W0WD15           *Synon (17,7) w
     C           W0WD15    ADD  $JZGNB    W0WD14           *Synon (17,7) w
     C           W0WD14    ADD  $JZHNB    W0WD13           *Synon (17,7) w
     C           W0WD13    ADD  $JZINB    W0WD12           *Synon (17,7) w
     C           W0WD12    ADD  $JZJNB    W0WD11           *Synon (17,7) w
     C           W0WD11    ADD  $JZKNB    W0WD10           *Synon (17,7) w
     C           W0WD10    ADD  $JZLNB    W0WD09           *Synon (17,7) w
     C           W0WD09    ADD  $JZMNB    W0WD08           *Synon (17,7) w
     C           W0WD08    ADD  $JZNNB    W0WD07           *Synon (17,7) w
     C           W0WD07    ADD  $JZONB    W0WD06           *Synon (17,7) w
     C           W0WD06    ADD  $JZPNB    W0WD05           *Synon (17,7) w
     C           W0WD05    ADD  $JZQNB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  $JZRNB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $JZSNB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $JZTNB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $JZUNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $JRJNB           HRD Percent Tot
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$JKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Hog Popltn Rpt    PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Hog Popltn Rpt    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of first page format
      * 1PG = PAR By name
     C                     Z-ADDP3QYNB    $CQYNB           HRH Company Num
     C                     Z-ADDP3CMDT    $CCMDT           HRH From Kill D
     C                     Z-ADDP3CODT    $CCODT           HRH To Kill Dat
     C                     MOVELP7C9CD    $CC9CD           Cutout Matrix C
     C                     Z-ADDP7KLNB    $CKLNB           Effective Month
     C                     MOVELP2K9ST    $CK9ST           Report Type Usr
     C                     MOVELP3K1ST    $CK1ST           HRH Type Of Dis
     C                     MOVELP8NBST    $CNBST           Type of Popltn
     C                     MOVELP3KZST    $CKZST           HRH Source Type
     C                     MOVELP5ABCD    $CABCD           PD Producer Cod
     C                     MOVELP6HTCD    $CHTCD           HRH Prdcr Locat
     C                     MOVELP3K0ST    $CK0ST           HRH Payment Typ
     C                     Z-ADDP3R6NB    $CR6NB           HRH Tattoo Numb
     C                     Z-ADDP3ENNB    $CENNB           HRH Farm Site
     C                     MOVELP3TNST    $CTNST           HRH Kill Shift
      * Val Company Number    XF - STR Order Management Sys  * 
     C                     CALL 'PDGZXFR'              90  Val Company Num
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $CQYNB    WQ0001  30       CC Company Numb
     C           $CBSTX    PARM *BLANK    WQ0002 30        Oms Name
     C           WUG3ST    PARM *BLANK    WQ0003  1        Invalid Y/N USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL$CBSTX    WUBSTX           Name USR
      * Producer Code
      * CASE: 1PG.PD Producer Code is Blank
     C           $CABCD    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CCPTX           Name Producer D
     C                     MOVEL'All'     $CCPTX           Name Producer D
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CCPTX           Name Producer D
      * Name Producer DRV
      * Rtv Producer Name     RT - Producer  * 
     C                     EXSR SARVGN
     C                     END                             *FI
      * Location Code
      * CASE: 1PG.HRH Prdcr Location Code is Blank
     C           $CHTCD    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CA9TX           Pdctn Loc Name
     C                     MOVEL'All'     $CA9TX           Pdctn Loc Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CA9TX           Pdctn Loc Name
      * Pdctn Loc Name DRV
      * Rtv Pdctn Loc Name    RT - Production Location  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
      * E10350 JJH 05/18/17 - SR Code replaced with 6 Source Codes
      * Source Type
      * CASE: 1PG.HRH Source Type EQ WRK.Blank USR
     C           $CKZST    IFEQ WUCRTX                     *IF
     C                     MOVEL*BLANK    $CISTX           SR Type Desc
     C                     MOVEL'All'     $CISTX           SR Type Desc
     C                     ELSE
      * CASE: *OTHERWISE
      * 1PG.SR Type Desc = Condition name of 1PG.HRH Source Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1121482   Y2LSNO  70       List number
     C                     PARM $CKZST    W0INVL 25        HRH Source Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CISTX    PARM           W0CNNM 25        SR Type Desc
      *
     C                     END                             *FI
      * Payment Type
      * CASE: 1PG.HRH Payment Type EQ WRK.Blank USR
     C           $CK0ST    IFEQ WUCRTX                     *IF
     C                     MOVEL*BLANK    $CHDTX           Payment Type De
     C                     MOVEL'All'     $CHDTX           Payment Type De
     C                     ELSE
      * CASE: *OTHERWISE
      * 1PG.Payment Type Desc USR = Condition name of 1PG.HRH Payment Typ
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100717   Y2LSNO  70       List number
     C                     PARM $CK0ST    W0INVL 25        HRH Payment Typ
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CHDTX    PARM           W0CNNM 25        Payment Type De
      *
     C                     END                             *FI
      * Tattoo
      * CASE: 1PG.HRH Tattoo Number EQ WRK.Zero USR
     C           $CR6NB    IFEQ WUE9NB                     *IF
     C                     MOVEL'All'     $CJFTX           All Text
     C                     END                             *FI
      * Farm Site
      * CASE: 1PG.HRH Farm Site EQ WRK.Zero USR
     C           $CENNB    IFEQ WUE9NB                     *IF
     C                     MOVEL*BLANK    $CKQTX           Farm site Name
     C                     MOVEL'All'     $CKQTX           Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * Val HPS Farm Site     UP - STR HPS Interface  * 
     C                     CALL 'HP256'                90  Val HPS Farm Si
     C           WULMST    PARM WULMST    WQ0004  7        Return Code USR
     C                     PARM $CENNB    WQ0005  50       HRH Farm Site
     C                     PARM *BLANK    WQ0006  5        Farm Site Prod
     C           $CKQTX    PARM *BLANK    WQ0007 25        Farm site Name
     C                     PARM *BLANK    WQ0008 20        MTech Farm Site
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP256'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Kill Shift
      * CASE: 1PG.HRH Kill Shift EQ WRK.Blank USR
     C           $CTNST    IFEQ WUCRTX                     *IF
     C                     MOVEL*BLANK    $CI1TX           Condition Name
     C                     MOVEL'All'     $CI1TX           Condition Name
     C                     ELSE
      * CASE: *OTHERWISE
      * 1PG.Condition Name 1 USR = Condition name of 1PG.HRH Kill Shift
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100059   Y2LSNO  70       List number
     C                     PARM $CTNST    W0INVL 25        HRH Kill Shift
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CI1TX    PARM           W0CNNM 25        Condition Name
      *
     C                     END                             *FI
      * 1PG.Type of Dist Desc Usr = Condition name of 1PG.HRH Type Of Dis
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1152918   Y2LSNO  70       List number
     C                     PARM $CK1ST    W0INVL 25        HRH Type Of Dis
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CJDTX    PARM           W0CNNM 25        Type of Dist De
      *
      * 1PG.Report Type Desc Usr = Condition name of 1PG.Report Type Usr
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1153624   Y2LSNO  70       List number
     C                     PARM $CK9ST    W0INVL 25        Report Type Usr
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CJJTX    PARM           W0CNNM 25        Report Type Des
      *
      * 1PG.Type of Popltn Desc   USR = Condition name of 1PG.Type of Pop
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1178202   Y2LSNO  70       List number
     C                     PARM $CNBST    W0INVL 25        Type of Popltn
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CKOTX    PARM           W0CNNM 25        Type of Popltn
      *
      * Val Cutout Matrix     XF - STR Order Management Sys  * 
     C                     CALL 'PDLGXFR'              90  Val Cutout Matr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $CQYNB    WQ0009  30       Company Number
     C                     PARM $CC9CD    WQ0010  6        Cutout Matrix C
     C                     PARM $CKLNB    WQ0011  40       Effective Month
     C           $CKKTX    PARM *BLANK    WQ0012 30        Description 30
     C           WUH7ST    PARM *BLANK    WQ0013  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * E10350 JJH 05/18/17 - Display 6 Source Codes
     C                     MOVELYL0002    $CSHCD           TH Source Code-
     C                     MOVELYL0003    $CSICD           TH Source Code-
     C                     MOVELYL0004    $CSJCD           TH Source Code-
     C                     MOVELYL0005    $CSKCD           TH Source Code-
     C                     MOVELYL0006    $CSLCD           TH Source Code-
     C                     MOVELYL0007    $CSMCD           TH Source Code-
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert HRH From Kill Date to display format
      * Convert date
     C           1000000   ADD  $CCMDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCCMDT
      * Convert HRH To Kill Date to display format
      * Convert date
     C           1000000   ADD  $CCODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCCODT
      * Print format
     C                     WRITE$C1STPAG
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print HRH Type Of Distribution of Prt Hog Popltn Rpt    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Detail line. of Prt Hog Popltn Rpt    PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVELWUCRTX    $DJJTX           Report Type Des
      * CASE: PAR.Type of Popltn Rpt    USR is Head
     C           P8NBST    IFEQ 'H'                        *IF
     C                     MOVEL'Total'   $DKPTX           Text 5
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $DKPTX           Text 5
     C                     MOVEL'  %'     $DKPTX           Text 5
     C                     END                             *FI
      * CASE: PAR.Type of Popltn Rpt    USR is Head
     C           P8NBST    IFEQ 'H'                        *IF
     C                     MOVEL*BLANK    $DKUTX           Text 5   2
     C                     MOVEL'   %'    $DKUTX           Text 5   2
     C                     ELSE
      * CASE: PAR.Type of Popltn Rpt    USR is Percent By Weight Range
     C           P8NBST    IFEQ 'W'                        *IF
     C                     MOVEL'Total'   $DKUTX           Text 5   2
     C                     ELSE
      * CASE: PAR.Type of Popltn Rpt    USR is Percent
     C           P8NBST    IFEQ 'P'                        *IF
     C                     MOVELWUCRTX    $DKUTX           Text 5   2
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Report break field description
      * CASE: PAR.Report Type Usr is Producer
     C           P2K9ST    IFEQ 'P'                        *IF
      * Rtv Producer Name     RT - Producer  * 
     C                     EXSR SCRVGN
     C                     Z-ADD1         ZQ      50
     C           DAABCD    CAT  WUA4TX:ZQ $DJJTX    P      Report Type Des
     C                     ELSE
      * CASE: PAR.Report Type Usr is Producer/Location
     C           P2K9ST    IFEQ 'L'                        *IF
     C                     Z-ADD1         ZQ      50
     C           DAABCD    CAT  DAHTCD:ZQ $DJJTX    P      Report Type Des
     C                     ELSE
      * CASE: PAR.Report Type Usr is Payment Type
     C           P2K9ST    IFEQ 'B'                        *IF
      * WRK.Payment Type Desc USR = Condition name of DB1.HRH Payment Typ
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100717   Y2LSNO  70       List number
     C                     PARM DAK0ST    W0INVL 25        HRH Payment Typ
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUHDTX    PARM           W0CNNM 25        Payment Type De
      *
     C                     MOVEL*BLANK    $DJJTX           Report Type Des
     C                     MOVELWUHDTX    $DJJTX           Report Type Des
      * E10350 JJH 05/18/17 - SR Code replaced with 6 Source Codes
     C                     ELSE
      * CASE: PAR.Report Type Usr is Source Type
     C           P2K9ST    IFEQ 'A'                        *IF
      * WRK.SR Type Desc = Condition name of DB1.HRH Source Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1121482   Y2LSNO  70       List number
     C                     PARM DAKZST    W0INVL 25        HRH Source Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUISTX    PARM           W0CNNM 25        SR Type Desc
      *
     C                     MOVEL*BLANK    $DJJTX           Report Type Des
     C                     MOVELWUISTX    $DJJTX           Report Type Des
     C                     ELSE
      * CASE: PAR.Report Type Usr is Tattoo
     C           P2K9ST    IFEQ 'T'                        *IF
     C                     MOVEL*BLANK    WUDDCD           Tattoo Nbr Alph
     C                     MOVELDAR6NB    WUDDCD           Tattoo Nbr Alph
     C                     MOVEL*BLANK    $DJJTX           Report Type Des
     C                     MOVEL@CN,002   $DJJTX           Report Type Des
     C                     Z-ADD1         ZQ      50
     C           $DJJTX    CAT  WUDDCD:ZQ $DJJTX    P      Report Type Des
     C                     ELSE
      * CASE: PAR.Report Type Usr is Farm Site
     C           P2K9ST    IFEQ 'F'                        *IF
      * Val HPS Farm Site     UP - STR HPS Interface  * 
     C                     CALL 'HP256'                90  Val HPS Farm Si
     C           WULMST    PARM WULMST    WQ0014  7        Return Code USR
     C                     PARM DAENNB    WQ0015  50       HRH Farm Site
     C                     PARM *BLANK    WQ0016  5        Farm Site Prod
     C           WUKQTX    PARM *BLANK    WQ0017 25        Farm site Name
     C                     PARM *BLANK    WQ0018 20        MTech Farm Site
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP256'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    $DJJTX           Report Type Des
     C                     MOVELWUKQTX    $DJJTX           Report Type Des
     C                     ELSE
      * CASE: PAR.Report Type Usr is Company
     C           P2K9ST    IFEQ 'C'                        *IF
     C                     MOVEL*BLANK    $DJJTX           Report Type Des
     C                     MOVELWUBSTX    $DJJTX           Report Type Des
     C                     ELSE
      * CASE: PAR.Report Type Usr is Shift
     C           P2K9ST    IFEQ 'H'                        *IF
      * CUR.Report Type Desc Usr = Condition name of DB1.HRH Kill Shift
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100059   Y2LSNO  70       List number
     C                     PARM DATNST    W0INVL 25        HRH Kill Shift
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $DJJTX    PARM           W0CNNM 25        Report Type Des
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Report Type = Shift
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CUR.HRH Head Killed is Equals 0
      *   |- c2    : PAR.Report Type Usr is Shift
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $DR3NB    IFEQ *ZERO                      *IF
     C           P2K9ST    IFEQ 'H'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     $DR7NB           HRH AVG Hot Wei
     C                     Z-ADD*ZERO     $DEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     $DR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     $DEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     $DEWPC           HRH Avg Light R
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,003   CAT  @CN,004:ZQ$DOBTX    P      Text descriptio
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $DOBTX           Text descriptio
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
     C                     MOVEL'0'       *IN79
     C           P2K9ST    IFEQ 'H'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$DCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$DDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Prt Hog Population Rpt PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print HRH Type Of Distribution of Prt Hog Population Rpt PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print HRH Report Break of Prt Hog Population Rpt PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * USER: On print of HRH Report Break format
      * Rtv Hog Popltn Rpt HK RT - Hog Population Rpt Hdr  * 
     C                     EXSR SFRVGN
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print HRD Min Carcass Weight of Prt Hog Population Rpt PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Detail line. of Prt Hog Population Rpt PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     Z-ADDC9QUNB    $ESANB           Min Carcass Wei
     C                     Z-ADDC9QVNB    $ER8NB           Max Carcass Wei
     C                     Z-ADDC9QWNB    $ESBNB           Min Live Weight
     C                     Z-ADDC9QXNB    $ER9NB           Max Live Weight
      * CASE: WRK.HRH Head Killed is Greater then Zero
     C           WUR3NB    IFGT *ZERO                      *IF
     C           C9RINB    DIV  WUR3NB    WUE1PC    H      Percent Total C
     C           WUE1PC    MULT 100       $ES2NB    H      Percent Total D
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $ES2NB           Percent Total D
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt Hog Pop Rpt- %     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print HRH Type Of Distribution of Prt Hog Pop Rpt- %     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print HRH Report Break of Prt Hog Pop Rpt- %     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * USER: On print of HRH Report Break format
      * Rtv Hog Popltn Rpt HK RT - Hog Population Rpt Hdr  * 
     C                     EXSR SHRVGN
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print HRD Min Carcass Weight of Prt Hog Pop Rpt- %     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print Detail line. of Prt Hog Pop Rpt- %     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     Z-ADDC9QUNB    $GSANB           Min Carcass Wei
     C                     Z-ADDC9QVNB    $GR8NB           Max Carcass Wei
     C                     Z-ADDC9QWNB    $GSBNB           Min Live Weight
     C                     Z-ADDC9QXNB    $GR9NB           Max Live Weight
      * Calculate Percent of Hd Killed for each column
      * CASE: WRK.HRH Head Killed is Greater then Zero
     C           WUR3NB    IFGT *ZERO                      *IF
     C           C9RINB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZVNB    H      Percent Tot Dtl
     C           C9QZNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZCNB    H      Percent of hd k
     C           C9Q0NB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZDNB    H      Percent of hd k
     C           C9Q1NB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZENB    H      Percent of hd k
     C           C9Q2NB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZFNB    H      Percent of hd k
     C           C9Q3NB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZGNB    H      Percent of hd k
     C           C9Q4NB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZHNB    H      Percent of hd k
     C           C9Q5NB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZINB    H      Percent of hd k
     C           C9Q6NB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZJNB    H      Percent of hd k
     C           C9Q7NB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZKNB    H      Percent of hd k
     C           C9Q8NB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZLNB    H      Percent of hd k
     C           C9Q9NB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZMNB    H      Percent of hd k
     C           C9RANB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZNNB    H      Percent of hd k
     C           C9RBNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZONB    H      Percent of hd k
     C           C9RCNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZPNB    H      Percent of hd k
     C           C9RDNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZQNB    H      Percent of hd k
     C           C9RENB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZRNB    H      Percent of hd k
     C           C9RFNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZSNB    H      Percent of hd k
     C           C9RGNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZTNB    H      Percent of hd k
     C           C9RHNB    DIV  WUR3NB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $GZUNB    H      Percent of hd k
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $GZVNB           Percent Tot Dtl
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$GCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$GDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of Prt Hog Pop Rpt- % Wt  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print HRH Type Of Distribution of Prt Hog Pop Rpt- % Wt  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print HRH Report Break of Prt Hog Pop Rpt- % Wt  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * USER: On print of HRH Report Break format
      * Rtv Hog Popltn Rpt HK RT - Hog Population Rpt Hdr  * 
     C                     EXSR SIRVGN
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print HRD Min Carcass Weight of Prt Hog Pop Rpt- % Wt  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP02
     C                     END                             FI
      * Print Detail line. of Prt Hog Pop Rpt- % Wt  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     Z-ADDC9QUNB    $ISANB           Min Carcass Wei
     C                     Z-ADDC9QVNB    $IR8NB           Max Carcass Wei
     C                     Z-ADDC9QWNB    $ISBNB           Min Live Weight
     C                     Z-ADDC9QXNB    $IR9NB           Max Live Weight
      * Calculate Percent of Hd Killed for each weight range
      * CASE: DB1.HRD Dist Carcass Cnt Tot is Greater than 0
     C           C9RINB    IFGT *ZERO                      *IF
     C           C9QZNB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZCNB    H      Percent of hd k
     C           C9Q0NB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZDNB    H      Percent of hd k
     C           C9Q1NB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZENB    H      Percent of hd k
     C           C9Q2NB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZFNB    H      Percent of hd k
     C           C9Q3NB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZGNB    H      Percent of hd k
     C           C9Q4NB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZHNB    H      Percent of hd k
     C           C9Q5NB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZINB    H      Percent of hd k
     C           C9Q6NB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZJNB    H      Percent of hd k
     C           C9Q7NB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZKNB    H      Percent of hd k
     C           C9Q8NB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZLNB    H      Percent of hd k
     C           C9Q9NB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZMNB    H      Percent of hd k
     C           C9RANB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZNNB    H      Percent of hd k
     C           C9RBNB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZONB    H      Percent of hd k
     C           C9RCNB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZPNB    H      Percent of hd k
     C           C9RDNB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZQNB    H      Percent of hd k
     C           C9RENB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZRNB    H      Percent of hd k
     C           C9RFNB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZSNB    H      Percent of hd k
     C           C9RGNB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZTNB    H      Percent of hd k
     C           C9RHNB    DIV  C9RINB    WUGAPC    H      Percent Calc 7,
     C           WUGAPC    MULT 100       $IZUNB    H      Percent of hd k
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $IZVNB           Percent Tot Dtl
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$ICOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$IDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     MOVEL*BLANK    W0SKP   1
      * Cascade skip to new page requests upwards
     C           W0APDT    IFEQ 'Y'
     C                     MOVEL'Y'       W0SKP
     C                     END
      * Request new page if required
     C           W0SKP     IFEQ 'Y'                        IF
     C                     MOVE 'Y'       W0NEWP
     C                     END                             FI
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Hog Popltn Rpt    PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  17        W0FSUM
     C                     END                             FI
      *
      * * HRH Type Of Distribution of Prt Hog Popltn Rpt    PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Hog Popltn Rpt    PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD14        W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Hog Population Rpt PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * HRH Type Of Distribution of Prt Hog Population Rpt PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * HRH Report Break of Prt Hog Population Rpt PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * HRD Min Carcass Weight of Prt Hog Population Rpt PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Hog Population Rpt PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Hog Pop Rpt- %     PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * HRH Type Of Distribution of Prt Hog Pop Rpt- %     PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * HRH Report Break of Prt Hog Pop Rpt- %     PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * HRD Min Carcass Weight of Prt Hog Pop Rpt- %     PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Hog Pop Rpt- %     PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Hog Pop Rpt- % Wt  PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * HRH Type Of Distribution of Prt Hog Pop Rpt- % Wt  PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * HRH Report Break of Prt Hog Pop Rpt- % Wt  PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * HRD Min Carcass Weight of Prt Hog Pop Rpt- % Wt  PO
     C           W0DP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Hog Pop Rpt- % Wt  PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * WRK.Type of Dist Desc Usr = Condition name of DB1.HRH Type Of Dis
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1152918   Y2LSNO  70       List number
     C                     PARM DAK1ST    W0INVL 25        HRH Type Of Dis
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUJDTX    PARM           W0CNNM 25        Type of Dist De
      *
     C                     Z-ADD1         ZQ      50
     C           '***'     CAT  WUJDTX:ZQ $BJHTX    P      Head of Report
     C                     Z-ADD1         ZQ      50
     C           $BJHTX    CAT  '***':ZQ  $BJHTX    P      Head of Report
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELDAABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSA     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAGTX    $CCPTX           PD Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Pdctn Loc Name    RT - Production Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVEL$CABCD    AFABCD           PD Producer Cod
     C                     MOVEL$CHTCD    AFAECD           PL Location Cod
      * Establish starting position
     C           KRSSB     CHAIN@AFREAR              90    *
      * Data record not found
     C   90                MOVEL'PRK0015' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAFA8TX    $CA9TX           PL Name
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELDAABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSC     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAGTX    WUA4TX           PD Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Farm/Prod/Loc     RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0008           TH HPS Farm Sit
     C                     MOVEL*BLANK    YL0009           PD Producer Cod
     C                     MOVEL*BLANK    YL0010           PL Location Cod
     C                     Z-ADD*ZERO     YL0011           HRH Hot Weight
     C                     Z-ADD*ZERO     YL0012           HRH Live Weight
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UCSUBR                     Get the MTech L
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQSD01           BOH Company Num
     C           *LIKE     DEFN A1B0DT    WQSD02           TH Kill Date
     C           *LIKE     DEFN A1CVNB    WQSD03           TH Tattoo Numbe
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           BOH Company Num
     C                     KFLD           WQSD02           TH Kill Date
     C                     KFLD           WQSD03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD$DQYNB    WQSD01           BOH Company Num
     C                     Z-ADD$DCMDT    WQSD02           TH Kill Date
     C                     Z-ADD$DR6NB    WQSD03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSD     SETLL@A1CPL0                    *
     C           KRSSD     READE@A1CPL0                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  A1E0NB    YL0011           HRH Hot Weight
     C                     ADD  A1CYNB    YL0012           HRH Live Weight
     C                     MOVELA1ABCD    YL0009           PD Producer Cod
     C                     MOVELA1AECD    YL0010           PL Location Cod
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0013    IFEQ 'N'                        *IF
      * CASE: DB1.TH HPS Farm Site is *Zeros
     C           A1THHD    IFEQ 0                          *IF
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0022  7        *Return code
     C                     PARM A1OXNB    WQ0023  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0024 25        Farm site Name
     C           YL0008    PARM *ZERO     WQ0025  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0026  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0027  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDA1THHD    YL0008           TH HPS Farm Sit
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0013    IFEQ 'Y'                        *IF
     C                     Z-ADDA1THHD    YL0008           TH HPS Farm Sit
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@A1CPL0                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr OUTF  CR - Hog Population Hdr OUTF  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E0CPE4
     C                     Z-ADD$DQYNB    E0HMNB           BOH Company Num
     C                     Z-ADD$DR6NB    E0CVNB           TH Tattoo Numbe
     C                     Z-ADD$DCMDT    E0B0DT           TH Kill Date
     C                     Z-ADD$DR3NB    E0R3NB           HRH Head Killed
     C                     Z-ADD$DEWPC    E0EWPC           HRH Avg Light R
     C                     Z-ADD$DEXPC    E0EXPC           HRH Avg Loin Ey
     C                     Z-ADD$DR4NB    E0R4NB           HRH Avg Back Fa
     C                     Z-ADD$DEYPC    E0EYPC           HRH Avg Lean %
     C                     Z-ADDYL0011    E0CHA1           HRH Hot Weight
     C                     Z-ADDYL0012    E0CIA1           HRH Live Weight
     C                     Z-ADD$DE0PC    E0E0PC           HRH % Adjusted
     C                     Z-ADD$DR7NB    E0R7NB           HRH AVG Hot Wei
     C                     Z-ADD$DEONB    E0EONB           HRH Avg Live Wg
     C                     Z-ADDYL0008    E0ENNB           HRH Farm Site
     C                     MOVELYL0009    E0H6CD           HRH Producer Co
     C                     MOVELYL0010    E0H7CD           HRH Location Co
      *
     C           KLCRSE    KLIST
     C                     KFLD           E0HMNB           BOH Company Num
     C                     KFLD           E0CVNB           TH Tattoo Numbe
     C                     KFLD           E0B0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRSE    SETLL@E0CPE4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@E0CPE4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Hog Popltn Rpt HK RT - Hog Population Rpt Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           DAK1ST           HRH Type Of Dis
     C                     KFLD           DAJCTX           HRH Report Brea
      * Setup key
     C                     MOVELC9K1ST    DAK1ST           HRH Type Of Dis
     C                     MOVELC9JCTX    DAJCTX           HRH Report Brea
      * Establish starting position
     C           KRSSF     CHAIN@DACPQW              90    *
      * Data record not found
     C   90                MOVEL'PRK0478' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDAR3NB    WUR3NB           HRH Head Killed
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl OUTF  CR - Hog Population Dtl OUTF  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EZCPE1
     C                     Z-ADD$DQYNB    EZHMNB           BOH Company Num
     C                     Z-ADD$DR6NB    EZCVNB           TH Tattoo Numbe
     C                     Z-ADD$DCMDT    EZB0DT           TH Kill Date
     C                     Z-ADD$EQUNB    EZQUNB           HRD Min Carcass
     C                     Z-ADD$EQVNB    EZQVNB           HRD Max Carcass
     C                     Z-ADD$EQWNB    EZQWNB           HRD Min Live We
     C                     Z-ADD$EQXNB    EZQXNB           HRD Max Live We
     C                     Z-ADD$ERINB    EZRINB           HRD Dist Carcas
     C                     Z-ADD$ES2NB    EZRJNB           HRD Percent Tot
      *
     C           KLCRSG    KLIST
     C                     KFLD           EZHMNB           BOH Company Num
     C                     KFLD           EZCVNB           TH Tattoo Numbe
     C                     KFLD           EZB0DT           TH Kill Date
     C                     KFLD           EZQUNB           HRD Min Carcass
     C                     KFLD           EZQVNB           HRD Max Carcass
      * Check for duplicate primary key
     C           KLCRSG    SETLL@EZCPE1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0953' W0RTN   7
      * Send message 'Hog Population Dtl OUT EX'
     C                     MOVEL'PRK0953' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@EZCPE1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Hog Popltn Rpt HK RT - Hog Population Rpt Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           DAK1ST           HRH Type Of Dis
     C                     KFLD           DAJCTX           HRH Report Brea
      * Setup key
     C                     MOVELC9K1ST    DAK1ST           HRH Type Of Dis
     C                     MOVELC9JCTX    DAJCTX           HRH Report Brea
      * Establish starting position
     C           KRSSH     CHAIN@DACPQW              90    *
      * Data record not found
     C   90                MOVEL'PRK0478' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDAR3NB    WUR3NB           HRH Head Killed
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Hog Popltn Rpt HK RT - Hog Population Rpt Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           DAK1ST           HRH Type Of Dis
     C                     KFLD           DAJCTX           HRH Report Brea
      * Setup key
     C                     MOVELC9K1ST    DAK1ST           HRH Type Of Dis
     C                     MOVELC9JCTX    DAJCTX           HRH Report Brea
      * Establish starting position
     C           KRSSI     CHAIN@DACPQW              90    *
      * Data record not found
     C   90                MOVEL'PRK0478' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDAR3NB    WUR3NB           HRH Head Killed
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E10350 JJH 05/17/17 - Hog Population Report Modifications
      * - Replace I Parm Oms System Value Alpha with Oms Application Code
      * - Replace I Parm SR Source Code with TH Source Code-X18 USR
      * - Remove SR Description from 1st Page Format
      * - Remove SR Source Code from 1st Page Format
      * - Add TH Source Code-1 USR through TH Source Code-6 USR to 1st Pa
      * H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Num
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Hog Population Rpt PO
      *================================================================
      * If Type of Pop is HEAD then use that print object, else fall out.
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Type of Popltn Rpt    USR is Percent
      *   |- c2    : PAR.Type of Popltn Rpt    USR is Percent by Weight R
      *   '-
     C           P8NBST    IFEQ 'P'                        *IF
     C           P8NBST    OREQ 'W'                        *OR
     C                     GOTO UBEXIT                     *QUIT
     C                     END                             *FI
      * Create Header
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CUR.HRH Tattoo Number is NE Zero
      *   |- c2    : PAR.Create Outfile USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $DR6NB    IFNE *ZERO                      *IF
     C           P9T9ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Farm/Prod/Loc     RT - Tattoo Header  * 
     C                     EXSR SDRVGN
      * Crt Hog Pop Hdr OUTF  CR - Hog Population Hdr OUTF  * 
     C                     EXSR SECRRC
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P9T9ST' defaulted for 'Create Outfile USR'.
      * Prt Hog Population Rpt PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $DQYNB    WQ0019  30       BOH Company Num
     C                     PARM @CN,005   WQ0020 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0021 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0013           MTech Live Yes
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Hog Pop Rpt- %     PO
      *================================================================
      * If Type of Pop is PERCENT then use that print object, else fall o
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Type of Popltn Rpt    USR is Head
      *   |- c2    : PAR.Type of Popltn Rpt    USR is Percent by Weight R
      *   '-
     C           P8NBST    IFEQ 'H'                        *IF
     C           P8NBST    OREQ 'W'                        *OR
     C                     GOTO UDEXIT                     *QUIT
     C                     END                             *FI
      * Prt Hog Pop Rpt- %     PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Hog Pop Rpt- % Wt  PO
      *================================================================
      * If type of pop is Percent by Weight Range use that prtobj, else f
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Type of Popltn Rpt    USR is Head
      *   |- c2    : PAR.Type of Popltn Rpt    USR is Percent
      *   '-
     C           P8NBST    IFEQ 'H'                        *IF
     C           P8NBST    OREQ 'P'                        *OR
     C                     GOTO UEEXIT                     *QUIT
     C                     END                             *FI
      * Prt Hog Pop Rpt- % Wt  PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    DAK1ST           HRH Type Of Dis
     C                     MOVEL*LOVAL    DAJCTX           HRH Report Brea
      * Define work field Type of Dist Desc Usr
     C                     MOVEL*BLANK    WUJDTX 15
      * Define work field Invalid Y/N USR
     C                     MOVEL*BLANK    WUG3ST  1
      * Define work field Name USR
     C                     MOVEL*BLANK    WUBSTX 40
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUH7ST  1
      * Define work field Producer Name         DRV
     C                     MOVEL*BLANK    WUA4TX 40
      * Define work field Payment Type Desc USR
     C                     MOVEL*BLANK    WUHDTX 30
      * Define work field SR Type Desc
     C                     MOVEL*BLANK    WUISTX 15
      * Define work field Tattoo Nbr Alpha Usr
     C                     MOVEL*BLANK    WUDDCD  5
      * Define work field Farm site Name f/ HPS USR
     C                     MOVEL*BLANK    WUKQTX 25
      * Define work field System Value Alpha    USR
     C                     MOVEL*BLANK    WUKBTX 40
      * Define work field HPS FS Comp Relation USR
     C                     MOVEL*BLANK    WUG4CD  5
      * Define work field State
     C                     MOVEL*BLANK    WUDRTX  3
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    C9K1ST           HRH Type Of Dis
     C                     MOVEL*LOVAL    C9JCTX           HRH Report Brea
     C                     MOVEL*LOVAL    C9QUNB           HRD Min Carcass
     C                     MOVEL*LOVAL    C9QVNB           HRD Max Carcass
      * Define work field HRH Head Killed
     C                     Z-ADD*ZERO     WUR3NB  70
      * Define work field Percent Total Cal Usr
     C                     Z-ADD*ZERO     WUE1PC  52
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    C9K1ST           HRH Type Of Dis
     C                     MOVEL*LOVAL    C9JCTX           HRH Report Brea
     C                     MOVEL*LOVAL    C9QUNB           HRD Min Carcass
     C                     MOVEL*LOVAL    C9QVNB           HRD Max Carcass
      * Define work field Percent Calc 7,4      USR
     C                     Z-ADD*ZERO     WUGAPC  74
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    C9K1ST           HRH Type Of Dis
     C                     MOVEL*LOVAL    C9JCTX           HRH Report Brea
     C                     MOVEL*LOVAL    C9QUNB           HRD Min Carcass
     C                     MOVEL*LOVAL    C9QVNB           HRD Max Carcass
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WD17 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD16 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD15 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD14 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD13 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD12 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD11 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD10 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD09 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD08 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD07 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD06 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD05 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD04 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Oms System Value Alpha
     C                     MOVEL*BLANK    YL0001 40
      * Define local work field TH Source Code-1 USR
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field TH Source Code-2 USR
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field TH Source Code-3 USR
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field TH Source Code-4 USR
     C                     MOVEL*BLANK    YL0005  3
      * Define local work field TH Source Code-5 USR
     C                     MOVEL*BLANK    YL0006  3
      * Define local work field TH Source Code-6 USR
     C                     MOVEL*BLANK    YL0007  3
      * Define null work field MTech Farm Site Ref
     C                     MOVEL*BLANK    YN0001 20
      * Define local work field HRH Farm Site
     C                     Z-ADD*ZERO     YL0008  50
      * Define local work field HRH Producer Code
     C                     MOVEL*BLANK    YL0009  6
      * Define local work field HRH Location Code
     C                     MOVEL*BLANK    YL0010  6
      * Define local work field HRH Hot Weight
     C                     Z-ADD*ZERO     YL0011 111
      * Define local work field HRH Live Weight
     C                     Z-ADD*ZERO     YL0012 111
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0013  1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * E10350 JJH 05/17/17 - Set the OMS System Value Alpha because it
      *   could not be passed via the EXCMSG which is limited to 32-char
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,001   CAT  'ion':ZQ  YL0001    P      Oms System Valu
      * Mov ApplN to Co-PRINT US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELYL0001    $ACMP
      * E10350 JJH 05/18/17 - Substring TH Source Code-X18 USR
     C                     Z-ADD3         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00018
     C           ZQ        ORGT 00018
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTP4DRT1:ZQ YL0002    P  90  TH Source Code-
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD3         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00018
     C           ZQ        ORGT 00018
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTP4DRT1:ZQ YL0003    P  90  TH Source Code-
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD3         YRSW00
     C                     Z-ADD7         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00018
     C           ZQ        ORGT 00018
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTP4DRT1:ZQ YL0004    P  90  TH Source Code-
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD3         YRSW00
     C                     Z-ADD10        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00018
     C           ZQ        ORGT 00018
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTP4DRT1:ZQ YL0005    P  90  TH Source Code-
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD3         YRSW00
     C                     Z-ADD13        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00018
     C           ZQ        ORGT 00018
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTP4DRT1:ZQ YL0006    P  90  TH Source Code-
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD3         YRSW00
     C                     Z-ADD16        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00018
     C           ZQ        ORGT 00018
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTP4DRT1:ZQ YL0007    P  90  TH Source Code-
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Hog Procurement & Evaluat
00002 Tattoo Number
00003 Carcass information not a
00004 vailable.
00005 MTECHLIVE
