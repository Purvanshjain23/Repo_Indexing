     H/TITLE Edt OrdDtl Pricing    ER  Edit record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Edit record(1 screen)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 10/31/18  Time  : 11:13:34
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPNQBE1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Edt OrdDtl Pricing    ER  Edit record(1 screen)
      *
     FOPBGWKL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Order Detail              Retrieval index
      *
     FPDIHREL4IF  E           K        DISK
      * RSQ : Price Method Header       Price Method Header
      *
     FOMFYREL0IF  E           K        DISK
      * RTV : Commodity Markets         Retrieval index
      *
     FPDIPREL0IF  E           K        DISK
      * RTV : Market Date Method        Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDIHREL0IF  E           K        DISK
      * RTV : Price Method Header       Retrieval index
      *
     FCAASREL3IF  E           K        DISK
      * RTV : Company Control           Retrieval Active Only
      *
     FOMF0CPL2IF  E           K        DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
     FPDIPREL2IF  E           K        DISK
      * RSQ : Market Date Method        System/Co/Date Method
      *
     FOMF0CPL3IF  E           K        DISK
      * RTV : Commodity Mrkt Price      Active Only
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPDK0REL1IF  E           K        DISK
      * RTV : Order Group               Retrieval index
      *
     FCAAMREL1IF  E           K        DISK
      * RTV : Unit of Measure           Retrieval index       NV
      *
     FPDIRREL0IF  E           K        DISK
      * RTV : Price Audit Reason Cd     Retrieval index
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FOME8REL0IF  E           K        DISK
      * RTV : Item Structure Type       Retrieval index
      *
     FOME9REL0IF  E           K        DISK
      * RTV : Item Structure Group      Retrieval index
      *
     FOMFAREL1IF  E           K        DISK
      * RTV : Item Structure Class      Retrieval index
      *
     FPDILREL0IF  E           K        DISK
      * RTV : Item Level                Retrieval index
      *
     FCAAIREL1IF  E           K        DISK
      * RTV : Quality Level             Retrieval index       NV
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FOME5REL1IF  E           K        DISK
      * RTV : Country                   Retrieval index
      *
     FOPEZREL1IF  E           K        DISK
      * RTV : Event Types               Retrieval index       NV
      *
     FOPCXREL1IF  E           K        DISK
      * RTV : OP Reason Codes           Retrieval index
      *
     FPDJEREL1IF  E           K        DISK
      * RTV : Sales Route               Retrieval index
      *
     FPDM0REL1IF  E           K        DISK
      * RTV : Ham Group                 Retrieval index
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * KEY Screen: Field position and name array
     E                    W0BEG   2 002  5 0A
     E                    W0END   2 002  5 0A
     E                    W0NAM   2 002 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 023  5 0A
     E                    W1END   7 023  5 0A
     E                    W1NAM   7 023 10
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@IHRERN
      * Price Method Header       Retrieval index
      * Renamed input format fields
     I              IHAIC3                          WAAIC3
     I              IHQ7CD                          WAQ7CD
     I              IHMLNA                          WAMLNA
     I              IHU0ST                          WAU0ST
     I              IHV8ST                          WAV8ST
     I              IHBYST                          WABYST
     I              IHRMNY                          WARMNY
     I              IHH3ST                          WAH3ST
     I              IHH5ST                          WAH5ST
     I              IHH6ST                          WAH6ST
     I              IHH7ST                          WAH7ST
     I              IHUVST                          WAUVST
     I              IHUWST                          WAUWST
     I              IHUXST                          WAUXST
     I              IHAATM                          WAAATM
     I              IHAYNA                          WAAYNA
     I              IHA0NA                          WAA0NA
     I              IHAXDT                          WAAXDT
      *
     I@IPREFJ
      * Market Date Method        System/Co/Date Method
      * Renamed input format fields
     I              IPAIC3                          WBAIC3
     I              IPRDCD                          WBRDCD
     I              IPMNNA                          WBMNNA
     I              IPRECD                          WBRECD
     I              IPCPRD                          WBCPRD
     I              IPQMNB                          WBQMNB
     I              IPU7ST                          WBU7ST
     I              IPCNOT                          WBCNOT
     I              IPU8ST                          WBU8ST
     I              IPCDOW                          WBCDOW
     I              IPBXST                          WBBXST
     I              IPUVST                          WBUVST
     I              IPUWST                          WBUWST
     I              IPUXST                          WBUXST
     I              IPAATM                          WBAATM
     I              IPAYNA                          WBAYNA
     I              IPA0NA                          WBA0NA
     I              IPAXDT                          WBAXDT
      *
     I@F0CPVR
      * Commodity Mrkt Price      Active Only
      * Renamed input format fields
     I              F0LQCD                          WCLQCD
     I              F0LRCD                          WCLRCD
     I              F0EQDT                          WCEQDT
     I              F0A5PR                          WCA5PR
     I              F0B8PR                          WCB8PR
     I              F0UVST                          WCUVST
     I              F0UWST                          WCUWST
     I              F0UXST                          WCUXST
     I              F0VSST                          WCVSST
     I              F0AATM                          WCAATM
     I              F0AYNA                          WCAYNA
     I              F0A0NA                          WCA0NA
     I              F0AXDT                          WCAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            525
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPARC        DS                              7
      * KEY : IP Item Market Details    Retrieval index
      * I :  Item Code
     I                                    P   1   40PAHGCD
      * I :  Commodity Market Code
     I                                        5   7 PALQCD
      *
      * Outward parameters
     IPBRC        DS                             12
      * KEY : Order Detail              Ship To/Price Code/Item
      * I :  Ship To Customer
     I                                    P   1   40PBBKC7
      * I :  Price Code
     I                                    P   5   80PBBVTM
      * I :  Item Code
     I                                    P   9  120PBHGCD
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             10
      * KEY: Order Detail              Retrieval index
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * I : RST Order Sequence Number
     I                                    P   7   80P1DPNB
      * I : RST Order Secondary Line Seq
     I                                    P   9  100P1UENB
     IP2PARM      DS
      * FLD: Company Customer
      * N :  Type Code
     I                                        1   2 P2BOCD
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Value Required (alpha)'
      * Text 1 USR
     I                                        1  25 ZA0001
      * Message data for 'Price Code Inv for Mthd'
      * Price Code
     I                                    P   1   40ZA0002
      * Price Method Code
     I                                        5   7 ZA0003
      * Message data for 'Price Code not val f/cust'
      * Price Code
     I                                    P   1   40ZA0004
      * Message data for 'Price Code not val dt rng'
      * Price Code
     I                                    P   1   40ZA0005
      * Message data for 'Price Code not val f/item'
      * Price Code
     I                                    P   1   40ZA0006
      * Item Code
     I                                        5  11 ZA0007
      * Message data for 'Price Code max wgt exceed'
      * Price Code
     I                                    P   1   40ZA0008
      * Weight Allocated USR
     I                                    P   5   92ZA0009
      * Maximum Contract Units
     I                                    P  10  152ZA0010
      * Item Code
     I                                       16  22 ZA0011
      * Message data for 'Price Code max wgt exceed'
      * Price Code
     I                                    P   1   40ZA0012
      * Weight Allocated USR
     I                                    P   5   92ZA0013
      * Maximum Contract Units
     I                                    P  10  152ZA0014
      * Item Code
     I                                       16  22 ZA0015
      * Message data for 'Price code req for mthd'
      * Price Method Code
     I                                        1   3 ZA0016
      * Price Code
     I                                    P   4   70ZA0017
      * Message data for 'Market Date/Range ERR'
      * Market Pricing Date
     I                                    P   1   40ZA0018
      * OD Market Begin Date
     I                                    P   5   80ZA0019
      * OD Market Ending Date
     I                                    P   9  120ZA0020
      * Message data for 'Date Range Invalid'
      * OD Market Begin Date
     I                                    P   1   40ZA0021
      * OD Market Ending Date
     I                                    P   5   80ZA0022
      * Message data for 'Price Override not allow'
      * Contract Price Override
     I                                    P   1   64ZA0023
      * Message data for 'Date Meth Code not allow'
      * Date Method Code
     I                                        1   3 ZA0024
      * Message data for 'Ceiling Price Invalid'
      * OD Ceiling Price
     I                                    P   1   64ZA0025
      * Message data for 'Prc Date Range Inv'
      * OD Market Begin Date
     I                                    P   1   40ZA0026
      * OD Market Ending Date
     I                                    P   5   80ZA0027
      * Price Method Code
     I                                        9  11 ZA0028
      * Message data for 'Price Override Required'
      * Contract Price Override
     I                                    P   1   64ZA0029
      * Message data for 'Market Code not allowed'
      * Dft Commodity Market
     I                                        1   3 ZA0030
      * Message data for 'Date Meth Code not allow'
      * Date Method Code
     I                                        1   3 ZA0031
      * Message data for 'Ceiling Price Invalid'
      * OD Ceiling Price
     I                                    P   1   64ZA0032
      * Message data for 'Prc Dts = 0 f/Prc Mth'
      * Market Pricing Date
     I                                    P   1   40ZA0033
      * OD Market Begin Date
     I                                    P   5   80ZA0034
      * OD Market Ending Date
     I                                    P   9  120ZA0035
      * Price Method Code
     I                                       13  15 ZA0036
      * Message data for 'Manual price within Prcnt'
      * Price Overage Override
     I                                    P   1   64ZA0037
      * Message data for 'No Mkt Prc Found for test'
      * Price Overage Override
     I                                    P   1   64ZA0038
      * Commodity Market Code
     I                                        7   9 ZA0039
      * Commodity Price Group
     I                                       10  16 ZA0040
      * Message data for 'Market Code not allowed'
      * Dft Commodity Market
     I                                        1   3 ZA0041
      * Message data for 'Date Meth Code not allow'
      * Date Method Code
     I                                        1   3 ZA0042
      * Message data for 'Ceiling Price Invalid'
      * OD Ceiling Price
     I                                    P   1   64ZA0043
      * Message data for 'Ceiling Price Required'
      * OD Ceiling Price
     I                                    P   1   64ZA0044
      * Message data for 'Prc Dts = 0 f/Prc Mth'
      * Market Pricing Date
     I                                    P   1   40ZA0045
      * OD Market Begin Date
     I                                    P   5   80ZA0046
      * OD Market Ending Date
     I                                    P   9  120ZA0047
      * Price Method Code
     I                                       13  15 ZA0048
      * Message data for 'Price Override not allow'
      * Contract Price Override
     I                                    P   1   64ZA0049
      * Message data for 'Market Code must be enter'
      * Commodity Market Code
     I                                        1   3 ZA0050
      * Message data for 'Market Date Method Inval.'
      * Date Method Code
     I                                        1   3 ZA0051
      * Message data for 'Date Meth & Prc Dat N/A'
      * Market Pricing Date
     I                                    P   1   40ZA0052
      * Date Method Code
     I                                        5   7 ZA0053
      * Message data for 'Market Date Method Inval.'
      * Date Method Code
     I                                        1   3 ZA0054
      * Message data for 'Market Date/Range ERR'
      * Market Pricing Date
     I                                    P   1   40ZA0055
      * OD Market Begin Date
     I                                    P   5   80ZA0056
      * OD Market Ending Date
     I                                    P   9  120ZA0057
      * Message data for 'Date Range Invalid'
      * OD Market Begin Date
     I                                    P   1   40ZA0058
      * OD Market Ending Date
     I                                    P   5   80ZA0059
      * Message data for 'No Price for Mkt/Group'
      * Commodity Market Code
     I                                        1   3 ZA0060
      * Commodity Price Group
     I                                        4  10 ZA0061
      * Message data for 'No Price Mkt/Group Deflt'
      * Commodity Market Code
     I                                        1   3 ZA0062
      * Commodity Price Group
     I                                        4  10 ZA0063
      * Default Commod Mark basis
     I                                       11  13 ZA0064
      * Message data for 'No Price for Mkt/Group'
      * Commodity Market Code
     I                                        1   3 ZA0065
      * Commodity Price Group
     I                                        4  10 ZA0066
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Order Deta
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Display and process key screen
     C                     EXSR BADSKY
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1DPNB    IFEQ *ZERO                      Order Sequence
     C           #1UENB    OREQ *ZERO                      Order Secondary
     C           #1AIC3    OREQ *ZERO                      Company Number
     C           #1C4NB    OREQ *ZERO                      Order Number
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Setup key
     C                     Z-ADD#1AIC3    OMAIC3
     C                     Z-ADD#1C4NB    OMC4NB
     C                     Z-ADD#1DPNB    OMDPNB
     C                     Z-ADD#1UENB    OMUENB
     C           KRTV      CHAIN@BGWKL1              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     99    *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     99    *
      * Send message 'Order Detail           NF'
     C                     MOVEL'USR1309' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
     C                     MOVEL*BLANK    #DRRNA           Price Method De
      * Price Method Desc DRV
      * Rtv Price Method Desc  RT - Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1Q7CD    WL0001    P      Price Method Co
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DRRNA    P      Price Method De
     C                     MOVEL*BLANK    #DTMNA           Commodity Marke
      * Commodity Market Desc DRV
      * RTV Commod. Mkts Desc  RT - Commodity Markets  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1LQCD    WL0003    P      Commodity Marke
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DTMNA    P      Commodity Marke
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                     MOVEL*BLANK    #DTNNA           Date Method Cod
      * Date Method Code Desc DRV
      * Rtv Method Desc       RT - Market Date Method  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0005           Company Number
     C                     MOVEL#1RDCD    WL0006    P      Date Method Cod
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    #DTNNA    P      Date Method Des
      * USER: Initialize detail screen (existing record)
      * R12926 DN 05/03/18-At Order level, get Absorbed Freight Rate from
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0008           Company Number
     C                     Z-ADDOMBKC7    WL0009           Ship To Custome
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    #DBOCD    P      Type Code
     C                     Z-ADDWL0011    YN0001           Absorbed Freigh
      * Rtv Absorbed Frt Rate RT - Order Header TRG  * 
     C                     EXSR SERVGN
      * Val Manual Price      RT - Company Item  * 
     C                     EXSR SFRVGN
     C                     MOVEL*BLANK    #DRRNA           Price Method De
      * Price Method Desc DRV
      * Rtv Price Method Desc  RT - Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1Q7CD    WL0001    P      Price Method Co
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DRRNA    P      Price Method De
     C                     MOVEL*BLANK    #DTMNA           Commodity Marke
      * Commodity Market Desc DRV
      * RTV Commod. Mkts Desc  RT - Commodity Markets  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1LQCD    WL0003    P      Commodity Marke
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DTMNA    P      Commodity Marke
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) OMAIC3' defaulted for 'Company Number'.
     C                     MOVEL*BLANK    #DTNNA           Date Method Cod
      * Date Method Code Desc DRV
      * Rtv Method Desc       RT - Market Date Method  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0005           Company Number
     C                     MOVEL#1RDCD    WL0006    P      Date Method Cod
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    #DTNNA    P      Date Method Des
     C                     END
      *
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
     C           YPMTFD    IFNE *BLANK
      * Check restriction within
     C                     EXSR VACKRL
     C                     END
      * Check relations
      * Check restriction within
     C                     EXSR VBCKRL
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * Initialise derived fields
     C                     EXSR MFIZ#2
     C                     END
      * Validate Market Pricing Date
      * External date
     C                     Z-ADDV1EXDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
     C                     Z-ADDXDINDT    #1EXDT
      * Validate OD Market Begin Date
      * External date
     C                     Z-ADDV1TKDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9938  *
     C                     END
     C                     Z-ADDXDINDT    #1TKDT
      * Validate OD Market Ending Date
      * External date
     C                     Z-ADDV1TLDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     Z-ADDXDINDT    #1TLDT
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * F4=Prompt
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.Price Code
     C           W0CFL     IFEQ '#1BVTM'                   *IF
      * Sel Customer Prc Hdr  SL - Customer Price Header  * 
     C                     CALL 'POPOSRR'              90  Sel Customer Pr
     C                     PARM *BLANK    W0RTN   7
     C           #1BKC7    PARM #1BKC7    WQ0010  70       Ship To Custome
     C           #1BVTM    PARM #1BVTM    WQ0011  60       Price Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPOSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Edt OD Pricing Dflts  XF - Order Detail  * 
     C                     CALL 'PNS2XFR'              90  Edt OD Pricing
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HGCD    WQ0012  70       Item Code
     C           #1EXDT    PARM #1EXDT    WQ0013  70       Market Pricing
     C           #1LQCD    PARM #1LQCD    WQ0014  3        Commodity Marke
     C           #1RDCD    PARM #1RDCD    WQ0015  3        Date Method Cod
     C           #1Q7CD    PARM #1Q7CD    WQ0016  3        Price Method Co
     C           #1BZPR    PARM #1BZPR    WQ0017 114       Price Overage O
     C           #1BVTM    PARM #1BVTM    WQ0018  60       Price Code
     C           #1DWPR    PARM #1DWPR    WQ0019 114       OD Ceiling Pric
     C           #1TKDT    PARM #1TKDT    WQ0020  70       OD Market Begin
     C           #1TLDT    PARM #1TLDT    WQ0021  70       OD Market Endin
     C                     PARM #1AIC3    WQ0022  30       Company Number
     C                     PARM #1BKC7    WQ0023  70       Ship To Custome
     C                     PARM #DBOCD    WQ0024  2        Type Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNS2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993735*
     C                     SETON                     363132*
     C                     SETON                     343338*
     C                     SETON                     39    *
     C                     END
     C                     MOVEL'N'       YL0008           Error Status
      * Edt OD Pricing Validt IF
     C                     Z-ADD0         #1ALPR           Unit Price - Cr
      * RTV PrcMthTyp/PrcTyp  XF - Price Method Header  * 
     C                     CALL 'PNS7XFR'              90  RTV PrcMthTyp/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0025  30       Company Number
     C                     PARM #1Q7CD    WQ0026  3        Price Method Co
     C           YL0010    PARM *BLANK    WQ0027  1        Price Method Ty
     C           YL0011    PARM *BLANK    WQ0028  1        PMH Price Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNS7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * Rtv Market Dtls OrEnt XF - IP Item Market Details  * 
     C                     CLEARPARC
     C                     Z-ADD#1HGCD    PAHGCD           Item Code
     C                     MOVEL#1LQCD    PALQCD    P      Commodity Marke
      *
     C                     CALL 'PNS1XFR'              90  Rtv Market Dtls
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: IP Item Ma
     C           YL0012    PARM *BLANK    WQ0029  7        Commodity Price
     C           YL0013    PARM *ZERO     WQ0030  94       Market Prem/Ded
     C           YL0014    PARM *BLANK    WQ0031  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNS1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     MOVEL'N'       YL0009           USR Display 4
      * LCL.Commodity Price Group & LCL.Market Overage
      * CASE: LCL.Record Found USR is Record Found
     C           YL0014    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0013    YL0015           Market Overage
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0003    YL0012           Commodity Price
     C                     Z-ADDYL0002    YL0015           Market Overage
     C                     END                             *FI
      * VAL: Price Method Code
      * CASE: PAR.Price Method Code is Blank
     C           #1Q7CD    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     MOVEL#1Q7CD    ZA0001           Price Method Co
      * Send message 'Value Required (alpha)'
     C                     MOVEL'USR2808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * VAL: Price Code
      * CASE: PAR.Price Code is Entered
     C           #1BVTM    IFGT 0                          *IF
      * VAL: Price Code
      * CASE: LCL.Price Method Type is Not Contract
     C           YL0010    IFEQ 'X'                        *IF
     C           YL0010    OREQ 'F'
     C           YL0010    OREQ 'M'
     C           YL0010    OREQ 'K'
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0002           Price Code
     C                     MOVEL#1Q7CD    ZA0003           Price Method Co
      * Send message 'Price Code Inv for Mthd'
     C                     MOVEL'USR4338' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993431*
      *
      * CASE: PAR.USR Display 4 is No
     C           YL0009    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       YL0009           USR Display 4
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Cust Prc Str/End  XF - Customer Price Header  * 
     C                     CALL 'PNTAXFR'              90  Rtv Cust Prc St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1BKC7    WQ0032  70       Ship To Custome
     C                     PARM #1BVTM    WQ0033  60       Price Code
     C           YL0016    PARM *ZERO     WQ0034  70       Price Start Dat
     C           YL0017    PARM *ZERO     WQ0035  70       Price End Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNTAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
      * CASE: LCL.Price Start Date is Not Entered
     C           YL0016    IFEQ 0                          *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0004           Price Code
      * Send message 'Price Code not val f/cust'
     C                     MOVEL'USR3318' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL: Contract Start & End Date
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Scheduled Ship Date LT LCL.Price Start Date
      *   |- c2    : PAR.Scheduled Ship Date GT LCL.Price End Date
      *   '-
     C           #1AODT    IFLT YL0016                     *IF
     C           #1AODT    ORGT YL0017                     *OR
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0005           Price Code
      * Send message 'Price Code not val dt rng'
     C                     MOVEL'USR3317' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
      * Rtv Max Wt and price  XF - Customer Price Detail  * 
     C                     CALL 'PNTBXFR'              90  Rtv Max Wt and
     C                     PARM *BLANK    W0RTN   7
     C           W0RTN     PARM *BLANK    WQ0036  7        *Return code
     C                     PARM #1BKC7    WQ0037  70       Ship To Custome
     C                     PARM #1BVTM    WQ0038  60       Price Code
     C                     PARM #1HGCD    WQ0039  70       Item Code
     C           YL0018    PARM *ZERO     WQ0040 112       Maximum Contrac
     C           YL0019    PARM *ZERO     WQ0041 114       Customer Price
     C           YL0020    PARM *BLANK    WQ0042  3        Commodity Marke
     C           YL0021    PARM *BLANK    WQ0043  3        Price Method Co
     C           YL0022    PARM *BLANK    WQ0044  3        Date Method Cod
     C           YL0023    PARM *BLANK    WQ0045  1        Contract Unit T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNTBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0006           Price Code
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0007           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0007           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code not val f/item'
     C                     MOVEL'USR3319' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Sum weights shipped/ordered for ship to /price code
      *
     C                     Z-ADD*ZERO     WN0001 112       Total Weight Or
     C                     Z-ADD*ZERO     WN0002 112       Total Quantity
     C                     Z-ADD*ZERO     WN0003 112       Maximum Contrac
     C                     Z-ADD*ZERO     WN0004 114       Customer Price
     C                     MOVEL*BLANK    WN0005  1        Contract Unit T
      *
      * Clc Sum Ship/Ord Unit IF
     C                     MOVEL'N'       YL0008           Error Status
     C           #1AVQT    MULT #1AVWG    YL0024           Weight Ordered
      * CLC Sum Ship/Ord Unit XF - Order Detail  * 
     C                     CLEARPBRC
     C                     Z-ADD#1BKC7    PBBKC7           Ship To Custome
     C                     Z-ADD#1BVTM    PBBVTM           Price Code
     C                     Z-ADD#1HGCD    PBHGCD           Item Code
      *
     C                     CALL 'PPA6XFR'              90  CLC Sum Ship/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Order Deta
     C           WN0001    PARM WN0001    WQ0046 112       Total Weight Or
     C                     PARM #1C4NB    WQ0047  70       Order Number
     C           WN0002    PARM WN0002    WQ0048 112       Total Quantity
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     ADD  YL0024    WN0001           Total Weight Or
     C                     ADD  #1AVQT    WN0002           Total Quantity
      * 5/13/10 SAZ P205-Add parm for Max Unit Type;rtv Contract Unit Typ
      * Rtv Cust Prc hdr/dtl  XF - Customer Price Header  * 
     C                     CALL 'PPA7XFR'              90  Rtv Cust Prc hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1BKC7    WQ0049  70       Ship To Custome
     C                     PARM #1BVTM    WQ0050  60       Price Code
     C           WUPLDT    PARM *ZERO     WQ0051  70       Price Start Dat
     C           WUPMDT    PARM *ZERO     WQ0052  70       Price End Date
     C                     PARM #1HGCD    WQ0053  70       Item Code
     C           WN0003    PARM *ZERO     WQ0054 112       Maximum Contrac
     C           WN0004    PARM *ZERO     WQ0055 114       Customer Price
     C           #1LQCD    PARM *BLANK    WQ0056  3        Commodity Marke
     C           YL0025    PARM *BLANK    WQ0057  3        Price Method Co
     C           #1RDCD    PARM *BLANK    WQ0058  3        Date Method Cod
     C           WN0005    PARM *BLANK    WQ0059  1        Contract Unit T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993435*
     C                     SETON                     36    *
     C                     END
     C                     MOVELYL0025    #1Q7CD           Price Method Co
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
     C                     EXSR SGRVGN
      * 5/13/10 SAZ P205-Use Contract Unit Type to check Qty or Weight-Lb
      * Use Contract Unit Type to check Qty or Weight-Lbs
      * VAL: Total Weight and Quantity w/Maximum
      * CASE: PAR.Contract Unit Type is Weight-LB
     C           WN0005    IFEQ 'W'                        *IF
      * CASE: PAR.Total Weight Ordered USR GT PAR.Maximum Contract Units
     C           WN0001    IFGT WN0003                     *IF
     C                     MOVEL'Y'       YL0008           Error Status
     C           WN0001    SUB  WN0003    YL0026           Weight Allocate
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0008           Price Code
     C                     Z-ADDYL0026    ZA0009           Weight Allocate
     C                     Z-ADDWN0003    ZA0010           Maximum Contrac
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0011           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0011           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code max wgt exceed'
     C                     MOVEL'USR3320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If Contract Unit type = Quantity
      * CASE: PAR.Total Quantity Ordered GT PAR.Maximum Contract Units
     C           WN0002    IFGT WN0003                     *IF
     C                     MOVEL'Y'       YL0008           Error Status
     C           WN0002    SUB  WN0003    YL0026           Weight Allocate
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0012           Price Code
     C                     Z-ADDYL0026    ZA0013           Weight Allocate
     C                     Z-ADDWN0003    ZA0014           Maximum Contrac
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0015           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0015           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code max wgt exceed'
     C                     MOVEL'USR3320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Original code
      * OUT: No Errors
      * CASE: PAR.Error Status is no
     C           YL0008    IFEQ 'N'                        *IF
     C                     Z-ADDWN0004    #1BZPR           Price Overage O
      * CASE: PAR.PMH Price Type is Invoice Price
     C           YL0011    IFEQ 'I'                        *IF
     C                     Z-ADDWN0004    #1BZPR           Price Overage O
     C                     Z-ADD0         #1DWPR           OD Ceiling Pric
     C                     ELSE
      * CASE: PAR.PMH Price Type is Ceiling Price
     C           YL0011    IFEQ 'C'                        *IF
     C                     Z-ADD0         #1BZPR           Price Overage O
     C                     Z-ADDWN0004    #1DWPR           OD Ceiling Pric
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL: Price Code Required
      * CASE: LCL.Price Method Type is Contract Pricing
     C           YL0010    IFEQ 'Q'                        *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     MOVEL#1Q7CD    ZA0016           Price Method Co
     C                     Z-ADD#1BVTM    ZA0017           Price Code
      * Send message 'Price code req for mthd'
     C                     MOVEL'USR3316' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993134*
      *
      * CASE: PAR.USR Display 4 is No
     C           YL0009    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       YL0009           USR Display 4
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Market Price Date/Range
      * CASE:
      *  - c1 AND (c2ORc3)
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1EXDT    IFNE 0                          *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #1TKDT    IFNE 0                          *IF
     C           #1TLDT    ORNE 0                          *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #1EXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0018
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0019
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0020
      * Send message 'Market Date/Range ERR'
     C                     MOVEL'USR4331' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993738*
     C                     SETON                     39    *
      *
     C                     ELSE
      * CASE: PAR.OD Market Begin Date GT PAR.OD Market Ending Date
     C           #1TKDT    IFGT #1TLDT                     *IF
      * CASE: PAR.OD Market Ending Date is not entered
     C           #1TLDT    IFEQ 0                          *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0021
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0022
      * Send message 'Date Range Invalid'
     C                     MOVEL'USR4332' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993839*
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Price Method Type = Published
      * CASE: LCL.Price Method Type is Published Pricing
     C           YL0010    IFEQ 'P'                        *IF
      * VAL: Price Overage Override
      * CASE: PAR.Price Overage Override is Not Zeros
     C           #1BZPR    IFNE 0                          *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     Z-ADD#1BZPR    ZA0023           Price Overage O
      * Send message 'Price Override not allow'
     C                     MOVEL'USR1807' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     MOVEL'SBD'     #1LQCD           Commodity Marke
      * VAL: Date Method Code
      * CASE: PAR.Date Method Code is Entered
     C           #1RDCD    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     MOVEL#1RDCD    ZA0024           Date Method Cod
      * Send message 'Date Meth Code not allow'
     C                     MOVEL'USR1808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
      * VAL: Ceiling Price
      * CASE: PAR.OD Ceiling Price is Not Zeros
     C           #1DWPR    IFNE 0                          *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     Z-ADD#1DWPR    ZA0025           OD Ceiling Pric
      * Send message 'Ceiling Price Invalid'
     C                     MOVEL'USR4333' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * VAL: Market Date or Date Range
      * CASE:
      *  - c2 OR c3
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C           #1TKDT    IFNE 0                          *IF
     C           #1TLDT    ORNE 0                          *OR
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0026
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0027
     C                     MOVEL#1Q7CD    ZA0028           Price Method Co
      * Send message 'Prc Date Range Inv'
     C                     MOVEL'USR4344' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993839*
     C                     SETON                     31    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Price Method Type = Manual/Extended
      * CASE:
      *  - c1 OR c3
      *   |- c1    : LCL.Price Method Type is Manual Pricing
      *   |- c3    : LCL.Price Method Type is Extended Pricing
      *   '-
     C           YL0010    IFEQ 'M'                        *IF
     C           YL0010    OREQ 'X'                        *OR
      * VAL: Price Overage Override for Price Method Type=Extended
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override is Equal zero
      *   |- c2    : LCL.Price Method Type is Extended Pricing
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BZPR    IFEQ 0                          *IF
     C           YL0010    IFEQ 'X'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     Z-ADD#1BZPR    ZA0029           Price Overage O
      * Send message 'Price Override Required'
     C                     MOVEL'USR1805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
      * VAL: Commodity Market Code
      * CASE: PAR.Commodity Market Code is Entered
     C           #1LQCD    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     MOVEL#1LQCD    ZA0030           Commodity Marke
      * Send message 'Market Code not allowed'
     C                     MOVEL'USR1809' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
      * VAL: Date Method Code
      * CASE: PAR.Date Method Code is Entered
     C           #1RDCD    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     MOVEL#1RDCD    ZA0031           Date Method Cod
      * Send message 'Date Meth Code not allow'
     C                     MOVEL'USR1808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
      * VAL: Ceiling Price
      * CASE: PAR.OD Ceiling Price is Not Zeros
     C           #1DWPR    IFNE 0                          *IF
      * Setup message data for message
     C                     Z-ADD#1DWPR    ZA0032           OD Ceiling Pric
      * Send message 'Ceiling Price Invalid'
     C                     MOVEL'USR4333' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     Z-ADD0         #1DWPR           OD Ceiling Pric
     C                     END                             *FI
      * VAL: Market Date or Date Range
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C           #1EXDT    IFNE 0                          *IF
     C           #1TKDT    ORNE 0                          *OR
     C           #1TLDT    ORNE 0                          *OR
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #1EXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0033
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0034
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0035
     C                     MOVEL#1Q7CD    ZA0036           Price Method Co
      * Send message 'Prc Dts = 0 f/Prc Mth'
     C                     MOVEL'USR4339' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993738*
     C                     SETON                     3931  *
      *
     C                     END                             *FI
      * VAL: Manual Pricing
      * CASE: LCL.Price Method Type is Manual Pricing
     C           YL0010    IFEQ 'M'                        *IF
      * VAL: Manual Price Range
      * CASE: PAR.Billing Activity Type is Not Warehouse Transfer
     C           '1'       IFEQ '2'                        *IF
     C           '1'       OREQ '3'
     C           '1'       OREQ '1'
      * CASE: PAR.Primal Group Code is NE Samples or Cut Loss
     C           YL0004    IFNE 'UNID'                     *IF
      * RMC S14013 remove chk for type n= Promo/Samples- we want them val
      *
     C                     Z-ADD*ZERO     WN0006  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0007  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0008  74       Percent 7.4 USR
     C                     Z-ADD*ZERO     WN0009 114       Price Adjustmen
      *
      * VAL Manual Price Range IF
      * *---------------------------------------------------------------*
      * Documentation:
      * This internal function will determine if a manual price entered
      * on an order detail line is within the Manual Pricing Acceptance
      * Percentage from the Company Control file. If it does not fall
      * within the percentage range then the market price will be used.
      * If no market price is found then it is a manual price error
      * *---------------------------------------------------------------*
     C                     Z-ADD0         YL0027           Projected Marke
     C                     Z-ADD0         YL0029           Minimum Price
     C                     Z-ADD0         YL0030           Maximum Price
     C                     MOVEL'Y'       YL0028           Error Status  3
      * RTV Manual Price Accpt RT - Company Control  * 
     C                     EXSR SHRVGN
      * Food Service and Co-Pack Items
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Default Commod Mark basis is Food Service
      *   |- c2    : PAR.Default Commod Mark basis is Co-Pack
      *   '-
     C           YL0001    IFEQ 'FSV'                      *IF
     C           YL0001    OREQ 'CPK'                      *OR
     C                     Z-ADDWN0007    WN0006           Manual Price Ac
     C                     END                             *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1LQCD    WL0012    P      Commodity Marke
     C                     MOVELYL0012    WL0013    P      Commodity Price
     C                     Z-ADD9999999   WL0014           Market Price Da
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    YL0027           Commodity Marke
     C                     Z-ADDWL0016    WUE7DT           USR Date Priced
      * Projected Market Price
      * PAR.Projected Market Price =
      *    *COMPUTE (x1 + x2 + (x3 / x4))
      * x1    : PAR.Projected Market Price
      * +     : PGM.*Synon (15,5) work field
      * x2    : PAR.Standard Overage/Underage
      * +     : PGM.*Synon (15,5) work field
      * x3    : PAR.Absorbed Freight Rate CWT
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           YL0027    ADD  YL0015    W0WB01           *Synon (15,5) w
     C           #DTBNB    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WB01    ADD  W0WB02    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0027           Projected Marke
      * If a market price is found for co/cust market code default
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x4 - (x1 / x2)) * x3))
      * x4    : CON.1
      * -     : PGM.*Synon (17,7) work field
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0006    DIV  100       W0WD02    H      *Synon (17,7) w
     C           1         SUB  W0WD02    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT YL0027    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0029           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0006    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT YL0027    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0030           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BZPR    IFGE YL0029                     *IF
     C           #1BZPR    IFLE YL0030                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0028           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If no price for co/cust market code then use co/item market code
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0001    WL0012    P      Commodity Marke
     C                     MOVELYL0012    WL0013    P      Commodity Price
     C                     Z-ADD9999999   WL0014           Market Price Da
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    YL0027           Commodity Marke
     C                     Z-ADDWL0016    WUE7DT           USR Date Priced
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0006    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT YL0027    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0029           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0006    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT YL0027    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0030           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BZPR    IFGE YL0029                     *IF
     C           #1BZPR    IFLE YL0030                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0028           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         YL0027           Projected Marke
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDYL0027    #1ALPR           Unit Price - Cr
     C                     END                             *FI
      * CASE: LCL.Error Status  3 is Yes
     C           YL0028    IFEQ 'Y'                        *IF
      * CASE: LCL.Projected Market Price is Not Zeros
     C           YL0027    IFNE 0                          *IF
      * Setup message data for message
     C                     Z-ADD#1BZPR    ZA0037           Price Overage O
      * Send message 'Manual price within Prcnt'
     C                     MOVEL'USR2351' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     Z-ADD#1BZPR    ZA0038           Price Overage O
     C                     MOVEL#1LQCD    ZA0039           Commodity Marke
     C                     MOVELYL0003    ZA0040           Commodity Price
      * Send message 'No Mkt Prc Found for test'
     C                     MOVEL'USR2353' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993235*
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Price Method Type = Contract
      * CASE: LCL.Price Method Type is Contract Pricing
     C           YL0010    IFEQ 'Q'                        *IF
      * VAL: Commodity Market Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Commodity Market Code is Entered
      *   |- c2    : LCL.PMH Price Type is Invoice Price
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1LQCD    IFNE *BLANK                     *IF
     C           YL0011    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     MOVEL#1LQCD    ZA0041           Commodity Marke
      * Send message 'Market Code not allowed'
     C                     MOVEL'USR1809' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
      * VAL: Date Method Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Date Method Code is Entered
      *   |- c2    : LCL.PMH Price Type is Invoice Price
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1RDCD    IFNE *BLANK                     *IF
     C           YL0011    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     MOVEL#1RDCD    ZA0042           Date Method Cod
      * Send message 'Date Meth Code not allow'
     C                     MOVEL'USR1808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
      * VAL: Ceiling Price
      * CASE: LCL.PMH Price Type is Invoice Price
     C           YL0011    IFEQ 'I'                        *IF
      * ERR: Ceiling Price not allowed
      * CASE: PAR.OD Ceiling Price is Not Zeros
     C           #1DWPR    IFNE 0                          *IF
      * Setup message data for message
     C                     Z-ADD#1DWPR    ZA0043           OD Ceiling Pric
      * Send message 'Ceiling Price Invalid'
     C                     MOVEL'USR4333' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     Z-ADD0         #1DWPR           OD Ceiling Pric
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ERR: Ceiling Price Required
      * CASE: PAR.OD Ceiling Price is Equal zero
     C           #1DWPR    IFEQ 0                          *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     Z-ADD#1DWPR    ZA0044           OD Ceiling Pric
      * Send message 'Ceiling Price Required'
     C                     MOVEL'USR4340' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     Z-ADD#1DWPR    #1ALPR           Unit Price - Cr
     C                     END                             *FI
      * VAL: Market Date or Date Range
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C           #1EXDT    IFNE 0                          *IF
     C           #1TKDT    ORNE 0                          *OR
     C           #1TLDT    ORNE 0                          *OR
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #1EXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0045
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0046
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0047
     C                     MOVEL#1Q7CD    ZA0048           Price Method Co
      * Send message 'Prc Dts = 0 f/Prc Mth'
     C                     MOVEL'USR4339' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993738*
     C                     SETON                     3931  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Price Method Type = Market/Formula
      * CASE: LCL.Price Method Type is Market or Formula
     C           YL0010    IFEQ 'F'                        *IF
     C           YL0010    OREQ 'K'
      * VAL: Price Overage Override
      * CASE: PAR.Price Overage Override is Not Zeros
     C           #1BZPR    IFNE 0                          *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     Z-ADD#1BZPR    ZA0049           Price Overage O
      * Send message 'Price Override not allow'
     C                     MOVEL'USR1807' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
      * VAL: Commodity Market Code
      * CASE: PAR.Commodity Market Code is Not Entered
     C           #1LQCD    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     MOVEL#1LQCD    ZA0050           Commodity Marke
      * Send message 'Market Code must be enter'
     C                     MOVEL'USR1750' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
      * VAL: Date Method Code
      * CASE: PAR.Date Method Code is Entered
     C           #1RDCD    IFNE *BLANK                     *IF
      * VAL Date Method Exists RT - Market Date Method  * 
     C                     EXSR SJRVGN
      * ERR: Date Method Code Invalid
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     MOVEL#1RDCD    ZA0051           Date Method Cod
      * Send message 'Market Date Method Inval.'
     C                     MOVEL'USR2161' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ERR: Date Method Entered & Market Price Date/Range Entered
      * CASE:
      *  - (c1 AND c2) OR (c1 AND c3 AND c4)
      *   |- c1    : PAR.Date Method Code is Entered
      *   |- c2    : PAR.Market Pricing Date is NE Zero
      *   |- c3    : PAR.OD Market Begin Date is Entered
      *   |- c4    : PAR.OD Market Ending Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1RDCD    IFNE *BLANK                     *IF
     C           #1EXDT    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1RDCD    IFNE *BLANK                     *IF
     C           #1TKDT    IFNE 0                          *IF
     C           #1TLDT    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #1EXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0052
     C                     MOVEL#1RDCD    ZA0053           Date Method Cod
      * Send message 'Date Meth & Prc Dat N/A'
     C                     MOVEL'USR2097' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993736*
      *
     C                     END                             *FI
      * ERR: Date Method = Blank and Market Price Date/Rage = Zero
      * CASE: (No Market Dates Entered)
      *  - c1ANDc2ANDc3ANDc4
      *   |- c1    : PAR.Date Method Code is Not Entered
      *   |- c2    : PAR.Market Pricing Date is EQ Zero
      *   |- c3    : PAR.OD Market Begin Date is not entered
      *   |- c4    : PAR.OD Market Ending Date is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1RDCD    IFEQ *BLANK                     *IF
     C           #1EXDT    IFEQ 0                          *IF
     C           #1TKDT    IFEQ 0                          *IF
     C           #1TLDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     MOVEL#1RDCD    ZA0054           Date Method Cod
      * Send message 'Market Date Method Inval.'
     C                     MOVEL'USR2161' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
      * ERR: Market Price Date & Market Price Date Range Entered
      * CASE:
      *  - c1 AND (c2ORc3)
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1EXDT    IFNE 0                          *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #1TKDT    IFNE 0                          *IF
     C           #1TLDT    ORNE 0                          *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #1EXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0055
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0056
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0057
      * Send message 'Market Date/Range ERR'
     C                     MOVEL'USR4331' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993738*
     C                     SETON                     39    *
      *
     C                     END                             *FI
      * ERR: Market Price Begin Date > Market Price Ending Date
      * CASE: PAR.OD Market Begin Date GT PAR.OD Market Ending Date
     C           #1TKDT    IFGT #1TLDT                     *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0058
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0059
      * Send message 'Date Range Invalid'
     C                     MOVEL'USR4332' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993839*
      *
     C                     END                             *FI
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1LQCD    WL0017    P      Commodity Marke
     C                     MOVELYL0012    WL0018    P      Commodity Price
     C                     EXSR SKRVGN
      * VAL: Commodity Market Price Exists
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * CASE: PAR.Commodity Market Code NE PAR.Default Commod Mark basis
     C           #1LQCD    IFNE YL0001                     *IF
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0001    WL0017    P      Commodity Marke
     C                     MOVELYL0012    WL0018    P      Commodity Price
     C                     EXSR SKRVGN
      * Use Company Item
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     MOVEL#1LQCD    ZA0060           Commodity Marke
     C                     MOVELYL0012    ZA0061           Commodity Price
      * Send message 'No Price for Mkt/Group'
     C                     MOVEL'USR2349' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1LQCD    ZA0062           Commodity Marke
     C                     MOVELYL0012    ZA0063           Commodity Price
     C                     MOVELYL0001    ZA0064           Default Commod
      * Send message 'No Price Mkt/Group Deflt'
     C                     MOVEL'USR2350' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0008           Error Status
      * Setup message data for message
     C                     MOVEL#1LQCD    ZA0065           Commodity Marke
     C                     MOVELYL0012    ZA0066           Commodity Price
      * Send message 'No Price for Mkt/Group'
     C                     MOVEL'USR2349' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Error Status is no
     C           YL0008    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END
      * Check relations
      * Check reference to Company Item
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Warehouse
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Customer
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Order Group
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Commodity Markets
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9935  *
     C                     END
      * Check reference to Market Date Method
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9936  *
     C                     END
      * Check reference to Price Method Header
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VJCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VKCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Price Audit Reason Cd
     C                     EXSR VLCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VMCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VNCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VOCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Structure Type
     C                     EXSR VPCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Structure Group
     C                     EXSR VQCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Structure Class
     C                     EXSR VRCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Level
     C                     EXSR VSCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Quality Level
     C                     EXSR VTCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Quality Level
     C                     EXSR VUCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Quality Level
     C                     EXSR VVCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to User Profile Control
     C                     EXSR VWCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Country
     C                     EXSR VXCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Event Types
     C                     EXSR VYCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to OP Reason Codes
     C                     EXSR VZCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Sales Route
     C                     EXSR WACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Ham Group
     C                     EXSR WBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Detail screen function fields
     C                     MOVEL*BLANK    #DRRNA           Price Method De
      * Price Method Desc DRV
      * Rtv Price Method Desc  RT - Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1Q7CD    WL0001    P      Price Method Co
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DRRNA    P      Price Method De
     C                     MOVEL*BLANK    #DTMNA           Commodity Marke
      * Commodity Market Desc DRV
      * RTV Commod. Mkts Desc  RT - Commodity Markets  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1LQCD    WL0003    P      Commodity Marke
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DTMNA    P      Commodity Marke
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                     MOVEL*BLANK    #DTNNA           Date Method Cod
      * Date Method Code Desc DRV
      * Rtv Method Desc       RT - Market Date Method  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0005           Company Number
     C                     MOVEL#1RDCD    WL0006    P      Date Method Cod
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    #DTNNA    P      Date Method Des
     C                     END
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * CHG OE Price Details  CH - Order Detail  * 
     C                     EXSR SLCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YARDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
      * Disable key screen
     C                     SETOF                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     Z-ADD*ZERO     #1L6NB           Contract Number
     C                     Z-ADD*ZERO     #1CFC7           Order Group Cod
     C                     MOVEL*BLANK    #1GMST           Detail Line Sta
     C                     MOVEL*BLANK    #1GNST           Detail Line Sta
     C                     Z-ADD*ZERO     #1MAVA           Billing Detail
     C                     Z-ADD*ZERO     #1KDVA           Billing Detail
     C                     Z-ADD*ZERO     #1L8VA           Billing Detail
     C                     Z-ADD*ZERO     #1L9VA           Quantity to Sub
     C                     MOVEL*BLANK    #1GTST           Comment Print A
     C                     MOVEL*BLANK    #1GVST           Comment Print I
     C                     MOVEL*BLANK    #1GUST           Comment Print P
     C                     MOVEL*BLANK    #1QFST           Comment Print S
     C                     Z-ADD*ZERO     #1AYVA           Extended Amount
     C                     MOVEL*BLANK    #1U1ST           Price Status
     C                     Z-ADD*ZERO     #1GIDT           Pricing Date Us
     C                     MOVEL*BLANK    #1CRCD           U/M - Base Pric
     C                     MOVEL*BLANK    #1AGCD           U/M - Ordered
     C                     MOVEL*BLANK    #1RZST           Work Confirm St
     C                     MOVEL*BLANK    #1R0ST           Work Over/Short
     C                     MOVEL*BLANK    #1R1ST           OD Production P
     C                     MOVEL*BLANK    #1G8NA           Order Desc. Lin
     C                     MOVEL*BLANK    #1RPCD           Age Code
     C                     MOVEL*BLANK    #1VEST           Palletize
     C                     MOVEL*BLANK    #1VGST           Slip Sheet
     C                     MOVEL*BLANK    #1AVST           Catch Weight St
     C                     MOVEL*BLANK    #1U0ST           Price Audit
     C                     MOVEL*BLANK    #1RFCD           Price Audit Rea
     C                     MOVEL*BLANK    #1FZST           Production Date
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     Z-ADD*ZERO     #1AVQT           Quantity Ordere
     C                     Z-ADD*ZERO     #1D0WG           Weight Ordered
     C                     Z-ADD*ZERO     #1CCQT           Quantity Schedu
     C                     Z-ADD*ZERO     #1AUWG           Weight Schedule
     C                     Z-ADD*ZERO     #1CBQT           Quantity Shippe
     C                     Z-ADD*ZERO     #1ATWG           Weight Shipped
     C                     Z-ADD*ZERO     #1AQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     #1AGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     #1AKPR           Unit Price
     C                     Z-ADD*ZERO     #1ALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     #1AUPR           Unit Price Orde
     C                     Z-ADD*ZERO     #1AVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     #1A4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     #1GNDT           Actual Shipped
     C                     MOVEL*BLANK    #1AMST           Affect Inventor
     C                     MOVEL*BLANK    #1ANST           Affect Sales Do
     C                     MOVEL*BLANK    #1VAST           Affect Sales Pn
     C                     Z-ADD*ZERO     #1RGNB           Item Structure
     C                     Z-ADD*ZERO     #1RHNB           Item Structure
     C                     Z-ADD*ZERO     #1RINB           Item Structure
     C                     MOVEL*BLANK    #1RBCD           Item Level
     C                     MOVEL*BLANK    #1HICD           Quality Level
     C                     MOVEL*BLANK    #1RNCD           Pricing Product
     C                     MOVEL*BLANK    #1ROCD           Season Product
     C                     Z-ADD*ZERO     #1CXDT           Date of Origina
     C                     MOVEL*BLANK    #1AJVN           User Profile Na
     C                     MOVEL*BLANK    #1KXCD           Country Code
     C                     MOVEL*BLANK    #1JPCD           Event Code
     C                     MOVEL*BLANK    #1CQCD           Reason Code
     C                     MOVEL*BLANK    #1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    #1Z1ST           Modified Flag
     C                     MOVEL*BLANK    #1Z3ST           Substituted Fla
     C                     MOVEL*BLANK    #1Z4ST           OD Schedule Ove
     C                     Z-ADD*ZERO     #1DUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     #1B6VL           Invoice Extende
     C                     Z-ADD*ZERO     #1A1AA           Ham Group Numbe
     C                     MOVEL*BLANK    #1FZSX           OD Adj Type Ove
     C                     MOVEL*BLANK    #1F0SX           Affect Trade Fu
     C                     MOVEL*BLANK    #1F1SX           Affect Commissi
     C                     MOVEL*BLANK    #1F2SX           Affect Pricing
     C                     MOVEL*BLANK    #1F3SX           Released by Use
     C                     MOVEL*BLANK    #1F4SX           Ord TF Exempt C
     C                     MOVEL*BLANK    #1F5SX           OD Pallet Type
     C                     MOVEL*BLANK    #1F6SX           Production Ware
     C                     MOVEL*BLANK    #1F7SX           OD Price Type
     C                     Z-ADD*ZERO     #1NTDT           Warehouse Palle
     C                     Z-ADD*ZERO     #1NUDT           Consumed Item C
     C                     Z-ADD*ZERO     #1NVDT           Deadline Depart
     C                     Z-ADD*ZERO     #1NWDT           OD Price Type R
     C                     Z-ADD*ZERO     #1NXDT           OD Unused Date
     C                     Z-ADD*ZERO     #1BUTM           Deadline Depart
     C                     Z-ADD*ZERO     #1BWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     #1BXTM           Substitution Li
     C                     Z-ADD*ZERO     #1BYTM           Max Qty to sche
     C                     Z-ADD*ZERO     #1H5NX           Warehouse Palle
     C                     Z-ADD*ZERO     #1H6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     #1H7NX           OD Item Target
     C                     Z-ADD*ZERO     #1H8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     #1H9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     #1DVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     #1DXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     #1DYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     #1DZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     #1GSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     #1GTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     #1GUPR           OD Unused Prc 8
     C                     MOVEL*BLANK    #1HOST           OD MPR Sent to
     C                     MOVEL*BLANK    #1HPST           OD MPR Prc Read
     C                     MOVEL*BLANK    #1IOST           OD UnUsed Price
     C                     Z-ADD*ZERO     #1PEWG           Weight Amount E
     C                     Z-ADD*ZERO     #1RINY           Item Age Days
     C                     Z-ADD*ZERO     #1TIDT           Production Ovr
     C                     Z-ADD*ZERO     #1TJDT           Production Ovr
     C                     MOVEL*BLANK    #1H2ST           OD UnUsed Statu
     C                     MOVEL*BLANK    #1H0ST           OD Clm Full Ret
     C                     MOVEL*BLANK    #1H1ST           Order Line Erro
     C                     Z-ADD*ZERO     #1TMDT           OD Atch to Ord
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADD*ZERO     #1A5DT           Requested Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1A5DT
     C                     Z-ADD*ZERO     #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADD*ZERO     #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     MOVEL*BLANK    #DBOCD           Type Code
     C                     Z-ADD*ZERO     #1HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1HGCD
     C                     MOVEL*BLANK    #1G7NA           Order Desc. Lin
     C                     Z-ADD*ZERO     #DTBNB           Absorbed Freigh
     C                     MOVEL*BLANK    #1AJCD           Warehouse Code
     C                     MOVEL*BLANK    #1Q7CD           Price Method Co
     C                     MOVEL*BLANK    #DRRNA           Price Method De
     C                     Z-ADD*ZERO     #1BZPR           Price Overage O
     C                     Z-ADD*ZERO     #1DWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     #1BVTM           Price Code
     C                     MOVEL*BLANK    #1LQCD           Commodity Marke
     C                     MOVEL*BLANK    #DTMNA           Commodity Marke
     C                     MOVEL*BLANK    #1RDCD           Date Method Cod
     C                     MOVEL*BLANK    #DTNNA           Date Method Cod
     C                     Z-ADD*ZERO     #1EXDT           Market Pricing
      * Clear external version also
     C                     Z-ADD*ZERO     V1EXDT
     C                     Z-ADD*ZERO     #1TKDT           OD Market Begin
      * Clear external version also
     C                     Z-ADD*ZERO     V1TKDT
     C                     Z-ADD*ZERO     #1TLDT           OD Market Endin
      * Clear external version also
     C                     Z-ADD*ZERO     V1TLDT
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BGWKL1 fields to screen
      *================================================================
     C                     Z-ADDOMDPNB    #1DPNB           Order Sequence
     C                     Z-ADDOMUENB    #1UENB           Order Secondary
     C                     Z-ADDOML6NB    #1L6NB           Contract Number
     C                     Z-ADDOMCFC7    #1CFC7           Order Group Cod
     C                     MOVELOMGMST    #1GMST           Detail Line Sta
     C                     MOVELOMGNST    #1GNST           Detail Line Sta
     C                     Z-ADDOMMAVA    #1MAVA           Billing Detail
     C                     Z-ADDOMKDVA    #1KDVA           Billing Detail
     C                     Z-ADDOML8VA    #1L8VA           Billing Detail
     C                     Z-ADDOML9VA    #1L9VA           Quantity to Sub
     C                     MOVELOMGTST    #1GTST           Comment Print A
     C                     MOVELOMGVST    #1GVST           Comment Print I
     C                     MOVELOMGUST    #1GUST           Comment Print P
     C                     MOVELOMQFST    #1QFST           Comment Print S
     C                     Z-ADDOMAYVA    #1AYVA           Extended Amount
     C                     MOVELOMU1ST    #1U1ST           Price Status
     C                     Z-ADDOMGIDT    #1GIDT           Pricing Date Us
     C                     MOVELOMCRCD    #1CRCD           U/M - Base Pric
     C                     MOVELOMAGCD    #1AGCD           U/M - Ordered
     C                     MOVELOMRZST    #1RZST           Work Confirm St
     C                     MOVELOMR0ST    #1R0ST           Work Over/Short
     C                     MOVELOMR1ST    #1R1ST           OD Production P
     C                     MOVELOMG8NA    #1G8NA           Order Desc. Lin
     C                     MOVELOMRPCD    #1RPCD           Age Code
     C                     MOVELOMVEST    #1VEST           Palletize
     C                     MOVELOMVGST    #1VGST           Slip Sheet
     C                     MOVELOMAVST    #1AVST           Catch Weight St
     C                     MOVELOMU0ST    #1U0ST           Price Audit
     C                     MOVELOMRFCD    #1RFCD           Price Audit Rea
     C                     MOVELOMFZST    #1FZST           Production Date
     C                     Z-ADDOMR1NB    #1R1NB           Rated Freight
     C                     Z-ADDOMAVQT    #1AVQT           Quantity Ordere
     C                     Z-ADDOMD0WG    #1D0WG           Weight Ordered
     C                     Z-ADDOMCCQT    #1CCQT           Quantity Schedu
     C                     Z-ADDOMAUWG    #1AUWG           Weight Schedule
     C                     Z-ADDOMCBQT    #1CBQT           Quantity Shippe
     C                     Z-ADDOMATWG    #1ATWG           Weight Shipped
     C                     Z-ADDOMAQCS    #1AQCS           Unit Cost Prici
     C                     Z-ADDOMAGCS    #1AGCS           Unit Cost Per P
     C                     Z-ADDOMAKPR    #1AKPR           Unit Price
     C                     Z-ADDOMALPR    #1ALPR           Unit Price - Cr
     C                     Z-ADDOMAUPR    #1AUPR           Unit Price Orde
     C                     Z-ADDOMAVWG    #1AVWG           Unit Weight Ord
     C                     Z-ADDOMA4WG    #1A4WG           Tare Weight Tot
     C                     Z-ADDOMGNDT    #1GNDT           Actual Shipped
     C                     MOVELOMAMST    #1AMST           Affect Inventor
     C                     MOVELOMANST    #1ANST           Affect Sales Do
     C                     MOVELOMVAST    #1VAST           Affect Sales Pn
     C                     Z-ADDOMRGNB    #1RGNB           Item Structure
     C                     Z-ADDOMRHNB    #1RHNB           Item Structure
     C                     Z-ADDOMRINB    #1RINB           Item Structure
     C                     MOVELOMRBCD    #1RBCD           Item Level
     C                     MOVELOMHICD    #1HICD           Quality Level
     C                     MOVELOMRNCD    #1RNCD           Pricing Product
     C                     MOVELOMROCD    #1ROCD           Season Product
     C                     Z-ADDOMCXDT    #1CXDT           Date of Origina
     C                     MOVELOMAJVN    #1AJVN           User Profile Na
     C                     MOVELOMKXCD    #1KXCD           Country Code
     C                     MOVELOMJPCD    #1JPCD           Event Code
     C                     MOVELOMCQCD    #1CQCD           Reason Code
     C                     MOVELOMR4CD    #1R4CD           Sales Route Cod
     C                     MOVELOMZ1ST    #1Z1ST           Modified Flag
     C                     MOVELOMZ3ST    #1Z3ST           Substituted Fla
     C                     MOVELOMZ4ST    #1Z4ST           OD Schedule Ove
     C                     Z-ADDOMDUPR    #1DUPR           Invoice Unit Pr
     C                     Z-ADDOMB6VL    #1B6VL           Invoice Extende
     C                     Z-ADDOMA1AA    #1A1AA           Ham Group Numbe
     C                     MOVELOMFZSX    #1FZSX           OD Adj Type Ove
     C                     MOVELOMF0SX    #1F0SX           Affect Trade Fu
     C                     MOVELOMF1SX    #1F1SX           Affect Commissi
     C                     MOVELOMF2SX    #1F2SX           Affect Pricing
     C                     MOVELOMF3SX    #1F3SX           Released by Use
     C                     MOVELOMF4SX    #1F4SX           Ord TF Exempt C
     C                     MOVELOMF5SX    #1F5SX           OD Pallet Type
     C                     MOVELOMF6SX    #1F6SX           Production Ware
     C                     MOVELOMF7SX    #1F7SX           OD Price Type
     C                     Z-ADDOMNTDT    #1NTDT           Warehouse Palle
     C                     Z-ADDOMNUDT    #1NUDT           Consumed Item C
     C                     Z-ADDOMNVDT    #1NVDT           Deadline Depart
     C                     Z-ADDOMNWDT    #1NWDT           OD Price Type R
     C                     Z-ADDOMNXDT    #1NXDT           OD Unused Date
     C                     Z-ADDOMBUTM    #1BUTM           Deadline Depart
     C                     Z-ADDOMBWTM    #1BWTM           Maximum Net Wei
     C                     Z-ADDOMBXTM    #1BXTM           Substitution Li
     C                     Z-ADDOMBYTM    #1BYTM           Max Qty to sche
     C                     Z-ADDOMH5NX    #1H5NX           Warehouse Palle
     C                     Z-ADDOMH6NX    #1H6NX           Warehouse Avg P
     C                     Z-ADDOMH7NX    #1H7NX           OD Item Target
     C                     Z-ADDOMH8NX    #1H8NX           OD Estimated Gr
     C                     Z-ADDOMH9NX    #1H9NX           OD Maximum Unit
     C                     Z-ADDOMDVPR    #1DVPR           Order Gate/Fina
     C                     Z-ADDOMDXPR    #1DXPR           OD Gate/Final P
     C                     Z-ADDOMDYPR    #1DYPR           OD Weighted Avg
     C                     Z-ADDOMDZPR    #1DZPR           OD Unused Prc 5
     C                     Z-ADDOMGSPR    #1GSPR           OD Unused Prc 6
     C                     Z-ADDOMGTPR    #1GTPR           OD Unused Prc 7
     C                     Z-ADDOMGUPR    #1GUPR           OD Unused Prc 8
     C                     MOVELOMHOST    #1HOST           OD MPR Sent to
     C                     MOVELOMHPST    #1HPST           OD MPR Prc Read
     C                     MOVELOMIOST    #1IOST           OD UnUsed Price
     C                     Z-ADDOMPEWG    #1PEWG           Weight Amount E
     C                     Z-ADDOMRINY    #1RINY           Item Age Days
     C                     Z-ADDOMTIDT    #1TIDT           Production Ovr
     C                     Z-ADDOMTJDT    #1TJDT           Production Ovr
     C                     MOVELOMH2ST    #1H2ST           OD UnUsed Statu
     C                     MOVELOMH0ST    #1H0ST           OD Clm Full Ret
     C                     MOVELOMH1ST    #1H1ST           Order Line Erro
     C                     Z-ADDOMTMDT    #1TMDT           OD Atch to Ord
     C                     MOVELOMUVST    #1UVST           EDI Status 1
     C                     MOVELOMUWST    #1UWST           EDI Status 2
     C                     MOVELOMUXST    #1UXST           EDI Status 3
     C                     Z-ADDOMAATM    #1AATM           Job Time
     C                     MOVELOMAYNA    #1AYNA           User Id
     C                     MOVELOMA0NA    #1A0NA           Job Name
     C                     Z-ADDOMAXDT    #1AXDT           Job Date
     C                     Z-ADDOMAIC3    #1AIC3           Company Number
     C                     Z-ADDOMA5DT    #1A5DT           Requested Ship
     C                     Z-ADDOMC4NB    #1C4NB           Order Number
     C                     Z-ADDOMAODT    #1AODT           Scheduled Ship
     C                     Z-ADDOMBKC7    #1BKC7           Ship To Custome
     C                     Z-ADDOMHGCD    #1HGCD           Item Code
     C                     MOVELOMG7NA    #1G7NA           Order Desc. Lin
     C                     MOVELOMAJCD    #1AJCD           Warehouse Code
     C                     MOVELOMQ7CD    #1Q7CD           Price Method Co
     C                     Z-ADDOMBZPR    #1BZPR           Price Overage O
     C                     Z-ADDOMDWPR    #1DWPR           OD Ceiling Pric
     C                     Z-ADDOMBVTM    #1BVTM           Price Code
     C                     MOVELOMLQCD    #1LQCD           Commodity Marke
     C                     MOVELOMRDCD    #1RDCD           Date Method Cod
     C                     Z-ADDOMEXDT    #1EXDT           Market Pricing
     C                     Z-ADDOMTKDT    #1TKDT           OD Market Begin
     C                     Z-ADDOMTLDT    #1TLDT           OD Market Endin
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     MOVEL*BLANK    #1XIST           Credit Hold
     C                     MOVEL*BLANK    #1XJST           Production Hold
     C                     MOVEL*BLANK    #1GWST           Header Status
     C                     MOVEL*BLANK    #1JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     MOVEL*BLANK    #1U2ST           Export Status
     C                     MOVEL*BLANK    #1HNNA           Ship To City
     C                     MOVEL*BLANK    #1DBCD           Ship To State C
     C                     Z-ADD*ZERO     #1EIDT           Requested Deliv
     C                     Z-ADD*ZERO     #1AFTM           Requested Deliv
     C                     MOVEL*BLANK    #1GJST           Order in Use
     C                     Z-ADDP1DPNB    #1DPNB           Order Sequence
     C                     Z-ADDP1UENB    #1UENB           Order Secondary
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
      * Check restriction within
     C                     EXSR WCCKRL
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MFIZ#2    BEGSR
      *================================================================
      * Initialise derived fields
      *================================================================
     C                     MOVEL*BLANK    #DRRNA           Price Method De
     C                     MOVEL*BLANK    #DTMNA           Commodity Marke
     C                     MOVEL*BLANK    #DTNNA           Date Method Cod
      *================================================================
     CSR         MFEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #1A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1A5DT
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1EIDT
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #1EXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1EXDT
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1TKDT
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1TLDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Price Method Desc  RT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN IHQ7CD    WQSA01           Price Method Co
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Price Method Co
      * Setup key
     C                     MOVELWL0001    WQSA01           Price Method Co
      * Establish starting position
     C           KRSSA     SETLL@IHREU4                    *
     C           KRSSA     READE@IHREU4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Price Method De
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELIHMLNA    WL0002           Price Method De
     C           KRSSA     READE@IHREU4                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Commod. Mkts Desc  RT - Commodity Markets  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           FYLQCD           Commodity Marke
      * Setup key
     C                     MOVELWL0003    FYLQCD           Commodity Marke
      * Establish starting position
     C           KRSSB     CHAIN@FYREDK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1218' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Commodity Marke
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFYJ3NA    WL0004           Commodity Marke
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Method Desc       RT - Market Date Method  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           IPAIC3           Company Number
     C                     KFLD           IPRDCD           Date Method Cod
      * Setup key
     C                     Z-ADDWL0005    IPAIC3           Company Number
     C                     MOVELWL0006    IPRDCD           Date Method Cod
      * Establish starting position
     C           KRSSC     CHAIN@IPRERT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1681' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0007           Date Method Des
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELIPMNNA    WL0007           Date Method Des
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0008    EOAIC3           Company Number
     C                     Z-ADDWL0009    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0010           Type Code
     C                     Z-ADD*ZERO     WL0011           Absorbed Freigh
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOBOCD    WL0010           Type Code
     C                     Z-ADDEOTBNB    WL0011           Absorbed Freigh
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Absorbed Frt Rate RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     #DTBNB           Absorbed Freigh
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDOMAIC3    BEAIC3           Company Number
     C                     Z-ADDOMC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBETBNB    #DTBNB           Absorbed Freigh
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Val Manual Price      RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDOMAIC3    BZAIC3           Company Number
     C                     Z-ADDOMHGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSF     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Default Commod
     C                     Z-ADD*ZERO     YL0002           Market Overage
     C                     MOVEL*BLANK    YL0003           Commodity Price
     C                     MOVEL*BLANK    YL0004           Primal Group Co
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZLNCD    YL0001           Default Commod
     C                     Z-ADDBZBLPR    YL0002           Market Overage
     C                     MOVELBZLRCD    YL0003           Commodity Price
     C                     MOVELBZXRCD    YL0004           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAQ7CD           Price Method Co
      * Setup key
     C                     Z-ADD#1AIC3    WAAIC3           Company Number
     C                     MOVELYL0025    WAQ7CD           Price Method Co
      * Establish starting position
     C           KRSSG     CHAIN@IHRERN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           Price Method Ty
     C                     MOVEL*BLANK    YL0011           PMH Price Type
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAV8ST    YL0010           Price Method Ty
     C                     MOVELWAH3ST    YL0011           PMH Price Type
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Manual Price Accpt RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           ASAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    ASAIC3           Company Number
      * Establish starting position
     C           KRSSH     CHAIN@ASREVL              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0049' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0006           Manual Price Ac
     C                     Z-ADD*ZERO     WN0007           CoPk/FdSrv ManP
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDASAIPC    WN0006           Manual Price Ac
     C                     Z-ADDASASPC    WN0007           CoPk/FdSrv ManP
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN F0LQCD    WQSI01           Commodity Marke
     C           *LIKE     DEFN F0LRCD    WQSI02           Commodity Price
      * Define keylist
     C           KPSSI     KLIST
     C                     KFLD           WQSI01           Commodity Marke
     C                     KFLD           WQSI02           Commodity Price
     C                     KFLD           F0EQDT           Market Price Da
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Commodity Marke
     C                     KFLD           WQSI02           Commodity Price
      * Setup key
     C                     MOVELWL0012    WQSI01           Commodity Marke
     C                     MOVELWL0013    WQSI02           Commodity Price
     C                     Z-ADDWL0014    F0EQDT           Market Price Da
      * Establish starting position
     C           KPSSI     SETLL@F0CPEP                    *
     C           KRSSI     READE@F0CPEP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0015           Commodity Marke
     C                     Z-ADD*ZERO     WL0016           USR Date Priced
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDF0A5PR    WL0015           Commodity Marke
     C                     Z-ADDF0EQDT    WL0016           USR Date Priced
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@F0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * VAL Date Method Exists RT - Market Date Method  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBXST    WQSJ01           System using Da
     C           *LIKE     DEFN WBAIC3    WQSJ02           Company Number
     C           *LIKE     DEFN WBRDCD    WQSJ03           Date Method Cod
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           System using Da
     C                     KFLD           WQSJ02           Company Number
     C                     KFLD           WQSJ03           Date Method Cod
      * Setup key
     C                     MOVEL'O'       WQSJ01           System using Da
     C                     Z-ADD#1AIC3    WQSJ02           Company Number
     C                     MOVEL#1RDCD    WQSJ03           Date Method Cod
      * Establish starting position
     C           KRSSJ     SETLL@IPREFJ                    *
     C           KRSSJ     READE@IPREFJ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1681' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C           KRSSJ     READE@IPREFJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCLQCD    WQSK01           Commodity Marke
     C           *LIKE     DEFN WCLRCD    WQSK02           Commodity Price
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Commodity Marke
     C                     KFLD           WQSK02           Commodity Price
      * Setup key
     C                     MOVELWL0017    WQSK01           Commodity Marke
     C                     MOVELWL0018    WQSK02           Commodity Price
      * Establish starting position
     C           KRSSK     SETLL@F0CPVR                    *
     C           KRSSK     READE@F0CPVR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@F0CPVR                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * CHG OE Price Details  CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0010  70       Item Code
     C                     MOVEL*BLANK    WN0011  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0012  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0013  70       Order Group Cod
     C                     MOVEL*BLANK    WN0014  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0015  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0016 112       Billing Detail
     C                     Z-ADD*ZERO     WN0017 112       Billing Detail
     C                     Z-ADD*ZERO     WN0018 112       Billing Detail
     C                     Z-ADD*ZERO     WN0019 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0020  1        Comment Print A
     C                     MOVEL*BLANK    WN0021  1        Comment Print I
     C                     MOVEL*BLANK    WN0022  1        Comment Print P
     C                     MOVEL*BLANK    WN0023  1        Comment Print S
     C                     Z-ADD*ZERO     WN0024  70       Contract Number
     C                     MOVEL*BLANK    WN0025  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0026  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0027  1        Work Confirm St
     C                     MOVEL*BLANK    WN0028  1        Work Over/Short
     C                     MOVEL*BLANK    WN0029  1        OD Production P
     C                     MOVEL*BLANK    WN0030 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0031 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0032  1        Age Code
     C                     MOVEL*BLANK    WN0033  1        Palletize
     C                     MOVEL*BLANK    WN0034  1        Slip Sheet
     C                     MOVEL*BLANK    WN0035  1        Catch Weight St
     C                     MOVEL*BLANK    WN0036  1        Price Audit
     C                     MOVEL*BLANK    WN0037  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0038  1        Production Date
     C                     Z-ADD*ZERO     WN0039 112       Rated Freight
     C                     Z-ADD*ZERO     WN0040 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0041 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0042 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0043 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0044 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0045 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0046 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0047 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0048 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0049 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0050 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0051  70       Requested Ship
     C                     Z-ADD*ZERO     WN0052  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0053  70       Actual Shipped
     C                     MOVEL*BLANK    WN0054  1        Affect Inventor
     C                     MOVEL*BLANK    WN0055  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0056  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0057  30       Item Structure
     C                     Z-ADD*ZERO     WN0058  30       Item Structure
     C                     Z-ADD*ZERO     WN0059  30       Item Structure
     C                     MOVEL*BLANK    WN0060  2        Item Level
     C                     MOVEL*BLANK    WN0061  2        Quality Level
     C                     MOVEL*BLANK    WN0062  2        Pricing Product
     C                     MOVEL*BLANK    WN0063  2        Season Product
     C                     Z-ADD*ZERO     WN0064  70       Date of Origina
     C                     MOVEL*BLANK    WN0065 10        User Profile Na
     C                     MOVEL*BLANK    WN0066  6        Country Code
     C                     MOVEL*BLANK    WN0067  2        Event Code
     C                     MOVEL*BLANK    WN0068  3        Reason Code
     C                     MOVEL*BLANK    WN0069  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0070  1        Modified Flag
     C                     MOVEL*BLANK    WN0071  1        Substituted Fla
     C                     MOVEL*BLANK    WN0072  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0073 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0074 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0075  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0076  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0077  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0078  1        Affect Commissi
     C                     MOVEL*BLANK    WN0079  1        Affect Pricing
     C                     MOVEL*BLANK    WN0080  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0081  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0082  3        Production Ware
     C                     Z-ADD*ZERO     WN0083  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0084  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0085  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0086  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0087  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0088  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0089  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0090  60       Substitution Li
     C                     Z-ADD*ZERO     WN0091  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0092 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0093 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0094 112       OD Item Target
     C                     Z-ADD*ZERO     WN0095 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0096 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0097 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0098 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0099 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0100 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0101 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0102 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0103 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0104  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0105  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0106  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0107 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0108  40       Item Age Days
     C                     Z-ADD*ZERO     WN0109  70       Production Ovr
     C                     Z-ADD*ZERO     WN0110  70       Production Ovr
     C                     MOVEL*BLANK    WN0111  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0112  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0113  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0114  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0115  1        EDI Status 1
     C                     MOVEL*BLANK    WN0116  1        EDI Status 2
     C                     MOVEL*BLANK    WN0117  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0118  60       Job Time
     C                     MOVEL*BLANK    WN0119 10        User Id
     C                     MOVEL*BLANK    WN0120 10        Job Name
     C                     Z-ADD*ZERO     WN0121  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADD#1AIC3    OMAIC3           Company Number
     C                     Z-ADD#1C4NB    OMC4NB           Order Number
     C                     Z-ADD#1DPNB    OMDPNB           Order Sequence
     C                     Z-ADD#1UENB    OMUENB           Order Secondary
      *
     C           KLCHSL    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
     C           KLCHSL    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     GOTO SLEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADD#1AYVA    OMAYVA           Extended Amount
     C                     Z-ADD#1EXDT    OMEXDT           Market Pricing
     C                     MOVEL#1LQCD    OMLQCD    P      Commodity Marke
     C                     MOVEL#1RDCD    OMRDCD    P      Date Method Cod
     C                     MOVEL#1Q7CD    OMQ7CD    P      Price Method Co
     C                     Z-ADD#1BZPR    OMBZPR           Price Overage O
     C                     MOVEL#1U1ST    OMU1ST    P      Price Status
     C                     Z-ADD#1GIDT    OMGIDT           Pricing Date Us
     C                     Z-ADD#1AKPR    OMAKPR           Unit Price
     C                     Z-ADD#1AUPR    OMAUPR           Unit Price Orde
     C                     MOVEL#1F3SX    OMF3SX    P      Released by Use
     C                     MOVEL#1F7SX    OMF7SX    P      OD Price Type
     C                     Z-ADD#1BVTM    OMBVTM           Price Code
     C                     Z-ADD#1DWPR    OMDWPR           OD Ceiling Pric
     C                     Z-ADD#1TKDT    OMTKDT           OD Market Begin
     C                     Z-ADD#1TLDT    OMTLDT           OD Market Endin
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) OMAATM' defaulted for 'Job Time'.
      * Field '(DB1) OMAYNA' defaulted for 'User Id'.
      * Field '(DB1) OMA0NA' defaulted for 'Job Name'.
      * Field '(DB1) OMAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     OMAATM           Job Time
     C                     MOVEL##USR     OMAYNA           User Id
     C                     MOVEL##JOB     OMA0NA           Job Name
     C                     Z-ADD##JDT     OMAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSM01           Application Cod
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSM01           Application Cod
     C                     MOVEL'O/P'     WQSM01           Application Cod
      * Establish starting position
     C           KRSSM     SETLL@DNRESF                    *
     C           KRSSM     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SNRVGN
     C                     END                             *FI
     C           KRSSM     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSN01           Application Cod
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSN01           Application Cod
      * Establish starting position
     C           KRSSN     SETLL@DNRESF                    *
     C           KRSSN     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSN     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     C           YPMTFD    OREQ '#1DPNB'
     C           YPMTFD    OREQ '#1UENB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1C4NB' defaulted for 'Order Number'.
      * Field '(KEY) #1DPNB' defaulted for 'Order Sequence Number'.
      * Field '(KEY) #1UENB' defaulted for 'Order Secondary Line Seq'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0005' defaulted for 'Item Code'.
      * Field '(LCL) YL0006' defaulted for 'Price Overage Override'.
      * Field '(LCL) YL0007' defaulted for 'Record Selected       USR'.
     C                     CALL 'POKJSRR'              90  Sel Item f/Pric
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0001  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0002  70       Order Number
     C           #1DPNB    PARM *ZERO     WQ0003  30       Order Sequence
     C           #1UENB    PARM *ZERO     WQ0004  30       Order Secondary
     C           YL0005    PARM YL0005    WQ0005  70       Item Code
     C           YL0006    PARM *ZERO     WQ0006 114       Price Overage O
     C           YL0007    PARM YL0007    WQ0007  1        Record Selected
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POKJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1DPNB    IFNE *ZERO                      Order Sequence
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1UENB    IFNE *ZERO                      Order Secondary
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0008  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0009  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VB999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVBBE    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3
     C                     Z-ADD#1C4NB    BEC4NB
     C           KLVBBE    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     MOVELBEJNCD    #1JNCD           Order Type - Sa
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
     C           VB999     TAG
      * Restrictor relation not satisfied
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Company Item
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1HGCD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Item Code
     C           YPMTFD    OREQ '#1HGCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1HGCD' defaulted for 'Item Code'.
     C                     CALL 'PDJISRR'              90  SEL Company/Ite
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0060  30       Company Number
     C           #1HGCD    PARM #1HGCD    WQ0061  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJISRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HGCD    IFNE *ZERO                      Item Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HGCD    IFEQ *ZERO                      Item Code
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCBZ    KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    BZAIC3
     C                     Z-ADD#1HGCD    BZHGCD
     C           KLVCBZ    CHAIN@BZREJU              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Company Item           NF'
     C                     MOVEL'USR0326' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0326' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Warehouse
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AJCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1AJCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AJCD' defaulted for 'Warehouse Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'Accounting Company'.
     C                     CALL 'PMCQSRR'              90  SEL AcctCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #1AJCD    PARM #1AJCD    WQ0062  3        Warehouse Code
     C                     PARM *ZERO     WQ0063  30       Accounting Comp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AJCD    IFEQ *BLANK                     Warehouse Code
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDAD    KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    ADAJCD
     C           KLVDAD    CHAIN@ADREAO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0007' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Customer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1BKC7    WK1X01  1
     C           WK1X01    IFEQ '?'                        Ship To Custome
     C           YPMTFD    OREQ '#1BKC7'
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'A/R Customer Number'.
      * Field '(LCL) YL0031' defaulted for 'G/L Vendor Number USR'.
     C                     CALL 'PMFRSRR'              90  SEL A/R Cust W/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0064  70       A/R Customer Nu
     C           YL0031    PARM *ZERO     WQ0065  80       G/L Vendor Numb
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BKC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BKC7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEBB    KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7
     C           KLVEBB    CHAIN@BBREE9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Order Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1CFC7    IFEQ *ZERO                      Order Group Cod
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFK0    KLIST
     C                     KFLD           K0AIC3           Company Number
     C                     KFLD           K0CFC7           Order Group Cod
      * Setup key
     C                     Z-ADD#1AIC3    K0AIC3
     C                     Z-ADD#1CFC7    K0CFC7
     C           KLVFK0    CHAIN@K0REJ6              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Order Group            NF'
     C                     MOVEL'USR2364' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2364' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Commodity Markets
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1LQCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Commodity Marke
     C           YPMTFD    OREQ '#1LQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1LQCD' defaulted for 'Commodity Market Code'.
     C                     CALL 'PDEDSRR'              90  SEL Commod. Mkt
     C                     PARM *BLANK    W0RTN   7
     C           #1LQCD    PARM #1LQCD    WQ0066  3        Commodity Marke
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEDSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9935  *
     C                     END
      *
     C           #1LQCD    IFNE *BLANK                     Commodity Marke
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1LQCD    IFEQ *BLANK                     Commodity Marke
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGFY    KLIST
     C                     KFLD           FYLQCD           Commodity Marke
      * Setup key
     C                     MOVEL#1LQCD    FYLQCD
     C           KLVGFY    CHAIN@FYREDK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Commodity Markets      NF'
     C                     MOVEL'USR1218' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1218' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Market Date Method
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RDCD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Date Method Cod
     C           YPMTFD    OREQ '#1RDCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1RDCD' defaulted for 'Date Method Code'.
     C                     CALL 'PDKISRR'              90  Sel Market Date
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0067  30       Company Number
     C           #1RDCD    PARM *BLANK    WQ0068  3        Date Method Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKISRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9936  *
     C                     END
      *
     C           #1RDCD    IFNE *BLANK                     Date Method Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RDCD    IFEQ *BLANK                     Date Method Cod
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHIP    KLIST
     C                     KFLD           IPAIC3           Company Number
     C                     KFLD           IPRDCD           Date Method Cod
      * Setup key
     C                     Z-ADD#1AIC3    IPAIC3
     C                     MOVEL#1RDCD    IPRDCD
     C           KLVHIP    CHAIN@IPRERT              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Market Date Method     NF'
     C                     MOVEL'USR1681' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1681' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to Price Method Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1Q7CD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Price Method Co
     C           YPMTFD    OREQ '#1Q7CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1Q7CD' defaulted for 'Price Method Code'.
     C                     CALL 'PDZDSRR'              90  SEL PD Price Me
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0069  30       Company Number
     C           #1Q7CD    PARM #1Q7CD    WQ0070  3        Price Method Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZDSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1Q7CD    IFNE *BLANK                     Price Method Co
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VIEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1Q7CD    IFEQ *BLANK                     Price Method Co
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVIWA    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAQ7CD           Price Method Co
      * Setup key
     C                     Z-ADD#1AIC3    WAAIC3
     C                     MOVEL#1Q7CD    WAQ7CD
     C           KLVIWA    CHAIN@IHRERN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
      * Send message 'Price Method Header    NF'
     C                     MOVEL'USR1665' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1665' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CRCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        U/M - Primary D
     C           YPMTFD    OREQ '#1CRCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1CRCD' defaulted for 'U/M - Base Price'.
     C                     CALL 'PDQWSRR'              90  SEL UM for Clai
     C                     PARM *BLANK    W0RTN   7
     C           #1CRCD    PARM #1CRCD    WQ0071  2        U/M - Primary D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1CRCD    IFNE *BLANK                     U/M - Primary D
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VJEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CRCD    IFEQ *BLANK                     U/M - Primary D
     C                     GOTO VJEXIT
     C                     END
      *
     C           KLVJAM    KLIST
     C                     KFLD           AMHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1CRCD    AMHHCD
     C           KLVJAM    CHAIN@AMREB0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VJEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VJEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         VKCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AGCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        U/M - Primary D
     C           YPMTFD    OREQ '#1AGCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AGCD' defaulted for 'U/M - Ordered'.
     C                     CALL 'PDQWSRR'              90  SEL UM for Clai
     C                     PARM *BLANK    W0RTN   7
     C           #1AGCD    PARM #1AGCD    WQ0072  2        U/M - Primary D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AGCD    IFNE *BLANK                     U/M - Primary D
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VKEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AGCD    IFEQ *BLANK                     U/M - Primary D
     C                     GOTO VKEXIT
     C                     END
      *
     C           KLVKAM    KLIST
     C                     KFLD           AMHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1AGCD    AMHHCD
     C           KLVKAM    CHAIN@AMREB0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VKEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VKEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VKEXIT    ENDSR
      /EJECT
     CSR         VLCKRL    BEGSR
      *================================================================
      * Check reference to Price Audit Reason Cd
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RFCD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Price Audit Rea
     C           YPMTFD    OREQ '#1RFCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1RFCD' defaulted for 'Price Audit Reason Code'.
     C                     CALL 'PDEZSRR'              90  SEL Price Audit
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0073  30       Company Number
     C           #1RFCD    PARM #1RFCD    WQ0074  3        Price Audit Rea
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEZSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RFCD    IFNE *BLANK                     Price Audit Rea
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VLEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RFCD    IFEQ *BLANK                     Price Audit Rea
     C                     GOTO VLEXIT
     C                     END
      *
     C           KLVLIR    KLIST
     C                     KFLD           IRAIC3           Company Number
     C                     KFLD           IRRFCD           Price Audit Rea
      * Setup key
     C                     Z-ADD#1AIC3    IRAIC3
     C                     MOVEL#1RFCD    IRRFCD
     C           KLVLIR    CHAIN@IRRERQ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VLEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VLEXIT
     C                     END
      * Send message 'Price Audit Reason Cd  NF'
     C                     MOVEL'USR1685' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1685' W0RTN
      *================================================================
     CSR         VLEXIT    ENDSR
      /EJECT
     CSR         VMCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1A5DT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VMEXIT
     C                     END
      *
     C           KLVMAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1A5DT    AFBCDT
     C           KLVMAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VMEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VMEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VMEXIT    ENDSR
      /EJECT
     CSR         VNCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1AODT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VNEXIT
     C                     END
      *
     C           KLVNAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1AODT    AFBCDT
     C           KLVNAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VNEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VNEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VNEXIT    ENDSR
      /EJECT
     CSR         VOCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1GNDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VOEXIT
     C                     END
      *
     C           KLVOAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1GNDT    AFBCDT
     C           KLVOAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VOEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VOEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VOEXIT    ENDSR
      /EJECT
     CSR         VPCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Type
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RGNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RGNB' defaulted for 'Item Structure Type Code'.
     C                     CALL 'PDENSRR'              90  SEL Item Type A
     C                     PARM *BLANK    W0RTN   7
     C           #1RGNB    PARM #1RGNB    WQ0075  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDENSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RGNB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VPEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RGNB    IFEQ *ZERO                      Item Structure
     C                     GOTO VPEXIT
     C                     END
      *
     C           KLVPE8    KLIST
     C                     KFLD           E8RGNB           Item Structure
      * Setup key
     C                     Z-ADD#1RGNB    E8RGNB
     C           KLVPE8    CHAIN@E8REBB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VPEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VPEXIT
     C                     END
      * Send message 'Item Structure Type    NF'
     C                     MOVEL'USR1166' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1166' W0RTN
      *================================================================
     CSR         VPEXIT    ENDSR
      /EJECT
     CSR         VQCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RHNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RHNB' defaulted for 'Item Structure Group Code'.
     C                     CALL 'PDEMSRR'              90  SEL Item Group
     C                     PARM *BLANK    W0RTN   7
     C           #1RHNB    PARM #1RHNB    WQ0076  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RHNB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VQEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RHNB    IFEQ *ZERO                      Item Structure
     C                     GOTO VQEXIT
     C                     END
      *
     C           KLVQE9    KLIST
     C                     KFLD           E9RHNB           Item Structure
      * Setup key
     C                     Z-ADD#1RHNB    E9RHNB
     C           KLVQE9    CHAIN@E9REA8              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VQEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VQEXIT
     C                     END
      * Send message 'Item Structure Group   NF'
     C                     MOVEL'USR1168' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1168' W0RTN
      *================================================================
     CSR         VQEXIT    ENDSR
      /EJECT
     CSR         VRCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Class
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RINB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RINB' defaulted for 'Item Structure Class Code'.
     C                     CALL 'PDELSRR'              90  SEL Item Class
     C                     PARM *BLANK    W0RTN   7
     C           #1RINB    PARM #1RINB    WQ0077  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDELSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RINB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VREXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RINB    IFEQ *ZERO                      Item Structure
     C                     GOTO VREXIT
     C                     END
      *
     C           KLVRFA    KLIST
     C                     KFLD           FARINB           Item Structure
      * Setup key
     C                     Z-ADD#1RINB    FARINB
     C           KLVRFA    CHAIN@FAREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VREXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VREXIT
     C                     END
      * Send message 'Item Structure Class   NF'
     C                     MOVEL'USR1170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1170' W0RTN
      *================================================================
     CSR         VREXIT    ENDSR
      /EJECT
     CSR         VSCKRL    BEGSR
      *================================================================
      * Check reference to Item Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RBCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Item Level
     C           YPMTFD    OREQ '#1RBCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RBCD' defaulted for 'Item Level'.
     C                     CALL 'PDBPSRR'              90  SEL PD Item Lev
     C                     PARM *BLANK    W0RTN   7
     C           #1RBCD    PARM #1RBCD    WQ0078  2        Item Level
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RBCD    IFNE *BLANK                     Item Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VSEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RBCD    IFEQ *BLANK                     Item Level
     C                     GOTO VSEXIT
     C                     END
      *
     C           KLVSIL    KLIST
     C                     KFLD           ILRBCD           Item Level
      * Setup key
     C                     MOVEL#1RBCD    ILRBCD
     C           KLVSIL    CHAIN@ILRERK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VSEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VSEXIT
     C                     END
      * Send message 'Item Level             NF'
     C                     MOVEL'USR1673' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1673' W0RTN
      *================================================================
     CSR         VSEXIT    ENDSR
      /EJECT
     CSR         VTCKRL    BEGSR
      *================================================================
      * Check reference to Quality Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1HICD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Quality Level
     C           YPMTFD    OREQ '#1HICD'
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0032' defaulted for 'Record Status'.
     C                     CALL 'PDHJSRR'              90  SEL Rcd Sts-Act
     C                     PARM *BLANK    W0RTN   7
     C           YL0032    PARM YL0032    WQ0079  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HICD    IFNE *BLANK                     Quality Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VTEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HICD    IFEQ *BLANK                     Quality Level
     C                     GOTO VTEXIT
     C                     END
      *
     C           KLVTAI    KLIST
     C                     KFLD           AIHICD           Quality Level
      * Setup key
     C                     MOVEL#1HICD    AIHICD
     C           KLVTAI    CHAIN@AIREBL              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VTEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VTEXIT
     C                     END
      * Send message 'Quality Level          NF'
     C                     MOVEL'USR0024' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0024' W0RTN
      *================================================================
     CSR         VTEXIT    ENDSR
      /EJECT
     CSR         VUCKRL    BEGSR
      *================================================================
      * Check reference to Quality Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RNCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Quality Level
     C           YPMTFD    OREQ '#1RNCD'
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0032' defaulted for 'Record Status'.
     C                     CALL 'PDHJSRR'              90  SEL Rcd Sts-Act
     C                     PARM *BLANK    W0RTN   7
     C           YL0032    PARM YL0032    WQ0080  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RNCD    IFNE *BLANK                     Quality Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VUEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RNCD    IFEQ *BLANK                     Quality Level
     C                     GOTO VUEXIT
     C                     END
      *
     C           KLVUAI    KLIST
     C                     KFLD           AIHICD           Quality Level
      * Setup key
     C                     MOVEL#1RNCD    AIHICD
     C           KLVUAI    CHAIN@AIREBL              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VUEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VUEXIT
     C                     END
      * Send message 'Quality Level          NF'
     C                     MOVEL'USR0024' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0024' W0RTN
      *================================================================
     CSR         VUEXIT    ENDSR
      /EJECT
     CSR         VVCKRL    BEGSR
      *================================================================
      * Check reference to Quality Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ROCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Quality Level
     C           YPMTFD    OREQ '#1ROCD'
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0032' defaulted for 'Record Status'.
     C                     CALL 'PDHJSRR'              90  SEL Rcd Sts-Act
     C                     PARM *BLANK    W0RTN   7
     C           YL0032    PARM YL0032    WQ0081  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ROCD    IFNE *BLANK                     Quality Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VVEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ROCD    IFEQ *BLANK                     Quality Level
     C                     GOTO VVEXIT
     C                     END
      *
     C           KLVVAI    KLIST
     C                     KFLD           AIHICD           Quality Level
      * Setup key
     C                     MOVEL#1ROCD    AIHICD
     C           KLVVAI    CHAIN@AIREBL              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VVEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VVEXIT
     C                     END
      * Send message 'Quality Level          NF'
     C                     MOVEL'USR0024' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0024' W0RTN
      *================================================================
     CSR         VVEXIT    ENDSR
      /EJECT
     CSR         VWCKRL    BEGSR
      *================================================================
      * Check reference to User Profile Control
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AJVN    WK1X01  1
     C           WK1X01    IFEQ '?'                        User Profile Na
     C           YPMTFD    OREQ '#1AJVN'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AJVN' defaulted for 'User Profile Name'.
     C                     CALL 'CAXPSRR'              90  SEL User Profil
     C                     PARM *BLANK    W0RTN   7
     C           #1AJVN    PARM #1AJVN    WQ0082 10        User Profile Na
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAXPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AJVN    IFNE *BLANK                     User Profile Na
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VWEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AJVN    IFEQ *BLANK                     User Profile Na
     C                     GOTO VWEXIT
     C                     END
      *
     C           KLVWDR    KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL#1AJVN    DRAJVN
     C           KLVWDR    CHAIN@DRRETH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VWEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VWEXIT
     C                     END
      * Send message 'User Profile Control   NF'
     C                     MOVEL'USR0763' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0763' W0RTN
      *================================================================
     CSR         VWEXIT    ENDSR
      /EJECT
     CSR         VXCKRL    BEGSR
      *================================================================
      * Check reference to Country
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1KXCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Country Code
     C           YPMTFD    OREQ '#1KXCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1KXCD' defaulted for 'Country Code'.
     C                     CALL 'OMZASRR'              90  SEL Select Coun
     C                     PARM *BLANK    W0RTN   7
     C           #1KXCD    PARM #1KXCD    WQ0083  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMZASRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1KXCD    IFNE *BLANK                     Country Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VXEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1KXCD    IFEQ *BLANK                     Country Code
     C                     GOTO VXEXIT
     C                     END
      *
     C           KLVXE5    KLIST
     C                     KFLD           E5KXCD           Country Code
      * Setup key
     C                     MOVEL#1KXCD    E5KXCD
     C           KLVXE5    CHAIN@E5REB8              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VXEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VXEXIT
     C                     END
      * Send message 'Country                NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1158' W0RTN
      *================================================================
     CSR         VXEXIT    ENDSR
      /EJECT
     CSR         VYCKRL    BEGSR
      *================================================================
      * Check reference to Event Types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1JPCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Event Code
     C           YPMTFD    OREQ '#1JPCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1JPCD' defaulted for 'Event Code'.
     C                     CALL 'PDEQSRR'              90  SEL Event Types
     C                     PARM *BLANK    W0RTN   7
     C           #1JPCD    PARM #1JPCD    WQ0084  2        Event Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1JPCD    IFNE *BLANK                     Event Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VYEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1JPCD    IFEQ *BLANK                     Event Code
     C                     GOTO VYEXIT
     C                     END
      *
     C           KLVYEZ    KLIST
     C                     KFLD           EZJPCD           Event Code
      * Setup key
     C                     MOVEL#1JPCD    EZJPCD
     C           KLVYEZ    CHAIN@EZREYT              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VYEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VYEXIT
     C                     END
      * Send message 'Event Types            NF'
     C                     MOVEL'USR1076' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1076' W0RTN
      *================================================================
     CSR         VYEXIT    ENDSR
      /EJECT
     CSR         VZCKRL    BEGSR
      *================================================================
      * Check reference to OP Reason Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CQCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Reason Code
     C           YPMTFD    OREQ '#1CQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1CQCD' defaulted for 'Reason Code'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1C4NB' defaulted for 'Order Number'.
      * Field '(DTL) #1GWST' defaulted for 'Header Status'.
     C                     CALL 'PDG8SRR'              90  SEL for Order R
     C                     PARM *BLANK    W0RTN   7
     C           #1CQCD    PARM #1CQCD    WQ0085  3        Reason Code
     C                     PARM #1C4NB    WQ0086  70       Order Number
     C                     PARM #1GWST    WQ0087  1        Header Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG8SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1CQCD    IFNE *BLANK                     Reason Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VZEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CQCD    IFEQ *BLANK                     Reason Code
     C                     GOTO VZEXIT
     C                     END
      *
     C           KLVZCX    KLIST
     C                     KFLD           CXCQCD           Reason Code
      * Setup key
     C                     MOVEL#1CQCD    CXCQCD
     C           KLVZCX    CHAIN@CXRENA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VZEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VZEXIT
     C                     END
      * Send message 'OP Reason Codes        NF'
     C                     MOVEL'USR0504' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0504' W0RTN
      *================================================================
     CSR         VZEXIT    ENDSR
      /EJECT
     CSR         WACKRL    BEGSR
      *================================================================
      * Check reference to Sales Route
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1R4CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Sales Route Cod
     C           YPMTFD    OREQ '#1R4CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1R4CD' defaulted for 'Sales Route Code'.
     C                     CALL 'PDFWSRR'              90  SEL PD Sales Ro
     C                     PARM *BLANK    W0RTN   7
     C           #1R4CD    PARM #1R4CD    WQ0088  3        Sales Route Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1R4CD    IFNE *BLANK                     Sales Route Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO WAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1R4CD    IFEQ *BLANK                     Sales Route Cod
     C                     GOTO WAEXIT
     C                     END
      *
     C           KLWAJE    KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL#1R4CD    JER4CD
     C           KLWAJE    CHAIN@JEREWF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO WAEXIT
     C                     END
      * Send message 'Sales Route            NF'
     C                     MOVEL'USR1800' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1800' W0RTN
      *================================================================
     CSR         WAEXIT    ENDSR
      /EJECT
     CSR         WBCKRL    BEGSR
      *================================================================
      * Check reference to Ham Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1A1AA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1A1AA' defaulted for 'Ham Group Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0033' defaulted for 'Exit Selection USR'.
     C                     CALL 'PDVYSRR'              90  SEL Ham Group
     C                     PARM *BLANK    W0RTN   7
     C           #1A1AA    PARM #1A1AA    WQ0089  30       Ham Group Numbe
     C           YL0033    PARM YL0033    WQ0090  1        Exit Selection
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDVYSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1A1AA    IFNE *ZERO                      Ham Group Numbe
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO WBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1A1AA    IFEQ *ZERO                      Ham Group Numbe
     C                     GOTO WBEXIT
     C                     END
      *
     C           KLWBM0    KLIST
     C                     KFLD           M0A1AA           Ham Group Numbe
      * Setup key
     C                     Z-ADD#1A1AA    M0A1AA
     C           KLWBM0    CHAIN@M0REZH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO WBEXIT
     C                     END
      * Send message 'Ham Group              NF'
     C                     MOVEL'USR2837' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2837' W0RTN
      *================================================================
     CSR         WBEXIT    ENDSR
      /EJECT
     CSR         WCCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0091  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0092  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO WC999
     C                     END
     C                     END
      *................................................................
      *
     C           KLWCBE    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3
     C                     Z-ADD#1C4NB    BEC4NB
     C           KLWCBE    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     MOVELBEJNCD    #1JNCD           Order Type - Sa
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     GOTO WCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO WCEXIT
     C                     END
     C           WC999     TAG
      * Restrictor relation not satisfied
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         WCEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDGE033
     C           ZHCSCL    ANDLE035
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1Q7CD'  YPMTFD           Price Method Co
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDGE033
     C           ZHCSCL    ANDLE035
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1LQCD'  YPMTFD           Commodity Marke
     C                     END
      *
     C           ZHCSRW    IFEQ 018
     C           ZHCSCL    ANDGE033
     C           ZHCSCL    ANDLE035
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1RDCD'  YPMTFD           Date Method Cod
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2BOCD           Type Code
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Price Start Date
     C                     Z-ADD*ZERO     WUPLDT  70
      * Define work field Price End Date
     C                     Z-ADD*ZERO     WUPMDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WARMNY           Decimal Places
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field USR Date Priced
     C                     Z-ADD*ZERO     WUE7DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBCPRD           CTL Prior Day
     C                     Z-ADD*ZERO     WBQMNB           CTL Prior Week
     C                     Z-ADD*ZERO     WBCNOT           CTL Number of T
     C                     Z-ADD*ZERO     WBCDOW           CTL Day of Week
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCEQDT           Market Price Da
     C                     Z-ADD*ZERO     WCA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WCB8PR           Projected Marke
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0003  3
     C                     MOVEL*BLANK    WL0004 30
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     MOVEL*BLANK    WL0006  3
     C                     MOVEL*BLANK    WL0007 30
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009  70
     C                     MOVEL*BLANK    WL0010  2
     C                     Z-ADD*ZERO     WL0011  52
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0012  3
     C                     MOVEL*BLANK    WL0013  7
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015 114
     C                     Z-ADD*ZERO     WL0016  70
      * Define local variables for subroutine SKRVGN.
     C                     MOVEL*BLANK    WL0017  3
     C                     MOVEL*BLANK    WL0018  7
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0001  52
      * Define null work field Description Line One
     C                     MOVEL*BLANK    YN0002 30
      * Define local work field Default Commod Mark basis
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field Market Overage
     C                     Z-ADD*ZERO     YL0002 114
      * Define null work field Standard Overage/Underage
     C                     Z-ADD*ZERO     YN0003 114
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0003  7
      * Define null work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     YN0004 112
      * Define local work field Primal Group Code
     C                     MOVEL*BLANK    YL0004  6
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Price Overage Override
     C                     Z-ADD*ZERO     YL0006 114
      * Define local work field Record Selected       USR
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Error Status
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field USR Display 4
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Price Method Type
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field PMH Price Type
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0012  7
      * Define local work field Market Prem/Ded
     C                     Z-ADD*ZERO     YL0013  94
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Market Overage
     C                     Z-ADD*ZERO     YL0015 114
      * Define local work field Price Start Date
     C                     Z-ADD*ZERO     YL0016  70
      * Define local work field Price End Date
     C                     Z-ADD*ZERO     YL0017  70
      * Define local work field Maximum Contract Units
     C                     Z-ADD*ZERO     YL0018 112
      * Define local work field Customer Price /UM Prc
     C                     Z-ADD*ZERO     YL0019 114
      * Define local work field Commodity Market Code USR
     C                     MOVEL*BLANK    YL0020  3
      * Define local work field Price Method Code USR
     C                     MOVEL*BLANK    YL0021  3
      * Define local work field Date Method Code USR
     C                     MOVEL*BLANK    YL0022  3
      * Define local work field Contract Unit Type
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0024 112
      * Define local work field Price Method Code
     C                     MOVEL*BLANK    YL0025  3
      * Define local work field Weight Allocated USR
     C                     Z-ADD*ZERO     YL0026  92
      * Define local work field Projected Market Price
     C                     Z-ADD*ZERO     YL0027 114
      * Define local work field Error Status  3
     C                     MOVEL*BLANK    YL0028  1
      * Define local work field Minimum Price   USR
     C                     Z-ADD*ZERO     YL0029 114
      * Define local work field Maximum Price  USR
     C                     Z-ADD*ZERO     YL0030 114
      * Define null work field Date Method Description
     C                     MOVEL*BLANK    YN0005 30
      * Define local work field G/L Vendor Number USR
     C                     Z-ADD*ZERO     YL0031  80
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field Exit Selection USR
     C                     MOVEL*BLANK    YL0033  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SMRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** KEY Screen: Field position and name array
0105501311
** W0END
0105701317
** W0NAM
V1AIC3    V1C4NB
** W1BEG
01043010960129901352015550157301608
01811018190186402067025930260203105
03361036170412904138046410465004897
0515305162
** W1END
01045011030130501359015610157401615
01817018430186902069025950263103116
03372036220413104167046430467904904
0516005169
** W1NAM
V1AIC3    V1A5DT    V1C4NB    V1AODT    V1BKC7    #DBOCD    V1EIDT
V1HGCD    #1G7NA    #DTBNB    #1AJCD    #1Q7CD    #DRRNA    #1BZPR
#1DWPR    #1BVTM    #1LQCD    #DTMNA    #1RDCD    #DTNNA    V1EXDT
V1TKDT    V1TLDT
** @CN
00001 Y2U0005
