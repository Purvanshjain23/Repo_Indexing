     H/TITLE Edt Enter Issu/Adj Dtl EF Edit file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Maintain database file using subfile display
     H* - Existing records may be updated
     H* - Key changes are not allowed
     H* - New records cannot be added
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Edit file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 09/27/24  Time  : 12:50:39
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FICQ7EFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: Edt Enter Issu/Adj Dtl EF Edit file
      *
     FCAB1REL0IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FCAAMREL1IF  E           K        DISK
      * RTV : Unit of Measure           Retrieval index       NV
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar Master           Retrieval index       NV
      *
     FOMFAREL1IF  E           K        DISK
      * RTV : Item Structure Class      Retrieval index
      *
     FOME9REL0IF  E           K        DISK
      * RTV : Item Structure Group      Retrieval index
      *
     FOME8REL0IF  E           K        DISK
      * RTV : Item Structure Type       Retrieval index
      *
     FPUC6REL1IF  E           K        DISK
      * RTV : OMS Transformation Ctl    Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB7CPLEIF  E           K        DISK
      * RSQ : Item Transaction Detail   Normal KEY Sequence (D)
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FCAB1REL4IF  E           K        DISK
      * RTV : Item Balance Detail       Active only
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FCAB0REL1IF  E           K        DISK
      * RTV : Item Balance              Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAB7CPL0IF  E           K        DISK                      A
      * UPD : Item Transaction Detail   Update index
      *
     FCAB1REL1UF  E           K        DISK                      A
      * UPD : Item Balance Detail       Update index
      *
     FCAB0REL0UF  E           K        DISK
      * UPD : Item Balance              Update index
      *
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  12  6   @CN    25
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WAAIC3
     I              B7HGCD                          WAHGCD
     I              B7AJCD                          WAAJCD
     I              B7W9ST                          WAW9ST
     I              B7BSST                          WABSST
     I              B7B4DT                          WAB4DT
     I              B7C4NY                          WAC4NY
     I              B7DXNB                          WADXNB
     I              B7ELDT                          WAELDT
     I              B7HVCD                          WAHVCD
     I              B7F1ST                          WAF1ST
     I              B7AUNA                          WAAUNA
     I              B7A5QT                          WAA5QT
     I              B7AHWG                          WAAHWG
     I              B7AKCS                          WAAKCS
     I              B7CGCD                          WACGCD
     I              B7AYVA                          WAAYVA
     I              B7BJNA                          WABJNA
     I              B7CKNB                          WACKNB
     I              B7BMST                          WABMST
     I              B7CQCD                          WACQCD
     I              B7DTCD                          WADTCD
     I              B7MGNA                          WAMGNA
     I              B7TRBN                          WATRBN
     I              B7TRBS                          WATRBS
     I              B7C4NB                          WAC4NB
     I              B7RINB                          WARINB
     I              B7RHNB                          WARHNB
     I              B7RGNB                          WARGNB
     I              B7M3NA                          WAM3NA
     I              B7AWTM                          WAAWTM
     I              B7XLCD                          WAXLCD
     I              B7K7DT                          WAK7DT
     I              B7UVST                          WAUVST
     I              B7UWST                          WAUWST
     I              B7UXST                          WAUXST
     I              B7VSST                          WAVSST
     I              B7AATM                          WAAATM
     I              B7AYNA                          WAAYNA
     I              B7A0NA                          WAA0NA
     I              B7AXDT                          WAAXDT
      *
     ICAB1RL4
      * Item Balance Detail       Active only
      * Renamed input format fields
     I              B1AIC3                          WBAIC3
     I              B1HGCD                          WBHGCD
     I              B1AJCD                          WBAJCD
     I              B1ELDT                          WBELDT
     I              B1ABWG                          WBABWG
     I              B1AGQT                          WBAGQT
     I              B1AHQT                          WBAHQT
     I              B1AIQT                          WBAIQT
     I              B1CTST                          WBCTST
     I              B1ACWG                          WBACWG
     I              B1ARQT                          WBARQT
     I              B1ASQT                          WBASQT
     I              B1ATQT                          WBATQT
     I              B1HDQT                          WBHDQT
     I              B1HEQT                          WBHEQT
     I              B1F6ST                          WBF6ST
     I              B1BMWG                          WBBMWG
     I              B1DSQT                          WBDSQT
     I              B1DTQT                          WBDTQT
     I              B1DUQT                          WBDUQT
     I              B1DHDT                          WBDHDT
     I              B1AGCS                          WBAGCS
     I              B1AECS                          WBAECS
     I              B1IDVA                          WBIDVA
     I              B1K7DT                          WBK7DT
     I              B1RINB                          WBRINB
     I              B1RHNB                          WBRHNB
     I              B1RGNB                          WBRGNB
     I              B1UVST                          WBUVST
     I              B1UWST                          WBUWST
     I              B1UXST                          WBUXST
     I              B1VSST                          WBVSST
     I              B1AATM                          WBAATM
     I              B1AYNA                          WBAYNA
     I              B1A0NA                          WBA0NA
     I              B1AXDT                          WBAXDT
      *
     I@B0REJX
      * Item Balance              Retrieval index       NV
      * Renamed input format fields
     I              B0AIC3                          WCAIC3
     I              B0HGCD                          WCHGCD
     I              B0AJCD                          WCAJCD
     I              B0AGCS                          WCAGCS
     I              B0AECS                          WCAECS
     I              B0BACS                          WCBACS
     I              B0BBCS                          WCBBCS
     I              B0CBPR                          WCCBPR
     I              B0GUDT                          WCGUDT
     I              B0XYST                          WCXYST
     I              B0CTPR                          WCCTPR
     I              B0G4DT                          WCG4DT
     I              B0BOWG                          WCBOWG
     I              B0DDQT                          WCDDQT
     I              B0DEQT                          WCDEQT
     I              B0DFQT                          WCDFQT
     I              B0HDQT                          WCHDQT
     I              B0HEQT                          WCHEQT
     I              B0AJQT                          WCAJQT
     I              B0AQQT                          WCAQQT
     I              B0AUQT                          WCAUQT
     I              B0EMQT                          WCEMQT
     I              B0DOQT                          WCDOQT
     I              B0ATNA                          WCATNA
     I              B0AKDT                          WCAKDT
     I              B0ANDT                          WCANDT
     I              B0IDVA                          WCIDVA
     I              B0JVST                          WCJVST
     I              B0BZPC                          WCBZPC
     I              B0DGQT                          WCDGQT
     I              B0DIDT                          WCDIDT
     I              B0ALCD                          WCALCD
     I              B0BFDY                          WCBFDY
     I              B0DJDT                          WCDJDT
     I              B0BGDY                          WCBGDY
     I              B0DKDT                          WCDKDT
     I              B0J2ST                          WCJ2ST
     I              B0DJQT                          WCDJQT
     I              B0BNWG                          WCBNWG
     I              B0DLDT                          WCDLDT
     I              B0DPQT                          WCDPQT
     I              B0DQQT                          WCDQQT
     I              B0DMDT                          WCDMDT
     I              B0M0ST                          WCM0ST
     I              B0J9ST                          WCJ9ST
     I              B0KBST                          WCKBST
     I              B0AKC8                          WCAKC8
     I              B0RINB                          WCRINB
     I              B0RHNB                          WCRHNB
     I              B0RGNB                          WCRGNB
     I              B0UVST                          WCUVST
     I              B0UWST                          WCUWST
     I              B0UXST                          WCUXST
     I              B0VSST                          WCVSST
     I              B0AATM                          WCAATM
     I              B0AYNA                          WCAYNA
     I              B0A0NA                          WCA0NA
     I              B0AXDT                          WCAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Current/previous master file format fields for change control
      *
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WAAIC3
     I              B7HGCD                          WAHGCD
     I              B7AJCD                          WAAJCD
     I              B7W9ST                          WAW9ST
     I              B7BSST                          WABSST
     I              B7B4DT                          WAB4DT
     I              B7C4NY                          WAC4NY
     I              B7DXNB                          WADXNB
     I              B7ELDT                          WAELDT
     I              B7HVCD                          WAHVCD
     I              B7F1ST                          WAF1ST
     I              B7AUNA                          WAAUNA
     I              B7A5QT                          WAA5QT
     I              B7AHWG                          WAAHWG
     I              B7AKCS                          WAAKCS
     I              B7CGCD                          WACGCD
     I              B7AYVA                          WAAYVA
     I              B7BJNA                          WABJNA
     I              B7CKNB                          WACKNB
     I              B7BMST                          WABMST
     I              B7CQCD                          WACQCD
     I              B7DTCD                          WADTCD
     I              B7MGNA                          WAMGNA
     I              B7TRBN                          WATRBN
     I              B7TRBS                          WATRBS
     I              B7C4NB                          WAC4NB
     I              B7RINB                          WARINB
     I              B7RHNB                          WARHNB
     I              B7RGNB                          WARGNB
     I              B7M3NA                          WAM3NA
     I              B7AWTM                          WAAWTM
     I              B7XLCD                          WAXLCD
     I              B7K7DT                          WAK7DT
     I              B7UVST                          WAUVST
     I              B7UWST                          WAUWST
     I              B7UXST                          WAUXST
     I              B7VSST                          WAVSST
     I              B7AATM                          WAAATM
     I              B7AYNA                          WAAYNA
     I              B7A0NA                          WAA0NA
     I              B7AXDT                          WAAXDT
      *
     IYARDCS      DS                            163
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      *
     IYBRDCS      DS                            245
      * Outward parameters
     IPARC        DS                            157
      * RCD : PAR API WIM Inv Shipping2
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Item Code
     I                                    P   3   60PAHGCD
      * I :  Ship From Warehouse
     I                                        7   9 PAVPCD
      * I :  WIM Inventory Trans ID
     I                                       10  12 PANOSC
      * I :  WIM Inventory Trans Type
     I                                       13  15 PANPSC
      * I :  Transaction Date
     I                                    P  16  190PAA9DT
      * I :  Production Date
     I                                    P  20  230PAELDT
      * I :  Item Transaction Source
     I                                       24  25 PAF1ST
      * I :  Transaction Description
     I                                       26  55 PAVQNA
      * I :  Transaction Reason Code
     I                                       56  58 PAA1AB
      * I :  Order Number
     I                                    P  59  620PAC4NB
      * I :  Shift Number
     I                                       63  63 PAXLCD
      * I :  Ship To Warehouse
     I                                       64  66 PAL9AA
      * I :  Transaction Weight
     I                                    P  67  722PAAHWG
      * I :  Transaction Quantity
     I                                    P  73  782PAA5QT
      * I :  USR Unship Flag
     I                                       79  79 PAUSST
      * I :  Inter-Plant Transfer USR
     I                                       80  80 PAA5TX
      * O :  API EccResult-MsgId U
     I                                       81  87 PACLAB
      * O :  API EccResult-MsgDesc U
     I                                       88 137 PAVGU1
      * B :  API Request Key U
     I                                      138 147 PACKAB
      * I :  API Mode U
     I                                      148 157 PACJAB
      *
      * Outward parameters
     IPBRC        DS                              9
      * KEY : Item Balance              Co/Whse/Item
      * I : RST Company Number
     I                                    P   1   20PBAIC3
      * I : RST Warehouse Code
     I                                        3   5 PBAJCD
      * B : MAP Item Code
     I                                    P   6   90PBHGCD
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Item Transaction Detail
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Item Code
     I                                    P   3   60P1HGCD
      * I : RST Warehouse Code
     I                                        7   9 P1AJCD
      * I :  Inventory Trans ID
     I                                       10  10 P1W9ST
      * I :  Inventory Trans Type
     I                                       11  12 P1BSST
      * I :  Transaction Date Code
     I                                    P  13  160P1B4DT
      * I : MAP Production Date
     I                                    P  17  200P1ELDT
      * I : MAP UOM Transaction
     I                                       21  22 P1HVCD
      * N :  Item Transaction Source
     I                                       23  24 P1F1ST
      * I : MAP Description
     I                                       25  54 P1AUNA
      * I :  UOM Cost
     I                                       55  56 P1CGCD
      * I :  Reason Code
     I                                       57  59 P1CQCD
      * I :  Employee Badge Number
     I                                       60  69 P1M3NA
      * I : MAP Shift Number
     I                                       70  70 P1XLCD
     IP2PARM      DS
      * FLD: Company Item
      * I : MAP Description Line One
     I                                        1  30 P2AVNA
      * I :  UOM Primary
     I                                       31  32 P2ADCD
      * I :  Conversion Factor 1
     I                                    P  33  374P2AWPC
      * I :  Operation Factor 1
     I                                       38  38 P2LXST
      * I :  UOM Second
     I                                       39  40 P2AECD
      * I :  Conversion Factor 2
     I                                    P  41  454P2AXPC
      * I :  Operation Factor 2
     I                                       46  46 P2LYST
      * I :  UOM Third
     I                                       47  48 P2AFCD
      * I :  Unit Weight
     I                                    P  49  542P2AIWG
      * I :  Production Date Control
     I                                       55  55 P2FZST
      * I :  Catch Weight Status
     I                                       56  56 P2AVST
     IP3PARM      DS
      * FLD: Warehouse Codes
      * I : MAP Warehouse Description
     I                                        1  30 P3F8NA
     IP4PARM      DS
      * FLD: Item Balance
      * I :  Unit Cost Per Pound
     I                                    P   1   64P4AGCS
     IP5PARM      DS
      * I : MAP Name
     I                                        1  30 P5ADTX
     IP6PARM      DS
      * I : MAP Condition Desc. 1  USR
     I                                        1  25 P6HLTX
     IP7PARM      DS
      * I : MAP USR Hold Description
     I                                        1  30 P7CUNA
     IP8PARM      DS
      * I :  Lot Number
     I                                    P   1   30P8LXNM
     IP9PARM      DS
      * FLD: *Arrays
      * O :  Inventory Updated USR
     I                                        1   1 P9ORSC
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Quantity cannot be neg.'
      * Message data for 'Quantity req for tran typ'
      * Condition Desc. 1  USR
     I                                        1  25 ZA0001
      * Message data for 'Weight can't be negative'
      * Transaction Weight
     I                                    P   1   62ZA0002
      * Message data for 'Weight req for tran typ'
      * Condition Desc. 1  USR
     I                                        1  25 ZA0003
      * Message data for 'Qty or Weight Required'
      * Transaction Quantity
     I                                    P   1   62ZA0004
      * Transaction Weight
     I                                    P   7  122ZA0005
      * Message data for 'Quantity cannot be neg.'
      * Message data for 'Transaction wgt must be +'
      * Message data for 'Quantity cannot be pos.'
      * Message data for 'Transaction wgt must be -'
      * Message data for 'Transaction sign mismatch'
      * Message data for 'Transaction sign mismatch'
      * Message data for 'Last item processed'
      * @Item Code
     I                                        1   7 ZA0006
      * Message data for 'Last item not processed'
      * @Item Code
     I                                        1   7 ZA0007
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1HGCD    PARM           WP0002  70       Item Code
     C           P1AJCD    PARM           WP0003  3        Warehouse Code
     C           P1W9ST    PARM           WP0004  1        Inventory Trans
     C           P1BSST    PARM           WP0005  2        Inventory Trans
     C           P1B4DT    PARM           WP0006  70       Transaction Dat
     C           P1ELDT    PARM           WP0007  70       Production Date
     C           P1HVCD    PARM           WP0008  2        UOM Transaction
     C           P1AUNA    PARM           WP0009 30        Description
     C           P1CGCD    PARM           WP0010  2        UOM Cost
     C           P1CQCD    PARM           WP0011  3        Reason Code
     C           P1M3NA    PARM           WP0012 10        Employee Badge
     C           P1XLCD    PARM           WP0013  1        Shift Number
     C           P2AVNA    PARM           WP0014 30        Description Lin
     C           P2ADCD    PARM           WP0015  2        UOM Primary
     C           P2AWPC    PARM           WP0016  94       Conversion Fact
     C           P2LXST    PARM           WP0017  1        Operation Facto
     C           P2AECD    PARM           WP0018  2        UOM Second
     C           P2AXPC    PARM           WP0019  94       Conversion Fact
     C           P2LYST    PARM           WP0020  1        Operation Facto
     C           P2AFCD    PARM           WP0021  2        UOM Third
     C           P2AIWG    PARM           WP0022 112       Unit Weight
     C           P2FZST    PARM           WP0023  1        Production Date
     C           P2AVST    PARM           WP0024  1        Catch Weight St
     C           P3F8NA    PARM           WP0025 30        Warehouse Descr
     C           P4AGCS    PARM           WP0026 114       Unit Cost Per P
     C           P5ADTX    PARM           WP0027 30        Name
     C           P6HLTX    PARM           WP0028 25        Condition Desc.
     C           P7CUNA    PARM           WP0029 30        USR Hold Descri
     C           P8LXNM    PARM           WP0030  50       Lot Number
     C                     PARM P9ORSC    WP0031  1        Inventory Updat
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise and load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END
     C                     END
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise & load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile header
      * Rtv UOM Description    RT - Unit of Measure  * 
     C                     EXSR SARVGN
      * CASE: CTL.USR Auto Calculate Weight is Blank
     C           #CT5ST    IFEQ *BLANK                     *IF
      * CASE: PAR.Catch Weight Status is yes
     C           P2AVST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       #CT5ST           USR Auto Calcul
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       #CT5ST           USR Auto Calcul
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *................................................................
      * Position file
     C           KPOS      KLIST
     C                     KFLD           B1AIC3           Company Number
     C                     KFLD           B1HGCD           Item Code
     C                     KFLD           B1AJCD           Warehouse Code
     C                     KFLD           B1ELDT           Production Date
      * Setup key
     C                     Z-ADD#2AIC3    B1AIC3
     C                     Z-ADD#2HGCD    B1HGCD
     C                     MOVEL#2AJCD    B1AJCD
     C                     Z-ADD#2ELDT    B1ELDT
      * 82=EOF
     C           KPOS      SETLL@B1REJ0              82    *
      * 82=EOF
     C           KRST      KLIST
     C                     KFLD           B1AIC3           Company Number
     C                     KFLD           B1HGCD           Item Code
     C                     KFLD           B1AJCD           Warehouse Code
      * Setup key
     C                     Z-ADD#2AIC3    B1AIC3
     C                     Z-ADD#2HGCD    B1HGCD
     C                     MOVEL#2AJCD    B1AJCD
     C  N82      KRST      READE@B1REJ0                9182*
      * Load subfile page
     C                     EXSR BBLDSF
      *................................................................
      * If no records found, display error message
     C   82      ##RR      IFEQ *ZERO                      IF
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
     C                     SETOF                     84    No SFLNXTCHG
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@B1REJ0                  90*
     C  N82                READ @B1REJ0                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVE *ALL'0'   WKIND0  2
     C                     MOVE *ALL'1'   WKIND1  2
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
     C                     Z-ADD*ZERO     ##RROK  50
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next subfile page
     C  N82      ##RROK    DOWLT##SFLN                     DO
     C                     ADD  1         ##RR
     C                     MOVEAWKIND0    *IN,32
     C                     SETOF                     87    *
      * Clear subfile fields
     C                     EXSR MAIZ#1
      * Load SFL fields
     C                     EXSR MBFL#1
      * Record will be selected unless overridden
     C                     MOVEL'Y'       W0RSL   1
      * USER: Initialize subfile record (existing record)
      * CASE: WRK.First Time Flag EQ WRK.BLANK
     C           WUTAST    IFEQ WUGSTX                     *IF
      * *Set Cursor: RCD.USR Quantity  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     ADD  012       W0ROW0
     C                     Z-ADD024       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0001 112       Quantity based
     C                     Z-ADD*ZERO     WN0002 112       Quantity based
     C                     Z-ADD*ZERO     WN0003 112       Quantity based
      *
      * Clc Consolidate On Hnd IF
      * Calculate unit of measure 2 equivalent for unit of measure 3
      * CASE: PAR.Quantity on Hand - U/M3 is not equal zero
     C           B1ATQT    IFNE 0                          *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
      * Convert based on operation code
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           B1ATQT    DIV  P2AXPC    WN0002    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
     C           B1ATQT    MULT P2AXPC    WN0002    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  B1ATQT    WN0002           Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  B1ASQT    WN0002           Quantity based
      * Calculate unit of measure 1 equivalent for unit of measure 2
      * CASE: PAR.Quantity based on U/M2 S is not equal zero
     C           WN0002    IFNE 0                          *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           WN0002    DIV  P2AWPC    WN0001    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
     C           WN0002    MULT P2AWPC    WN0001    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WN0002    WN0001           Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  B1ARQT    WN0001           Quantity based
     C                     Z-ADDWN0001    #RBQQT           Quantity Total
      * Select records for production date and zero balance
      * CASE: PAR.Production Date is entered
     C           P1ELDT    IFNE *ZERO                      *IF
      * CASE: PAR.Production Date NE DB1.Production Date
     C           P1ELDT    IFNE B1ELDT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.On Hand is Equal to zero
      *   |- c2    : PAR.Production Date Control is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RBQQT    IFEQ *ZERO                      *IF
     C           P2FZST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * If record dropped...
     C                     SUB  1         ##RR
     C           W0RSL     CABNE'Y'       BB020
     C                     ADD  1         ##RR
      * Validate subfile record and calculate derived fields
     C                     EXSR DFV2RC
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * 82=EOF
     C           KRST      READE@B1REJ0                  82*
     C  N82                END
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Validate USR Auto Calculate Weight
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CT5ST'  IFEQ YPMTFD
      * USR Auto Calculate Weight
     C                     MOVEL#CT5ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFT5ST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZFT5ST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZFT5ST
     C                     ENDSL
     C                     EXFMTZET5ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFT5ST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZFT5ST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CT5ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
      * Quit if reload requested
     C           W0RSF     CABEQ'Y'       DAEXIT
      *
     C   81                DO
      * No data entered as yet
     C                     MOVEL'N'       WKIPIN  1
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Process subfile records
     C                     EXSR DBPRSF
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * If data entered
     C           WKIPIN    IFEQ 'Y'
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Update DBF from subfile
     C                     EXSR EAPRSF
      * If error during update, exit:
     C           *IN99     CABEQ'1'       DAEXIT
     C                     END                             WKIPIN
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     SETOF                     87    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,32
      * No errors
     C                     SETOF                     98
      * Data entered
     C                     MOVEL'Y'       WKIPIN
      * SFLNXTCHG
     C                     SETON                     84
      * Validate subfile record
     C                     EXSR DEV1RC
      * If SFLRCD invalid, note the fact
     C   98N99             Z-ADD##RR      ##SFRC     99    *
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DEV1RC    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record fields
      * skip if wt & qty are zeros
      * CASE: Qty and weight both zero
      *  - c1 AND c2
      *   |- c1    : RCD.USR Quantity EQ WRK.ZERO
      *   |- c2    : RCD.USR Weight EQ WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RBAQT    IFEQ WUW0NB                     *IF
     C           #RASWG    IFEQ WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     GOTO DEEXIT                     *QUIT
     C                     END                             *FI
      * If auto calc weight is yes, then calc weight
      * CASE: CTL.USR Auto Calculate Weight is Yes
     C           #CT5ST    IFEQ 'Y'                        *IF
      * Clc Convert Weight     XF
     C                     Z-ADD*ZERO     WUBHWG           USR Weight base
     C                     Z-ADD*ZERO     WUBIWG           USR Weight base
     C                     Z-ADD*ZERO     WUBJWG           USR Weight base
     C                     Z-ADDP2AIWG    WUBHWG           USR Weight base
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           P2AECD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           P2AIWG    DIV  P2AWPC    WUASWG    H      USR Weight
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
     C           P2AIWG    MULT P2AWPC    WUASWG    H      USR Weight
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUASWG    WUBIWG           USR Weight base
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           WUASWG    DIV  P2AXPC    WUBJWG    H      USR Weight base
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
     C           WUASWG    MULT P2AXPC    WUBJWG    H      USR Weight base
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: CTL.U/M - Transaction EQ PAR.U/M - Primary
     C           #PHVCD    IFEQ P2ADCD                     *IF
     C           #RBAQT    MULT WUBHWG    #RASWG    H      USR Weight
     C                     END                             *FI
      * CASE: CTL.U/M - Transaction EQ PAR.U/M - Second
     C           #PHVCD    IFEQ P2AECD                     *IF
     C           #RBAQT    MULT WUBIWG    #RASWG    H      USR Weight
     C                     END                             *FI
      * CASE: CTL.U/M - Transaction EQ PAR.U/M - Third
     C           #PHVCD    IFEQ P2AFCD                     *IF
     C           #RBAQT    MULT WUBJWG    #RASWG    H      USR Weight
     C                     END                             *FI
     C                     END                             *FI
      * Issues - quantity must be greater than zeros
      * CASE: PAR.Inventory Trans. Type is Transaction Issue Types
     C           P1BSST    IFEQ 'I'                        *IF
     C           P1BSST    OREQ 'RW'
      * Quantity may not be less than or equal to zero
      * CASE: RCD.USR Quantity is Less than zero
     C           #RBAQT    IFLT *ZERO                      *IF
      * Setup message data for message
      * Send message 'Quantity cannot be neg.'
     C                     MOVEL'USR0416' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     ELSE
      * CASE: RCD.USR Quantity is Equal to zero
     C           #RBAQT    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#PHLTX    ZA0001           Condition Desc.
      * Send message 'Quantity req for tran typ'
     C                     MOVEL'USR1950' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Issues - weight must be greater than zeros
      * CASE: PAR.Inventory Trans. Type is Transaction Issue Types
     C           P1BSST    IFEQ 'I'                        *IF
     C           P1BSST    OREQ 'RW'
      * Weight must be greater than zero
      * CASE: RCD.USR Weight is Less than zero
     C           #RASWG    IFLT *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#RASWG    ZA0002           USR Weight
      * Send message 'Weight can't be negative'
     C                     MOVEL'USR1951' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     ELSE
      * CASE: RCD.USR Weight is Equal to zero
     C           #RASWG    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#PHLTX    ZA0003           Condition Desc.
      * Send message 'Weight req for tran typ'
     C                     MOVEL'USR1952' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Adjustment
      * CASE: PAR.Inventory Trans. ID is Adjustment
     C           P1W9ST    IFEQ 'A'                        *IF
      * Edt Quantity/Wght Adj  IF
     C                     EXSR UASUBR
     C                     END                             *FI
     C                     END
      * Validate subfile record relations
     C                     EXSR DFV2RC
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         DFV2RC    BEGSR
      *================================================================
      * Validate subfile record relations
      *================================================================
      * Check reference to Calendar Master
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Calendar Master
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Item Structure Class
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Item Structure Group
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Item Structure Type
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      *================================================================
     CSR         DFEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * Initialise subfile reload flag
     C                     MOVEL'N'       W0RSF
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,32
     C                     SETOF                     98
      *
      * Process change request
     C                     EXSR EECHRQ
      * If error occurred on update, note the fact
     C           *IN98     IFEQ '1'
     C           *IN99     IFEQ '0'
     C                     Z-ADD##RR      ##SFRC     99    *
     C                     END
     C                     ELSE
      * USER: Extra processing after DBF update
      * 09/28/23 DN WI517-Commented Out.
      * 09/28/23 DN WI517-Send Info Msg Based on Inventory was Updated or
      * CASE: *OTHERWISE
     C                     MOVELYL0001    P9ORSC           Inventory Updat
      * CASE: LCL.Inventory Updated USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0006           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0006           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Last item processed'
     C                     MOVEL'USR0400' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0007           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0007           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Last item not processed'
     C                     MOVEL'USR0399' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Clear the entry fields
     C                     Z-ADD*ZERO     #RBAQT           USR Quantity
     C                     Z-ADD*ZERO     #RASWG           USR Weight
      * Signal subfile reload if record processed
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      *
     C                     Z-ADD*ZERO     WN0004  30       Item Structure
     C                     Z-ADD*ZERO     WN0005  30       Item Structure
     C                     Z-ADD*ZERO     WN0006  30       Item Structure
     C                     Z-ADD*ZERO     WN0007  50       ITD Sequence Nu
     C                     Z-ADD*ZERO     WN0008  30       Sequence Number
     C                     Z-ADD*ZERO     WN0009 114       USR Transaction
     C                     Z-ADD*ZERO     WN0010 112       Extended Amount
     C                     Z-ADD*ZERO     WN0011 112       On Hand Weight
     C                     Z-ADD*ZERO     WN0012 112       On Hand UOM1 Su
     C                     Z-ADD*ZERO     WN0013 112       Value of On Han
     C                     Z-ADD*ZERO     WN0014 112       Quantity based
     C                     Z-ADD*ZERO     WN0015 112       Quantity based
     C                     Z-ADD*ZERO     WN0016 112       Quantity based
     C                     Z-ADD*ZERO     WN0017 114       Cost based on U
     C                     Z-ADD*ZERO     WN0018 114       Cost based on U
     C                     Z-ADD*ZERO     WN0019 114       Cost based on U
     C                     Z-ADD*ZERO     WN0020 112       Quantity Total
     C                     Z-ADD*ZERO     WN0021 112       USR Transaction
     C                     MOVEL*BLANK    WN0022  3        USR Reason Code
      *
      * UPD Balances Issue/Adj IF
      * NOTES: WI517 DN 10/09/23-Per Business (Ace C./Ryan H.), we will N
      *        pass in the 'negative' Qty/Wgt when processing the WIM API
      *        WIM API logic will handle this scenario.
      * WI517 DN 07/05/23-Get WIM Module Release Status.
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
     C                     EXSR SBRVGN
     C                     MOVEL'N'       YL0001           Inventory Updat
     C                     MOVEL'N'       YN0001           API was Called?
      * 08/10/23 DN WI517-Call Existing Legacy Process.
      * CASE: *OTHERWISE
     C                     Z-ADD#RBAQT    WN0020           Quantity Total
     C                     Z-ADD#RASWG    WN0021           USR Transaction
      * Adjust quantity, weight for trans type (make negative if issue)
      * CASE: PAR.Inventory Trans. Type is Issue types
     C           P1BSST    IFEQ 'I'                        *IF
     C           P1BSST    OREQ 'IO'
     C           P1BSST    OREQ 'RW'
      * CASE: PAR.USR Unship Flag is yes
     C           'N'       IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Qty
      * CASE: PAR.Transaction Quantity GT WRK.ZERO
     C           #RBAQT    IFGT WUW0NB                     *IF
     C           *ZERO     SUB  #RBAQT    WN0020           Quantity Total
     C                     END                             *FI
      * Wgt
      * CASE: PAR.Transaction Weight GT WRK.ZERO
     C           #RASWG    IFGT WUW0NB                     *IF
     C           *ZERO     SUB  #RASWG    WN0021           USR Transaction
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      *
     C                     Z-ADD*ZERO     WN0023 112       Quantity based
     C                     Z-ADD*ZERO     WN0024 112       Quantity based
     C                     Z-ADD*ZERO     WN0025 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0014           USR Qty based o
     C                     Z-ADD*ZERO     WN0015           USR Qty based o
     C                     Z-ADD*ZERO     WN0016           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           P2ADCD    IFEQ #PHVCD                     *IF
     C                     Z-ADDWN0020    WN0014           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           P2AECD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
     C           WN0020    MULT P2AWPC    WN0024    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           WN0020    DIV  P2AWPC    WN0024    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0024    WN0015           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
     C           WN0024    MULT P2AXPC    WN0025    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           WN0024    DIV  P2AXPC    WN0025    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0025    WN0016           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           P2AECD    IFEQ #PHVCD                     *IF
     C                     Z-ADDWN0020    WN0015           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           WN0020    DIV  P2AWPC    WN0014    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
     C           WN0020    MULT P2AWPC    WN0014    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
     C           WN0020    MULT P2AXPC    WN0025    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           WN0020    DIV  P2AXPC    WN0025    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0025    WN0016           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           P2AFCD    IFEQ #PHVCD                     *IF
     C                     Z-ADDWN0020    WN0016           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           WN0020    DIV  P2AXPC    WN0024    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
     C           WN0020    MULT P2AXPC    WN0024    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0024    WN0015           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           WN0024    DIV  P2AWPC    WN0014    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
     C           WN0024    MULT P2AWPC    WN0014    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0026 114       Cost based on U
     C                     Z-ADD*ZERO     WN0027 114       Cost based on U
     C                     Z-ADD*ZERO     WN0028 114       Cost based on U
      *
      * Clc Convert Cost       IF
      * Initialize parameter values
     C                     Z-ADD*ZERO     WN0017           Cost based on U
     C                     Z-ADD*ZERO     WN0018           Cost based on U
     C                     Z-ADD*ZERO     WN0019           Cost based on U
      * Process based on Unit of Measure entered
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Cost
     C           P2ADCD    IFEQ P1CGCD                     *IF
     C                     Z-ADDP4AGCS    WN0017           Cost based on U
      * Process second U/M if entered
      * CASE: PAR.U/M - Second is Entered
     C           P2AECD    IFNE *BLANK                     *IF
      * Convert based on operation code
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           P4AGCS    DIV  P2AWPC    WN0027    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
     C           P4AGCS    MULT P2AWPC    WN0027    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0027    WN0018           Cost based on U
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           WN0027    DIV  P2AXPC    WN0019    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
     C           WN0027    MULT P2AXPC    WN0019    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Cost
     C           P2AECD    IFEQ P1CGCD                     *IF
     C                     Z-ADDP4AGCS    WN0018           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
     C           P4AGCS    MULT P2AWPC    WN0017    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           P4AGCS    DIV  P2AWPC    WN0017    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           P4AGCS    DIV  P2AXPC    WN0019    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
     C           P4AGCS    MULT P2AXPC    WN0019    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Cost
     C           P2AFCD    IFEQ P1CGCD                     *IF
     C                     Z-ADDP4AGCS    WN0019           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
     C           P4AGCS    MULT P2AXPC    WN0027    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           P4AGCS    DIV  P2AXPC    WN0027    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0027    WN0018           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
     C           WN0027    MULT P2AWPC    WN0017    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           WN0027    DIV  P2AWPC    WN0017    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P4AGCS    MULT WN0021    WN0010           Extended Amount
     C                     MOVELP1CQCD    WN0022           USR Reason Code
      * Error if unit cost = 0
      * CASE: PAR.Unit Cost Pricing U/M EQ WRK.ZERO
     C           P4AGCS    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     WN0022           USR Reason Code
     C                     END                             *FI
      * 08/10/23 DN WI517-Call Legacy Process if Not Live or Parallel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Not Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0002    IFEQ 'N'                        *IF
     C           YL0002    OREQ 'P'                        *OR
      * 09/22/23 DN WI517-Set 'Inventory Updated USR' Flag.
     C                     MOVEL'Y'       YL0001           Inventory Updat
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1HGCD    WL0002           Item Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WN0004           Item Structure
     C                     Z-ADDWL0004    WN0005           Item Structure
     C                     Z-ADDWL0005    WN0006           Item Structure
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0006           Company Number
     C                     Z-ADD#1HGCD    WL0007           Item Code
     C                     MOVEL#1AJCD    WL0008    P      Warehouse Code
     C                     MOVELP1W9ST    WL0009    P      Inventory Trans
     C                     MOVELP1BSST    WL0010    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0011           Transaction Dat
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    WN0007           ITD Sequence Nu
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0013           Company Number
     C                     Z-ADD#1HGCD    WL0014           Item Code
     C                     MOVEL#1AJCD    WL0015    P      Warehouse Code
     C                     MOVELP1W9ST    WL0016    P      Inventory Trans
     C                     MOVELP1BSST    WL0017    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0018           Transaction Dat
     C                     Z-ADDWN0007    WL0019           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0020           Sequence Number
     C                     Z-ADD#1ELDT    WL0021           Production Date
     C                     MOVEL#PHVCD    WL0022    P      UOM Transaction
     C                     MOVELP1F1ST    WL0023    P      Item Transactio
     C                     MOVEL#PAUNA    WL0024    P      Description
     C                     Z-ADDWN0020    WL0025           Transaction Qua
     C                     Z-ADDWN0021    WL0026           Transaction Wei
     C                     Z-ADD*ZERO     WL0027           USR Transaction
     C                     MOVELP1CGCD    WL0028    P      UOM Cost
     C                     Z-ADDWN0010    WL0029           Extended Amount
     C                     MOVEL*BLANK    WL0030           Ticket Number
     C                     Z-ADD*ZERO     WL0031           GL Document Num
     C                     MOVEL*BLANK    WL0032           GL Update Statu
     C                     MOVELWN0022    WL0033    P      Reason Code
     C                     MOVEL*BLANK    WL0034           Reference Numbe
     C                     MOVEL*BLANK    WL0035           Lot ID
     C                     Z-ADD*ZERO     WL0036           Transfer Batch
     C                     Z-ADD*ZERO     WL0037           Transfer Batch
     C                     Z-ADD*ZERO     WL0038           Order Number
     C                     Z-ADDWN0004    WL0039           Item Structure
     C                     Z-ADDWN0005    WL0040           Item Structure
     C                     Z-ADDWN0006    WL0041           Item Structure
     C                     MOVELP1M3NA    WL0042    P      Employee Badge
     C                     Z-ADD*ZERO     WL0043           Production Time
     C                     MOVELP1XLCD    WL0044    P      Shift Number
     C                     Z-ADD#1K7DT    WL0045           Label Date
     C                     MOVEL*BLANK    WL0046           EDI Status 1
     C                     MOVEL*BLANK    WL0047           EDI Status 2
     C                     MOVEL*BLANK    WL0048           EDI Status 3
     C                     MOVEL'A'       WL0049    P      Record Status
     C                     EXSR SECRRC
      * ** This creates or updates Item Balance Detail
      * CHG Value/Qty/Wgt      CH - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0050           Company Number
     C                     Z-ADD#1HGCD    WL0051           Item Code
     C                     MOVEL#1AJCD    WL0052    P      Warehouse Code
     C                     Z-ADD#1ELDT    WL0053           Production Date
     C                     Z-ADDWN0004    WL0054           Item Structure
     C                     Z-ADDWN0005    WL0055           Item Structure
     C                     Z-ADDWN0006    WL0056           Item Structure
     C                     MOVELP2ADCD    WL0057    P      UOM Primary
     C                     Z-ADDP2AWPC    WL0058           Conversion Fact
     C                     MOVELP2LXST    WL0059    P      Operation Facto
     C                     MOVELP2AECD    WL0060    P      UOM Second
     C                     Z-ADDP2AXPC    WL0061           Conversion Fact
     C                     MOVELP2LYST    WL0062    P      Operation Facto
     C                     MOVELP2AFCD    WL0063    P      UOM Third
     C                     MOVELP2FZST    WL0064    P      Production Date
     C                     MOVELP2AVST    WL0065    P      Catch Weight St
     C                     MOVELP1W9ST    WL0066    P      Inventory Trans
     C                     MOVELP1BSST    WL0067    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0068           Transaction Dat
     C                     MOVEL#PHVCD    WL0069    P      UOM Transaction
     C                     Z-ADDWN0014    WL0070           Transaction Qua
     C                     Z-ADDWN0021    WL0071           Transaction Wei
     C                     Z-ADDP4AGCS    WL0072           USR Transaction
     C                     MOVELP1CGCD    WL0073    P      UOM Cost
     C                     Z-ADDWN0010    WL0074           Extended Amount
     C                     Z-ADD#1K7DT    WL0075           Label Date  USR
     C                     EXSR SFCHRC
      * 11/25/09 PKD Comment out until we know what we need to do here.
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0112           Company Number
     C                     Z-ADD#1HGCD    WL0113           Item Code
     C                     MOVEL#1AJCD    WL0114    P      Warehouse Code
     C                     Z-ADDWN0011    WL0115           Quantity on Han
     C                     Z-ADDWN0012    WL0116           Quantity on Han
     C                     Z-ADDWUNFNN    WL0117           Quantity on Han
     C                     Z-ADDWUNFNN    WL0118           Quantity on Han
     C                     Z-ADDWN0013    WL0119           Value of On Han
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0115    WN0011           Quantity on Han
     C                     Z-ADDWL0116    WN0012           Quantity on Han
     C                     Z-ADDWL0117    WUNFNN           Quantity on Han
     C                     Z-ADDWL0118    WUNFNN           Quantity on Han
     C                     Z-ADDWL0119    WN0013           Value of On Han
      * Chg Val/Qty/Wgt        Ch - Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0120           Company Number
     C                     Z-ADD#1HGCD    WL0121           Item Code
     C                     MOVEL#1AJCD    WL0122    P      Warehouse Code
     C                     Z-ADDWN0011    WL0123           On Hand Weight
     C                     Z-ADDWN0012    WL0124           On Hand UOM1 Su
     C                     Z-ADDWN0013    WL0125           Value of On Han
     C                     EXSR SKCHRC
      * ** Process Auto-Locate Whse inventory             FP1127
      * RTV Warehouse Info     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0126    P      Warehouse Code
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0127    YN0002    P      Warehouse Descr
     C                     MOVELWL0128    YN0003    P      Address Line 1
     C                     MOVELWL0129    YN0004    P      Address Line 2
     C                     MOVELWL0130    YN0005    P      Address Line 3
     C                     MOVELWL0131    YN0006    P      City
     C                     MOVELWL0132    YN0007    P      Zip Postal Code
     C                     MOVELWL0133    YN0008    P      Production Ware
     C                     MOVELWL0134    YN0009    P      State Code
     C                     MOVELWL0135    YL0003    P      Lot Tracking Fl
     C                     MOVELWL0136    YN0010    P      Default Printer
     C                     MOVELWL0137    YN0011    P      Warehouse Type
     C                     MOVELWL0138    YN0012    P      Trans Contol AS
     C                     MOVELWL0139    YL0004    P      Warehouse Locat
     C                     MOVELWL0140    YN0013    P      Warehouse Std C
     C                     Z-ADDWL0141    YN0014           Warehouse Chill
     C                     MOVELWL0142    YN0015    P      Include in Auto
     C                     MOVELWL0143    YN0016    P      Default Manifes
     C                     MOVELWL0144    YN0017    P      Default Load Se
     C                     MOVELWL0145    YN0018    P      WHS Slotting Li
     C                     Z-ADDWL0146    YN0019           Shipping Compan
     C                     Z-ADDWL0147    YN0020           Accounting Comp
     C                     Z-ADDWL0148    YN0021           WHS Sched Prod
     C                     Z-ADDWL0149    YN0022           WHS Inventory C
     C                     MOVELWL0150    YN0023    P      Parent Warehous
     C                     MOVELWL0151    YN0024    P      Default Shippin
     C                     MOVELWL0152    YL0005    P      WHS Live with C
     C                     MOVELWL0153    YN0025    P      WHS PFS Interfa
     C                     MOVELWL0154    YN0026    P      WHS Req Meter R
     C                     MOVELWL0155    YN0027    P      WHS Default Loa
     C                     MOVELWL0156    YN0028    P      WHS TMS Plannin
     C                     MOVELWL0157    YN0029    P      Default Carrier
     C                     MOVELWL0158    YN0030    P      Inventory Logic
     C                     MOVELWL0159    YN0031    P      WHS Auto Inv Re
     C                     MOVELWL0160    YN0032    P      EDI Status 1
     C                     MOVELWL0161    YN0033    P      EDI Status 2
     C                     MOVELWL0162    YN0034    P      EDI Status 3
     C                     MOVELWL0163    YN0035    P      Record Status
     C                     Z-ADDWL0164    YN0036           Job Time
     C                     MOVELWL0165    YN0037    P      User Id
     C                     MOVELWL0166    YN0038    P      Job Name
     C                     Z-ADDWL0167    YN0039           Job Date
      * ** Process lot tracking if External, not Carlisle, Lot trk=Y
      * CASE: Process lots if External, not Carlisle, Lot trk=Y
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : LCL.WHS Live w/Carlisle is *No/Blank
      *   |- c3    : LCL.Lot Tracking Flag is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0004    IFEQ 'E'                        *IF
     C           YL0005    IFEQ *BLANK                     *IF
     C           YL0005    OREQ 'N'
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** For External whses: level=0, lot=last 5 digits of Load ID (opt
      * RTV Whse Location Info RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0168    P      Warehouse Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0169    WUYMCD    P      Location Code
     C                     MOVELWL0170    YL0006    P      Location Aisle
     C                     Z-ADDWL0171    YL0007           Location Bay
     C                     Z-ADDWL0172    YL0008           Loc Unused Chil
     C                     MOVEL*BLANK    YL0009           Order Type_Sale
      * RTV Order Type         RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0173           Company Number
     C                     Z-ADD*ZERO     WL0174           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0175    YL0009    P      Order Type_Sale
      * ** Upd/add lot info if Transfer, or Issue, but not for shipped or
      * CASE:
      *  - c1 OR c3
      *   |- c1    : LCL.Order Type - Sales is Not Regular Order
      *   |- c3    : PAR.Order Number is Equal to zeros
      *   '-
     C           YL0009    IFNE 'OR'                       *IF
     C           *ZERO     OREQ 0                          *OR
      * UPD Auto-Loc TR Ord ItmXF - Item Lot Location  * 
     C                     CALL 'PMBVXFR'              90  UPD Auto-Loc TR
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0059  30       Company Number
     C                     PARM #1HGCD    WQ0060  70       Item Code
     C                     PARM #1AJCD    WQ0061  3        Warehouse Code
     C                     PARM #1ELDT    WQ0062  70       Production Date
     C                     PARM P8LXNM    WQ0063  50       Lot Number
     C                     PARM WUYMCD    WQ0064  4        Location Code
     C                     PARM WUYNCD    WQ0065  20       Location Level
     C                     PARM WN0020    WQ0066  70       Quantity Loc Tr
     C                     PARM *ZERO     WQ0067  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMBVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
      * 09/27/24 DN SR20410-Commented Out & Moved Below.
      * 09/27/24 DN SR20410-Commented Out & Moved Below.
      * 09/27/24 DN SR20410-Only Call if NOT from PDLYXFR Program.
      * CASE:
      *  - NOTc1
      *   |- c1    : PAR.Called From Program is UPD Backin Spec'l Adj  XF
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           @CN,001   IFEQ @CN,002                    *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 08/10/23 DN WI517-Call WIM API if Live or Parallel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Is Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0002    IFEQ 'Y'                        *IF
     C           YL0002    OREQ 'P'                        *OR
     C                     MOVEL'Y'       YN0001           API was Called?
     C                     MOVEL*BLANK    YL0010           API EccResult-M
     C                     MOVEL*BLANK    YL0011           API EccResult-M
     C                     MOVEL*BLANK    YL0012           API Request Key
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,003   CAT  'ry':ZQ   YL0013    P      API Name
      * RTV Numeric Value      RT - System Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL@CN,004   WL0176    P      System Value Co
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0177    YL0014           System Value Nu
      * Call API Wrapper Program for wim.ordershipping.inventory API.
      * 1/6/24 DN SR08283-Added 'API Request Key U' & 'API Mode U' Parms.
      * API WIM Inv Shipping   UP - WIM Item Trans Detail  * 
     C                     CLEARPARC
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     Z-ADD#1HGCD    PAHGCD           Item Code
     C                     MOVEL#1AJCD    PAVPCD    P      Ship From Wareh
     C                     MOVELP1W9ST    PANOSC    P      WIM Inventory T
     C                     MOVELP1BSST    PANPSC    P      WIM Inventory T
     C                     Z-ADDP1B4DT    PAA9DT           Transaction Dat
     C                     Z-ADD#1ELDT    PAELDT           Production Date
     C                     MOVELP1F1ST    PAF1ST    P      Item Transactio
     C                     MOVEL#PAUNA    PAVQNA    P      Transaction Des
     C                     MOVEL*BLANK    PAA1AB    P      Transaction Rea
     C                     Z-ADD*ZERO     PAC4NB           Order Number
     C                     MOVELP1XLCD    PAXLCD    P      Shift Number
     C                     MOVEL*BLANK    PAL9AA    P      Ship To Warehou
     C                     Z-ADD#RASWG    PAAHWG           Transaction Wei
     C                     Z-ADD#RBAQT    PAA5QT           Transaction Qua
     C                     MOVEL'N'       PAUSST    P      USR Unship Flag
     C                     MOVEL'N'       PAA5TX    P      Inter-Plant Tra
     C                     MOVELYL0012    PACKAB    P      API Request Key
     C                     MOVEL'*SNDRCV' PACJAB    P      API Mode U
      *
     C                     CALL 'PVAYUPR'              90  API WIM Inv Shi
     C                     PARM YL0014    WQ0068  50       API Wait Time U
     C                     PARM           PARC             RCD: *Arrays
      *
     C                     MOVELPACLAB    YL0010           API EccResult-M
     C                     MOVELPAVGU1    YL0011           API EccResult-M
     C                     MOVELPACKAB    YL0012           API Request Key
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVAYUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     983332*
     C                     END
      * API Call Successful? If Not, Create Log & Send Email.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.API EccResult-MsgId U is Success
      *   |- c2    : LCL.API EccResult-MsgId U is Timeout
      *   '-
     C           YL0010    IFEQ @CN,005                    *IF
     C           YL0010    OREQ @CN,006                    *OR
     C                     MOVEL'Y'       YL0001           Inventory Updat
      * 01/06/24 DN SR08283-Create Log Record for Timeout Transaction.
      * CASE: LCL.API EccResult-MsgId U is Timeout
     C           YL0010    IFEQ @CN,006                    *IF
      * Crt WIM API Failure LogXF - WIM API Failure Log  * Timeout Failur
     C                     CALL 'PVA8XFR'              90  Crt WIM API Fai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0013    WQ0069 45        API Name
     C                     PARM YL0010    WQ0070  7        API EccResult M
     C                     PARM YL0011    WQ0071 50        API EccResult-M
     C                     PARM YL0012    WQ0072 10        API Request Key
     C                     PARM @CN,001   WQ0073 10        Called From Pro
     C                     PARM #1AIC3    WQ0074  30       Company Number
     C                     PARM #1HGCD    WQ0075  70       Item Code
     C                     PARM #1AJCD    WQ0076  3        Ship From Wareh
     C                     PARM P1W9ST    WQ0077  3        WIM Inventory T
     C                     PARM P1BSST    WQ0078  3        WIM Inventory T
     C                     PARM P1B4DT    WQ0079  70       Transaction Dat
     C                     PARM #1ELDT    WQ0080  70       Production Date
     C                     PARM P1F1ST    WQ0081  2        Item Transactio
     C                     PARM #PAUNA    WQ0082 30        Transaction Des
     C                     PARM *BLANK    WQ0083  3        Transaction Rea
     C                     PARM *ZERO     WQ0084  70       Order Number
     C                     PARM P1XLCD    WQ0085  1        Shift Number
     C                     PARM *BLANK    WQ0086  3        Ship To Warehou
     C                     PARM #RASWG    WQ0087 112       Transaction Wei
     C                     PARM #RBAQT    WQ0088 112       Transaction Qua
     C                     PARM 'N'       WQ0089  1        Unship Flag
     C                     PARM 'N'       WQ0090  1        Inter Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983332*
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 12/21/23 DN SR07943-Added 'API EccResult-MsgId U is Entered' Cond
      * CASE: LCL.API EccResult-MsgId U is Entered
     C           YL0010    IFNE *BLANK                     *IF
     C                     MOVEL'N'       YL0001           Inventory Updat
      * 1/6/24 DN SR08283-Added 'API Request Key' as Input Parm.
      * Crt WIM API Failure LogXF - WIM API Failure Log  * Hardstop Failu
     C                     CALL 'PVA8XFR'              90  Crt WIM API Fai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0013    WQ0091 45        API Name
     C                     PARM YL0010    WQ0092  7        API EccResult M
     C                     PARM YL0011    WQ0093 50        API EccResult-M
     C                     PARM YL0012    WQ0094 10        API Request Key
     C                     PARM @CN,001   WQ0095 10        Called From Pro
     C                     PARM #1AIC3    WQ0096  30       Company Number
     C                     PARM #1HGCD    WQ0097  70       Item Code
     C                     PARM #1AJCD    WQ0098  3        Ship From Wareh
     C                     PARM P1W9ST    WQ0099  3        WIM Inventory T
     C                     PARM P1BSST    WQ0100  3        WIM Inventory T
     C                     PARM P1B4DT    WQ0101  70       Transaction Dat
     C                     PARM #1ELDT    WQ0102  70       Production Date
     C                     PARM P1F1ST    WQ0103  2        Item Transactio
     C                     PARM #PAUNA    WQ0104 30        Transaction Des
     C                     PARM *BLANK    WQ0105  3        Transaction Rea
     C                     PARM *ZERO     WQ0106  70       Order Number
     C                     PARM P1XLCD    WQ0107  1        Shift Number
     C                     PARM *BLANK    WQ0108  3        Ship To Warehou
     C                     PARM #RASWG    WQ0109 112       Transaction Wei
     C                     PARM #RBAQT    WQ0110 112       Transaction Qua
     C                     PARM 'N'       WQ0111  1        Unship Flag
     C                     PARM 'N'       WQ0112  1        Inter Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983332*
     C                     END
      * Keep Track of Batch Processing Functions so Email will NOT be Sen
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7
      *   |- c1    : PAR.Called From Program is Exc Proc 947 Whs InvAdjXF
      *   |- c2    : PAR.Called From Program is EDT Confirm Ship Detl  DF
      *   |- c3    : PAR.Called From Program is ADD Ready to Confirm  XL
      *   |- c4    : PAR.Called From Program is Exc Upd EDI 945 Trsn   XF
      *   |- c5    : PAR.Called From Program is PFS Reopen Order      XL
      *   |- c6    : PAR.Called From Program is WW Unship Orders       DF
      *   |- c7    : PAR.Called From Program is UPD Backin Spec'l Adj  XF
      *   '-
     C           @CN,001   IFEQ @CN,007                    *IF
     C           @CN,001   OREQ @CN,008                    *OR
     C           @CN,001   OREQ @CN,009                    *OR
     C           @CN,001   OREQ @CN,010                    *OR
     C           @CN,001   OREQ @CN,011                    *OR
     C           @CN,001   OREQ @CN,012                    *OR
     C           @CN,001   OREQ @CN,002                    *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Send Email to Business & IT.
      * Prc Eml Shipping & IT  XF - WIM API Failure Log  * 
     C                     CALL 'PVA9XFR'              90  Prc Eml Shippin
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,001   WQ0113 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Screen errors
     C                     MOVEAWKIND1    *IN,32
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
      * Reset subfile record if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1           IF
     C                     END
     C                     ELSE
      * DBF update successful
      * Enable entry
     C                     SETOF                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect keys if change mode or updated record
     C                     SETON                     88    *
     C   89N87             SETOF                     88    *
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise subfile record
      *================================================================
      * Previous values
     C                     MOVEL*BLANK    #1DBRC
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     Z-ADDP1HGCD    #1HGCD           Item Code
     C                     MOVELP1AJCD    #1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     #1ABWG           Physical Count
     C                     Z-ADD*ZERO     #1AGQT           Physical Count
     C                     Z-ADD*ZERO     #1AHQT           Physical Count
     C                     Z-ADD*ZERO     #1AIQT           Physical Count
     C                     MOVEL*BLANK    #1CTST           Physical Count
     C                     Z-ADD*ZERO     #1ARQT           Quantity on Han
     C                     Z-ADD*ZERO     #1ASQT           Quantity on Han
     C                     Z-ADD*ZERO     #1ATQT           Quantity on Han
     C                     Z-ADD*ZERO     #1HDQT           Quantity In Chi
     C                     Z-ADD*ZERO     #1HEQT           Weight In Chill
     C                     MOVEL*BLANK    #1F6ST           Update Exceptio
     C                     Z-ADD*ZERO     #1BMWG           Physical Start
     C                     Z-ADD*ZERO     #1DSQT           Physical Start
     C                     Z-ADD*ZERO     #1DTQT           Physical Start
     C                     Z-ADD*ZERO     #1DUQT           Physical Start
     C                     Z-ADD*ZERO     #1DHDT           Physical Start
     C                     Z-ADD*ZERO     #1AGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     #1AECS           Last Cost
     C                     Z-ADD*ZERO     #1IDVA           Value of On Han
     C                     Z-ADD*ZERO     #1RINB           Item Structure
     C                     Z-ADD*ZERO     #1RHNB           Item Structure
     C                     Z-ADD*ZERO     #1RGNB           Item Structure
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADDP1ELDT    #1ELDT           Production Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1ELDT
     C                     Z-ADD*ZERO     #1K7DT           Label Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1K7DT
     C                     Z-ADD*ZERO     #RBAQT           USR Quantity
     C                     Z-ADD*ZERO     #RBQQT           On Hand
     C                     Z-ADD*ZERO     #RASWG           USR Weight
     C                     Z-ADD*ZERO     #1ACWG           Quantity on Han
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @B1REJ0 fields to subfile
      *================================================================
     C                     Z-ADDB1AIC3    #1AIC3           Company Number
     C                     Z-ADDB1HGCD    #1HGCD           Item Code
     C                     MOVELB1AJCD    #1AJCD           Warehouse Code
     C                     Z-ADDB1ABWG    #1ABWG           Physical Count
     C                     Z-ADDB1AGQT    #1AGQT           Physical Count
     C                     Z-ADDB1AHQT    #1AHQT           Physical Count
     C                     Z-ADDB1AIQT    #1AIQT           Physical Count
     C                     MOVELB1CTST    #1CTST           Physical Count
     C                     Z-ADDB1ARQT    #1ARQT           Quantity on Han
     C                     Z-ADDB1ASQT    #1ASQT           Quantity on Han
     C                     Z-ADDB1ATQT    #1ATQT           Quantity on Han
     C                     Z-ADDB1HDQT    #1HDQT           Quantity In Chi
     C                     Z-ADDB1HEQT    #1HEQT           Weight In Chill
     C                     MOVELB1F6ST    #1F6ST           Update Exceptio
     C                     Z-ADDB1BMWG    #1BMWG           Physical Start
     C                     Z-ADDB1DSQT    #1DSQT           Physical Start
     C                     Z-ADDB1DTQT    #1DTQT           Physical Start
     C                     Z-ADDB1DUQT    #1DUQT           Physical Start
     C                     Z-ADDB1DHDT    #1DHDT           Physical Start
     C                     Z-ADDB1AGCS    #1AGCS           Unit Cost Per P
     C                     Z-ADDB1AECS    #1AECS           Last Cost
     C                     Z-ADDB1IDVA    #1IDVA           Value of On Han
     C                     Z-ADDB1RINB    #1RINB           Item Structure
     C                     Z-ADDB1RHNB    #1RHNB           Item Structure
     C                     Z-ADDB1RGNB    #1RGNB           Item Structure
     C                     MOVELB1UVST    #1UVST           EDI Status 1
     C                     MOVELB1UWST    #1UWST           EDI Status 2
     C                     MOVELB1UXST    #1UXST           EDI Status 3
     C                     MOVELB1VSST    #1VSST           Record Status
     C                     Z-ADDB1AATM    #1AATM           Job Time
     C                     MOVELB1AYNA    #1AYNA           User Id
     C                     MOVELB1A0NA    #1A0NA           Job Name
     C                     Z-ADDB1AXDT    #1AXDT           Job Date
     C                     Z-ADDB1ELDT    #1ELDT           Production Date
     C                     Z-ADDB1K7DT    #1K7DT           Label Date
     C                     Z-ADDB1ACWG    #1ACWG           Quantity on Han
      * Hold current record image for change detection
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADDP1ELDT    #2ELDT           Production Date
     C                     MOVELP1AUNA    #PAUNA           Description
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVELP5ADTX    #PADTX           Name
     C                     MOVELP6HLTX    #PHLTX           Condition Desc.
     C                     MOVELP7CUNA    #PCUNA           USR Hold Descri
     C                     MOVELP1AJCD    #2AJCD           Warehouse Code
     C                     MOVELP3F8NA    #PF8NA           Warehouse Descr
     C                     Z-ADDP1HGCD    #2HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V2HGCD
     C                     MOVELP2AVNA    #PAVNA           Description Lin
     C                     MOVELP1XLCD    #PXLCD           Shift Number
     C                     MOVELP1HVCD    #PHVCD           UOM Transaction
     C                     MOVEL*BLANK    #CDL01           Description. .
     C                     MOVEL*BLANK    #CT5ST           USR Auto Calcul
      * Check restriction within
     C                     EXSR VFCKRL
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1ELDT
      * Convert Label Date to display format
      * Convert date
     C           1000000   ADD  #1K7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1K7DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2HGCD           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv UOM Description    RT - Unit of Measure  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           AMHHCD           UOM Primary Dft
      * Setup key
     C                     MOVELP1HVCD    AMHHCD           UOM Primary Dft
      * Establish starting position
     C           KRSSA     CHAIN@AMREB0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0033' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #CDL01           Description
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELAMAUNA    #CDL01           Description
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Module Release
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           C6B3AB           Module ID
     C                     KFLD           C6HUNZ           Release Number
      * Setup key
     C                     MOVEL'WIM'     C6B3AB           Module ID
     C                     Z-ADD1         C6HUNZ           Release Number
      * Establish starting position
     C           KRSSB     CHAIN@C6REMK              90    *
      * Data record not found
     C   90                MOVEL'USR5307' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           C6VSST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELC6OCSC    YL0002           Module Release
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0001    BZAIC3           Company Number
     C                     Z-ADDWL0002    BZHGCD           Item Code
      * Establish starting position
     C           KRSSC     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZRINB    WL0003           Item Structure
     C                     Z-ADDBZRHNB    WL0004           Item Structure
     C                     Z-ADDBZRGNB    WL0005           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN B7AIC3    WQSD01           Company Number
     C           *LIKE     DEFN B7HGCD    WQSD02           Item Code
     C           *LIKE     DEFN B7AJCD    WQSD03           Warehouse Code
     C           *LIKE     DEFN B7W9ST    WQSD04           Inventory Trans
     C           *LIKE     DEFN B7BSST    WQSD05           Inventory Trans
     C           *LIKE     DEFN B7B4DT    WQSD06           Transaction Dat
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Item Code
     C                     KFLD           WQSD03           Warehouse Code
     C                     KFLD           WQSD04           Inventory Trans
     C                     KFLD           WQSD05           Inventory Trans
     C                     KFLD           WQSD06           Transaction Dat
      * Setup key
     C                     Z-ADDWL0006    WQSD01           Company Number
     C                     Z-ADDWL0007    WQSD02           Item Code
     C                     MOVELWL0008    WQSD03           Warehouse Code
     C                     MOVELWL0009    WQSD04           Inventory Trans
     C                     MOVELWL0010    WQSD05           Inventory Trans
     C                     Z-ADDWL0011    WQSD06           Transaction Dat
      * Establish starting position
     C           KRSSD     SETLL@B7CPZA                    *
     C           KRSSD     READE@B7CPZA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0012           ITD Sequence Nu
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           B7C4NY    ADD  1         WL0012           ITD Sequence Nu
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@B7CPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0029  60       Job Time
     C                     MOVEL*BLANK    WN0030 10        User Id
     C                     MOVEL*BLANK    WN0031 10        Job Name
     C                     Z-ADD*ZERO     WN0032  70       Job Date
     C                     Z-ADD*ZERO     WN0033  20       Production Hour
     C                     Z-ADD*ZERO     WN0034 112       Production Weig
     C                     Z-ADD*ZERO     WN0035  50       Production Quan
     C                     Z-ADD*ZERO     WN0036  70       Production Piec
     C                     MOVEL*BLANK    WN0037  1        Export_Domestic
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B7CPJZ
     C                     Z-ADDWL0013    WAAIC3           Company Number
     C                     Z-ADDWL0014    WAHGCD           Item Code
     C                     MOVELWL0015    WAAJCD           Warehouse Code
     C                     MOVELWL0016    WAW9ST           Inventory Trans
     C                     MOVELWL0017    WABSST           Inventory Trans
     C                     Z-ADDWL0018    WAB4DT           Transaction Dat
     C                     Z-ADDWL0019    WAC4NY           ITD Sequence Nu
     C                     Z-ADDWL0020    WADXNB           Sequence Number
     C                     Z-ADDWL0021    WAELDT           Production Date
     C                     MOVELWL0022    WAHVCD           UOM Transaction
     C                     MOVELWL0023    WAF1ST           Item Transactio
     C                     MOVELWL0024    WAAUNA           Description
     C                     Z-ADDWL0025    WAA5QT           Transaction Qua
     C                     Z-ADDWL0026    WAAHWG           Transaction Wei
     C                     Z-ADDWL0027    WAAKCS           USR Transaction
     C                     MOVELWL0028    WACGCD           UOM Cost
     C                     Z-ADDWL0029    WAAYVA           Extended Amount
     C                     MOVELWL0030    WABJNA           Ticket Number
     C                     Z-ADDWL0031    WACKNB           GL Document Num
     C                     MOVELWL0032    WABMST           GL Update Statu
     C                     MOVELWL0033    WACQCD           Reason Code
     C                     MOVELWL0034    WADTCD           Reference Numbe
     C                     MOVELWL0035    WAMGNA           Lot ID
     C                     Z-ADDWL0036    WATRBN           Transfer Batch
     C                     Z-ADDWL0037    WATRBS           Transfer Batch
     C                     Z-ADDWL0038    WAC4NB           Order Number
     C                     Z-ADDWL0039    WARINB           Item Structure
     C                     Z-ADDWL0040    WARHNB           Item Structure
     C                     Z-ADDWL0041    WARGNB           Item Structure
     C                     MOVELWL0042    WAM3NA           Employee Badge
     C                     Z-ADDWL0043    WAAWTM           Production Time
     C                     MOVELWL0044    WAXLCD           Shift Number
     C                     Z-ADDWL0045    WAK7DT           Label Date
     C                     MOVELWL0046    WAUVST           EDI Status 1
     C                     MOVELWL0047    WAUWST           EDI Status 2
     C                     MOVELWL0048    WAUXST           EDI Status 3
     C                     MOVELWL0049    WAVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##JOB     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WAAXDT    PARM *ZERO     WQ0004 155       Current System
     C           WAAATM    PARM *ZERO     WQ0005 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
     C           KLCRSE    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
     C                     KFLD           WAAJCD           Warehouse Code
     C                     KFLD           WAW9ST           Inventory Trans
     C                     KFLD           WABSST           Inventory Trans
     C                     KFLD           WAB4DT           Transaction Dat
     C                     KFLD           WAC4NY           ITD Sequence Nu
     C                     KFLD           WADXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSE    SETLL@B7CPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0345' W0RTN   7
      * Send message 'Item Transaction Detai EX'
     C                     MOVEL'USR0345' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@B7CPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                     CALL 'POO5XFR'              90  Crt Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0006  30       Company Number
     C                     PARM WAHGCD    WQ0007  70       Item Code
     C                     PARM WAAJCD    WQ0008  3        Warehouse Code
     C                     PARM WAW9ST    WQ0009  1        Inventory Trans
     C                     PARM WABSST    WQ0010  2        Inventory Trans
     C                     PARM WAB4DT    WQ0011  70       Transaction Dat
     C                     PARM WADXNB    WQ0012  30       Sequence Number
     C                     PARM WAELDT    WQ0013  70       Production Date
     C                     PARM WAHVCD    WQ0014  2        UOM Transaction
     C                     PARM WAF1ST    WQ0015  2        Item Transactio
     C                     PARM WAAUNA    WQ0016 30        Description
     C                     PARM WAA5QT    WQ0017 112       Transaction Qua
     C                     PARM WAAHWG    WQ0018 112       Transaction Wei
     C                     PARM WAAKCS    WQ0019 114       USR Transaction
     C                     PARM WACGCD    WQ0020  2        UOM Cost
     C                     PARM WAAYVA    WQ0021 112       Extended Amount
     C                     PARM WABJNA    WQ0022  6        Ticket Number
     C                     PARM WACKNB    WQ0023  80       GL Document Num
     C                     PARM WABMST    WQ0024  1        GL Update Statu
     C                     PARM WACQCD    WQ0025  3        Reason Code
     C                     PARM WADTCD    WQ0026 15        Reference Numbe
     C                     PARM WAMGNA    WQ0027 10        Lot ID
     C                     PARM WATRBN    WQ0028  70       Transfer Batch
     C                     PARM WATRBS    WQ0029  30       Transfer Batch
     C                     PARM WAC4NB    WQ0030  70       Order Number
     C                     PARM WARINB    WQ0031  30       Item Structure
     C                     PARM WARHNB    WQ0032  30       Item Structure
     C                     PARM WARGNB    WQ0033  30       Item Structure
     C                     PARM WAM3NA    WQ0034 10        Employee Badge
     C                     PARM WAAWTM    WQ0035  60       Production Time
     C                     PARM WAXLCD    WQ0036  1        Shift Number
     C                     PARM WAK7DT    WQ0037  70       Label Date
     C                     PARM WAVSST    WQ0038  1        Record Status
     C                     PARM WAAATM    WQ0039  60       Job Time
     C                     PARM WAAXDT    WQ0040  70       Job Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * CHG Value/Qty/Wgt      CH - Item Balance Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0038 112       Physical Count
     C                     Z-ADD*ZERO     WN0039 112       Physical Count
     C                     Z-ADD*ZERO     WN0040 112       Physical Count
     C                     Z-ADD*ZERO     WN0041 112       Physical Count
     C                     MOVEL*BLANK    WN0042  1        Physical Count
     C                     Z-ADD*ZERO     WN0043 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0044 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0045 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0046 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0047 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0048 112       Weight In Chill
     C                     MOVEL*BLANK    WN0049  1        Update Exceptio
     C                     Z-ADD*ZERO     WN0050 112       Physical Start
     C                     Z-ADD*ZERO     WN0051 112       Physical Start
     C                     Z-ADD*ZERO     WN0052 112       Physical Start
     C                     Z-ADD*ZERO     WN0053 112       Physical Start
     C                     Z-ADD*ZERO     WN0054  70       Physical Start
     C                     Z-ADD*ZERO     WN0055 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0056 114       Last Cost
     C                     Z-ADD*ZERO     WN0057 112       Value of On Han
     C                     Z-ADD*ZERO     WN0058  70       Label Date
     C                     MOVEL*BLANK    WN0059  1        EDI Status 1
     C                     MOVEL*BLANK    WN0060  1        EDI Status 2
     C                     MOVEL*BLANK    WN0061  1        EDI Status 3
     C                     MOVEL*BLANK    WN0062  1        Record Status
     C                     Z-ADD*ZERO     WN0063  60       Job Time
     C                     MOVEL*BLANK    WN0064 10        User Id
     C                     MOVEL*BLANK    WN0065 10        Job Name
     C                     Z-ADD*ZERO     WN0066  70       Job Date
     C                     MOVEL*BLANK    WN0067  1        Shift Number
     C                     MOVEL*BLANK    WN0068  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
     C                     MOVEL'1'       WN0067           Shift Number
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWL0050    B1AIC3           Company Number
     C                     Z-ADDWL0051    B1HGCD           Item Code
     C                     MOVELWL0052    B1AJCD    P      Warehouse Code
     C                     Z-ADDWL0053    B1ELDT           Production Date
      *
     C           KLCHSF    KLIST
     C                     KFLD           B1AIC3           Company Number
     C                     KFLD           B1HGCD           Item Code
     C                     KFLD           B1AJCD           Warehouse Code
     C                     KFLD           B1ELDT           Production Date
     C           KLCHSF    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0050    WL0076           Company Number
     C                     Z-ADDWL0051    WL0077           Item Code
     C                     MOVELWL0052    WL0078    P      Warehouse Code
     C                     Z-ADDWL0053    WL0079           Production Date
     C                     Z-ADD*ZERO     WL0080           Physical Count
     C                     Z-ADD*ZERO     WL0081           Physical Count
     C                     Z-ADD*ZERO     WL0082           Physical Count
     C                     Z-ADD*ZERO     WL0083           Physical Count
     C                     MOVEL*BLANK    WL0084           Physical Count
     C                     Z-ADDWL0071    WL0085           Quantity on Han
     C                     Z-ADDWL0070    WL0086           Quantity on Han
     C                     Z-ADD*ZERO     WL0087           Quantity on Han
     C                     Z-ADD*ZERO     WL0088           Quantity on Han
     C                     Z-ADD*ZERO     WL0089           Quantity In Chi
     C                     Z-ADD*ZERO     WL0090           Weight In Chill
     C                     MOVEL'N'       WL0091    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0092           Physical Start
     C                     Z-ADD*ZERO     WL0093           Physical Start
     C                     Z-ADD*ZERO     WL0094           Physical Start
     C                     Z-ADD*ZERO     WL0095           Physical Start
     C                     Z-ADD*ZERO     WL0096           Physical Start
     C                     Z-ADD*ZERO     WL0097           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0098           Last Cost
     C                     Z-ADDWL0074    WL0099           Value of On Han
     C                     Z-ADDWL0075    WL0100           Label Date
     C                     Z-ADDWL0054    WL0101           Item Structure
     C                     Z-ADDWL0055    WL0102           Item Structure
     C                     Z-ADDWL0056    WL0103           Item Structure
     C                     MOVEL*BLANK    WL0104           EDI Status 1
     C                     MOVEL*BLANK    WL0105           EDI Status 2
     C                     MOVEL*BLANK    WL0106           EDI Status 3
     C                     MOVEL'A'       WL0107    P      Record Status
     C                     EXSR SGCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWL0054    B1RINB           Item Structure
     C                     Z-ADDWL0055    B1RHNB           Item Structure
     C                     Z-ADDWL0056    B1RGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YARDC            *Record Data Ch
     C                     ADD  WL0070    B1ARQT           Quantity on Han
     C                     ADD  WL0071    B1ACWG           Quantity on Han
     C                     ADD  WL0074    B1IDVA           Value of On Han
      * If quantity is zero, so are weight, value of inventory
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           B1ARQT    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - Item Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM B1AIC3    WQ0043  30       Company Number
     C                     PARM B1HGCD    WQ0044  70       Item Code
     C                     PARM B1AJCD    WQ0045  3        Warehouse Code
     C                     PARM WL0068    WQ0046  70       Transaction Dat
     C                     PARM B1ELDT    WQ0047  70       Production Date
     C                     PARM WL0069    WQ0048  2        UOM Transaction
     C                     PARM B1ACWG    WQ0049 112       Transaction Wei
     C                     PARM WL0072    WQ0050 114       USR Transaction
     C                     PARM WL0073    WQ0051  2        UOM Cost
     C                     PARM B1RINB    WQ0052  30       Item Structure
     C                     PARM B1RHNB    WQ0053  30       Item Structure
     C                     PARM B1RGNB    WQ0054  30       Item Structure
     C                     PARM WN0067    WQ0055  1        Shift Number
     C                     PARM B1K7DT    WQ0056  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADD*ZERO     B1ACWG           Quantity on Han
     C                     Z-ADD*ZERO     B1IDVA           Value of On Han
     C                     END                             *FI
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     B1AATM           Job Time
     C                     MOVEL##USR     B1AYNA           User Id
     C                     MOVEL##JOB     B1A0NA           Job Name
     C                     Z-ADD##JDT     B1AXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           B1AXDT    PARM *ZERO     WQ0057 155       Current System
     C           B1AATM    PARM *ZERO     WQ0058 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           B1ARQT    IFEQ WUW0NB                     *IF
      * Rtv Lot Tracking Flag RT - Warehouse  * 
     C                     EXSR SHRVGN
      * CASE: PAR.Lot Tracking Flag is Not Yes
     C           WN0068    IFEQ *BLANK                     *IF
     C           WN0068    OREQ 'N'
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDB1AIC3    WL0108           Company Number
     C                     Z-ADDB1HGCD    WL0109           Item Code
     C                     MOVELB1AJCD    WL0110    P      Warehouse Code
     C                     Z-ADDB1ELDT    WL0111           Production Date
     C                     EXSR SIDLRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0069  60       Job Time
     C                     MOVEL*BLANK    WN0070 10        User Id
     C                     MOVEL*BLANK    WN0071 10        Job Name
     C                     Z-ADD*ZERO     WN0072  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1REJ1
     C                     Z-ADDWL0076    B1AIC3           Company Number
     C                     Z-ADDWL0077    B1HGCD           Item Code
     C                     MOVELWL0078    B1AJCD           Warehouse Code
     C                     Z-ADDWL0079    B1ELDT           Production Date
     C                     Z-ADDWL0080    B1ABWG           Physical Count
     C                     Z-ADDWL0081    B1AGQT           Physical Count
     C                     Z-ADDWL0082    B1AHQT           Physical Count
     C                     Z-ADDWL0083    B1AIQT           Physical Count
     C                     MOVELWL0084    B1CTST           Physical Count
     C                     Z-ADDWL0085    B1ACWG           Quantity on Han
     C                     Z-ADDWL0086    B1ARQT           Quantity on Han
     C                     Z-ADDWL0087    B1ASQT           Quantity on Han
     C                     Z-ADDWL0088    B1ATQT           Quantity on Han
     C                     Z-ADDWL0089    B1HDQT           Quantity In Chi
     C                     Z-ADDWL0090    B1HEQT           Weight In Chill
     C                     MOVELWL0091    B1F6ST           Update Exceptio
     C                     Z-ADDWL0092    B1BMWG           Physical Start
     C                     Z-ADDWL0093    B1DSQT           Physical Start
     C                     Z-ADDWL0094    B1DTQT           Physical Start
     C                     Z-ADDWL0095    B1DUQT           Physical Start
     C                     Z-ADDWL0096    B1DHDT           Physical Start
     C                     Z-ADDWL0097    B1AGCS           Unit Cost Per P
     C                     Z-ADDWL0098    B1AECS           Last Cost
     C                     Z-ADDWL0099    B1IDVA           Value of On Han
     C                     Z-ADDWL0100    B1K7DT           Label Date
     C                     Z-ADDWL0101    B1RINB           Item Structure
     C                     Z-ADDWL0102    B1RHNB           Item Structure
     C                     Z-ADDWL0103    B1RGNB           Item Structure
     C                     MOVELWL0104    B1UVST           EDI Status 1
     C                     MOVELWL0105    B1UWST           EDI Status 2
     C                     MOVELWL0106    B1UXST           EDI Status 3
     C                     MOVELWL0107    B1VSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     B1AATM           Job Time
     C                     MOVEL##USR     B1AYNA           User Id
     C                     MOVEL##JOB     B1A0NA           Job Name
     C                     Z-ADD##JDT     B1AXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           B1AXDT    PARM *ZERO     WQ0041 155       Current System
     C           B1AATM    PARM *ZERO     WQ0042 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
     C           KLCRSG    KLIST
     C                     KFLD           B1AIC3           Company Number
     C                     KFLD           B1HGCD           Item Code
     C                     KFLD           B1AJCD           Warehouse Code
     C                     KFLD           B1ELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSG    SETLL@B1REJ1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0331' W0RTN   7
      * Send message 'Item Balance Detail    EX'
     C                     MOVEL'USR0331' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@B1REJ1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELB1AJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0068           Lot Tracking Fl
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADVHST    WN0068           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIDLRC    BEGSR
      *================================================================
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDWL0108    B1AIC3           Company Number
     C                     Z-ADDWL0109    B1HGCD           Item Code
     C                     MOVELWL0110    B1AJCD           Warehouse Code
     C                     Z-ADDWL0111    B1ELDT           Production Date
      *
     C           KLDLSI    KLIST
     C                     KFLD           B1AIC3           Company Number
     C                     KFLD           B1HGCD           Item Code
     C                     KFLD           B1AJCD           Warehouse Code
     C                     KFLD           B1ELDT           Production Date
     C           KLDLSI    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0115           Quantity on Han
     C                     Z-ADD*ZERO     WL0116           Quantity on Han
     C                     Z-ADD*ZERO     WL0117           Quantity on Han
     C                     Z-ADD*ZERO     WL0118           Quantity on Han
     C                     Z-ADD*ZERO     WL0119           Value of On Han
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WBHGCD    WQSJ02           Item Code
     C           *LIKE     DEFN WBAJCD    WQSJ03           Warehouse Code
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Item Code
     C                     KFLD           WQSJ03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0112    WQSJ01           Company Number
     C                     Z-ADDWL0113    WQSJ02           Item Code
     C                     MOVELWL0114    WQSJ03           Warehouse Code
      * Establish starting position
     C           KRSSJ     SETLLCAB1RL4                    *
     C           KRSSJ     READECAB1RL4                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WBACWG    WL0115           Quantity on Han
     C                     ADD  WBARQT    WL0116           Quantity on Han
     C                     ADD  WBASQT    WL0117           Quantity on Han
     C                     ADD  WBATQT    WL0118           Quantity on Han
     C                     ADD  WBIDVA    WL0119           Value of On Han
     C           KRSSJ     READECAB1RL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * Chg Val/Qty/Wgt        Ch - Item Balance  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0073 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0074 114       Last Cost
     C                     Z-ADD*ZERO     WN0075 114       Cost per Primar
     C                     Z-ADD*ZERO     WN0076 114       Cost per Pricin
     C                     Z-ADD*ZERO     WN0077 114       Revaluation Cos
     C                     Z-ADD*ZERO     WN0078  70       Revaluation Eff
     C                     MOVEL*BLANK    WN0079  1        Revaluation Cos
     C                     Z-ADD*ZERO     WN0080 114       Last Revaluatio
     C                     Z-ADD*ZERO     WN0081  70       Last Revaluatio
     C                     Z-ADD*ZERO     WN0082 112       On Hand UOM2 Su
     C                     Z-ADD*ZERO     WN0083 112       On Hand UOM3 Su
     C                     Z-ADD*ZERO     WN0084 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0085 112       Weight In Chill
     C                     Z-ADD*ZERO     WN0086 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0087 112       Quantity on Sal
     C                     Z-ADD*ZERO     WN0088 112       Quantity on Pur
     C                     Z-ADD*ZERO     WN0089 112       Quantity on Tra
     C                     Z-ADD*ZERO     WN0090 112       Quantity Avail
     C                     MOVEL*BLANK    WN0091  3        Cycle Count Cod
     C                     Z-ADD*ZERO     WN0092  70       Date of Last Or
     C                     Z-ADD*ZERO     WN0093  70       Date of Last Sh
     C                     MOVEL*BLANK    WN0094  1        Inventory Plann
     C                     Z-ADD*ZERO     WN0095  52       Safety Allowanc
     C                     Z-ADD*ZERO     WN0096 112       Safety Allowanc
     C                     Z-ADD*ZERO     WN0097  70       Stock Out Date
     C                     MOVEL*BLANK    WN0098  3        Buyer Code
     C                     Z-ADD*ZERO     WN0099  30       Lead Time Last
     C                     Z-ADD*ZERO     WN0100  70       Lead Time Date
     C                     Z-ADD*ZERO     WN0101  30       Lead Time Next
     C                     Z-ADD*ZERO     WN0102  70       Lead Time Date
     C                     MOVEL*BLANK    WN0103  1        Lead Time Excep
     C                     Z-ADD*ZERO     WN0104 112       Usage Qty per C
     C                     Z-ADD*ZERO     WN0105 112       Usage Weight pe
     C                     Z-ADD*ZERO     WN0106  70       Inventory Manag
     C                     Z-ADD*ZERO     WN0107 112       Minimum Quantit
     C                     Z-ADD*ZERO     WN0108 112       Maximum Quantit
     C                     Z-ADD*ZERO     WN0109  70       Last Physical C
     C                     MOVEL*BLANK    WN0110  1        Requisition Mod
     C                     MOVEL*BLANK    WN0111  1        Cost Update Pen
     C                     MOVEL*BLANK    WN0112  1        Post GL Status
     C                     Z-ADD*ZERO     WN0113  80       Vendor Item_Whs
     C                     Z-ADD*ZERO     WN0114  30       Item Structure
     C                     Z-ADD*ZERO     WN0115  30       Item Structure
     C                     Z-ADD*ZERO     WN0116  30       Item Structure
     C                     MOVEL*BLANK    WN0117  1        EDI Status 1
     C                     MOVEL*BLANK    WN0118  1        EDI Status 2
     C                     MOVEL*BLANK    WN0119  1        EDI Status 3
     C                     MOVEL*BLANK    WN0120  1        Record Status
     C                     Z-ADD*ZERO     WN0121  60       Job Time
     C                     MOVEL*BLANK    WN0122 10        User Id
     C                     MOVEL*BLANK    WN0123 10        Job Name
     C                     Z-ADD*ZERO     WN0124  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWL0120    B0AIC3           Company Number
     C                     Z-ADDWL0121    B0HGCD           Item Code
     C                     MOVELWL0122    B0AJCD    P      Warehouse Code
      *
     C           KLCHSK    KLIST
     C                     KFLD           B0AIC3           Company Number
     C                     KFLD           B0HGCD           Item Code
     C                     KFLD           B0AJCD           Warehouse Code
     C           KLCHSK    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YBRDCS
      * Move non-key fields to @B0REJT
     C                     Z-ADDWL0123    B0BOWG           On Hand Weight
     C                     Z-ADDWL0124    B0DDQT           On Hand UOM1 Su
     C                     Z-ADDWL0125    B0IDVA           Value of On Han
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YBRDC            *Record Data Ch
      * Refresh the available to sell quantity
     C                     Z-ADDB0DDQT    B0DOQT           Quantity Avail
     C                     SUB  B0AQQT    B0DOQT           Quantity Avail
     C                     SUB  B0AUQT    B0DOQT           Quantity Avail
     C                     SUB  B0EMQT    B0DOQT           Quantity Avail
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     B0AATM           Job Time
     C                     MOVEL##USR     B0AYNA           User Id
     C                     MOVEL##JOB     B0A0NA           Job Name
     C                     Z-ADD##JDT     B0AXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Warehouse Info     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0126    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSL     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0127           Warehouse Descr
     C                     MOVEL*BLANK    WL0128           Address Line 1
     C                     MOVEL*BLANK    WL0129           Address Line 2
     C                     MOVEL*BLANK    WL0130           Address Line 3
     C                     MOVEL*BLANK    WL0131           City
     C                     MOVEL*BLANK    WL0132           Zip Postal Code
     C                     MOVEL*BLANK    WL0133           Production Ware
     C                     MOVEL*BLANK    WL0134           State Code
     C                     MOVEL*BLANK    WL0135           Lot Tracking Fl
     C                     MOVEL*BLANK    WL0136           Default Printer
     C                     MOVEL*BLANK    WL0137           Warehouse Type
     C                     MOVEL*BLANK    WL0138           Trans Contol AS
     C                     MOVEL*BLANK    WL0139           Warehouse Locat
     C                     MOVEL*BLANK    WL0140           Warehouse Std C
     C                     Z-ADD*ZERO     WL0141           Warehouse Chill
     C                     MOVEL*BLANK    WL0142           Include in Auto
     C                     MOVEL*BLANK    WL0143           Default Manifes
     C                     MOVEL*BLANK    WL0144           Default Load Se
     C                     MOVEL*BLANK    WL0145           WHS Slotting Li
     C                     Z-ADD*ZERO     WL0146           Shipping Compan
     C                     Z-ADD*ZERO     WL0147           Accounting Comp
     C                     Z-ADD*ZERO     WL0148           WHS Sched Prod
     C                     Z-ADD*ZERO     WL0149           WHS Inventory C
     C                     MOVEL*BLANK    WL0150           Parent Warehous
     C                     MOVEL*BLANK    WL0151           Default Shippin
     C                     MOVEL*BLANK    WL0152           WHS Live with C
     C                     MOVEL*BLANK    WL0153           WHS PFS Interfa
     C                     MOVEL*BLANK    WL0154           WHS Req Meter R
     C                     MOVEL*BLANK    WL0155           WHS Default Loa
     C                     MOVEL*BLANK    WL0156           WHS TMS Plannin
     C                     MOVEL*BLANK    WL0157           Default Carrier
     C                     MOVEL*BLANK    WL0158           Inventory Logic
     C                     MOVEL*BLANK    WL0159           WHS Auto Inv Re
     C                     MOVEL*BLANK    WL0160           EDI Status 1
     C                     MOVEL*BLANK    WL0161           EDI Status 2
     C                     MOVEL*BLANK    WL0162           EDI Status 3
     C                     MOVEL*BLANK    WL0163           Record Status
     C                     Z-ADD*ZERO     WL0164           Job Time
     C                     MOVEL*BLANK    WL0165           User Id
     C                     MOVEL*BLANK    WL0166           Job Name
     C                     Z-ADD*ZERO     WL0167           Job Date
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADF8NA    WL0127           Warehouse Descr
     C                     MOVELADACNA    WL0128           Address Line 1
     C                     MOVELADADNA    WL0129           Address Line 2
     C                     MOVELADAENA    WL0130           Address Line 3
     C                     MOVELADAJNA    WL0131           City
     C                     MOVELADBTTX    WL0132           Zip Postal Code
     C                     MOVELADAOCD    WL0133           Production Ware
     C                     MOVELADBGCD    WL0134           State Code
     C                     MOVELADVHST    WL0135           Lot Tracking Fl
     C                     MOVELADMPNA    WL0136           Default Printer
     C                     MOVELADWPST    WL0137           Warehouse Type
     C                     MOVELADXUST    WL0138           Trans Contol AS
     C                     MOVELADT0ST    WL0139           Warehouse Locat
     C                     MOVELADT1ST    WL0140           Warehouse Std C
     C                     Z-ADDADDBNB    WL0141           Warehouse Chill
     C                     MOVELADT2ST    WL0142           Include in Auto
     C                     MOVELADT3ST    WL0143           Default Manifes
     C                     MOVELADT4ST    WL0144           Default Load Se
     C                     MOVELADT6ST    WL0145           WHS Slotting Li
     C                     Z-ADDADBWC3    WL0146           Shipping Compan
     C                     Z-ADDADBTC3    WL0147           Accounting Comp
     C                     Z-ADDADBUC3    WL0148           WHS Sched Prod
     C                     Z-ADDADBVC3    WL0149           WHS Inventory C
     C                     MOVELADFCAA    WL0150           Parent Warehous
     C                     MOVELADRQSX    WL0151           Default Shippin
     C                     MOVELADRRSX    WL0152           WHS Live with C
     C                     MOVELADRSSX    WL0153           WHS PFS Interfa
     C                     MOVELADRTSX    WL0154           WHS Req Meter R
     C                     MOVELADT7ST    WL0155           WHS Default Loa
     C                     MOVELADT8ST    WL0156           WHS TMS Plannin
     C                     MOVELADRNSX    WL0157           Default Carrier
     C                     MOVELADROSX    WL0158           Inventory Logic
     C                     MOVELADRPSX    WL0159           WHS Auto Inv Re
     C                     MOVELADUVST    WL0160           EDI Status 1
     C                     MOVELADUWST    WL0161           EDI Status 2
     C                     MOVELADUXST    WL0162           EDI Status 3
     C                     MOVELADVSST    WL0163           Record Status
     C                     Z-ADDADAATM    WL0164           Job Time
     C                     MOVELADAYNA    WL0165           User Id
     C                     MOVELADA0NA    WL0166           Job Name
     C                     Z-ADDADAXDT    WL0167           Job Date
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Whse Location Info RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN L2AJCD    WQSM01           Warehouse Code
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Warehouse Code
      * Setup key
     C                     MOVELWL0168    WQSM01           Warehouse Code
      * Establish starting position
     C           KRSSM     SETLL@L2RESM                    *
     C           KRSSM     READE@L2RESM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0169           Location Code
     C                     MOVEL*BLANK    WL0170           Location Aisle
     C                     Z-ADD*ZERO     WL0171           Location Bay
     C                     Z-ADD*ZERO     WL0172           Loc Unused Chil
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELL2YMCD    WL0169           Location Code
     C                     MOVELL2YPCD    WL0170           Location Aisle
     C                     Z-ADDL2LCBY    WL0171           Location Bay
     C                     Z-ADDL2LCCT    WL0172           Loc Unused Chil
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@L2RESM                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Order Type         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0173    BEAIC3           Company Number
     C                     Z-ADDWL0174    BEC4NB           Order Number
      * Establish starting position
     C           KRSSN     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELBEJNCD    WL0175           Order Type_Sale
     C                     GOTO SNEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           DPDOCD           System Value Co
      * Setup key
     C                     MOVELWL0176    DPDOCD           System Value Co
      * Establish starting position
     C           KRSSO     CHAIN@DPRETD              90    *
      * Data record not found
     C   90                MOVEL'USR0759' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDDPM8NB    WL0177           System Value Nu
     C                     GOTO SOEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSP01           Application Cod
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSP01           Application Cod
     C                     MOVEL'I/C'     WQSP01           Application Cod
      * Establish starting position
     C           KRSSP     SETLL@DNRESF                    *
     C           KRSSP     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SQRVGN
     C                     END                             *FI
     C           KRSSP     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSQ01           Application Cod
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSQ01           Application Cod
      * Establish starting position
     C           KRSSQ     SETLL@DNRESF                    *
     C           KRSSQ     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSQ     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      *
      *================================================================
      * If detail entry required then bypass edits if no entry made
      * CASE: PAR.USR Detail Confirm Req'd is yes
     C           'N'       IFEQ 'Y'                        *IF
      * Both quantities are zero then *Quit
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Transaction Quantity is Equal to zero
      *   |- c2    : PAR.Transaction Weight is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RBAQT    IFEQ 0                          *IF
     C           #RASWG    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#RBAQT    ZA0004           Transaction Qua
     C                     Z-ADD#RASWG    ZA0005           Transaction Wei
      * Send message 'Qty or Weight Required'
     C                     MOVEL'USR1583' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983233*
      *
     C                     GOTO UAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Edit for field values
      * CASE: PAR.Field Value Edit is Positive
     C           'B'       IFEQ 'P'                        *IF
      * Edit quantity
      * CASE: PAR.Transaction Quantity is Less than zero
     C           #RBAQT    IFLT 0                          *IF
      * Setup message data for message
      * Send message 'Quantity cannot be neg.'
     C                     MOVEL'USR0416' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     END                             *FI
      * Edit weight
      * CASE: PAR.Transaction Weight is Less than zero
     C           #RASWG    IFLT 0                          *IF
      * Setup message data for message
      * Send message 'Transaction wgt must be +'
     C                     MOVEL'USR0539' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Field Value Edit is Negative
     C           'B'       IFEQ 'N'                        *IF
      * Edit quantity
      * CASE: PAR.Transaction Quantity is Greater than zero
     C           #RBAQT    IFGT 0                          *IF
      * Setup message data for message
      * Send message 'Quantity cannot be pos.'
     C                     MOVEL'USR0911' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     END                             *FI
      * Edit weight
      * CASE: PAR.Transaction Weight is Greater than zero
     C           #RASWG    IFGT 0                          *IF
      * Setup message data for message
      * Send message 'Transaction wgt must be -'
     C                     MOVEL'USR0912' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Edit for quantity and weight match
      * CASE: PAR.Transaction Quantity is Greater than zero
     C           #RBAQT    IFGT 0                          *IF
      * CASE: PAR.Transaction Weight is Less than zero
     C           #RASWG    IFLT 0                          *IF
      * Setup message data for message
      * Send message 'Transaction sign mismatch'
     C                     MOVEL'USR0383' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983233*
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Transaction Weight is Greater than zero
      *   |- c2    : PAR.Transaction Quantity is not equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RASWG    IFGT 0                          *IF
     C           #RBAQT    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Send message 'Transaction sign mismatch'
     C                     MOVEL'USR0383' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983233*
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1ELDT    IFEQ *ZERO                      Post to G_L Dat
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G_L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1ELDT    AFBCDT
     C           KLVAAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Calendar Master        NF'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1DHDT    IFEQ *ZERO                      Post to G_L Dat
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G_L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1DHDT    AFBCDT
     C           KLVBAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Calendar Master        NF'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Class
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RINB'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1RINB' defaulted for 'Item Structure Class Code'.
     C                     CALL 'PDELSRR'              90  SEL Item Class
     C                     PARM *BLANK    W0RTN   7
     C           #1RINB    PARM #1RINB    WQ0001  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDELSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1RINB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RINB    IFEQ *ZERO                      Item Structure
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCFA    KLIST
     C                     KFLD           FARINB           Item Structure
      * Setup key
     C                     Z-ADD#1RINB    FARINB
     C           KLVCFA    CHAIN@FAREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Item Structure Class   NF'
     C                     MOVEL'USR1170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1170' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RHNB'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1RHNB' defaulted for 'Item Structure Group Code'.
     C                     CALL 'PDEMSRR'              90  SEL Item Group
     C                     PARM *BLANK    W0RTN   7
     C           #1RHNB    PARM #1RHNB    WQ0002  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1RHNB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RHNB    IFEQ *ZERO                      Item Structure
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDE9    KLIST
     C                     KFLD           E9RHNB           Item Structure
      * Setup key
     C                     Z-ADD#1RHNB    E9RHNB
     C           KLVDE9    CHAIN@E9REA8              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Item Structure Group   NF'
     C                     MOVEL'USR1168' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1168' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Type
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RGNB'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1RGNB' defaulted for 'Item Structure Type Code'.
     C                     CALL 'PDENSRR'              90  SEL Item Type A
     C                     PARM *BLANK    W0RTN   7
     C           #1RGNB    PARM #1RGNB    WQ0003  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDENSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1RGNB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RGNB    IFEQ *ZERO                      Item Structure
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEE8    KLIST
     C                     KFLD           E8RGNB           Item Structure
      * Setup key
     C                     Z-ADD#1RGNB    E8RGNB
     C           KLVEE8    CHAIN@E8REBB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Item Structure Type    NF'
     C                     MOVEL'USR1166' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1166' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV2AIC3    WK1X01  1
     C                     MOVELV2HGCD    WK1X02  1
     C                     MOVEL#2AJCD    WK1X03  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#2AIC3'
     C           WK1X02    OREQ '?'                        Item Code
     C           YPMTFD    OREQ '#2HGCD'
     C           WK1X03    OREQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#2AJCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2AIC3' defaulted for 'Company Number'.
      * Field '(CTL) #2AJCD' defaulted for 'Warehouse Code'.
      * Field '(CTL) #2HGCD' defaulted for 'Item Code'.
     C                     CLEARPBRC
     C                     Z-ADD#2AIC3    PBAIC3           Company Number
     C                     MOVEL#2AJCD    PBAJCD    P      Warehouse Code
     C                     Z-ADD#2HGCD    PBHGCD           Item Code
      *
     C                     CALL 'PNMPSRR'              90  Sel Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Item Balan
      *
     C                     Z-ADDPBHGCD    #2HGCD           Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2HGCD    IFNE *ZERO                      Item Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X03    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VF999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVFWC    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     Z-ADD#2AIC3    WCAIC3
     C                     Z-ADD#2HGCD    WCHGCD
     C                     MOVEL#2AJCD    WCAJCD
     C           KLVFWC    CHAIN@B0REJX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
     C           VF999     TAG
      * Restrictor relation not satisfied
      * Send message 'Item Balance           NF'
     C                     MOVEL'USR0328' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0328' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD12        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
      *
     C           YPMRRN    IFGT *ZERO
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
     C                     END
     C                     END
      *
     C           ZHCSRW    IFEQ 008
     C           ZHCSCL    ANDEQ075
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CT5ST'  YPMTFD           USR Auto Calcul
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1F1ST           Item Transactio
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field UOM Transaction
     C                     MOVEL*BLANK    WUHVCD  2
      * Define work field USR Weight based on U/M1
     C                     Z-ADD*ZERO     WUBHWG 112
      * Define work field USR Weight based on U/M2
     C                     Z-ADD*ZERO     WUBIWG 112
      * Define work field USR Weight based on U/M3
     C                     Z-ADD*ZERO     WUBJWG 112
      * Define work field USR Weight
     C                     Z-ADD*ZERO     WUASWG 112
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WAC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WADXNB           Sequence Number
     C                     Z-ADD*ZERO     WAELDT           Production Date
     C                     Z-ADD*ZERO     WAA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WAAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WAAKCS           USR Transaction
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WACKNB           GL Document Num
     C                     Z-ADD*ZERO     WATRBN           Transfer Batch
     C                     Z-ADD*ZERO     WATRBS           Transfer Batch
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WAAWTM           Production Time
     C                     Z-ADD*ZERO     WAK7DT           Label Date
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Clear all neither parameters
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
     C                     Z-ADD*ZERO     B1AATM           Job Time
     C                     Z-ADD*ZERO     B1AXDT           Job Date
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBABWG           Physical Count
     C                     Z-ADD*ZERO     WBAGQT           Physical Count
     C                     Z-ADD*ZERO     WBAHQT           Physical Count
     C                     Z-ADD*ZERO     WBAIQT           Physical Count
     C                     Z-ADD*ZERO     WBACWG           Quantity on Han
     C                     Z-ADD*ZERO     WBARQT           Quantity on Han
     C                     Z-ADD*ZERO     WBASQT           Quantity on Han
     C                     Z-ADD*ZERO     WBATQT           Quantity on Han
     C                     Z-ADD*ZERO     WBHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WBHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WBBMWG           Physical Start
     C                     Z-ADD*ZERO     WBDSQT           Physical Start
     C                     Z-ADD*ZERO     WBDTQT           Physical Start
     C                     Z-ADD*ZERO     WBDUQT           Physical Start
     C                     Z-ADD*ZERO     WBDHDT           Physical Start
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAECS           Last Cost
     C                     Z-ADD*ZERO     WBIDVA           Value of On Han
     C                     Z-ADD*ZERO     WBK7DT           Label Date
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Location Code
     C                     MOVEL*BLANK    WUYMCD  4
      * Define work field Location Level
     C                     Z-ADD*ZERO     WUYNCD  20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAECS           Last Cost
     C                     Z-ADD*ZERO     WCBACS           Cost per Primar
     C                     Z-ADD*ZERO     WCBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WCCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WCGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WCCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WCG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WCBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WCDDQT           On Hand UOM1 Su
     C                     Z-ADD*ZERO     WCDEQT           On Hand UOM2 Su
     C                     Z-ADD*ZERO     WCDFQT           On Hand UOM3 Su
     C                     Z-ADD*ZERO     WCHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WCHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WCAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WCAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WCEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WCDOQT           Quantity Avail
     C                     Z-ADD*ZERO     WCAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WCANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WCIDVA           Value of On Han
     C                     Z-ADD*ZERO     WCBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WCDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WCDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WCBFDY           Lead Time Last
     C                     Z-ADD*ZERO     WCDJDT           Lead Time Date
     C                     Z-ADD*ZERO     WCBGDY           Lead Time Next
     C                     Z-ADD*ZERO     WCDKDT           Lead Time Date
     C                     Z-ADD*ZERO     WCDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WCBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WCDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WCDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WCDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WCDMDT           Last Physical C
     C                     Z-ADD*ZERO     WCAKC8           Vendor Item_Whs
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  30
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008  3
     C                     MOVEL*BLANK    WL0009  1
     C                     MOVEL*BLANK    WL0010  2
     C                     Z-ADD*ZERO     WL0011  70
     C                     Z-ADD*ZERO     WL0012  50
      * Define local variables for subroutine SECRRC.
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  70
     C                     MOVEL*BLANK    WL0015  3
     C                     MOVEL*BLANK    WL0016  1
     C                     MOVEL*BLANK    WL0017  2
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  50
     C                     Z-ADD*ZERO     WL0020  30
     C                     Z-ADD*ZERO     WL0021  70
     C                     MOVEL*BLANK    WL0022  2
     C                     MOVEL*BLANK    WL0023  2
     C                     MOVEL*BLANK    WL0024 30
     C                     Z-ADD*ZERO     WL0025 112
     C                     Z-ADD*ZERO     WL0026 112
     C                     Z-ADD*ZERO     WL0027 114
     C                     MOVEL*BLANK    WL0028  2
     C                     Z-ADD*ZERO     WL0029 112
     C                     MOVEL*BLANK    WL0030  6
     C                     Z-ADD*ZERO     WL0031  80
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  3
     C                     MOVEL*BLANK    WL0034 15
     C                     MOVEL*BLANK    WL0035 10
     C                     Z-ADD*ZERO     WL0036  70
     C                     Z-ADD*ZERO     WL0037  30
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039  30
     C                     Z-ADD*ZERO     WL0040  30
     C                     Z-ADD*ZERO     WL0041  30
     C                     MOVEL*BLANK    WL0042 10
     C                     Z-ADD*ZERO     WL0043  60
     C                     MOVEL*BLANK    WL0044  1
     C                     Z-ADD*ZERO     WL0045  70
     C                     MOVEL*BLANK    WL0046  1
     C                     MOVEL*BLANK    WL0047  1
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  1
      * Define local variables for subroutine SFCHRC.
     C                     Z-ADD*ZERO     WL0050  30
     C                     Z-ADD*ZERO     WL0051  70
     C                     MOVEL*BLANK    WL0052  3
     C                     Z-ADD*ZERO     WL0053  70
     C                     Z-ADD*ZERO     WL0054  30
     C                     Z-ADD*ZERO     WL0055  30
     C                     Z-ADD*ZERO     WL0056  30
     C                     MOVEL*BLANK    WL0057  2
     C                     Z-ADD*ZERO     WL0058  94
     C                     MOVEL*BLANK    WL0059  1
     C                     MOVEL*BLANK    WL0060  2
     C                     Z-ADD*ZERO     WL0061  94
     C                     MOVEL*BLANK    WL0062  1
     C                     MOVEL*BLANK    WL0063  2
     C                     MOVEL*BLANK    WL0064  1
     C                     MOVEL*BLANK    WL0065  1
     C                     MOVEL*BLANK    WL0066  1
     C                     MOVEL*BLANK    WL0067  2
     C                     Z-ADD*ZERO     WL0068  70
     C                     MOVEL*BLANK    WL0069  2
     C                     Z-ADD*ZERO     WL0070 112
     C                     Z-ADD*ZERO     WL0071 112
     C                     Z-ADD*ZERO     WL0072 114
     C                     MOVEL*BLANK    WL0073  2
     C                     Z-ADD*ZERO     WL0074 112
     C                     Z-ADD*ZERO     WL0075  70
      * Define local variables for subroutine SGCRRC.
     C                     Z-ADD*ZERO     WL0076  30
     C                     Z-ADD*ZERO     WL0077  70
     C                     MOVEL*BLANK    WL0078  3
     C                     Z-ADD*ZERO     WL0079  70
     C                     Z-ADD*ZERO     WL0080 112
     C                     Z-ADD*ZERO     WL0081 112
     C                     Z-ADD*ZERO     WL0082 112
     C                     Z-ADD*ZERO     WL0083 112
     C                     MOVEL*BLANK    WL0084  1
     C                     Z-ADD*ZERO     WL0085 112
     C                     Z-ADD*ZERO     WL0086 112
     C                     Z-ADD*ZERO     WL0087 112
     C                     Z-ADD*ZERO     WL0088 112
     C                     Z-ADD*ZERO     WL0089 112
     C                     Z-ADD*ZERO     WL0090 112
     C                     MOVEL*BLANK    WL0091  1
     C                     Z-ADD*ZERO     WL0092 112
     C                     Z-ADD*ZERO     WL0093 112
     C                     Z-ADD*ZERO     WL0094 112
     C                     Z-ADD*ZERO     WL0095 112
     C                     Z-ADD*ZERO     WL0096  70
     C                     Z-ADD*ZERO     WL0097 114
     C                     Z-ADD*ZERO     WL0098 114
     C                     Z-ADD*ZERO     WL0099 112
     C                     Z-ADD*ZERO     WL0100  70
     C                     Z-ADD*ZERO     WL0101  30
     C                     Z-ADD*ZERO     WL0102  30
     C                     Z-ADD*ZERO     WL0103  30
     C                     MOVEL*BLANK    WL0104  1
     C                     MOVEL*BLANK    WL0105  1
     C                     MOVEL*BLANK    WL0106  1
     C                     MOVEL*BLANK    WL0107  1
      * Define local variables for subroutine SIDLRC.
     C                     Z-ADD*ZERO     WL0108  30
     C                     Z-ADD*ZERO     WL0109  70
     C                     MOVEL*BLANK    WL0110  3
     C                     Z-ADD*ZERO     WL0111  70
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0112  30
     C                     Z-ADD*ZERO     WL0113  70
     C                     MOVEL*BLANK    WL0114  3
     C                     Z-ADD*ZERO     WL0115 112
     C                     Z-ADD*ZERO     WL0116 112
     C                     Z-ADD*ZERO     WL0117 112
     C                     Z-ADD*ZERO     WL0118 112
     C                     Z-ADD*ZERO     WL0119 112
      * Define local variables for subroutine SKCHRC.
     C                     Z-ADD*ZERO     WL0120  30
     C                     Z-ADD*ZERO     WL0121  70
     C                     MOVEL*BLANK    WL0122  3
     C                     Z-ADD*ZERO     WL0123 112
     C                     Z-ADD*ZERO     WL0124 112
     C                     Z-ADD*ZERO     WL0125 112
      * Define local variables for subroutine SLRVGN.
     C                     MOVEL*BLANK    WL0126  3
     C                     MOVEL*BLANK    WL0127 30
     C                     MOVEL*BLANK    WL0128 30
     C                     MOVEL*BLANK    WL0129 30
     C                     MOVEL*BLANK    WL0130 30
     C                     MOVEL*BLANK    WL0131 20
     C                     MOVEL*BLANK    WL0132 11
     C                     MOVEL*BLANK    WL0133  3
     C                     MOVEL*BLANK    WL0134  2
     C                     MOVEL*BLANK    WL0135  1
     C                     MOVEL*BLANK    WL0136 10
     C                     MOVEL*BLANK    WL0137  2
     C                     MOVEL*BLANK    WL0138  1
     C                     MOVEL*BLANK    WL0139  1
     C                     MOVEL*BLANK    WL0140  1
     C                     Z-ADD*ZERO     WL0141  52
     C                     MOVEL*BLANK    WL0142  1
     C                     MOVEL*BLANK    WL0143  1
     C                     MOVEL*BLANK    WL0144  1
     C                     MOVEL*BLANK    WL0145  1
     C                     Z-ADD*ZERO     WL0146  30
     C                     Z-ADD*ZERO     WL0147  30
     C                     Z-ADD*ZERO     WL0148  30
     C                     Z-ADD*ZERO     WL0149  30
     C                     MOVEL*BLANK    WL0150  3
     C                     MOVEL*BLANK    WL0151  1
     C                     MOVEL*BLANK    WL0152  1
     C                     MOVEL*BLANK    WL0153  1
     C                     MOVEL*BLANK    WL0154  1
     C                     MOVEL*BLANK    WL0155  2
     C                     MOVEL*BLANK    WL0156  2
     C                     MOVEL*BLANK    WL0157  3
     C                     MOVEL*BLANK    WL0158  3
     C                     MOVEL*BLANK    WL0159  3
     C                     MOVEL*BLANK    WL0160  1
     C                     MOVEL*BLANK    WL0161  1
     C                     MOVEL*BLANK    WL0162  1
     C                     MOVEL*BLANK    WL0163  1
     C                     Z-ADD*ZERO     WL0164  60
     C                     MOVEL*BLANK    WL0165 10
     C                     MOVEL*BLANK    WL0166 10
     C                     Z-ADD*ZERO     WL0167  70
      * Define local variables for subroutine SMRVGN.
     C                     MOVEL*BLANK    WL0168  3
     C                     MOVEL*BLANK    WL0169  4
     C                     MOVEL*BLANK    WL0170  2
     C                     Z-ADD*ZERO     WL0171  20
     C                     Z-ADD*ZERO     WL0172  52
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0173  30
     C                     Z-ADD*ZERO     WL0174  70
     C                     MOVEL*BLANK    WL0175  2
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0176 10
     C                     Z-ADD*ZERO     WL0177 155
      * Define local work field Inventory Updated USR
     C                     MOVEL*BLANK    YL0001  1
      * Define null work field API was Called? U
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Module Release Status
     C                     MOVEL*BLANK    YL0002  1
      * Define null work field Warehouse Description
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0005 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0006 20
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0007 11
      * Define null work field Production Warehouse Code
     C                     MOVEL*BLANK    YN0008  3
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0009  2
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0003  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0010 10
      * Define null work field Warehouse Type
     C                     MOVEL*BLANK    YN0011  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0012  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0004  1
      * Define null work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YN0013  1
      * Define null work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YN0014  52
      * Define null work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field Default Manifest Copies
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field Default Load Sequence
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field WHS Slotting Limit Type
     C                     MOVEL*BLANK    YN0018  1
      * Define null work field Shipping Company
     C                     Z-ADD*ZERO     YN0019  30
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0020  30
      * Define null work field WHS Sched Prod Max Days
     C                     Z-ADD*ZERO     YN0021  30
      * Define null work field WHS Inventory Chill Time
     C                     Z-ADD*ZERO     YN0022  30
      * Define null work field Parent Warehouse
     C                     MOVEL*BLANK    YN0023  3
      * Define null work field Default Shipping Whs
     C                     MOVEL*BLANK    YN0024  1
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0005  1
      * Define null work field WHS PFS Interface
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YN0026  1
      * Define null work field WHS Default Load Type
     C                     MOVEL*BLANK    YN0027  2
      * Define null work field WHS TMS Planning Region
     C                     MOVEL*BLANK    YN0028  2
      * Define null work field Default Carrier Code
     C                     MOVEL*BLANK    YN0029  3
      * Define null work field Inventory Logic Version
     C                     MOVEL*BLANK    YN0030  3
      * Define null work field WHS Auto Inv Restoration
     C                     MOVEL*BLANK    YN0031  3
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0032  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0035  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0036  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0037 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0038 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0039  70
      * Define local work field Location Aisle
     C                     MOVEL*BLANK    YL0006  2
      * Define local work field Location Bay
     C                     Z-ADD*ZERO     YL0007  20
      * Define local work field Loc Unused Chill Time
     C                     Z-ADD*ZERO     YL0008  52
      * Define local work field Order Type_Sales
     C                     MOVEL*BLANK    YL0009  2
      * Define local work field API EccResult-MsgId U
     C                     MOVEL*BLANK    YL0010  7
      * Define local work field API EccResult-MsgDesc U
     C                     MOVEL*BLANK    YL0011 50
      * Define local work field API Request Key U
     C                     MOVEL*BLANK    YL0012 10
      * Define local work field API Name
     C                     MOVEL*BLANK    YL0013 45
      * Define local work field API Wait Time U
     C                     Z-ADD*ZERO     YL0014  50
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      *
     C                     Z-ADD10        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SPRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'IC'      P1F1ST           Item Transactio
      * Prc Reset Field CAIN89 US - /UT User Source  * Turn off PUTOVR
      *  SETON INDICATOR 89 TO MAKE SURE PUTOVR IS TURNED OFF
     C                     MOVEL'1'       CAIN89  1
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 ICQ7EFR
00002 PDLYXFR
00003 wim.ordershipping.invento
00004 APIWAITTME
00005 ECC0000
00006 TIMEOUT
00007 PUGDXFR
00008 PDL8DFR
00009 PNTKXFR
00010 PUEJXFR
00011 PNTWXFR
00012 PDMLDFR
