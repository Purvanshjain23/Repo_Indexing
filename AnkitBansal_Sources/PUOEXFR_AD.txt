// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PUOEXFR
// ?Date: 14.08.2025 Time: 03:50:57
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?***NOTE: Similar logic also exist in PUS4XFR. Any logic changes
//?         here should also consider changing in PUS4XFR. ***
//?Update new CIR for EDI from POs that come in -- daily
//?Create WF record if order's item cant be determined
CASE;

// IF PAR.G5002-ORDER DATE EQ WRK.Blank Date            USR
IF PAR.G5002_ORDER_DATE = WRK.Blank_Date_USR;

// LCL.G5002-ORDER DATE = JOB.*Job date
LCL.G5002_ORDER_DATE = JOB.*Job_date;

// IF *OTHERWISE
IF *OTHERWISE;

// LCL.G5002-ORDER DATE = PAR.G5002-ORDER DATE
LCL.G5002_ORDER_DATE = PAR.G5002_ORDER_DATE;

ENDIF;

EXECUTE FUNCTION(Rtv Upd CIR 2 Product RT) TYPE(RTVOBJ) FILE(ECP004)            AC2176790;
PARAMETER(LCL.G5002_ORDER_DATE);
{
 //?USER: Initialize routine

 // LCL.First Time Flag = CND.Yes
 LCL.First_Time_Flag = 'Y';

 // WRK.G5002-ORDER DATE = CON.1190101
 WRK.G5002_ORDER_DATE = 1190101;

 //?USER: Process Data record

 //?every time
 CASE;

 // IF LCL.First Time Flag is Yes
 IF LCL.First_Time_Flag = 'Y';

 EXECUTE FUNCTION(Rtv All Hdr by Control RT) TYPE(RTVOBJ) FILE(ECP004)           AC2140646;
 PARAMETER(DB1.ST02_TRANS_SET_CONTROL_NU);
 PARAMETER(NLL.G5001_ORDER_STATUS_CODE);
 PARAMETER(LCL.Order_Date);
 PARAMETER(LCL.G5003_PURCHASE_ORDER_NUMB);
 PARAMETER(NLL.G6101_CONTACT_FUNCTION_CO);
 PARAMETER(NLL.G6102_CONTACT_NAME);
 PARAMETER(NLL.G6103_COMM_NUM_QUALIFIER);
 PARAMETER(NLL.G6104_COMM_NUMBER);
 PARAMETER(NLL.G6105_INQUIRY_REFERENCE);
 PARAMETER(NLL.SAC01_ALLOW_OR_CHG_INDICA);
 PARAMETER(NLL.SAC02_SERV_PROMO_ALLO_OR);
 PARAMETER(NLL.SAC05_$$_AMT_OF_ALLOW_CHG);
 PARAMETER(NLL.SAC12_ALLOW_CHG_CODE);
 PARAMETER(NLL.SAC15_Description);
 PARAMETER(LCL.DTM01_Ship_Date_Qualifier);
 PARAMETER(LCL.Requested_Ship_Date);
 PARAMETER(LCL.G6201_DATE_QUALIFIER);
 PARAMETER(LCL.Requested_Delivery_Date);
 PARAMETER(LCL.G6601_SHIPMENT_METHOD);
 PARAMETER(NLL.G6602_METHOD_TYPE_CODE);
 PARAMETER(NLL.G6603_PALLET_EXCHANGE_COD);
 PARAMETER(NLL.G6604_UNIT_LOAD_OPTION_CO);
 PARAMETER(NLL.G6605_ROUTING);
 PARAMETER(NLL.G6606_FOB_POINT_CODE);
 PARAMETER(LCL.G7601_QUANTITY_ORDERED);
 PARAMETER(NLL.G6802_BASIS_FOR_MEASUREME);
 PARAMETER(LCL.G7603_WEIGHT_ORDERED);
 PARAMETER(NLL.G7608_ORDER_AMOUNT);
 PARAMETER(NLL.EDI_RECORD_STATUS);
 PARAMETER(NLL.Customer_Ref_ID_Qualifier);
 PARAMETER(NLL.Customer_Ref_ID);
 PARAMETER(NLL.Internal_Ord_ID_Qualifier);
 PARAMETER(NLL.Internal_Order_number);
 PARAMETER(NLL.Buyer_ID_Qualifier);
 PARAMETER(NLL.Buyer_Identification);
 PARAMETER(NLL.Reference_Vs_Nbr_ID_Qual);
 PARAMETER(NLL.Ref_Version_Nbr);
 PARAMETER(NLL.Revision_Nbr_ID_Qualifier);
 PARAMETER(NLL.Revision_Nbr);
 PARAMETER(NLL.Ref_ID_Qualifier_01);
 PARAMETER(NLL.Reference_01);
 PARAMETER(NLL.Ref_ID_Qualifier_02);
 PARAMETER(LCL.OH_Order_Number);
 PARAMETER(NLL.Delivery_PO_Number);
 PARAMETER(LCL.Don_t_Create_Order_Reason);
 PARAMETER(NLL.POH_Date_Stamp_received);
 PARAMETER(NLL.POH_PO_Purpose_cde_OO);
 PARAMETER(LCL.EDI_Trading_Partner_No);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

 }

 //?* Get Duns Number for Ship To customer
 EXECUTE FUNCTION(Rtv All info by type  RT) TYPE(RTVOBJ) FILE(ECP006)            AC2140467;
 PARAMETER(DB1.ST02_TRANS_SET_CONTROL_NU);
 PARAMETER('ST');
 PARAMETER(LCL.N102_NAME);
 PARAMETER(LCL.N103_ID_CODE_QUALIFIER);
 PARAMETER(LCL.EDI_Shipto_Duns_Number);
 PARAMETER(NLL.N201_NAME);
 PARAMETER(NLL.N202_NAME);
 PARAMETER(LCL.N301_ADD);
 PARAMETER(NLL.N302_ADDRESS);
 PARAMETER(LCL.N401_CITY);
 PARAMETER(LCL.N402_STATE);
 PARAMETER(NLL.N403_POSTAL_CODE);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

 }

 CASE;

 // IF LCL.EDI Shipto Duns Number is Not Found
 IF LCL.EDI_Shipto_Duns_Number = *BLANK;

 EXECUTE FUNCTION(Rtv All info by type  RT) TYPE(RTVOBJ) FILE(ECP006)            AC2140467;
 PARAMETER(DB1.ST02_TRANS_SET_CONTROL_NU);
 PARAMETER('BS');
 PARAMETER(LCL.N102_NAME);
 PARAMETER(LCL.N103_ID_CODE_QUALIFIER);
 PARAMETER(LCL.EDI_Shipto_Duns_Number);
 PARAMETER(NLL.N201_NAME);
 PARAMETER(NLL.N202_NAME);
 PARAMETER(LCL.N301_ADD);
 PARAMETER(NLL.N302_ADDRESS);
 PARAMETER(LCL.N401_CITY);
 PARAMETER(LCL.N402_STATE);
 PARAMETER(NLL.N403_POSTAL_CODE);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

 }

 ENDIF;

 CASE;

 // IF LCL.EDI Shipto Duns Number is Not Found
 IF LCL.EDI_Shipto_Duns_Number = *BLANK;

 EXECUTE FUNCTION(Rtv All info by type  RT) TYPE(RTVOBJ) FILE(ECP006)            AC2140467;
 PARAMETER(DB1.ST02_TRANS_SET_CONTROL_NU);
 PARAMETER('BY');
 PARAMETER(LCL.N102_NAME);
 PARAMETER(LCL.N103_ID_CODE_QUALIFIER);
 PARAMETER(LCL.EDI_Shipto_Duns_Number);
 PARAMETER(NLL.N201_NAME);
 PARAMETER(NLL.N202_NAME);
 PARAMETER(LCL.N301_ADD);
 PARAMETER(NLL.N302_ADDRESS);
 PARAMETER(LCL.N401_CITY);
 PARAMETER(LCL.N402_STATE);
 PARAMETER(NLL.N403_POSTAL_CODE);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

 }

 ENDIF;

 //?* Get Ship To customer for Duns Number
 //?02/22/21 DN R17040-Changed to Check that EDI Trading Partner # matches.
 //?   Changed EDI Trading Partner No. Parm from output to input.
 EXECUTE FUNCTION(Rtv EDI ST by EDI Duns RT) TYPE(RTVOBJ) FILE(PDNEREP)          AC2140468;
 PARAMETER(LCL.Customer_Number_NBR);
 PARAMETER(DB1.EDI_Trading_Partner_No);
 PARAMETER(LCL.EDI_Shipto_Duns_Number);
 PARAMETER(NLL.Cust_Shipping_Temp_C_F);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  //?02/22/21 DN R17040-Old Logic. Commented Out.
  //?***NOTE: Any changes made here, should consider changes to
  //?         'Rtv Sales Rte-1st ShToRT - Customer EXT',
  //?         'PRT BT Cust by DUNS   PO - Customer EXT' &
  //?         'PRT ST Cust by DUNS   PO - Customer EXT' functions as
  //?         well. BOTH functions share the same Business Logic to get
  //?         the correct EDI Ship To Customer #. ***
  //?03/01/21 DN R17040-New Logic: Get 1st Active STC# by DUNS#/Trade Partner.
  CASE;

  // IF DB1.Record Status is Active
  IF DB1.Record_Status = 'A';

  //?Get Ship To Cust Flag & Bill To Customer #.
  EXECUTE FUNCTION(Rtv ShpTo Info/AR Cst RT) TYPE(RTVOBJ) FILE(CABBREP)           AC1522850;
  PARAMETER(DB1.Ship_To_Customer);
  PARAMETER(NLL.Customer_Name);
  PARAMETER(NLL.Address_Line_1);
  PARAMETER(NLL.Address_Line_2);
  PARAMETER(NLL.Address_Line_3);
  PARAMETER(NLL.City);
  PARAMETER(NLL.State_Code);
  PARAMETER(NLL.Zip_Postal_Code);
  PARAMETER(NLL.Telephone_Number_FF);
  PARAMETER(LCL.AR_Customer_Number);
  PARAMETER(NLL.Order_Entry_Hold);
  PARAMETER(LCL.Ship_To_Customer_Flag);
  {
   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  //?Must Be Use as Ship To Customer.
  CASE;

  // IF LCL.Ship To Customer Flag is Allow Use as Ship To Cust
  IF LCL.Ship_To_Customer_Flag = 'Y';

  EXECUTE FUNCTION(Rtv Trading Partner   RT) TYPE(RTVOBJ) FILE(PDNEREP)           AC2195397;
  PARAMETER(LCL.AR_Customer_Number);
  PARAMETER(LCL.EDI_Trading_Partner_No);
  {
   //?USER: Initialize routine

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  //?Match by Trading Partner for Bill To Customer.
  CASE;

  // IF PAR.EDI Trading Partner No. EQ LCL.EDI Trading Partner No.
  IF PAR.EDI_Trading_Partner_No = LCL.EDI_Trading_Partner_No;

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

  ENDIF;

  ENDIF;

  ENDIF;

 }

 ENDIF;

 EXECUTE FUNCTION(RTV Upd CIR 2 Product RT) TYPE(RTVOBJ) FILE(ECP005)            AC2176791;
 PARAMETER(DB1.ST02_TRANS_SET_CONTROL_NU);
 PARAMETER(0);
 PARAMETER(DB1.G5002_ORDER_DATE);
 PARAMETER(DB1.G5003_PURCHASE_ORDER_NUMB);
 PARAMETER(DB1.EDI_Trading_Partner_No);
 PARAMETER(LCL.Customer_Number_NBR);
 {
  //?USER: Initialize routine

  //?WI 458 RMC 1/25/2021 add resource "IN" (Walmrt sends it)
  //?  sent in G6807/PO110 Prod ID Qual
  //?USER: Process Data record

  //?W103972 DN 07/19/22-Initialize.
  // LCL.Crt Cust Item Ref for EDI = CND.No
  LCL.Crt_Cust_Item_Ref_for_EDI = 'N';

  //?Get Seaboard Item code
  // LCL.CIR Resource No = CON.*BLANK
  LCL.CIR_Resource_No = *BLANK;

  // PAR.Item Code Number 7.0  USR = CON.*ZERO
  PAR.Item_Code_Number_7_0_USR = *ZERO;

  CASE;

  // IF DB1.POD SBD Item Number is Entered
  IF DB1.POD_SBD_Item_Number <> 0;

  // PAR.Item Code Number 7.0  USR = DB1.POD SBD Item Number
  PAR.Item_Code_Number_7_0_USR = DB1.POD_SBD_Item_Number;

  // LCL.Item Code Exist USR = CND.Yes
  LCL.Item_Code_Exist_USR = 'Y';

  ENDIF;

  CASE;

  // IF PAR.Item Code Number 7.0  USR is Not Entered
  IF PAR.Item_Code_Number_7_0_USR = *ZERO;

  //?G6805 check
  CASE;

  // IF DB1.G6805/P108 PROD ID QUAL is Vendor Product
  IF DB1.G6805_P108_PROD_ID_QUAL = 'VP';

  // OR DB1.G6805/P108 PROD ID QUAL is Vendor Product 2
  OR DB1.G6805_P108_PROD_ID_QUAL = 'VN';

  // OR DB1.G6805/P108 PROD ID QUAL is Manufacturer Part Number
  OR DB1.G6805_P108_PROD_ID_QUAL = 'MG';

  // WRK.Text USR 7 = DB1.G6806/P109 PRODUCT ID
  WRK.Text_USR_7 = DB1.G6806_P109_PRODUCT_ID;

  // Execute function RTV Right Just  7 Alph US.
  EXECUTE FUNCTION(RTV Right Just  7 Alph US) TYPE(EXCUSRSRC) ('POM3UFR');
  PARAMETER(WRK.Text_USR_7);
  PARAMETER(WRK.Text_7_Alpha_Usr);
  {
   E                    A1         07  1
   E                    A2         07  1
   C                     MOVEAWUY8TX    A1
   C                     MOVEA*BLANKS   A2
   C                     MOVE 07        C1      20
   C                     MOVE 07        C2      20
   C           C1        DOWGT0
   C           A1,C1     IFNE ' '
   C                     MOVE A1,C1     A2,C2
   C           C2        SUB  1         C2
   C                     END
   C           C1        SUB  1         C1
   C                     END
   C                     MOVEAA2        WUZ3TX
  }

  // LCL.USR Item Code 7,0 signed = CVTVAR(WRK.Text 7 Alpha Usr)
  LCL.USR_Item_Code_70_signed = CVTVAR(WRK.Text_7_Alpha_Usr);

  // LCL.Item Code Number 7.0  USR = LCL.USR Item Code 7,0 signed
  LCL.Item_Code_Number_7_0_USR = LCL.USR_Item_Code_70_signed;

  EXECUTE FUNCTION(Rtv CIR Resource      RT) TYPE(RTVOBJ) FILE(POBIREP)           AC2159017;
  PARAMETER(PAR.Customer_Number_NBR);
  PARAMETER(LCL.Item_Code_Number_7_0_USR);
  PARAMETER(LCL.CIR_Resource_No);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  CASE;

  // IF LCL.CIR Resource No is Entered
  IF LCL.CIR_Resource_No <> *BLANK;

  // PAR.Item Code Number 7.0  USR = LCL.Item Code Number 7.0  USR
  PAR.Item_Code_Number_7_0_USR = LCL.Item_Code_Number_7_0_USR;

  // LCL.Item Code Exist USR = CND.Yes
  LCL.Item_Code_Exist_USR = 'Y';

  // IF *OTHERWISE
  IF *OTHERWISE;

  // LCL.Item Code Number 7.0  USR = CON.*ZERO
  LCL.Item_Code_Number_7_0_USR = *ZERO;

  ENDIF;

  ENDIF;

  ENDIF;

  //?G6807 check
  CASE;

  // IF PAR.Item Code Number 7.0  USR is Not Entered
  IF PAR.Item_Code_Number_7_0_USR = *ZERO;

  CASE;

  // IF DB1.G6807/PO110 Prod ID Qual is Vendor Product 1
  IF DB1.G6807_PO110_Prod_ID_Qual = 'VP';

  // OR DB1.G6807/PO110 Prod ID Qual is Vendor Product 2
  OR DB1.G6807_PO110_Prod_ID_Qual = 'VN';

  // OR DB1.G6807/PO110 Prod ID Qual is Manufacturer Part Number
  OR DB1.G6807_PO110_Prod_ID_Qual = 'MG';

  // OR DB1.G6807/PO110 Prod ID Qual is GTIN/UPC Code
  OR DB1.G6807_PO110_Prod_ID_Qual = 'UK';

  //?S17059 DN 04/28/21-Added 'GTIN/UPC Code' (UK) Condition c4.
  // WRK.Text USR 7 = DB1.G6808/PO111 Prod ID
  WRK.Text_USR_7 = DB1.G6808_PO111_Prod_ID;

  // Execute function RTV Right Just  7 Alph US.
  EXECUTE FUNCTION(RTV Right Just  7 Alph US) TYPE(EXCUSRSRC) ('POM3UFR');
  PARAMETER(WRK.Text_USR_7);
  PARAMETER(WRK.Text_7_Alpha_Usr);
  {
   E                    A1         07  1
   E                    A2         07  1
   C                     MOVEAWUY8TX    A1
   C                     MOVEA*BLANKS   A2
   C                     MOVE 07        C1      20
   C                     MOVE 07        C2      20
   C           C1        DOWGT0
   C           A1,C1     IFNE ' '
   C                     MOVE A1,C1     A2,C2
   C           C2        SUB  1         C2
   C                     END
   C           C1        SUB  1         C1
   C                     END
   C                     MOVEAA2        WUZ3TX
  }

  // LCL.USR Item Code 7,0 signed = CVTVAR(WRK.Text 7 Alpha Usr)
  LCL.USR_Item_Code_70_signed = CVTVAR(WRK.Text_7_Alpha_Usr);

  // LCL.Item Code Number 7.0  USR = LCL.USR Item Code 7,0 signed
  LCL.Item_Code_Number_7_0_USR = LCL.USR_Item_Code_70_signed;

  EXECUTE FUNCTION(Rtv CIR Resource      RT) TYPE(RTVOBJ) FILE(POBIREP)           AC2159017;
  PARAMETER(PAR.Customer_Number_NBR);
  PARAMETER(LCL.Item_Code_Number_7_0_USR);
  PARAMETER(LCL.CIR_Resource_No);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  CASE;

  // IF LCL.CIR Resource No is Entered
  IF LCL.CIR_Resource_No <> *BLANK;

  // PAR.Item Code Number 7.0  USR = LCL.Item Code Number 7.0  USR
  PAR.Item_Code_Number_7_0_USR = LCL.Item_Code_Number_7_0_USR;

  // LCL.Item Code Exist USR = CND.Yes
  LCL.Item_Code_Exist_USR = 'Y';

  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.Item Code Number 7.0  USR = CON.*ZERO
  PAR.Item_Code_Number_7_0_USR = *ZERO;

  ENDIF;

  ENDIF;

  ENDIF;

  //?11/30/22 DN W108770-Removed 'UK' Qualifier. Check IDUPC Field Instead.
  //?  Commented out & moved 'UK' check below.
  //?IT = purch item code
  CASE;

  // IF PAR.Item Code Number 7.0  USR is Not Entered
  IF PAR.Item_Code_Number_7_0_USR = *ZERO;

  CASE;

  // IF DB1.G6807/PO110 Prod ID Qual is Purchaser Product 3
  IF DB1.G6807_PO110_Prod_ID_Qual = 'IT';

  CASE;

  // IF DB1.G6808/PO111 Prod ID is Entered
  IF DB1.G6808_PO111_Prod_ID <> *BLANK;

  EXECUTE FUNCTION(Rtv CIR Ref item      RT) TYPE(RTVOBJ) FILE(POBIREP)           AC2052817;
  PARAMETER(PAR.Customer_Number_NBR);
  PARAMETER(LCL.Item_Code);
  PARAMETER(DB1.G6808_PO111_Prod_ID);
  PARAMETER(NLL.CIR_UM_Base_Price);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   QUIT;

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

   QUIT;

  }

  CASE;

  // IF LCL.Item Code is Entered
  IF LCL.Item_Code <> *ZERO;

  // PAR.Item Code Number 7.0  USR = LCL.Item Code
  PAR.Item_Code_Number_7_0_USR = LCL.Item_Code;

  // LCL.Item Code Exist USR = CND.Yes
  LCL.Item_Code_Exist_USR = 'Y';

  ENDIF;

  ENDIF;

  ENDIF;

  ENDIF;

  //?Catchall
  CASE;

  // IF PAR.Item Code Number 7.0  USR is Not Entered
  IF PAR.Item_Code_Number_7_0_USR = *ZERO;

  // LCL.Item Code = CON.*ZERO
  LCL.Item_Code = *ZERO;

  CASE;

  // IF DB1.G6806/P109 PRODUCT ID is Not Blank
  IF DB1.G6806_P109_PRODUCT_ID <> *BLANK;

  EXECUTE FUNCTION(Rtv CIR Ref item      RT) TYPE(RTVOBJ) FILE(POBIREP)           AC2052817;
  PARAMETER(PAR.Customer_Number_NBR);
  PARAMETER(LCL.Item_Code);
  PARAMETER(DB1.G6806_P109_PRODUCT_ID);
  PARAMETER(NLL.CIR_UM_Base_Price);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   QUIT;

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

   QUIT;

  }

  CASE;

  // IF LCL.Item Code is Entered
  IF LCL.Item_Code <> *ZERO;

  // PAR.Item Code Number 7.0  USR = LCL.Item Code
  PAR.Item_Code_Number_7_0_USR = LCL.Item_Code;

  // LCL.Item Code Exist USR = CND.Yes
  LCL.Item_Code_Exist_USR = 'Y';

  ENDIF;

  ENDIF;

  CASE;

  // IF LCL.Item Code is Not Entered
  IF LCL.Item_Code = *ZERO;

  CASE;

  // IF DB1.G6808/PO111 Prod ID is Entered
  IF DB1.G6808_PO111_Prod_ID <> *BLANK;

  EXECUTE FUNCTION(Rtv CIR Ref item      RT) TYPE(RTVOBJ) FILE(POBIREP)           AC2052817;
  PARAMETER(PAR.Customer_Number_NBR);
  PARAMETER(LCL.Item_Code);
  PARAMETER(DB1.G6808_PO111_Prod_ID);
  PARAMETER(NLL.CIR_UM_Base_Price);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   QUIT;

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

   QUIT;

  }

  CASE;

  // IF LCL.Item Code is Entered
  IF LCL.Item_Code <> *ZERO;

  // PAR.Item Code Number 7.0  USR = LCL.Item Code
  PAR.Item_Code_Number_7_0_USR = LCL.Item_Code;

  // LCL.CIR Resource No = DB1.G6808/PO111 Prod ID
  LCL.CIR_Resource_No = DB1.G6808_PO111_Prod_ID;

  // LCL.Item Code Exist USR = CND.Yes
  LCL.Item_Code_Exist_USR = 'Y';

  ENDIF;

  ENDIF;

  ENDIF;

  ENDIF;

  //?If no product id then zero out SBD item number
  CASE;

  // IF PAR.Item Code Number 7.0  USR is Not Entered
  IF PAR.Item_Code_Number_7_0_USR = *ZERO;

  // OR LCL.Item Code Exist USR is No
  OR LCL.Item_Code_Exist_USR = 'N';

  // PAR.Item Code Number 7.0  USR = CND.Not Entered
  PAR.Item_Code_Number_7_0_USR = *ZERO;

  ENDIF;

  // PAR.CIR Resource No = LCL.CIR Resource No
  PAR.CIR_Resource_No = LCL.CIR_Resource_No;

  CASE;

  // IF PAR.Item Code Number 7.0  USR is Entered
  IF PAR.Item_Code_Number_7_0_USR <> *ZERO;

  //?UPC
  CASE;

  // IF DB1.POD Unused GTIN is Entered
  IF DB1.POD_Unused_GTIN <> *BLANK;

  // PAR.CIR Resource No Type = CND.UPC Consumer Pkg Cde
  PAR.CIR_Resource_No_Type = 'UP';

  // PAR.CIR Resource No = DB1.POD Unused GTIN
  PAR.CIR_Resource_No = DB1.POD_Unused_GTIN;

  EXECUTE FUNCTION(Rtv Chg/Ct CIR EDI    RT) TYPE(RTVOBJ) FILE(PUBQREP)           AC2176793;
  PARAMETER(PAR.EDI_Trading_Partner_No);
  PARAMETER(PAR.Item_Code_Number_7_0_USR);
  PARAMETER(PAR.CIR_Resource_No_Type);
  PARAMETER(PAR.CIR_Resource_No);
  PARAMETER(DB1.G6901_ITEM_DESCRIPTION);
  {
   //?USER: Processing if Data record not found

   EXECUTE FUNCTION(Crt Customer Item Ref  CR) TYPE(CRTOBJ) FILE(PUBQREP)          AC2176604;
   PARAMETER(PAR.EDI_Trading_Partner_No);
   PARAMETER(PAR.Item_Code);
   PARAMETER(PAR.CIR_Resource_No_Type);
   PARAMETER(*BLANK);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(LCL.CIR_Unused_Status_1);
   PARAMETER(LCL.CIR_Unused_Status_2);
   PARAMETER(LCL.CIR_UM_Base_Price);
   PARAMETER(LCL.CIR_Unused_Status_5);
   PARAMETER(LCL.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Crt Date/Time      IF) TYPE(EXCINTFUN)                     AC1523477;
    PARAMETER(DB1.Record_Status);
    PARAMETER(DB1.Create_Date);
    PARAMETER(DB1.Create_Time);
    PARAMETER(DB1.Create_User);
    PARAMETER(DB1.Create_Program);
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     //?*** Set RECORD STATUS field. ***
     // PAR.Record Status = CND.Active
     PAR.Record_Status = 'A';

     //?*** Set CREATE fields. ***
     // PAR.Create Date = JOB.*Job date
     PAR.Create_Date = JOB.*Job_date;

     // PAR.Create Time = JOB.*Job time
     PAR.Create_Time = JOB.*Job_time;

     // PAR.Create User = JOB.*USER
     PAR.Create_User = JOB.*USER;

     // PAR.Create Program = JOB.*PROGRAM
     PAR.Create_Program = JOB.*PROGRAM;

     //?*** Set CHANGE fields. ***
     // PAR.Change Date = CON.*ZERO
     PAR.Change_Date = *ZERO;

     // PAR.Change Time = CON.*ZERO
     PAR.Change_Time = *ZERO;

     // PAR.Change User = CON.*BLANK
     PAR.Change_User = *BLANK;

     // PAR.Change Program = CON.*BLANK
     PAR.Change_Program = *BLANK;

    }

    //?USER: Processing if Data record already exists

    // PGM.*Return code = CND.*Normal
    PGM.*Return_code = *BLANK;

   }

   //?USER: Process Data record

   CASE;

   // IF DB1.CIR Resource No NE PAR.CIR Resource No
   IF DB1.CIR_Resource_No <> PAR.CIR_Resource_No;

   EXECUTE FUNCTION(Chg Customer Item Ref CH) TYPE(CHGOBJ) FILE(PUBQREP)           AC2176605;
   PARAMETER(DB1.EDI_Trading_Partner_No);
   PARAMETER(DB1.Item_Code);
   PARAMETER(DB1.CIR_Resource_No_Type);
   PARAMETER(DB1.CIR_Item_No);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(DB1.CIR_Description_Line);
   PARAMETER(DB1.CIR_Description_Line_2);
   PARAMETER(DB1.CIR_Description_Line_3);
   PARAMETER(DB1.CIR_Unused_Status_1);
   PARAMETER(DB1.CIR_Unused_Status_2);
   PARAMETER(DB1.CIR_UM_Base_Price);
   PARAMETER(DB1.CIR_Unused_Status_5);
   PARAMETER(DB1.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Chg Date/Time      IF) TYPE(EXCINTFUN)                     AC1523476;
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     // PAR.Change Date = JOB.*Job date
     PAR.Change_Date = JOB.*Job_date;

     // PAR.Change Time = JOB.*Job time
     PAR.Change_Time = JOB.*Job_time;

     // PAR.Change User = JOB.*USER
     PAR.Change_User = JOB.*USER;

     // PAR.Change Program = JOB.*PROGRAM
     PAR.Change_Program = JOB.*PROGRAM;

    }

   }

   ENDIF;

  }

  ENDIF;

  //?VP/VN/MF/UA/PI G807
  CASE;

  // IF DB1.G6807/PO110 Prod ID Qual is Vendor Product 1
  IF DB1.G6807_PO110_Prod_ID_Qual = 'VP';

  // OR DB1.G6807/PO110 Prod ID Qual is Vendor Product 2
  OR DB1.G6807_PO110_Prod_ID_Qual = 'VN';

  // OR DB1.G6807/PO110 Prod ID Qual is Manufacturer Part Number
  OR DB1.G6807_PO110_Prod_ID_Qual = 'MG';

  // OR DB1.G6807/PO110 Prod ID Qual is Purchaser Product 1
  OR DB1.G6807_PO110_Prod_ID_Qual = 'PI';

  // OR DB1.G6807/PO110 Prod ID Qual is UA
  OR DB1.G6807_PO110_Prod_ID_Qual = 'UA';

  // OR DB1.G6807/PO110 Prod ID Qual is Purchaser Product 2
  OR DB1.G6807_PO110_Prod_ID_Qual = 'IN';

  CASE;

  // IF DB1.G6807/PO110 Prod ID Qual is UA
  IF DB1.G6807_PO110_Prod_ID_Qual = 'UA';

  // PAR.CIR Resource No Type = CND.Purchaser Item Code
  PAR.CIR_Resource_No_Type = 'PI';

  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.CIR Resource No Type = DB1.G6807/PO110 Prod ID Qual
  PAR.CIR_Resource_No_Type = DB1.G6807_PO110_Prod_ID_Qual;

  ENDIF;

  // PAR.CIR Resource No = DB1.G6808/PO111 Prod ID
  PAR.CIR_Resource_No = DB1.G6808_PO111_Prod_ID;

  EXECUTE FUNCTION(Rtv Chg/Ct CIR EDI    RT) TYPE(RTVOBJ) FILE(PUBQREP)           AC2176793;
  PARAMETER(PAR.EDI_Trading_Partner_No);
  PARAMETER(PAR.Item_Code_Number_7_0_USR);
  PARAMETER(PAR.CIR_Resource_No_Type);
  PARAMETER(PAR.CIR_Resource_No);
  PARAMETER(DB1.G6901_ITEM_DESCRIPTION);
  {
   //?USER: Processing if Data record not found

   EXECUTE FUNCTION(Crt Customer Item Ref  CR) TYPE(CRTOBJ) FILE(PUBQREP)          AC2176604;
   PARAMETER(PAR.EDI_Trading_Partner_No);
   PARAMETER(PAR.Item_Code);
   PARAMETER(PAR.CIR_Resource_No_Type);
   PARAMETER(*BLANK);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(LCL.CIR_Unused_Status_1);
   PARAMETER(LCL.CIR_Unused_Status_2);
   PARAMETER(LCL.CIR_UM_Base_Price);
   PARAMETER(LCL.CIR_Unused_Status_5);
   PARAMETER(LCL.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Crt Date/Time      IF) TYPE(EXCINTFUN)                     AC1523477;
    PARAMETER(DB1.Record_Status);
    PARAMETER(DB1.Create_Date);
    PARAMETER(DB1.Create_Time);
    PARAMETER(DB1.Create_User);
    PARAMETER(DB1.Create_Program);
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     //?*** Set RECORD STATUS field. ***
     // PAR.Record Status = CND.Active
     PAR.Record_Status = 'A';

     //?*** Set CREATE fields. ***
     // PAR.Create Date = JOB.*Job date
     PAR.Create_Date = JOB.*Job_date;

     // PAR.Create Time = JOB.*Job time
     PAR.Create_Time = JOB.*Job_time;

     // PAR.Create User = JOB.*USER
     PAR.Create_User = JOB.*USER;

     // PAR.Create Program = JOB.*PROGRAM
     PAR.Create_Program = JOB.*PROGRAM;

     //?*** Set CHANGE fields. ***
     // PAR.Change Date = CON.*ZERO
     PAR.Change_Date = *ZERO;

     // PAR.Change Time = CON.*ZERO
     PAR.Change_Time = *ZERO;

     // PAR.Change User = CON.*BLANK
     PAR.Change_User = *BLANK;

     // PAR.Change Program = CON.*BLANK
     PAR.Change_Program = *BLANK;

    }

    //?USER: Processing if Data record already exists

    // PGM.*Return code = CND.*Normal
    PGM.*Return_code = *BLANK;

   }

   //?USER: Process Data record

   CASE;

   // IF DB1.CIR Resource No NE PAR.CIR Resource No
   IF DB1.CIR_Resource_No <> PAR.CIR_Resource_No;

   EXECUTE FUNCTION(Chg Customer Item Ref CH) TYPE(CHGOBJ) FILE(PUBQREP)           AC2176605;
   PARAMETER(DB1.EDI_Trading_Partner_No);
   PARAMETER(DB1.Item_Code);
   PARAMETER(DB1.CIR_Resource_No_Type);
   PARAMETER(DB1.CIR_Item_No);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(DB1.CIR_Description_Line);
   PARAMETER(DB1.CIR_Description_Line_2);
   PARAMETER(DB1.CIR_Description_Line_3);
   PARAMETER(DB1.CIR_Unused_Status_1);
   PARAMETER(DB1.CIR_Unused_Status_2);
   PARAMETER(DB1.CIR_UM_Base_Price);
   PARAMETER(DB1.CIR_Unused_Status_5);
   PARAMETER(DB1.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Chg Date/Time      IF) TYPE(EXCINTFUN)                     AC1523476;
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     // PAR.Change Date = JOB.*Job date
     PAR.Change_Date = JOB.*Job_date;

     // PAR.Change Time = JOB.*Job time
     PAR.Change_Time = JOB.*Job_time;

     // PAR.Change User = JOB.*USER
     PAR.Change_User = JOB.*USER;

     // PAR.Change Program = JOB.*PROGRAM
     PAR.Change_Program = JOB.*PROGRAM;

    }

   }

   ENDIF;

  }

  ENDIF;

  //?VP  G805
  CASE;

  // IF DB1.G6805/P108 PROD ID QUAL is Vendor Product
  IF DB1.G6805_P108_PROD_ID_QUAL = 'VP';

  // OR DB1.G6805/P108 PROD ID QUAL is Vendor Product 2
  OR DB1.G6805_P108_PROD_ID_QUAL = 'VN';

  // OR DB1.G6805/P108 PROD ID QUAL is Manufacturer Part Number
  OR DB1.G6805_P108_PROD_ID_QUAL = 'MG';

  // OR DB1.G6805/P108 PROD ID QUAL is Purchaser Product 1
  OR DB1.G6805_P108_PROD_ID_QUAL = 'PI';

  // PAR.CIR Resource No Type = DB1.G6805/P108 PROD ID QUAL
  PAR.CIR_Resource_No_Type = DB1.G6805_P108_PROD_ID_QUAL;

  // PAR.CIR Resource No = DB1.G6806/P109 PRODUCT ID
  PAR.CIR_Resource_No = DB1.G6806_P109_PRODUCT_ID;

  EXECUTE FUNCTION(Rtv Chg/Ct CIR EDI    RT) TYPE(RTVOBJ) FILE(PUBQREP)           AC2176793;
  PARAMETER(PAR.EDI_Trading_Partner_No);
  PARAMETER(PAR.Item_Code_Number_7_0_USR);
  PARAMETER(PAR.CIR_Resource_No_Type);
  PARAMETER(PAR.CIR_Resource_No);
  PARAMETER(DB1.G6901_ITEM_DESCRIPTION);
  {
   //?USER: Processing if Data record not found

   EXECUTE FUNCTION(Crt Customer Item Ref  CR) TYPE(CRTOBJ) FILE(PUBQREP)          AC2176604;
   PARAMETER(PAR.EDI_Trading_Partner_No);
   PARAMETER(PAR.Item_Code);
   PARAMETER(PAR.CIR_Resource_No_Type);
   PARAMETER(*BLANK);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(LCL.CIR_Unused_Status_1);
   PARAMETER(LCL.CIR_Unused_Status_2);
   PARAMETER(LCL.CIR_UM_Base_Price);
   PARAMETER(LCL.CIR_Unused_Status_5);
   PARAMETER(LCL.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Crt Date/Time      IF) TYPE(EXCINTFUN)                     AC1523477;
    PARAMETER(DB1.Record_Status);
    PARAMETER(DB1.Create_Date);
    PARAMETER(DB1.Create_Time);
    PARAMETER(DB1.Create_User);
    PARAMETER(DB1.Create_Program);
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     //?*** Set RECORD STATUS field. ***
     // PAR.Record Status = CND.Active
     PAR.Record_Status = 'A';

     //?*** Set CREATE fields. ***
     // PAR.Create Date = JOB.*Job date
     PAR.Create_Date = JOB.*Job_date;

     // PAR.Create Time = JOB.*Job time
     PAR.Create_Time = JOB.*Job_time;

     // PAR.Create User = JOB.*USER
     PAR.Create_User = JOB.*USER;

     // PAR.Create Program = JOB.*PROGRAM
     PAR.Create_Program = JOB.*PROGRAM;

     //?*** Set CHANGE fields. ***
     // PAR.Change Date = CON.*ZERO
     PAR.Change_Date = *ZERO;

     // PAR.Change Time = CON.*ZERO
     PAR.Change_Time = *ZERO;

     // PAR.Change User = CON.*BLANK
     PAR.Change_User = *BLANK;

     // PAR.Change Program = CON.*BLANK
     PAR.Change_Program = *BLANK;

    }

    //?USER: Processing if Data record already exists

    // PGM.*Return code = CND.*Normal
    PGM.*Return_code = *BLANK;

   }

   //?USER: Process Data record

   CASE;

   // IF DB1.CIR Resource No NE PAR.CIR Resource No
   IF DB1.CIR_Resource_No <> PAR.CIR_Resource_No;

   EXECUTE FUNCTION(Chg Customer Item Ref CH) TYPE(CHGOBJ) FILE(PUBQREP)           AC2176605;
   PARAMETER(DB1.EDI_Trading_Partner_No);
   PARAMETER(DB1.Item_Code);
   PARAMETER(DB1.CIR_Resource_No_Type);
   PARAMETER(DB1.CIR_Item_No);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(DB1.CIR_Description_Line);
   PARAMETER(DB1.CIR_Description_Line_2);
   PARAMETER(DB1.CIR_Description_Line_3);
   PARAMETER(DB1.CIR_Unused_Status_1);
   PARAMETER(DB1.CIR_Unused_Status_2);
   PARAMETER(DB1.CIR_UM_Base_Price);
   PARAMETER(DB1.CIR_Unused_Status_5);
   PARAMETER(DB1.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Chg Date/Time      IF) TYPE(EXCINTFUN)                     AC1523476;
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     // PAR.Change Date = JOB.*Job date
     PAR.Change_Date = JOB.*Job_date;

     // PAR.Change Time = JOB.*Job time
     PAR.Change_Time = JOB.*Job_time;

     // PAR.Change User = JOB.*USER
     PAR.Change_User = JOB.*USER;

     // PAR.Change Program = JOB.*PROGRAM
     PAR.Change_Program = JOB.*PROGRAM;

    }

   }

   ENDIF;

  }

  ENDIF;

  //?SK = SKU
  CASE;

  // IF DB1.G6807/PO110 Prod ID Qual is Sku
  IF DB1.G6807_PO110_Prod_ID_Qual = 'SK';

  // PAR.CIR Resource No Type = CND.SKU
  PAR.CIR_Resource_No_Type = 'SK';

  // PAR.CIR Resource No = DB1.G6808/PO111 Prod ID
  PAR.CIR_Resource_No = DB1.G6808_PO111_Prod_ID;

  EXECUTE FUNCTION(Rtv Chg/Ct CIR EDI    RT) TYPE(RTVOBJ) FILE(PUBQREP)           AC2176793;
  PARAMETER(PAR.EDI_Trading_Partner_No);
  PARAMETER(PAR.Item_Code_Number_7_0_USR);
  PARAMETER(PAR.CIR_Resource_No_Type);
  PARAMETER(PAR.CIR_Resource_No);
  PARAMETER(DB1.G6901_ITEM_DESCRIPTION);
  {
   //?USER: Processing if Data record not found

   EXECUTE FUNCTION(Crt Customer Item Ref  CR) TYPE(CRTOBJ) FILE(PUBQREP)          AC2176604;
   PARAMETER(PAR.EDI_Trading_Partner_No);
   PARAMETER(PAR.Item_Code);
   PARAMETER(PAR.CIR_Resource_No_Type);
   PARAMETER(*BLANK);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(LCL.CIR_Unused_Status_1);
   PARAMETER(LCL.CIR_Unused_Status_2);
   PARAMETER(LCL.CIR_UM_Base_Price);
   PARAMETER(LCL.CIR_Unused_Status_5);
   PARAMETER(LCL.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Crt Date/Time      IF) TYPE(EXCINTFUN)                     AC1523477;
    PARAMETER(DB1.Record_Status);
    PARAMETER(DB1.Create_Date);
    PARAMETER(DB1.Create_Time);
    PARAMETER(DB1.Create_User);
    PARAMETER(DB1.Create_Program);
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     //?*** Set RECORD STATUS field. ***
     // PAR.Record Status = CND.Active
     PAR.Record_Status = 'A';

     //?*** Set CREATE fields. ***
     // PAR.Create Date = JOB.*Job date
     PAR.Create_Date = JOB.*Job_date;

     // PAR.Create Time = JOB.*Job time
     PAR.Create_Time = JOB.*Job_time;

     // PAR.Create User = JOB.*USER
     PAR.Create_User = JOB.*USER;

     // PAR.Create Program = JOB.*PROGRAM
     PAR.Create_Program = JOB.*PROGRAM;

     //?*** Set CHANGE fields. ***
     // PAR.Change Date = CON.*ZERO
     PAR.Change_Date = *ZERO;

     // PAR.Change Time = CON.*ZERO
     PAR.Change_Time = *ZERO;

     // PAR.Change User = CON.*BLANK
     PAR.Change_User = *BLANK;

     // PAR.Change Program = CON.*BLANK
     PAR.Change_Program = *BLANK;

    }

    //?USER: Processing if Data record already exists

    // PGM.*Return code = CND.*Normal
    PGM.*Return_code = *BLANK;

   }

   //?USER: Process Data record

   CASE;

   // IF DB1.CIR Resource No NE PAR.CIR Resource No
   IF DB1.CIR_Resource_No <> PAR.CIR_Resource_No;

   EXECUTE FUNCTION(Chg Customer Item Ref CH) TYPE(CHGOBJ) FILE(PUBQREP)           AC2176605;
   PARAMETER(DB1.EDI_Trading_Partner_No);
   PARAMETER(DB1.Item_Code);
   PARAMETER(DB1.CIR_Resource_No_Type);
   PARAMETER(DB1.CIR_Item_No);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(DB1.CIR_Description_Line);
   PARAMETER(DB1.CIR_Description_Line_2);
   PARAMETER(DB1.CIR_Description_Line_3);
   PARAMETER(DB1.CIR_Unused_Status_1);
   PARAMETER(DB1.CIR_Unused_Status_2);
   PARAMETER(DB1.CIR_UM_Base_Price);
   PARAMETER(DB1.CIR_Unused_Status_5);
   PARAMETER(DB1.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Chg Date/Time      IF) TYPE(EXCINTFUN)                     AC1523476;
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     // PAR.Change Date = JOB.*Job date
     PAR.Change_Date = JOB.*Job_date;

     // PAR.Change Time = JOB.*Job time
     PAR.Change_Time = JOB.*Job_time;

     // PAR.Change User = JOB.*USER
     PAR.Change_User = JOB.*USER;

     // PAR.Change Program = JOB.*PROGRAM
     PAR.Change_Program = JOB.*PROGRAM;

    }

   }

   ENDIF;

  }

  ENDIF;

  //?UP = consumer pkg code
  CASE;

  // IF DB1.G6807/PO110 Prod ID Qual is UPC Comsumer Pkg Code
  IF DB1.G6807_PO110_Prod_ID_Qual = 'UP';

  // PAR.CIR Resource No Type = CND.UPC Consumer Pkg Cde
  PAR.CIR_Resource_No_Type = 'UP';

  // PAR.CIR Resource No = DB1.G6808/PO111 Prod ID
  PAR.CIR_Resource_No = DB1.G6808_PO111_Prod_ID;

  EXECUTE FUNCTION(Rtv Chg/Ct CIR EDI    RT) TYPE(RTVOBJ) FILE(PUBQREP)           AC2176793;
  PARAMETER(PAR.EDI_Trading_Partner_No);
  PARAMETER(PAR.Item_Code_Number_7_0_USR);
  PARAMETER(PAR.CIR_Resource_No_Type);
  PARAMETER(PAR.CIR_Resource_No);
  PARAMETER(DB1.G6901_ITEM_DESCRIPTION);
  {
   //?USER: Processing if Data record not found

   EXECUTE FUNCTION(Crt Customer Item Ref  CR) TYPE(CRTOBJ) FILE(PUBQREP)          AC2176604;
   PARAMETER(PAR.EDI_Trading_Partner_No);
   PARAMETER(PAR.Item_Code);
   PARAMETER(PAR.CIR_Resource_No_Type);
   PARAMETER(*BLANK);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(LCL.CIR_Unused_Status_1);
   PARAMETER(LCL.CIR_Unused_Status_2);
   PARAMETER(LCL.CIR_UM_Base_Price);
   PARAMETER(LCL.CIR_Unused_Status_5);
   PARAMETER(LCL.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Crt Date/Time      IF) TYPE(EXCINTFUN)                     AC1523477;
    PARAMETER(DB1.Record_Status);
    PARAMETER(DB1.Create_Date);
    PARAMETER(DB1.Create_Time);
    PARAMETER(DB1.Create_User);
    PARAMETER(DB1.Create_Program);
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     //?*** Set RECORD STATUS field. ***
     // PAR.Record Status = CND.Active
     PAR.Record_Status = 'A';

     //?*** Set CREATE fields. ***
     // PAR.Create Date = JOB.*Job date
     PAR.Create_Date = JOB.*Job_date;

     // PAR.Create Time = JOB.*Job time
     PAR.Create_Time = JOB.*Job_time;

     // PAR.Create User = JOB.*USER
     PAR.Create_User = JOB.*USER;

     // PAR.Create Program = JOB.*PROGRAM
     PAR.Create_Program = JOB.*PROGRAM;

     //?*** Set CHANGE fields. ***
     // PAR.Change Date = CON.*ZERO
     PAR.Change_Date = *ZERO;

     // PAR.Change Time = CON.*ZERO
     PAR.Change_Time = *ZERO;

     // PAR.Change User = CON.*BLANK
     PAR.Change_User = *BLANK;

     // PAR.Change Program = CON.*BLANK
     PAR.Change_Program = *BLANK;

    }

    //?USER: Processing if Data record already exists

    // PGM.*Return code = CND.*Normal
    PGM.*Return_code = *BLANK;

   }

   //?USER: Process Data record

   CASE;

   // IF DB1.CIR Resource No NE PAR.CIR Resource No
   IF DB1.CIR_Resource_No <> PAR.CIR_Resource_No;

   EXECUTE FUNCTION(Chg Customer Item Ref CH) TYPE(CHGOBJ) FILE(PUBQREP)           AC2176605;
   PARAMETER(DB1.EDI_Trading_Partner_No);
   PARAMETER(DB1.Item_Code);
   PARAMETER(DB1.CIR_Resource_No_Type);
   PARAMETER(DB1.CIR_Item_No);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(DB1.CIR_Description_Line);
   PARAMETER(DB1.CIR_Description_Line_2);
   PARAMETER(DB1.CIR_Description_Line_3);
   PARAMETER(DB1.CIR_Unused_Status_1);
   PARAMETER(DB1.CIR_Unused_Status_2);
   PARAMETER(DB1.CIR_UM_Base_Price);
   PARAMETER(DB1.CIR_Unused_Status_5);
   PARAMETER(DB1.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Chg Date/Time      IF) TYPE(EXCINTFUN)                     AC1523476;
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     // PAR.Change Date = JOB.*Job date
     PAR.Change_Date = JOB.*Job_date;

     // PAR.Change Time = JOB.*Job time
     PAR.Change_Time = JOB.*Job_time;

     // PAR.Change User = JOB.*USER
     PAR.Change_User = JOB.*USER;

     // PAR.Change Program = JOB.*PROGRAM
     PAR.Change_Program = JOB.*PROGRAM;

    }

   }

   ENDIF;

  }

  ENDIF;

  //?IT = item code
  CASE;

  // IF DB1.G6807/PO110 Prod ID Qual is Purchaser Product 3
  IF DB1.G6807_PO110_Prod_ID_Qual = 'IT';

  // PAR.CIR Resource No Type = CND.Purchaser Prod Code 3
  PAR.CIR_Resource_No_Type = 'IT';

  // PAR.CIR Resource No = DB1.G6808/PO111 Prod ID
  PAR.CIR_Resource_No = DB1.G6808_PO111_Prod_ID;

  EXECUTE FUNCTION(Rtv Chg/Ct CIR EDI    RT) TYPE(RTVOBJ) FILE(PUBQREP)           AC2176793;
  PARAMETER(PAR.EDI_Trading_Partner_No);
  PARAMETER(PAR.Item_Code_Number_7_0_USR);
  PARAMETER(PAR.CIR_Resource_No_Type);
  PARAMETER(PAR.CIR_Resource_No);
  PARAMETER(DB1.G6901_ITEM_DESCRIPTION);
  {
   //?USER: Processing if Data record not found

   EXECUTE FUNCTION(Crt Customer Item Ref  CR) TYPE(CRTOBJ) FILE(PUBQREP)          AC2176604;
   PARAMETER(PAR.EDI_Trading_Partner_No);
   PARAMETER(PAR.Item_Code);
   PARAMETER(PAR.CIR_Resource_No_Type);
   PARAMETER(*BLANK);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(LCL.CIR_Unused_Status_1);
   PARAMETER(LCL.CIR_Unused_Status_2);
   PARAMETER(LCL.CIR_UM_Base_Price);
   PARAMETER(LCL.CIR_Unused_Status_5);
   PARAMETER(LCL.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Crt Date/Time      IF) TYPE(EXCINTFUN)                     AC1523477;
    PARAMETER(DB1.Record_Status);
    PARAMETER(DB1.Create_Date);
    PARAMETER(DB1.Create_Time);
    PARAMETER(DB1.Create_User);
    PARAMETER(DB1.Create_Program);
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     //?*** Set RECORD STATUS field. ***
     // PAR.Record Status = CND.Active
     PAR.Record_Status = 'A';

     //?*** Set CREATE fields. ***
     // PAR.Create Date = JOB.*Job date
     PAR.Create_Date = JOB.*Job_date;

     // PAR.Create Time = JOB.*Job time
     PAR.Create_Time = JOB.*Job_time;

     // PAR.Create User = JOB.*USER
     PAR.Create_User = JOB.*USER;

     // PAR.Create Program = JOB.*PROGRAM
     PAR.Create_Program = JOB.*PROGRAM;

     //?*** Set CHANGE fields. ***
     // PAR.Change Date = CON.*ZERO
     PAR.Change_Date = *ZERO;

     // PAR.Change Time = CON.*ZERO
     PAR.Change_Time = *ZERO;

     // PAR.Change User = CON.*BLANK
     PAR.Change_User = *BLANK;

     // PAR.Change Program = CON.*BLANK
     PAR.Change_Program = *BLANK;

    }

    //?USER: Processing if Data record already exists

    // PGM.*Return code = CND.*Normal
    PGM.*Return_code = *BLANK;

   }

   //?USER: Process Data record

   CASE;

   // IF DB1.CIR Resource No NE PAR.CIR Resource No
   IF DB1.CIR_Resource_No <> PAR.CIR_Resource_No;

   EXECUTE FUNCTION(Chg Customer Item Ref CH) TYPE(CHGOBJ) FILE(PUBQREP)           AC2176605;
   PARAMETER(DB1.EDI_Trading_Partner_No);
   PARAMETER(DB1.Item_Code);
   PARAMETER(DB1.CIR_Resource_No_Type);
   PARAMETER(DB1.CIR_Item_No);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(DB1.CIR_Description_Line);
   PARAMETER(DB1.CIR_Description_Line_2);
   PARAMETER(DB1.CIR_Description_Line_3);
   PARAMETER(DB1.CIR_Unused_Status_1);
   PARAMETER(DB1.CIR_Unused_Status_2);
   PARAMETER(DB1.CIR_UM_Base_Price);
   PARAMETER(DB1.CIR_Unused_Status_5);
   PARAMETER(DB1.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Chg Date/Time      IF) TYPE(EXCINTFUN)                     AC1523476;
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     // PAR.Change Date = JOB.*Job date
     PAR.Change_Date = JOB.*Job_date;

     // PAR.Change Time = JOB.*Job time
     PAR.Change_Time = JOB.*Job_time;

     // PAR.Change User = JOB.*USER
     PAR.Change_User = JOB.*USER;

     // PAR.Change Program = JOB.*PROGRAM
     PAR.Change_Program = JOB.*PROGRAM;

    }

   }

   ENDIF;

  }

  ENDIF;

  //?07/19/22 DN W103972-Add Additional Resource Type to Process Here.
  CASE;

  // IF *OTHERWISE
  IF *OTHERWISE;

  //?CB = Buyer Catalog Number
  CASE;

  // IF DB1.G6807/PO110 Prod ID Qual is Buyer Catalog Number
  IF DB1.G6807_PO110_Prod_ID_Qual = 'CB';

  // PAR.CIR Resource No Type = CND.Buyer Catalog Number
  PAR.CIR_Resource_No_Type = 'CB';

  // PAR.CIR Resource No = DB1.G6808/PO111 Prod ID
  PAR.CIR_Resource_No = DB1.G6808_PO111_Prod_ID;

  // LCL.Crt Cust Item Ref for EDI = CND.Yes
  LCL.Crt_Cust_Item_Ref_for_EDI = 'Y';

  ENDIF;

  //?BP = Buyer Part Nbr
  CASE;

  // IF DB1.G6807/PO110 Prod ID Qual is Buyer Part Nbr
  IF DB1.G6807_PO110_Prod_ID_Qual = 'BP';

  // PAR.CIR Resource No Type = CND.Buyer Part Nbr
  PAR.CIR_Resource_No_Type = 'BP';

  // PAR.CIR Resource No = DB1.G6808/PO111 Prod ID
  PAR.CIR_Resource_No = DB1.G6808_PO111_Prod_ID;

  // LCL.Crt Cust Item Ref for EDI = CND.Yes
  LCL.Crt_Cust_Item_Ref_for_EDI = 'Y';

  ENDIF;

  //?Create Customer Item Ref for EDI Record?
  CASE;

  // IF LCL.Crt Cust Item Ref for EDI is Yes
  IF LCL.Crt_Cust_Item_Ref_for_EDI = 'Y';

  EXECUTE FUNCTION(Rtv Chg/Ct CIR EDI    RT) TYPE(RTVOBJ) FILE(PUBQREP)           AC2176793;
  PARAMETER(PAR.EDI_Trading_Partner_No);
  PARAMETER(PAR.Item_Code_Number_7_0_USR);
  PARAMETER(PAR.CIR_Resource_No_Type);
  PARAMETER(PAR.CIR_Resource_No);
  PARAMETER(DB1.G6901_ITEM_DESCRIPTION);
  {
   //?USER: Processing if Data record not found

   EXECUTE FUNCTION(Crt Customer Item Ref  CR) TYPE(CRTOBJ) FILE(PUBQREP)          AC2176604;
   PARAMETER(PAR.EDI_Trading_Partner_No);
   PARAMETER(PAR.Item_Code);
   PARAMETER(PAR.CIR_Resource_No_Type);
   PARAMETER(*BLANK);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(LCL.CIR_Unused_Status_1);
   PARAMETER(LCL.CIR_Unused_Status_2);
   PARAMETER(LCL.CIR_UM_Base_Price);
   PARAMETER(LCL.CIR_Unused_Status_5);
   PARAMETER(LCL.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Crt Date/Time      IF) TYPE(EXCINTFUN)                     AC1523477;
    PARAMETER(DB1.Record_Status);
    PARAMETER(DB1.Create_Date);
    PARAMETER(DB1.Create_Time);
    PARAMETER(DB1.Create_User);
    PARAMETER(DB1.Create_Program);
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     //?*** Set RECORD STATUS field. ***
     // PAR.Record Status = CND.Active
     PAR.Record_Status = 'A';

     //?*** Set CREATE fields. ***
     // PAR.Create Date = JOB.*Job date
     PAR.Create_Date = JOB.*Job_date;

     // PAR.Create Time = JOB.*Job time
     PAR.Create_Time = JOB.*Job_time;

     // PAR.Create User = JOB.*USER
     PAR.Create_User = JOB.*USER;

     // PAR.Create Program = JOB.*PROGRAM
     PAR.Create_Program = JOB.*PROGRAM;

     //?*** Set CHANGE fields. ***
     // PAR.Change Date = CON.*ZERO
     PAR.Change_Date = *ZERO;

     // PAR.Change Time = CON.*ZERO
     PAR.Change_Time = *ZERO;

     // PAR.Change User = CON.*BLANK
     PAR.Change_User = *BLANK;

     // PAR.Change Program = CON.*BLANK
     PAR.Change_Program = *BLANK;

    }

    //?USER: Processing if Data record already exists

    // PGM.*Return code = CND.*Normal
    PGM.*Return_code = *BLANK;

   }

   //?USER: Process Data record

   CASE;

   // IF DB1.CIR Resource No NE PAR.CIR Resource No
   IF DB1.CIR_Resource_No <> PAR.CIR_Resource_No;

   EXECUTE FUNCTION(Chg Customer Item Ref CH) TYPE(CHGOBJ) FILE(PUBQREP)           AC2176605;
   PARAMETER(DB1.EDI_Trading_Partner_No);
   PARAMETER(DB1.Item_Code);
   PARAMETER(DB1.CIR_Resource_No_Type);
   PARAMETER(DB1.CIR_Item_No);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(DB1.CIR_Description_Line);
   PARAMETER(DB1.CIR_Description_Line_2);
   PARAMETER(DB1.CIR_Description_Line_3);
   PARAMETER(DB1.CIR_Unused_Status_1);
   PARAMETER(DB1.CIR_Unused_Status_2);
   PARAMETER(DB1.CIR_UM_Base_Price);
   PARAMETER(DB1.CIR_Unused_Status_5);
   PARAMETER(DB1.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Chg Date/Time      IF) TYPE(EXCINTFUN)                     AC1523476;
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     // PAR.Change Date = JOB.*Job date
     PAR.Change_Date = JOB.*Job_date;

     // PAR.Change Time = JOB.*Job time
     PAR.Change_Time = JOB.*Job_time;

     // PAR.Change User = JOB.*USER
     PAR.Change_User = JOB.*USER;

     // PAR.Change Program = JOB.*PROGRAM
     PAR.Change_Program = JOB.*PROGRAM;

    }

   }

   ENDIF;

  }

  ENDIF;

  ENDIF;

  //?UP = UP Case code     rmc added 3/26/21
  CASE;

  // IF DB1.P106 UPC/GTIN QUAL is UPC Package Code
  IF DB1.P106_UPC_GTIN_QUAL = 'UP';

  // PAR.CIR Resource No Type = CND.UPC Consumer Pkg Cde
  PAR.CIR_Resource_No_Type = 'UP';

  // PAR.CIR Resource No = DB1.POD Unused GTIN
  PAR.CIR_Resource_No = DB1.POD_Unused_GTIN;

  EXECUTE FUNCTION(Rtv Chg/Ct CIR EDI    RT) TYPE(RTVOBJ) FILE(PUBQREP)           AC2176793;
  PARAMETER(PAR.EDI_Trading_Partner_No);
  PARAMETER(PAR.Item_Code_Number_7_0_USR);
  PARAMETER(PAR.CIR_Resource_No_Type);
  PARAMETER(PAR.CIR_Resource_No);
  PARAMETER(DB1.G6901_ITEM_DESCRIPTION);
  {
   //?USER: Processing if Data record not found

   EXECUTE FUNCTION(Crt Customer Item Ref  CR) TYPE(CRTOBJ) FILE(PUBQREP)          AC2176604;
   PARAMETER(PAR.EDI_Trading_Partner_No);
   PARAMETER(PAR.Item_Code);
   PARAMETER(PAR.CIR_Resource_No_Type);
   PARAMETER(*BLANK);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(LCL.CIR_Unused_Status_1);
   PARAMETER(LCL.CIR_Unused_Status_2);
   PARAMETER(LCL.CIR_UM_Base_Price);
   PARAMETER(LCL.CIR_Unused_Status_5);
   PARAMETER(LCL.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Crt Date/Time      IF) TYPE(EXCINTFUN)                     AC1523477;
    PARAMETER(DB1.Record_Status);
    PARAMETER(DB1.Create_Date);
    PARAMETER(DB1.Create_Time);
    PARAMETER(DB1.Create_User);
    PARAMETER(DB1.Create_Program);
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     //?*** Set RECORD STATUS field. ***
     // PAR.Record Status = CND.Active
     PAR.Record_Status = 'A';

     //?*** Set CREATE fields. ***
     // PAR.Create Date = JOB.*Job date
     PAR.Create_Date = JOB.*Job_date;

     // PAR.Create Time = JOB.*Job time
     PAR.Create_Time = JOB.*Job_time;

     // PAR.Create User = JOB.*USER
     PAR.Create_User = JOB.*USER;

     // PAR.Create Program = JOB.*PROGRAM
     PAR.Create_Program = JOB.*PROGRAM;

     //?*** Set CHANGE fields. ***
     // PAR.Change Date = CON.*ZERO
     PAR.Change_Date = *ZERO;

     // PAR.Change Time = CON.*ZERO
     PAR.Change_Time = *ZERO;

     // PAR.Change User = CON.*BLANK
     PAR.Change_User = *BLANK;

     // PAR.Change Program = CON.*BLANK
     PAR.Change_Program = *BLANK;

    }

    //?USER: Processing if Data record already exists

    // PGM.*Return code = CND.*Normal
    PGM.*Return_code = *BLANK;

   }

   //?USER: Process Data record

   CASE;

   // IF DB1.CIR Resource No NE PAR.CIR Resource No
   IF DB1.CIR_Resource_No <> PAR.CIR_Resource_No;

   EXECUTE FUNCTION(Chg Customer Item Ref CH) TYPE(CHGOBJ) FILE(PUBQREP)           AC2176605;
   PARAMETER(DB1.EDI_Trading_Partner_No);
   PARAMETER(DB1.Item_Code);
   PARAMETER(DB1.CIR_Resource_No_Type);
   PARAMETER(DB1.CIR_Item_No);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(DB1.CIR_Description_Line);
   PARAMETER(DB1.CIR_Description_Line_2);
   PARAMETER(DB1.CIR_Description_Line_3);
   PARAMETER(DB1.CIR_Unused_Status_1);
   PARAMETER(DB1.CIR_Unused_Status_2);
   PARAMETER(DB1.CIR_UM_Base_Price);
   PARAMETER(DB1.CIR_Unused_Status_5);
   PARAMETER(DB1.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Chg Date/Time      IF) TYPE(EXCINTFUN)                     AC1523476;
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     // PAR.Change Date = JOB.*Job date
     PAR.Change_Date = JOB.*Job_date;

     // PAR.Change Time = JOB.*Job time
     PAR.Change_Time = JOB.*Job_time;

     // PAR.Change User = JOB.*USER
     PAR.Change_User = JOB.*USER;

     // PAR.Change Program = JOB.*PROGRAM
     PAR.Change_Program = JOB.*PROGRAM;

    }

   }

   ENDIF;

  }

  ENDIF;

  //?GTIN = UK                                    12/07/22 DN W108770
  CASE;

  // IF DB1.G6804/P107 UPC/GTIN CODE is Entered
  IF DB1.G6804_P107_UPC_GTIN_CODE <> *BLANK;

  // Call program Val UK Val Data Length XF.
  CALL PROGRAM(Val UK Val Data Length XF) ('PUXVXFR');
  PARAMETER(DB1.G6804_P107_UPC_GTIN_CODE);
  PARAMETER(LCL.Validation_Pass_USR);

  //?'UK' Data Value Length is 14, Then Proceed.
  CASE;

  // IF LCL.Validation Pass USR is Yes
  IF LCL.Validation_Pass_USR = 'Y';

  // PAR.CIR Resource No Type = CND.UPC/EAN (1-2-5-5-1)
  PAR.CIR_Resource_No_Type = 'UK';

  // PAR.CIR Resource No = DB1.G6804/P107 UPC/GTIN CODE
  PAR.CIR_Resource_No = DB1.G6804_P107_UPC_GTIN_CODE;

  EXECUTE FUNCTION(Rtv Chg/Ct CIR EDI    RT) TYPE(RTVOBJ) FILE(PUBQREP)           AC2176793;
  PARAMETER(PAR.EDI_Trading_Partner_No);
  PARAMETER(PAR.Item_Code_Number_7_0_USR);
  PARAMETER(PAR.CIR_Resource_No_Type);
  PARAMETER(PAR.CIR_Resource_No);
  PARAMETER(DB1.G6901_ITEM_DESCRIPTION);
  {
   //?USER: Processing if Data record not found

   EXECUTE FUNCTION(Crt Customer Item Ref  CR) TYPE(CRTOBJ) FILE(PUBQREP)          AC2176604;
   PARAMETER(PAR.EDI_Trading_Partner_No);
   PARAMETER(PAR.Item_Code);
   PARAMETER(PAR.CIR_Resource_No_Type);
   PARAMETER(*BLANK);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(LCL.CIR_Unused_Status_1);
   PARAMETER(LCL.CIR_Unused_Status_2);
   PARAMETER(LCL.CIR_UM_Base_Price);
   PARAMETER(LCL.CIR_Unused_Status_5);
   PARAMETER(LCL.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Crt Date/Time      IF) TYPE(EXCINTFUN)                     AC1523477;
    PARAMETER(DB1.Record_Status);
    PARAMETER(DB1.Create_Date);
    PARAMETER(DB1.Create_Time);
    PARAMETER(DB1.Create_User);
    PARAMETER(DB1.Create_Program);
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     //?*** Set RECORD STATUS field. ***
     // PAR.Record Status = CND.Active
     PAR.Record_Status = 'A';

     //?*** Set CREATE fields. ***
     // PAR.Create Date = JOB.*Job date
     PAR.Create_Date = JOB.*Job_date;

     // PAR.Create Time = JOB.*Job time
     PAR.Create_Time = JOB.*Job_time;

     // PAR.Create User = JOB.*USER
     PAR.Create_User = JOB.*USER;

     // PAR.Create Program = JOB.*PROGRAM
     PAR.Create_Program = JOB.*PROGRAM;

     //?*** Set CHANGE fields. ***
     // PAR.Change Date = CON.*ZERO
     PAR.Change_Date = *ZERO;

     // PAR.Change Time = CON.*ZERO
     PAR.Change_Time = *ZERO;

     // PAR.Change User = CON.*BLANK
     PAR.Change_User = *BLANK;

     // PAR.Change Program = CON.*BLANK
     PAR.Change_Program = *BLANK;

    }

    //?USER: Processing if Data record already exists

    // PGM.*Return code = CND.*Normal
    PGM.*Return_code = *BLANK;

   }

   //?USER: Process Data record

   CASE;

   // IF DB1.CIR Resource No NE PAR.CIR Resource No
   IF DB1.CIR_Resource_No <> PAR.CIR_Resource_No;

   EXECUTE FUNCTION(Chg Customer Item Ref CH) TYPE(CHGOBJ) FILE(PUBQREP)           AC2176605;
   PARAMETER(DB1.EDI_Trading_Partner_No);
   PARAMETER(DB1.Item_Code);
   PARAMETER(DB1.CIR_Resource_No_Type);
   PARAMETER(DB1.CIR_Item_No);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(DB1.CIR_Description_Line);
   PARAMETER(DB1.CIR_Description_Line_2);
   PARAMETER(DB1.CIR_Description_Line_3);
   PARAMETER(DB1.CIR_Unused_Status_1);
   PARAMETER(DB1.CIR_Unused_Status_2);
   PARAMETER(DB1.CIR_UM_Base_Price);
   PARAMETER(DB1.CIR_Unused_Status_5);
   PARAMETER(DB1.Record_Status);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Chg Date/Time      IF) TYPE(EXCINTFUN)                     AC1523476;
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     // PAR.Change Date = JOB.*Job date
     PAR.Change_Date = JOB.*Job_date;

     // PAR.Change Time = JOB.*Job time
     PAR.Change_Time = JOB.*Job_time;

     // PAR.Change User = JOB.*USER
     PAR.Change_User = JOB.*USER;

     // PAR.Change Program = JOB.*PROGRAM
     PAR.Change_Program = JOB.*PROGRAM;

    }

   }

   ENDIF;

  }

  ENDIF;

  ENDIF;

  //?S17059 DN 04/26/21-Create Customer Item Reference Record if Not Found.
  CASE;

  // IF DB1.G6807/PO110 Prod ID Qual is Entered
  IF DB1.G6807_PO110_Prod_ID_Qual <> *BLANK;

  //?W100147 DN 05/27/22-Added 'CIR UM Base Price' as Input Parm.
  EXECUTE FUNCTION(Upd Crt Cust Item Ref  RT) TYPE(RTVOBJ) FILE(POBIREP)          AC2197023;
  PARAMETER(PAR.Customer_Number_NBR);
  PARAMETER(PAR.Item_Code_Number_7_0_USR);
  PARAMETER(DB1.G6808_PO111_Prod_ID);
  PARAMETER(DB1.G6807_PO110_Prod_ID_Qual);
  PARAMETER(DB1.POD_Basis_Unit_Prc_Cde);
  {
   //?USER: Processing if Data record not found

   //?W100147 DN 05/27/22-Added 'CIR UM Base Price' for Update.
   EXECUTE FUNCTION(Crt Cust Item Ref     CR) TYPE(CRTOBJ) FILE(POBIREP)           AC1631562;
   PARAMETER(PAR.Ship_To_Customer);
   PARAMETER(PAR.Item_Code);
   PARAMETER(PAR.CIR_Resource_No);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(LCL.Blank_1_USR);
   PARAMETER(LCL.Blank_1_USR);
   PARAMETER(PAR.CIR_Resource_No_Type);
   PARAMETER(PAR.CIR_UM_Base_Price);
   PARAMETER(LCL.Blank_1_USR);
   PARAMETER('A');
   PARAMETER(JOB.*Job_date);
   PARAMETER(JOB.*Job_time);
   PARAMETER(JOB.*USER);
   PARAMETER(JOB.*PROGRAM);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Crt Date/Time      IF) TYPE(EXCINTFUN)                     AC1523477;
    PARAMETER(DB1.Record_Status);
    PARAMETER(DB1.Create_Date);
    PARAMETER(DB1.Create_Time);
    PARAMETER(DB1.Create_User);
    PARAMETER(DB1.Create_Program);
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?Execute internal function

     //?*** Set RECORD STATUS field. ***
     // PAR.Record Status = CND.Active
     PAR.Record_Status = 'A';

     //?*** Set CREATE fields. ***
     // PAR.Create Date = JOB.*Job date
     PAR.Create_Date = JOB.*Job_date;

     // PAR.Create Time = JOB.*Job time
     PAR.Create_Time = JOB.*Job_time;

     // PAR.Create User = JOB.*USER
     PAR.Create_User = JOB.*USER;

     // PAR.Create Program = JOB.*PROGRAM
     PAR.Create_Program = JOB.*PROGRAM;

     //?*** Set CHANGE fields. ***
     // PAR.Change Date = CON.*ZERO
     PAR.Change_Date = *ZERO;

     // PAR.Change Time = CON.*ZERO
     PAR.Change_Time = *ZERO;

     // PAR.Change User = CON.*BLANK
     PAR.Change_User = *BLANK;

     // PAR.Change Program = CON.*BLANK
     PAR.Change_Program = *BLANK;

    }

   }

  }

  ENDIF;

  // IF *OTHERWISE
  IF *OTHERWISE;

  EXECUTE FUNCTION(Crt WF EDI PO Detail  CR) TYPE(CRTOBJ) FILE(PUBSCPP)           AC2179495;
  PARAMETER(DB1.ST02_TRANS_SET_CONTROL_NU);
  PARAMETER(DB1.ITEM_SEQUENCE_NUMBER);
  PARAMETER(PAR.EDI_Trading_Partner_No);
  PARAMETER(PAR.G5003_PURCHASE_ORDER_NUMB);
  PARAMETER(PAR.G5002_ORDER_DATE);
  PARAMETER(DB1.G6804_P107_UPC_GTIN_CODE);
  PARAMETER(DB1.G6901_ITEM_DESCRIPTION);
  PARAMETER(DB1.G6805_P108_PROD_ID_QUAL);
  PARAMETER(DB1.G6806_P109_PRODUCT_ID);
  PARAMETER(DB1.G6807_PO110_Prod_ID_Qual);
  PARAMETER(DB1.G6808_PO111_Prod_ID);
  PARAMETER(DB1.PO112_Prod_ID_Qual);
  PARAMETER(DB1.PO113_Prod_ID);
  PARAMETER(DB1.P106_UPC_GTIN_QUAL);
  PARAMETER(DB1.POD_Unused_GTIN);
  ENDIF;

 }

}


