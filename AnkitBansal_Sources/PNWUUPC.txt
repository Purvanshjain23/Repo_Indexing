/*********************************************************************/
/*  SYNOPSIS -  SUBMIT THE PROGRAM TO DOWNLOAD FUEL SURCHARGE AND    */
/*              EXPORT LOAD VERIFICATION AS A SPREADSHEET            */
/*                                                                   */
/*  SYSTEM      - ORDER MANAGEMENT SYSTEM                            */
/*  PROGRAM     - PNWUUPC                                            */
/*  DESCRIPTION - SUBMITS PROGRAM TO PRINT THE FUEL SURCHARGE REPORT */
/*  DATE        - 04/01/2014                                         */
/*  PROGRAMMER  - LARA BUSER                                         */
/*                                                                   */
/*  PARAMETERS:                                                      */
/*   &CARRIER    - BACKHAUL CARRIER CODE                             */
/*   &COMPNYN    - COMPANY NUMBER 15.5                               */
/*   &FRMDATN    - FROM BOL DATE 15.5                               */
/*   &THRDATN    - THRU BOL DATE 15.5                               */
/*   &RATEAMTN   - RATE AMOUNT   15.5                               */
/*   &RATEAMTN2  - RATE AMOUNT 2 15.5                               */
/*   &EMAIL      - EMAIL ADDRESS                                    */
/*   &RPTTYPE    - REPORT TYPE                                      */
/*********************************************************************/
/* Modifications:                                                    */
/*   Date     Pgmr     Description                                   */
/* -------- ---------- --------------------------------------------  */
/*                                                                   */
/*********************************************************************/
 PMWUUPC:    PGM        PARM(&COMPNYN &FRMDATN &TODATN &RATEAMTN +
                          &RATEAMTN2 &CARRIER &RPTTYPE &EMAIL)

             DCL        VAR(&CARRIER)   TYPE(*CHAR) LEN(3)
             DCL        VAR(&RPTTYPE)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&DESC)      TYPE(*CHAR) LEN(30)
             DCL        VAR(&OUTQ)      TYPE(*CHAR) LEN(10)
             DCL        VAR(&HOLD)      TYPE(*CHAR) LEN(4)
             DCL        VAR(&SAVE)      TYPE(*CHAR) LEN(4)
             DCL        VAR(&COMPNYN)   TYPE(*DEC)
             DCL        VAR(&COMP)      TYPE(*DEC) LEN(3 0)
             DCL        VAR(&COMPA)     TYPE(*CHAR) LEN(3)
             DCL        VAR(&FRMDATN)   TYPE(*DEC)
             DCL        VAR(&FROMDT)    TYPE(*DEC) LEN(7 0)
             DCL        VAR(&FROMDTA)   TYPE(*CHAR) LEN(7)
             DCL        VAR(&FROMDT10)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&TODATN)    TYPE(*DEC)
             DCL        VAR(&TODT)      TYPE(*DEC) LEN(7 0)
             DCL        VAR(&TODTA)     TYPE(*CHAR) LEN(7)
             DCL        VAR(&TODTA10)   TYPE(*CHAR) LEN(10)
             DCL        VAR(&RATEAMTN)  TYPE(*DEC)
             DCL        VAR(&RATEAMT)   TYPE(*DEC) LEN(9 4)
             DCL        VAR(&RATEAMTA)  TYPE(*CHAR) LEN(9)
             DCL        VAR(&RATEAMTN2) TYPE(*DEC)
             DCL        VAR(&RATEAMT2)  TYPE(*DEC) LEN(9 4)
             DCL        VAR(&RATEAMTA2) TYPE(*CHAR) LEN(9)
             DCL        VAR(&EMAIL) TYPE(*CHAR) LEN(50)
             DCL        VAR(&SUBJECT) TYPE(*CHAR) LEN(65)

             CHGVAR     VAR(&FROMDT) VALUE(&FRMDATN)
             CHGVAR     VAR(&FROMDTA) VALUE(&FROMDT)
             CHGVAR     VAR(&TODT) VALUE(&TODATN)
             CHGVAR     VAR(&TODTA) VALUE(&TODT)
             CHGVAR     VAR(&COMP) VALUE(&COMPNYN)
             CHGVAR     VAR(&COMPA) VALUE(&COMP)
             CHGVAR     VAR(&RATEAMT) VALUE(&RATEAMTN)
             CHGVAR     VAR(&RATEAMTA) VALUE(&RATEAMT)
             CHGVAR     VAR(&RATEAMT2) VALUE(&RATEAMTN2)
             CHGVAR     VAR(&RATEAMTA2) VALUE(&RATEAMT2)

/* CONVERT FROM DATE TO MM/DD/YYYY CHAR FORMAT                       */
             CVTDAT     DATE(&FROMDTA) TOVAR(&FROMDT10) +
                          FROMFMT(*CYMD) TOFMT(*MDYY) TOSEP(/)
/* CONVERT TO DATE TO MM/DD/YYYY CHAR FORMAT                         */
             CVTDAT     DATE(&TODTA) TOVAR(&TODTA10) FROMFMT(*CYMD) +
                          TOFMT(*MDYY) TOSEP(/)

/* ATTACHMENT - FORMAT THE SUBJECT LINE                              */
             CHGVAR     VAR(&SUBJECT) VALUE('Fuel Surcharge/Load +
                          Verification: ' *CAT &FROMDT10 *CAT ' - ' +
                          *CAT &TODTA10)

/****  RMVLIBLE PRKDEVQRY        +
MONMSG CPF9999                   +
ADDLIBLE PRKDEVQRY *LAST         +
MONMSG CPF9999         **********/
/*-------------------------------------------------------------------*/
/* REPORT TYPE = 1: 1 COMPANY, 1 CARRIER                             */
/*-------------------------------------------------------------------*/
             IF         COND(&RPTTYPE *EQ '1') THEN(DO)
             EXECUTE    VIEW(PMAMRELFV1) PCFMT(*XLS) +
                          RECIPIENT(&EMAIL) EMLMSG(&SUBJECT) +
                          SETVAR((&CO# &COMPA) (&BHCARRIER +
                          &CARRIER) (&FROMDATE &FROMDTA) (&THRUDATE +
                          &TODTA) (&RATEAMT &RATEAMTA) (&RATEAMT2 +
                          &RATEAMTA2))
             MONMSG     MSGID(CPF6801)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

/*-------------------------------------------------------------------*/
/* REPORT TYPE = 2: ALL COMPANIES, ALL CARRIERS                      */
/*-------------------------------------------------------------------*/
             IF         COND(&RPTTYPE *EQ '2') THEN(DO)
             EXECUTE    VIEW(PMAMRELFV2) PCFMT(*XLS) +
                          RECIPIENT(&EMAIL) EMLMSG(&SUBJECT) +
                          SETVAR((&FROMDATE &FROMDTA) (&THRUDATE +
                          &TODTA) (&RATEAMT &RATEAMTA) (&RATEAMT2 +
                          &RATEAMTA2))
             MONMSG     MSGID(CPF6801)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

/*-------------------------------------------------------------------*/
/* REPORT TYPE = 3: ALL COMPANIES, 1 CARRIER                         */
/*-------------------------------------------------------------------*/
             IF         COND(&RPTTYPE *EQ '3') THEN(DO)
             EXECUTE    VIEW(PMAMRELFV3) PCFMT(*XLS) +
                          RECIPIENT(&EMAIL) EMLMSG(&SUBJECT) +
                          SETVAR((&BHCARRIER &CARRIER) (&FROMDATE +
                          &FROMDTA) (&THRUDATE &TODTA) (&RATEAMT +
                          &RATEAMTA) (&RATEAMT2 &RATEAMTA2))
             MONMSG     MSGID(CPF6801)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

/*-------------------------------------------------------------------*/
/* REPORT TYPE = 4: 1 COMPANY, ALL CARRIERS                          */
/*-------------------------------------------------------------------*/
             IF         COND(&RPTTYPE *EQ '4') THEN(DO)
             EXECUTE    VIEW(PMAMRELFV4) PCFMT(*XLS) +
                          RECIPIENT(&EMAIL) EMLMSG(&SUBJECT) +
                          SETVAR((&CO# &COMPA) (&FROMDATE &FROMDTA) +
                          (&THRUDATE &TODTA) (&RATEAMT &RATEAMTA) +
                          (&RATEAMT2 &RATEAMTA2))
             MONMSG     MSGID(CPF6801)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

 ENDPGM:     ENDPGM
