/***************************************************************** */
/*                                                                 */
/* YECALUPDT- YEAR END CALENDAR FILE SETUP - TEST ENVIRONMENTS ONLY*/
/*                                                                 */
/*                                                                 */
/* This CL should only be ran after the OMS calendar files have    */
/* been updated for the new year ON SBFPROD AND those files copied */
/* over in the normal SBFDEV refresh process.  Currently this      */
/* happens on the 3rd Sunday of the month.                         */
/*                                                                 */
/* This CL will only update test libraries and is dependent upon   */
/* the production files being copied over from SBFPROD containing  */
/* the new year.                                                   */
/*                                                                 */
/* Once cl completes, verify new year was created in test files.   */
/*                                                                 */
/*  Created by:  Barb Gutierrez   2/20/2023                        */
/*                                                                 */
/* --------------------------------------------------------------- */
/* Modified by: BARB GUTIERREZ 8/15/2023                           */
/*              ADDED PRKUATF LIBRARY                              */
/*******************************************************************/

             PGM

             DCL        VAR(&ERR)    TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&USER)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&EMAIL)    TYPE(*CHAR) LEN(42)
             DCL        VAR(&SUBJECT) TYPE(*CHAR) LEN(64) +
                          VALUE('Calendar file creation in  +
                          test libraries.')

/*------------------------------------------------------------------*/
/* Set up the Email Recipient                                       */
/*------------------------------------------------------------------*/

             CHGVAR     VAR(&EMAIL) VALUE('dl calendar test')

/*-----------------------------------------------------------------*/

/*  PRKtestf  ---  replace                                         */

             CPYF       FROMFILE(PRKFLIB/CAAfREP) +
                          TOFILE(PRKTESTF/CAAfREP) MBROPT(*REPLACE) +
                          CRTFILE(*NO)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))

             CPYF       FROMFILE(PRKFLIB/CAATREP) +
                          TOFILE(PRKTESTF/CAATREP) MBROPT(*REPLACE) +
                          CRTFILE(*NO)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))

/*  TPMtestf  ---  replace                                         */

             CPYF       FROMFILE(PRKFLIB/CAAfREP) +
                          TOFILE(TPMTESTF/CAAfREP) MBROPT(*REPLACE) +
                          CRTFILE(*NO)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))

             CPYF       FROMFILE(PRKFLIB/CAATREP) +
                          TOFILE(TPMTESTF/CAATREP) MBROPT(*REPLACE) +
                          CRTFILE(*NO)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))


/*  PRKUATF   ---  replace                                         */

             CPYF       FROMFILE(PRKFLIB/CAAfREP) +
                          TOFILE(PRKUATF/CAAfREP) MBROPT(*REPLACE) +
                          CRTFILE(*NO)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))

             CPYF       FROMFILE(PRKFLIB/CAATREP) +
                          TOFILE(PRKUATF/CAATREP) MBROPT(*REPLACE) +
                          CRTFILE(*NO)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))

/*  PRKEDITEST --  replace                                         */

             CPYF       FROMFILE(PRKFLIB/CAAFREP) +
                          TOFILE(PRKEDITEST/CAAFREP) +
                          MBROPT(*REPLACE) CRTFILE(*NO)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))

             CPYF       FROMFILE(PRKFLIB/CAATREP) +
                          TOFILE(PRKEDITEST/CAATREP) +
                          MBROPT(*REPLACE) CRTFILE(*NO)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))

/*  OMSDEVGEN  --  replace                                         */

             CPYF       FROMFILE(PRKFLIB/CAAFREP) +
                          TOFILE(OMSDEVGEN/CAAFREP) +
                          MBROPT(*REPLACE) CRTFILE(*NO)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))

             CPYF       FROMFILE(PRKFLIB/CAATREP) +
                          TOFILE(OMSDEVGEN/CAATREP) +
                          MBROPT(*REPLACE) CRTFILE(*NO)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))

/*-----------------------------------------------------------------*/
/*  Update the High Plains test library.                           */
/*-----------------------------------------------------------------*/
/*  hpbtestf  ---  replace                                         */


             CPYF       FROMFILE(HPBFLIB/CAAfREP) +
                          TOFILE(HPBTESTF/CAAfREP) MBROPT(*REPLACE) +
                          CRTFILE(*NO)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))

             CPYF       FROMFILE(HPBFLIB/CAATREP) +
                          TOFILE(HPBTESTF/CAATREP) MBROPT(*REPLACE) +
                          CRTFILE(*NO)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))

/*-----------------------------------------------------------------*/
/*  DAILYS LIBRARIES ARE NOT ON SBFDEV.  COMMENT OUT.              */
/*  Update Daily Foods Test common library to be used with their   */
/*  old applications.                                              */
/*-----------------------------------------------------------------*/
/*  common  ---  replace                                         */

/*           CPYF       FROMFILE(common/CAAfREP) +
                          TOFILE(tstdlycf/CAAfREP) MBROPT(*REPLACE) +
                          CRTFILE(*NO)                     */
/*           MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))                      */

/*           CPYF       FROMFILE(common/CAATREP) +
                          TOFILE(tstdlycf/CAATREP) MBROPT(*REPLACE) +
                          CRTFILE(*NO)                  */
/*           MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))                   */

/*-----------------------------------------------------------------*/
/*  Update Daily Foods Test library                                */
/*-----------------------------------------------------------------*/
/*  dlytestf  ---  replace                                         */

/*           CPYF       FROMFILE(dpmFLIB/CAAfREP) +
                          TOFILE(dlytestf/CAAfREP) MBROPT(*REPLACE) +
                          CRTFILE(*NO)                 */
/*           MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))                  */

/*           CPYF       FROMFILE(dpmFLIB/CAATREP) +
                          TOFILE(dlytestf/CAATREP) MBROPT(*REPLACE) +
                          CRTFILE(*NO)                      */
/*           MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))                 */

/*-----------------------------------------------------------------*/
/*  Update Data mart calendar CAPCAL                             */
/*-----------------------------------------------------------------*/
/*  prktestf  ---  replace                                         */

             CPYF       FROMFILE(prkflib/capcal)  +
                          TOFILE(prktestf/capcal) MBROPT(*REPLACE) +
                          CRTFILE(*NO)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))

/*  tpmtestf  ---  replace                                         */

             CPYF       FROMFILE(prkflib/capcal)  +
                          TOFILE(tpmtestf/capcal) MBROPT(*REPLACE) +
                          CRTFILE(*NO)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))

/*  prkuatf   ---  Replace                                         */

             CPYF       FROMFILE(prkflib/capcal)  +
                          TOFILE(prkuatf/capcal) MBROPT(*REPLACE) +
                          CRTFILE(*NO)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))

/*  tstdmflib ---  replace                                         */

             CPYF       FROMFILE(prkflib/capcal)  +
                          TOFILE(tstdmflib/capcal) MBROPT(*REPLACE) +
                          CRTFILE(*NO)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))

/*-----------------------------------------------------------------*/
/*  Update Data mart calendar DMPCAL                             */
/*-----------------------------------------------------------------*/

             CPYF       FROMFILE(PRKFLIB/CAPCAL) +
                          TOFILE(TSTDMFLIB/DMPCAL) MBROPT(*REPLACE) +
                          CRTFILE(*NO) FMTOPT(*MAP *DROP)
             MONMSG     MSGID(CPF2817 CPF2864) EXEC(CHGVAR VAR(&ERR) +
                          VALUE('Y'))


/*-----------------------------------------------------------------*/
/*  Email processing                                             */
/*-----------------------------------------------------------------*/


             IF         COND(&ERR = 'Y') THEN(ESNDMAIL +
                          RECIPIENT(&EMAIL) SUBJECT(&SUBJECT) +
                          MSG('All Test Calendar Files did not get +
                          created. Investigate joblog and rerun the +
                          job.') IMPORTANCE(*NORMAL))

             IF         COND(&ERR = 'N') THEN(ESNDMAIL +
                          RECIPIENT(&EMAIL) SUBJECT(&SUBJECT) +
                          MSG('Test Calendar files successfully +
                          created in all libs.') IMPORTANCE(*NORMAL))


             ENDPGM

