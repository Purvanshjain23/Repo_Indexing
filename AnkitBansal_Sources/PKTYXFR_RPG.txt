     H/TITLE Prc Pay w/Hist Avgs   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:53:50
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKBOREL1IF  E           K        DISK
      * RTV : Evaluation Validation     Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     I@BOREFN
      * Evaluation Validation     Retrieval index
      * Renamed input format fields
     I              BOBVCD                          WABVCD
     I              BOCBTX                          WACBTX
     I              BOC5ST                          WAC5ST
     I              BOAFPC                          WAAFPC
     I              BOAGPC                          WAAGPC
     I              BOFEST                          WAFEST
     I              BOAAVN                          WAAAVN
     I              BOAADT                          WAAADT
     I              BOAMTM                          WAAMTM
     I              BOAJST                          WAAJST
     I              BOAHVN                          WAAHVN
     I              BOAGVN                          WAAGVN
     I              BOABVN                          WAABVN
     I              BOABDT                          WAABDT
     I              BOABTM                          WAABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * Outward parameters
     IPARC        DS                            583
      * RCD : Tattoo Header             Retrieval index
      * I :  BOH Company Number
     I                                    P   1   20PAHMNB
      * I :  BOH Buy Order Number
     I                                    P   3   60PABNNB
      * I :  BOL Load Number
     I                                    P   7   90PABONB
      * I :  TH Tattoo Number
     I                                    P  10  120PACVNB
      * I :  TH Kill Date
     I                                    P  13  160PAB0DT
      * I :  TH Purchase Date
     I                                    P  17  200PAAWDT
      * I :  TH Group Reference
     I                                       21  30 PABICD
      * I :  TH Live Purchase UOM
     I                                       31  32 PACPST
      * I :  TH Live Purchase Price
     I                                    P  33  352PAACPR
      * I :  TH Live Gross Amt
     I                                    P  36  392PAB9PR
      * I :  TH LIve Net Amt
     I                                    P  40  432PACAPR
      * I :  TH Resale UOM
     I                                       44  45 PAC4ST
      * I :  TH Recalc Live Wgt Yld
     I                                    P  46  482PAAIPR
      * I :  TH Pricing Date
     I                                    P  49  520PAA6DT
      * I :  TH Resale Spread Sts
     I                                       53  53 PAC2ST
      * I :  TH Dead On Arrival
     I                                    P  54  560PACXNB
      * I :  TH Head Received
     I                                    P  57  590PACWNB
      * I :  TH Yard Deads
     I                                    P  60  620PAFCNB
      * I :  TH Held Over
     I                                    P  63  650PAH9NB
      * I :  TH Head Condemned
     I                                    P  66  680PAFDNB
      * I :  TH Head Killed
     I                                    P  69  710PAFENB
      * I :  TH Head Adds
     I                                    P  72  740PAHENB
      * I :  TH Head Accepted
     I                                    P  75  770PAHFNB
      * I :  TH Live Wgt
     I                                    P  78  811PACYNB
      * I :  TH Adj Live Wgt
     I                                    P  82  851PALRNB
      * I :  TH Hot Wgt
     I                                    P  86  891PAE0NB
      * I :  TH Tot Loin Eye Depth
     I                                    P  90  931PAA5PC
      * I :  TH Tot Backfat Inches
     I                                    P  94  971PAFBNB
      * I :  TH Tot Light Reflectance
     I                                    P  98 1011PAA4PC
      * I :  TH Avg Live Wgt
     I                                    P 102 1041PAF7NB
      * I :  TH Avg Hot Wgt
     I                                    P 105 1071PAHDNB
      * I :  TH Avg Light Reflectance
     I                                    P 108 1091PAF5NB
      * I :  TH Avg Lean Percent
     I                                    P 110 1111PAF4NB
      * I :  TH Avg Loin Eye Depth
     I                                    P 112 1131PAF3NB
      * I :  TH Avg Backfat
     I                                    P 114 1151PAF2NB
      * I :  TH Std Yield Percent
     I                                    P 116 1182PAAVPC
      * I :  TH Actual Yield %
     I                                    P 119 1212PAAWPC
      * I :  TH Adj Actual Yield %
     I                                    P 122 1242PACWPC
      * I :  TH Yield Difference
     I                                    P 125 1272PAA8PC
      * I :  TH Recalc Live Wgt
     I                                    P 128 1291PAA7PC
      * I :  TH CM Market Price
     I                                    P 130 1322PAB8PR
      * I :  TH CM Base Mkt Price
     I                                    P 133 1352PAAMPR
      * I :  TH CM Base Mkt Price Amt
     I                                    P 136 1392PAANPR
      * I :  TH CM Sort Discount Amt
     I                                    P 140 1432PAAYVA
      * I :  TH CM Yield Gain/Loss Amt
     I                                    P 144 1472PAAWVA
      * I :  TH CM Base Carcass Value
     I                                    P 148 1512PAAOPR
      * I :  TH CM LN AddOn/Deduct Amt
     I                                    P 152 1552PAAXVA
      * I :  TH CM Carcass Gross Amt
     I                                    P 156 1592PAAPPR
      * I :  TH Deduction Amt
     I                                    P 160 1632PAASPR
      * I :  TH Total Net WO Adds
     I                                    P 164 1672PAA4VA
      * I :  TH Carcass Net Amt
     I                                    P 168 1712PAATPR
      * I :  TH Additions Amt
     I                                    P 172 1752PAA5VA
      * I :  TH Payment Gross
     I                                    P 176 1792PACBPR
      * I :  Th Payment Net Amt
     I                                    P 180 1832PACCPR
      * I :  TH AP Voucher/Document#
     I                                    P 184 1880PALPNB
      * I :  TH Freight Amount
     I                                    P 189 1922PACDPR
      * I :  TH Accrual Amount
     I                                    P 193 1962PAA7VA
      * I :  TH Fixed Cost Amount
     I                                    P 197 2002PAA2PR
      * I :  TH Calc Net Sts
     I                                      201 201 PAJWST
      * I :  TH Payment Sts
     I                                      202 203 PACWST
      * N :  TH Header Error Sts
     I                                      204 204 PAD7ST
      * N :  TH Detail Error Sts
     I                                      205 205 PAD8ST
      * N :  TH Kill Balancing Sts
     I                                      206 206 PADWST
      * I :  TH Bal to Kill Gen
     I                                      207 207 PAD6ST
      * I :  TH Commission A/P Voucher
     I                                      208 2150PAGHNB
      * I :  TH Voucher Payment Date
     I                                    P 216 2190PABYDT
      * I :  TH User Error Override
     I                                      220 220 PAE0ST
      * I :  TH Held Over Record
     I                                      221 221 PAE1ST
      * I :  TH Sex
     I                                      222 222 PAE2ST
      * I :  TH Held/Ovr Completed Dte
     I                                    P 223 2260PABSDT
      * I :  TH Commission Paid Date
     I                                    P 227 2300PABTDT
      * I :  TH Actual Check Date
     I                                    P 231 2340PABUDT
      * I :  TH Shipped Weight
     I                                    P 235 2381PAHGNB
      * I :  TH Avg Hot Wgt EXC/ADD
     I                                    P 239 2421PAHHNB
      * I :  TH FFLI
     I                                    P 243 2441PAHINB
      * I :  TH Kill Product Value
     I                                    P 245 2482PAA3PR
      * I :  TH Cut Product Value
     I                                    P 249 2522PAA4PR
      * I :  TH Render Product Value
     I                                    P 253 2562PAA6PR
      * I :  TH Head Excluded
     I                                    P 257 2590PAJ9NB
      * I :  TH CM Bse Mkt Live /CWT
     I                                    P 260 2622PAD6PR
      * I :  TH CM Bse Mkt Carc /CWT
     I                                    P 263 2652PAD7PR
      * I :  TH CM Srt Dsc Live /CWT
     I                                    P 266 2682PAD8PR
      * I :  TH CM Srt Dsc Carc /CWT
     I                                    P 269 2712PAD9PR
      * I :  TH CM Yld G/L Live /CWT
     I                                    P 272 2742PAEAPR
      * I :  TH CM Yld G/L Carc /CWT
     I                                    P 275 2772PAEBPR
      * I :  TH CM Crc Val Live /CWT
     I                                    P 278 2802PAECPR
      * I :  TH CM Crc Val Carc /CWT
     I                                    P 281 2832PAEDPR
      * I :  TH CM Lean Prem Live /CWT
     I                                    P 284 2862PAEEPR
      * I :  TH CM Lean Prem Carc /CWT
     I                                    P 287 2892PAEFPR
      * I :  TH CM Gross Live /CWT
     I                                    P 290 2922PAEGPR
      * I :  TH CM Gross Carc /CWT
     I                                    P 293 2952PAEHPR
      * I :  TH Source Type
     I                                      296 296 PAKAST
      * I :  TH Scale Ticket Sts
     I                                      297 297 PAJ7ST
      * I :  TH Payment Type
     I                                      298 298 PAJ9ST
      * I :  TH HPS Movement Ref #
     I                                    P 299 3020PAOXNB
      * I :  TH Source Code
     I                                      303 305 PALKST
      * I :  TH Hog Class Type
     I                                      306 306 PALLST
      * I :  TH Posted to HPS Flag
     I                                      307 307 PAJ8ST
      * I :  TH Schedule Kill Shift
     I                                      308 308 PALIST
      * I :  TH Shift Held Over
     I                                      309 309 PALJST
      * I :  DF Defect Code
     I                                      492 497 PABDCD
      * I :  THP Process Code
     I                                      498 503 PACSCD
      * I :  PD Producer Code
     I                                      504 509 PAABCD
      * I :  PL Location Code
     I                                      510 515 PAAECD
      * I :  HB Buyer Code
     I                                      516 518 PAACCD
      * I :  GN Genetic Code
     I                                      519 523 PAAGCD
      * I :  HC Class Code
     I                                      524 526 PABECD
      * I :  RS User Changed
     I                                      527 536 PAAAVN
      * I :  RS Date Changed
     I                                    P 537 5400PAAADT
      * I :  RS Time Changed
     I                                    P 541 5440PAAMTM
      * I :  RS Record Status
     I                                      545 545 PAAJST
      * I :  RS Job
     I                                      546 555 PAAHVN
      * I :  RS Program
     I                                      556 565 PAAGVN
      * I :  RS User Added
     I                                      566 575 PAABVN
      * I :  RS Date Added
     I                                    P 576 5790PAABDT
      * I :  RS Time Added
     I                                    P 580 5830PAABTM
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I :  BOH Company Number
     I                                    P   1   20P1HMNB
      * I :  BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I :  BOL Load Number
     I                                    P   7   90P1BONB
      * I :  TH Tattoo Number
     I                                    P  10  120P1CVNB
      * I :  TH Kill Date
     I                                    P  13  160P1B0DT
      * N :  TH Purchase Date
     I                                    P  17  200P1AWDT
      * N :  TH Group Reference
     I                                       21  30 P1BICD
      * N :  TH Live Purchase UOM
     I                                       31  32 P1CPST
      * N :  TH Live Purchase Price
     I                                    P  33  352P1ACPR
      * N :  TH Live Gross Amt
     I                                    P  36  392P1B9PR
      * N :  TH LIve Net Amt
     I                                    P  40  432P1CAPR
      * N :  TH Resale UOM
     I                                       44  45 P1C4ST
      * N :  TH Recalc Live Wgt Yld
     I                                    P  46  482P1AIPR
      * N :  TH Pricing Date
     I                                    P  49  520P1A6DT
      * N :  TH Resale Spread Sts
     I                                       53  53 P1C2ST
      * N :  TH Dead On Arrival
     I                                    P  54  560P1CXNB
      * N :  TH Head Received
     I                                    P  57  590P1CWNB
      * N :  TH Yard Deads
     I                                    P  60  620P1FCNB
      * N :  TH Held Over
     I                                    P  63  650P1H9NB
      * N :  TH Head Condemned
     I                                    P  66  680P1FDNB
      * N :  TH Head Killed
     I                                    P  69  710P1FENB
      * N :  TH Head Adds
     I                                    P  72  740P1HENB
      * N :  TH Head Accepted
     I                                    P  75  770P1HFNB
      * N :  TH Live Wgt
     I                                    P  78  811P1CYNB
      * N :  TH Adj Live Wgt
     I                                    P  82  851P1LRNB
      * N :  TH Hot Wgt
     I                                    P  86  891P1E0NB
      * N :  TH Tot Loin Eye Depth
     I                                    P  90  931P1A5PC
      * N :  TH Tot Backfat Inches
     I                                    P  94  971P1FBNB
      * N :  TH Tot Light Reflectance
     I                                    P  98 1011P1A4PC
      * N :  TH Avg Live Wgt
     I                                    P 102 1041P1F7NB
      * N :  TH Avg Hot Wgt
     I                                    P 105 1071P1HDNB
      * N :  TH Avg Light Reflectance
     I                                    P 108 1091P1F5NB
      * N :  TH Avg Lean Percent
     I                                    P 110 1111P1F4NB
      * N :  TH Avg Loin Eye Depth
     I                                    P 112 1131P1F3NB
      * N :  TH Avg Backfat
     I                                    P 114 1151P1F2NB
      * N :  TH Std Yield Percent
     I                                    P 116 1182P1AVPC
      * N :  TH Actual Yield %
     I                                    P 119 1212P1AWPC
      * N :  TH Adj Actual Yield %
     I                                    P 122 1242P1CWPC
      * N :  TH Yield Difference
     I                                    P 125 1272P1A8PC
      * N :  TH Recalc Live Wgt
     I                                    P 128 1291P1A7PC
      * N :  TH CM Market Price
     I                                    P 130 1322P1B8PR
      * N :  TH CM Base Mkt Price
     I                                    P 133 1352P1AMPR
      * N :  TH CM Base Mkt Price Amt
     I                                    P 136 1392P1ANPR
      * N :  TH CM Sort Discount Amt
     I                                    P 140 1432P1AYVA
      * N :  TH CM Yield Gain/Loss Amt
     I                                    P 144 1472P1AWVA
      * N :  TH CM Base Carcass Value
     I                                    P 148 1512P1AOPR
      * N :  TH CM LN AddOn/Deduct Amt
     I                                    P 152 1552P1AXVA
      * N :  TH CM Carcass Gross Amt
     I                                    P 156 1592P1APPR
      * N :  TH Deduction Amt
     I                                    P 160 1632P1ASPR
      * N :  TH Total Net WO Adds
     I                                    P 164 1672P1A4VA
      * N :  TH Carcass Net Amt
     I                                    P 168 1712P1ATPR
      * N :  TH Additions Amt
     I                                    P 172 1752P1A5VA
      * N :  TH Payment Gross
     I                                    P 176 1792P1CBPR
      * N :  Th Payment Net Amt
     I                                    P 180 1832P1CCPR
      * N :  TH AP Voucher/Document#
     I                                    P 184 1880P1LPNB
      * N :  TH Freight Amount
     I                                    P 189 1922P1CDPR
      * N :  TH Accrual Amount
     I                                    P 193 1962P1A7VA
      * N :  TH Fixed Cost Amount
     I                                    P 197 2002P1A2PR
      * N :  TH Calc Net Sts
     I                                      201 201 P1JWST
      * N :  TH Payment Sts
     I                                      202 203 P1CWST
      * N :  TH Header Error Sts
     I                                      204 204 P1D7ST
      * N :  TH Detail Error Sts
     I                                      205 205 P1D8ST
      * N :  TH Kill Balancing Sts
     I                                      206 206 P1DWST
      * N :  TH Bal to Kill Gen
     I                                      207 207 P1D6ST
      * N :  TH Commission A/P Voucher
     I                                      208 2150P1GHNB
      * N :  TH Voucher Payment Date
     I                                    P 216 2190P1BYDT
      * N :  TH User Error Override
     I                                      220 220 P1E0ST
      * N :  TH Held Over Record
     I                                      221 221 P1E1ST
      * N :  TH Sex
     I                                      222 222 P1E2ST
      * N :  TH Held/Ovr Completed Dte
     I                                    P 223 2260P1BSDT
      * N :  TH Commission Paid Date
     I                                    P 227 2300P1BTDT
      * N :  TH Actual Check Date
     I                                    P 231 2340P1BUDT
      * N :  TH Shipped Weight
     I                                    P 235 2381P1HGNB
      * N :  TH Avg Hot Wgt EXC/ADD
     I                                    P 239 2421P1HHNB
      * N :  TH FFLI
     I                                    P 243 2441P1HINB
      * N :  TH Kill Product Value
     I                                    P 245 2482P1A3PR
      * N :  TH Cut Product Value
     I                                    P 249 2522P1A4PR
      * N :  TH Render Product Value
     I                                    P 253 2562P1A6PR
      * N :  TH Head Excluded
     I                                    P 257 2590P1J9NB
      * N :  TH CM Bse Mkt Live /CWT
     I                                    P 260 2622P1D6PR
      * N :  TH CM Bse Mkt Carc /CWT
     I                                    P 263 2652P1D7PR
      * N :  TH CM Srt Dsc Live /CWT
     I                                    P 266 2682P1D8PR
      * N :  TH CM Srt Dsc Carc /CWT
     I                                    P 269 2712P1D9PR
      * N :  TH CM Yld G/L Live /CWT
     I                                    P 272 2742P1EAPR
      * N :  TH CM Yld G/L Carc /CWT
     I                                    P 275 2772P1EBPR
      * N :  TH CM Crc Val Live /CWT
     I                                    P 278 2802P1ECPR
      * N :  TH CM Crc Val Carc /CWT
     I                                    P 281 2832P1EDPR
      * N :  TH CM Lean Prem Live /CWT
     I                                    P 284 2862P1EEPR
      * N :  TH CM Lean Prem Carc /CWT
     I                                    P 287 2892P1EFPR
      * N :  TH CM Gross Live /CWT
     I                                    P 290 2922P1EGPR
      * N :  TH CM Gross Carc /CWT
     I                                    P 293 2952P1EHPR
      * N :  TH Source Type
     I                                      296 296 P1KAST
      * N :  TH Scale Ticket Sts
     I                                      297 297 P1J7ST
      * N :  TH Payment Type
     I                                      298 298 P1J9ST
      * N :  TH HPS Movement Ref #
     I                                    P 299 3020P1OXNB
      * N :  TH Source Code
     I                                      303 305 P1LKST
      * N :  TH Hog Class Type
     I                                      306 306 P1LLST
      * N :  TH Posted to HPS Flag
     I                                      307 307 P1J8ST
      * N :  TH Schedule Kill Shift
     I                                      308 308 P1LIST
      * N :  TH Shift Held Over
     I                                      309 309 P1LJST
      * I :  TH PHA Add Type
     I                                      310 310 P1OQET
      * I :  TH PHA Average Type
     I                                      311 313 P1URST
      * I :  TH PHA Add Reason
     I                                      314 314 P1USST
      * N :  DF Defect Code
     I                                      315 320 P1BDCD
      * N :  THP Process Code
     I                                      321 326 P1CSCD
      * N :  PD Producer Code
     I                                      327 332 P1ABCD
      * N :  PL Location Code
     I                                      333 338 P1AECD
      * N :  HB Buyer Code
     I                                      339 341 P1ACCD
      * N :  GN Genetic Code
     I                                      342 346 P1AGCD
      * N :  HC Class Code
     I                                      347 349 P1BECD
      * N :  RS User Changed
     I                                      350 359 P1AAVN
      * N :  RS Date Changed
     I                                    P 360 3630P1AADT
      * N :  RS Time Changed
     I                                    P 364 3670P1AMTM
      * N :  RS Record Status
     I                                      368 368 P1AJST
      * N :  RS Job
     I                                      369 378 P1AHVN
      * N :  RS Program
     I                                      379 388 P1AGVN
      * N :  RS User Added
     I                                      389 398 P1ABVN
      * N :  RS Date Added
     I                                    P 399 4020P1ABDT
      * N :  RS Time Added
     I                                    P 403 4060P1ABTM
     IP2PARM      DS
      * FLD: Producer History WKLY
      * I :  PH GA Adjusted Yield%
     I                                    P   1   32P2G9PC
      * I :  PH GA Avg Lean%
     I                                    P   4   51P2HBPC
      * I :  PH GA Avg Backfat
     I                                    P   6   71P2UWOE
      * I :  PH GA Avg Loin Eye
     I                                    P   8   91P2HEPC
      * I :  PH GA Avg Light Ref
     I                                    P  10  111P2HGPC
      * I :  PH GA Lean Prm /Carc CWT
     I                                    P  12  142P2TIPR
      * I :  PH GA Avg Srt Disc Fctr
     I                                    P  15  173P2B8A1
     IP3PARM      DS
      * FLD: STR Evaluation Min/Max
      * N :  Carcass Dbw Min
     I                                    P   1   41P3I7NB
      * N :  Carcass Dbw Max
     I                                    P   5   81P3I8NB
      * N :  Carcass Lgt Min
     I                                    P   9  121P3I9NB
      * N :  Carcass Lgt Max
     I                                    P  13  161P3JANB
      * N :  %Lean High Min
     I                                    P  17  201P3JBNB
      * N :  %Lean High Max
     I                                    P  21  241P3JLNB
      * N :  %Lean Low Min
     I                                    P  25  281P3JMNB
      * N :  %Lean Low Max
     I                                    P  29  321P3JCNB
      * N :  High Yield Min
     I                                    P  33  361P3JDNB
      * N :  High Yield Max
     I                                    P  37  401P3JENB
      * N :  Low Yield Min
     I                                    P  41  441P3JFNB
      * N :  Low Yield Max
     I                                    P  45  481P3JGNB
      * N :  Head < Percent Min
     I                                    P  49  521P3JHNB
      * N :  Head < Percent Max
     I                                    P  53  561P3JINB
      * N :  Head > Percent Min
     I                                    P  57  601P3JJNB
      * N :  Head > Percent Max
     I                                    P  61  641P3JKNB
      * N :  BackFat High Min
     I                                    P  65  681P3K5NB
      * N :  BackFat High Max
     I                                    P  69  721P3K6NB
      * N :  BackFat Low Min
     I                                    P  73  761P3K7NB
      * N :  Backfat Low Max
     I                                    P  77  801P3K8NB
      * N :  LoinEye High Min
     I                                    P  81  841P3K9NB
      * N :  LoinEye High Max
     I                                    P  85  881P3LANB
      * N :  LoinEye Low Min
     I                                    P  89  921P3LBNB
      * N :  LoinEye Low Max
     I                                    P  93  961P3LCNB
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BNNB    PARM           WP0002  70       BOH Buy Order N
     C           P1BONB    PARM           WP0003  50       BOL Load Number
     C           P1CVNB    PARM           WP0004  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0005  70       TH Kill Date
     C           P1OQET    PARM           WP0006  1        TH PHA Add Type
     C           P1URST    PARM           WP0007  3        TH PHA Average
     C           P1USST    PARM           WP0008  1        TH PHA Add Reas
     C           P2G9PC    PARM           WP0009  52       PH GA Adjusted
     C           P2HBPC    PARM           WP0010  31       PH GA Avg Lean%
     C           P2UWOE    PARM           WP0011  31       PH GA Avg Backf
     C           P2HEPC    PARM           WP0012  31       PH GA Avg Loin
     C           P2HGPC    PARM           WP0013  31       PH GA Avg Light
     C           P2TIPR    PARM           WP0014  52       PH GA Lean Prm
     C           P2B8A1    PARM           WP0015  53       PH GA Avg Srt D
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prc Pay w/Hist Avgs   XF
      * MODIFICATIONS
      * 11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM
      * Rtv Validation Rules  RT - Evaluation Validation  * 
     C                     EXSR SARVGN
      * Rtv Val Kill Trans    RT - Tattoo Header  * 
     C                     EXSR SBRVGN
      * CASE: PAR.TH PHA Average Type is Available History
     C           P1URST    IFEQ 'HST'                      *IF
     C                     MOVEL'A'       YL0001           Bal w/History
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'P'       YL0001           Bal w/History
     C                     END                             *FI
      * Bal/Val Tattoo        XF - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADDP1HMNB    PAHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    PABONB           BOL Load Number
     C                     Z-ADDP1CVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    PAB0DT           TH Kill Date
     C                     Z-ADDP1AWDT    PAAWDT           TH Purchase Dat
     C                     MOVELP1BICD    PABICD    P      TH Group Refere
     C                     MOVELP1CPST    PACPST    P      TH Live Purchas
     C                     Z-ADDP1ACPR    PAACPR           TH Live Purchas
     C                     Z-ADDP1B9PR    PAB9PR           TH Live Gross A
     C                     Z-ADDP1CAPR    PACAPR           TH LIve Net Amt
     C                     MOVELP1C4ST    PAC4ST    P      TH Resale UOM
     C                     Z-ADDP1AIPR    PAAIPR           TH Recalc Live
     C                     Z-ADDP1A6DT    PAA6DT           TH Pricing Date
     C                     MOVELP1C2ST    PAC2ST    P      TH Resale Sprea
     C                     Z-ADDP1CXNB    PACXNB           TH Dead On Arri
     C                     Z-ADDP1CWNB    PACWNB           TH Head Receive
     C                     Z-ADDP1FCNB    PAFCNB           TH Yard Deads
     C                     Z-ADDP1H9NB    PAH9NB           TH Held Over
     C                     Z-ADDP1FDNB    PAFDNB           TH Head Condemn
     C                     Z-ADDP1FENB    PAFENB           TH Head Killed
     C                     Z-ADDP1HENB    PAHENB           TH Head Adds
     C                     Z-ADDP1HFNB    PAHFNB           TH Head Accepte
     C                     Z-ADDP1CYNB    PACYNB           TH Live Wgt
     C                     Z-ADDP1LRNB    PALRNB           TH Adj Live Wgt
     C                     Z-ADDP1E0NB    PAE0NB           TH Hot Wgt
     C                     Z-ADDP1A5PC    PAA5PC           TH Tot Loin Eye
     C                     Z-ADDP1FBNB    PAFBNB           TH Tot Backfat
     C                     Z-ADDP1A4PC    PAA4PC           TH Tot Light Re
     C                     Z-ADDP1F7NB    PAF7NB           TH Avg Live Wgt
     C                     Z-ADDP1HDNB    PAHDNB           TH Avg Hot Wgt
     C                     Z-ADDP1F5NB    PAF5NB           TH Avg Light Re
     C                     Z-ADDP1F4NB    PAF4NB           TH Avg Lean Per
     C                     Z-ADDP1F3NB    PAF3NB           TH Avg Loin Eye
     C                     Z-ADDP1F2NB    PAF2NB           TH Avg Backfat
     C                     Z-ADDP1AVPC    PAAVPC           TH Std Yield Pe
     C                     Z-ADDP1AWPC    PAAWPC           TH Actual Yield
     C                     Z-ADDP1CWPC    PACWPC           TH Adj Actual Y
     C                     Z-ADDP1A8PC    PAA8PC           TH Yield Differ
     C                     Z-ADDP1A7PC    PAA7PC           TH Recalc Live
     C                     Z-ADDP1B8PR    PAB8PR           TH CM Market Pr
     C                     Z-ADDP1AMPR    PAAMPR           TH CM Base Mkt
     C                     Z-ADDP1ANPR    PAANPR           TH CM Base Mkt
     C                     Z-ADDP1AYVA    PAAYVA           TH CM Sort Disc
     C                     Z-ADDP1AWVA    PAAWVA           TH CM Yield Gai
     C                     Z-ADDP1AOPR    PAAOPR           TH CM Base Carc
     C                     Z-ADDP1AXVA    PAAXVA           TH CM LN AddOn/
     C                     Z-ADDP1APPR    PAAPPR           TH CM Carcass G
     C                     Z-ADDP1ASPR    PAASPR           TH Deduction Am
     C                     Z-ADDP1A4VA    PAA4VA           TH Total Net WO
     C                     Z-ADDP1ATPR    PAATPR           TH Carcass Net
     C                     Z-ADDP1A5VA    PAA5VA           TH Additions Am
     C                     Z-ADDP1CBPR    PACBPR           TH Payment Gros
     C                     Z-ADDP1CCPR    PACCPR           Th Payment Net
     C                     Z-ADDP1LPNB    PALPNB           TH AP Voucher/D
     C                     Z-ADDP1CDPR    PACDPR           TH Freight Amou
     C                     Z-ADDP1A7VA    PAA7VA           TH Accrual Amou
     C                     Z-ADDP1A2PR    PAA2PR           TH Fixed Cost A
     C                     MOVELP1JWST    PAJWST    P      TH Calc Net Sts
     C                     MOVELP1CWST    PACWST    P      TH Payment Sts
     C                     MOVELP1D6ST    PAD6ST    P      TH Bal to Kill
     C                     Z-ADDP1GHNB    PAGHNB           TH Commission A
     C                     Z-ADDP1BYDT    PABYDT           TH Voucher Paym
     C                     MOVELP1E0ST    PAE0ST    P      TH User Error O
     C                     MOVELP1E1ST    PAE1ST    P      TH Held Over Re
     C                     MOVELP1E2ST    PAE2ST    P      TH Sex
     C                     Z-ADDP1BSDT    PABSDT           TH Held/Ovr Com
     C                     Z-ADDP1BTDT    PABTDT           TH Commission P
     C                     Z-ADDP1BUDT    PABUDT           TH Actual Check
     C                     Z-ADDP1HGNB    PAHGNB           TH Shipped Weig
     C                     Z-ADDP1HHNB    PAHHNB           TH Avg Hot Wgt
     C                     Z-ADDP1HINB    PAHINB           TH FFLI
     C                     Z-ADDP1A3PR    PAA3PR           TH Kill Product
     C                     Z-ADDP1A4PR    PAA4PR           TH Cut Product
     C                     Z-ADDP1A6PR    PAA6PR           TH Render Produ
     C                     Z-ADDP1J9NB    PAJ9NB           TH Head Exclude
     C                     Z-ADDP1D6PR    PAD6PR           TH CM Bse Mkt L
     C                     Z-ADDP1D7PR    PAD7PR           TH CM Bse Mkt C
     C                     Z-ADDP1D8PR    PAD8PR           TH CM Srt Dsc L
     C                     Z-ADDP1D9PR    PAD9PR           TH CM Srt Dsc C
     C                     Z-ADDP1EAPR    PAEAPR           TH CM Yld G/L L
     C                     Z-ADDP1EBPR    PAEBPR           TH CM Yld G/L C
     C                     Z-ADDP1ECPR    PAECPR           TH CM Crc Val L
     C                     Z-ADDP1EDPR    PAEDPR           TH CM Crc Val C
     C                     Z-ADDP1EEPR    PAEEPR           TH CM Lean Prem
     C                     Z-ADDP1EFPR    PAEFPR           TH CM Lean Prem
     C                     Z-ADDP1EGPR    PAEGPR           TH CM Gross Liv
     C                     Z-ADDP1EHPR    PAEHPR           TH CM Gross Car
     C                     MOVELP1KAST    PAKAST    P      TH Source Type
     C                     MOVELP1J7ST    PAJ7ST    P      TH Scale Ticket
     C                     MOVELP1J9ST    PAJ9ST    P      TH Payment Type
     C                     Z-ADDP1OXNB    PAOXNB           TH HPS Movement
     C                     MOVELP1LKST    PALKST    P      TH Source Code
     C                     MOVELP1LLST    PALLST    P      TH Hog Class Ty
     C                     MOVELP1J8ST    PAJ8ST    P      TH Posted to HP
     C                     MOVELP1LIST    PALIST    P      TH Schedule Kil
     C                     MOVELP1LJST    PALJST    P      TH Shift Held O
     C                     MOVELP1BDCD    PABDCD    P      DF Defect Code
     C                     MOVELP1CSCD    PACSCD    P      THP Process Cod
     C                     MOVELP1ABCD    PAABCD    P      PD Producer Cod
     C                     MOVELP1AECD    PAAECD    P      PL Location Cod
     C                     MOVELP1ACCD    PAACCD    P      HB Buyer Code
     C                     MOVELP1AGCD    PAAGCD    P      GN Genetic Code
     C                     MOVELP1BECD    PABECD    P      HC Class Code
     C                     MOVELP1AAVN    PAAAVN    P      RS User Changed
     C                     Z-ADDP1AADT    PAAADT           RS Date Changed
     C                     Z-ADDP1AMTM    PAAMTM           RS Time Changed
     C                     MOVELP1AJST    PAAJST    P      RS Record Statu
     C                     MOVELP1AHVN    PAAHVN    P      RS Job
     C                     MOVELP1AGVN    PAAGVN    P      RS Program
     C                     MOVELP1ABVN    PAABVN    P      RS User Added
     C                     Z-ADDP1ABDT    PAABDT           RS Date Added
     C                     Z-ADDP1ABTM    PAABTM           RS Time Added
      *
     C                     CALL 'PKAAXFR'              90  Bal/Val Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Tattoo Hea
     C                     PARM P3I7NB    WQ0001  71       Carcass Dbw Min
     C                     PARM P3I8NB    WQ0002  71       Carcass Dbw Max
     C                     PARM P3I9NB    WQ0003  71       Carcass Lgt Min
     C                     PARM P3JANB    WQ0004  71       Carcass Lgt Max
     C                     PARM P3JBNB    WQ0005  71       %Lean High Min
     C                     PARM P3JLNB    WQ0006  71       %Lean High Max
     C                     PARM P3JMNB    WQ0007  71       %Lean Low Min
     C                     PARM P3JCNB    WQ0008  71       %Lean Low Max
     C                     PARM P3JDNB    WQ0009  71       High Yield Min
     C                     PARM P3JENB    WQ0010  71       High Yield Max
     C                     PARM P3JFNB    WQ0011  71       Low Yield Min
     C                     PARM P3JGNB    WQ0012  71       Low Yield Max
     C                     PARM P3JHNB    WQ0013  71       Head < Percent
     C                     PARM P3JINB    WQ0014  71       Head < Percent
     C                     PARM P3JJNB    WQ0015  71       Head > Percent
     C                     PARM P3JKNB    WQ0016  71       Head > Percent
     C                     PARM P3K5NB    WQ0017  71       BackFat High Mi
     C                     PARM P3K6NB    WQ0018  71       BackFat High Ma
     C                     PARM P3K7NB    WQ0019  71       BackFat Low Min
     C                     PARM P3K8NB    WQ0020  71       Backfat Low Max
     C                     PARM P3K9NB    WQ0021  71       LoinEye High Mi
     C                     PARM P3LANB    WQ0022  71       LoinEye High Ma
     C                     PARM P3LBNB    WQ0023  71       LoinEye Low Min
     C                     PARM P3LCNB    WQ0024  71       LoinEye Low Max
     C                     PARM 'Y'       WQ0025  1        Requested by Us
     C                     PARM YL0001    WQ0026  1        Bal w/History
     C                     PARM P1OQET    WQ0027  1        TH PHA Add Type
     C                     PARM P1URST    WQ0028  3        TH PHA Average
     C                     PARM P1USST    WQ0029  1        TH PHA Add Reas
     C                     PARM *ZERO     WQ0030  51       PH GA Avg Live
     C                     PARM P2G9PC    WQ0031  52       PH GA Adjusted
     C                     PARM P2HBPC    WQ0032  31       PH GA Avg Lean%
     C                     PARM P2UWOE    WQ0033  31       PH GA Avg Backf
     C                     PARM P2HEPC    WQ0034  31       PH GA Avg Loin
     C                     PARM P2HGPC    WQ0035  31       PH GA Avg Light
     C                     PARM P2TIPR    WQ0036  52       PH GA Lean Prm
     C                     PARM P2B8A1    WQ0037  53       PH GA Avg Srt D
     C                     PARM 'N'       WQ0038  1        Undo MPR USR
     C           YL0002    PARM *BLANK    WQ0039  1        Balance First D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Validation Rules  RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     P3I7NB           Carcass Dbw Min
     C                     Z-ADD*ZERO     P3I8NB           Carcass Dbw Max
     C                     Z-ADD*ZERO     P3I9NB           Carcass Lgt Min
     C                     Z-ADD*ZERO     P3JANB           Carcass Lgt Max
     C                     Z-ADD*ZERO     P3JBNB           %Lean High Min
     C                     Z-ADD*ZERO     P3JLNB           %Lean High Max
     C                     Z-ADD*ZERO     P3JMNB           %Lean Low Min
     C                     Z-ADD*ZERO     P3JCNB           %Lean Low Max
     C                     Z-ADD*ZERO     P3JDNB           High Yield Min
     C                     Z-ADD*ZERO     P3JENB           High Yield Max
     C                     Z-ADD*ZERO     P3JFNB           Low Yield Min
     C                     Z-ADD*ZERO     P3JGNB           Low Yield Max
     C                     Z-ADD*ZERO     P3JHNB           Head < Percent
     C                     Z-ADD*ZERO     P3JINB           Head < Percent
     C                     Z-ADD*ZERO     P3JJNB           Head > Percent
     C                     Z-ADD*ZERO     P3JKNB           Head > Percent
     C                     Z-ADD*ZERO     P3K5NB           BackFat High Mi
     C                     Z-ADD*ZERO     P3K6NB           BackFat High Ma
     C                     Z-ADD*ZERO     P3K7NB           BackFat Low Min
     C                     Z-ADD*ZERO     P3K8NB           Backfat Low Max
     C                     Z-ADD*ZERO     P3K9NB           LoinEye High Mi
     C                     Z-ADD*ZERO     P3LANB           LoinEye High Ma
     C                     Z-ADD*ZERO     P3LBNB           LoinEye Low Min
     C                     Z-ADD*ZERO     P3LCNB           LoinEye Low Max
      * Establish starting position
     C           *LOVAL    SETLL@BOREFN                    *
     C                     READ @BOREFN                  90*
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EV Validation Code is Carcass has Double Weight
     C           WABVCD    IFEQ 'CDB'                      *IF
      * Carcass double weight
     C                     Z-ADDWAAFPC    P3I7NB           Carcass Dbw Min
     C                     Z-ADDWAAGPC    P3I8NB           Carcass Dbw Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Carcass is Light Weight
     C           WABVCD    IFEQ 'CLT'                      *IF
      * Carcass light weight
     C                     Z-ADDWAAFPC    P3I9NB           Carcass Lgt Min
     C                     Z-ADDWAAGPC    P3JANB           Carcass Lgt Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is high
     C           WABVCD    IFEQ 'BHI'                      *IF
      * backfat is high
     C                     Z-ADDWAAFPC    P3K5NB           BackFat High Mi
     C                     Z-ADDWAAGPC    P3K6NB           BackFat High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is Low
     C           WABVCD    IFEQ 'BLW'                      *IF
      * Backfat is low
     C                     Z-ADDWAAFPC    P3K7NB           BackFat Low Min
     C                     Z-ADDWAAGPC    P3K8NB           Backfat Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is High
     C           WABVCD    IFEQ 'LHI'                      *IF
      * loineye is high
     C                     Z-ADDWAAFPC    P3K9NB           LoinEye High Mi
     C                     Z-ADDWAAGPC    P3LANB           LoinEye High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is Low
     C           WABVCD    IFEQ 'LLW'                      *IF
      * loineye is low
     C                     Z-ADDWAAFPC    P3LBNB           LoinEye Low Min
     C                     Z-ADDWAAGPC    P3LCNB           LoinEye Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is high
     C           WABVCD    IFEQ 'PLH'                      *IF
      * % Lean High
     C                     Z-ADDWAAFPC    P3JBNB           %Lean High Min
     C                     Z-ADDWAAGPC    P3JLNB           %Lean High Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is Low
     C           WABVCD    IFEQ 'PLL'                      *IF
      * % Lean Low
     C                     Z-ADDWAAFPC    P3JMNB           %Lean Low Min
     C                     Z-ADDWAAGPC    P3JCNB           %Lean Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is < % Allowed
     C           WABVCD    IFEQ 'HLP'                      *IF
      * Head < Percent
     C                     Z-ADDWAAFPC    P3JHNB           Head < Percent
     C                     Z-ADDWAAGPC    P3JINB           Head < Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is > % Allowed
     C           WABVCD    IFEQ 'HHP'                      *IF
      * Head > Percent
     C                     Z-ADDWAAFPC    P3JJNB           Head > Percent
     C                     Z-ADDWAAGPC    P3JKNB           Head > Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is High
     C           WABVCD    IFEQ 'YHI'                      *IF
      * Yield High
     C                     Z-ADDWAAFPC    P3JDNB           High Yield Min
     C                     Z-ADDWAAGPC    P3JENB           High Yield Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is Low
     C           WABVCD    IFEQ 'YLW'                      *IF
      * Yield Low
     C                     Z-ADDWAAFPC    P3JFNB           Low Yield Min
     C                     Z-ADDWAAGPC    P3JGNB           Low Yield Max
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BOREFN                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Val Kill Trans    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WBHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WBBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WBB0DT           TH Kill Date
      * Establish starting position
     C           KRSSB     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P1AWDT           TH Purchase Dat
     C                     MOVEL*BLANK    P1BICD           TH Group Refere
     C                     MOVEL*BLANK    P1CPST           TH Live Purchas
     C                     Z-ADD*ZERO     P1ACPR           TH Live Purchas
     C                     Z-ADD*ZERO     P1B9PR           TH Live Gross A
     C                     Z-ADD*ZERO     P1CAPR           TH LIve Net Amt
     C                     MOVEL*BLANK    P1C4ST           TH Resale UOM
     C                     Z-ADD*ZERO     P1AIPR           TH Recalc Live
     C                     Z-ADD*ZERO     P1A6DT           TH Pricing Date
     C                     MOVEL*BLANK    P1C2ST           TH Resale Sprea
     C                     Z-ADD*ZERO     P1CXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     P1CWNB           TH Head Receive
     C                     Z-ADD*ZERO     P1FCNB           TH Yard Deads
     C                     Z-ADD*ZERO     P1H9NB           TH Held Over
     C                     Z-ADD*ZERO     P1FDNB           TH Head Condemn
     C                     Z-ADD*ZERO     P1FENB           TH Head Killed
     C                     Z-ADD*ZERO     P1HENB           TH Head Adds
     C                     Z-ADD*ZERO     P1HFNB           TH Head Accepte
     C                     Z-ADD*ZERO     P1CYNB           TH Live Wgt
     C                     Z-ADD*ZERO     P1LRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     P1E0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     P1A5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     P1FBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     P1A4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     P1F7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     P1HDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     P1F5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     P1F4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     P1F3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     P1F2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     P1AVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     P1AWPC           TH Actual Yield
     C                     Z-ADD*ZERO     P1CWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     P1A8PC           TH Yield Differ
     C                     Z-ADD*ZERO     P1A7PC           TH Recalc Live
     C                     Z-ADD*ZERO     P1B8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     P1AMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     P1ANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     P1AYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     P1AWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     P1AOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     P1AXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     P1APPR           TH CM Carcass G
     C                     Z-ADD*ZERO     P1ASPR           TH Deduction Am
     C                     Z-ADD*ZERO     P1A4VA           TH Total Net WO
     C                     Z-ADD*ZERO     P1ATPR           TH Carcass Net
     C                     Z-ADD*ZERO     P1A5VA           TH Additions Am
     C                     Z-ADD*ZERO     P1CBPR           TH Payment Gros
     C                     Z-ADD*ZERO     P1CCPR           Th Payment Net
     C                     Z-ADD*ZERO     P1LPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     P1CDPR           TH Freight Amou
     C                     Z-ADD*ZERO     P1A7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     P1A2PR           TH Fixed Cost A
     C                     MOVEL*BLANK    P1JWST           TH Calc Net Sts
     C                     MOVEL*BLANK    P1CWST           TH Payment Sts
     C                     MOVEL*BLANK    P1D6ST           TH Bal to Kill
     C                     Z-ADD*ZERO     P1GHNB           TH Commission A
     C                     Z-ADD*ZERO     P1BYDT           TH Voucher Paym
     C                     MOVEL*BLANK    P1E0ST           TH User Error O
     C                     MOVEL*BLANK    P1E1ST           TH Held Over Re
     C                     MOVEL*BLANK    P1E2ST           TH Sex
     C                     Z-ADD*ZERO     P1BSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     P1BTDT           TH Commission P
     C                     Z-ADD*ZERO     P1BUDT           TH Actual Check
     C                     Z-ADD*ZERO     P1HGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     P1HHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     P1HINB           TH FFLI
     C                     Z-ADD*ZERO     P1A3PR           TH Kill Product
     C                     Z-ADD*ZERO     P1A4PR           TH Cut Product
     C                     Z-ADD*ZERO     P1A6PR           TH Render Produ
     C                     Z-ADD*ZERO     P1J9NB           TH Head Exclude
     C                     Z-ADD*ZERO     P1D6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     P1D7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     P1D8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     P1D9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     P1EAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     P1EBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     P1ECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     P1EDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     P1EEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     P1EFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     P1EGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     P1EHPR           TH CM Gross Car
     C                     MOVEL*BLANK    P1KAST           TH Source Type
     C                     MOVEL*BLANK    P1J7ST           TH Scale Ticket
     C                     MOVEL*BLANK    P1J9ST           TH Payment Type
     C                     Z-ADD*ZERO     P1OXNB           TH HPS Movement
     C                     MOVEL*BLANK    P1LKST           TH Source Code
     C                     MOVEL*BLANK    P1LLST           TH Hog Class Ty
     C                     MOVEL*BLANK    P1J8ST           TH Posted to HP
     C                     MOVEL*BLANK    P1LIST           TH Schedule Kil
     C                     MOVEL*BLANK    P1LJST           TH Shift Held O
     C                     MOVEL*BLANK    P1BDCD           DF Defect Code
     C                     MOVEL*BLANK    P1CSCD           THP Process Cod
     C                     MOVEL*BLANK    P1ABCD           PD Producer Cod
     C                     MOVEL*BLANK    P1AECD           PL Location Cod
     C                     MOVEL*BLANK    P1ACCD           HB Buyer Code
     C                     MOVEL*BLANK    P1AGCD           GN Genetic Code
     C                     MOVEL*BLANK    P1BECD           HC Class Code
     C                     MOVEL*BLANK    P1AAVN           RS User Changed
     C                     Z-ADD*ZERO     P1AADT           RS Date Changed
     C                     Z-ADD*ZERO     P1AMTM           RS Time Changed
     C                     MOVEL*BLANK    P1AJST           RS Record Statu
     C                     MOVEL*BLANK    P1AHVN           RS Job
     C                     MOVEL*BLANK    P1AGVN           RS Program
     C                     MOVEL*BLANK    P1ABVN           RS User Added
     C                     Z-ADD*ZERO     P1ABDT           RS Date Added
     C                     Z-ADD*ZERO     P1ABTM           RS Time Added
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAWDT    P1AWDT           TH Purchase Dat
     C                     MOVELWBBICD    P1BICD           TH Group Refere
     C                     MOVELWBCPST    P1CPST           TH Live Purchas
     C                     Z-ADDWBACPR    P1ACPR           TH Live Purchas
     C                     Z-ADDWBB9PR    P1B9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    P1CAPR           TH LIve Net Amt
     C                     MOVELWBC4ST    P1C4ST           TH Resale UOM
     C                     Z-ADDWBAIPR    P1AIPR           TH Recalc Live
     C                     Z-ADDWBA6DT    P1A6DT           TH Pricing Date
     C                     MOVELWBC2ST    P1C2ST           TH Resale Sprea
     C                     Z-ADDWBCXNB    P1CXNB           TH Dead On Arri
     C                     Z-ADDWBCWNB    P1CWNB           TH Head Receive
     C                     Z-ADDWBFCNB    P1FCNB           TH Yard Deads
     C                     Z-ADDWBH9NB    P1H9NB           TH Held Over
     C                     Z-ADDWBFDNB    P1FDNB           TH Head Condemn
     C                     Z-ADDWBFENB    P1FENB           TH Head Killed
     C                     Z-ADDWBHENB    P1HENB           TH Head Adds
     C                     Z-ADDWBHFNB    P1HFNB           TH Head Accepte
     C                     Z-ADDWBCYNB    P1CYNB           TH Live Wgt
     C                     Z-ADDWBLRNB    P1LRNB           TH Adj Live Wgt
     C                     Z-ADDWBE0NB    P1E0NB           TH Hot Wgt
     C                     Z-ADDWBA5PC    P1A5PC           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    P1FBNB           TH Tot Backfat
     C                     Z-ADDWBA4PC    P1A4PC           TH Tot Light Re
     C                     Z-ADDWBF7NB    P1F7NB           TH Avg Live Wgt
     C                     Z-ADDWBHDNB    P1HDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    P1F5NB           TH Avg Light Re
     C                     Z-ADDWBF4NB    P1F4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    P1F3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    P1F2NB           TH Avg Backfat
     C                     Z-ADDWBAVPC    P1AVPC           TH Std Yield Pe
     C                     Z-ADDWBAWPC    P1AWPC           TH Actual Yield
     C                     Z-ADDWBCWPC    P1CWPC           TH Adj Actual Y
     C                     Z-ADDWBA8PC    P1A8PC           TH Yield Differ
     C                     Z-ADDWBA7PC    P1A7PC           TH Recalc Live
     C                     Z-ADDWBB8PR    P1B8PR           TH CM Market Pr
     C                     Z-ADDWBAMPR    P1AMPR           TH CM Base Mkt
     C                     Z-ADDWBANPR    P1ANPR           TH CM Base Mkt
     C                     Z-ADDWBAYVA    P1AYVA           TH CM Sort Disc
     C                     Z-ADDWBAWVA    P1AWVA           TH CM Yield Gai
     C                     Z-ADDWBAOPR    P1AOPR           TH CM Base Carc
     C                     Z-ADDWBAXVA    P1AXVA           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    P1APPR           TH CM Carcass G
     C                     Z-ADDWBASPR    P1ASPR           TH Deduction Am
     C                     Z-ADDWBA4VA    P1A4VA           TH Total Net WO
     C                     Z-ADDWBATPR    P1ATPR           TH Carcass Net
     C                     Z-ADDWBA5VA    P1A5VA           TH Additions Am
     C                     Z-ADDWBCBPR    P1CBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    P1CCPR           Th Payment Net
     C                     Z-ADDWBLPNB    P1LPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    P1CDPR           TH Freight Amou
     C                     Z-ADDWBA7VA    P1A7VA           TH Accrual Amou
     C                     Z-ADDWBA2PR    P1A2PR           TH Fixed Cost A
     C                     MOVELWBJWST    P1JWST           TH Calc Net Sts
     C                     MOVELWBCWST    P1CWST           TH Payment Sts
     C                     MOVELWBD6ST    P1D6ST           TH Bal to Kill
     C                     Z-ADDWBGHNB    P1GHNB           TH Commission A
     C                     Z-ADDWBBYDT    P1BYDT           TH Voucher Paym
     C                     MOVELWBE0ST    P1E0ST           TH User Error O
     C                     MOVELWBE1ST    P1E1ST           TH Held Over Re
     C                     MOVELWBE2ST    P1E2ST           TH Sex
     C                     Z-ADDWBBSDT    P1BSDT           TH Held/Ovr Com
     C                     Z-ADDWBBTDT    P1BTDT           TH Commission P
     C                     Z-ADDWBBUDT    P1BUDT           TH Actual Check
     C                     Z-ADDWBHGNB    P1HGNB           TH Shipped Weig
     C                     Z-ADDWBHHNB    P1HHNB           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    P1HINB           TH FFLI
     C                     Z-ADDWBA3PR    P1A3PR           TH Kill Product
     C                     Z-ADDWBA4PR    P1A4PR           TH Cut Product
     C                     Z-ADDWBA6PR    P1A6PR           TH Render Produ
     C                     Z-ADDWBJ9NB    P1J9NB           TH Head Exclude
     C                     Z-ADDWBD6PR    P1D6PR           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    P1D7PR           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    P1D8PR           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    P1D9PR           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    P1EAPR           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    P1EBPR           TH CM Yld G/L C
     C                     Z-ADDWBECPR    P1ECPR           TH CM Crc Val L
     C                     Z-ADDWBEDPR    P1EDPR           TH CM Crc Val C
     C                     Z-ADDWBEEPR    P1EEPR           TH CM Lean Prem
     C                     Z-ADDWBEFPR    P1EFPR           TH CM Lean Prem
     C                     Z-ADDWBEGPR    P1EGPR           TH CM Gross Liv
     C                     Z-ADDWBEHPR    P1EHPR           TH CM Gross Car
     C                     MOVELWBKAST    P1KAST           TH Source Type
     C                     MOVELWBJ7ST    P1J7ST           TH Scale Ticket
     C                     MOVELWBJ9ST    P1J9ST           TH Payment Type
     C                     Z-ADDWBOXNB    P1OXNB           TH HPS Movement
     C                     MOVELWBLKST    P1LKST           TH Source Code
     C                     MOVELWBLLST    P1LLST           TH Hog Class Ty
     C                     MOVELWBJ8ST    P1J8ST           TH Posted to HP
     C                     MOVELWBLIST    P1LIST           TH Schedule Kil
     C                     MOVELWBLJST    P1LJST           TH Shift Held O
     C                     MOVELWBBDCD    P1BDCD           DF Defect Code
     C                     MOVELWBCSCD    P1CSCD           THP Process Cod
     C                     MOVELWBABCD    P1ABCD           PD Producer Cod
     C                     MOVELWBAECD    P1AECD           PL Location Cod
     C                     MOVELWBACCD    P1ACCD           HB Buyer Code
     C                     MOVELWBAGCD    P1AGCD           GN Genetic Code
     C                     MOVELWBBECD    P1BECD           HC Class Code
     C                     MOVELWBAAVN    P1AAVN           RS User Changed
     C                     Z-ADDWBAADT    P1AADT           RS Date Changed
     C                     Z-ADDWBAMTM    P1AMTM           RS Time Changed
     C                     MOVELWBAJST    P1AJST           RS Record Statu
     C                     MOVELWBAHVN    P1AHVN           RS Job
     C                     MOVELWBAGVN    P1AGVN           RS Program
     C                     MOVELWBABVN    P1ABVN           RS User Added
     C                     Z-ADDWBABDT    P1ABDT           RS Date Added
     C                     Z-ADDWBABTM    P1ABTM           RS Time Added
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1AWDT           TH Purchase Dat
     C                     MOVEL*BLANK    P1BICD           TH Group Refere
     C                     MOVEL*BLANK    P1CPST           TH Live Purchas
     C                     Z-ADD*ZERO     P1ACPR           TH Live Purchas
     C                     Z-ADD*ZERO     P1B9PR           TH Live Gross A
     C                     Z-ADD*ZERO     P1CAPR           TH LIve Net Amt
     C                     MOVEL*BLANK    P1C4ST           TH Resale UOM
     C                     Z-ADD*ZERO     P1AIPR           TH Recalc Live
     C                     Z-ADD*ZERO     P1A6DT           TH Pricing Date
     C                     MOVEL*BLANK    P1C2ST           TH Resale Sprea
     C                     Z-ADD*ZERO     P1CXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     P1CWNB           TH Head Receive
     C                     Z-ADD*ZERO     P1FCNB           TH Yard Deads
     C                     Z-ADD*ZERO     P1H9NB           TH Held Over
     C                     Z-ADD*ZERO     P1FDNB           TH Head Condemn
     C                     Z-ADD*ZERO     P1FENB           TH Head Killed
     C                     Z-ADD*ZERO     P1HENB           TH Head Adds
     C                     Z-ADD*ZERO     P1HFNB           TH Head Accepte
     C                     Z-ADD*ZERO     P1CYNB           TH Live Wgt
     C                     Z-ADD*ZERO     P1LRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     P1E0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     P1A5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     P1FBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     P1A4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     P1F7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     P1HDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     P1F5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     P1F4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     P1F3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     P1F2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     P1AVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     P1AWPC           TH Actual Yield
     C                     Z-ADD*ZERO     P1CWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     P1A8PC           TH Yield Differ
     C                     Z-ADD*ZERO     P1A7PC           TH Recalc Live
     C                     Z-ADD*ZERO     P1B8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     P1AMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     P1ANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     P1AYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     P1AWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     P1AOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     P1AXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     P1APPR           TH CM Carcass G
     C                     Z-ADD*ZERO     P1ASPR           TH Deduction Am
     C                     Z-ADD*ZERO     P1A4VA           TH Total Net WO
     C                     Z-ADD*ZERO     P1ATPR           TH Carcass Net
     C                     Z-ADD*ZERO     P1A5VA           TH Additions Am
     C                     Z-ADD*ZERO     P1CBPR           TH Payment Gros
     C                     Z-ADD*ZERO     P1CCPR           Th Payment Net
     C                     Z-ADD*ZERO     P1LPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     P1CDPR           TH Freight Amou
     C                     Z-ADD*ZERO     P1A7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     P1A2PR           TH Fixed Cost A
     C                     MOVEL*BLANK    P1JWST           TH Calc Net Sts
     C                     MOVEL*BLANK    P1CWST           TH Payment Sts
     C                     MOVEL*BLANK    P1D7ST           TH Header Error
     C                     MOVEL*BLANK    P1D8ST           TH Detail Error
     C                     MOVEL*BLANK    P1DWST           TH Kill Balanci
     C                     MOVEL*BLANK    P1D6ST           TH Bal to Kill
     C                     Z-ADD*ZERO     P1GHNB           TH Commission A
     C                     Z-ADD*ZERO     P1BYDT           TH Voucher Paym
     C                     MOVEL*BLANK    P1E0ST           TH User Error O
     C                     MOVEL*BLANK    P1E1ST           TH Held Over Re
     C                     MOVEL*BLANK    P1E2ST           TH Sex
     C                     Z-ADD*ZERO     P1BSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     P1BTDT           TH Commission P
     C                     Z-ADD*ZERO     P1BUDT           TH Actual Check
     C                     Z-ADD*ZERO     P1HGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     P1HHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     P1HINB           TH FFLI
     C                     Z-ADD*ZERO     P1A3PR           TH Kill Product
     C                     Z-ADD*ZERO     P1A4PR           TH Cut Product
     C                     Z-ADD*ZERO     P1A6PR           TH Render Produ
     C                     Z-ADD*ZERO     P1J9NB           TH Head Exclude
     C                     Z-ADD*ZERO     P1D6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     P1D7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     P1D8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     P1D9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     P1EAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     P1EBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     P1ECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     P1EDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     P1EEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     P1EFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     P1EGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     P1EHPR           TH CM Gross Car
     C                     MOVEL*BLANK    P1KAST           TH Source Type
     C                     MOVEL*BLANK    P1J7ST           TH Scale Ticket
     C                     MOVEL*BLANK    P1J9ST           TH Payment Type
     C                     Z-ADD*ZERO     P1OXNB           TH HPS Movement
     C                     MOVEL*BLANK    P1LKST           TH Source Code
     C                     MOVEL*BLANK    P1LLST           TH Hog Class Ty
     C                     MOVEL*BLANK    P1J8ST           TH Posted to HP
     C                     MOVEL*BLANK    P1LIST           TH Schedule Kil
     C                     MOVEL*BLANK    P1LJST           TH Shift Held O
     C                     MOVEL*BLANK    P1BDCD           DF Defect Code
     C                     MOVEL*BLANK    P1CSCD           THP Process Cod
     C                     MOVEL*BLANK    P1ABCD           PD Producer Cod
     C                     MOVEL*BLANK    P1AECD           PL Location Cod
     C                     MOVEL*BLANK    P1ACCD           HB Buyer Code
     C                     MOVEL*BLANK    P1AGCD           GN Genetic Code
     C                     MOVEL*BLANK    P1BECD           HC Class Code
     C                     MOVEL*BLANK    P1AAVN           RS User Changed
     C                     Z-ADD*ZERO     P1AADT           RS Date Changed
     C                     Z-ADD*ZERO     P1AMTM           RS Time Changed
     C                     MOVEL*BLANK    P1AJST           RS Record Statu
     C                     MOVEL*BLANK    P1AHVN           RS Job
     C                     MOVEL*BLANK    P1AGVN           RS Program
     C                     MOVEL*BLANK    P1ABVN           RS User Added
     C                     Z-ADD*ZERO     P1ABDT           RS Date Added
     C                     Z-ADD*ZERO     P1ABTM           RS Time Added
     C                     Z-ADD*ZERO     P3I7NB           Carcass Dbw Min
     C                     Z-ADD*ZERO     P3I8NB           Carcass Dbw Max
     C                     Z-ADD*ZERO     P3I9NB           Carcass Lgt Min
     C                     Z-ADD*ZERO     P3JANB           Carcass Lgt Max
     C                     Z-ADD*ZERO     P3JBNB           %Lean High Min
     C                     Z-ADD*ZERO     P3JLNB           %Lean High Max
     C                     Z-ADD*ZERO     P3JMNB           %Lean Low Min
     C                     Z-ADD*ZERO     P3JCNB           %Lean Low Max
     C                     Z-ADD*ZERO     P3JDNB           High Yield Min
     C                     Z-ADD*ZERO     P3JENB           High Yield Max
     C                     Z-ADD*ZERO     P3JFNB           Low Yield Min
     C                     Z-ADD*ZERO     P3JGNB           Low Yield Max
     C                     Z-ADD*ZERO     P3JHNB           Head < Percent
     C                     Z-ADD*ZERO     P3JINB           Head < Percent
     C                     Z-ADD*ZERO     P3JJNB           Head > Percent
     C                     Z-ADD*ZERO     P3JKNB           Head > Percent
     C                     Z-ADD*ZERO     P3K5NB           BackFat High Mi
     C                     Z-ADD*ZERO     P3K6NB           BackFat High Ma
     C                     Z-ADD*ZERO     P3K7NB           BackFat Low Min
     C                     Z-ADD*ZERO     P3K8NB           Backfat Low Max
     C                     Z-ADD*ZERO     P3K9NB           LoinEye High Mi
     C                     Z-ADD*ZERO     P3LANB           LoinEye High Ma
     C                     Z-ADD*ZERO     P3LBNB           LoinEye Low Min
     C                     Z-ADD*ZERO     P3LCNB           LoinEye Low Max
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAFPC           EV Minimum
     C                     Z-ADD*ZERO     WAAGPC           EV Maximum
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WBACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WBB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WBCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WBAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WBA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WBCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WBCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WBFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WBH9NB           TH Held Over
     C                     Z-ADD*ZERO     WBFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WBFENB           TH Head Killed
     C                     Z-ADD*ZERO     WBHENB           TH Head Adds
     C                     Z-ADD*ZERO     WBHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WBCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WBLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WBE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WBA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WBFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WBA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WBF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WBHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WBF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WBF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WBAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WBAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WBCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WBA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WBA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WBB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WBAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WBAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WBAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WBAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WBAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WBASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WBA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WBATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WBA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WBCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WBCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WBLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WBCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WBA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WBA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WBGHNB           TH Commission A
     C                     Z-ADD*ZERO     WBBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WBBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WBBTDT           TH Commission P
     C                     Z-ADD*ZERO     WBBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WBHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WBHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBHINB           TH FFLI
     C                     Z-ADD*ZERO     WBA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WBA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WBA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WBJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WBD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WBD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WBD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WBD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WBEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WBEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WBECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WBEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WBEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WBEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WBOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WBTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WBT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WBTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WBT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WBOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WBKOER           TH Head Identif
     C                     Z-ADD*ZERO     WBOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WBOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WBIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WBOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WBHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WBS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WBTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WBTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WBJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WBKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WBKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WBKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WBKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WBOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WBIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WBIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WBIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WBKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WBKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WBORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WBOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WBMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WBNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WBNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WBIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WBEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBECDT           TH Head LFT
     C                     Z-ADD*ZERO     WBEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WBEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Bal w/History
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Balance First Day USR
     C                     MOVEL*BLANK    YL0002  1
      *================================================================
     CSR         ZZEXIT    ENDSR
