// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKDGPVR
// ?Date: 14.08.2025 Time: 02:49:01
// ?------------------------------------------------------------------------------------------------

//?USER: Validate fields

EXECUTE FUNCTION(Chk Row Existance     RT) TYPE(RTVOBJ) FILE(PKBYREP)           AB1104067;
PARAMETER(DTL.CMP_Program_Code);
PARAMETER(DTL.Row_Number_USR);
PARAMETER(WRK.Record_Found_CMM_USR);
{
 //?USER: Initialize routine

 // *MO.VE             1183529*Bu = ilt. in functions
 PAR.Record_Found_CMM_USR = 'N';

 //?USER: Process Data record

 // *MO.VE             1183529*Bu = ilt. in functions
 PAR.Record_Found_CMM_USR = 'Y';

}


CASE;

// IF WRK.Record Found CMM USR is Record Not Found
IF WRK.Record_Found_CMM_USR = 'N';

// Send error message - 'Carcass Merit Matrix Row not found.'
ERROR(PRK0132);

ENDIF;

//?USER: User defined action

EXECUTE FUNCTION(Cpy Premium           RT) TYPE(RTVOBJ) FILE(PKBZREP)           AB1104068;
PARAMETER(DTL.CMP_Program_Code);
PARAMETER(DTL.CMMR_Row_Number);
PARAMETER(DTL.Row_Number_USR);
{
 //?USER: Process Data record

 EXECUTE FUNCTION(Crt CMM Col           CR) TYPE(CRTOBJ) FILE(PKBZREP)           AB1103404;
 PARAMETER(DB1.CMP_Program_Code);
 PARAMETER(PAR.Row_Number_USR);
 PARAMETER(DB1.CMMC_Column_Number);
 PARAMETER(DB1.CMMC_Lean_Percent);
 PARAMETER(DB1.CMMC_Backfat_Inches);
 PARAMETER(DB1.CMMC_Grade);
 PARAMETER(DB1.CMMC_Premium_Value);
 PARAMETER(DB1.RS_User_Changed);
 PARAMETER(DB1.RS_Date_Changed);
 PARAMETER(DB1.RS_Time_Changed);
 PARAMETER(DB1.RS_Record_Status);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 PARAMETER(DB1.RS_User_Added);
 PARAMETER(DB1.RS_Date_Added);
 PARAMETER(DB1.RS_Time_Added);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
  PARAMETER(DB1.RS_Record_Status);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  PARAMETER(DB1.RS_User_Added);
  PARAMETER(DB1.RS_Date_Added);
  PARAMETER(DB1.RS_Time_Added);
  {
   //?Execute internal function

   // PAR.RS Record Status = CND.Active
   PAR.RS_Record_Status = 'A';

   // PAR.RS User Added = JOB.*USER
   PAR.RS_User_Added = JOB.*USER;

   // PAR.RS Date Added = JOB.*Job date
   PAR.RS_Date_Added = JOB.*Job_date;

   // PAR.RS Time Added = JOB.*Job time
   PAR.RS_Time_Added = JOB.*Job_time;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

  }

 }

}


