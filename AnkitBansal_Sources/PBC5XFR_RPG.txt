     H/TITLE RTV/Cnv Assoc File Sts XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISLBUSE
     H* Date          : 04/26/12  Time  : 14:37:40
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FCAEOREL3IF  E           K        DISK
      * RSQ : Company Customer          Customer/Company
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FPDISREL3IF  E           K        DISK
      * RSQ : Company Customer Item     Customer/Company/Item
      *
     FPNGKREL2IF  E           K        DISK
      * RSQ : Customer Freight Rate     Customer/Company/Chg Dat
      *
     FPOBIREL1IF  E           K        DISK
      * RTV : Customer Item Reference   Retrieval index
      *
     FCAEOREL0UF  E           K        DISK
      * UPD : Company Customer          Update index
      *
     FPDNEREL0UF  E           K        DISK
      * UPD : Customer EXT              Update index
      *
     FPDISREL0UF  E           K        DISK
      * UPD : Company Customer Item     Update index
      *
     FPNGKREL0UF  E           K        DISK
      * UPD : Customer Freight Rate     Update index
      *
     FPOBIREL0UF  E           K        DISK
      * UPD : Customer Item Reference   Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WABKC7
     I              BBAYTX                          WAAYTX
     I              BBACNA                          WAACNA
     I              BBADNA                          WAADNA
     I              BBAENA                          WAAENA
     I              BBAJNA                          WAAJNA
     I              BBBGCD                          WABGCD
     I              BBG5CD                          WAG5CD
     I              BBBTTX                          WABTTX
     I              BBBVTX                          WABVTX
     I              BBBWTX                          WABWTX
     I              BBABTX                          WAABTX
     I              BBA2NA                          WAA2NA
     I              BBCBST                          WACBST
     I              BBB0NA                          WAB0NA
     I              BBP3NB                          WAP3NB
     I              BBAXNA                          WAAXNA
     I              BBI6DT                          WAI6DT
     I              BBAYDT                          WAAYDT
     I              BBANC7                          WAANC7
     I              BBBTC7                          WABTC7
     I              BBK6ST                          WAK6ST
     I              BBUZST                          WAUZST
     I              BBKXCD                          WAKXCD
     I              BBLTCD                          WALTCD
     I              BBQNST                          WAQNST
     I              BBS2NB                          WAS2NB
     I              BBVHVA                          WAVHVA
     I              BBI7DT                          WAI7DT
     I              BBRJST                          WARJST
     I              BBRKST                          WARKST
     I              BBQWST                          WAQWST
     I              BBQXST                          WAQXST
     I              BBQYST                          WAQYST
     I              BBUNCS                          WAUNCS
     I              BBUVST                          WAUVST
     I              BBUWST                          WAUWST
     I              BBUXST                          WAUXST
     I              BBVSST                          WAVSST
     I              BBAATM                          WAAATM
     I              BBAYNA                          WAAYNA
     I              BBA0NA                          WAA0NA
     I              BBAXDT                          WAAXDT
      *
     I@EOREU0
      * Company Customer          Customer/Company
      * Renamed input format fields
     I              EOAIC3                          WBAIC3
     I              EOBKC7                          WBBKC7
     I              EOAQCD                          WBAQCD
     I              EOR4CD                          WBR4CD
     I              EOBYNA                          WBBYNA
     I              EOB6NA                          WBB6NA
     I              EOBZNA                          WBBZNA
     I              EOLLST                          WBLLST
     I              EOPPST                          WBPPST
     I              EOR5NB                          WBR5NB
     I              EOR6NB                          WBR6NB
     I              EOQGST                          WBQGST
     I              EOBOCD                          WBBOCD
     I              EOTBNB                          WBTBNB
     I              EOMTCU                          WBMTCU
     I              EOW2NB                          WBW2NB
     I              EORPCD                          WBRPCD
     I              EOAJCD                          WBAJCD
     I              EOX9ST                          WBX9ST
     I              EOT9CD                          WBT9CD
     I              EOUBCD                          WBUBCD
     I              EOISTX                          WBISTX
     I              EOLQCD                          WBLQCD
     I              EONJNA                          WBNJNA
     I              EOI0TX                          WBI0TX
     I              EONKNA                          WBNKNA
     I              EOI1TX                          WBI1TX
     I              EOVLST                          WBVLST
     I              EORLST                          WBRLST
     I              EOMMTX                          WBMMTX
     I              EOOHNA                          WBOHNA
     I              EOQ6ST                          WBQ6ST
     I              EOQ8ST                          WBQ8ST
     I              EORBST                          WBRBST
     I              EOREST                          WBREST
     I              EOUVST                          WBUVST
     I              EOUWST                          WBUWST
     I              EOUXST                          WBUXST
     I              EOVSST                          WBVSST
     I              EOAATM                          WBAATM
     I              EOAYNA                          WBAYNA
     I              EOA0NA                          WBA0NA
     I              EOAXDT                          WBAXDT
      *
     I@EOREXL
      * Company Customer          Update index
      * Renamed input format fields
     I              EOAIC3                          WCAIC3
     I              EOBKC7                          WCBKC7
     I              EOAQCD                          WCAQCD
     I              EOR4CD                          WCR4CD
     I              EOBYNA                          WCBYNA
     I              EOB6NA                          WCB6NA
     I              EOBZNA                          WCBZNA
     I              EOLLST                          WCLLST
     I              EOPPST                          WCPPST
     I              EOR5NB                          WCR5NB
     I              EOR6NB                          WCR6NB
     I              EOQGST                          WCQGST
     I              EOBOCD                          WCBOCD
     I              EOTBNB                          WCTBNB
     I              EOMTCU                          WCMTCU
     I              EOW2NB                          WCW2NB
     I              EORPCD                          WCRPCD
     I              EOAJCD                          WCAJCD
     I              EOX9ST                          WCX9ST
     I              EOT9CD                          WCT9CD
     I              EOUBCD                          WCUBCD
     I              EOISTX                          WCISTX
     I              EOLQCD                          WCLQCD
     I              EONJNA                          WCNJNA
     I              EOI0TX                          WCI0TX
     I              EONKNA                          WCNKNA
     I              EOI1TX                          WCI1TX
     I              EOVLST                          WCVLST
     I              EORLST                          WCRLST
     I              EOMMTX                          WCMMTX
     I              EOOHNA                          WCOHNA
     I              EOQ6ST                          WCQ6ST
     I              EOQ8ST                          WCQ8ST
     I              EORBST                          WCRBST
     I              EOREST                          WCREST
     I              EOUVST                          WCUVST
     I              EOUWST                          WCUWST
     I              EOUXST                          WCUXST
     I              EOVSST                          WCVSST
     I              EOAATM                          WCAATM
     I              EOAYNA                          WCAYNA
     I              EOA0NA                          WCA0NA
     I              EOAXDT                          WCAXDT
      *
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                          WDBKC7
     I              NEUFTX                          WDUFTX
     I              NEUGTX                          WDUGTX
     I              NEPFNA                          WDPFNA
     I              NEJ5NX                          WDJ5NX
     I              NEU5TX                          WDU5TX
     I              NEU6TX                          WDU6TX
     I              NEW0TX                          WDW0TX
     I              NEHSSX                          WDHSSX
     I              NEHUSX                          WDHUSX
     I              NEHVSX                          WDHVSX
     I              NEAAC8                          WDAAC8
     I              NEP0SX                          WDP0SX
     I              NEP1SX                          WDP1SX
     I              NEP2SX                          WDP2SX
     I              NEP3SX                          WDP3SX
     I              NEP4SX                          WDP4SX
     I              NEP5SX                          WDP5SX
     I              NEP6SX                          WDP6SX
     I              NEUVST                          WDUVST
     I              NEUWST                          WDUWST
     I              NEUXST                          WDUXST
     I              NEVSST                          WDVSST
     I              NEAATM                          WDAATM
     I              NEAYNA                          WDAYNA
     I              NEA0NA                          WDA0NA
     I              NEAXDT                          WDAXDT
      *
     I@NEREAS
      * Customer EXT              Update index
      * Renamed input format fields
     I              NEBKC7                          WEBKC7
     I              NEUFTX                          WEUFTX
     I              NEUGTX                          WEUGTX
     I              NEPFNA                          WEPFNA
     I              NEJ5NX                          WEJ5NX
     I              NEU5TX                          WEU5TX
     I              NEU6TX                          WEU6TX
     I              NEW0TX                          WEW0TX
     I              NEHSSX                          WEHSSX
     I              NEHUSX                          WEHUSX
     I              NEHVSX                          WEHVSX
     I              NEAAC8                          WEAAC8
     I              NEP0SX                          WEP0SX
     I              NEP1SX                          WEP1SX
     I              NEP2SX                          WEP2SX
     I              NEP3SX                          WEP3SX
     I              NEP4SX                          WEP4SX
     I              NEP5SX                          WEP5SX
     I              NEP6SX                          WEP6SX
     I              NEUVST                          WEUVST
     I              NEUWST                          WEUWST
     I              NEUXST                          WEUXST
     I              NEVSST                          WEVSST
     I              NEAATM                          WEAATM
     I              NEAYNA                          WEAYNA
     I              NEA0NA                          WEA0NA
     I              NEAXDT                          WEAXDT
      *
     I@ISRENM
      * Company Customer Item     Customer/Company/Item
      * Renamed input format fields
     I              ISAIC3                          WFAIC3
     I              ISBKC7                          WFBKC7
     I              ISHGCD                          WFHGCD
     I              ISERDT                          WFERDT
     I              ISESDT                          WFESDT
     I              ISBWPR                          WFBWPR
     I              ISBLPR                          WFBLPR
     I              ISBXPR                          WFBXPR
     I              ISBYPR                          WFBYPR
     I              ISLQCD                          WFLQCD
     I              ISUVST                          WFUVST
     I              ISUWST                          WFUWST
     I              ISUXST                          WFUXST
     I              ISVSST                          WFVSST
     I              ISAATM                          WFAATM
     I              ISAYNA                          WFAYNA
     I              ISA0NA                          WFA0NA
     I              ISAXDT                          WFAXDT
      *
     I@ISREV5
      * Company Customer Item     Update index
      * Renamed input format fields
     I              ISAIC3                          WGAIC3
     I              ISBKC7                          WGBKC7
     I              ISHGCD                          WGHGCD
     I              ISERDT                          WGERDT
     I              ISESDT                          WGESDT
     I              ISBWPR                          WGBWPR
     I              ISBLPR                          WGBLPR
     I              ISBXPR                          WGBXPR
     I              ISBYPR                          WGBYPR
     I              ISLQCD                          WGLQCD
     I              ISUVST                          WGUVST
     I              ISUWST                          WGUWST
     I              ISUXST                          WGUXST
     I              ISVSST                          WGVSST
     I              ISAATM                          WGAATM
     I              ISAYNA                          WGAYNA
     I              ISA0NA                          WGA0NA
     I              ISAXDT                          WGAXDT
      *
     I@GKRENN
      * Customer Freight Rate     Customer/Company/Chg Dat
      * Renamed input format fields
     I              GKAIC3                          WHAIC3
     I              GKBKC7                          WHBKC7
     I              GKMKDT                          WHMKDT
     I              GKBFTM                          WHBFTM
     I              GKTBNB                          WHTBNB
     I              GKVSST                          WHVSST
     I              GKAATM                          WHAATM
     I              GKAYNA                          WHAYNA
     I              GKA0NA                          WHA0NA
     I              GKAXDT                          WHAXDT
      *
     I@GKREHL
      * Customer Freight Rate     Update index
      * Renamed input format fields
     I              GKAIC3                          WIAIC3
     I              GKBKC7                          WIBKC7
     I              GKMKDT                          WIMKDT
     I              GKBFTM                          WIBFTM
     I              GKTBNB                          WITBNB
     I              GKVSST                          WIVSST
     I              GKAATM                          WIAATM
     I              GKAYNA                          WIAYNA
     I              GKA0NA                          WIA0NA
     I              GKAXDT                          WIAXDT
      *
     I@BIREKY
      * Customer Item Reference   Retrieval index
      * Renamed input format fields
     I              BIBKC7                          WJBKC7
     I              BIHGCD                          WJHGCD
     I              BICOAA                          WJCOAA
     I              BICPAA                          WJCPAA
     I              BIPSNA                          WJPSNA
     I              BIPTNA                          WJPTNA
     I              BIPUNA                          WJPUNA
     I              BILBSX                          WJLBSX
     I              BILCSX                          WJLCSX
     I              BILDSX                          WJLDSX
     I              BILESX                          WJLESX
     I              BILFSX                          WJLFSX
     I              BIVSST                          WJVSST
     I              BIMJDT                          WJMJDT
     I              BIBETM                          WJBETM
     I              BICCVN                          WJCCVN
     I              BICDVN                          WJCDVN
     I              BIMKDT                          WJMKDT
     I              BIBFTM                          WJBFTM
     I              BICEVN                          WJCEVN
     I              BICFVN                          WJCFVN
      *
     I@BIREKX
      * Customer Item Reference   Update index
      * Renamed input format fields
     I              BIBKC7                          WKBKC7
     I              BIHGCD                          WKHGCD
     I              BICOAA                          WKCOAA
     I              BICPAA                          WKCPAA
     I              BIPSNA                          WKPSNA
     I              BIPTNA                          WKPTNA
     I              BIPUNA                          WKPUNA
     I              BILBSX                          WKLBSX
     I              BILCSX                          WKLCSX
     I              BILDSX                          WKLDSX
     I              BILESX                          WKLESX
     I              BILFSX                          WKLFSX
     I              BIVSST                          WKVSST
     I              BIMJDT                          WKMJDT
     I              BIBETM                          WKBETM
     I              BICCVN                          WKCCVN
     I              BICDVN                          WKCDVN
     I              BIMKDT                          WKMKDT
     I              BIBFTM                          WKBFTM
     I              BICEVN                          WKCEVN
     I              BICFVN                          WKCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAEO1    E DSCAEOREL0
      * UPD : Company Customer          Update index
      * Renamed input format fields
     I              EOAIC3                          WCAIC3
     I              EOBKC7                          WCBKC7
     I              EOAQCD                          WCAQCD
     I              EOR4CD                          WCR4CD
     I              EOBYNA                          WCBYNA
     I              EOB6NA                          WCB6NA
     I              EOBZNA                          WCBZNA
     I              EOLLST                          WCLLST
     I              EOPPST                          WCPPST
     I              EOR5NB                          WCR5NB
     I              EOR6NB                          WCR6NB
     I              EOQGST                          WCQGST
     I              EOBOCD                          WCBOCD
     I              EOTBNB                          WCTBNB
     I              EOMTCU                          WCMTCU
     I              EOW2NB                          WCW2NB
     I              EORPCD                          WCRPCD
     I              EOAJCD                          WCAJCD
     I              EOX9ST                          WCX9ST
     I              EOT9CD                          WCT9CD
     I              EOUBCD                          WCUBCD
     I              EOISTX                          WCISTX
     I              EOLQCD                          WCLQCD
     I              EONJNA                          WCNJNA
     I              EOI0TX                          WCI0TX
     I              EONKNA                          WCNKNA
     I              EOI1TX                          WCI1TX
     I              EOVLST                          WCVLST
     I              EORLST                          WCRLST
     I              EOMMTX                          WCMMTX
     I              EOOHNA                          WCOHNA
     I              EOQ6ST                          WCQ6ST
     I              EOQ8ST                          WCQ8ST
     I              EORBST                          WCRBST
     I              EOREST                          WCREST
     I              EOUVST                          WCUVST
     I              EOUWST                          WCUWST
     I              EOUXST                          WCUXST
     I              EOVSST                          WCVSST
     I              EOAATM                          WCAATM
     I              EOAYNA                          WCAYNA
     I              EOA0NA                          WCA0NA
     I              EOAXDT                          WCAXDT
      *
     IYARDCS      DS                            344
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDNE1    E DSPDNEREL0
      * UPD : Customer EXT              Update index
      * Renamed input format fields
     I              NEBKC7                          WEBKC7
     I              NEUFTX                          WEUFTX
     I              NEUGTX                          WEUGTX
     I              NEPFNA                          WEPFNA
     I              NEJ5NX                          WEJ5NX
     I              NEU5TX                          WEU5TX
     I              NEU6TX                          WEU6TX
     I              NEW0TX                          WEW0TX
     I              NEHSSX                          WEHSSX
     I              NEHUSX                          WEHUSX
     I              NEHVSX                          WEHVSX
     I              NEAAC8                          WEAAC8
     I              NEP0SX                          WEP0SX
     I              NEP1SX                          WEP1SX
     I              NEP2SX                          WEP2SX
     I              NEP3SX                          WEP3SX
     I              NEP4SX                          WEP4SX
     I              NEP5SX                          WEP5SX
     I              NEP6SX                          WEP6SX
     I              NEUVST                          WEUVST
     I              NEUWST                          WEUWST
     I              NEUXST                          WEUXST
     I              NEVSST                          WEVSST
     I              NEAATM                          WEAATM
     I              NEAYNA                          WEAYNA
     I              NEA0NA                          WEA0NA
     I              NEAXDT                          WEAXDT
      *
     IYBRDCS      DS                            189
     IQPDIS1    E DSPDISREL0
      * UPD : Company Customer Item     Update index
      * Renamed input format fields
     I              ISAIC3                          WGAIC3
     I              ISBKC7                          WGBKC7
     I              ISHGCD                          WGHGCD
     I              ISERDT                          WGERDT
     I              ISESDT                          WGESDT
     I              ISBWPR                          WGBWPR
     I              ISBLPR                          WGBLPR
     I              ISBXPR                          WGBXPR
     I              ISBYPR                          WGBYPR
     I              ISLQCD                          WGLQCD
     I              ISUVST                          WGUVST
     I              ISUWST                          WGUWST
     I              ISUXST                          WGUXST
     I              ISVSST                          WGVSST
     I              ISAATM                          WGAATM
     I              ISAYNA                          WGAYNA
     I              ISA0NA                          WGA0NA
     I              ISAXDT                          WGAXDT
      *
     IYCRDCS      DS                             77
     IQPNGK1    E DSPNGKREL0
      * UPD : Customer Freight Rate     Update index
      * Renamed input format fields
     I              GKAIC3                          WIAIC3
     I              GKBKC7                          WIBKC7
     I              GKMKDT                          WIMKDT
     I              GKBFTM                          WIBFTM
     I              GKTBNB                          WITBNB
     I              GKVSST                          WIVSST
     I              GKAATM                          WIAATM
     I              GKAYNA                          WIAYNA
     I              GKA0NA                          WIA0NA
     I              GKAXDT                          WIAXDT
      *
     IYDRDCS      DS                             46
     IQPOBI1    E DSPOBIREL0
      * UPD : Customer Item Reference   Update index
      * Renamed input format fields
     I              BIBKC7                          WKBKC7
     I              BIHGCD                          WKHGCD
     I              BICOAA                          WKCOAA
     I              BICPAA                          WKCPAA
     I              BIPSNA                          WKPSNA
     I              BIPTNA                          WKPTNA
     I              BIPUNA                          WKPUNA
     I              BILBSX                          WKLBSX
     I              BILCSX                          WKLCSX
     I              BILDSX                          WKLDSX
     I              BILESX                          WKLESX
     I              BILFSX                          WKLFSX
     I              BIVSST                          WKVSST
     I              BIMJDT                          WKMJDT
     I              BIBETM                          WKBETM
     I              BICCVN                          WKCCVN
     I              BICDVN                          WKCDVN
     I              BIMKDT                          WKMKDT
     I              BIBFTM                          WKBFTM
     I              BICEVN                          WKCEVN
     I              BICFVN                          WKCFVN
      *
     IYERDCS      DS                            188
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * RTV/Cnv Assoc File Sts XF
      * * one time conversion program
      * RTV/Cnv Assoc File Sts RT - Customer  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV/Cnv Assoc File Sts RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@BBREE9                    *
     C                     READ @BBREE9                  90*
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** If Company/Customer record exists, set status to match Custome
     C                     EXSR UASUBR                     ** If Company/C
      * ** If Customer EXT exists, set record status to match customer
     C                     EXSR UBSUBR                     ** If Customer
      * ** If Co Customer Item record exists, set status to match Custome
     C                     EXSR UCSUBR                     ** If Co Custom
      * ** If Customer Freight Rate exists, set RecSts to match customer
     C                     EXSR UDSUBR                     ** If Customer
      * ** If Customer Item Reference exists, set RecSts to match custome
     C                     EXSR UESUBR                     ** If Customer
     C                     READ @BBREE9                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Val Customer exists    RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBKC7    WQSB01           Ship To Custome
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Ship To Custome
      * Setup key
     C                     Z-ADDWABKC7    WQSB01           Ship To Custome
      * Establish starting position
     C           KRSSB     SETLL@EOREU0                    *
     C           KRSSB     READE@EOREU0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL@CN,002   W0RTN            *Return code
     C           KRSSB     READE@EOREU0                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV/UPD Co Cust Status RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBKC7    WQSC01           Ship To Custome
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Ship To Custome
      * Setup key
     C                     Z-ADDWABKC7    WQSC01           Ship To Custome
      * Establish starting position
     C           KRSSC     SETLL@EOREU0                    *
     C           KRSSC     READE@EOREU0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status NE PAR.Record Status
     C           WBVSST    IFNE WAVSST                     *IF
      * Chg Co Cust Status    CH - Company Customer  * 
     C                     EXSR SDCHRC
     C                     END                             *FI
     C           KRSSC     READE@EOREU0                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg Co Cust Status    CH - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @EOREXL
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWBBKC7    WCBKC7           Ship To Custome
      *
     C           KLCHSD    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCBKC7           Ship To Custome
     C           KLCHSD    CHAIN@EOREXL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * Not an error if no record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAEOREL0'MDACP
     C                     MOVEL'@EOREXL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAEO1    YARDCS
      * Move non-key fields to @EOREXL
     C                     MOVELWBAQCD    WCAQCD    P      Terms Code
     C                     MOVELWBR4CD    WCR4CD    P      Sales Route Cod
     C                     MOVELWBBYNA    WCBYNA    P      Special Instruc
     C                     MOVELWBB6NA    WCB6NA    P      Special Instruc
     C                     MOVELWBBZNA    WCBZNA    P      Carrier Code
     C                     MOVELWBLLST    WCLLST    P      Broker
     C                     MOVELWBPPST    WCPPST    P      P.O. Required F
     C                     Z-ADDWBR5NB    WCR5NB           Deliver after t
     C                     Z-ADDWBR6NB    WCR6NB           Deliver before
     C                     MOVELWBQGST    WCQGST    P      Alt Remittance
     C                     MOVELWBBOCD    WCBOCD    P      Type Code
     C                     Z-ADDWBTBNB    WCTBNB           Absorbed Freigh
     C                     Z-ADDWBMTCU    WCMTCU           Mileage To Cust
     C                     Z-ADDWBW2NB    WCW2NB           Co/Cust Overage
     C                     MOVELWBRPCD    WCRPCD    P      Age Code
     C                     MOVELWBAJCD    WCAJCD    P      Warehouse Code
     C                     MOVELWBX9ST    WCX9ST    P      Outside Warehou
     C                     MOVELWBT9CD    WCT9CD    P      Customer Group
     C                     MOVELWBUBCD    WCUBCD    P      Customer Group
     C                     MOVELWBISTX    WCISTX    P      G/L Code
     C                     MOVELWBLQCD    WCLQCD    P      Commodity Marke
     C                     MOVELWBNJNA    WCNJNA    P      Credit Contact
     C                     MOVELWBI0TX    WCI0TX    P      Credit Contact
     C                     MOVELWBNKNA    WCNKNA    P      Credit Contact
     C                     MOVELWBI1TX    WCI1TX    P      Credit Contact
     C                     MOVELWBVLST    WCVLST    P      Allow Man/Qt WO
     C                     MOVELWBRLST    WCRLST    P      Fax Invoice Fla
     C                     MOVELWBMMTX    WCMMTX    P      Fax Invoice Fax
     C                     MOVELWBOHNA    WCOHNA    P      Fax Invoice Con
     C                     MOVELWBQ6ST    WCQ6ST    P      Distributor
     C                     MOVELWBQ8ST    WCQ8ST    P      Default Shippin
     C                     MOVELWBRBST    WCRBST    P      Ord Ent Default
     C                     MOVELWBREST    WCREST    P      Bypass DDt/Dela
     C                     MOVELWBUVST    WCUVST    P      EDI Status 1
     C                     MOVELWBUWST    WCUWST    P      EDI Status 2
     C                     MOVELWBUXST    WCUXST    P      EDI Status 3
     C                     MOVELWAVSST    WCVSST    P      Record Status
     C                     Z-ADDWBAATM    WCAATM           Job Time
     C                     MOVELWBAYNA    WCAYNA    P      User Id
     C                     MOVELWBA0NA    WCA0NA    P      Job Name
     C                     Z-ADDWBAXDT    WCAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QCAEO1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAEO1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@EOREXL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAEOREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Val Cust in Custom EXT RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WDBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWABKC7    WDBKC7           Ship To Custome
      * Establish starting position
     C           KRSSE     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL@CN,002   W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Upd Cust Status   RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WDBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWABKC7    WDBKC7           Ship To Custome
      * Establish starting position
     C           KRSSF     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: PAR.Record Status NE DB1.Record Status
     C           WAVSST    IFNE WDVSST                     *IF
      * Chg Cust EXT Rec Sts  CH - Customer EXT  * 
     C                     EXSR SGCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Cust EXT Rec Sts  CH - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @NEREAS
     C                     Z-ADDWDBKC7    WEBKC7           Ship To Custome
      *
     C           KLCHSG    KLIST
     C                     KFLD           WEBKC7           Ship To Custome
     C           KLCHSG    CHAIN@NEREAS              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDNEREL0'MDACP
     C                     MOVEL'@NEREAS' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDNE1    YBRDCS
      * Move non-key fields to @NEREAS
     C                     MOVELWDUFTX    WEUFTX    P      Internet Passwo
     C                     MOVELWDUGTX    WEUGTX    P      Email Address
     C                     MOVELWDPFNA    WEPFNA    P      Email User ID
     C                     MOVELWDJ5NX    WEJ5NX    P      EDI Trading Par
     C                     MOVELWDU5TX    WEU5TX    P      EDI Cust Duns N
     C                     MOVELWDU6TX    WEU6TX    P      EDI Warehouse/S
     C                     MOVELWDW0TX    WEW0TX    P      State Tax ID
     C                     MOVELWDHSSX    WEHSSX    P      Cust Shipping T
     C                     MOVELWDHUSX    WEHUSX    P      One Invoice Per
     C                     MOVELWDHVSX    WEHVSX    P      EDI Advanced Sh
     C                     Z-ADDWDAAC8    WEAAC8           Customer G/L Ve
     C                     MOVELWDP0SX    WEP0SX    P      Air Freight Ord
     C                     MOVELWDP1SX    WEP1SX    P      Regional Mgr Fa
     C                     MOVELWDP2SX    WEP2SX    P      Employee Meat S
     C                     MOVELWDP3SX    WEP3SX    P      Customer TF Exe
     C                     MOVELWDP4SX    WEP4SX    P      Customer Watch
     C                     MOVELWDP5SX    WEP5SX    P      Customer Sales
     C                     MOVELWDP6SX    WEP6SX    P      Customer Market
     C                     MOVELWDUVST    WEUVST    P      EDI Status 1
     C                     MOVELWDUWST    WEUWST    P      EDI Status 2
     C                     MOVELWDUXST    WEUXST    P      EDI Status 3
     C                     MOVELWAVSST    WEVSST    P      Record Status
     C                     Z-ADDWDAATM    WEAATM           Job Time
     C                     MOVELWDAYNA    WEAYNA    P      User Id
     C                     MOVELWDA0NA    WEA0NA    P      Job Name
     C                     Z-ADDWDAXDT    WEAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPDNE1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDNE1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@NEREAS                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDNEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Val Customer exists    RT - Company Customer Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFBKC7    WQSH01           Ship To Custome
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Ship To Custome
      * Setup key
     C                     Z-ADDWABKC7    WQSH01           Ship To Custome
      * Establish starting position
     C           KRSSH     SETLL@ISRENM                    *
     C           KRSSH     READE@ISRENM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1687' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL@CN,002   W0RTN            *Return code
     C           KRSSH     READE@ISRENM                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV/Upd Cust Item Sts  RT - Company Customer Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFBKC7    WQSI01           Ship To Custome
      * Define keylist
     C           KPSSI     KLIST
     C                     KFLD           WQSI01           Ship To Custome
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Ship To Custome
      * Setup key
     C                     Z-ADDWABKC7    WQSI01           Ship To Custome
     C                     Z-ADD1         WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
      * Establish starting position
     C           KPSSI     SETLL@ISRENM                    *
     C           KRSSI     READE@ISRENM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1687' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status NE PAR.Record Status
     C           WFVSST    IFNE WAVSST                     *IF
      * CHG CoCust Item Status CH - Company Customer Item  * 
     C                     EXSR SJCHRC
     C                     END                             *FI
     C           KRSSI     READE@ISRENM                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * CHG CoCust Item Status CH - Company Customer Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @ISREV5
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFBKC7    WGBKC7           Ship To Custome
     C                     Z-ADDWFHGCD    WGHGCD           Item Code
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGBKC7           Ship To Custome
     C                     KFLD           WGHGCD           Item Code
     C           KLCHSJ    CHAIN@ISREV5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDISREL0'MDACP
     C                     MOVEL'@ISREV5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDIS1    YCRDCS
      * USER: Processing after Data read
      * DB1 = PAR By name
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFBKC7    WGBKC7           Ship To Custome
     C                     Z-ADDWFHGCD    WGHGCD           Item Code
     C                     Z-ADDWFERDT    WGERDT           Overage Begin D
     C                     Z-ADDWFESDT    WGESDT           Overage End Dat
     C                     Z-ADDWFBWPR    WGBWPR           Seasonal Overag
     C                     Z-ADDWFBLPR    WGBLPR           Market Overage
     C                     Z-ADDWFBXPR    WGBXPR           Formula Differe
     C                     Z-ADDWFBYPR    WGBYPR           Formula Process
     C                     MOVELWFLQCD    WGLQCD           Commodity Marke
     C                     MOVELWFUVST    WGUVST           EDI Status 1
     C                     MOVELWFUWST    WGUWST           EDI Status 2
     C                     MOVELWFUXST    WGUXST           EDI Status 3
     C                     MOVELWAVSST    WGVSST           Record Status
     C                     Z-ADDWFAATM    WGAATM           Job Time
     C                     MOVELWFAYNA    WGAYNA           User Id
     C                     MOVELWFA0NA    WGA0NA           Job Name
     C                     Z-ADDWFAXDT    WGAXDT           Job Date
      * Move non-key fields to @ISREV5
     C                     Z-ADDWFERDT    WGERDT           Overage Begin D
     C                     Z-ADDWFESDT    WGESDT           Overage End Dat
     C                     Z-ADDWFBWPR    WGBWPR           Seasonal Overag
     C                     Z-ADDWFBLPR    WGBLPR           Market Overage
     C                     Z-ADDWFBXPR    WGBXPR           Formula Differe
     C                     Z-ADDWFBYPR    WGBYPR           Formula Process
     C                     MOVELWFLQCD    WGLQCD    P      Commodity Marke
     C                     MOVELWFUVST    WGUVST    P      EDI Status 1
     C                     MOVELWFUWST    WGUWST    P      EDI Status 2
     C                     MOVELWFUXST    WGUXST    P      EDI Status 3
     C                     MOVELWAVSST    WGVSST    P      Record Status
     C                     Z-ADDWFAATM    WGAATM           Job Time
     C                     MOVELWFAYNA    WGAYNA    P      User Id
     C                     MOVELWFA0NA    WGA0NA    P      Job Name
     C                     Z-ADDWFAXDT    WGAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPDIS1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDIS1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@ISREV5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDISREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * VAL Cust Frt Rt Exists RT - Customer Freight Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHBKC7    WQSK01           Ship To Custome
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Ship To Custome
      * Setup key
     C                     Z-ADDWABKC7    WQSK01           Ship To Custome
      * Establish starting position
     C           KRSSK     SETLL@GKRENN                    *
     C           KRSSK     READE@GKRENN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4357' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL@CN,002   W0RTN            *Return code
     C           KRSSK     READE@GKRENN                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV/UPD Cst Frt Rt Sts RT - Customer Freight Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHBKC7    WQSL01           Ship To Custome
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           Ship To Custome
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHMKDT           Change Date
     C                     KFLD           WHBFTM           Change Time
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Ship To Custome
      * Setup key
     C                     Z-ADDWABKC7    WQSL01           Ship To Custome
     C                     Z-ADD1         WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHMKDT           Change Date
     C                     Z-ADD*ZERO     WHBFTM           Change Time
      * Establish starting position
     C           KPSSL     SETLL@GKRENN                    *
     C           KRSSL     READE@GKRENN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4357' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status NE PAR.Record Status
     C           WHVSST    IFNE WAVSST                     *IF
      * CHG Cust Frt Rate Sts  CH - Customer Freight Rate  * 
     C                     EXSR SMCHRC
     C                     END                             *FI
     C           KRSSL     READE@GKRENN                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * CHG Cust Frt Rate Sts  CH - Customer Freight Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @GKREHL
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     Z-ADDWHBKC7    WIBKC7           Ship To Custome
     C                     Z-ADDWHMKDT    WIMKDT           Change Date
     C                     Z-ADDWHBFTM    WIBFTM           Change Time
      *
     C           KLCHSM    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIBKC7           Ship To Custome
     C                     KFLD           WIMKDT           Change Date
     C                     KFLD           WIBFTM           Change Time
     C           KLCHSM    CHAIN@GKREHL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PNGKREL0'MDACP
     C                     MOVEL'@GKREHL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPNGK1    YDRDCS
      * Move non-key fields to @GKREHL
     C                     Z-ADDWHTBNB    WITBNB           Absorbed Freigh
     C                     MOVELWAVSST    WIVSST    P      Record Status
     C                     Z-ADDWHAATM    WIAATM           Job Time
     C                     MOVELWHAYNA    WIAYNA    P      User Id
     C                     MOVELWHA0NA    WIA0NA    P      Job Name
     C                     Z-ADDWHAXDT    WIAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPNGK1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPNGK1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@GKREHL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPNGKREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * VAL Cust Item Ref Exis RT - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJBKC7    WQSN01           Ship To Custome
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Ship To Custome
      * Setup key
     C                     Z-ADDWABKC7    WQSN01           Ship To Custome
      * Establish starting position
     C           KRSSN     SETLL@BIREKY                    *
     C           KRSSN     READE@BIREKY                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL@CN,002   W0RTN            *Return code
     C           KRSSN     READE@BIREKY                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV/UPD CIR Status    RT - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJBKC7    WQSO01           Ship To Custome
      * Define keylist
     C           KPSSO     KLIST
     C                     KFLD           WQSO01           Ship To Custome
     C                     KFLD           WJHGCD           Item Code
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Ship To Custome
      * Setup key
     C                     Z-ADDWABKC7    WQSO01           Ship To Custome
     C                     Z-ADD1         WJHGCD           Item Code
      * Establish starting position
     C           KPSSO     SETLL@BIREKY                    *
     C           KRSSO     READE@BIREKY                  90*
      * Data record not found
     C   90                MOVEL'USR3081' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status NE PAR.Record Status
     C           WJVSST    IFNE WAVSST                     *IF
      * CHG Cust Itm Ref Sts  CH - Customer Item Reference  * 
     C                     EXSR SPCHRC
     C                     END                             *FI
     C           KRSSO     READE@BIREKY                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * CHG Cust Itm Ref Sts  CH - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BIREKX
     C                     Z-ADDWJBKC7    WKBKC7           Ship To Custome
     C                     Z-ADDWJHGCD    WKHGCD           Item Code
      *
     C           KLCHSP    KLIST
     C                     KFLD           WKBKC7           Ship To Custome
     C                     KFLD           WKHGCD           Item Code
     C           KLCHSP    CHAIN@BIREKX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POBIREL0'MDACP
     C                     MOVEL'@BIREKX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOBI1    YERDCS
      * Move non-key fields to @BIREKX
     C                     MOVELWJCOAA    WKCOAA    P      CIR Resource No
     C                     MOVELWJCPAA    WKCPAA    P      CIR Item No
     C                     MOVELWJPSNA    WKPSNA    P      CIR Description
     C                     MOVELWJPTNA    WKPTNA    P      CIR Description
     C                     MOVELWJPUNA    WKPUNA    P      CIR Description
     C                     MOVELWJLBSX    WKLBSX    P      CIR Unused Stat
     C                     MOVELWJLCSX    WKLCSX    P      CIR Unused Stat
     C                     MOVELWJLDSX    WKLDSX    P      CIR Unused Stat
     C                     MOVELWJLESX    WKLESX    P      CIR Unused Stat
     C                     MOVELWJLFSX    WKLFSX    P      CIR Unused Stat
     C                     MOVELWAVSST    WKVSST    P      Record Status
     C                     Z-ADDWJMJDT    WKMJDT           Create Date
     C                     Z-ADDWJBETM    WKBETM           Create Time
     C                     MOVELWJCCVN    WKCCVN    P      Create User
     C                     MOVELWJCDVN    WKCDVN    P      Create Program
     C                     Z-ADDWJMKDT    WKMKDT           Change Date
     C                     Z-ADDWJBFTM    WKBFTM           Change Time
     C                     MOVELWJCEVN    WKCEVN    P      Change User
     C                     MOVELWJCFVN    WKCFVN    P      Change Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPOBI1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WKBFTM           Job Time
     C                     MOVEL##USR     WKCEVN           User Id
     C                     MOVEL##JOB     WKCFVN           Job Name
     C                     Z-ADD##JDT     WKMKDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOBI1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BIREKX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOBIREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ** If Company/Customer record exists, set status to match Custom
      *================================================================
      * ** If Ship To record exists, set to match Customer
      * Val Customer exists    RT - Company Customer  * 
     C                     EXSR SBRVGN
      * ** Update CoCust status
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,002                    *IF
      * ** Updates Ship To for all companies in the library
      * RTV/UPD Co Cust Status RT - Company Customer  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ** If Customer EXT exists, set record status to match customer
      *================================================================
      * ** If Ship To record exists, set status to match Customer
      * Val Cust in Custom EXT RT - Customer EXT  * 
     C                     EXSR SERVGN
      * ** Update Cust EXT status to match Customer status
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,002                    *IF
      * RTV Upd Cust Status   RT - Customer EXT  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ** If Co Customer Item record exists, set status to match Custom
      *================================================================
      * ** If Ship To record exists, set to match Customer
      * Val Customer exists    RT - Company Customer Item  * 
     C                     EXSR SHRVGN
      * ** Update Co Customer Item record
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,002                    *IF
      * ** Updates Ship To for all companies in the library
      * RTV/Upd Cust Item Sts  RT - Company Customer Item  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ** If Customer Freight Rate exists, set RecSts to match customer
      *================================================================
      * ** If Ship To record exists, set status to match Customer
      * VAL Cust Frt Rt Exists RT - Customer Freight Rate  * 
     C                     EXSR SKRVGN
      * ** Update Customer Freight Rate status to match Customer status
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,002                    *IF
      * RTV/UPD Cst Frt Rt Sts RT - Customer Freight Rate  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * ** If Customer Item Reference exists, set RecSts to match custom
      *================================================================
      * ** If Ship To record exists, set status to match Customer
      * VAL Cust Item Ref Exis RT - Customer Item Reference  * 
     C                     EXSR SNRVGN
      * ** Update Customer Item Reference status to match Customer status
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,002                    *IF
      * RTV/UPD CIR Status    RT - Customer Item Reference  * 
     C                     EXSR SORVGN
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAP3NB           D & B Number
     C                     Z-ADD*ZERO     WAI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WAAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WAVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WAI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBR5NB           Deliver after t
     C                     Z-ADD*ZERO     WBR6NB           Deliver before
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WBW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDAAC8           Customer G/L Ve
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFERDT           Overage Begin D
     C                     Z-ADD*ZERO     WFESDT           Overage End Dat
     C                     Z-ADD*ZERO     WFBWPR           Seasonal Overag
     C                     Z-ADD*ZERO     WFBLPR           Market Overage
     C                     Z-ADD*ZERO     WFBXPR           Formula Differe
     C                     Z-ADD*ZERO     WFBYPR           Formula Process
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHMKDT           Change Date
     C                     Z-ADD*ZERO     WHBFTM           Change Time
     C                     Z-ADD*ZERO     WHTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJMJDT           Create Date
     C                     Z-ADD*ZERO     WJBETM           Create Time
     C                     Z-ADD*ZERO     WJMKDT           Change Date
     C                     Z-ADD*ZERO     WJBFTM           Change Time
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 Y2U0003
