     H/TITLE Pmt Trnsfr H/O Crcss  PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Prompt & validate record
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJBADE
     H* Date          : 02/05/21  Time  : 16:25:48
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPKTZPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Pmt Trnsfr H/O Crcss  PV  Prompt & validate record
      *
     FPKBOREL1IF  E           K        DISK
      * RTV : Evaluation Validation     Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKBVCPL9IF  E           K        DISK
      * RSQ : Eval Trans                Co/Bol/KillDt/Tattoo
      *
     FPKBVCPL2IF  E           K        DISK
      * RSQ : Eval Trans                Next Eval Trans
      *
     FPKCGCPL4IF  E           K        DISK
      * RSQ : Producer History WKLY     Co/Prod/WkEndDte(D)/Type
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPKA7REL1IF  E           K        DISK
      * RTV : Hog Defect                Retrieval index
      *
     FPKCCREL0IF  E           K        DISK
      * RTV : Tattoo Header Process     Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKADREL0IF  E           K        DISK
      * RTV : Hog Buyer                 Retrieval index
      *
     FPKAIREL0IF  E           K        DISK
      * RTV : Genetic                   Retrieval index
      *
     FPKA8REL1IF  E           K        DISK
      * RTV : Hog Classification        Retrieval index
      *
     FPKBVCPL0UF  E           K        DISK                      A
      * UPD : Eval Trans                Update index
      *
     I@BOREFN
      * Evaluation Validation     Retrieval index
      * Renamed input format fields
     I              BOBVCD                          WABVCD
     I              BOCBTX                          WACBTX
     I              BOC5ST                          WAC5ST
     I              BOAFPC                          WAAFPC
     I              BOAGPC                          WAAGPC
     I              BOFEST                          WAFEST
     I              BOAAVN                          WAAAVN
     I              BOAADT                          WAAADT
     I              BOAMTM                          WAAMTM
     I              BOAJST                          WAAJST
     I              BOAHVN                          WAAHVN
     I              BOAGVN                          WAAGVN
     I              BOABVN                          WAABVN
     I              BOABDT                          WAABDT
     I              BOABTM                          WAABTM
      *
     I@BVCPQ9
      * Eval Trans                Co/Bol/KillDt/Tattoo
      * Renamed input format fields
     I              BVHSNB                          WBHSNB
     I              BVA9DT                          WBA9DT
     I              BVFJNB                          WBFJNB
     I              BVHCNB                          WBHCNB
     I              BVGDNB                          WBGDNB
     I              BVFINB                          WBFINB
     I              BVLKNB                          WBLKNB
     I              BVEAST                          WBEAST
     I              BVAMPC                          WBAMPC
     I              BVAIPC                          WBAIPC
     I              BVAJPC                          WBAJPC
     I              BVAKPC                          WBAKPC
     I              BVX8NB                          WBX8NB
     I              BVFVPC                          WBFVPC
     I              BVFWPC                          WBFWPC
     I              BVFXPC                          WBFXPC
     I              BVALPC                          WBALPC
     I              BVDIST                          WBDIST
     I              BVFYST                          WBFYST
     I              BVD2ST                          WBD2ST
     I              BVEHST                          WBEHST
     I              BVG1ST                          WBG1ST
     I              BVH4ST                          WBH4ST
     I              BVJLST                          WBJLST
     I              BVUUST                          WBUUST
     I              BVVHST                          WBVHST
     I              BVVIST                          WBVIST
     I              BVVJST                          WBVJST
     I              BVVKST                          WBVKST
     I              BVVLST                          WBVLST
     I              BVHMNB                          WBHMNB
     I              BVBNNB                          WBBNNB
     I              BVBONB                          WBBONB
     I              BVCVNB                          WBCVNB
     I              BVB0DT                          WBB0DT
     I              BVAAVN                          WBAAVN
     I              BVAADT                          WBAADT
     I              BVAMTM                          WBAMTM
     I              BVAJST                          WBAJST
     I              BVAHVN                          WBAHVN
     I              BVAGVN                          WBAGVN
     I              BVABVN                          WBABVN
     I              BVABDT                          WBABDT
     I              BVABTM                          WBABTM
     I              BVB8DT                          WBB8DT
     I              BVAOTM                          WBAOTM
      *
     I@BVCPNE
      * Eval Trans                Next Eval Trans
      * Renamed input format fields
     I              BVHSNB                          WCHSNB
     I              BVA9DT                          WCA9DT
     I              BVFJNB                          WCFJNB
     I              BVHCNB                          WCHCNB
     I              BVGDNB                          WCGDNB
     I              BVFINB                          WCFINB
     I              BVLKNB                          WCLKNB
     I              BVEAST                          WCEAST
     I              BVAMPC                          WCAMPC
     I              BVAIPC                          WCAIPC
     I              BVAJPC                          WCAJPC
     I              BVAKPC                          WCAKPC
     I              BVX8NB                          WCX8NB
     I              BVFVPC                          WCFVPC
     I              BVFWPC                          WCFWPC
     I              BVFXPC                          WCFXPC
     I              BVALPC                          WCALPC
     I              BVDIST                          WCDIST
     I              BVFYST                          WCFYST
     I              BVD2ST                          WCD2ST
     I              BVEHST                          WCEHST
     I              BVG1ST                          WCG1ST
     I              BVH4ST                          WCH4ST
     I              BVJLST                          WCJLST
     I              BVUUST                          WCUUST
     I              BVVHST                          WCVHST
     I              BVVIST                          WCVIST
     I              BVVJST                          WCVJST
     I              BVVKST                          WCVKST
     I              BVVLST                          WCVLST
     I              BVHMNB                          WCHMNB
     I              BVBNNB                          WCBNNB
     I              BVBONB                          WCBONB
     I              BVCVNB                          WCCVNB
     I              BVB0DT                          WCB0DT
     I              BVAAVN                          WCAAVN
     I              BVAADT                          WCAADT
     I              BVAMTM                          WCAMTM
     I              BVAJST                          WCAJST
     I              BVAHVN                          WCAHVN
     I              BVAGVN                          WCAGVN
     I              BVABVN                          WCABVN
     I              BVABDT                          WCABDT
     I              BVABTM                          WCABTM
     I              BVB8DT                          WCB8DT
     I              BVAOTM                          WCAOTM
      *
     I@BVCPF0
      * Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WDHSNB
     I              BVA9DT                          WDA9DT
     I              BVFJNB                          WDFJNB
     I              BVHCNB                          WDHCNB
     I              BVGDNB                          WDGDNB
     I              BVFINB                          WDFINB
     I              BVLKNB                          WDLKNB
     I              BVEAST                          WDEAST
     I              BVAMPC                          WDAMPC
     I              BVAIPC                          WDAIPC
     I              BVAJPC                          WDAJPC
     I              BVAKPC                          WDAKPC
     I              BVX8NB                          WDX8NB
     I              BVFVPC                          WDFVPC
     I              BVFWPC                          WDFWPC
     I              BVFXPC                          WDFXPC
     I              BVALPC                          WDALPC
     I              BVDIST                          WDDIST
     I              BVFYST                          WDFYST
     I              BVD2ST                          WDD2ST
     I              BVEHST                          WDEHST
     I              BVG1ST                          WDG1ST
     I              BVH4ST                          WDH4ST
     I              BVJLST                          WDJLST
     I              BVUUST                          WDUUST
     I              BVVHST                          WDVHST
     I              BVVIST                          WDVIST
     I              BVVJST                          WDVJST
     I              BVVKST                          WDVKST
     I              BVVLST                          WDVLST
     I              BVHMNB                          WDHMNB
     I              BVBNNB                          WDBNNB
     I              BVBONB                          WDBONB
     I              BVCVNB                          WDCVNB
     I              BVB0DT                          WDB0DT
     I              BVAAVN                          WDAAVN
     I              BVAADT                          WDAADT
     I              BVAMTM                          WDAMTM
     I              BVAJST                          WDAJST
     I              BVAHVN                          WDAHVN
     I              BVAGVN                          WDAGVN
     I              BVABVN                          WDABVN
     I              BVABDT                          WDABDT
     I              BVABTM                          WDABTM
     I              BVB8DT                          WDB8DT
     I              BVAOTM                          WDAOTM
      *
     I@CGCPEJ
      * Producer History WKLY     Co/Prod/WkEndDte(D)/Type
      * Renamed input format fields
     I              CGY3A1                          WEY3A1
     I              CGABCD                          WEABCD
     I              CGUVST                          WEUVST
     I              CGDZDT                          WEDZDT
     I              CGOJJF                          WEOJJF
     I              CGALHD                          WEALHD
     I              CGKDUR                          WEKDUR
     I              CGKJOQ                          WEKJOQ
     I              CGJOWR                          WEJOWR
     I              CGOIWE                          WEOIWE
     I              CGIOTR                          WEIOTR
     I              CGJOWK                          WEJOWK
     I              CGUQWP                          WEUQWP
     I              CGO6PC                          WEO6PC
     I              CGJKSE                          WEJKSE
     I              CGG8PC                          WEG8PC
     I              CGHAPC                          WEHAPC
     I              CGORJG                          WEORJG
     I              CGHDPC                          WEHDPC
     I              CGHFPC                          WEHFPC
     I              CGS1PR                          WES1PR
     I              CGTCPR                          WETCPR
     I              CGS3PR                          WES3PR
     I              CGTDPR                          WETDPR
     I              CGS5PR                          WES5PR
     I              CGTEPR                          WETEPR
     I              CGS7PR                          WES7PR
     I              CGTFPR                          WETFPR
     I              CGB6A1                          WEB6A1
     I              CGJKOS                          WEJKOS
     I              CGALRC                          WEALRC
     I              CGKDIE                          WEKDIE
     I              CGJOEW                          WEJOEW
     I              CGOWUI                          WEOWUI
     I              CGIOWN                          WEIOWN
     I              CGORMB                          WEORMB
     I              CGJOQR                          WEJOQR
     I              CGPRUR                          WEPRUR
     I              CGG7PC                          WEG7PC
     I              CGIOOG                          WEIOOG
     I              CGG9PC                          WEG9PC
     I              CGHBPC                          WEHBPC
     I              CGUWOE                          WEUWOE
     I              CGHEPC                          WEHEPC
     I              CGHGPC                          WEHGPC
     I              CGS2PR                          WES2PR
     I              CGTGPR                          WETGPR
     I              CGS4PR                          WES4PR
     I              CGTHPR                          WETHPR
     I              CGS6PR                          WES6PR
     I              CGTIPR                          WETIPR
     I              CGS8PR                          WES8PR
     I              CGTJPR                          WETJPR
     I              CGB8A1                          WEB8A1
     I              CGAAVN                          WEAAVN
     I              CGAADT                          WEAADT
     I              CGAMTM                          WEAMTM
     I              CGAJST                          WEAJST
     I              CGAHVN                          WEAHVN
     I              CGAGVN                          WEAGVN
     I              CGABVN                          WEABVN
     I              CGABDT                          WEABDT
     I              CGABTM                          WEABTM
      *
     I@AXCPBX
      * Buy Order Load            Retrieval index
      * Renamed input format fields
     I              AXHMNB                          WFHMNB
     I              AXBNNB                          WFBNNB
     I              AXBONB                          WFBONB
     I              AXCQDT                          WFCQDT
     I              AXABTH                          WFABTH
     I              AXACTH                          WFACTH
     I              AXBPNB                          WFBPNB
     I              AXCSNB                          WFCSNB
     I              AXAUDT                          WFAUDT
     I              AXCMST                          WFCMST
     I              AXAGPR                          WFAGPR
     I              AXATVA                          WFATVA
     I              AXI1ST                          WFI1ST
     I              AXDHNB                          WFDHNB
     I              AXDINB                          WFDINB
     I              AXCNST                          WFCNST
     I              AXGINB                          WFGINB
     I              AXBZDT                          WFBZDT
     I              AXLSNB                          WFLSNB
     I              AXF3TX                          WFF3TX
     I              AXO8ST                          WFO8ST
     I              AXO9ST                          WFO9ST
     I              AXPAST                          WFPAST
     I              AXLDSH                          WFLDSH
     I              AXPBST                          WFPBST
     I              AXPCST                          WFPCST
     I              AXPDST                          WFPDST
     I              AXUWST                          WFUWST
     I              AXUXST                          WFUXST
     I              AXUYST                          WFUYST
     I              AXJKRU                          WFJKRU
     I              AXKEOR                          WFKEOR
     I              AXIOEW                          WFIOEW
     I              AXKJIO                          WFKJIO
     I              AXIOJR                          WFIOJR
     I              AXEIRR                          WFEIRR
     I              AXITMF                          WFITMF
     I              AXODJE                          WFODJE
     I              AXRJIF                          WFRJIF
     I              AXOEJF                          WFOEJF
     I              AXD0DT                          WFD0DT
     I              AXD1DT                          WFD1DT
     I              AXD2DT                          WFD2DT
     I              AXD3DT                          WFD3DT
     I              AXD4DT                          WFD4DT
     I              AXBNCD                          WFBNCD
     I              AXABCD                          WFABCD
     I              AXAECD                          WFAECD
     I              AXAAVN                          WFAAVN
     I              AXAADT                          WFAADT
     I              AXAMTM                          WFAMTM
     I              AXAJST                          WFAJST
     I              AXAHVN                          WFAHVN
     I              AXAGVN                          WFAGVN
     I              AXABVN                          WFABVN
     I              AXABDT                          WFABDT
     I              AXABTM                          WFABTM
      *
     I@A7REC1
      * Hog Defect                Retrieval index
      * Renamed input format fields
     I              A7BDCD                          WGBDCD
     I              A7BCTX                          WGBCTX
     I              A7RXST                          WGRXST
     I              A7R2ST                          WGR2ST
     I              A7RYST                          WGRYST
     I              A7RZST                          WGRZST
     I              A7R0ST                          WGR0ST
     I              A7R1ST                          WGR1ST
     I              A7HYCD                          WGHYCD
     I              A7HZCD                          WGHZCD
     I              A7VYST                          WGVYST
     I              A7AEA1                          WGAEA1
     I              A7UOPR                          WGUOPR
     I              A7UPPR                          WGUPPR
     I              A7UQPR                          WGUQPR
     I              A7AAVN                          WGAAVN
     I              A7AADT                          WGAADT
     I              A7AMTM                          WGAMTM
     I              A7AJST                          WGAJST
     I              A7AHVN                          WGAHVN
     I              A7AGVN                          WGAGVN
     I              A7ABVN                          WGABVN
     I              A7ABDT                          WGABDT
     I              A7ABTM                          WGABTM
      *
     I@CCREH3
      * Tattoo Header Process     Retrieval index
      * Renamed input format fields
     I              CCCSCD                          WHCSCD
     I              CCCETX                          WHCETX
     I              CCAAVN                          WHAAVN
     I              CCAADT                          WHAADT
     I              CCAMTM                          WHAMTM
     I              CCAJST                          WHAJST
     I              CCAHVN                          WHAHVN
     I              CCAGVN                          WHAGVN
     I              CCABVN                          WHABVN
     I              CCABDT                          WHABDT
     I              CCABTM                          WHABTM
      *
     I@AFREAR
      * Producer Location         Retrieval index
      * Renamed input format fields
     I              AFABCD                          WIABCD
     I              AFAECD                          WIAECD
     I              AFA8TX                          WIA8TX
     I              AFGLNB                          WIGLNB
     I              AFATST                          WIATST
     I              AFASNB                          WIASNB
     I              AFAUST                          WIAUST
     I              AFQNST                          WIQNST
     I              AFQOST                          WIQOST
     I              AFQPST                          WIQPST
     I              AFQQST                          WIQQST
     I              AFQRST                          WIQRST
     I              AFN0TX                          WIN0TX
     I              AFQSST                          WIQSST
     I              AFQTST                          WIQTST
     I              AFQUST                          WIQUST
     I              AFQVST                          WIQVST
     I              AFR8ST                          WIR8ST
     I              AFR9ST                          WIR9ST
     I              AFSAST                          WISAST
     I              AFSBST                          WISBST
     I              AFSDST                          WISDST
     I              AFSEST                          WISEST
     I              AFSFST                          WISFST
     I              AFHWNB                          WIHWNB
     I              AFFUCD                          WIFUCD
     I              AFAAVN                          WIAAVN
     I              AFAADT                          WIAADT
     I              AFAMTM                          WIAMTM
     I              AFAJST                          WIAJST
     I              AFAHVN                          WIAHVN
     I              AFAGVN                          WIAGVN
     I              AFABVN                          WIABVN
     I              AFABDT                          WIABDT
     I              AFABTM                          WIABTM
      *
     I@ADREAF
      * Hog Buyer                 Retrieval index
      * Renamed input format fields
     I              ADACCD                          WJACCD
     I              ADALTX                          WJALTX
     I              ADAQST                          WJAQST
     I              ADARST                          WJARST
     I              ADAAVN                          WJAAVN
     I              ADAADT                          WJAADT
     I              ADAMTM                          WJAMTM
     I              ADAJST                          WJAJST
     I              ADAHVN                          WJAHVN
     I              ADAGVN                          WJAGVN
     I              ADABVN                          WJABVN
     I              ADABDT                          WJABDT
     I              ADABTM                          WJABTM
      *
     I@AIREA9
      * Genetic                   Retrieval index
      * Renamed input format fields
     I              AIAGCD                          WKAGCD
     I              AIAWTX                          WKAWTX
     I              AIAAVN                          WKAAVN
     I              AIAADT                          WKAADT
     I              AIAMTM                          WKAMTM
     I              AIAJST                          WKAJST
     I              AIAHVN                          WKAHVN
     I              AIAGVN                          WKAGVN
     I              AIABVN                          WKABVN
     I              AIABDT                          WKABDT
     I              AIABTM                          WKABTM
      *
     I@A8REDA
      * Hog Classification        Retrieval index
      * Renamed input format fields
     I              A8BECD                          WLBECD
     I              A8BDTX                          WLBDTX
     I              A8BXST                          WLBXST
     I              A8BYST                          WLBYST
     I              A8BITX                          WLBITX
     I              A8B0ST                          WLB0ST
     I              A8FBST                          WLFBST
     I              A8AAVN                          WLAAVN
     I              A8AADT                          WLAADT
     I              A8AMTM                          WLAMTM
     I              A8AJST                          WLAJST
     I              A8AHVN                          WLAHVN
     I              A8AGVN                          WLAGVN
     I              A8ABVN                          WLABVN
     I              A8ABDT                          WLABDT
     I              A8ABTM                          WLABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
      * Outward parameters
     IPARC        DS                            583
      * RCD : Tattoo Header             Retrieval index
      * I :  BOH Company Number
     I                                    P   1   20PAHMNB
      * I :  BOH Buy Order Number
     I                                    P   3   60PABNNB
      * I :  BOL Load Number
     I                                    P   7   90PABONB
      * I :  TH Tattoo Number
     I                                    P  10  120PACVNB
      * I :  TH Kill Date
     I                                    P  13  160PAB0DT
      * I :  TH Purchase Date
     I                                    P  17  200PAAWDT
      * I :  TH Group Reference
     I                                       21  30 PABICD
      * I :  TH Live Purchase UOM
     I                                       31  32 PACPST
      * I :  TH Live Purchase Price
     I                                    P  33  352PAACPR
      * I :  TH Live Gross Amt
     I                                    P  36  392PAB9PR
      * I :  TH LIve Net Amt
     I                                    P  40  432PACAPR
      * I :  TH Resale UOM
     I                                       44  45 PAC4ST
      * I :  TH Recalc Live Wgt Yld
     I                                    P  46  482PAAIPR
      * I :  TH Pricing Date
     I                                    P  49  520PAA6DT
      * I :  TH Resale Spread Sts
     I                                       53  53 PAC2ST
      * I :  TH Dead On Arrival
     I                                    P  54  560PACXNB
      * I :  TH Head Received
     I                                    P  57  590PACWNB
      * I :  TH Yard Deads
     I                                    P  60  620PAFCNB
      * I :  TH Held Over
     I                                    P  63  650PAH9NB
      * I :  TH Head Condemned
     I                                    P  66  680PAFDNB
      * I :  TH Head Killed
     I                                    P  69  710PAFENB
      * I :  TH Head Adds
     I                                    P  72  740PAHENB
      * I :  TH Head Accepted
     I                                    P  75  770PAHFNB
      * I :  TH Live Wgt
     I                                    P  78  811PACYNB
      * I :  TH Adj Live Wgt
     I                                    P  82  851PALRNB
      * I :  TH Hot Wgt
     I                                    P  86  891PAE0NB
      * I :  TH Tot Loin Eye Depth
     I                                    P  90  931PAA5PC
      * I :  TH Tot Backfat Inches
     I                                    P  94  971PAFBNB
      * I :  TH Tot Light Reflectance
     I                                    P  98 1011PAA4PC
      * I :  TH Avg Live Wgt
     I                                    P 102 1041PAF7NB
      * I :  TH Avg Hot Wgt
     I                                    P 105 1071PAHDNB
      * I :  TH Avg Light Reflectance
     I                                    P 108 1091PAF5NB
      * I :  TH Avg Lean Percent
     I                                    P 110 1111PAF4NB
      * I :  TH Avg Loin Eye Depth
     I                                    P 112 1131PAF3NB
      * I :  TH Avg Backfat
     I                                    P 114 1151PAF2NB
      * I :  TH Std Yield Percent
     I                                    P 116 1182PAAVPC
      * I :  TH Actual Yield %
     I                                    P 119 1212PAAWPC
      * I :  TH Adj Actual Yield %
     I                                    P 122 1242PACWPC
      * I :  TH Yield Difference
     I                                    P 125 1272PAA8PC
      * I :  TH Recalc Live Wgt
     I                                    P 128 1291PAA7PC
      * I :  TH CM Market Price
     I                                    P 130 1322PAB8PR
      * I :  TH CM Base Mkt Price
     I                                    P 133 1352PAAMPR
      * I :  TH CM Base Mkt Price Amt
     I                                    P 136 1392PAANPR
      * I :  TH CM Sort Discount Amt
     I                                    P 140 1432PAAYVA
      * I :  TH CM Yield Gain/Loss Amt
     I                                    P 144 1472PAAWVA
      * I :  TH CM Base Carcass Value
     I                                    P 148 1512PAAOPR
      * I :  TH CM LN AddOn/Deduct Amt
     I                                    P 152 1552PAAXVA
      * I :  TH CM Carcass Gross Amt
     I                                    P 156 1592PAAPPR
      * I :  TH Deduction Amt
     I                                    P 160 1632PAASPR
      * I :  TH Total Net WO Adds
     I                                    P 164 1672PAA4VA
      * I :  TH Carcass Net Amt
     I                                    P 168 1712PAATPR
      * I :  TH Additions Amt
     I                                    P 172 1752PAA5VA
      * I :  TH Payment Gross
     I                                    P 176 1792PACBPR
      * I :  Th Payment Net Amt
     I                                    P 180 1832PACCPR
      * I :  TH AP Voucher/Document#
     I                                    P 184 1880PALPNB
      * I :  TH Freight Amount
     I                                    P 189 1922PACDPR
      * I :  TH Accrual Amount
     I                                    P 193 1962PAA7VA
      * I :  TH Fixed Cost Amount
     I                                    P 197 2002PAA2PR
      * I :  TH Calc Net Sts
     I                                      201 201 PAJWST
      * I :  TH Payment Sts
     I                                      202 203 PACWST
      * N :  TH Header Error Sts
     I                                      204 204 PAD7ST
      * N :  TH Detail Error Sts
     I                                      205 205 PAD8ST
      * N :  TH Kill Balancing Sts
     I                                      206 206 PADWST
      * I :  TH Bal to Kill Gen
     I                                      207 207 PAD6ST
      * I :  TH Commission A/P Voucher
     I                                      208 2150PAGHNB
      * I :  TH Voucher Payment Date
     I                                    P 216 2190PABYDT
      * I :  TH User Error Override
     I                                      220 220 PAE0ST
      * I :  TH Held Over Record
     I                                      221 221 PAE1ST
      * I :  TH Sex
     I                                      222 222 PAE2ST
      * I :  TH Held/Ovr Completed Dte
     I                                    P 223 2260PABSDT
      * I :  TH Commission Paid Date
     I                                    P 227 2300PABTDT
      * I :  TH Actual Check Date
     I                                    P 231 2340PABUDT
      * I :  TH Shipped Weight
     I                                    P 235 2381PAHGNB
      * I :  TH Avg Hot Wgt EXC/ADD
     I                                    P 239 2421PAHHNB
      * I :  TH FFLI
     I                                    P 243 2441PAHINB
      * I :  TH Kill Product Value
     I                                    P 245 2482PAA3PR
      * I :  TH Cut Product Value
     I                                    P 249 2522PAA4PR
      * I :  TH Render Product Value
     I                                    P 253 2562PAA6PR
      * I :  TH Head Excluded
     I                                    P 257 2590PAJ9NB
      * I :  TH CM Bse Mkt Live /CWT
     I                                    P 260 2622PAD6PR
      * I :  TH CM Bse Mkt Carc /CWT
     I                                    P 263 2652PAD7PR
      * I :  TH CM Srt Dsc Live /CWT
     I                                    P 266 2682PAD8PR
      * I :  TH CM Srt Dsc Carc /CWT
     I                                    P 269 2712PAD9PR
      * I :  TH CM Yld G/L Live /CWT
     I                                    P 272 2742PAEAPR
      * I :  TH CM Yld G/L Carc /CWT
     I                                    P 275 2772PAEBPR
      * I :  TH CM Crc Val Live /CWT
     I                                    P 278 2802PAECPR
      * I :  TH CM Crc Val Carc /CWT
     I                                    P 281 2832PAEDPR
      * I :  TH CM Lean Prem Live /CWT
     I                                    P 284 2862PAEEPR
      * I :  TH CM Lean Prem Carc /CWT
     I                                    P 287 2892PAEFPR
      * I :  TH CM Gross Live /CWT
     I                                    P 290 2922PAEGPR
      * I :  TH CM Gross Carc /CWT
     I                                    P 293 2952PAEHPR
      * I :  TH Source Type
     I                                      296 296 PAKAST
      * I :  TH Scale Ticket Sts
     I                                      297 297 PAJ7ST
      * I :  TH Payment Type
     I                                      298 298 PAJ9ST
      * I :  TH HPS Movement Ref #
     I                                    P 299 3020PAOXNB
      * I :  TH Source Code
     I                                      303 305 PALKST
      * I :  TH Hog Class Type
     I                                      306 306 PALLST
      * I :  TH Posted to HPS Flag
     I                                      307 307 PAJ8ST
      * I :  TH Schedule Kill Shift
     I                                      308 308 PALIST
      * I :  TH Shift Held Over
     I                                      309 309 PALJST
      * I :  DF Defect Code
     I                                      492 497 PABDCD
      * I :  THP Process Code
     I                                      498 503 PACSCD
      * I :  PD Producer Code
     I                                      504 509 PAABCD
      * I :  PL Location Code
     I                                      510 515 PAAECD
      * I :  HB Buyer Code
     I                                      516 518 PAACCD
      * I :  GN Genetic Code
     I                                      519 523 PAAGCD
      * I :  HC Class Code
     I                                      524 526 PABECD
      * I :  RS User Changed
     I                                      527 536 PAAAVN
      * I :  RS Date Changed
     I                                    P 537 5400PAAADT
      * I :  RS Time Changed
     I                                    P 541 5440PAAMTM
      * I :  RS Record Status
     I                                      545 545 PAAJST
      * I :  RS Job
     I                                      546 555 PAAHVN
      * I :  RS Program
     I                                      556 565 PAAGVN
      * I :  RS User Added
     I                                      566 575 PAABVN
      * I :  RS Date Added
     I                                    P 576 5790PAABDT
      * I :  RS Time Added
     I                                    P 580 5830PAABTM
      *
     IQPKBV1    E DSPKBVCPL0
      * UPD : Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WDHSNB
     I              BVA9DT                          WDA9DT
     I              BVFJNB                          WDFJNB
     I              BVHCNB                          WDHCNB
     I              BVGDNB                          WDGDNB
     I              BVFINB                          WDFINB
     I              BVLKNB                          WDLKNB
     I              BVEAST                          WDEAST
     I              BVAMPC                          WDAMPC
     I              BVAIPC                          WDAIPC
     I              BVAJPC                          WDAJPC
     I              BVAKPC                          WDAKPC
     I              BVX8NB                          WDX8NB
     I              BVFVPC                          WDFVPC
     I              BVFWPC                          WDFWPC
     I              BVFXPC                          WDFXPC
     I              BVALPC                          WDALPC
     I              BVDIST                          WDDIST
     I              BVFYST                          WDFYST
     I              BVD2ST                          WDD2ST
     I              BVEHST                          WDEHST
     I              BVG1ST                          WDG1ST
     I              BVH4ST                          WDH4ST
     I              BVJLST                          WDJLST
     I              BVUUST                          WDUUST
     I              BVVHST                          WDVHST
     I              BVVIST                          WDVIST
     I              BVVJST                          WDVJST
     I              BVVKST                          WDVKST
     I              BVVLST                          WDVLST
     I              BVHMNB                          WDHMNB
     I              BVBNNB                          WDBNNB
     I              BVBONB                          WDBONB
     I              BVCVNB                          WDCVNB
     I              BVB0DT                          WDB0DT
     I              BVAAVN                          WDAAVN
     I              BVAADT                          WDAADT
     I              BVAMTM                          WDAMTM
     I              BVAJST                          WDAJST
     I              BVAHVN                          WDAHVN
     I              BVAGVN                          WDAGVN
     I              BVABVN                          WDABVN
     I              BVABDT                          WDABDT
     I              BVABTM                          WDABTM
     I              BVB8DT                          WDB8DT
     I              BVAOTM                          WDAOTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I : MAP BOH Company Number
     I                                    P   1   20P1HMNB
      * I : MAP BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I : MAP BOL Load Number
     I                                    P   7   90P1BONB
      * I : MAP TH Tattoo Number
     I                                    P  10  120P1CVNB
      * I : MAP TH Kill Date
     I                                    P  13  160P1B0DT
      * I : MAP TH Purchase Date
     I                                    P  17  200P1AWDT
      * I : MAP TH Group Reference
     I                                       21  30 P1BICD
      * I : MAP TH Live Purchase UOM
     I                                       31  32 P1CPST
      * I : MAP TH Live Purchase Price
     I                                    P  33  352P1ACPR
      * I : MAP TH Live Gross Amt
     I                                    P  36  392P1B9PR
      * I : MAP TH LIve Net Amt
     I                                    P  40  432P1CAPR
      * I : MAP TH Resale UOM
     I                                       44  45 P1C4ST
      * I : MAP TH Recalc Live Wgt Yld
     I                                    P  46  482P1AIPR
      * I : MAP TH Pricing Date
     I                                    P  49  520P1A6DT
      * I : MAP TH Resale Spread Sts
     I                                       53  53 P1C2ST
      * I : MAP TH Dead On Arrival
     I                                    P  54  560P1CXNB
      * I : MAP TH Head Received
     I                                    P  57  590P1CWNB
      * I : MAP TH Yard Deads
     I                                    P  60  620P1FCNB
      * I : MAP TH Held Over
     I                                    P  63  650P1H9NB
      * I : MAP TH Head Condemned
     I                                    P  66  680P1FDNB
      * I : MAP TH Head Killed
     I                                    P  69  710P1FENB
      * I : MAP TH Head Adds
     I                                    P  72  740P1HENB
      * I : MAP TH Head Accepted
     I                                    P  75  770P1HFNB
      * I : MAP TH Live Wgt
     I                                    P  78  811P1CYNB
      * I : MAP TH Adj Live Wgt
     I                                    P  82  851P1LRNB
      * I : MAP TH Hot Wgt
     I                                    P  86  891P1E0NB
      * I : MAP TH Tot Loin Eye Depth
     I                                    P  90  931P1A5PC
      * I : MAP TH Tot Backfat Inches
     I                                    P  94  971P1FBNB
      * I : MAP TH Tot Light Reflectance
     I                                    P  98 1011P1A4PC
      * I : MAP TH Avg Live Wgt
     I                                    P 102 1041P1F7NB
      * I : MAP TH Avg Hot Wgt
     I                                    P 105 1071P1HDNB
      * I : MAP TH Avg Light Reflectance
     I                                    P 108 1091P1F5NB
      * I : MAP TH Avg Lean Percent
     I                                    P 110 1111P1F4NB
      * I : MAP TH Avg Loin Eye Depth
     I                                    P 112 1131P1F3NB
      * I : MAP TH Avg Backfat
     I                                    P 114 1151P1F2NB
      * I : MAP TH Std Yield Percent
     I                                    P 116 1182P1AVPC
      * I : MAP TH Actual Yield %
     I                                    P 119 1212P1AWPC
      * I : MAP TH Adj Actual Yield %
     I                                    P 122 1242P1CWPC
      * I : MAP TH Yield Difference
     I                                    P 125 1272P1A8PC
      * I : MAP TH Recalc Live Wgt
     I                                    P 128 1291P1A7PC
      * I : MAP TH CM Market Price
     I                                    P 130 1322P1B8PR
      * I : MAP TH CM Base Mkt Price
     I                                    P 133 1352P1AMPR
      * I : MAP TH CM Base Mkt Price Amt
     I                                    P 136 1392P1ANPR
      * I : MAP TH CM Sort Discount Amt
     I                                    P 140 1432P1AYVA
      * I : MAP TH CM Yield Gain/Loss Amt
     I                                    P 144 1472P1AWVA
      * I : MAP TH CM Base Carcass Value
     I                                    P 148 1512P1AOPR
      * I : MAP TH CM LN AddOn/Deduct Amt
     I                                    P 152 1552P1AXVA
      * I : MAP TH CM Carcass Gross Amt
     I                                    P 156 1592P1APPR
      * I : MAP TH Deduction Amt
     I                                    P 160 1632P1ASPR
      * I : MAP TH Total Net WO Adds
     I                                    P 164 1672P1A4VA
      * I : MAP TH Carcass Net Amt
     I                                    P 168 1712P1ATPR
      * I : MAP TH Additions Amt
     I                                    P 172 1752P1A5VA
      * I : MAP TH Payment Gross
     I                                    P 176 1792P1CBPR
      * I : MAP Th Payment Net Amt
     I                                    P 180 1832P1CCPR
      * I : MAP TH AP Voucher/Document#
     I                                    P 184 1880P1LPNB
      * I : MAP TH Freight Amount
     I                                    P 189 1922P1CDPR
      * I : MAP TH Accrual Amount
     I                                    P 193 1962P1A7VA
      * I : MAP TH Fixed Cost Amount
     I                                    P 197 2002P1A2PR
      * I : MAP TH Calc Net Sts
     I                                      201 201 P1JWST
      * I : MAP TH Payment Sts
     I                                      202 203 P1CWST
      * N : MAP TH Header Error Sts
     I                                      204 204 P1D7ST
      * N : MAP TH Detail Error Sts
     I                                      205 205 P1D8ST
      * N : MAP TH Kill Balancing Sts
     I                                      206 206 P1DWST
      * I : MAP TH Bal to Kill Gen
     I                                      207 207 P1D6ST
      * I : MAP TH Commission A/P Voucher
     I                                      208 2150P1GHNB
      * I : MAP TH Voucher Payment Date
     I                                    P 216 2190P1BYDT
      * I : MAP TH User Error Override
     I                                      220 220 P1E0ST
      * I : MAP TH Held Over Record
     I                                      221 221 P1E1ST
      * I : MAP TH Sex
     I                                      222 222 P1E2ST
      * I : MAP TH Held/Ovr Completed Dte
     I                                    P 223 2260P1BSDT
      * I : MAP TH Commission Paid Date
     I                                    P 227 2300P1BTDT
      * I : MAP TH Actual Check Date
     I                                    P 231 2340P1BUDT
      * I : MAP TH Shipped Weight
     I                                    P 235 2381P1HGNB
      * I : MAP TH Avg Hot Wgt EXC/ADD
     I                                    P 239 2421P1HHNB
      * I : MAP TH FFLI
     I                                    P 243 2441P1HINB
      * I : MAP TH Kill Product Value
     I                                    P 245 2482P1A3PR
      * I : MAP TH Cut Product Value
     I                                    P 249 2522P1A4PR
      * I : MAP TH Render Product Value
     I                                    P 253 2562P1A6PR
      * I : MAP TH Head Excluded
     I                                    P 257 2590P1J9NB
      * I : MAP TH CM Bse Mkt Live /CWT
     I                                    P 260 2622P1D6PR
      * I : MAP TH CM Bse Mkt Carc /CWT
     I                                    P 263 2652P1D7PR
      * I : MAP TH CM Srt Dsc Live /CWT
     I                                    P 266 2682P1D8PR
      * I : MAP TH CM Srt Dsc Carc /CWT
     I                                    P 269 2712P1D9PR
      * I : MAP TH CM Yld G/L Live /CWT
     I                                    P 272 2742P1EAPR
      * I : MAP TH CM Yld G/L Carc /CWT
     I                                    P 275 2772P1EBPR
      * I : MAP TH CM Crc Val Live /CWT
     I                                    P 278 2802P1ECPR
      * I : MAP TH CM Crc Val Carc /CWT
     I                                    P 281 2832P1EDPR
      * I : MAP TH CM Lean Prem Live /CWT
     I                                    P 284 2862P1EEPR
      * I : MAP TH CM Lean Prem Carc /CWT
     I                                    P 287 2892P1EFPR
      * I : MAP TH CM Gross Live /CWT
     I                                    P 290 2922P1EGPR
      * I : MAP TH CM Gross Carc /CWT
     I                                    P 293 2952P1EHPR
      * I : MAP TH Source Type
     I                                      296 296 P1KAST
      * I : MAP TH Scale Ticket Sts
     I                                      297 297 P1J7ST
      * I : MAP TH Payment Type
     I                                      298 298 P1J9ST
      * I : MAP TH HPS Movement Ref #
     I                                    P 299 3020P1OXNB
      * I : MAP TH Source Code
     I                                      303 305 P1LKST
      * I : MAP TH Hog Class Type
     I                                      306 306 P1LLST
      * I : MAP TH Posted to HPS Flag
     I                                      307 307 P1J8ST
      * I : MAP TH Schedule Kill Shift
     I                                      308 308 P1LIST
      * I : MAP TH Shift Held Over
     I                                      309 309 P1LJST
      * I : MAP TH Head Identified
     I                                    P 310 3120P1KOER
      * I : MAP TH Percent Identified
     I                                    P 313 3152P1OPIR
      * I : MAP TH Percent Accepted
     I                                    P 316 3182P1OPEM
      * I : MAP DF Defect Code
     I                                      319 324 P1BDCD
      * I : MAP THP Process Code
     I                                      325 330 P1CSCD
      * I : MAP PD Producer Code
     I                                      331 336 P1ABCD
      * I : MAP PL Location Code
     I                                      337 342 P1AECD
      * I : MAP HB Buyer Code
     I                                      343 345 P1ACCD
      * I : MAP GN Genetic Code
     I                                      346 350 P1AGCD
      * I : MAP HC Class Code
     I                                      351 353 P1BECD
      * I : MAP RS User Changed
     I                                      354 363 P1AAVN
      * I : MAP RS Date Changed
     I                                    P 364 3670P1AADT
      * I : MAP RS Time Changed
     I                                    P 368 3710P1AMTM
      * I : MAP RS Record Status
     I                                      372 372 P1AJST
      * I : MAP RS Job
     I                                      373 382 P1AHVN
      * I : MAP RS Program
     I                                      383 392 P1AGVN
      * I : MAP RS User Added
     I                                      393 402 P1ABVN
      * I : MAP RS Date Added
     I                                    P 403 4060P1ABDT
      * I : MAP RS Time Added
     I                                    P 407 4100P1ABTM
     IP2PARM      DS
      * I : MAP Oms System Value Alpha
     I                                        1  40 P2EVTX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BNNB    PARM           WP0002  70       BOH Buy Order N
     C           P1BONB    PARM           WP0003  50       BOL Load Number
     C           P1CVNB    PARM           WP0004  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0005  70       TH Kill Date
     C           P1AWDT    PARM           WP0006  70       TH Purchase Dat
     C           P1BICD    PARM           WP0007 10        TH Group Refere
     C           P1CPST    PARM           WP0008  2        TH Live Purchas
     C           P1ACPR    PARM           WP0009  52       TH Live Purchas
     C           P1B9PR    PARM           WP0010  72       TH Live Gross A
     C           P1CAPR    PARM           WP0011  72       TH LIve Net Amt
     C           P1C4ST    PARM           WP0012  2        TH Resale UOM
     C           P1AIPR    PARM           WP0013  52       TH Recalc Live
     C           P1A6DT    PARM           WP0014  70       TH Pricing Date
     C           P1C2ST    PARM           WP0015  1        TH Resale Sprea
     C           P1CXNB    PARM           WP0016  50       TH Dead On Arri
     C           P1CWNB    PARM           WP0017  50       TH Head Receive
     C           P1FCNB    PARM           WP0018  50       TH Yard Deads
     C           P1H9NB    PARM           WP0019  50       TH Held Over
     C           P1FDNB    PARM           WP0020  50       TH Head Condemn
     C           P1FENB    PARM           WP0021  50       TH Head Killed
     C           P1HENB    PARM           WP0022  50       TH Head Adds
     C           P1HFNB    PARM           WP0023  50       TH Head Accepte
     C           P1CYNB    PARM           WP0024  71       TH Live Wgt
     C           P1LRNB    PARM           WP0025  71       TH Adj Live Wgt
     C           P1E0NB    PARM           WP0026  71       TH Hot Wgt
     C           P1A5PC    PARM           WP0027  61       TH Tot Loin Eye
     C           P1FBNB    PARM           WP0028  61       TH Tot Backfat
     C           P1A4PC    PARM           WP0029  61       TH Tot Light Re
     C           P1F7NB    PARM           WP0030  51       TH Avg Live Wgt
     C           P1HDNB    PARM           WP0031  51       TH Avg Hot Wgt
     C           P1F5NB    PARM           WP0032  31       TH Avg Light Re
     C           P1F4NB    PARM           WP0033  31       TH Avg Lean Per
     C           P1F3NB    PARM           WP0034  31       TH Avg Loin Eye
     C           P1F2NB    PARM           WP0035  31       TH Avg Backfat
     C           P1AVPC    PARM           WP0036  52       TH Std Yield Pe
     C           P1AWPC    PARM           WP0037  52       TH Actual Yield
     C           P1CWPC    PARM           WP0038  52       TH Adj Actual Y
     C           P1A8PC    PARM           WP0039  52       TH Yield Differ
     C           P1A7PC    PARM           WP0040  31       TH Recalc Live
     C           P1B8PR    PARM           WP0041  52       TH CM Market Pr
     C           P1AMPR    PARM           WP0042  52       TH CM Base Mkt
     C           P1ANPR    PARM           WP0043  72       TH CM Base Mkt
     C           P1AYVA    PARM           WP0044  72       TH CM Sort Disc
     C           P1AWVA    PARM           WP0045  72       TH CM Yield Gai
     C           P1AOPR    PARM           WP0046  72       TH CM Base Carc
     C           P1AXVA    PARM           WP0047  72       TH CM LN AddOn/
     C           P1APPR    PARM           WP0048  72       TH CM Carcass G
     C           P1ASPR    PARM           WP0049  72       TH Deduction Am
     C           P1A4VA    PARM           WP0050  72       TH Total Net WO
     C           P1ATPR    PARM           WP0051  72       TH Carcass Net
     C           P1A5VA    PARM           WP0052  72       TH Additions Am
     C           P1CBPR    PARM           WP0053  72       TH Payment Gros
     C           P1CCPR    PARM           WP0054  72       Th Payment Net
     C           P1LPNB    PARM           WP0055  80       TH AP Voucher/D
     C           P1CDPR    PARM           WP0056  72       TH Freight Amou
     C           P1A7VA    PARM           WP0057  72       TH Accrual Amou
     C           P1A2PR    PARM           WP0058  72       TH Fixed Cost A
     C           P1JWST    PARM           WP0059  1        TH Calc Net Sts
     C           P1CWST    PARM           WP0060  2        TH Payment Sts
     C           P1D6ST    PARM           WP0061  1        TH Bal to Kill
     C           P1GHNB    PARM           WP0062  80       TH Commission A
     C           P1BYDT    PARM           WP0063  70       TH Voucher Paym
     C           P1E0ST    PARM           WP0064  1        TH User Error O
     C           P1E1ST    PARM           WP0065  1        TH Held Over Re
     C           P1E2ST    PARM           WP0066  1        TH Sex
     C           P1BSDT    PARM           WP0067  70       TH Held/Ovr Com
     C           P1BTDT    PARM           WP0068  70       TH Commission P
     C           P1BUDT    PARM           WP0069  70       TH Actual Check
     C           P1HGNB    PARM           WP0070  71       TH Shipped Weig
     C           P1HHNB    PARM           WP0071  71       TH Avg Hot Wgt
     C           P1HINB    PARM           WP0072  31       TH FFLI
     C           P1A3PR    PARM           WP0073  72       TH Kill Product
     C           P1A4PR    PARM           WP0074  72       TH Cut Product
     C           P1A6PR    PARM           WP0075  72       TH Render Produ
     C           P1J9NB    PARM           WP0076  50       TH Head Exclude
     C           P1D6PR    PARM           WP0077  52       TH CM Bse Mkt L
     C           P1D7PR    PARM           WP0078  52       TH CM Bse Mkt C
     C           P1D8PR    PARM           WP0079  52       TH CM Srt Dsc L
     C           P1D9PR    PARM           WP0080  52       TH CM Srt Dsc C
     C           P1EAPR    PARM           WP0081  52       TH CM Yld G/L L
     C           P1EBPR    PARM           WP0082  52       TH CM Yld G/L C
     C           P1ECPR    PARM           WP0083  52       TH CM Crc Val L
     C           P1EDPR    PARM           WP0084  52       TH CM Crc Val C
     C           P1EEPR    PARM           WP0085  52       TH CM Lean Prem
     C           P1EFPR    PARM           WP0086  52       TH CM Lean Prem
     C           P1EGPR    PARM           WP0087  52       TH CM Gross Liv
     C           P1EHPR    PARM           WP0088  52       TH CM Gross Car
     C           P1KAST    PARM           WP0089  1        TH Source Type
     C           P1J7ST    PARM           WP0090  1        TH Scale Ticket
     C           P1J9ST    PARM           WP0091  1        TH Payment Type
     C           P1OXNB    PARM           WP0092  70       TH HPS Movement
     C           P1LKST    PARM           WP0093  3        TH Source Code
     C           P1LLST    PARM           WP0094  1        TH Hog Class Ty
     C           P1J8ST    PARM           WP0095  1        TH Posted to HP
     C           P1LIST    PARM           WP0096  1        TH Schedule Kil
     C           P1LJST    PARM           WP0097  1        TH Shift Held O
     C           P1KOER    PARM           WP0098  50       TH Head Identif
     C           P1OPIR    PARM           WP0099  52       TH Percent Iden
     C           P1OPEM    PARM           WP0100  52       TH Percent Acce
     C           P1BDCD    PARM           WP0101  6        DF Defect Code
     C           P1CSCD    PARM           WP0102  6        THP Process Cod
     C           P1ABCD    PARM           WP0103  6        PD Producer Cod
     C           P1AECD    PARM           WP0104  6        PL Location Cod
     C           P1ACCD    PARM           WP0105  3        HB Buyer Code
     C           P1AGCD    PARM           WP0106  5        GN Genetic Code
     C           P1BECD    PARM           WP0107  3        HC Class Code
     C           P1AAVN    PARM           WP0108 10        RS User Changed
     C           P1AADT    PARM           WP0109  70       RS Date Changed
     C           P1AMTM    PARM           WP0110  60       RS Time Changed
     C           P1AJST    PARM           WP0111  1        RS Record Statu
     C           P1AHVN    PARM           WP0112 10        RS Job
     C           P1AGVN    PARM           WP0113 10        RS Program
     C           P1ABVN    PARM           WP0114 10        RS User Added
     C           P1ABDT    PARM           WP0115  70       RS Date Added
     C           P1ABTM    PARM           WP0116  60       RS Time Added
     C           P2EVTX    PARM           WP0117 40        Oms System Valu
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Enable PUTOVR
     C                     SETON                     86
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      * Balance the Tattoo?
      * CASE: DTL.@Status (Yes/No) is Yes
     C           #DABST    IFEQ 'Y'                        *IF
      * Rtv Validation Rules  RT - Evaluation Validation  * 
     C                     EXSR SARVGN
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * First Day: Kill Date
     C                     EXSR SBRVGN
      * Bal/Val Tattoo        XF - Tattoo Header  * First Day: Kill Date
     C                     CLEARPARC
     C                     Z-ADD#1HMNB    PAHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    PABNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    PABONB           BOL Load Number
     C                     Z-ADD#1CVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADD#DCGDT    PAB0DT           TH Kill Date
     C                     Z-ADDYL0025    PAAWDT           TH Purchase Dat
     C                     MOVELYL0026    PABICD    P      TH Group Refere
     C                     MOVELYL0027    PACPST    P      TH Live Purchas
     C                     Z-ADDYL0028    PAACPR           TH Live Purchas
     C                     Z-ADDYL0029    PAB9PR           TH Live Gross A
     C                     Z-ADDYL0030    PACAPR           TH LIve Net Amt
     C                     MOVELYL0031    PAC4ST    P      TH Resale UOM
     C                     Z-ADDYL0032    PAAIPR           TH Recalc Live
     C                     Z-ADDYL0033    PAA6DT           TH Pricing Date
     C                     MOVELYL0034    PAC2ST    P      TH Resale Sprea
     C                     Z-ADDYL0035    PACXNB           TH Dead On Arri
     C                     Z-ADDYL0036    PACWNB           TH Head Receive
     C                     Z-ADDYL0037    PAFCNB           TH Yard Deads
     C                     Z-ADDYL0038    PAH9NB           TH Held Over
     C                     Z-ADDYL0039    PAFDNB           TH Head Condemn
     C                     Z-ADDYL0040    PAFENB           TH Head Killed
     C                     Z-ADDYL0041    PAHENB           TH Head Adds
     C                     Z-ADDYL0042    PAHFNB           TH Head Accepte
     C                     Z-ADDYL0043    PACYNB           TH Live Wgt
     C                     Z-ADDYL0044    PALRNB           TH Adj Live Wgt
     C                     Z-ADDYL0045    PAE0NB           TH Hot Wgt
     C                     Z-ADDYL0046    PAA5PC           TH Tot Loin Eye
     C                     Z-ADDYL0047    PAFBNB           TH Tot Backfat
     C                     Z-ADDYL0048    PAA4PC           TH Tot Light Re
     C                     Z-ADDYL0049    PAF7NB           TH Avg Live Wgt
     C                     Z-ADDYL0050    PAHDNB           TH Avg Hot Wgt
     C                     Z-ADDYL0051    PAF5NB           TH Avg Light Re
     C                     Z-ADDYL0052    PAF4NB           TH Avg Lean Per
     C                     Z-ADDYL0053    PAF3NB           TH Avg Loin Eye
     C                     Z-ADDYL0054    PAF2NB           TH Avg Backfat
     C                     Z-ADDYL0055    PAAVPC           TH Std Yield Pe
     C                     Z-ADDYL0056    PAAWPC           TH Actual Yield
     C                     Z-ADDYL0057    PACWPC           TH Adj Actual Y
     C                     Z-ADDYL0058    PAA8PC           TH Yield Differ
     C                     Z-ADDYL0059    PAA7PC           TH Recalc Live
     C                     Z-ADDYL0060    PAB8PR           TH CM Market Pr
     C                     Z-ADDYL0061    PAAMPR           TH CM Base Mkt
     C                     Z-ADDYL0062    PAANPR           TH CM Base Mkt
     C                     Z-ADDYL0063    PAAYVA           TH CM Sort Disc
     C                     Z-ADDYL0064    PAAWVA           TH CM Yield Gai
     C                     Z-ADDYL0065    PAAOPR           TH CM Base Carc
     C                     Z-ADDYL0066    PAAXVA           TH CM LN AddOn/
     C                     Z-ADDYL0067    PAAPPR           TH CM Carcass G
     C                     Z-ADDYL0068    PAASPR           TH Deduction Am
     C                     Z-ADDYL0069    PAA4VA           TH Total Net WO
     C                     Z-ADDYL0070    PAATPR           TH Carcass Net
     C                     Z-ADDYL0071    PAA5VA           TH Additions Am
     C                     Z-ADDYL0072    PACBPR           TH Payment Gros
     C                     Z-ADDYL0073    PACCPR           Th Payment Net
     C                     Z-ADDYL0074    PALPNB           TH AP Voucher/D
     C                     Z-ADDYL0075    PACDPR           TH Freight Amou
     C                     Z-ADDYL0076    PAA7VA           TH Accrual Amou
     C                     Z-ADDYL0077    PAA2PR           TH Fixed Cost A
     C                     MOVELYL0078    PAJWST    P      TH Calc Net Sts
     C                     MOVELYL0079    PACWST    P      TH Payment Sts
     C                     MOVEL*BLANK    PAD6ST    P      TH Bal to Kill
     C                     Z-ADDYL0081    PAGHNB           TH Commission A
     C                     Z-ADDYL0082    PABYDT           TH Voucher Paym
     C                     MOVELYL0083    PAE0ST    P      TH User Error O
     C                     MOVELYL0084    PAE1ST    P      TH Held Over Re
     C                     MOVELYL0085    PAE2ST    P      TH Sex
     C                     Z-ADDYL0086    PABSDT           TH Held/Ovr Com
     C                     Z-ADDYL0087    PABTDT           TH Commission P
     C                     Z-ADDYL0088    PABUDT           TH Actual Check
     C                     Z-ADDYL0089    PAHGNB           TH Shipped Weig
     C                     Z-ADDYL0090    PAHHNB           TH Avg Hot Wgt
     C                     Z-ADDYL0091    PAHINB           TH FFLI
     C                     Z-ADDYL0092    PAA3PR           TH Kill Product
     C                     Z-ADDYL0093    PAA4PR           TH Cut Product
     C                     Z-ADDYL0094    PAA6PR           TH Render Produ
     C                     Z-ADDYL0095    PAJ9NB           TH Head Exclude
     C                     Z-ADDYL0096    PAD6PR           TH CM Bse Mkt L
     C                     Z-ADDYL0097    PAD7PR           TH CM Bse Mkt C
     C                     Z-ADDYL0098    PAD8PR           TH CM Srt Dsc L
     C                     Z-ADDYL0099    PAD9PR           TH CM Srt Dsc C
     C                     Z-ADDYL0100    PAEAPR           TH CM Yld G/L L
     C                     Z-ADDYL0101    PAEBPR           TH CM Yld G/L C
     C                     Z-ADDYL0102    PAECPR           TH CM Crc Val L
     C                     Z-ADDYL0103    PAEDPR           TH CM Crc Val C
     C                     Z-ADDYL0104    PAEEPR           TH CM Lean Prem
     C                     Z-ADDYL0105    PAEFPR           TH CM Lean Prem
     C                     Z-ADDYL0106    PAEGPR           TH CM Gross Liv
     C                     Z-ADDYL0107    PAEHPR           TH CM Gross Car
     C                     MOVELYL0108    PAKAST    P      TH Source Type
     C                     MOVELYL0109    PAJ7ST    P      TH Scale Ticket
     C                     MOVELYL0110    PAJ9ST    P      TH Payment Type
     C                     Z-ADDYL0111    PAOXNB           TH HPS Movement
     C                     MOVELYL0112    PALKST    P      TH Source Code
     C                     MOVELYL0113    PALLST    P      TH Hog Class Ty
     C                     MOVELYL0114    PAJ8ST    P      TH Posted to HP
     C                     MOVELYL0115    PALIST    P      TH Schedule Kil
     C                     MOVELYL0116    PALJST    P      TH Shift Held O
     C                     MOVELYL0117    PABDCD    P      DF Defect Code
     C                     MOVELYL0118    PACSCD    P      THP Process Cod
     C                     MOVELYL0119    PAABCD    P      PD Producer Cod
     C                     MOVELYL0120    PAAECD    P      PL Location Cod
     C                     MOVELYL0121    PAACCD    P      HB Buyer Code
     C                     MOVELYL0122    PAAGCD    P      GN Genetic Code
     C                     MOVELYL0123    PABECD    P      HC Class Code
     C                     MOVELYL0124    PAAAVN    P      RS User Changed
     C                     Z-ADDYL0125    PAAADT           RS Date Changed
     C                     Z-ADDYL0126    PAAMTM           RS Time Changed
     C                     MOVELYL0127    PAAJST    P      RS Record Statu
     C                     MOVELYL0128    PAAHVN    P      RS Job
     C                     MOVELYL0129    PAAGVN    P      RS Program
     C                     MOVELYL0130    PAABVN    P      RS User Added
     C                     Z-ADDYL0131    PAABDT           RS Date Added
     C                     Z-ADDYL0132    PAABTM           RS Time Added
      *
     C                     CALL 'PKAAXFR'              90  Bal/Val Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Tattoo Hea
     C                     PARM YL0001    WQ0001  71       Carcass Dbw Min
     C                     PARM YL0002    WQ0002  71       Carcass Dbw Max
     C                     PARM YL0003    WQ0003  71       Carcass Lgt Min
     C                     PARM YL0004    WQ0004  71       Carcass Lgt Max
     C                     PARM YL0005    WQ0005  71       %Lean High Min
     C                     PARM YL0006    WQ0006  71       %Lean High Max
     C                     PARM YL0007    WQ0007  71       %Lean Low Min
     C                     PARM YL0008    WQ0008  71       %Lean Low Max
     C                     PARM YL0009    WQ0009  71       High Yield Min
     C                     PARM YL0010    WQ0010  71       High Yield Max
     C                     PARM YL0011    WQ0011  71       Low Yield Min
     C                     PARM YL0012    WQ0012  71       Low Yield Max
     C                     PARM YL0013    WQ0013  71       Head < Percent
     C                     PARM YL0014    WQ0014  71       Head < Percent
     C                     PARM YL0015    WQ0015  71       Head > Percent
     C                     PARM YL0016    WQ0016  71       Head > Percent
     C                     PARM YL0017    WQ0017  71       BackFat High Mi
     C                     PARM YL0018    WQ0018  71       BackFat High Ma
     C                     PARM YL0019    WQ0019  71       BackFat Low Min
     C                     PARM YL0020    WQ0020  71       Backfat Low Max
     C                     PARM YL0021    WQ0021  71       LoinEye High Mi
     C                     PARM YL0022    WQ0022  71       LoinEye High Ma
     C                     PARM YL0023    WQ0023  71       LoinEye Low Min
     C                     PARM YL0024    WQ0024  71       LoinEye Low Max
     C                     PARM 'N'       WQ0025  1        Requested by Us
     C                     PARM *BLANK    WQ0026  1        Bal w/History
     C                     PARM *BLANK    WQ0027  1        TH PHA Add Type
     C                     PARM *BLANK    WQ0028  3        TH PHA Average
     C                     PARM *BLANK    WQ0029  1        TH PHA Add Reas
     C                     PARM *ZERO     WQ0030  51       PH GA Avg Live
     C                     PARM *ZERO     WQ0031  52       PH GA Adjusted
     C                     PARM *ZERO     WQ0032  31       PH GA Avg Lean%
     C                     PARM *ZERO     WQ0033  31       PH GA Avg Backf
     C                     PARM *ZERO     WQ0034  31       PH GA Avg Loin
     C                     PARM *ZERO     WQ0035  31       PH GA Avg Light
     C                     PARM *ZERO     WQ0036  52       PH GA Lean Prm
     C                     PARM *ZERO     WQ0037  53       PH GA Avg Srt D
     C                     PARM 'N'       WQ0038  1        Undo MPR USR
     C           YL0133    PARM *BLANK    WQ0039  1        Balance First D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv/Trnsfr Eval Trns  RT - Tattoo Header  * 
     C                     EXSR SCRVGN
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * Second Day: TH Kill D
     C                     EXSR SNRVGN
      * Bal/Val Tattoo        XF - Tattoo Header  * Second Day: TH Kill D
     C                     CLEARPARC
     C                     Z-ADD#1HMNB    PAHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    PABNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    PABONB           BOL Load Number
     C                     Z-ADD#1CVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    PAB0DT           TH Kill Date
     C                     Z-ADDYL0025    PAAWDT           TH Purchase Dat
     C                     MOVELYL0026    PABICD    P      TH Group Refere
     C                     MOVELYL0027    PACPST    P      TH Live Purchas
     C                     Z-ADDYL0028    PAACPR           TH Live Purchas
     C                     Z-ADDYL0029    PAB9PR           TH Live Gross A
     C                     Z-ADDYL0030    PACAPR           TH LIve Net Amt
     C                     MOVELYL0031    PAC4ST    P      TH Resale UOM
     C                     Z-ADDYL0032    PAAIPR           TH Recalc Live
     C                     Z-ADDYL0033    PAA6DT           TH Pricing Date
     C                     MOVELYL0034    PAC2ST    P      TH Resale Sprea
     C                     Z-ADDYL0035    PACXNB           TH Dead On Arri
     C                     Z-ADDYL0036    PACWNB           TH Head Receive
     C                     Z-ADDYL0037    PAFCNB           TH Yard Deads
     C                     Z-ADDYL0038    PAH9NB           TH Held Over
     C                     Z-ADDYL0039    PAFDNB           TH Head Condemn
     C                     Z-ADDYL0040    PAFENB           TH Head Killed
     C                     Z-ADDYL0041    PAHENB           TH Head Adds
     C                     Z-ADDYL0042    PAHFNB           TH Head Accepte
     C                     Z-ADDYL0043    PACYNB           TH Live Wgt
     C                     Z-ADDYL0044    PALRNB           TH Adj Live Wgt
     C                     Z-ADDYL0045    PAE0NB           TH Hot Wgt
     C                     Z-ADDYL0046    PAA5PC           TH Tot Loin Eye
     C                     Z-ADDYL0047    PAFBNB           TH Tot Backfat
     C                     Z-ADDYL0048    PAA4PC           TH Tot Light Re
     C                     Z-ADDYL0049    PAF7NB           TH Avg Live Wgt
     C                     Z-ADDYL0050    PAHDNB           TH Avg Hot Wgt
     C                     Z-ADDYL0051    PAF5NB           TH Avg Light Re
     C                     Z-ADDYL0052    PAF4NB           TH Avg Lean Per
     C                     Z-ADDYL0053    PAF3NB           TH Avg Loin Eye
     C                     Z-ADDYL0054    PAF2NB           TH Avg Backfat
     C                     Z-ADDYL0055    PAAVPC           TH Std Yield Pe
     C                     Z-ADDYL0056    PAAWPC           TH Actual Yield
     C                     Z-ADDYL0057    PACWPC           TH Adj Actual Y
     C                     Z-ADDYL0058    PAA8PC           TH Yield Differ
     C                     Z-ADDYL0059    PAA7PC           TH Recalc Live
     C                     Z-ADDYL0060    PAB8PR           TH CM Market Pr
     C                     Z-ADDYL0061    PAAMPR           TH CM Base Mkt
     C                     Z-ADDYL0062    PAANPR           TH CM Base Mkt
     C                     Z-ADDYL0063    PAAYVA           TH CM Sort Disc
     C                     Z-ADDYL0064    PAAWVA           TH CM Yield Gai
     C                     Z-ADDYL0065    PAAOPR           TH CM Base Carc
     C                     Z-ADDYL0066    PAAXVA           TH CM LN AddOn/
     C                     Z-ADDYL0067    PAAPPR           TH CM Carcass G
     C                     Z-ADDYL0068    PAASPR           TH Deduction Am
     C                     Z-ADDYL0069    PAA4VA           TH Total Net WO
     C                     Z-ADDYL0070    PAATPR           TH Carcass Net
     C                     Z-ADDYL0071    PAA5VA           TH Additions Am
     C                     Z-ADDYL0072    PACBPR           TH Payment Gros
     C                     Z-ADDYL0073    PACCPR           Th Payment Net
     C                     Z-ADDYL0074    PALPNB           TH AP Voucher/D
     C                     Z-ADDYL0075    PACDPR           TH Freight Amou
     C                     Z-ADDYL0076    PAA7VA           TH Accrual Amou
     C                     Z-ADDYL0077    PAA2PR           TH Fixed Cost A
     C                     MOVELYL0078    PAJWST    P      TH Calc Net Sts
     C                     MOVELYL0079    PACWST    P      TH Payment Sts
     C                     MOVELYL0080    PAD6ST    P      TH Bal to Kill
     C                     Z-ADDYL0081    PAGHNB           TH Commission A
     C                     Z-ADDYL0082    PABYDT           TH Voucher Paym
     C                     MOVELYL0083    PAE0ST    P      TH User Error O
     C                     MOVELYL0084    PAE1ST    P      TH Held Over Re
     C                     MOVELYL0085    PAE2ST    P      TH Sex
     C                     Z-ADDYL0086    PABSDT           TH Held/Ovr Com
     C                     Z-ADDYL0087    PABTDT           TH Commission P
     C                     Z-ADDYL0088    PABUDT           TH Actual Check
     C                     Z-ADDYL0089    PAHGNB           TH Shipped Weig
     C                     Z-ADDYL0090    PAHHNB           TH Avg Hot Wgt
     C                     Z-ADDYL0091    PAHINB           TH FFLI
     C                     Z-ADDYL0092    PAA3PR           TH Kill Product
     C                     Z-ADDYL0093    PAA4PR           TH Cut Product
     C                     Z-ADDYL0094    PAA6PR           TH Render Produ
     C                     Z-ADDYL0095    PAJ9NB           TH Head Exclude
     C                     Z-ADDYL0096    PAD6PR           TH CM Bse Mkt L
     C                     Z-ADDYL0097    PAD7PR           TH CM Bse Mkt C
     C                     Z-ADDYL0098    PAD8PR           TH CM Srt Dsc L
     C                     Z-ADDYL0099    PAD9PR           TH CM Srt Dsc C
     C                     Z-ADDYL0100    PAEAPR           TH CM Yld G/L L
     C                     Z-ADDYL0101    PAEBPR           TH CM Yld G/L C
     C                     Z-ADDYL0102    PAECPR           TH CM Crc Val L
     C                     Z-ADDYL0103    PAEDPR           TH CM Crc Val C
     C                     Z-ADDYL0104    PAEEPR           TH CM Lean Prem
     C                     Z-ADDYL0105    PAEFPR           TH CM Lean Prem
     C                     Z-ADDYL0106    PAEGPR           TH CM Gross Liv
     C                     Z-ADDYL0107    PAEHPR           TH CM Gross Car
     C                     MOVELYL0108    PAKAST    P      TH Source Type
     C                     MOVELYL0109    PAJ7ST    P      TH Scale Ticket
     C                     MOVELYL0110    PAJ9ST    P      TH Payment Type
     C                     Z-ADDYL0111    PAOXNB           TH HPS Movement
     C                     MOVELYL0112    PALKST    P      TH Source Code
     C                     MOVELYL0113    PALLST    P      TH Hog Class Ty
     C                     MOVELYL0114    PAJ8ST    P      TH Posted to HP
     C                     MOVELYL0115    PALIST    P      TH Schedule Kil
     C                     MOVELYL0116    PALJST    P      TH Shift Held O
     C                     MOVELYL0117    PABDCD    P      DF Defect Code
     C                     MOVELYL0118    PACSCD    P      THP Process Cod
     C                     MOVELYL0119    PAABCD    P      PD Producer Cod
     C                     MOVELYL0120    PAAECD    P      PL Location Cod
     C                     MOVELYL0121    PAACCD    P      HB Buyer Code
     C                     MOVELYL0122    PAAGCD    P      GN Genetic Code
     C                     MOVELYL0123    PABECD    P      HC Class Code
     C                     MOVELYL0124    PAAAVN    P      RS User Changed
     C                     Z-ADDYL0125    PAAADT           RS Date Changed
     C                     Z-ADDYL0126    PAAMTM           RS Time Changed
     C                     MOVELYL0127    PAAJST    P      RS Record Statu
     C                     MOVELYL0128    PAAHVN    P      RS Job
     C                     MOVELYL0129    PAAGVN    P      RS Program
     C                     MOVELYL0130    PAABVN    P      RS User Added
     C                     Z-ADDYL0131    PAABDT           RS Date Added
     C                     Z-ADDYL0132    PAABTM           RS Time Added
      *
     C                     CALL 'PKAAXFR'              90  Bal/Val Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Tattoo Hea
     C                     PARM YL0001    WQ0118  71       Carcass Dbw Min
     C                     PARM YL0002    WQ0119  71       Carcass Dbw Max
     C                     PARM YL0003    WQ0120  71       Carcass Lgt Min
     C                     PARM YL0004    WQ0121  71       Carcass Lgt Max
     C                     PARM YL0005    WQ0122  71       %Lean High Min
     C                     PARM YL0006    WQ0123  71       %Lean High Max
     C                     PARM YL0007    WQ0124  71       %Lean Low Min
     C                     PARM YL0008    WQ0125  71       %Lean Low Max
     C                     PARM YL0009    WQ0126  71       High Yield Min
     C                     PARM YL0010    WQ0127  71       High Yield Max
     C                     PARM YL0011    WQ0128  71       Low Yield Min
     C                     PARM YL0012    WQ0129  71       Low Yield Max
     C                     PARM YL0013    WQ0130  71       Head < Percent
     C                     PARM YL0014    WQ0131  71       Head < Percent
     C                     PARM YL0015    WQ0132  71       Head > Percent
     C                     PARM YL0016    WQ0133  71       Head > Percent
     C                     PARM YL0017    WQ0134  71       BackFat High Mi
     C                     PARM YL0018    WQ0135  71       BackFat High Ma
     C                     PARM YL0019    WQ0136  71       BackFat Low Min
     C                     PARM YL0020    WQ0137  71       Backfat Low Max
     C                     PARM YL0021    WQ0138  71       LoinEye High Mi
     C                     PARM YL0022    WQ0139  71       LoinEye High Ma
     C                     PARM YL0023    WQ0140  71       LoinEye Low Min
     C                     PARM YL0024    WQ0141  71       LoinEye Low Max
     C                     PARM 'N'       WQ0142  1        Requested by Us
     C                     PARM *BLANK    WQ0143  1        Bal w/History
     C                     PARM *BLANK    WQ0144  1        TH PHA Add Type
     C                     PARM *BLANK    WQ0145  3        TH PHA Average
     C                     PARM *BLANK    WQ0146  1        TH PHA Add Reas
     C                     PARM *ZERO     WQ0147  51       PH GA Avg Live
     C                     PARM *ZERO     WQ0148  52       PH GA Adjusted
     C                     PARM *ZERO     WQ0149  31       PH GA Avg Lean%
     C                     PARM *ZERO     WQ0150  31       PH GA Avg Backf
     C                     PARM *ZERO     WQ0151  31       PH GA Avg Loin
     C                     PARM *ZERO     WQ0152  31       PH GA Avg Light
     C                     PARM *ZERO     WQ0153  52       PH GA Lean Prm
     C                     PARM *ZERO     WQ0154  53       PH GA Avg Srt D
     C                     PARM 'N'       WQ0155  1        Undo MPR USR
     C           YL0133    PARM *BLANK    WQ0156  1        Balance First D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rebalance First Day w/Request by User Balance = Yes
      * CASE: LCL.Balance First Day USR is Yes
     C           YL0133    IFEQ 'Y'                        *IF
      * Rtv Balance Info      RT - Tattoo Header  * 
     C                     EXSR SORVGN
      * CASE: LCL.TH PHA Add Type is Historical Avg Balanced
     C           YL0140    IFEQ 'B'                        *IF
     C           YL0140    OREQ 'E'
     C                     MOVEL'P'       YL0143           Bal w/History
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
     C                     EXSR SPRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0143           Bal w/History
     C                     END                             *FI
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * Kill Date USR
     C                     EXSR SQRVGN
      * Bal/Val Tattoo        XF - Tattoo Header  * Kill Date USR
     C                     CLEARPARC
     C                     Z-ADD#1HMNB    PAHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    PABNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    PABONB           BOL Load Number
     C                     Z-ADD#1CVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADD#DCGDT    PAB0DT           TH Kill Date
     C                     Z-ADDYL0025    PAAWDT           TH Purchase Dat
     C                     MOVELYL0026    PABICD    P      TH Group Refere
     C                     MOVELYL0027    PACPST    P      TH Live Purchas
     C                     Z-ADDYL0028    PAACPR           TH Live Purchas
     C                     Z-ADDYL0029    PAB9PR           TH Live Gross A
     C                     Z-ADDYL0030    PACAPR           TH LIve Net Amt
     C                     MOVELYL0031    PAC4ST    P      TH Resale UOM
     C                     Z-ADDYL0032    PAAIPR           TH Recalc Live
     C                     Z-ADDYL0033    PAA6DT           TH Pricing Date
     C                     MOVELYL0034    PAC2ST    P      TH Resale Sprea
     C                     Z-ADDYL0035    PACXNB           TH Dead On Arri
     C                     Z-ADDYL0036    PACWNB           TH Head Receive
     C                     Z-ADDYL0037    PAFCNB           TH Yard Deads
     C                     Z-ADDYL0038    PAH9NB           TH Held Over
     C                     Z-ADDYL0039    PAFDNB           TH Head Condemn
     C                     Z-ADDYL0040    PAFENB           TH Head Killed
     C                     Z-ADDYL0041    PAHENB           TH Head Adds
     C                     Z-ADDYL0042    PAHFNB           TH Head Accepte
     C                     Z-ADDYL0043    PACYNB           TH Live Wgt
     C                     Z-ADDYL0044    PALRNB           TH Adj Live Wgt
     C                     Z-ADDYL0045    PAE0NB           TH Hot Wgt
     C                     Z-ADDYL0046    PAA5PC           TH Tot Loin Eye
     C                     Z-ADDYL0047    PAFBNB           TH Tot Backfat
     C                     Z-ADDYL0048    PAA4PC           TH Tot Light Re
     C                     Z-ADDYL0049    PAF7NB           TH Avg Live Wgt
     C                     Z-ADDYL0050    PAHDNB           TH Avg Hot Wgt
     C                     Z-ADDYL0051    PAF5NB           TH Avg Light Re
     C                     Z-ADDYL0052    PAF4NB           TH Avg Lean Per
     C                     Z-ADDYL0053    PAF3NB           TH Avg Loin Eye
     C                     Z-ADDYL0054    PAF2NB           TH Avg Backfat
     C                     Z-ADDYL0055    PAAVPC           TH Std Yield Pe
     C                     Z-ADDYL0056    PAAWPC           TH Actual Yield
     C                     Z-ADDYL0057    PACWPC           TH Adj Actual Y
     C                     Z-ADDYL0058    PAA8PC           TH Yield Differ
     C                     Z-ADDYL0059    PAA7PC           TH Recalc Live
     C                     Z-ADDYL0060    PAB8PR           TH CM Market Pr
     C                     Z-ADDYL0061    PAAMPR           TH CM Base Mkt
     C                     Z-ADDYL0062    PAANPR           TH CM Base Mkt
     C                     Z-ADDYL0063    PAAYVA           TH CM Sort Disc
     C                     Z-ADDYL0064    PAAWVA           TH CM Yield Gai
     C                     Z-ADDYL0065    PAAOPR           TH CM Base Carc
     C                     Z-ADDYL0066    PAAXVA           TH CM LN AddOn/
     C                     Z-ADDYL0067    PAAPPR           TH CM Carcass G
     C                     Z-ADDYL0068    PAASPR           TH Deduction Am
     C                     Z-ADDYL0069    PAA4VA           TH Total Net WO
     C                     Z-ADDYL0070    PAATPR           TH Carcass Net
     C                     Z-ADDYL0071    PAA5VA           TH Additions Am
     C                     Z-ADDYL0072    PACBPR           TH Payment Gros
     C                     Z-ADDYL0073    PACCPR           Th Payment Net
     C                     Z-ADDYL0074    PALPNB           TH AP Voucher/D
     C                     Z-ADDYL0075    PACDPR           TH Freight Amou
     C                     Z-ADDYL0076    PAA7VA           TH Accrual Amou
     C                     Z-ADDYL0077    PAA2PR           TH Fixed Cost A
     C                     MOVELYL0078    PAJWST    P      TH Calc Net Sts
     C                     MOVELYL0079    PACWST    P      TH Payment Sts
     C                     MOVELYL0080    PAD6ST    P      TH Bal to Kill
     C                     Z-ADDYL0081    PAGHNB           TH Commission A
     C                     Z-ADDYL0082    PABYDT           TH Voucher Paym
     C                     MOVELYL0083    PAE0ST    P      TH User Error O
     C                     MOVELYL0084    PAE1ST    P      TH Held Over Re
     C                     MOVELYL0085    PAE2ST    P      TH Sex
     C                     Z-ADDYL0086    PABSDT           TH Held/Ovr Com
     C                     Z-ADDYL0087    PABTDT           TH Commission P
     C                     Z-ADDYL0088    PABUDT           TH Actual Check
     C                     Z-ADDYL0089    PAHGNB           TH Shipped Weig
     C                     Z-ADDYL0090    PAHHNB           TH Avg Hot Wgt
     C                     Z-ADDYL0091    PAHINB           TH FFLI
     C                     Z-ADDYL0092    PAA3PR           TH Kill Product
     C                     Z-ADDYL0093    PAA4PR           TH Cut Product
     C                     Z-ADDYL0094    PAA6PR           TH Render Produ
     C                     Z-ADDYL0095    PAJ9NB           TH Head Exclude
     C                     Z-ADDYL0096    PAD6PR           TH CM Bse Mkt L
     C                     Z-ADDYL0097    PAD7PR           TH CM Bse Mkt C
     C                     Z-ADDYL0098    PAD8PR           TH CM Srt Dsc L
     C                     Z-ADDYL0099    PAD9PR           TH CM Srt Dsc C
     C                     Z-ADDYL0100    PAEAPR           TH CM Yld G/L L
     C                     Z-ADDYL0101    PAEBPR           TH CM Yld G/L C
     C                     Z-ADDYL0102    PAECPR           TH CM Crc Val L
     C                     Z-ADDYL0103    PAEDPR           TH CM Crc Val C
     C                     Z-ADDYL0104    PAEEPR           TH CM Lean Prem
     C                     Z-ADDYL0105    PAEFPR           TH CM Lean Prem
     C                     Z-ADDYL0106    PAEGPR           TH CM Gross Liv
     C                     Z-ADDYL0107    PAEHPR           TH CM Gross Car
     C                     MOVELYL0108    PAKAST    P      TH Source Type
     C                     MOVELYL0109    PAJ7ST    P      TH Scale Ticket
     C                     MOVELYL0110    PAJ9ST    P      TH Payment Type
     C                     Z-ADDYL0111    PAOXNB           TH HPS Movement
     C                     MOVELYL0112    PALKST    P      TH Source Code
     C                     MOVELYL0113    PALLST    P      TH Hog Class Ty
     C                     MOVELYL0114    PAJ8ST    P      TH Posted to HP
     C                     MOVELYL0115    PALIST    P      TH Schedule Kil
     C                     MOVELYL0116    PALJST    P      TH Shift Held O
     C                     MOVELYL0117    PABDCD    P      DF Defect Code
     C                     MOVELYL0118    PACSCD    P      THP Process Cod
     C                     MOVELYL0119    PAABCD    P      PD Producer Cod
     C                     MOVELYL0120    PAAECD    P      PL Location Cod
     C                     MOVELYL0121    PAACCD    P      HB Buyer Code
     C                     MOVELYL0122    PAAGCD    P      GN Genetic Code
     C                     MOVELYL0123    PABECD    P      HC Class Code
     C                     MOVELYL0124    PAAAVN    P      RS User Changed
     C                     Z-ADDYL0125    PAAADT           RS Date Changed
     C                     Z-ADDYL0126    PAAMTM           RS Time Changed
     C                     MOVELYL0127    PAAJST    P      RS Record Statu
     C                     MOVELYL0128    PAAHVN    P      RS Job
     C                     MOVELYL0129    PAAGVN    P      RS Program
     C                     MOVELYL0130    PAABVN    P      RS User Added
     C                     Z-ADDYL0131    PAABDT           RS Date Added
     C                     Z-ADDYL0132    PAABTM           RS Time Added
      *
     C                     CALL 'PKAAXFR'              90  Bal/Val Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Tattoo Hea
     C                     PARM YL0001    WQ0157  71       Carcass Dbw Min
     C                     PARM YL0002    WQ0158  71       Carcass Dbw Max
     C                     PARM YL0003    WQ0159  71       Carcass Lgt Min
     C                     PARM YL0004    WQ0160  71       Carcass Lgt Max
     C                     PARM YL0005    WQ0161  71       %Lean High Min
     C                     PARM YL0006    WQ0162  71       %Lean High Max
     C                     PARM YL0007    WQ0163  71       %Lean Low Min
     C                     PARM YL0008    WQ0164  71       %Lean Low Max
     C                     PARM YL0009    WQ0165  71       High Yield Min
     C                     PARM YL0010    WQ0166  71       High Yield Max
     C                     PARM YL0011    WQ0167  71       Low Yield Min
     C                     PARM YL0012    WQ0168  71       Low Yield Max
     C                     PARM YL0013    WQ0169  71       Head < Percent
     C                     PARM YL0014    WQ0170  71       Head < Percent
     C                     PARM YL0015    WQ0171  71       Head > Percent
     C                     PARM YL0016    WQ0172  71       Head > Percent
     C                     PARM YL0017    WQ0173  71       BackFat High Mi
     C                     PARM YL0018    WQ0174  71       BackFat High Ma
     C                     PARM YL0019    WQ0175  71       BackFat Low Min
     C                     PARM YL0020    WQ0176  71       Backfat Low Max
     C                     PARM YL0021    WQ0177  71       LoinEye High Mi
     C                     PARM YL0022    WQ0178  71       LoinEye High Ma
     C                     PARM YL0023    WQ0179  71       LoinEye Low Min
     C                     PARM YL0024    WQ0180  71       LoinEye Low Max
     C                     PARM 'Y'       WQ0181  1        Requested by Us
     C                     PARM YL0143    WQ0182  1        Bal w/History
     C                     PARM YL0140    WQ0183  1        TH PHA Add Type
     C                     PARM YL0141    WQ0184  3        TH PHA Average
     C                     PARM YL0142    WQ0185  1        TH PHA Add Reas
     C                     PARM YL0145    WQ0186  51       PH GA Avg Live
     C                     PARM YL0146    WQ0187  52       PH GA Adjusted
     C                     PARM YL0147    WQ0188  31       PH GA Avg Lean%
     C                     PARM YL0148    WQ0189  31       PH GA Avg Backf
     C                     PARM YL0149    WQ0190  31       PH GA Avg Loin
     C                     PARM YL0150    WQ0191  31       PH GA Avg Light
     C                     PARM YL0151    WQ0192  52       PH GA Lean Prm
     C                     PARM YL0152    WQ0193  53       PH GA Avg Srt D
     C                     PARM 'N'       WQ0194  1        Undo MPR USR
     C           YL0133    PARM *BLANK    WQ0195  1        Balance First D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate @Status (Yes/No)
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DABST'  IFEQ YPMTFD
      * @Status (Yes/No)
     C                     MOVEL#DABST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHABST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZHABST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZHABST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZHABST
     C           W0INVL    WHEQ 'L'                        L
     C                     Z-ADD4         ZHABST
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD5         ZHABST
     C           W0INVL    WHEQ 'O'                        O
     C                     Z-ADD6         ZHABST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD7         ZHABST
     C           W0INVL    WHEQ 'R'                        R
     C                     Z-ADD8         ZHABST
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD9         ZHABST
     C                     ENDSL
     C                     EXFMTZGABST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHABST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHABST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZHABST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZHABST    WHEQ 4
     C                     MOVEL'L'       W0INVL           L
     C           ZHABST    WHEQ 5
     C                     MOVEL'E'       W0INVL           E
     C           ZHABST    WHEQ 6
     C                     MOVEL'O'       W0INVL           O
     C           ZHABST    WHEQ 7
     C                     MOVEL'I'       W0INVL           I
     C           ZHABST    WHEQ 8
     C                     MOVEL'R'       W0INVL           R
     C           ZHABST    WHEQ 9
     C                     MOVEL'P'       W0INVL           P
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DABST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
      * Check reference to Buy Order Load
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Hog Defect
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Tattoo Header Process
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Producer Location
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Hog Buyer
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Genetic
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Hog Classification
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * @Status (Yes/No) required
     C           #DABST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Update screen time
     C                     TIME           ##TME
      * Enable PUTOVR
     C                     SETON                         86*
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     MOVELP2EVTX    #PEVTX           Oms System Valu
     C                     Z-ADD*ZERO     #DTCHD           Transfer Carcas
     C                     MOVEL*BLANK    #1OQET           TH PHA Add Type
     C                     MOVEL*BLANK    #1USST           TH PHA Add Reas
     C                     MOVEL*BLANK    #1URST           TH PHA Average
     C                     Z-ADDP1EFPR    #1EFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     #DTSPR           CM Lean Prem Ca
     C                     Z-ADDP1F2NB    #1F2NB           TH Avg Backfat
     C                     Z-ADDP1F3NB    #1F3NB           TH Avg Loin Eye
     C                     Z-ADDP1AWDT    #1AWDT           TH Purchase Dat
     C                     MOVELP1BICD    #1BICD           TH Group Refere
     C                     MOVELP1CPST    #1CPST           TH Live Purchas
     C                     Z-ADDP1ACPR    #1ACPR           TH Live Purchas
     C                     Z-ADDP1B9PR    #1B9PR           TH Live Gross A
     C                     Z-ADDP1CAPR    #1CAPR           TH LIve Net Amt
     C                     MOVELP1C4ST    #1C4ST           TH Resale UOM
     C                     Z-ADDP1AIPR    #1AIPR           TH Recalc Live
     C                     Z-ADDP1A6DT    #1A6DT           TH Pricing Date
     C                     MOVELP1C2ST    #1C2ST           TH Resale Sprea
     C                     Z-ADDP1CXNB    #1CXNB           TH Dead On Arri
     C                     Z-ADDP1CWNB    #1CWNB           TH Head Receive
     C                     Z-ADDP1FCNB    #1FCNB           TH Yard Deads
     C                     Z-ADDP1H9NB    #1H9NB           TH Held Over
     C                     Z-ADDP1FDNB    #1FDNB           TH Head Condemn
     C                     Z-ADDP1HENB    #1HENB           TH Head Adds
     C                     Z-ADDP1CYNB    #1CYNB           TH Live Wgt
     C                     Z-ADDP1LRNB    #1LRNB           TH Adj Live Wgt
     C                     Z-ADDP1E0NB    #1E0NB           TH Hot Wgt
     C                     Z-ADDP1A5PC    #1A5PC           TH Tot Loin Eye
     C                     Z-ADDP1FBNB    #1FBNB           TH Tot Backfat
     C                     Z-ADDP1A4PC    #1A4PC           TH Tot Light Re
     C                     Z-ADDP1F7NB    #1F7NB           TH Avg Live Wgt
     C                     Z-ADDP1HDNB    #1HDNB           TH Avg Hot Wgt
     C                     Z-ADDP1F5NB    #1F5NB           TH Avg Light Re
     C                     Z-ADDP1F4NB    #1F4NB           TH Avg Lean Per
     C                     Z-ADDP1AVPC    #1AVPC           TH Std Yield Pe
     C                     Z-ADDP1AWPC    #1AWPC           TH Actual Yield
     C                     Z-ADDP1A8PC    #1A8PC           TH Yield Differ
     C                     Z-ADDP1A7PC    #1A7PC           TH Recalc Live
     C                     Z-ADDP1B8PR    #1B8PR           TH CM Market Pr
     C                     Z-ADDP1AMPR    #1AMPR           TH CM Base Mkt
     C                     Z-ADDP1ANPR    #1ANPR           TH CM Base Mkt
     C                     Z-ADDP1AYVA    #1AYVA           TH CM Sort Disc
     C                     Z-ADDP1AWVA    #1AWVA           TH CM Yield Gai
     C                     Z-ADDP1AOPR    #1AOPR           TH CM Base Carc
     C                     Z-ADDP1AXVA    #1AXVA           TH CM LN AddOn/
     C                     Z-ADDP1APPR    #1APPR           TH CM Carcass G
     C                     Z-ADDP1ASPR    #1ASPR           TH Deduction Am
     C                     Z-ADDP1A4VA    #1A4VA           TH Total Net WO
     C                     Z-ADDP1ATPR    #1ATPR           TH Carcass Net
     C                     Z-ADDP1A5VA    #1A5VA           TH Additions Am
     C                     Z-ADDP1CBPR    #1CBPR           TH Payment Gros
     C                     Z-ADDP1CCPR    #1CCPR           Th Payment Net
     C                     Z-ADDP1LPNB    #1LPNB           TH AP Voucher/D
     C                     Z-ADDP1CDPR    #1CDPR           TH Freight Amou
     C                     Z-ADDP1A7VA    #1A7VA           TH Accrual Amou
     C                     Z-ADDP1A2PR    #1A2PR           TH Fixed Cost A
     C                     MOVELP1JWST    #1JWST           TH Calc Net Sts
     C                     MOVELP1CWST    #1CWST           TH Payment Sts
     C                     MOVELP1D7ST    #1D7ST           TH Header Error
     C                     MOVELP1D8ST    #1D8ST           TH Detail Error
     C                     MOVELP1DWST    #1DWST           TH Kill Balanci
     C                     MOVELP1D6ST    #1D6ST           TH Bal to Kill
     C                     Z-ADDP1GHNB    #1GHNB           TH Commission A
     C                     Z-ADDP1BYDT    #1BYDT           TH Voucher Paym
     C                     MOVELP1E0ST    #1E0ST           TH User Error O
     C                     MOVELP1E1ST    #1E1ST           TH Held Over Re
     C                     MOVELP1E2ST    #1E2ST           TH Sex
     C                     Z-ADDP1BSDT    #1BSDT           TH Held/Ovr Com
     C                     Z-ADDP1BTDT    #1BTDT           TH Commission P
     C                     Z-ADDP1BUDT    #1BUDT           TH Actual Check
     C                     Z-ADDP1HGNB    #1HGNB           TH Shipped Weig
     C                     Z-ADDP1HHNB    #1HHNB           TH Avg Hot Wgt
     C                     Z-ADDP1HINB    #1HINB           TH FFLI
     C                     Z-ADDP1A3PR    #1A3PR           TH Kill Product
     C                     Z-ADDP1A4PR    #1A4PR           TH Cut Product
     C                     Z-ADDP1A6PR    #1A6PR           TH Render Produ
     C                     Z-ADDP1J9NB    #1J9NB           TH Head Exclude
     C                     Z-ADDP1D6PR    #1D6PR           TH CM Bse Mkt L
     C                     Z-ADDP1D7PR    #1D7PR           TH CM Bse Mkt C
     C                     Z-ADDP1D8PR    #1D8PR           TH CM Srt Dsc L
     C                     Z-ADDP1D9PR    #1D9PR           TH CM Srt Dsc C
     C                     Z-ADDP1EAPR    #1EAPR           TH CM Yld G/L L
     C                     Z-ADDP1EBPR    #1EBPR           TH CM Yld G/L C
     C                     Z-ADDP1ECPR    #1ECPR           TH CM Crc Val L
     C                     Z-ADDP1EDPR    #1EDPR           TH CM Crc Val C
     C                     Z-ADDP1EEPR    #1EEPR           TH CM Lean Prem
     C                     Z-ADDP1EGPR    #1EGPR           TH CM Gross Liv
     C                     Z-ADDP1EHPR    #1EHPR           TH CM Gross Car
     C                     MOVELP1KAST    #1KAST           TH Source Type
     C                     MOVELP1J7ST    #1J7ST           TH Scale Ticket
     C                     MOVELP1J9ST    #1J9ST           TH Payment Type
     C                     Z-ADDP1OXNB    #1OXNB           TH HPS Movement
     C                     MOVELP1LKST    #1LKST           TH Source Code
     C                     MOVELP1LLST    #1LLST           TH Hog Class Ty
     C                     MOVELP1J8ST    #1J8ST           TH Posted to HP
     C                     MOVELP1LIST    #1LIST           TH Schedule Kil
     C                     MOVELP1LJST    #1LJST           TH Shift Held O
     C                     MOVEL*BLANK    #1NZTX           TH State
     C                     MOVEL*BLANK    #1HJCD           TH Unused Code
     C                     MOVEL*BLANK    #1R4ST           TH Unused Sts 2
     C                     MOVEL*BLANK    #1R5ST           TH Commission S
     C                     MOVEL*BLANK    #1R6ST           TH Paid 2 Week
     C                     MOVEL*BLANK    #1R7ST           TH Unused Sts 1
     C                     Z-ADD*ZERO     #1THWT           TH DOA Weight
     C                     Z-ADD*ZERO     #1T2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     #1THHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     #1T2HD           TH Shift Held O
     C                     Z-ADD*ZERO     #1OBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     #1IORP           TH Head Adjuste
     C                     Z-ADD*ZERO     #1OWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     #1HHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     #1S9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     #1TAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     #1TBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     #1JFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     #1KRIF           TH Broken Back
     C                     Z-ADD*ZERO     #1KORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     #1KAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     #1KROT           TH Excluded Car
     C                     Z-ADD*ZERO     #1OTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     #1IRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     #1IMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     #1IRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     #1KRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     #1OJRF           TH Break Even P
     C                     Z-ADD*ZERO     #1KFOR           TH Meat Value F
     C                     Z-ADD*ZERO     #1ORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     #1OMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     #1MVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     #1MCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     #1NCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     #1NCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     #1IGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     #1KFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     #1EADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     #1EBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     #1ECDT           TH Head LFT
     C                     Z-ADD*ZERO     #1EDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     #1EEDT           TH Unused Date
     C                     MOVEL*BLANK    #1U4ST           TH Unused Sts 1
     C                     MOVEL*BLANK    #1U5ST           TH Unused Sts 2
     C                     MOVEL*BLANK    #1U6ST           TH Unused Sts 3
     C                     MOVEL*BLANK    #1U7ST           TH Unused Sts 4
     C                     MOVEL*BLANK    #1U8ST           TH Unused Sts 5
     C                     MOVEL*BLANK    #1U9ST           TH Unused Sts 6
     C                     MOVEL*BLANK    #1VAST           TH Unused Sts 7
     C                     MOVEL*BLANK    #1VBST           TH Unused Sts 8
     C                     MOVELP1BDCD    #1BDCD           DF Defect Code
     C                     MOVELP1CSCD    #1CSCD           THP Process Cod
     C                     MOVELP1ABCD    #1ABCD           PD Producer Cod
     C                     MOVELP1AECD    #1AECD           PL Location Cod
     C                     MOVELP1ACCD    #1ACCD           HB Buyer Code
     C                     MOVELP1AGCD    #1AGCD           GN Genetic Code
     C                     MOVELP1BECD    #1BECD           HC Class Code
     C                     MOVELP1AAVN    #1AAVN           RS User Changed
     C                     Z-ADDP1AADT    #1AADT           RS Date Changed
     C                     Z-ADDP1AMTM    #1AMTM           RS Time Changed
     C                     MOVELP1AJST    #1AJST           RS Record Statu
     C                     MOVELP1AHVN    #1AHVN           RS Job
     C                     MOVELP1AGVN    #1AGVN           RS Program
     C                     MOVELP1ABVN    #1ABVN           RS User Added
     C                     Z-ADDP1ABDT    #1ABDT           RS Date Added
     C                     Z-ADDP1ABTM    #1ABTM           RS Time Added
     C                     Z-ADDP1HMNB    #1HMNB           BOH Company Num
     C                     MOVEL*BLANK    #DBSTX           Name USR
     C                     Z-ADD*ZERO     #DCGDT           Kill Date Usr
      * Clear external version also
     C                     Z-ADD*ZERO     VDCGDT
     C                     Z-ADDP1B0DT    #1B0DT           TH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1B0DT
     C                     Z-ADDP1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     #DF6NB           Net Head Usr
     C                     Z-ADDP1CWPC    #1CWPC           TH Adj Actual Y
     C                     Z-ADDP1BONB    #1BONB           BOL Load Number
     C                     Z-ADDP1FENB    #1FENB           TH Head Killed
     C                     Z-ADDP1CVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADDP1KOER    #1KOER           TH Head Identif
     C                     Z-ADDP1OPIR    #1OPIR           TH Percent Iden
     C                     Z-ADDP1HFNB    #1HFNB           TH Head Accepte
     C                     Z-ADDP1OPEM    #1OPEM           TH Percent Acce
     C                     MOVEL*BLANK    #DABST           @Status (Yes/No
      * USER: Load screen
      * DTL = PAR By name
     C                     MOVELP2EVTX    #PEVTX           Oms System Valu
     C                     Z-ADDP1HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDP1B0DT    #1B0DT           TH Kill Date
     C                     Z-ADDP1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDP1CWPC    #1CWPC           TH Adj Actual Y
     C                     Z-ADDP1BONB    #1BONB           BOL Load Number
     C                     Z-ADDP1FENB    #1FENB           TH Head Killed
     C                     Z-ADDP1CVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADDP1KOER    #1KOER           TH Head Identif
     C                     Z-ADDP1OPIR    #1OPIR           TH Percent Iden
     C                     Z-ADDP1HFNB    #1HFNB           TH Head Accepte
     C                     Z-ADDP1OPEM    #1OPEM           TH Percent Acce
     C                     Z-ADDP1EFPR    #1EFPR           TH CM Lean Prem
     C                     Z-ADDP1F2NB    #1F2NB           TH Avg Backfat
     C                     Z-ADDP1F3NB    #1F3NB           TH Avg Loin Eye
     C                     Z-ADDP1AWDT    #1AWDT           TH Purchase Dat
     C                     MOVELP1BICD    #1BICD           TH Group Refere
     C                     MOVELP1CPST    #1CPST           TH Live Purchas
     C                     Z-ADDP1ACPR    #1ACPR           TH Live Purchas
     C                     Z-ADDP1B9PR    #1B9PR           TH Live Gross A
     C                     Z-ADDP1CAPR    #1CAPR           TH LIve Net Amt
     C                     MOVELP1C4ST    #1C4ST           TH Resale UOM
     C                     Z-ADDP1AIPR    #1AIPR           TH Recalc Live
     C                     Z-ADDP1A6DT    #1A6DT           TH Pricing Date
     C                     MOVELP1C2ST    #1C2ST           TH Resale Sprea
     C                     Z-ADDP1CXNB    #1CXNB           TH Dead On Arri
     C                     Z-ADDP1CWNB    #1CWNB           TH Head Receive
     C                     Z-ADDP1FCNB    #1FCNB           TH Yard Deads
     C                     Z-ADDP1H9NB    #1H9NB           TH Held Over
     C                     Z-ADDP1FDNB    #1FDNB           TH Head Condemn
     C                     Z-ADDP1HENB    #1HENB           TH Head Adds
     C                     Z-ADDP1CYNB    #1CYNB           TH Live Wgt
     C                     Z-ADDP1LRNB    #1LRNB           TH Adj Live Wgt
     C                     Z-ADDP1E0NB    #1E0NB           TH Hot Wgt
     C                     Z-ADDP1A5PC    #1A5PC           TH Tot Loin Eye
     C                     Z-ADDP1FBNB    #1FBNB           TH Tot Backfat
     C                     Z-ADDP1A4PC    #1A4PC           TH Tot Light Re
     C                     Z-ADDP1F7NB    #1F7NB           TH Avg Live Wgt
     C                     Z-ADDP1HDNB    #1HDNB           TH Avg Hot Wgt
     C                     Z-ADDP1F5NB    #1F5NB           TH Avg Light Re
     C                     Z-ADDP1F4NB    #1F4NB           TH Avg Lean Per
     C                     Z-ADDP1AVPC    #1AVPC           TH Std Yield Pe
     C                     Z-ADDP1AWPC    #1AWPC           TH Actual Yield
     C                     Z-ADDP1A8PC    #1A8PC           TH Yield Differ
     C                     Z-ADDP1A7PC    #1A7PC           TH Recalc Live
     C                     Z-ADDP1B8PR    #1B8PR           TH CM Market Pr
     C                     Z-ADDP1AMPR    #1AMPR           TH CM Base Mkt
     C                     Z-ADDP1ANPR    #1ANPR           TH CM Base Mkt
     C                     Z-ADDP1AYVA    #1AYVA           TH CM Sort Disc
     C                     Z-ADDP1AWVA    #1AWVA           TH CM Yield Gai
     C                     Z-ADDP1AOPR    #1AOPR           TH CM Base Carc
     C                     Z-ADDP1AXVA    #1AXVA           TH CM LN AddOn/
     C                     Z-ADDP1APPR    #1APPR           TH CM Carcass G
     C                     Z-ADDP1ASPR    #1ASPR           TH Deduction Am
     C                     Z-ADDP1A4VA    #1A4VA           TH Total Net WO
     C                     Z-ADDP1ATPR    #1ATPR           TH Carcass Net
     C                     Z-ADDP1A5VA    #1A5VA           TH Additions Am
     C                     Z-ADDP1CBPR    #1CBPR           TH Payment Gros
     C                     Z-ADDP1CCPR    #1CCPR           Th Payment Net
     C                     Z-ADDP1LPNB    #1LPNB           TH AP Voucher/D
     C                     Z-ADDP1CDPR    #1CDPR           TH Freight Amou
     C                     Z-ADDP1A7VA    #1A7VA           TH Accrual Amou
     C                     Z-ADDP1A2PR    #1A2PR           TH Fixed Cost A
     C                     MOVELP1JWST    #1JWST           TH Calc Net Sts
     C                     MOVELP1CWST    #1CWST           TH Payment Sts
     C                     MOVELP1D7ST    #1D7ST           TH Header Error
     C                     MOVELP1D8ST    #1D8ST           TH Detail Error
     C                     MOVELP1DWST    #1DWST           TH Kill Balanci
     C                     MOVELP1D6ST    #1D6ST           TH Bal to Kill
     C                     Z-ADDP1GHNB    #1GHNB           TH Commission A
     C                     Z-ADDP1BYDT    #1BYDT           TH Voucher Paym
     C                     MOVELP1E0ST    #1E0ST           TH User Error O
     C                     MOVELP1E1ST    #1E1ST           TH Held Over Re
     C                     MOVELP1E2ST    #1E2ST           TH Sex
     C                     Z-ADDP1BSDT    #1BSDT           TH Held/Ovr Com
     C                     Z-ADDP1BTDT    #1BTDT           TH Commission P
     C                     Z-ADDP1BUDT    #1BUDT           TH Actual Check
     C                     Z-ADDP1HGNB    #1HGNB           TH Shipped Weig
     C                     Z-ADDP1HHNB    #1HHNB           TH Avg Hot Wgt
     C                     Z-ADDP1HINB    #1HINB           TH FFLI
     C                     Z-ADDP1A3PR    #1A3PR           TH Kill Product
     C                     Z-ADDP1A4PR    #1A4PR           TH Cut Product
     C                     Z-ADDP1A6PR    #1A6PR           TH Render Produ
     C                     Z-ADDP1J9NB    #1J9NB           TH Head Exclude
     C                     Z-ADDP1D6PR    #1D6PR           TH CM Bse Mkt L
     C                     Z-ADDP1D7PR    #1D7PR           TH CM Bse Mkt C
     C                     Z-ADDP1D8PR    #1D8PR           TH CM Srt Dsc L
     C                     Z-ADDP1D9PR    #1D9PR           TH CM Srt Dsc C
     C                     Z-ADDP1EAPR    #1EAPR           TH CM Yld G/L L
     C                     Z-ADDP1EBPR    #1EBPR           TH CM Yld G/L C
     C                     Z-ADDP1ECPR    #1ECPR           TH CM Crc Val L
     C                     Z-ADDP1EDPR    #1EDPR           TH CM Crc Val C
     C                     Z-ADDP1EEPR    #1EEPR           TH CM Lean Prem
     C                     Z-ADDP1EGPR    #1EGPR           TH CM Gross Liv
     C                     Z-ADDP1EHPR    #1EHPR           TH CM Gross Car
     C                     MOVELP1KAST    #1KAST           TH Source Type
     C                     MOVELP1J7ST    #1J7ST           TH Scale Ticket
     C                     MOVELP1J9ST    #1J9ST           TH Payment Type
     C                     Z-ADDP1OXNB    #1OXNB           TH HPS Movement
     C                     MOVELP1LKST    #1LKST           TH Source Code
     C                     MOVELP1LLST    #1LLST           TH Hog Class Ty
     C                     MOVELP1J8ST    #1J8ST           TH Posted to HP
     C                     MOVELP1LIST    #1LIST           TH Schedule Kil
     C                     MOVELP1LJST    #1LJST           TH Shift Held O
     C                     MOVELP1BDCD    #1BDCD           DF Defect Code
     C                     MOVELP1CSCD    #1CSCD           THP Process Cod
     C                     MOVELP1ABCD    #1ABCD           PD Producer Cod
     C                     MOVELP1AECD    #1AECD           PL Location Cod
     C                     MOVELP1ACCD    #1ACCD           HB Buyer Code
     C                     MOVELP1AGCD    #1AGCD           GN Genetic Code
     C                     MOVELP1BECD    #1BECD           HC Class Code
     C                     MOVELP1AAVN    #1AAVN           RS User Changed
     C                     Z-ADDP1AADT    #1AADT           RS Date Changed
     C                     Z-ADDP1AMTM    #1AMTM           RS Time Changed
     C                     MOVELP1AJST    #1AJST           RS Record Statu
     C                     MOVELP1AHVN    #1AHVN           RS Job
     C                     MOVELP1AGVN    #1AGVN           RS Program
     C                     MOVELP1ABVN    #1ABVN           RS User Added
     C                     Z-ADDP1ABDT    #1ABDT           RS Date Added
     C                     Z-ADDP1ABTM    #1ABTM           RS Time Added
      * Compute: Net head
      * DTL.Net Head Usr =
      *    *COMPUTE (x1 - x2 - x3)
      * x1    : DTL.TH Head Received
      * -     : PGM.*Synon (17,7) work field
      * x2    : DTL.TH Yard Deads
      * -     : PGM.*Synon (17,7) work field
      * x3    : DTL.TH Head Condemned
     C           #1CWNB    SUB  #1FCNB    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  #1FDNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    #DF6NB           Net Head Usr
     C                     MOVEL'N'       #DABST           @Status (Yes/No
      * Get other kill date for the tattoo
      * Rtv Held Over KillDt  RT - Tattoo Header  * 
     C                     EXSR SRRVGN
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Kill Date Usr to display format
      * Convert date
     C           1000000   ADD  #DCGDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDCGDT
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B0DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Validation Rules  RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0001           Carcass Dbw Min
     C                     Z-ADD*ZERO     YL0002           Carcass Dbw Max
     C                     Z-ADD*ZERO     YL0003           Carcass Lgt Min
     C                     Z-ADD*ZERO     YL0004           Carcass Lgt Max
     C                     Z-ADD*ZERO     YL0005           %Lean High Min
     C                     Z-ADD*ZERO     YL0006           %Lean High Max
     C                     Z-ADD*ZERO     YL0007           %Lean Low Min
     C                     Z-ADD*ZERO     YL0008           %Lean Low Max
     C                     Z-ADD*ZERO     YL0009           High Yield Min
     C                     Z-ADD*ZERO     YL0010           High Yield Max
     C                     Z-ADD*ZERO     YL0011           Low Yield Min
     C                     Z-ADD*ZERO     YL0012           Low Yield Max
     C                     Z-ADD*ZERO     YL0013           Head < Percent
     C                     Z-ADD*ZERO     YL0014           Head < Percent
     C                     Z-ADD*ZERO     YL0015           Head > Percent
     C                     Z-ADD*ZERO     YL0016           Head > Percent
     C                     Z-ADD*ZERO     YL0017           BackFat High Mi
     C                     Z-ADD*ZERO     YL0018           BackFat High Ma
     C                     Z-ADD*ZERO     YL0019           BackFat Low Min
     C                     Z-ADD*ZERO     YL0020           Backfat Low Max
     C                     Z-ADD*ZERO     YL0021           LoinEye High Mi
     C                     Z-ADD*ZERO     YL0022           LoinEye High Ma
     C                     Z-ADD*ZERO     YL0023           LoinEye Low Min
     C                     Z-ADD*ZERO     YL0024           LoinEye Low Max
      * Establish starting position
     C           *LOVAL    SETLL@BOREFN                    *
     C                     READ @BOREFN                  90*
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EV Validation Code is Carcass has Double Weight
     C           WABVCD    IFEQ 'CDB'                      *IF
      * Carcass double weight
     C                     Z-ADDWAAFPC    YL0001           Carcass Dbw Min
     C                     Z-ADDWAAGPC    YL0002           Carcass Dbw Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Carcass is Light Weight
     C           WABVCD    IFEQ 'CLT'                      *IF
      * Carcass light weight
     C                     Z-ADDWAAFPC    YL0003           Carcass Lgt Min
     C                     Z-ADDWAAGPC    YL0004           Carcass Lgt Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is high
     C           WABVCD    IFEQ 'BHI'                      *IF
      * backfat is high
     C                     Z-ADDWAAFPC    YL0017           BackFat High Mi
     C                     Z-ADDWAAGPC    YL0018           BackFat High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is Low
     C           WABVCD    IFEQ 'BLW'                      *IF
      * Backfat is low
     C                     Z-ADDWAAFPC    YL0019           BackFat Low Min
     C                     Z-ADDWAAGPC    YL0020           Backfat Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is High
     C           WABVCD    IFEQ 'LHI'                      *IF
      * loineye is high
     C                     Z-ADDWAAFPC    YL0021           LoinEye High Mi
     C                     Z-ADDWAAGPC    YL0022           LoinEye High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is Low
     C           WABVCD    IFEQ 'LLW'                      *IF
      * loineye is low
     C                     Z-ADDWAAFPC    YL0023           LoinEye Low Min
     C                     Z-ADDWAAGPC    YL0024           LoinEye Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is high
     C           WABVCD    IFEQ 'PLH'                      *IF
      * % Lean High
     C                     Z-ADDWAAFPC    YL0005           %Lean High Min
     C                     Z-ADDWAAGPC    YL0006           %Lean High Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is Low
     C           WABVCD    IFEQ 'PLL'                      *IF
      * % Lean Low
     C                     Z-ADDWAAFPC    YL0007           %Lean Low Min
     C                     Z-ADDWAAGPC    YL0008           %Lean Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is < % Allowed
     C           WABVCD    IFEQ 'HLP'                      *IF
      * Head < Percent
     C                     Z-ADDWAAFPC    YL0013           Head < Percent
     C                     Z-ADDWAAGPC    YL0014           Head < Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is > % Allowed
     C           WABVCD    IFEQ 'HHP'                      *IF
      * Head > Percent
     C                     Z-ADDWAAFPC    YL0015           Head > Percent
     C                     Z-ADDWAAGPC    YL0016           Head > Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is High
     C           WABVCD    IFEQ 'YHI'                      *IF
      * Yield High
     C                     Z-ADDWAAFPC    YL0009           High Yield Min
     C                     Z-ADDWAAGPC    YL0010           High Yield Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is Low
     C           WABVCD    IFEQ 'YLW'                      *IF
      * Yield Low
     C                     Z-ADDWAAFPC    YL0011           Low Yield Min
     C                     Z-ADDWAAGPC    YL0012           Low Yield Max
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BOREFN                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * First Day: Kill Date
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A1BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADD#DCGDT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSB     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0025           TH Purchase Dat
     C                     MOVEL*BLANK    YL0026           TH Group Refere
     C                     MOVEL*BLANK    YL0027           TH Live Purchas
     C                     Z-ADD*ZERO     YL0028           TH Live Purchas
     C                     Z-ADD*ZERO     YL0029           TH Live Gross A
     C                     Z-ADD*ZERO     YL0030           TH LIve Net Amt
     C                     MOVEL*BLANK    YL0031           TH Resale UOM
     C                     Z-ADD*ZERO     YL0032           TH Recalc Live
     C                     Z-ADD*ZERO     YL0033           TH Pricing Date
     C                     MOVEL*BLANK    YL0034           TH Resale Sprea
     C                     Z-ADD*ZERO     YL0035           TH Dead On Arri
     C                     Z-ADD*ZERO     YL0036           TH Head Receive
     C                     Z-ADD*ZERO     YL0037           TH Yard Deads
     C                     Z-ADD*ZERO     YL0038           TH Held Over
     C                     Z-ADD*ZERO     YL0039           TH Head Condemn
     C                     Z-ADD*ZERO     YL0040           TH Head Killed
     C                     Z-ADD*ZERO     YL0041           TH Head Adds
     C                     Z-ADD*ZERO     YL0042           TH Head Accepte
     C                     Z-ADD*ZERO     YL0043           TH Live Wgt
     C                     Z-ADD*ZERO     YL0044           TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0045           TH Hot Wgt
     C                     Z-ADD*ZERO     YL0046           TH Tot Loin Eye
     C                     Z-ADD*ZERO     YL0047           TH Tot Backfat
     C                     Z-ADD*ZERO     YL0048           TH Tot Light Re
     C                     Z-ADD*ZERO     YL0049           TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0050           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YL0051           TH Avg Light Re
     C                     Z-ADD*ZERO     YL0052           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0053           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0054           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0055           TH Std Yield Pe
     C                     Z-ADD*ZERO     YL0056           TH Actual Yield
     C                     Z-ADD*ZERO     YL0057           TH Adj Actual Y
     C                     Z-ADD*ZERO     YL0058           TH Yield Differ
     C                     Z-ADD*ZERO     YL0059           TH Recalc Live
     C                     Z-ADD*ZERO     YL0060           TH CM Market Pr
     C                     Z-ADD*ZERO     YL0061           TH CM Base Mkt
     C                     Z-ADD*ZERO     YL0062           TH CM Base Mkt
     C                     Z-ADD*ZERO     YL0063           TH CM Sort Disc
     C                     Z-ADD*ZERO     YL0064           TH CM Yield Gai
     C                     Z-ADD*ZERO     YL0065           TH CM Base Carc
     C                     Z-ADD*ZERO     YL0066           TH CM LN AddOn/
     C                     Z-ADD*ZERO     YL0067           TH CM Carcass G
     C                     Z-ADD*ZERO     YL0068           TH Deduction Am
     C                     Z-ADD*ZERO     YL0069           TH Total Net WO
     C                     Z-ADD*ZERO     YL0070           TH Carcass Net
     C                     Z-ADD*ZERO     YL0071           TH Additions Am
     C                     Z-ADD*ZERO     YL0072           TH Payment Gros
     C                     Z-ADD*ZERO     YL0073           Th Payment Net
     C                     Z-ADD*ZERO     YL0074           TH AP Voucher/D
     C                     Z-ADD*ZERO     YL0075           TH Freight Amou
     C                     Z-ADD*ZERO     YL0076           TH Accrual Amou
     C                     Z-ADD*ZERO     YL0077           TH Fixed Cost A
     C                     MOVEL*BLANK    YL0078           TH Calc Net Sts
     C                     MOVEL*BLANK    YL0079           TH Payment Sts
     C                     MOVEL*BLANK    YL0080           TH Bal to Kill
     C                     Z-ADD*ZERO     YL0081           TH Commission A
     C                     Z-ADD*ZERO     YL0082           TH Voucher Paym
     C                     MOVEL*BLANK    YL0083           TH User Error O
     C                     MOVEL*BLANK    YL0084           TH Held Over Re
     C                     MOVEL*BLANK    YL0085           TH Sex
     C                     Z-ADD*ZERO     YL0086           TH Held/Ovr Com
     C                     Z-ADD*ZERO     YL0087           TH Commission P
     C                     Z-ADD*ZERO     YL0088           TH Actual Check
     C                     Z-ADD*ZERO     YL0089           TH Shipped Weig
     C                     Z-ADD*ZERO     YL0090           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YL0091           TH FFLI
     C                     Z-ADD*ZERO     YL0092           TH Kill Product
     C                     Z-ADD*ZERO     YL0093           TH Cut Product
     C                     Z-ADD*ZERO     YL0094           TH Render Produ
     C                     Z-ADD*ZERO     YL0095           TH Head Exclude
     C                     Z-ADD*ZERO     YL0096           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     YL0097           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     YL0098           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     YL0099           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     YL0100           TH CM Yld G/L L
     C                     Z-ADD*ZERO     YL0101           TH CM Yld G/L C
     C                     Z-ADD*ZERO     YL0102           TH CM Crc Val L
     C                     Z-ADD*ZERO     YL0103           TH CM Crc Val C
     C                     Z-ADD*ZERO     YL0104           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0105           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0106           TH CM Gross Liv
     C                     Z-ADD*ZERO     YL0107           TH CM Gross Car
     C                     MOVEL*BLANK    YL0108           TH Source Type
     C                     MOVEL*BLANK    YL0109           TH Scale Ticket
     C                     MOVEL*BLANK    YL0110           TH Payment Type
     C                     Z-ADD*ZERO     YL0111           TH HPS Movement
     C                     MOVEL*BLANK    YL0112           TH Source Code
     C                     MOVEL*BLANK    YL0113           TH Hog Class Ty
     C                     MOVEL*BLANK    YL0114           TH Posted to HP
     C                     MOVEL*BLANK    YL0115           TH Schedule Kil
     C                     MOVEL*BLANK    YL0116           TH Shift Held O
     C                     MOVEL*BLANK    YL0117           DF Defect Code
     C                     MOVEL*BLANK    YL0118           THP Process Cod
     C                     MOVEL*BLANK    YL0119           PD Producer Cod
     C                     MOVEL*BLANK    YL0120           PL Location Cod
     C                     MOVEL*BLANK    YL0121           HB Buyer Code
     C                     MOVEL*BLANK    YL0122           GN Genetic Code
     C                     MOVEL*BLANK    YL0123           HC Class Code
     C                     MOVEL*BLANK    YL0124           RS User Changed
     C                     Z-ADD*ZERO     YL0125           RS Date Changed
     C                     Z-ADD*ZERO     YL0126           RS Time Changed
     C                     MOVEL*BLANK    YL0127           RS Record Statu
     C                     MOVEL*BLANK    YL0128           RS Job
     C                     MOVEL*BLANK    YL0129           RS Program
     C                     MOVEL*BLANK    YL0130           RS User Added
     C                     Z-ADD*ZERO     YL0131           RS Date Added
     C                     Z-ADD*ZERO     YL0132           RS Time Added
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA1AWDT    YL0025           TH Purchase Dat
     C                     MOVELA1BICD    YL0026           TH Group Refere
     C                     MOVELA1CPST    YL0027           TH Live Purchas
     C                     Z-ADDA1ACPR    YL0028           TH Live Purchas
     C                     Z-ADDA1B9PR    YL0029           TH Live Gross A
     C                     Z-ADDA1CAPR    YL0030           TH LIve Net Amt
     C                     MOVELA1C4ST    YL0031           TH Resale UOM
     C                     Z-ADDA1AIPR    YL0032           TH Recalc Live
     C                     Z-ADDA1A6DT    YL0033           TH Pricing Date
     C                     MOVELA1C2ST    YL0034           TH Resale Sprea
     C                     Z-ADDA1CXNB    YL0035           TH Dead On Arri
     C                     Z-ADDA1CWNB    YL0036           TH Head Receive
     C                     Z-ADDA1FCNB    YL0037           TH Yard Deads
     C                     Z-ADDA1H9NB    YL0038           TH Held Over
     C                     Z-ADDA1FDNB    YL0039           TH Head Condemn
     C                     Z-ADDA1FENB    YL0040           TH Head Killed
     C                     Z-ADDA1HENB    YL0041           TH Head Adds
     C                     Z-ADDA1HFNB    YL0042           TH Head Accepte
     C                     Z-ADDA1CYNB    YL0043           TH Live Wgt
     C                     Z-ADDA1LRNB    YL0044           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    YL0045           TH Hot Wgt
     C                     Z-ADDA1A5PC    YL0046           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    YL0047           TH Tot Backfat
     C                     Z-ADDA1A4PC    YL0048           TH Tot Light Re
     C                     Z-ADDA1F7NB    YL0049           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    YL0050           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    YL0051           TH Avg Light Re
     C                     Z-ADDA1F4NB    YL0052           TH Avg Lean Per
     C                     Z-ADDA1F3NB    YL0053           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    YL0054           TH Avg Backfat
     C                     Z-ADDA1AVPC    YL0055           TH Std Yield Pe
     C                     Z-ADDA1AWPC    YL0056           TH Actual Yield
     C                     Z-ADDA1CWPC    YL0057           TH Adj Actual Y
     C                     Z-ADDA1A8PC    YL0058           TH Yield Differ
     C                     Z-ADDA1A7PC    YL0059           TH Recalc Live
     C                     Z-ADDA1B8PR    YL0060           TH CM Market Pr
     C                     Z-ADDA1AMPR    YL0061           TH CM Base Mkt
     C                     Z-ADDA1ANPR    YL0062           TH CM Base Mkt
     C                     Z-ADDA1AYVA    YL0063           TH CM Sort Disc
     C                     Z-ADDA1AWVA    YL0064           TH CM Yield Gai
     C                     Z-ADDA1AOPR    YL0065           TH CM Base Carc
     C                     Z-ADDA1AXVA    YL0066           TH CM LN AddOn/
     C                     Z-ADDA1APPR    YL0067           TH CM Carcass G
     C                     Z-ADDA1ASPR    YL0068           TH Deduction Am
     C                     Z-ADDA1A4VA    YL0069           TH Total Net WO
     C                     Z-ADDA1ATPR    YL0070           TH Carcass Net
     C                     Z-ADDA1A5VA    YL0071           TH Additions Am
     C                     Z-ADDA1CBPR    YL0072           TH Payment Gros
     C                     Z-ADDA1CCPR    YL0073           Th Payment Net
     C                     Z-ADDA1LPNB    YL0074           TH AP Voucher/D
     C                     Z-ADDA1CDPR    YL0075           TH Freight Amou
     C                     Z-ADDA1A7VA    YL0076           TH Accrual Amou
     C                     Z-ADDA1A2PR    YL0077           TH Fixed Cost A
     C                     MOVELA1JWST    YL0078           TH Calc Net Sts
     C                     MOVELA1CWST    YL0079           TH Payment Sts
     C                     MOVELA1D6ST    YL0080           TH Bal to Kill
     C                     Z-ADDA1GHNB    YL0081           TH Commission A
     C                     Z-ADDA1BYDT    YL0082           TH Voucher Paym
     C                     MOVELA1E0ST    YL0083           TH User Error O
     C                     MOVELA1E1ST    YL0084           TH Held Over Re
     C                     MOVELA1E2ST    YL0085           TH Sex
     C                     Z-ADDA1BSDT    YL0086           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    YL0087           TH Commission P
     C                     Z-ADDA1BUDT    YL0088           TH Actual Check
     C                     Z-ADDA1HGNB    YL0089           TH Shipped Weig
     C                     Z-ADDA1HHNB    YL0090           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    YL0091           TH FFLI
     C                     Z-ADDA1A3PR    YL0092           TH Kill Product
     C                     Z-ADDA1A4PR    YL0093           TH Cut Product
     C                     Z-ADDA1A6PR    YL0094           TH Render Produ
     C                     Z-ADDA1J9NB    YL0095           TH Head Exclude
     C                     Z-ADDA1D6PR    YL0096           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    YL0097           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    YL0098           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    YL0099           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    YL0100           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    YL0101           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    YL0102           TH CM Crc Val L
     C                     Z-ADDA1EDPR    YL0103           TH CM Crc Val C
     C                     Z-ADDA1EEPR    YL0104           TH CM Lean Prem
     C                     Z-ADDA1EFPR    YL0105           TH CM Lean Prem
     C                     Z-ADDA1EGPR    YL0106           TH CM Gross Liv
     C                     Z-ADDA1EHPR    YL0107           TH CM Gross Car
     C                     MOVELA1KAST    YL0108           TH Source Type
     C                     MOVELA1J7ST    YL0109           TH Scale Ticket
     C                     MOVELA1J9ST    YL0110           TH Payment Type
     C                     Z-ADDA1OXNB    YL0111           TH HPS Movement
     C                     MOVELA1LKST    YL0112           TH Source Code
     C                     MOVELA1LLST    YL0113           TH Hog Class Ty
     C                     MOVELA1J8ST    YL0114           TH Posted to HP
     C                     MOVELA1LIST    YL0115           TH Schedule Kil
     C                     MOVELA1LJST    YL0116           TH Shift Held O
     C                     MOVELA1BDCD    YL0117           DF Defect Code
     C                     MOVELA1CSCD    YL0118           THP Process Cod
     C                     MOVELA1ABCD    YL0119           PD Producer Cod
     C                     MOVELA1AECD    YL0120           PL Location Cod
     C                     MOVELA1ACCD    YL0121           HB Buyer Code
     C                     MOVELA1AGCD    YL0122           GN Genetic Code
     C                     MOVELA1BECD    YL0123           HC Class Code
     C                     MOVELA1AAVN    YL0124           RS User Changed
     C                     Z-ADDA1AADT    YL0125           RS Date Changed
     C                     Z-ADDA1AMTM    YL0126           RS Time Changed
     C                     MOVELA1AJST    YL0127           RS Record Statu
     C                     MOVELA1AHVN    YL0128           RS Job
     C                     MOVELA1AGVN    YL0129           RS Program
     C                     MOVELA1ABVN    YL0130           RS User Added
     C                     Z-ADDA1ABDT    YL0131           RS Date Added
     C                     Z-ADDA1ABTM    YL0132           RS Time Added
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv/Trnsfr Eval Trns  RT - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0002 10        TH Group Refere
     C                     MOVEL*BLANK    WN0003  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0004  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0005  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0006  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0007  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0008  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0009  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0010  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0011  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0012  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0013  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0014  50       TH Held Over
     C                     Z-ADD*ZERO     WN0015  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0016  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0017  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0018  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0019  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0020  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0021  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0022  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0023  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0024  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0025  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0026  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0027  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0028  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0029  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0030  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0031  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0032  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0033  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0034  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0035  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0036  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0037  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0038  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0039  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0040  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0041  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0042  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0043  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0044  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0045  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0046  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0047  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0048  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0049  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0050  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0051  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0052  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0053  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0054  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0055  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0056  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0057  80       TH Commission A
     C                     Z-ADD*ZERO     WN0058  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0059  1        TH User Error O
     C                     MOVEL*BLANK    WN0060  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0061  1        TH Sex
     C                     Z-ADD*ZERO     WN0062  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0063  70       TH Commission P
     C                     Z-ADD*ZERO     WN0064  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0065  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0066  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0067  31       TH FFLI
     C                     Z-ADD*ZERO     WN0068  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0069  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0070  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0071  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0072  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0073  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0074  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0075  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0076  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0077  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0078  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0079  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0080  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0081  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0082  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0083  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0084  1        TH Source Type
     C                     MOVEL*BLANK    WN0085  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0086  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0087  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0088  3        TH Source Code
     C                     MOVEL*BLANK    WN0089  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0090  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0091  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0092  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0093  6        DF Defect Code
     C                     MOVEL*BLANK    WN0094  6        THP Process Cod
     C                     MOVEL*BLANK    WN0095  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0096  6        PL Location Cod
     C                     MOVEL*BLANK    WN0097  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0098  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0099  3        HC Class Code
     C                     MOVEL*BLANK    WN0100 10        RS User Changed
     C                     Z-ADD*ZERO     WN0101  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0102  60       RS Time Changed
     C                     MOVEL*BLANK    WN0103  1        RS Record Statu
     C                     MOVEL*BLANK    WN0104 10        RS Job
     C                     MOVEL*BLANK    WN0105 10        RS Program
     C                     MOVEL*BLANK    WN0106 10        RS User Added
     C                     Z-ADD*ZERO     WN0107  70       RS Date Added
     C                     Z-ADD*ZERO     WN0108  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * S13236 RMC 6/12/18 fixed parms on call to rebalance the FROM date
      *   was passing in DB1. which is from the last day's records. it ne
      *   pass in the PAR context previousely retrieved.  and only do it
      *  are transfer carcasses
     C                     MOVEL'Y'       YL0134           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQSC01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQSC02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQSC03           BOL Load Number
     C           *LIKE     DEFN A1CVNB    WQSC04           TH Tattoo Numbe
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           BOH Buy Order N
     C                     KFLD           WQSC03           BOL Load Number
     C                     KFLD           WQSC04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#1HMNB    WQSC01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSC02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSC03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSC04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSC     SETLL@A1CPC4                    *
     C           KRSSC     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0134    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0134           First Time Flag
      * Net Head Usr
      * LCL.Net Head Usr =
      *    *COMPUTE (x1 - x2 - x3)
      * x1    : DB1.TH Head Received
      * -     : PGM.*Synon (15,0) work field
      * x2    : DB1.TH Yard Deads
      * -     : PGM.*Synon (15,0) work field
      * x3    : DB1.TH Head Condemned
     C           A1CWNB    SUB  A1FCNB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  A1FDNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0135           Net Head Usr
     C           YL0135    SUB  A1FENB    YL0136           Transfer Carcas
     C                     Z-ADDA1B0DT    YL0137           TH Kill Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDA1B0DT    YL0138           Kill Date Usr
     C                     END                             *FI
     C           KRSSC     READE@A1CPC4                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.Transfer Carcasses    USR is *Zeros
     C           YL0136    IFEQ 0                          *IF
     C                     ELSE
      * CASE: LCL.Transfer Carcasses    USR is GT Zero
     C           YL0136    IFGT 0                          *IF
      * Transfer from the Held Over To Date.
      * Rtv/Trnsfr Eval Trns  RT - Eval Trans  * 
     C                     EXSR SDRVGN
      * RMC - moved here from below
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * 
     C                     EXSR SHRVGN
      * RMC chg to PAR to pick up orig kill date fields
      * Bal/Val Tattoo        XF - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADDA1HMNB    PAHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    PABONB           BOL Load Number
     C                     Z-ADDA1CVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDYL0137    PAB0DT           TH Kill Date
     C                     Z-ADDWN0001    PAAWDT           TH Purchase Dat
     C                     MOVELWN0002    PABICD    P      TH Group Refere
     C                     MOVELWN0003    PACPST    P      TH Live Purchas
     C                     Z-ADDWN0004    PAACPR           TH Live Purchas
     C                     Z-ADDWN0005    PAB9PR           TH Live Gross A
     C                     Z-ADDWN0006    PACAPR           TH LIve Net Amt
     C                     MOVELWN0007    PAC4ST    P      TH Resale UOM
     C                     Z-ADDWN0008    PAAIPR           TH Recalc Live
     C                     Z-ADDWN0009    PAA6DT           TH Pricing Date
     C                     MOVELWN0010    PAC2ST    P      TH Resale Sprea
     C                     Z-ADDWN0011    PACXNB           TH Dead On Arri
     C                     Z-ADDWN0012    PACWNB           TH Head Receive
     C                     Z-ADDWN0013    PAFCNB           TH Yard Deads
     C                     Z-ADDWN0014    PAH9NB           TH Held Over
     C                     Z-ADDWN0015    PAFDNB           TH Head Condemn
     C                     Z-ADDWN0016    PAFENB           TH Head Killed
     C                     Z-ADDWN0017    PAHENB           TH Head Adds
     C                     Z-ADDWN0018    PAHFNB           TH Head Accepte
     C                     Z-ADDWN0019    PACYNB           TH Live Wgt
     C                     Z-ADDWN0020    PALRNB           TH Adj Live Wgt
     C                     Z-ADDWN0021    PAE0NB           TH Hot Wgt
     C                     Z-ADDWN0022    PAA5PC           TH Tot Loin Eye
     C                     Z-ADDWN0023    PAFBNB           TH Tot Backfat
     C                     Z-ADDWN0024    PAA4PC           TH Tot Light Re
     C                     Z-ADDWN0025    PAF7NB           TH Avg Live Wgt
     C                     Z-ADDWN0026    PAHDNB           TH Avg Hot Wgt
     C                     Z-ADDWN0027    PAF5NB           TH Avg Light Re
     C                     Z-ADDWN0028    PAF4NB           TH Avg Lean Per
     C                     Z-ADDWN0029    PAF3NB           TH Avg Loin Eye
     C                     Z-ADDWN0030    PAF2NB           TH Avg Backfat
     C                     Z-ADDWN0031    PAAVPC           TH Std Yield Pe
     C                     Z-ADDWN0032    PAAWPC           TH Actual Yield
     C                     Z-ADDWN0033    PACWPC           TH Adj Actual Y
     C                     Z-ADDWN0034    PAA8PC           TH Yield Differ
     C                     Z-ADDWN0035    PAA7PC           TH Recalc Live
     C                     Z-ADDWN0036    PAB8PR           TH CM Market Pr
     C                     Z-ADDWN0037    PAAMPR           TH CM Base Mkt
     C                     Z-ADDWN0038    PAANPR           TH CM Base Mkt
     C                     Z-ADDWN0039    PAAYVA           TH CM Sort Disc
     C                     Z-ADDWN0040    PAAWVA           TH CM Yield Gai
     C                     Z-ADDWN0041    PAAOPR           TH CM Base Carc
     C                     Z-ADDWN0042    PAAXVA           TH CM LN AddOn/
     C                     Z-ADDWN0043    PAAPPR           TH CM Carcass G
     C                     Z-ADDWN0044    PAASPR           TH Deduction Am
     C                     Z-ADDWN0045    PAA4VA           TH Total Net WO
     C                     Z-ADDWN0046    PAATPR           TH Carcass Net
     C                     Z-ADDWN0047    PAA5VA           TH Additions Am
     C                     Z-ADDWN0048    PACBPR           TH Payment Gros
     C                     Z-ADDWN0049    PACCPR           Th Payment Net
     C                     Z-ADDWN0050    PALPNB           TH AP Voucher/D
     C                     Z-ADDWN0051    PACDPR           TH Freight Amou
     C                     Z-ADDWN0052    PAA7VA           TH Accrual Amou
     C                     Z-ADDWN0053    PAA2PR           TH Fixed Cost A
     C                     MOVELWN0054    PAJWST    P      TH Calc Net Sts
     C                     MOVELWN0055    PACWST    P      TH Payment Sts
     C                     MOVEL*BLANK    PAD6ST    P      TH Bal to Kill
     C                     Z-ADDWN0057    PAGHNB           TH Commission A
     C                     Z-ADDWN0058    PABYDT           TH Voucher Paym
     C                     MOVELWN0059    PAE0ST    P      TH User Error O
     C                     MOVELWN0060    PAE1ST    P      TH Held Over Re
     C                     MOVELWN0061    PAE2ST    P      TH Sex
     C                     Z-ADDWN0062    PABSDT           TH Held/Ovr Com
     C                     Z-ADDWN0063    PABTDT           TH Commission P
     C                     Z-ADDWN0064    PABUDT           TH Actual Check
     C                     Z-ADDWN0065    PAHGNB           TH Shipped Weig
     C                     Z-ADDWN0066    PAHHNB           TH Avg Hot Wgt
     C                     Z-ADDWN0067    PAHINB           TH FFLI
     C                     Z-ADDWN0068    PAA3PR           TH Kill Product
     C                     Z-ADDWN0069    PAA4PR           TH Cut Product
     C                     Z-ADDWN0070    PAA6PR           TH Render Produ
     C                     Z-ADDWN0071    PAJ9NB           TH Head Exclude
     C                     Z-ADDWN0072    PAD6PR           TH CM Bse Mkt L
     C                     Z-ADDWN0073    PAD7PR           TH CM Bse Mkt C
     C                     Z-ADDWN0074    PAD8PR           TH CM Srt Dsc L
     C                     Z-ADDWN0075    PAD9PR           TH CM Srt Dsc C
     C                     Z-ADDWN0076    PAEAPR           TH CM Yld G/L L
     C                     Z-ADDWN0077    PAEBPR           TH CM Yld G/L C
     C                     Z-ADDWN0078    PAECPR           TH CM Crc Val L
     C                     Z-ADDWN0079    PAEDPR           TH CM Crc Val C
     C                     Z-ADDWN0080    PAEEPR           TH CM Lean Prem
     C                     Z-ADDWN0081    PAEFPR           TH CM Lean Prem
     C                     Z-ADDWN0082    PAEGPR           TH CM Gross Liv
     C                     Z-ADDWN0083    PAEHPR           TH CM Gross Car
     C                     MOVELWN0084    PAKAST    P      TH Source Type
     C                     MOVELWN0085    PAJ7ST    P      TH Scale Ticket
     C                     MOVELWN0086    PAJ9ST    P      TH Payment Type
     C                     Z-ADDWN0087    PAOXNB           TH HPS Movement
     C                     MOVELWN0088    PALKST    P      TH Source Code
     C                     MOVELWN0089    PALLST    P      TH Hog Class Ty
     C                     MOVELWN0090    PAJ8ST    P      TH Posted to HP
     C                     MOVELWN0091    PALIST    P      TH Schedule Kil
     C                     MOVELWN0092    PALJST    P      TH Shift Held O
     C                     MOVELWN0093    PABDCD    P      DF Defect Code
     C                     MOVELWN0094    PACSCD    P      THP Process Cod
     C                     MOVELWN0095    PAABCD    P      PD Producer Cod
     C                     MOVELWN0096    PAAECD    P      PL Location Cod
     C                     MOVELWN0097    PAACCD    P      HB Buyer Code
     C                     MOVELWN0098    PAAGCD    P      GN Genetic Code
     C                     MOVELWN0099    PABECD    P      HC Class Code
     C                     MOVELWN0100    PAAAVN    P      RS User Changed
     C                     Z-ADDWN0101    PAAADT           RS Date Changed
     C                     Z-ADDWN0102    PAAMTM           RS Time Changed
     C                     MOVELWN0103    PAAJST    P      RS Record Statu
     C                     MOVELWN0104    PAAHVN    P      RS Job
     C                     MOVELWN0105    PAAGVN    P      RS Program
     C                     MOVELWN0106    PAABVN    P      RS User Added
     C                     Z-ADDWN0107    PAABDT           RS Date Added
     C                     Z-ADDWN0108    PAABTM           RS Time Added
      *
     C                     CALL 'PKAAXFR'              90  Bal/Val Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Tattoo Hea
     C                     PARM YL0001    WQ0040  71       Carcass Dbw Min
     C                     PARM YL0002    WQ0041  71       Carcass Dbw Max
     C                     PARM YL0003    WQ0042  71       Carcass Lgt Min
     C                     PARM YL0004    WQ0043  71       Carcass Lgt Max
     C                     PARM YL0005    WQ0044  71       %Lean High Min
     C                     PARM YL0006    WQ0045  71       %Lean High Max
     C                     PARM YL0007    WQ0046  71       %Lean Low Min
     C                     PARM YL0008    WQ0047  71       %Lean Low Max
     C                     PARM YL0009    WQ0048  71       High Yield Min
     C                     PARM YL0010    WQ0049  71       High Yield Max
     C                     PARM YL0011    WQ0050  71       Low Yield Min
     C                     PARM YL0012    WQ0051  71       Low Yield Max
     C                     PARM YL0013    WQ0052  71       Head < Percent
     C                     PARM YL0014    WQ0053  71       Head < Percent
     C                     PARM YL0015    WQ0054  71       Head > Percent
     C                     PARM YL0016    WQ0055  71       Head > Percent
     C                     PARM YL0017    WQ0056  71       BackFat High Mi
     C                     PARM YL0018    WQ0057  71       BackFat High Ma
     C                     PARM YL0019    WQ0058  71       BackFat Low Min
     C                     PARM YL0020    WQ0059  71       Backfat Low Max
     C                     PARM YL0021    WQ0060  71       LoinEye High Mi
     C                     PARM YL0022    WQ0061  71       LoinEye High Ma
     C                     PARM YL0023    WQ0062  71       LoinEye Low Min
     C                     PARM YL0024    WQ0063  71       LoinEye Low Max
     C                     PARM 'N'       WQ0064  1        Requested by Us
     C                     PARM *BLANK    WQ0065  1        Bal w/History
     C                     PARM *BLANK    WQ0066  1        TH PHA Add Type
     C                     PARM *BLANK    WQ0067  3        TH PHA Average
     C                     PARM *BLANK    WQ0068  1        TH PHA Add Reas
     C                     PARM 0         WQ0069  51       PH GA Avg Live
     C                     PARM 0         WQ0070  52       PH GA Adjusted
     C                     PARM 0         WQ0071  31       PH GA Avg Lean%
     C                     PARM 0         WQ0072  31       PH GA Avg Backf
     C                     PARM 0         WQ0073  31       PH GA Avg Loin
     C                     PARM 0         WQ0074  31       PH GA Avg Light
     C                     PARM 0         WQ0075  52       PH GA Lean Prm
     C                     PARM 0         WQ0076  53       PH GA Avg Srt D
     C                     PARM 'N'       WQ0077  1        Undo MPR USR
     C           YL0139    PARM *BLANK    WQ0078  1        Balance First D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: LCL.Transfer Carcasses    USR is LT Zero
     C           YL0136    IFLT 0                          *IF
      * Transfer from the Held Over From Date.
     C                     MULT -1        YL0136           Transfer Carcas
      * Rtv/Trnsfr Eval Trns  RT - Eval Trans  * 
     C                     EXSR SIRVGN
      * RMC - moved here from below
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * 
     C                     EXSR SMRVGN
      * RMC chg to PAR to pick up orig kill date fields
      * Bal/Val Tattoo        XF - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADDA1HMNB    PAHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    PABONB           BOL Load Number
     C                     Z-ADDA1CVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDYL0137    PAB0DT           TH Kill Date
     C                     Z-ADDWN0001    PAAWDT           TH Purchase Dat
     C                     MOVELWN0002    PABICD    P      TH Group Refere
     C                     MOVELWN0003    PACPST    P      TH Live Purchas
     C                     Z-ADDWN0004    PAACPR           TH Live Purchas
     C                     Z-ADDWN0005    PAB9PR           TH Live Gross A
     C                     Z-ADDWN0006    PACAPR           TH LIve Net Amt
     C                     MOVELWN0007    PAC4ST    P      TH Resale UOM
     C                     Z-ADDWN0008    PAAIPR           TH Recalc Live
     C                     Z-ADDWN0009    PAA6DT           TH Pricing Date
     C                     MOVELWN0010    PAC2ST    P      TH Resale Sprea
     C                     Z-ADDWN0011    PACXNB           TH Dead On Arri
     C                     Z-ADDWN0012    PACWNB           TH Head Receive
     C                     Z-ADDWN0013    PAFCNB           TH Yard Deads
     C                     Z-ADDWN0014    PAH9NB           TH Held Over
     C                     Z-ADDWN0015    PAFDNB           TH Head Condemn
     C                     Z-ADDWN0016    PAFENB           TH Head Killed
     C                     Z-ADDWN0017    PAHENB           TH Head Adds
     C                     Z-ADDWN0018    PAHFNB           TH Head Accepte
     C                     Z-ADDWN0019    PACYNB           TH Live Wgt
     C                     Z-ADDWN0020    PALRNB           TH Adj Live Wgt
     C                     Z-ADDWN0021    PAE0NB           TH Hot Wgt
     C                     Z-ADDWN0022    PAA5PC           TH Tot Loin Eye
     C                     Z-ADDWN0023    PAFBNB           TH Tot Backfat
     C                     Z-ADDWN0024    PAA4PC           TH Tot Light Re
     C                     Z-ADDWN0025    PAF7NB           TH Avg Live Wgt
     C                     Z-ADDWN0026    PAHDNB           TH Avg Hot Wgt
     C                     Z-ADDWN0027    PAF5NB           TH Avg Light Re
     C                     Z-ADDWN0028    PAF4NB           TH Avg Lean Per
     C                     Z-ADDWN0029    PAF3NB           TH Avg Loin Eye
     C                     Z-ADDWN0030    PAF2NB           TH Avg Backfat
     C                     Z-ADDWN0031    PAAVPC           TH Std Yield Pe
     C                     Z-ADDWN0032    PAAWPC           TH Actual Yield
     C                     Z-ADDWN0033    PACWPC           TH Adj Actual Y
     C                     Z-ADDWN0034    PAA8PC           TH Yield Differ
     C                     Z-ADDWN0035    PAA7PC           TH Recalc Live
     C                     Z-ADDWN0036    PAB8PR           TH CM Market Pr
     C                     Z-ADDWN0037    PAAMPR           TH CM Base Mkt
     C                     Z-ADDWN0038    PAANPR           TH CM Base Mkt
     C                     Z-ADDWN0039    PAAYVA           TH CM Sort Disc
     C                     Z-ADDWN0040    PAAWVA           TH CM Yield Gai
     C                     Z-ADDWN0041    PAAOPR           TH CM Base Carc
     C                     Z-ADDWN0042    PAAXVA           TH CM LN AddOn/
     C                     Z-ADDWN0043    PAAPPR           TH CM Carcass G
     C                     Z-ADDWN0044    PAASPR           TH Deduction Am
     C                     Z-ADDWN0045    PAA4VA           TH Total Net WO
     C                     Z-ADDWN0046    PAATPR           TH Carcass Net
     C                     Z-ADDWN0047    PAA5VA           TH Additions Am
     C                     Z-ADDWN0048    PACBPR           TH Payment Gros
     C                     Z-ADDWN0049    PACCPR           Th Payment Net
     C                     Z-ADDWN0050    PALPNB           TH AP Voucher/D
     C                     Z-ADDWN0051    PACDPR           TH Freight Amou
     C                     Z-ADDWN0052    PAA7VA           TH Accrual Amou
     C                     Z-ADDWN0053    PAA2PR           TH Fixed Cost A
     C                     MOVELWN0054    PAJWST    P      TH Calc Net Sts
     C                     MOVELWN0055    PACWST    P      TH Payment Sts
     C                     MOVEL*BLANK    PAD6ST    P      TH Bal to Kill
     C                     Z-ADDWN0057    PAGHNB           TH Commission A
     C                     Z-ADDWN0058    PABYDT           TH Voucher Paym
     C                     MOVELWN0059    PAE0ST    P      TH User Error O
     C                     MOVELWN0060    PAE1ST    P      TH Held Over Re
     C                     MOVELWN0061    PAE2ST    P      TH Sex
     C                     Z-ADDWN0062    PABSDT           TH Held/Ovr Com
     C                     Z-ADDWN0063    PABTDT           TH Commission P
     C                     Z-ADDWN0064    PABUDT           TH Actual Check
     C                     Z-ADDWN0065    PAHGNB           TH Shipped Weig
     C                     Z-ADDWN0066    PAHHNB           TH Avg Hot Wgt
     C                     Z-ADDWN0067    PAHINB           TH FFLI
     C                     Z-ADDWN0068    PAA3PR           TH Kill Product
     C                     Z-ADDWN0069    PAA4PR           TH Cut Product
     C                     Z-ADDWN0070    PAA6PR           TH Render Produ
     C                     Z-ADDWN0071    PAJ9NB           TH Head Exclude
     C                     Z-ADDWN0072    PAD6PR           TH CM Bse Mkt L
     C                     Z-ADDWN0073    PAD7PR           TH CM Bse Mkt C
     C                     Z-ADDWN0074    PAD8PR           TH CM Srt Dsc L
     C                     Z-ADDWN0075    PAD9PR           TH CM Srt Dsc C
     C                     Z-ADDWN0076    PAEAPR           TH CM Yld G/L L
     C                     Z-ADDWN0077    PAEBPR           TH CM Yld G/L C
     C                     Z-ADDWN0078    PAECPR           TH CM Crc Val L
     C                     Z-ADDWN0079    PAEDPR           TH CM Crc Val C
     C                     Z-ADDWN0080    PAEEPR           TH CM Lean Prem
     C                     Z-ADDWN0081    PAEFPR           TH CM Lean Prem
     C                     Z-ADDWN0082    PAEGPR           TH CM Gross Liv
     C                     Z-ADDWN0083    PAEHPR           TH CM Gross Car
     C                     MOVELWN0084    PAKAST    P      TH Source Type
     C                     MOVELWN0085    PAJ7ST    P      TH Scale Ticket
     C                     MOVELWN0086    PAJ9ST    P      TH Payment Type
     C                     Z-ADDWN0087    PAOXNB           TH HPS Movement
     C                     MOVELWN0088    PALKST    P      TH Source Code
     C                     MOVELWN0089    PALLST    P      TH Hog Class Ty
     C                     MOVELWN0090    PAJ8ST    P      TH Posted to HP
     C                     MOVELWN0091    PALIST    P      TH Schedule Kil
     C                     MOVELWN0092    PALJST    P      TH Shift Held O
     C                     MOVELWN0093    PABDCD    P      DF Defect Code
     C                     MOVELWN0094    PACSCD    P      THP Process Cod
     C                     MOVELWN0095    PAABCD    P      PD Producer Cod
     C                     MOVELWN0096    PAAECD    P      PL Location Cod
     C                     MOVELWN0097    PAACCD    P      HB Buyer Code
     C                     MOVELWN0098    PAAGCD    P      GN Genetic Code
     C                     MOVELWN0099    PABECD    P      HC Class Code
     C                     MOVELWN0100    PAAAVN    P      RS User Changed
     C                     Z-ADDWN0101    PAAADT           RS Date Changed
     C                     Z-ADDWN0102    PAAMTM           RS Time Changed
     C                     MOVELWN0103    PAAJST    P      RS Record Statu
     C                     MOVELWN0104    PAAHVN    P      RS Job
     C                     MOVELWN0105    PAAGVN    P      RS Program
     C                     MOVELWN0106    PAABVN    P      RS User Added
     C                     Z-ADDWN0107    PAABDT           RS Date Added
     C                     Z-ADDWN0108    PAABTM           RS Time Added
      *
     C                     CALL 'PKAAXFR'              90  Bal/Val Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Tattoo Hea
     C                     PARM YL0001    WQ0079  71       Carcass Dbw Min
     C                     PARM YL0002    WQ0080  71       Carcass Dbw Max
     C                     PARM YL0003    WQ0081  71       Carcass Lgt Min
     C                     PARM YL0004    WQ0082  71       Carcass Lgt Max
     C                     PARM YL0005    WQ0083  71       %Lean High Min
     C                     PARM YL0006    WQ0084  71       %Lean High Max
     C                     PARM YL0007    WQ0085  71       %Lean Low Min
     C                     PARM YL0008    WQ0086  71       %Lean Low Max
     C                     PARM YL0009    WQ0087  71       High Yield Min
     C                     PARM YL0010    WQ0088  71       High Yield Max
     C                     PARM YL0011    WQ0089  71       Low Yield Min
     C                     PARM YL0012    WQ0090  71       Low Yield Max
     C                     PARM YL0013    WQ0091  71       Head < Percent
     C                     PARM YL0014    WQ0092  71       Head < Percent
     C                     PARM YL0015    WQ0093  71       Head > Percent
     C                     PARM YL0016    WQ0094  71       Head > Percent
     C                     PARM YL0017    WQ0095  71       BackFat High Mi
     C                     PARM YL0018    WQ0096  71       BackFat High Ma
     C                     PARM YL0019    WQ0097  71       BackFat Low Min
     C                     PARM YL0020    WQ0098  71       Backfat Low Max
     C                     PARM YL0021    WQ0099  71       LoinEye High Mi
     C                     PARM YL0022    WQ0100  71       LoinEye High Ma
     C                     PARM YL0023    WQ0101  71       LoinEye Low Min
     C                     PARM YL0024    WQ0102  71       LoinEye Low Max
     C                     PARM 'N'       WQ0103  1        Requested by Us
     C                     PARM *BLANK    WQ0104  1        Bal w/History
     C                     PARM *BLANK    WQ0105  1        TH PHA Add Type
     C                     PARM *BLANK    WQ0106  3        TH PHA Average
     C                     PARM *BLANK    WQ0107  1        TH PHA Add Reas
     C                     PARM 0         WQ0108  51       PH GA Avg Live
     C                     PARM 0         WQ0109  52       PH GA Adjusted
     C                     PARM 0         WQ0110  31       PH GA Avg Lean%
     C                     PARM 0         WQ0111  31       PH GA Avg Backf
     C                     PARM 0         WQ0112  31       PH GA Avg Loin
     C                     PARM 0         WQ0113  31       PH GA Avg Light
     C                     PARM 0         WQ0114  52       PH GA Lean Prm
     C                     PARM 0         WQ0115  53       PH GA Avg Srt D
     C                     PARM 'N'       WQ0116  1        Undo MPR USR
     C           YL0139    PARM *BLANK    WQ0117  1        Balance First D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Balance Held From Date.
      * RMC chg to PAR to pick up orig kill date fields - and moved up
      *      to run only if a transfer is necessary     6/11/18
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv/Trnsfr Eval Trns  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSD01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSD02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSD03           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQSD04           TH Tattoo Numbe
     C           *LIKE     DEFN WBB0DT    WQSD05           TH Kill Date
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           BOH Company Num
     C                     KFLD           WQSD02           BOH Buy Order N
     C                     KFLD           WQSD03           BOL Load Number
     C                     KFLD           WQSD04           TH Tattoo Numbe
     C                     KFLD           WQSD05           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    WQSD01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSD02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSD03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSD04           TH Tattoo Numbe
     C                     Z-ADDYL0138    WQSD05           TH Kill Date
      * Establish starting position
     C           KRSSD     SETLL@BVCPQ9                    *
     C           KRSSD     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Transfer Carcasses    USR is GT Zero
     C           YL0136    IFGT 0                          *IF
      * 9/29/2010 slm check for deleted record
      * do not move the record if this is a deleted record
      * CASE: DB1.RS Record Status is Flag for Purge
     C           WBAJST    IFEQ 'D'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR SERVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR SFCRRC
      * Dlt Eval Trans        DL - Eval Trans  * 
     C                     EXSR SGDLRC
     C                     SUB  1         YL0136           Transfer Carcas
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHSNB    WQSE01           ET Company Numb
     C           *LIKE     DEFN WCA9DT    WQSE02           ET Kill Date
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           ET Company Numb
     C                     KFLD           WQSE02           ET Kill Date
      * Setup key
     C                     Z-ADDWBHSNB    WQSE01           ET Company Numb
     C                     Z-ADDYL0137    WQSE02           ET Kill Date
      * Establish starting position
     C           KRSSE     SETLL@BVCPNE                    *
     C           KRSSE     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUFJNB           ET Scale Sequen
     C                     GOTO SEEXIT                     *QUIT
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WCFJNB    IFGE 000001                     *IF
     C           WCFJNB    ANDLE699999
     C           WCFJNB    ADD  1         WUFJNB           ET Scale Sequen
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSE     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDWBHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDYL0137    WDA9DT           ET Kill Date
     C                     Z-ADDWUFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWBHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWBGDNB    WDGDNB           ET Carcass Numb
     C                     Z-ADD#1CVNB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDWBLKNB    WDLKNB           ET Lot
     C                     MOVELWBEAST    WDEAST           ET Shift
     C                     Z-ADDWBAMPC    WDAMPC           ET Hot Wgt
     C                     Z-ADDWBAIPC    WDAIPC           ET Backfat Thic
     C                     Z-ADDWBAJPC    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDWBAKPC    WDAKPC           ET Lean Percent
     C                     Z-ADDWBX8NB    WDX8NB           ET Backfat Thic
     C                     Z-ADDWBFVPC    WDFVPC           ET Loineye Dept
     C                     Z-ADDWBFWPC    WDFWPC           ET Light Reflec
     C                     Z-ADDWBFXPC    WDFXPC           ET Lean Percent
     C                     Z-ADDWBALPC    WDALPC           ET Light Reflec
     C                     MOVELWBDIST    WDDIST           ET Trim Area
     C                     MOVELWBFYST    WDFYST           ET Carcass Sex
     C                     MOVELWBD2ST    WDD2ST           ET Error Sts
     C                     MOVELWBEHST    WDEHST           ET Record Add/D
     C                     MOVELWBG1ST    WDG1ST           ET Record Creat
     C                     MOVELWBH4ST    WDH4ST           ET Record Creat
     C                     MOVELWBJLST    WDJLST           ET User Error O
     C                     MOVELWBUUST    WDUUST           ET Adjust/Add T
     C                     MOVELWBVHST    WDVHST           ET Broken Back
     C                     MOVELWBVIST    WDVIST           ET Unused Sts 2
     C                     MOVELWBVJST    WDVJST           ET Adjust/Add S
     C                     MOVELWBVKST    WDVKST           ET Unused Sts 4
     C                     MOVELWBVLST    WDVLST           ET Unused Sts 5
     C                     Z-ADDWBHMNB    WDHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WDBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDYL0137    WDB0DT           TH Kill Date
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD0         WDAADT           RS Date Changed
     C                     Z-ADD0         WDAMTM           RS Time Changed
     C                     MOVELWBAJST    WDAJST           RS Record Statu
     C                     MOVELWBAHVN    WDAHVN           RS Job
     C                     MOVELWBAGVN    WDAGVN           RS Program
     C                     MOVELWBABVN    WDABVN           RS User Added
     C                     Z-ADDWBABDT    WDABDT           RS Date Added
     C                     Z-ADDWBABTM    WDABTM           RS Time Added
     C                     Z-ADDWBB8DT    WDB8DT           RU Date
     C                     Z-ADDWBAOTM    WDAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRSF    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRSF    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGDLRC    BEGSR
      *================================================================
      * Dlt Eval Trans        DL - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BVCPF0
     C                     Z-ADDWBHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWBA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWBFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWBHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWBGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLDLSG    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLDLSG    CHAIN@BVCPF0              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BVCPF0                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADDA1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADDA1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    A1BONB           BOL Load Number
     C                     Z-ADDA1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADDYL0137    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSH     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           TH Purchase Dat
     C                     MOVEL*BLANK    WN0002           TH Group Refere
     C                     MOVEL*BLANK    WN0003           TH Live Purchas
     C                     Z-ADD*ZERO     WN0004           TH Live Purchas
     C                     Z-ADD*ZERO     WN0005           TH Live Gross A
     C                     Z-ADD*ZERO     WN0006           TH LIve Net Amt
     C                     MOVEL*BLANK    WN0007           TH Resale UOM
     C                     Z-ADD*ZERO     WN0008           TH Recalc Live
     C                     Z-ADD*ZERO     WN0009           TH Pricing Date
     C                     MOVEL*BLANK    WN0010           TH Resale Sprea
     C                     Z-ADD*ZERO     WN0011           TH Dead On Arri
     C                     Z-ADD*ZERO     WN0012           TH Head Receive
     C                     Z-ADD*ZERO     WN0013           TH Yard Deads
     C                     Z-ADD*ZERO     WN0014           TH Held Over
     C                     Z-ADD*ZERO     WN0015           TH Head Condemn
     C                     Z-ADD*ZERO     WN0016           TH Head Killed
     C                     Z-ADD*ZERO     WN0017           TH Head Adds
     C                     Z-ADD*ZERO     WN0018           TH Head Accepte
     C                     Z-ADD*ZERO     WN0019           TH Live Wgt
     C                     Z-ADD*ZERO     WN0020           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0021           TH Hot Wgt
     C                     Z-ADD*ZERO     WN0022           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0023           TH Tot Backfat
     C                     Z-ADD*ZERO     WN0024           TH Tot Light Re
     C                     Z-ADD*ZERO     WN0025           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0026           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0027           TH Avg Light Re
     C                     Z-ADD*ZERO     WN0028           TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0029           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0030           TH Avg Backfat
     C                     Z-ADD*ZERO     WN0031           TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0032           TH Actual Yield
     C                     Z-ADD*ZERO     WN0033           TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0034           TH Yield Differ
     C                     Z-ADD*ZERO     WN0035           TH Recalc Live
     C                     Z-ADD*ZERO     WN0036           TH CM Market Pr
     C                     Z-ADD*ZERO     WN0037           TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0038           TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0039           TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0040           TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0041           TH CM Base Carc
     C                     Z-ADD*ZERO     WN0042           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0043           TH CM Carcass G
     C                     Z-ADD*ZERO     WN0044           TH Deduction Am
     C                     Z-ADD*ZERO     WN0045           TH Total Net WO
     C                     Z-ADD*ZERO     WN0046           TH Carcass Net
     C                     Z-ADD*ZERO     WN0047           TH Additions Am
     C                     Z-ADD*ZERO     WN0048           TH Payment Gros
     C                     Z-ADD*ZERO     WN0049           Th Payment Net
     C                     Z-ADD*ZERO     WN0050           TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0051           TH Freight Amou
     C                     Z-ADD*ZERO     WN0052           TH Accrual Amou
     C                     Z-ADD*ZERO     WN0053           TH Fixed Cost A
     C                     MOVEL*BLANK    WN0054           TH Calc Net Sts
     C                     MOVEL*BLANK    WN0055           TH Payment Sts
     C                     MOVEL*BLANK    WN0056           TH Bal to Kill
     C                     Z-ADD*ZERO     WN0057           TH Commission A
     C                     Z-ADD*ZERO     WN0058           TH Voucher Paym
     C                     MOVEL*BLANK    WN0059           TH User Error O
     C                     MOVEL*BLANK    WN0060           TH Held Over Re
     C                     MOVEL*BLANK    WN0061           TH Sex
     C                     Z-ADD*ZERO     WN0062           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0063           TH Commission P
     C                     Z-ADD*ZERO     WN0064           TH Actual Check
     C                     Z-ADD*ZERO     WN0065           TH Shipped Weig
     C                     Z-ADD*ZERO     WN0066           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0067           TH FFLI
     C                     Z-ADD*ZERO     WN0068           TH Kill Product
     C                     Z-ADD*ZERO     WN0069           TH Cut Product
     C                     Z-ADD*ZERO     WN0070           TH Render Produ
     C                     Z-ADD*ZERO     WN0071           TH Head Exclude
     C                     Z-ADD*ZERO     WN0072           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0073           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0074           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0075           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0076           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0077           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0078           TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0079           TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0080           TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0081           TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0082           TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0083           TH CM Gross Car
     C                     MOVEL*BLANK    WN0084           TH Source Type
     C                     MOVEL*BLANK    WN0085           TH Scale Ticket
     C                     MOVEL*BLANK    WN0086           TH Payment Type
     C                     Z-ADD*ZERO     WN0087           TH HPS Movement
     C                     MOVEL*BLANK    WN0088           TH Source Code
     C                     MOVEL*BLANK    WN0089           TH Hog Class Ty
     C                     MOVEL*BLANK    WN0090           TH Posted to HP
     C                     MOVEL*BLANK    WN0091           TH Schedule Kil
     C                     MOVEL*BLANK    WN0092           TH Shift Held O
     C                     MOVEL*BLANK    WN0093           DF Defect Code
     C                     MOVEL*BLANK    WN0094           THP Process Cod
     C                     MOVEL*BLANK    WN0095           PD Producer Cod
     C                     MOVEL*BLANK    WN0096           PL Location Cod
     C                     MOVEL*BLANK    WN0097           HB Buyer Code
     C                     MOVEL*BLANK    WN0098           GN Genetic Code
     C                     MOVEL*BLANK    WN0099           HC Class Code
     C                     MOVEL*BLANK    WN0100           RS User Changed
     C                     Z-ADD*ZERO     WN0101           RS Date Changed
     C                     Z-ADD*ZERO     WN0102           RS Time Changed
     C                     MOVEL*BLANK    WN0103           RS Record Statu
     C                     MOVEL*BLANK    WN0104           RS Job
     C                     MOVEL*BLANK    WN0105           RS Program
     C                     MOVEL*BLANK    WN0106           RS User Added
     C                     Z-ADD*ZERO     WN0107           RS Date Added
     C                     Z-ADD*ZERO     WN0108           RS Time Added
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA1AWDT    WN0001           TH Purchase Dat
     C                     MOVELA1BICD    WN0002           TH Group Refere
     C                     MOVELA1CPST    WN0003           TH Live Purchas
     C                     Z-ADDA1ACPR    WN0004           TH Live Purchas
     C                     Z-ADDA1B9PR    WN0005           TH Live Gross A
     C                     Z-ADDA1CAPR    WN0006           TH LIve Net Amt
     C                     MOVELA1C4ST    WN0007           TH Resale UOM
     C                     Z-ADDA1AIPR    WN0008           TH Recalc Live
     C                     Z-ADDA1A6DT    WN0009           TH Pricing Date
     C                     MOVELA1C2ST    WN0010           TH Resale Sprea
     C                     Z-ADDA1CXNB    WN0011           TH Dead On Arri
     C                     Z-ADDA1CWNB    WN0012           TH Head Receive
     C                     Z-ADDA1FCNB    WN0013           TH Yard Deads
     C                     Z-ADDA1H9NB    WN0014           TH Held Over
     C                     Z-ADDA1FDNB    WN0015           TH Head Condemn
     C                     Z-ADDA1FENB    WN0016           TH Head Killed
     C                     Z-ADDA1HENB    WN0017           TH Head Adds
     C                     Z-ADDA1HFNB    WN0018           TH Head Accepte
     C                     Z-ADDA1CYNB    WN0019           TH Live Wgt
     C                     Z-ADDA1LRNB    WN0020           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    WN0021           TH Hot Wgt
     C                     Z-ADDA1A5PC    WN0022           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    WN0023           TH Tot Backfat
     C                     Z-ADDA1A4PC    WN0024           TH Tot Light Re
     C                     Z-ADDA1F7NB    WN0025           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    WN0026           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    WN0027           TH Avg Light Re
     C                     Z-ADDA1F4NB    WN0028           TH Avg Lean Per
     C                     Z-ADDA1F3NB    WN0029           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    WN0030           TH Avg Backfat
     C                     Z-ADDA1AVPC    WN0031           TH Std Yield Pe
     C                     Z-ADDA1AWPC    WN0032           TH Actual Yield
     C                     Z-ADDA1CWPC    WN0033           TH Adj Actual Y
     C                     Z-ADDA1A8PC    WN0034           TH Yield Differ
     C                     Z-ADDA1A7PC    WN0035           TH Recalc Live
     C                     Z-ADDA1B8PR    WN0036           TH CM Market Pr
     C                     Z-ADDA1AMPR    WN0037           TH CM Base Mkt
     C                     Z-ADDA1ANPR    WN0038           TH CM Base Mkt
     C                     Z-ADDA1AYVA    WN0039           TH CM Sort Disc
     C                     Z-ADDA1AWVA    WN0040           TH CM Yield Gai
     C                     Z-ADDA1AOPR    WN0041           TH CM Base Carc
     C                     Z-ADDA1AXVA    WN0042           TH CM LN AddOn/
     C                     Z-ADDA1APPR    WN0043           TH CM Carcass G
     C                     Z-ADDA1ASPR    WN0044           TH Deduction Am
     C                     Z-ADDA1A4VA    WN0045           TH Total Net WO
     C                     Z-ADDA1ATPR    WN0046           TH Carcass Net
     C                     Z-ADDA1A5VA    WN0047           TH Additions Am
     C                     Z-ADDA1CBPR    WN0048           TH Payment Gros
     C                     Z-ADDA1CCPR    WN0049           Th Payment Net
     C                     Z-ADDA1LPNB    WN0050           TH AP Voucher/D
     C                     Z-ADDA1CDPR    WN0051           TH Freight Amou
     C                     Z-ADDA1A7VA    WN0052           TH Accrual Amou
     C                     Z-ADDA1A2PR    WN0053           TH Fixed Cost A
     C                     MOVELA1JWST    WN0054           TH Calc Net Sts
     C                     MOVELA1CWST    WN0055           TH Payment Sts
     C                     MOVELA1D6ST    WN0056           TH Bal to Kill
     C                     Z-ADDA1GHNB    WN0057           TH Commission A
     C                     Z-ADDA1BYDT    WN0058           TH Voucher Paym
     C                     MOVELA1E0ST    WN0059           TH User Error O
     C                     MOVELA1E1ST    WN0060           TH Held Over Re
     C                     MOVELA1E2ST    WN0061           TH Sex
     C                     Z-ADDA1BSDT    WN0062           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    WN0063           TH Commission P
     C                     Z-ADDA1BUDT    WN0064           TH Actual Check
     C                     Z-ADDA1HGNB    WN0065           TH Shipped Weig
     C                     Z-ADDA1HHNB    WN0066           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    WN0067           TH FFLI
     C                     Z-ADDA1A3PR    WN0068           TH Kill Product
     C                     Z-ADDA1A4PR    WN0069           TH Cut Product
     C                     Z-ADDA1A6PR    WN0070           TH Render Produ
     C                     Z-ADDA1J9NB    WN0071           TH Head Exclude
     C                     Z-ADDA1D6PR    WN0072           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    WN0073           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    WN0074           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    WN0075           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    WN0076           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    WN0077           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    WN0078           TH CM Crc Val L
     C                     Z-ADDA1EDPR    WN0079           TH CM Crc Val C
     C                     Z-ADDA1EEPR    WN0080           TH CM Lean Prem
     C                     Z-ADDA1EFPR    WN0081           TH CM Lean Prem
     C                     Z-ADDA1EGPR    WN0082           TH CM Gross Liv
     C                     Z-ADDA1EHPR    WN0083           TH CM Gross Car
     C                     MOVELA1KAST    WN0084           TH Source Type
     C                     MOVELA1J7ST    WN0085           TH Scale Ticket
     C                     MOVELA1J9ST    WN0086           TH Payment Type
     C                     Z-ADDA1OXNB    WN0087           TH HPS Movement
     C                     MOVELA1LKST    WN0088           TH Source Code
     C                     MOVELA1LLST    WN0089           TH Hog Class Ty
     C                     MOVELA1J8ST    WN0090           TH Posted to HP
     C                     MOVELA1LIST    WN0091           TH Schedule Kil
     C                     MOVELA1LJST    WN0092           TH Shift Held O
     C                     MOVELA1BDCD    WN0093           DF Defect Code
     C                     MOVELA1CSCD    WN0094           THP Process Cod
     C                     MOVELA1ABCD    WN0095           PD Producer Cod
     C                     MOVELA1AECD    WN0096           PL Location Cod
     C                     MOVELA1ACCD    WN0097           HB Buyer Code
     C                     MOVELA1AGCD    WN0098           GN Genetic Code
     C                     MOVELA1BECD    WN0099           HC Class Code
     C                     MOVELA1AAVN    WN0100           RS User Changed
     C                     Z-ADDA1AADT    WN0101           RS Date Changed
     C                     Z-ADDA1AMTM    WN0102           RS Time Changed
     C                     MOVELA1AJST    WN0103           RS Record Statu
     C                     MOVELA1AHVN    WN0104           RS Job
     C                     MOVELA1AGVN    WN0105           RS Program
     C                     MOVELA1ABVN    WN0106           RS User Added
     C                     Z-ADDA1ABDT    WN0107           RS Date Added
     C                     Z-ADDA1ABTM    WN0108           RS Time Added
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv/Trnsfr Eval Trns  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSI01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSI02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSI03           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQSI04           TH Tattoo Numbe
     C           *LIKE     DEFN WBB0DT    WQSI05           TH Kill Date
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           BOH Company Num
     C                     KFLD           WQSI02           BOH Buy Order N
     C                     KFLD           WQSI03           BOL Load Number
     C                     KFLD           WQSI04           TH Tattoo Numbe
     C                     KFLD           WQSI05           TH Kill Date
      * Setup key
     C                     Z-ADDA1HMNB    WQSI01           BOH Company Num
     C                     Z-ADDA1BNNB    WQSI02           BOH Buy Order N
     C                     Z-ADDA1BONB    WQSI03           BOL Load Number
     C                     Z-ADDA1CVNB    WQSI04           TH Tattoo Numbe
     C                     Z-ADDYL0137    WQSI05           TH Kill Date
      * Establish starting position
     C           KRSSI     SETLL@BVCPQ9                    *
     C           KRSSI     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Transfer Carcasses    USR is GT Zero
     C           YL0136    IFGT 0                          *IF
      * 9/29/2010 slm check for deleted record
      * do not move the record if this is a deleted record
      * CASE: DB1.RS Record Status is Flag for Purge
     C           WBAJST    IFEQ 'D'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR SJRVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR SKCRRC
      * Dlt Eval Trans        DL - Eval Trans  * 
     C                     EXSR SLDLRC
     C                     SUB  1         YL0136           Transfer Carcas
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSI     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHSNB    WQSJ01           ET Company Numb
     C           *LIKE     DEFN WCA9DT    WQSJ02           ET Kill Date
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           ET Company Numb
     C                     KFLD           WQSJ02           ET Kill Date
      * Setup key
     C                     Z-ADDWBHSNB    WQSJ01           ET Company Numb
     C                     Z-ADDYL0138    WQSJ02           ET Kill Date
      * Establish starting position
     C           KRSSJ     SETLL@BVCPNE                    *
     C           KRSSJ     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUFJNB           ET Scale Sequen
     C                     GOTO SJEXIT                     *QUIT
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WCFJNB    IFGE 000001                     *IF
     C           WCFJNB    ANDLE699999
     C           WCFJNB    ADD  1         WUFJNB           ET Scale Sequen
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSJ     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDWBHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDYL0138    WDA9DT           ET Kill Date
     C                     Z-ADDWUFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWBHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWBGDNB    WDGDNB           ET Carcass Numb
     C                     Z-ADDA1CVNB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDWBLKNB    WDLKNB           ET Lot
     C                     MOVELWBEAST    WDEAST           ET Shift
     C                     Z-ADDWBAMPC    WDAMPC           ET Hot Wgt
     C                     Z-ADDWBAIPC    WDAIPC           ET Backfat Thic
     C                     Z-ADDWBAJPC    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDWBAKPC    WDAKPC           ET Lean Percent
     C                     Z-ADDWBX8NB    WDX8NB           ET Backfat Thic
     C                     Z-ADDWBFVPC    WDFVPC           ET Loineye Dept
     C                     Z-ADDWBFWPC    WDFWPC           ET Light Reflec
     C                     Z-ADDWBFXPC    WDFXPC           ET Lean Percent
     C                     Z-ADDWBALPC    WDALPC           ET Light Reflec
     C                     MOVELWBDIST    WDDIST           ET Trim Area
     C                     MOVELWBFYST    WDFYST           ET Carcass Sex
     C                     MOVELWBD2ST    WDD2ST           ET Error Sts
     C                     MOVELWBEHST    WDEHST           ET Record Add/D
     C                     MOVELWBG1ST    WDG1ST           ET Record Creat
     C                     MOVELWBH4ST    WDH4ST           ET Record Creat
     C                     MOVELWBJLST    WDJLST           ET User Error O
     C                     MOVELWBUUST    WDUUST           ET Adjust/Add T
     C                     MOVELWBVHST    WDVHST           ET Broken Back
     C                     MOVELWBVIST    WDVIST           ET Unused Sts 2
     C                     MOVELWBVJST    WDVJST           ET Adjust/Add S
     C                     MOVELWBVKST    WDVKST           ET Unused Sts 4
     C                     MOVELWBVLST    WDVLST           ET Unused Sts 5
     C                     Z-ADDWBHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    WDBONB           BOL Load Number
     C                     Z-ADDA1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDYL0138    WDB0DT           TH Kill Date
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD0         WDAADT           RS Date Changed
     C                     Z-ADD0         WDAMTM           RS Time Changed
     C                     MOVELWBAJST    WDAJST           RS Record Statu
     C                     MOVELWBAHVN    WDAHVN           RS Job
     C                     MOVELWBAGVN    WDAGVN           RS Program
     C                     MOVELWBABVN    WDABVN           RS User Added
     C                     Z-ADDWBABDT    WDABDT           RS Date Added
     C                     Z-ADDWBABTM    WDABTM           RS Time Added
     C                     Z-ADDWBB8DT    WDB8DT           RU Date
     C                     Z-ADDWBAOTM    WDAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRSK    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRSK    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLDLRC    BEGSR
      *================================================================
      * Dlt Eval Trans        DL - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BVCPF0
     C                     Z-ADDWBHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWBA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWBFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWBHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWBGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLDLSL    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLDLSL    CHAIN@BVCPF0              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BVCPF0                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADDA1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADDA1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    A1BONB           BOL Load Number
     C                     Z-ADDA1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADDYL0137    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSM     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           TH Purchase Dat
     C                     MOVEL*BLANK    WN0002           TH Group Refere
     C                     MOVEL*BLANK    WN0003           TH Live Purchas
     C                     Z-ADD*ZERO     WN0004           TH Live Purchas
     C                     Z-ADD*ZERO     WN0005           TH Live Gross A
     C                     Z-ADD*ZERO     WN0006           TH LIve Net Amt
     C                     MOVEL*BLANK    WN0007           TH Resale UOM
     C                     Z-ADD*ZERO     WN0008           TH Recalc Live
     C                     Z-ADD*ZERO     WN0009           TH Pricing Date
     C                     MOVEL*BLANK    WN0010           TH Resale Sprea
     C                     Z-ADD*ZERO     WN0011           TH Dead On Arri
     C                     Z-ADD*ZERO     WN0012           TH Head Receive
     C                     Z-ADD*ZERO     WN0013           TH Yard Deads
     C                     Z-ADD*ZERO     WN0014           TH Held Over
     C                     Z-ADD*ZERO     WN0015           TH Head Condemn
     C                     Z-ADD*ZERO     WN0016           TH Head Killed
     C                     Z-ADD*ZERO     WN0017           TH Head Adds
     C                     Z-ADD*ZERO     WN0018           TH Head Accepte
     C                     Z-ADD*ZERO     WN0019           TH Live Wgt
     C                     Z-ADD*ZERO     WN0020           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0021           TH Hot Wgt
     C                     Z-ADD*ZERO     WN0022           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0023           TH Tot Backfat
     C                     Z-ADD*ZERO     WN0024           TH Tot Light Re
     C                     Z-ADD*ZERO     WN0025           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0026           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0027           TH Avg Light Re
     C                     Z-ADD*ZERO     WN0028           TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0029           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0030           TH Avg Backfat
     C                     Z-ADD*ZERO     WN0031           TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0032           TH Actual Yield
     C                     Z-ADD*ZERO     WN0033           TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0034           TH Yield Differ
     C                     Z-ADD*ZERO     WN0035           TH Recalc Live
     C                     Z-ADD*ZERO     WN0036           TH CM Market Pr
     C                     Z-ADD*ZERO     WN0037           TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0038           TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0039           TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0040           TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0041           TH CM Base Carc
     C                     Z-ADD*ZERO     WN0042           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0043           TH CM Carcass G
     C                     Z-ADD*ZERO     WN0044           TH Deduction Am
     C                     Z-ADD*ZERO     WN0045           TH Total Net WO
     C                     Z-ADD*ZERO     WN0046           TH Carcass Net
     C                     Z-ADD*ZERO     WN0047           TH Additions Am
     C                     Z-ADD*ZERO     WN0048           TH Payment Gros
     C                     Z-ADD*ZERO     WN0049           Th Payment Net
     C                     Z-ADD*ZERO     WN0050           TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0051           TH Freight Amou
     C                     Z-ADD*ZERO     WN0052           TH Accrual Amou
     C                     Z-ADD*ZERO     WN0053           TH Fixed Cost A
     C                     MOVEL*BLANK    WN0054           TH Calc Net Sts
     C                     MOVEL*BLANK    WN0055           TH Payment Sts
     C                     MOVEL*BLANK    WN0056           TH Bal to Kill
     C                     Z-ADD*ZERO     WN0057           TH Commission A
     C                     Z-ADD*ZERO     WN0058           TH Voucher Paym
     C                     MOVEL*BLANK    WN0059           TH User Error O
     C                     MOVEL*BLANK    WN0060           TH Held Over Re
     C                     MOVEL*BLANK    WN0061           TH Sex
     C                     Z-ADD*ZERO     WN0062           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0063           TH Commission P
     C                     Z-ADD*ZERO     WN0064           TH Actual Check
     C                     Z-ADD*ZERO     WN0065           TH Shipped Weig
     C                     Z-ADD*ZERO     WN0066           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0067           TH FFLI
     C                     Z-ADD*ZERO     WN0068           TH Kill Product
     C                     Z-ADD*ZERO     WN0069           TH Cut Product
     C                     Z-ADD*ZERO     WN0070           TH Render Produ
     C                     Z-ADD*ZERO     WN0071           TH Head Exclude
     C                     Z-ADD*ZERO     WN0072           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0073           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0074           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0075           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0076           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0077           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0078           TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0079           TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0080           TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0081           TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0082           TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0083           TH CM Gross Car
     C                     MOVEL*BLANK    WN0084           TH Source Type
     C                     MOVEL*BLANK    WN0085           TH Scale Ticket
     C                     MOVEL*BLANK    WN0086           TH Payment Type
     C                     Z-ADD*ZERO     WN0087           TH HPS Movement
     C                     MOVEL*BLANK    WN0088           TH Source Code
     C                     MOVEL*BLANK    WN0089           TH Hog Class Ty
     C                     MOVEL*BLANK    WN0090           TH Posted to HP
     C                     MOVEL*BLANK    WN0091           TH Schedule Kil
     C                     MOVEL*BLANK    WN0092           TH Shift Held O
     C                     MOVEL*BLANK    WN0093           DF Defect Code
     C                     MOVEL*BLANK    WN0094           THP Process Cod
     C                     MOVEL*BLANK    WN0095           PD Producer Cod
     C                     MOVEL*BLANK    WN0096           PL Location Cod
     C                     MOVEL*BLANK    WN0097           HB Buyer Code
     C                     MOVEL*BLANK    WN0098           GN Genetic Code
     C                     MOVEL*BLANK    WN0099           HC Class Code
     C                     MOVEL*BLANK    WN0100           RS User Changed
     C                     Z-ADD*ZERO     WN0101           RS Date Changed
     C                     Z-ADD*ZERO     WN0102           RS Time Changed
     C                     MOVEL*BLANK    WN0103           RS Record Statu
     C                     MOVEL*BLANK    WN0104           RS Job
     C                     MOVEL*BLANK    WN0105           RS Program
     C                     MOVEL*BLANK    WN0106           RS User Added
     C                     Z-ADD*ZERO     WN0107           RS Date Added
     C                     Z-ADD*ZERO     WN0108           RS Time Added
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA1AWDT    WN0001           TH Purchase Dat
     C                     MOVELA1BICD    WN0002           TH Group Refere
     C                     MOVELA1CPST    WN0003           TH Live Purchas
     C                     Z-ADDA1ACPR    WN0004           TH Live Purchas
     C                     Z-ADDA1B9PR    WN0005           TH Live Gross A
     C                     Z-ADDA1CAPR    WN0006           TH LIve Net Amt
     C                     MOVELA1C4ST    WN0007           TH Resale UOM
     C                     Z-ADDA1AIPR    WN0008           TH Recalc Live
     C                     Z-ADDA1A6DT    WN0009           TH Pricing Date
     C                     MOVELA1C2ST    WN0010           TH Resale Sprea
     C                     Z-ADDA1CXNB    WN0011           TH Dead On Arri
     C                     Z-ADDA1CWNB    WN0012           TH Head Receive
     C                     Z-ADDA1FCNB    WN0013           TH Yard Deads
     C                     Z-ADDA1H9NB    WN0014           TH Held Over
     C                     Z-ADDA1FDNB    WN0015           TH Head Condemn
     C                     Z-ADDA1FENB    WN0016           TH Head Killed
     C                     Z-ADDA1HENB    WN0017           TH Head Adds
     C                     Z-ADDA1HFNB    WN0018           TH Head Accepte
     C                     Z-ADDA1CYNB    WN0019           TH Live Wgt
     C                     Z-ADDA1LRNB    WN0020           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    WN0021           TH Hot Wgt
     C                     Z-ADDA1A5PC    WN0022           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    WN0023           TH Tot Backfat
     C                     Z-ADDA1A4PC    WN0024           TH Tot Light Re
     C                     Z-ADDA1F7NB    WN0025           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    WN0026           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    WN0027           TH Avg Light Re
     C                     Z-ADDA1F4NB    WN0028           TH Avg Lean Per
     C                     Z-ADDA1F3NB    WN0029           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    WN0030           TH Avg Backfat
     C                     Z-ADDA1AVPC    WN0031           TH Std Yield Pe
     C                     Z-ADDA1AWPC    WN0032           TH Actual Yield
     C                     Z-ADDA1CWPC    WN0033           TH Adj Actual Y
     C                     Z-ADDA1A8PC    WN0034           TH Yield Differ
     C                     Z-ADDA1A7PC    WN0035           TH Recalc Live
     C                     Z-ADDA1B8PR    WN0036           TH CM Market Pr
     C                     Z-ADDA1AMPR    WN0037           TH CM Base Mkt
     C                     Z-ADDA1ANPR    WN0038           TH CM Base Mkt
     C                     Z-ADDA1AYVA    WN0039           TH CM Sort Disc
     C                     Z-ADDA1AWVA    WN0040           TH CM Yield Gai
     C                     Z-ADDA1AOPR    WN0041           TH CM Base Carc
     C                     Z-ADDA1AXVA    WN0042           TH CM LN AddOn/
     C                     Z-ADDA1APPR    WN0043           TH CM Carcass G
     C                     Z-ADDA1ASPR    WN0044           TH Deduction Am
     C                     Z-ADDA1A4VA    WN0045           TH Total Net WO
     C                     Z-ADDA1ATPR    WN0046           TH Carcass Net
     C                     Z-ADDA1A5VA    WN0047           TH Additions Am
     C                     Z-ADDA1CBPR    WN0048           TH Payment Gros
     C                     Z-ADDA1CCPR    WN0049           Th Payment Net
     C                     Z-ADDA1LPNB    WN0050           TH AP Voucher/D
     C                     Z-ADDA1CDPR    WN0051           TH Freight Amou
     C                     Z-ADDA1A7VA    WN0052           TH Accrual Amou
     C                     Z-ADDA1A2PR    WN0053           TH Fixed Cost A
     C                     MOVELA1JWST    WN0054           TH Calc Net Sts
     C                     MOVELA1CWST    WN0055           TH Payment Sts
     C                     MOVELA1D6ST    WN0056           TH Bal to Kill
     C                     Z-ADDA1GHNB    WN0057           TH Commission A
     C                     Z-ADDA1BYDT    WN0058           TH Voucher Paym
     C                     MOVELA1E0ST    WN0059           TH User Error O
     C                     MOVELA1E1ST    WN0060           TH Held Over Re
     C                     MOVELA1E2ST    WN0061           TH Sex
     C                     Z-ADDA1BSDT    WN0062           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    WN0063           TH Commission P
     C                     Z-ADDA1BUDT    WN0064           TH Actual Check
     C                     Z-ADDA1HGNB    WN0065           TH Shipped Weig
     C                     Z-ADDA1HHNB    WN0066           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    WN0067           TH FFLI
     C                     Z-ADDA1A3PR    WN0068           TH Kill Product
     C                     Z-ADDA1A4PR    WN0069           TH Cut Product
     C                     Z-ADDA1A6PR    WN0070           TH Render Produ
     C                     Z-ADDA1J9NB    WN0071           TH Head Exclude
     C                     Z-ADDA1D6PR    WN0072           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    WN0073           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    WN0074           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    WN0075           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    WN0076           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    WN0077           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    WN0078           TH CM Crc Val L
     C                     Z-ADDA1EDPR    WN0079           TH CM Crc Val C
     C                     Z-ADDA1EEPR    WN0080           TH CM Lean Prem
     C                     Z-ADDA1EFPR    WN0081           TH CM Lean Prem
     C                     Z-ADDA1EGPR    WN0082           TH CM Gross Liv
     C                     Z-ADDA1EHPR    WN0083           TH CM Gross Car
     C                     MOVELA1KAST    WN0084           TH Source Type
     C                     MOVELA1J7ST    WN0085           TH Scale Ticket
     C                     MOVELA1J9ST    WN0086           TH Payment Type
     C                     Z-ADDA1OXNB    WN0087           TH HPS Movement
     C                     MOVELA1LKST    WN0088           TH Source Code
     C                     MOVELA1LLST    WN0089           TH Hog Class Ty
     C                     MOVELA1J8ST    WN0090           TH Posted to HP
     C                     MOVELA1LIST    WN0091           TH Schedule Kil
     C                     MOVELA1LJST    WN0092           TH Shift Held O
     C                     MOVELA1BDCD    WN0093           DF Defect Code
     C                     MOVELA1CSCD    WN0094           THP Process Cod
     C                     MOVELA1ABCD    WN0095           PD Producer Cod
     C                     MOVELA1AECD    WN0096           PL Location Cod
     C                     MOVELA1ACCD    WN0097           HB Buyer Code
     C                     MOVELA1AGCD    WN0098           GN Genetic Code
     C                     MOVELA1BECD    WN0099           HC Class Code
     C                     MOVELA1AAVN    WN0100           RS User Changed
     C                     Z-ADDA1AADT    WN0101           RS Date Changed
     C                     Z-ADDA1AMTM    WN0102           RS Time Changed
     C                     MOVELA1AJST    WN0103           RS Record Statu
     C                     MOVELA1AHVN    WN0104           RS Job
     C                     MOVELA1AGVN    WN0105           RS Program
     C                     MOVELA1ABVN    WN0106           RS User Added
     C                     Z-ADDA1ABDT    WN0107           RS Date Added
     C                     Z-ADDA1ABTM    WN0108           RS Time Added
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * Second Day: TH Kill
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A1BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSN     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0025           TH Purchase Dat
     C                     MOVEL*BLANK    YL0026           TH Group Refere
     C                     MOVEL*BLANK    YL0027           TH Live Purchas
     C                     Z-ADD*ZERO     YL0028           TH Live Purchas
     C                     Z-ADD*ZERO     YL0029           TH Live Gross A
     C                     Z-ADD*ZERO     YL0030           TH LIve Net Amt
     C                     MOVEL*BLANK    YL0031           TH Resale UOM
     C                     Z-ADD*ZERO     YL0032           TH Recalc Live
     C                     Z-ADD*ZERO     YL0033           TH Pricing Date
     C                     MOVEL*BLANK    YL0034           TH Resale Sprea
     C                     Z-ADD*ZERO     YL0035           TH Dead On Arri
     C                     Z-ADD*ZERO     YL0036           TH Head Receive
     C                     Z-ADD*ZERO     YL0037           TH Yard Deads
     C                     Z-ADD*ZERO     YL0038           TH Held Over
     C                     Z-ADD*ZERO     YL0039           TH Head Condemn
     C                     Z-ADD*ZERO     YL0040           TH Head Killed
     C                     Z-ADD*ZERO     YL0041           TH Head Adds
     C                     Z-ADD*ZERO     YL0042           TH Head Accepte
     C                     Z-ADD*ZERO     YL0043           TH Live Wgt
     C                     Z-ADD*ZERO     YL0044           TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0045           TH Hot Wgt
     C                     Z-ADD*ZERO     YL0046           TH Tot Loin Eye
     C                     Z-ADD*ZERO     YL0047           TH Tot Backfat
     C                     Z-ADD*ZERO     YL0048           TH Tot Light Re
     C                     Z-ADD*ZERO     YL0049           TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0050           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YL0051           TH Avg Light Re
     C                     Z-ADD*ZERO     YL0052           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0053           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0054           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0055           TH Std Yield Pe
     C                     Z-ADD*ZERO     YL0056           TH Actual Yield
     C                     Z-ADD*ZERO     YL0057           TH Adj Actual Y
     C                     Z-ADD*ZERO     YL0058           TH Yield Differ
     C                     Z-ADD*ZERO     YL0059           TH Recalc Live
     C                     Z-ADD*ZERO     YL0060           TH CM Market Pr
     C                     Z-ADD*ZERO     YL0061           TH CM Base Mkt
     C                     Z-ADD*ZERO     YL0062           TH CM Base Mkt
     C                     Z-ADD*ZERO     YL0063           TH CM Sort Disc
     C                     Z-ADD*ZERO     YL0064           TH CM Yield Gai
     C                     Z-ADD*ZERO     YL0065           TH CM Base Carc
     C                     Z-ADD*ZERO     YL0066           TH CM LN AddOn/
     C                     Z-ADD*ZERO     YL0067           TH CM Carcass G
     C                     Z-ADD*ZERO     YL0068           TH Deduction Am
     C                     Z-ADD*ZERO     YL0069           TH Total Net WO
     C                     Z-ADD*ZERO     YL0070           TH Carcass Net
     C                     Z-ADD*ZERO     YL0071           TH Additions Am
     C                     Z-ADD*ZERO     YL0072           TH Payment Gros
     C                     Z-ADD*ZERO     YL0073           Th Payment Net
     C                     Z-ADD*ZERO     YL0074           TH AP Voucher/D
     C                     Z-ADD*ZERO     YL0075           TH Freight Amou
     C                     Z-ADD*ZERO     YL0076           TH Accrual Amou
     C                     Z-ADD*ZERO     YL0077           TH Fixed Cost A
     C                     MOVEL*BLANK    YL0078           TH Calc Net Sts
     C                     MOVEL*BLANK    YL0079           TH Payment Sts
     C                     MOVEL*BLANK    YL0080           TH Bal to Kill
     C                     Z-ADD*ZERO     YL0081           TH Commission A
     C                     Z-ADD*ZERO     YL0082           TH Voucher Paym
     C                     MOVEL*BLANK    YL0083           TH User Error O
     C                     MOVEL*BLANK    YL0084           TH Held Over Re
     C                     MOVEL*BLANK    YL0085           TH Sex
     C                     Z-ADD*ZERO     YL0086           TH Held/Ovr Com
     C                     Z-ADD*ZERO     YL0087           TH Commission P
     C                     Z-ADD*ZERO     YL0088           TH Actual Check
     C                     Z-ADD*ZERO     YL0089           TH Shipped Weig
     C                     Z-ADD*ZERO     YL0090           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YL0091           TH FFLI
     C                     Z-ADD*ZERO     YL0092           TH Kill Product
     C                     Z-ADD*ZERO     YL0093           TH Cut Product
     C                     Z-ADD*ZERO     YL0094           TH Render Produ
     C                     Z-ADD*ZERO     YL0095           TH Head Exclude
     C                     Z-ADD*ZERO     YL0096           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     YL0097           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     YL0098           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     YL0099           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     YL0100           TH CM Yld G/L L
     C                     Z-ADD*ZERO     YL0101           TH CM Yld G/L C
     C                     Z-ADD*ZERO     YL0102           TH CM Crc Val L
     C                     Z-ADD*ZERO     YL0103           TH CM Crc Val C
     C                     Z-ADD*ZERO     YL0104           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0105           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0106           TH CM Gross Liv
     C                     Z-ADD*ZERO     YL0107           TH CM Gross Car
     C                     MOVEL*BLANK    YL0108           TH Source Type
     C                     MOVEL*BLANK    YL0109           TH Scale Ticket
     C                     MOVEL*BLANK    YL0110           TH Payment Type
     C                     Z-ADD*ZERO     YL0111           TH HPS Movement
     C                     MOVEL*BLANK    YL0112           TH Source Code
     C                     MOVEL*BLANK    YL0113           TH Hog Class Ty
     C                     MOVEL*BLANK    YL0114           TH Posted to HP
     C                     MOVEL*BLANK    YL0115           TH Schedule Kil
     C                     MOVEL*BLANK    YL0116           TH Shift Held O
     C                     MOVEL*BLANK    YL0117           DF Defect Code
     C                     MOVEL*BLANK    YL0118           THP Process Cod
     C                     MOVEL*BLANK    YL0119           PD Producer Cod
     C                     MOVEL*BLANK    YL0120           PL Location Cod
     C                     MOVEL*BLANK    YL0121           HB Buyer Code
     C                     MOVEL*BLANK    YL0122           GN Genetic Code
     C                     MOVEL*BLANK    YL0123           HC Class Code
     C                     MOVEL*BLANK    YL0124           RS User Changed
     C                     Z-ADD*ZERO     YL0125           RS Date Changed
     C                     Z-ADD*ZERO     YL0126           RS Time Changed
     C                     MOVEL*BLANK    YL0127           RS Record Statu
     C                     MOVEL*BLANK    YL0128           RS Job
     C                     MOVEL*BLANK    YL0129           RS Program
     C                     MOVEL*BLANK    YL0130           RS User Added
     C                     Z-ADD*ZERO     YL0131           RS Date Added
     C                     Z-ADD*ZERO     YL0132           RS Time Added
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA1AWDT    YL0025           TH Purchase Dat
     C                     MOVELA1BICD    YL0026           TH Group Refere
     C                     MOVELA1CPST    YL0027           TH Live Purchas
     C                     Z-ADDA1ACPR    YL0028           TH Live Purchas
     C                     Z-ADDA1B9PR    YL0029           TH Live Gross A
     C                     Z-ADDA1CAPR    YL0030           TH LIve Net Amt
     C                     MOVELA1C4ST    YL0031           TH Resale UOM
     C                     Z-ADDA1AIPR    YL0032           TH Recalc Live
     C                     Z-ADDA1A6DT    YL0033           TH Pricing Date
     C                     MOVELA1C2ST    YL0034           TH Resale Sprea
     C                     Z-ADDA1CXNB    YL0035           TH Dead On Arri
     C                     Z-ADDA1CWNB    YL0036           TH Head Receive
     C                     Z-ADDA1FCNB    YL0037           TH Yard Deads
     C                     Z-ADDA1H9NB    YL0038           TH Held Over
     C                     Z-ADDA1FDNB    YL0039           TH Head Condemn
     C                     Z-ADDA1FENB    YL0040           TH Head Killed
     C                     Z-ADDA1HENB    YL0041           TH Head Adds
     C                     Z-ADDA1HFNB    YL0042           TH Head Accepte
     C                     Z-ADDA1CYNB    YL0043           TH Live Wgt
     C                     Z-ADDA1LRNB    YL0044           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    YL0045           TH Hot Wgt
     C                     Z-ADDA1A5PC    YL0046           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    YL0047           TH Tot Backfat
     C                     Z-ADDA1A4PC    YL0048           TH Tot Light Re
     C                     Z-ADDA1F7NB    YL0049           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    YL0050           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    YL0051           TH Avg Light Re
     C                     Z-ADDA1F4NB    YL0052           TH Avg Lean Per
     C                     Z-ADDA1F3NB    YL0053           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    YL0054           TH Avg Backfat
     C                     Z-ADDA1AVPC    YL0055           TH Std Yield Pe
     C                     Z-ADDA1AWPC    YL0056           TH Actual Yield
     C                     Z-ADDA1CWPC    YL0057           TH Adj Actual Y
     C                     Z-ADDA1A8PC    YL0058           TH Yield Differ
     C                     Z-ADDA1A7PC    YL0059           TH Recalc Live
     C                     Z-ADDA1B8PR    YL0060           TH CM Market Pr
     C                     Z-ADDA1AMPR    YL0061           TH CM Base Mkt
     C                     Z-ADDA1ANPR    YL0062           TH CM Base Mkt
     C                     Z-ADDA1AYVA    YL0063           TH CM Sort Disc
     C                     Z-ADDA1AWVA    YL0064           TH CM Yield Gai
     C                     Z-ADDA1AOPR    YL0065           TH CM Base Carc
     C                     Z-ADDA1AXVA    YL0066           TH CM LN AddOn/
     C                     Z-ADDA1APPR    YL0067           TH CM Carcass G
     C                     Z-ADDA1ASPR    YL0068           TH Deduction Am
     C                     Z-ADDA1A4VA    YL0069           TH Total Net WO
     C                     Z-ADDA1ATPR    YL0070           TH Carcass Net
     C                     Z-ADDA1A5VA    YL0071           TH Additions Am
     C                     Z-ADDA1CBPR    YL0072           TH Payment Gros
     C                     Z-ADDA1CCPR    YL0073           Th Payment Net
     C                     Z-ADDA1LPNB    YL0074           TH AP Voucher/D
     C                     Z-ADDA1CDPR    YL0075           TH Freight Amou
     C                     Z-ADDA1A7VA    YL0076           TH Accrual Amou
     C                     Z-ADDA1A2PR    YL0077           TH Fixed Cost A
     C                     MOVELA1JWST    YL0078           TH Calc Net Sts
     C                     MOVELA1CWST    YL0079           TH Payment Sts
     C                     MOVELA1D6ST    YL0080           TH Bal to Kill
     C                     Z-ADDA1GHNB    YL0081           TH Commission A
     C                     Z-ADDA1BYDT    YL0082           TH Voucher Paym
     C                     MOVELA1E0ST    YL0083           TH User Error O
     C                     MOVELA1E1ST    YL0084           TH Held Over Re
     C                     MOVELA1E2ST    YL0085           TH Sex
     C                     Z-ADDA1BSDT    YL0086           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    YL0087           TH Commission P
     C                     Z-ADDA1BUDT    YL0088           TH Actual Check
     C                     Z-ADDA1HGNB    YL0089           TH Shipped Weig
     C                     Z-ADDA1HHNB    YL0090           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    YL0091           TH FFLI
     C                     Z-ADDA1A3PR    YL0092           TH Kill Product
     C                     Z-ADDA1A4PR    YL0093           TH Cut Product
     C                     Z-ADDA1A6PR    YL0094           TH Render Produ
     C                     Z-ADDA1J9NB    YL0095           TH Head Exclude
     C                     Z-ADDA1D6PR    YL0096           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    YL0097           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    YL0098           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    YL0099           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    YL0100           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    YL0101           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    YL0102           TH CM Crc Val L
     C                     Z-ADDA1EDPR    YL0103           TH CM Crc Val C
     C                     Z-ADDA1EEPR    YL0104           TH CM Lean Prem
     C                     Z-ADDA1EFPR    YL0105           TH CM Lean Prem
     C                     Z-ADDA1EGPR    YL0106           TH CM Gross Liv
     C                     Z-ADDA1EHPR    YL0107           TH CM Gross Car
     C                     MOVELA1KAST    YL0108           TH Source Type
     C                     MOVELA1J7ST    YL0109           TH Scale Ticket
     C                     MOVELA1J9ST    YL0110           TH Payment Type
     C                     Z-ADDA1OXNB    YL0111           TH HPS Movement
     C                     MOVELA1LKST    YL0112           TH Source Code
     C                     MOVELA1LLST    YL0113           TH Hog Class Ty
     C                     MOVELA1J8ST    YL0114           TH Posted to HP
     C                     MOVELA1LIST    YL0115           TH Schedule Kil
     C                     MOVELA1LJST    YL0116           TH Shift Held O
     C                     MOVELA1BDCD    YL0117           DF Defect Code
     C                     MOVELA1CSCD    YL0118           THP Process Cod
     C                     MOVELA1ABCD    YL0119           PD Producer Cod
     C                     MOVELA1AECD    YL0120           PL Location Cod
     C                     MOVELA1ACCD    YL0121           HB Buyer Code
     C                     MOVELA1AGCD    YL0122           GN Genetic Code
     C                     MOVELA1BECD    YL0123           HC Class Code
     C                     MOVELA1AAVN    YL0124           RS User Changed
     C                     Z-ADDA1AADT    YL0125           RS Date Changed
     C                     Z-ADDA1AMTM    YL0126           RS Time Changed
     C                     MOVELA1AJST    YL0127           RS Record Statu
     C                     MOVELA1AHVN    YL0128           RS Job
     C                     MOVELA1AGVN    YL0129           RS Program
     C                     MOVELA1ABVN    YL0130           RS User Added
     C                     Z-ADDA1ABDT    YL0131           RS Date Added
     C                     Z-ADDA1ABTM    YL0132           RS Time Added
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Balance Info      RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0140           TH PHA Add Type
     C                     MOVEL*BLANK    YL0141           TH PHA Average
     C                     MOVEL*BLANK    YL0142           TH PHA Add Reas
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A1BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSO     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA1OQET    YL0140           TH PHA Add Type
     C                     MOVELA1URST    YL0141           TH PHA Average
     C                     MOVELA1USST    YL0142           TH PHA Add Reas
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0144           PH Summary Type
     C                     Z-ADD*ZERO     YL0145           PH GA Avg Live
     C                     Z-ADD*ZERO     YL0146           PH GA Adjusted
     C                     Z-ADD*ZERO     YL0147           PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0148           PH GA Avg Backf
     C                     Z-ADD*ZERO     YL0149           PH GA Avg Loin
     C                     Z-ADD*ZERO     YL0150           PH GA Avg Light
     C                     Z-ADD*ZERO     YL0151           PH GA Lean Prm
     C                     Z-ADD*ZERO     YL0152           PH GA Avg Srt D
     C                     MOVEL*BLANK    YL0153           History Avail S
     C                     MOVEL'N'       YL0153           History Avail S
     C                     MOVEL'Y'       YL0154           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEY3A1    WQSP01           PH Company Numb
     C           *LIKE     DEFN WEABCD    WQSP02           PD Producer Cod
      * Define keylist
     C           KPSSP     KLIST
     C                     KFLD           WQSP01           PH Company Numb
     C                     KFLD           WQSP02           PD Producer Cod
     C                     KFLD           WEDZDT           PH Week Ending
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           PH Company Numb
     C                     KFLD           WQSP02           PD Producer Cod
      * Setup key
     C                     Z-ADD#1HMNB    WQSP01           PH Company Numb
     C                     MOVEL#1ABCD    WQSP02           PD Producer Cod
     C                     Z-ADD#1AWDT    WEDZDT           PH Week Ending
      * Establish starting position
     C           KPSSP     SETLL@CGCPEJ                    *
     C           KRSSP     READE@CGCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0154    IFEQ 'Y'                        *IF
     C                     Z-ADDWEDZDT    YL0155           PH Week Ending
     C                     MOVEL'N'       YL0154           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PH Week Ending Date NE LCL.PH Week Ending Date
     C           WEDZDT    IFNE YL0155                     *IF
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PH Summary Type is 2 Week
     C           WEUVST    IFEQ '2WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GE 600
     C           WEOWUI    IFGE 600                        *IF
      * PAR = DB1 By name
     C                     MOVELWEUVST    YL0144           PH Summary Type
     C                     Z-ADDWEORMB    YL0145           PH GA Avg Live
     C                     Z-ADDWEG9PC    YL0146           PH GA Adjusted
     C                     Z-ADDWEHBPC    YL0147           PH GA Avg Lean%
     C                     Z-ADDWEUWOE    YL0148           PH GA Avg Backf
     C                     Z-ADDWEHEPC    YL0149           PH GA Avg Loin
     C                     Z-ADDWEHGPC    YL0150           PH GA Avg Light
     C                     Z-ADDWETIPR    YL0151           PH GA Lean Prm
     C                     Z-ADDWEB8A1    YL0152           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0153           History Avail S
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PH Summary Type is 4 Week
     C           WEUVST    IFEQ '4WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GT Zero
     C           WEOWUI    IFGT 0                          *IF
      * PAR = DB1 By name
     C                     MOVELWEUVST    YL0144           PH Summary Type
     C                     Z-ADDWEORMB    YL0145           PH GA Avg Live
     C                     Z-ADDWEG9PC    YL0146           PH GA Adjusted
     C                     Z-ADDWEHBPC    YL0147           PH GA Avg Lean%
     C                     Z-ADDWEUWOE    YL0148           PH GA Avg Backf
     C                     Z-ADDWEHEPC    YL0149           PH GA Avg Loin
     C                     Z-ADDWEHGPC    YL0150           PH GA Avg Light
     C                     Z-ADDWETIPR    YL0151           PH GA Lean Prm
     C                     Z-ADDWEB8A1    YL0152           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0153           History Avail S
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSP     READE@CGCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * Kill Date USR
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A1BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADD#DCGDT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSQ     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0025           TH Purchase Dat
     C                     MOVEL*BLANK    YL0026           TH Group Refere
     C                     MOVEL*BLANK    YL0027           TH Live Purchas
     C                     Z-ADD*ZERO     YL0028           TH Live Purchas
     C                     Z-ADD*ZERO     YL0029           TH Live Gross A
     C                     Z-ADD*ZERO     YL0030           TH LIve Net Amt
     C                     MOVEL*BLANK    YL0031           TH Resale UOM
     C                     Z-ADD*ZERO     YL0032           TH Recalc Live
     C                     Z-ADD*ZERO     YL0033           TH Pricing Date
     C                     MOVEL*BLANK    YL0034           TH Resale Sprea
     C                     Z-ADD*ZERO     YL0035           TH Dead On Arri
     C                     Z-ADD*ZERO     YL0036           TH Head Receive
     C                     Z-ADD*ZERO     YL0037           TH Yard Deads
     C                     Z-ADD*ZERO     YL0038           TH Held Over
     C                     Z-ADD*ZERO     YL0039           TH Head Condemn
     C                     Z-ADD*ZERO     YL0040           TH Head Killed
     C                     Z-ADD*ZERO     YL0041           TH Head Adds
     C                     Z-ADD*ZERO     YL0042           TH Head Accepte
     C                     Z-ADD*ZERO     YL0043           TH Live Wgt
     C                     Z-ADD*ZERO     YL0044           TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0045           TH Hot Wgt
     C                     Z-ADD*ZERO     YL0046           TH Tot Loin Eye
     C                     Z-ADD*ZERO     YL0047           TH Tot Backfat
     C                     Z-ADD*ZERO     YL0048           TH Tot Light Re
     C                     Z-ADD*ZERO     YL0049           TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0050           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YL0051           TH Avg Light Re
     C                     Z-ADD*ZERO     YL0052           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0053           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0054           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0055           TH Std Yield Pe
     C                     Z-ADD*ZERO     YL0056           TH Actual Yield
     C                     Z-ADD*ZERO     YL0057           TH Adj Actual Y
     C                     Z-ADD*ZERO     YL0058           TH Yield Differ
     C                     Z-ADD*ZERO     YL0059           TH Recalc Live
     C                     Z-ADD*ZERO     YL0060           TH CM Market Pr
     C                     Z-ADD*ZERO     YL0061           TH CM Base Mkt
     C                     Z-ADD*ZERO     YL0062           TH CM Base Mkt
     C                     Z-ADD*ZERO     YL0063           TH CM Sort Disc
     C                     Z-ADD*ZERO     YL0064           TH CM Yield Gai
     C                     Z-ADD*ZERO     YL0065           TH CM Base Carc
     C                     Z-ADD*ZERO     YL0066           TH CM LN AddOn/
     C                     Z-ADD*ZERO     YL0067           TH CM Carcass G
     C                     Z-ADD*ZERO     YL0068           TH Deduction Am
     C                     Z-ADD*ZERO     YL0069           TH Total Net WO
     C                     Z-ADD*ZERO     YL0070           TH Carcass Net
     C                     Z-ADD*ZERO     YL0071           TH Additions Am
     C                     Z-ADD*ZERO     YL0072           TH Payment Gros
     C                     Z-ADD*ZERO     YL0073           Th Payment Net
     C                     Z-ADD*ZERO     YL0074           TH AP Voucher/D
     C                     Z-ADD*ZERO     YL0075           TH Freight Amou
     C                     Z-ADD*ZERO     YL0076           TH Accrual Amou
     C                     Z-ADD*ZERO     YL0077           TH Fixed Cost A
     C                     MOVEL*BLANK    YL0078           TH Calc Net Sts
     C                     MOVEL*BLANK    YL0079           TH Payment Sts
     C                     MOVEL*BLANK    YL0080           TH Bal to Kill
     C                     Z-ADD*ZERO     YL0081           TH Commission A
     C                     Z-ADD*ZERO     YL0082           TH Voucher Paym
     C                     MOVEL*BLANK    YL0083           TH User Error O
     C                     MOVEL*BLANK    YL0084           TH Held Over Re
     C                     MOVEL*BLANK    YL0085           TH Sex
     C                     Z-ADD*ZERO     YL0086           TH Held/Ovr Com
     C                     Z-ADD*ZERO     YL0087           TH Commission P
     C                     Z-ADD*ZERO     YL0088           TH Actual Check
     C                     Z-ADD*ZERO     YL0089           TH Shipped Weig
     C                     Z-ADD*ZERO     YL0090           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YL0091           TH FFLI
     C                     Z-ADD*ZERO     YL0092           TH Kill Product
     C                     Z-ADD*ZERO     YL0093           TH Cut Product
     C                     Z-ADD*ZERO     YL0094           TH Render Produ
     C                     Z-ADD*ZERO     YL0095           TH Head Exclude
     C                     Z-ADD*ZERO     YL0096           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     YL0097           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     YL0098           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     YL0099           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     YL0100           TH CM Yld G/L L
     C                     Z-ADD*ZERO     YL0101           TH CM Yld G/L C
     C                     Z-ADD*ZERO     YL0102           TH CM Crc Val L
     C                     Z-ADD*ZERO     YL0103           TH CM Crc Val C
     C                     Z-ADD*ZERO     YL0104           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0105           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0106           TH CM Gross Liv
     C                     Z-ADD*ZERO     YL0107           TH CM Gross Car
     C                     MOVEL*BLANK    YL0108           TH Source Type
     C                     MOVEL*BLANK    YL0109           TH Scale Ticket
     C                     MOVEL*BLANK    YL0110           TH Payment Type
     C                     Z-ADD*ZERO     YL0111           TH HPS Movement
     C                     MOVEL*BLANK    YL0112           TH Source Code
     C                     MOVEL*BLANK    YL0113           TH Hog Class Ty
     C                     MOVEL*BLANK    YL0114           TH Posted to HP
     C                     MOVEL*BLANK    YL0115           TH Schedule Kil
     C                     MOVEL*BLANK    YL0116           TH Shift Held O
     C                     MOVEL*BLANK    YL0117           DF Defect Code
     C                     MOVEL*BLANK    YL0118           THP Process Cod
     C                     MOVEL*BLANK    YL0119           PD Producer Cod
     C                     MOVEL*BLANK    YL0120           PL Location Cod
     C                     MOVEL*BLANK    YL0121           HB Buyer Code
     C                     MOVEL*BLANK    YL0122           GN Genetic Code
     C                     MOVEL*BLANK    YL0123           HC Class Code
     C                     MOVEL*BLANK    YL0124           RS User Changed
     C                     Z-ADD*ZERO     YL0125           RS Date Changed
     C                     Z-ADD*ZERO     YL0126           RS Time Changed
     C                     MOVEL*BLANK    YL0127           RS Record Statu
     C                     MOVEL*BLANK    YL0128           RS Job
     C                     MOVEL*BLANK    YL0129           RS Program
     C                     MOVEL*BLANK    YL0130           RS User Added
     C                     Z-ADD*ZERO     YL0131           RS Date Added
     C                     Z-ADD*ZERO     YL0132           RS Time Added
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA1AWDT    YL0025           TH Purchase Dat
     C                     MOVELA1BICD    YL0026           TH Group Refere
     C                     MOVELA1CPST    YL0027           TH Live Purchas
     C                     Z-ADDA1ACPR    YL0028           TH Live Purchas
     C                     Z-ADDA1B9PR    YL0029           TH Live Gross A
     C                     Z-ADDA1CAPR    YL0030           TH LIve Net Amt
     C                     MOVELA1C4ST    YL0031           TH Resale UOM
     C                     Z-ADDA1AIPR    YL0032           TH Recalc Live
     C                     Z-ADDA1A6DT    YL0033           TH Pricing Date
     C                     MOVELA1C2ST    YL0034           TH Resale Sprea
     C                     Z-ADDA1CXNB    YL0035           TH Dead On Arri
     C                     Z-ADDA1CWNB    YL0036           TH Head Receive
     C                     Z-ADDA1FCNB    YL0037           TH Yard Deads
     C                     Z-ADDA1H9NB    YL0038           TH Held Over
     C                     Z-ADDA1FDNB    YL0039           TH Head Condemn
     C                     Z-ADDA1FENB    YL0040           TH Head Killed
     C                     Z-ADDA1HENB    YL0041           TH Head Adds
     C                     Z-ADDA1HFNB    YL0042           TH Head Accepte
     C                     Z-ADDA1CYNB    YL0043           TH Live Wgt
     C                     Z-ADDA1LRNB    YL0044           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    YL0045           TH Hot Wgt
     C                     Z-ADDA1A5PC    YL0046           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    YL0047           TH Tot Backfat
     C                     Z-ADDA1A4PC    YL0048           TH Tot Light Re
     C                     Z-ADDA1F7NB    YL0049           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    YL0050           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    YL0051           TH Avg Light Re
     C                     Z-ADDA1F4NB    YL0052           TH Avg Lean Per
     C                     Z-ADDA1F3NB    YL0053           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    YL0054           TH Avg Backfat
     C                     Z-ADDA1AVPC    YL0055           TH Std Yield Pe
     C                     Z-ADDA1AWPC    YL0056           TH Actual Yield
     C                     Z-ADDA1CWPC    YL0057           TH Adj Actual Y
     C                     Z-ADDA1A8PC    YL0058           TH Yield Differ
     C                     Z-ADDA1A7PC    YL0059           TH Recalc Live
     C                     Z-ADDA1B8PR    YL0060           TH CM Market Pr
     C                     Z-ADDA1AMPR    YL0061           TH CM Base Mkt
     C                     Z-ADDA1ANPR    YL0062           TH CM Base Mkt
     C                     Z-ADDA1AYVA    YL0063           TH CM Sort Disc
     C                     Z-ADDA1AWVA    YL0064           TH CM Yield Gai
     C                     Z-ADDA1AOPR    YL0065           TH CM Base Carc
     C                     Z-ADDA1AXVA    YL0066           TH CM LN AddOn/
     C                     Z-ADDA1APPR    YL0067           TH CM Carcass G
     C                     Z-ADDA1ASPR    YL0068           TH Deduction Am
     C                     Z-ADDA1A4VA    YL0069           TH Total Net WO
     C                     Z-ADDA1ATPR    YL0070           TH Carcass Net
     C                     Z-ADDA1A5VA    YL0071           TH Additions Am
     C                     Z-ADDA1CBPR    YL0072           TH Payment Gros
     C                     Z-ADDA1CCPR    YL0073           Th Payment Net
     C                     Z-ADDA1LPNB    YL0074           TH AP Voucher/D
     C                     Z-ADDA1CDPR    YL0075           TH Freight Amou
     C                     Z-ADDA1A7VA    YL0076           TH Accrual Amou
     C                     Z-ADDA1A2PR    YL0077           TH Fixed Cost A
     C                     MOVELA1JWST    YL0078           TH Calc Net Sts
     C                     MOVELA1CWST    YL0079           TH Payment Sts
     C                     MOVELA1D6ST    YL0080           TH Bal to Kill
     C                     Z-ADDA1GHNB    YL0081           TH Commission A
     C                     Z-ADDA1BYDT    YL0082           TH Voucher Paym
     C                     MOVELA1E0ST    YL0083           TH User Error O
     C                     MOVELA1E1ST    YL0084           TH Held Over Re
     C                     MOVELA1E2ST    YL0085           TH Sex
     C                     Z-ADDA1BSDT    YL0086           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    YL0087           TH Commission P
     C                     Z-ADDA1BUDT    YL0088           TH Actual Check
     C                     Z-ADDA1HGNB    YL0089           TH Shipped Weig
     C                     Z-ADDA1HHNB    YL0090           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    YL0091           TH FFLI
     C                     Z-ADDA1A3PR    YL0092           TH Kill Product
     C                     Z-ADDA1A4PR    YL0093           TH Cut Product
     C                     Z-ADDA1A6PR    YL0094           TH Render Produ
     C                     Z-ADDA1J9NB    YL0095           TH Head Exclude
     C                     Z-ADDA1D6PR    YL0096           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    YL0097           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    YL0098           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    YL0099           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    YL0100           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    YL0101           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    YL0102           TH CM Crc Val L
     C                     Z-ADDA1EDPR    YL0103           TH CM Crc Val C
     C                     Z-ADDA1EEPR    YL0104           TH CM Lean Prem
     C                     Z-ADDA1EFPR    YL0105           TH CM Lean Prem
     C                     Z-ADDA1EGPR    YL0106           TH CM Gross Liv
     C                     Z-ADDA1EHPR    YL0107           TH CM Gross Car
     C                     MOVELA1KAST    YL0108           TH Source Type
     C                     MOVELA1J7ST    YL0109           TH Scale Ticket
     C                     MOVELA1J9ST    YL0110           TH Payment Type
     C                     Z-ADDA1OXNB    YL0111           TH HPS Movement
     C                     MOVELA1LKST    YL0112           TH Source Code
     C                     MOVELA1LLST    YL0113           TH Hog Class Ty
     C                     MOVELA1J8ST    YL0114           TH Posted to HP
     C                     MOVELA1LIST    YL0115           TH Schedule Kil
     C                     MOVELA1LJST    YL0116           TH Shift Held O
     C                     MOVELA1BDCD    YL0117           DF Defect Code
     C                     MOVELA1CSCD    YL0118           THP Process Cod
     C                     MOVELA1ABCD    YL0119           PD Producer Cod
     C                     MOVELA1AECD    YL0120           PL Location Cod
     C                     MOVELA1ACCD    YL0121           HB Buyer Code
     C                     MOVELA1AGCD    YL0122           GN Genetic Code
     C                     MOVELA1BECD    YL0123           HC Class Code
     C                     MOVELA1AAVN    YL0124           RS User Changed
     C                     Z-ADDA1AADT    YL0125           RS Date Changed
     C                     Z-ADDA1AMTM    YL0126           RS Time Changed
     C                     MOVELA1AJST    YL0127           RS Record Statu
     C                     MOVELA1AHVN    YL0128           RS Job
     C                     MOVELA1AGVN    YL0129           RS Program
     C                     MOVELA1ABVN    YL0130           RS User Added
     C                     Z-ADDA1ABDT    YL0131           RS Date Added
     C                     Z-ADDA1ABTM    YL0132           RS Time Added
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Held Over KillDt  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQSR01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQSR02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQSR03           BOL Load Number
     C           *LIKE     DEFN A1CVNB    WQSR04           TH Tattoo Numbe
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           BOH Company Num
     C                     KFLD           WQSR02           BOH Buy Order N
     C                     KFLD           WQSR03           BOL Load Number
     C                     KFLD           WQSR04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#1HMNB    WQSR01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSR02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSR03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSR04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSR     SETLL@A1CPC4                    *
     C           KRSSR     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Kill Date NE PAR.Kill Date 1 Usr
     C           A1B0DT    IFNE #1B0DT                     *IF
     C                     Z-ADDA1B0DT    #DCGDT           Kill Date Usr
     C                     GOTO SREXIT                     *QUIT
     C                     END                             *FI
     C           KRSSR     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     C           YPMTFD    OREQ '#1BONB'
     C           YPMTFD    OREQ '#1CVNB'
     C           YPMTFD    OREQ '#1B0DT'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(DTL) #1CVNB' defaulted for 'TH Tattoo Number'.
      * Field '(DTL) #1B0DT' defaulted for 'TH Kill Date'.
     C                     CALL 'PKB7SRR'              90  Sel Kill/Tattoo
     C                     PARM *BLANK    W0RTN   7
     C           #1HMNB    PARM #1HMNB    WQ0196  30       BOH Company Num
     C           #1CVNB    PARM #1CVNB    WQ0197  50       TH Tattoo Numbe
     C           #1B0DT    PARM #1B0DT    WQ0198  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKB7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1CVNB    IFNE *ZERO                      TH Tattoo Numbe
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1B0DT    IFNE *ZERO                      TH Kill Date
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Buy Order Load
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     C           YPMTFD    OREQ '#1BONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(DTL) #1BNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(DTL) #1BONB' defaulted for 'BOL Load Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PKQJSRR'              90  Sel Producer BO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0199  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0200  70       BOH Buy Order N
     C           #1BONB    PARM #1BONB    WQ0201  50       BOL Load Number
     C                     PARM #1ABCD    WQ0202  6        PD Producer Cod
     C                     PARM #1AECD    WQ0203  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HMNB    IFEQ *ZERO                      BOH Company Num
     C           #1BNNB    ANDEQ*ZERO                      BOH Buy Order N
     C           #1BONB    ANDEQ*ZERO                      BOL Load Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWF    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    WFHMNB
     C                     Z-ADD#1BNNB    WFBNNB
     C                     Z-ADD#1BONB    WFBONB
     C           KLVBWF    CHAIN@AXCPBX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Buy Order Load         NF'
     C                     MOVEL'PRK0051' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0051' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Hog Defect
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BDCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        DF Defect Code
     C           YPMTFD    OREQ '#1BDCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BDCD' defaulted for 'DF Defect Code'.
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #1BDCD    PARM #1BDCD    WQ0204  6        DF Defect Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BDCD    IFNE *BLANK                     DF Defect Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BDCD    IFEQ *BLANK                     DF Defect Code
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWG    KLIST
     C                     KFLD           WGBDCD           DF Defect Code
      * Setup key
     C                     MOVEL#1BDCD    WGBDCD
     C           KLVCWG    CHAIN@A7REC1              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Hog Defect             NF'
     C                     MOVEL'PRK0073' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0073' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Tattoo Header Process
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1CSCD    IFEQ *BLANK                     THP Process Cod
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWH    KLIST
     C                     KFLD           WHCSCD           THP Process Cod
      * Setup key
     C                     MOVEL#1CSCD    WHCSCD
     C           KLVDWH    CHAIN@CCREH3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Tattoo Header Process  NF'
     C                     MOVEL'PRK0172' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0172' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Producer Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ABCD    WK1X01  1
     C                     MOVEL#1AECD    WK1X02  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#1ABCD'
     C           WK1X02    OREQ '?'                        PL Location Cod
     C           YPMTFD    OREQ '#1AECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PWF5SRR'              90  Sel Prod Loc by
     C                     PARM *BLANK    W0RTN   7
     C           #1ABCD    PARM #1ABCD    WQ0205  6        PD Producer Cod
     C           #1AECD    PARM #1AECD    WQ0206  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWF5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AECD    IFNE *BLANK                     PL Location Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ABCD    IFEQ *BLANK                     PD Producer Cod
     C           #1AECD    ANDEQ*BLANK                     PL Location Cod
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEWI    KLIST
     C                     KFLD           WIABCD           PD Producer Cod
     C                     KFLD           WIAECD           PL Location Cod
      * Setup key
     C                     MOVEL#1ABCD    WIABCD
     C                     MOVEL#1AECD    WIAECD
     C           KLVEWI    CHAIN@AFREAR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Producer Location      NF'
     C                     MOVEL'PRK0015' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0015' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Hog Buyer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ACCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        HB Buyer Code
     C           YPMTFD    OREQ '#1ACCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ACCD' defaulted for 'HB Buyer Code'.
     C                     CALL 'PKD3SRR'              90  Sel Hog Buyer
     C                     PARM *BLANK    W0RTN   7
     C           #1ACCD    PARM #1ACCD    WQ0207  3        HB Buyer Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKD3SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ACCD    IFNE *BLANK                     HB Buyer Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ACCD    IFEQ *BLANK                     HB Buyer Code
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFWJ    KLIST
     C                     KFLD           WJACCD           HB Buyer Code
      * Setup key
     C                     MOVEL#1ACCD    WJACCD
     C           KLVFWJ    CHAIN@ADREAF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Hog Buyer              NF'
     C                     MOVEL'PRK0011' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0011' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Genetic
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AGCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        GN Genetic Code
     C           YPMTFD    OREQ '#1AGCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AGCD' defaulted for 'GN Genetic Code'.
     C                     CALL 'PKNASRR'              90  Sel Genetic Act
     C                     PARM *BLANK    W0RTN   7
     C           #1AGCD    PARM #1AGCD    WQ0208  5        GN Genetic Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKNASRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AGCD    IFNE *BLANK                     GN Genetic Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AGCD    IFEQ *BLANK                     GN Genetic Code
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGWK    KLIST
     C                     KFLD           WKAGCD           GN Genetic Code
      * Setup key
     C                     MOVEL#1AGCD    WKAGCD
     C           KLVGWK    CHAIN@AIREA9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Genetic                NF'
     C                     MOVEL'PRK0021' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0021' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Hog Classification
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BECD    WK1X01  1
     C           WK1X01    IFEQ '?'                        HC Class Code
     C           YPMTFD    OREQ '#1BECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BECD' defaulted for 'HC Class Code'.
     C                     CALL 'PKC0SRR'              90  Sel Hog Classif
     C                     PARM *BLANK    W0RTN   7
     C           #1BECD    PARM #1BECD    WQ0209  3        HC Class Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKC0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BECD    IFNE *BLANK                     HC Class Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BECD    IFEQ *BLANK                     HC Class Code
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHWL    KLIST
     C                     KFLD           WLBECD           HC Class Code
      * Setup key
     C                     MOVEL#1BECD    WLBECD
     C           KLVHWL    CHAIN@A8REDA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Hog Classification     NF'
     C                     MOVEL'PRK0075' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0075' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDEQ027
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DABST'  YPMTFD           @Status (Yes/No
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1D7ST           TH Header Error
     C                     MOVEL*BLANK    P1D8ST           TH Detail Error
     C                     MOVEL*BLANK    P1DWST           TH Kill Balanci
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAFPC           EV Minimum
     C                     Z-ADD*ZERO     WAAGPC           EV Maximum
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHSNB           ET Company Numb
     C                     Z-ADD*ZERO     WBA9DT           ET Kill Date
     C                     Z-ADD*ZERO     WBFJNB           ET Scale Sequen
     C                     Z-ADD*ZERO     WBHCNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WBGDNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WBFINB           ET Tattoo Numbe
     C                     Z-ADD*ZERO     WBLKNB           ET Lot
     C                     Z-ADD*ZERO     WBAMPC           ET Hot Wgt
     C                     Z-ADD*ZERO     WBAIPC           ET Backfat Thic
     C                     Z-ADD*ZERO     WBAJPC           ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WBAKPC           ET Lean Percent
     C                     Z-ADD*ZERO     WBX8NB           ET Backfat Thic
     C                     Z-ADD*ZERO     WBFVPC           ET Loineye Dept
     C                     Z-ADD*ZERO     WBFWPC           ET Light Reflec
     C                     Z-ADD*ZERO     WBFXPC           ET Lean Percent
     C                     Z-ADD*ZERO     WBALPC           ET Light Reflec
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
     C                     Z-ADD*ZERO     WBB8DT           RU Date
     C                     Z-ADD*ZERO     WBAOTM           RU Time
      * Define work field ET Scale Sequence Number
     C                     Z-ADD*ZERO     WUFJNB  60
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEY3A1           PH Company Numb
     C                     Z-ADD*ZERO     WEDZDT           PH Week Ending
     C                     Z-ADD*ZERO     WEOJJF           PH ALL DOA
     C                     Z-ADD*ZERO     WEALHD           PH ALL Head Rec
     C                     Z-ADD*ZERO     WEKDUR           PH ALL Yard Dea
     C                     Z-ADD*ZERO     WEKJOQ           PH ALL Head Con
     C                     Z-ADD*ZERO     WEJOWR           PH ALL Head Kil
     C                     Z-ADD*ZERO     WEOIWE           PH ALL Live Wei
     C                     Z-ADD*ZERO     WEIOTR           PH ALL Avg Live
     C                     Z-ADD*ZERO     WEJOWK           PH ALL Hot Weig
     C                     Z-ADD*ZERO     WEUQWP           PH ALL Avg Hot
     C                     Z-ADD*ZERO     WEO6PC           PH ALL Actual Y
     C                     Z-ADD*ZERO     WEJKSE           PH ALL Adj Live
     C                     Z-ADD*ZERO     WEG8PC           PH ALL Adjusted
     C                     Z-ADD*ZERO     WEHAPC           PH ALL Avg Lean
     C                     Z-ADD*ZERO     WEORJG           PH ALL Avg Back
     C                     Z-ADD*ZERO     WEHDPC           PH ALL Avg Loin
     C                     Z-ADD*ZERO     WEHFPC           PH ALL Avg Ligh
     C                     Z-ADD*ZERO     WES1PR           PH ALL Base /Li
     C                     Z-ADD*ZERO     WETCPR           PH ALL Base /Ca
     C                     Z-ADD*ZERO     WES3PR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     WETDPR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     WES5PR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     WETEPR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     WES7PR           PH ALL Gross /L
     C                     Z-ADD*ZERO     WETFPR           PH ALL Gross /C
     C                     Z-ADD*ZERO     WEB6A1           PH ALL Avg Srt
     C                     Z-ADD*ZERO     WEJKOS           PH GA DOA
     C                     Z-ADD*ZERO     WEALRC           PH GA Head Rece
     C                     Z-ADD*ZERO     WEKDIE           PH GA Yard Dead
     C                     Z-ADD*ZERO     WEJOEW           PH GA Head Cond
     C                     Z-ADD*ZERO     WEOWUI           PH GA Head Kill
     C                     Z-ADD*ZERO     WEIOWN           PH GA Live Weig
     C                     Z-ADD*ZERO     WEORMB           PH GA Avg Live
     C                     Z-ADD*ZERO     WEJOQR           PH GA Hot Weigh
     C                     Z-ADD*ZERO     WEPRUR           PH GA Avg Hot W
     C                     Z-ADD*ZERO     WEG7PC           PH GA Actual Yi
     C                     Z-ADD*ZERO     WEIOOG           PH GA Adj Live
     C                     Z-ADD*ZERO     WEG9PC           PH GA Adjusted
     C                     Z-ADD*ZERO     WEHBPC           PH GA Avg Lean%
     C                     Z-ADD*ZERO     WEUWOE           PH GA Avg Backf
     C                     Z-ADD*ZERO     WEHEPC           PH GA Avg Loin
     C                     Z-ADD*ZERO     WEHGPC           PH GA Avg Light
     C                     Z-ADD*ZERO     WES2PR           PH GA Base /Liv
     C                     Z-ADD*ZERO     WETGPR           PH GA Base /Car
     C                     Z-ADD*ZERO     WES4PR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     WETHPR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     WES6PR           PH GA Lean Prm
     C                     Z-ADD*ZERO     WETIPR           PH GA Lean Prm
     C                     Z-ADD*ZERO     WES8PR           PH GA Gross /Li
     C                     Z-ADD*ZERO     WETJPR           PH GA Gross /Ca
     C                     Z-ADD*ZERO     WEB8A1           PH GA Avg Srt D
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFBONB           BOL Load Number
     C                     Z-ADD*ZERO     WFCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WFABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WFACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WFBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WFCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WFAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WFAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WFATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WFDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WFDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WFGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WFBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WFLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WFLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WFJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WFKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WFIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WFKJIO           BOL Auth Gate E
     C                     Z-ADD*ZERO     WFIOJR           BOL Head Receiv
     C                     Z-ADD*ZERO     WFEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFRJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFD0DT           BOL Auth Gate E
     C                     Z-ADD*ZERO     WFD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAEA1           DF Market Perce
     C                     Z-ADD*ZERO     WGUOPR           DF Unused Price
     C                     Z-ADD*ZERO     WGUPPR           DF Unused Price
     C                     Z-ADD*ZERO     WGUQPR           DF Unused Price
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIGLNB           Pl VND Address
     C                     Z-ADD*ZERO     WIASNB           PL Miles/Unused
     C                     Z-ADD*ZERO     WIHWNB           PL Primary Comp
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAADT           RS Date Changed
     C                     Z-ADD*ZERO     WJAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WJABDT           RS Date Added
     C                     Z-ADD*ZERO     WJABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAADT           RS Date Changed
     C                     Z-ADD*ZERO     WKAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WKABDT           RS Date Added
     C                     Z-ADD*ZERO     WKABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WLABDT           RS Date Added
     C                     Z-ADD*ZERO     WLABTM           RS Time Added
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Carcass Dbw Min
     C                     Z-ADD*ZERO     YL0001  71
      * Define local work field Carcass Dbw Max
     C                     Z-ADD*ZERO     YL0002  71
      * Define local work field Carcass Lgt Min
     C                     Z-ADD*ZERO     YL0003  71
      * Define local work field Carcass Lgt Max
     C                     Z-ADD*ZERO     YL0004  71
      * Define local work field %Lean High Min
     C                     Z-ADD*ZERO     YL0005  71
      * Define local work field %Lean High Max
     C                     Z-ADD*ZERO     YL0006  71
      * Define local work field %Lean Low Min
     C                     Z-ADD*ZERO     YL0007  71
      * Define local work field %Lean Low Max
     C                     Z-ADD*ZERO     YL0008  71
      * Define local work field High Yield Min
     C                     Z-ADD*ZERO     YL0009  71
      * Define local work field High Yield Max
     C                     Z-ADD*ZERO     YL0010  71
      * Define local work field Low Yield Min
     C                     Z-ADD*ZERO     YL0011  71
      * Define local work field Low Yield Max
     C                     Z-ADD*ZERO     YL0012  71
      * Define local work field Head < Percent Min
     C                     Z-ADD*ZERO     YL0013  71
      * Define local work field Head < Percent Max
     C                     Z-ADD*ZERO     YL0014  71
      * Define local work field Head > Percent Min
     C                     Z-ADD*ZERO     YL0015  71
      * Define local work field Head > Percent Max
     C                     Z-ADD*ZERO     YL0016  71
      * Define local work field BackFat High Min
     C                     Z-ADD*ZERO     YL0017  71
      * Define local work field BackFat High Max
     C                     Z-ADD*ZERO     YL0018  71
      * Define local work field BackFat Low Min
     C                     Z-ADD*ZERO     YL0019  71
      * Define local work field Backfat Low Max
     C                     Z-ADD*ZERO     YL0020  71
      * Define local work field LoinEye High Min
     C                     Z-ADD*ZERO     YL0021  71
      * Define local work field LoinEye High Max
     C                     Z-ADD*ZERO     YL0022  71
      * Define local work field LoinEye Low Min
     C                     Z-ADD*ZERO     YL0023  71
      * Define local work field LoinEye Low Max
     C                     Z-ADD*ZERO     YL0024  71
      * Define local work field TH Purchase Date
     C                     Z-ADD*ZERO     YL0025  70
      * Define local work field TH Group Reference
     C                     MOVEL*BLANK    YL0026 10
      * Define local work field TH Live Purchase UOM
     C                     MOVEL*BLANK    YL0027  2
      * Define local work field TH Live Purchase Price
     C                     Z-ADD*ZERO     YL0028  52
      * Define local work field TH Live Gross Amt
     C                     Z-ADD*ZERO     YL0029  72
      * Define local work field TH LIve Net Amt
     C                     Z-ADD*ZERO     YL0030  72
      * Define local work field TH Resale UOM
     C                     MOVEL*BLANK    YL0031  2
      * Define local work field TH Recalc Live Wgt Yld
     C                     Z-ADD*ZERO     YL0032  52
      * Define local work field TH Pricing Date
     C                     Z-ADD*ZERO     YL0033  70
      * Define local work field TH Resale Spread Sts
     C                     MOVEL*BLANK    YL0034  1
      * Define local work field TH Dead On Arrival
     C                     Z-ADD*ZERO     YL0035  50
      * Define local work field TH Head Received
     C                     Z-ADD*ZERO     YL0036  50
      * Define local work field TH Yard Deads
     C                     Z-ADD*ZERO     YL0037  50
      * Define local work field TH Held Over
     C                     Z-ADD*ZERO     YL0038  50
      * Define local work field TH Head Condemned
     C                     Z-ADD*ZERO     YL0039  50
      * Define local work field TH Head Killed
     C                     Z-ADD*ZERO     YL0040  50
      * Define local work field TH Head Adds
     C                     Z-ADD*ZERO     YL0041  50
      * Define local work field TH Head Accepted
     C                     Z-ADD*ZERO     YL0042  50
      * Define local work field TH Live Wgt
     C                     Z-ADD*ZERO     YL0043  71
      * Define local work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0044  71
      * Define local work field TH Hot Wgt
     C                     Z-ADD*ZERO     YL0045  71
      * Define local work field TH Tot Loin Eye Depth
     C                     Z-ADD*ZERO     YL0046  61
      * Define local work field TH Tot Backfat Inches
     C                     Z-ADD*ZERO     YL0047  61
      * Define local work field TH Tot Light Reflectance
     C                     Z-ADD*ZERO     YL0048  61
      * Define local work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0049  51
      * Define local work field TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YL0050  51
      * Define local work field TH Avg Light Reflectance
     C                     Z-ADD*ZERO     YL0051  31
      * Define local work field TH Avg Lean Percent
     C                     Z-ADD*ZERO     YL0052  31
      * Define local work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     YL0053  31
      * Define local work field TH Avg Backfat
     C                     Z-ADD*ZERO     YL0054  31
      * Define local work field TH Std Yield Percent
     C                     Z-ADD*ZERO     YL0055  52
      * Define local work field TH Actual Yield %
     C                     Z-ADD*ZERO     YL0056  52
      * Define local work field TH Adj Actual Yield %
     C                     Z-ADD*ZERO     YL0057  52
      * Define local work field TH Yield Difference
     C                     Z-ADD*ZERO     YL0058  52
      * Define local work field TH Recalc Live Wgt
     C                     Z-ADD*ZERO     YL0059  31
      * Define local work field TH CM Market Price
     C                     Z-ADD*ZERO     YL0060  52
      * Define local work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     YL0061  52
      * Define local work field TH CM Base Mkt Price Amt
     C                     Z-ADD*ZERO     YL0062  72
      * Define local work field TH CM Sort Discount Amt
     C                     Z-ADD*ZERO     YL0063  72
      * Define local work field TH CM Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     YL0064  72
      * Define local work field TH CM Base Carcass Value
     C                     Z-ADD*ZERO     YL0065  72
      * Define local work field TH CM LN AddOn/Deduct Amt
     C                     Z-ADD*ZERO     YL0066  72
      * Define local work field TH CM Carcass Gross Amt
     C                     Z-ADD*ZERO     YL0067  72
      * Define local work field TH Deduction Amt
     C                     Z-ADD*ZERO     YL0068  72
      * Define local work field TH Total Net WO Adds
     C                     Z-ADD*ZERO     YL0069  72
      * Define local work field TH Carcass Net Amt
     C                     Z-ADD*ZERO     YL0070  72
      * Define local work field TH Additions Amt
     C                     Z-ADD*ZERO     YL0071  72
      * Define local work field TH Payment Gross
     C                     Z-ADD*ZERO     YL0072  72
      * Define local work field Th Payment Net Amt
     C                     Z-ADD*ZERO     YL0073  72
      * Define local work field TH AP Voucher/Document#
     C                     Z-ADD*ZERO     YL0074  80
      * Define local work field TH Freight Amount
     C                     Z-ADD*ZERO     YL0075  72
      * Define local work field TH Accrual Amount
     C                     Z-ADD*ZERO     YL0076  72
      * Define local work field TH Fixed Cost Amount
     C                     Z-ADD*ZERO     YL0077  72
      * Define local work field TH Calc Net Sts
     C                     MOVEL*BLANK    YL0078  1
      * Define local work field TH Payment Sts
     C                     MOVEL*BLANK    YL0079  2
      * Define local work field TH Bal to Kill Gen
     C                     MOVEL*BLANK    YL0080  1
      * Define local work field TH Commission A/P Voucher
     C                     Z-ADD*ZERO     YL0081  80
      * Define local work field TH Voucher Payment Date
     C                     Z-ADD*ZERO     YL0082  70
      * Define local work field TH User Error Override
     C                     MOVEL*BLANK    YL0083  1
      * Define local work field TH Held Over Record
     C                     MOVEL*BLANK    YL0084  1
      * Define local work field TH Sex
     C                     MOVEL*BLANK    YL0085  1
      * Define local work field TH Held/Ovr Completed Dte
     C                     Z-ADD*ZERO     YL0086  70
      * Define local work field TH Commission Paid Date
     C                     Z-ADD*ZERO     YL0087  70
      * Define local work field TH Actual Check Date
     C                     Z-ADD*ZERO     YL0088  70
      * Define local work field TH Shipped Weight
     C                     Z-ADD*ZERO     YL0089  71
      * Define local work field TH Avg Hot Wgt EXC/ADD
     C                     Z-ADD*ZERO     YL0090  71
      * Define local work field TH FFLI
     C                     Z-ADD*ZERO     YL0091  31
      * Define local work field TH Kill Product Value
     C                     Z-ADD*ZERO     YL0092  72
      * Define local work field TH Cut Product Value
     C                     Z-ADD*ZERO     YL0093  72
      * Define local work field TH Render Product Value
     C                     Z-ADD*ZERO     YL0094  72
      * Define local work field TH Head Excluded
     C                     Z-ADD*ZERO     YL0095  50
      * Define local work field TH CM Bse Mkt Live /CWT
     C                     Z-ADD*ZERO     YL0096  52
      * Define local work field TH CM Bse Mkt Carc /CWT
     C                     Z-ADD*ZERO     YL0097  52
      * Define local work field TH CM Srt Dsc Live /CWT
     C                     Z-ADD*ZERO     YL0098  52
      * Define local work field TH CM Srt Dsc Carc /CWT
     C                     Z-ADD*ZERO     YL0099  52
      * Define local work field TH CM Yld G/L Live /CWT
     C                     Z-ADD*ZERO     YL0100  52
      * Define local work field TH CM Yld G/L Carc /CWT
     C                     Z-ADD*ZERO     YL0101  52
      * Define local work field TH CM Crc Val Live /CWT
     C                     Z-ADD*ZERO     YL0102  52
      * Define local work field TH CM Crc Val Carc /CWT
     C                     Z-ADD*ZERO     YL0103  52
      * Define local work field TH CM Lean Prem Live /CWT
     C                     Z-ADD*ZERO     YL0104  52
      * Define local work field TH CM Lean Prem Carc /CWT
     C                     Z-ADD*ZERO     YL0105  52
      * Define local work field TH CM Gross Live /CWT
     C                     Z-ADD*ZERO     YL0106  52
      * Define local work field TH CM Gross Carc /CWT
     C                     Z-ADD*ZERO     YL0107  52
      * Define local work field TH Source Type
     C                     MOVEL*BLANK    YL0108  1
      * Define local work field TH Scale Ticket Sts
     C                     MOVEL*BLANK    YL0109  1
      * Define local work field TH Payment Type
     C                     MOVEL*BLANK    YL0110  1
      * Define local work field TH HPS Movement Ref #
     C                     Z-ADD*ZERO     YL0111  70
      * Define local work field TH Source Code
     C                     MOVEL*BLANK    YL0112  3
      * Define local work field TH Hog Class Type
     C                     MOVEL*BLANK    YL0113  1
      * Define local work field TH Posted to HPS Flag
     C                     MOVEL*BLANK    YL0114  1
      * Define local work field TH Schedule Kill Shift
     C                     MOVEL*BLANK    YL0115  1
      * Define local work field TH Shift Held Over
     C                     MOVEL*BLANK    YL0116  1
      * Define local work field DF Defect Code
     C                     MOVEL*BLANK    YL0117  6
      * Define local work field THP Process Code
     C                     MOVEL*BLANK    YL0118  6
      * Define local work field PD Producer Code
     C                     MOVEL*BLANK    YL0119  6
      * Define local work field PL Location Code
     C                     MOVEL*BLANK    YL0120  6
      * Define local work field HB Buyer Code
     C                     MOVEL*BLANK    YL0121  3
      * Define local work field GN Genetic Code
     C                     MOVEL*BLANK    YL0122  5
      * Define local work field HC Class Code
     C                     MOVEL*BLANK    YL0123  3
      * Define local work field RS User Changed
     C                     MOVEL*BLANK    YL0124 10
      * Define local work field RS Date Changed
     C                     Z-ADD*ZERO     YL0125  70
      * Define local work field RS Time Changed
     C                     Z-ADD*ZERO     YL0126  60
      * Define local work field RS Record Status
     C                     MOVEL*BLANK    YL0127  1
      * Define local work field RS Job
     C                     MOVEL*BLANK    YL0128 10
      * Define local work field RS Program
     C                     MOVEL*BLANK    YL0129 10
      * Define local work field RS User Added
     C                     MOVEL*BLANK    YL0130 10
      * Define local work field RS Date Added
     C                     Z-ADD*ZERO     YL0131  70
      * Define local work field RS Time Added
     C                     Z-ADD*ZERO     YL0132  60
      * Define local work field Balance First Day USR
     C                     MOVEL*BLANK    YL0133  1
      * Define local work field First Time Flag Usr
     C                     MOVEL*BLANK    YL0134  1
      * Define local work field Net Head Usr
     C                     Z-ADD*ZERO     YL0135  50
      * Define local work field Transfer Carcasses    USR
     C                     Z-ADD*ZERO     YL0136  50
      * Define local work field TH Kill Date
     C                     Z-ADD*ZERO     YL0137  70
      * Define local work field Kill Date Usr
     C                     Z-ADD*ZERO     YL0138  70
      * Define local work field Balance First Day USR
     C                     MOVEL*BLANK    YL0139  1
      * Define local work field TH PHA Add Type
     C                     MOVEL*BLANK    YL0140  1
      * Define local work field TH PHA Average Type
     C                     MOVEL*BLANK    YL0141  3
      * Define local work field TH PHA Add Reason
     C                     MOVEL*BLANK    YL0142  1
      * Define local work field Bal w/History
     C                     MOVEL*BLANK    YL0143  1
      * Define local work field PH Summary Type
     C                     MOVEL*BLANK    YL0144  3
      * Define local work field PH GA Avg Live Wgt
     C                     Z-ADD*ZERO     YL0145  51
      * Define local work field PH GA Adjusted Yield%
     C                     Z-ADD*ZERO     YL0146  52
      * Define local work field PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0147  31
      * Define local work field PH GA Avg Backfat
     C                     Z-ADD*ZERO     YL0148  31
      * Define local work field PH GA Avg Loin Eye
     C                     Z-ADD*ZERO     YL0149  31
      * Define local work field PH GA Avg Light Ref
     C                     Z-ADD*ZERO     YL0150  31
      * Define local work field PH GA Lean Prm /Carc CWT
     C                     Z-ADD*ZERO     YL0151  52
      * Define local work field PH GA Avg Srt Disc Fctr
     C                     Z-ADD*ZERO     YL0152  53
      * Define local work field History Avail STS USR
     C                     MOVEL*BLANK    YL0153  1
      * Define local work field First Time Flag Usr
     C                     MOVEL*BLANK    YL0154  1
      * Define local work field PH Week Ending Date
     C                     Z-ADD*ZERO     YL0155  70
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * MODIFICATIONS
      * 11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP2EVTX    ##CMP
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
