     H/TITLE CLC TP FOB Sale Price XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 04/11/22  Time  : 15:41:12
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPMDNREL2IF  E           K        DISK
      * RSQ : Item Groups for TP Sales  Active Items Only
      *
     FOMHSTPO6IF  E           K        DISK
      * RSQ : Sales History             Itm/ASD-d/Co/Ord RegSls
      *
     FPNF4REL1IF  E           K        DISK
      * RTV : IP Cust Pricing Dtl       Retrieval index
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FOMF0CPL2IF  E           K        DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
     I@DNRERW
      * Item Groups for TP Sales  Active Items Only
      * Renamed input format fields
     I              DNHGCD                          WAHGCD
     I              DNERC7                          WAERC7
     I              DNGQPC                          WAGQPC
     I              DNAVGA                          WAAVGA
     I              DNSLSA                          WASLSA
     I              DNKFNY                          WAKFNY
     I              DNKGNY                          WAKGNY
     I              DNRNDT                          WARNDT
     I              DNJUAA                          WAJUAA
     I              DNJVAA                          WAJVAA
     I              DNUVST                          WAUVST
     I              DNUWST                          WAUWST
     I              DNUXST                          WAUXST
     I              DNVSST                          WAVSST
     I              DNAATM                          WAAATM
     I              DNAYNA                          WAAYNA
     I              DNA0NA                          WAA0NA
     I              DNAXDT                          WAAXDT
      *
     I@HSTPEW
      * Sales History             Itm/ASD-d/Co/Ord RegSls
      * Renamed input format fields
     I              F4AIC3                          WBAIC3
     I              F4C4NB                          WBC4NB
     I              F4DPNB                          WBDPNB
     I              F4UENB                          WBUENB
     I              F4MONA                          WBMONA
     I              F4RJCD                          WBRJCD
     I              F4RKCD                          WBRKCD
     I              F4GPTX                          WBGPTX
     I              F4ABTX                          WBABTX
     I              F4KXCD                          WBKXCD
     I              F4BOCD                          WBBOCD
     I              F4BTC7                          WBBTC7
     I              F4ANC7                          WBANC7
     I              F4AQTX                          WBAQTX
     I              F4BKC7                          WBBKC7
     I              F4BRTX                          WBBRTX
     I              F4HNNA                          WBHNNA
     I              F4DBCD                          WBDBCD
     I              F4CKTX                          WBCKTX
     I              F4BCNA                          WBBCNA
     I              F4A0DT                          WBA0DT
     I              F4ACDT                          WBACDT
     I              F4R4CD                          WBR4CD
     I              F4R5CD                          WBR5CD
     I              F4BFCD                          WBBFCD
     I              F4Q4CD                          WBQ4CD
     I              F4AQCD                          WBAQCD
     I              F4TBNB                          WBTBNB
     I              F4BZNA                          WBBZNA
     I              F4RLCD                          WBRLCD
     I              F4JNCD                          WBJNCD
     I              F4Q2CD                          WBQ2CD
     I              F4U2ST                          WBU2ST
     I              F4ATIN                          WBATIN
     I              F4T3NB                          WBT3NB
     I              F4RSRN                          WBRSRN
     I              F4ORIT                          WBORIT
     I              F4AJCD                          WBAJCD
     I              F4AVQT                          WBAVQT
     I              F4D0WG                          WBD0WG
     I              F4CCQT                          WBCCQT
     I              F4AUWG                          WBAUWG
     I              F4AGCD                          WBAGCD
     I              F4AKPR                          WBAKPR
     I              F4AUPR                          WBAUPR
     I              F4CRCD                          WBCRCD
     I              F4A5DT                          WBA5DT
     I              F4AWDT                          WBAWDT
     I              F4HDDT                          WBHDDT
     I              F4AGCS                          WBAGCS
     I              F4AQCS                          WBAQCS
     I              F4AVWG                          WBAVWG
     I              F4AYVA                          WBAYVA
     I              F4AMST                          WBAMST
     I              F4ANST                          WBANST
     I              F4VAST                          WBVAST
     I              F4L6NB                          WBL6NB
     I              F4UMCD                          WBUMCD
     I              F4HCDT                          WBHCDT
     I              F4ESNB                          WBESNB
     I              F4ETNB                          WBETNB
     I              F4BZNB                          WBBZNB
     I              F4EXQT                          WBEXQT
     I              F4BYWG                          WBBYWG
     I              F4S5NB                          WBS5NB
     I              F4MAVA                          WBMAVA
     I              F4KDVA                          WBKDVA
     I              F4USVA                          WBUSVA
     I              F4UTVA                          WBUTVA
     I              F4A4WG                          WBA4WG
     I              F4CKNB                          WBCKNB
     I              F4BMST                          WBBMST
     I              F4R8NB                          WBR8NB
     I              F4RMCD                          WBRMCD
     I              F4BZPR                          WBBZPR
     I              F4RDCD                          WBRDCD
     I              F4Q7CD                          WBQ7CD
     I              F4EXDT                          WBEXDT
     I              F4LQCD                          WBLQCD
     I              F4HICD                          WBHICD
     I              F4RBCD                          WBRBCD
     I              F4RGNB                          WBRGNB
     I              F4RHNB                          WBRHNB
     I              F4RINB                          WBRINB
     I              F4R1NB                          WBR1NB
     I              F4CONB                          WBCONB
     I              F4CEST                          WBCEST
     I              F4GNDT                          WBGNDT
     I              F4RMNB                          WBRMNB
     I              F4AODT                          WBAODT
     I              F4LLCD                          WBLLCD
     I              F4LMCD                          WBLMCD
     I              F4SKNB                          WBSKNB
     I              F4SLNB                          WBSLNB
     I              F4SMNB                          WBSMNB
     I              F4G7NA                          WBG7NA
     I              F4ONVA                          WBONVA
     I              F4N0CD                          WBN0CD
     I              F4B4NB                          WBB4NB
     I              F4B5NB                          WBB5NB
     I              F4N1CD                          WBN1CD
     I              F4GIDT                          WBGIDT
     I              F4Z1ST                          WBZ1ST
     I              F4ULVA                          WBULVA
     I              F4UNVA                          WBUNVA
     I              F4UOVA                          WBUOVA
     I              F4UPVA                          WBUPVA
     I              F4UQVA                          WBUQVA
     I              F4SDCD                          WBSDCD
     I              F4QZCD                          WBQZCD
     I              F4XWST                          WBXWST
     I              F4T9CD                          WBT9CD
     I              F4UBCD                          WBUBCD
     I              F4CFC7                          WBCFC7
     I              F4X1CD                          WBX1CD
     I              F4GASX                          WBGASX
     I              F4DUPR                          WBDUPR
     I              F4B6VL                          WBB6VL
     I              F4IANX                          WBIANX
     I              F4IBNX                          WBIBNX
     I              F4RPCD                          WBRPCD
     I              F4NYDT                          WBNYDT
     I              F4BZTM                          WBBZTM
     I              F4Z4NB                          WBZ4NB
     I              F4XACD                          WBXACD
     I              F4OANA                          WBOANA
     I              F4OKTX                          WBOKTX
     I              F4K4TX                          WBK4TX
     I              F4NBBO                          WBNBBO
     I              F4OCFR                          WBOCFR
     I              F4C0C7                          WBC0C7
     I              F4A1AA                          WBA1AA
     I              F4VEST                          WBVEST
     I              F4A5PR                          WBA5PR
     I              F4CDPR                          WBCDPR
     I              F4D0PR                          WBD0PR
     I              F4D0VL                          WBD0VL
     I              F4IRSX                          WBIRSX
     I              F4CEVL                          WBCEVL
     I              F4ISSX                          WBISSX
     I              F4ITSX                          WBITSX
     I              F4IUSX                          WBIUSX
     I              F4OHDT                          WBOHDT
     I              F4D9PR                          WBD9PR
     I              F4CFVL                          WBCFVL
     I              F4UVST                          WBUVST
     I              F4UWST                          WBUWST
     I              F4UXST                          WBUXST
     I              F4AATM                          WBAATM
     I              F4AYNA                          WBAYNA
     I              F4A0NA                          WBA0NA
     I              F4AXDT                          WBAXDT
      *
     I@F4REFS
      * IP Cust Pricing Dtl       Retrieval index
      * Renamed input format fields
     I              F4BKC7                          WCBKC7
     I              F4MMAA                          WCMMAA
     I              F4MKAA                          WCMKAA
     I              F4MLAA                          WCMLAA
     I              F4CXC3                          WCCXC3
     I              F4LQST                          WCLQST
     I              F4ALCD                          WCALCD
     I              F4NAAA                          WCNAAA
     I              F4VSST                          WCVSST
     I              F4MJDT                          WCMJDT
     I              F4BETM                          WCBETM
     I              F4CCVN                          WCCCVN
     I              F4CDVN                          WCCDVN
     I              F4MKDT                          WCMKDT
     I              F4BFTM                          WCBFTM
     I              F4CEVN                          WCCEVN
     I              F4CFVN                          WCCFVN
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WDAIC3
     I              AFBCDT                          WDBCDT
     I              AFCQNB                          WDCQNB
     I              AFESNB                          WDESNB
     I              AFETNB                          WDETNB
     I              AFBZNB                          WDBZNB
     I              AFA9ST                          WDA9ST
     I              AFEINB                          WDEINB
     I              AFC5ST                          WDC5ST
     I              AFAQNB                          WDAQNB
     I              AFCMST                          WDCMST
     I              AFV9ST                          WDV9ST
     I              AFWAST                          WDWAST
     I              AFX2ST                          WDX2ST
     I              AFOJDT                          WDOJDT
     I              AFNQNX                          WDNQNX
     I              AFNRNX                          WDNRNX
     I              AFI9SX                          WDI9SX
     I              AFJASX                          WDJASX
     I              AFOKDT                          WDOKDT
     I              AFOLDT                          WDOLDT
     I              AFUVST                          WDUVST
     I              AFUWST                          WDUWST
     I              AFUXST                          WDUXST
     I              AFAATM                          WDAATM
     I              AFAYNA                          WDAYNA
     I              AFA0NA                          WDA0NA
     I              AFAXDT                          WDAXDT
      *
     I@F0CPEP
      * Commodity Mrkt Price      Market Date Descending
      * Renamed input format fields
     I              F0LQCD                          WELQCD
     I              F0LRCD                          WELRCD
     I              F0EQDT                          WEEQDT
     I              F0A5PR                          WEA5PR
     I              F0B8PR                          WEB8PR
     I              F0UVST                          WEUVST
     I              F0UWST                          WEUWST
     I              F0UXST                          WEUXST
     I              F0VSST                          WEVSST
     I              F0AATM                          WEAATM
     I              F0AYNA                          WEAYNA
     I              F0A0NA                          WEA0NA
     I              F0AXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Item Groups for TP Sales
      * I :  Item Code
     I                                    P   1   40P1HGCD
      * I :  IGTS Commodity Group
     I                                        5  11 P1JVAA
      * I :  Job Date
     I                                    P  12  150P1AXDT
     IP2PARM      DS
      * O :  Market Price
     I                                    P   1   64P2EAPR
     IP3PARM      DS
      * I :  From Date             USR
     I                                    P   1   40P3L9DT
     IP4PARM      DS
      * I :  To Date               USR
     I                                    P   1   40P4MADT
     IP5PARM      DS
      * I :  Company Number
     I                                    P   1   20P5AIC3
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HGCD    PARM           WP0001  70       Item Code
     C           P1JVAA    PARM           WP0002  7        IGTS Commodity
     C           P1AXDT    PARM           WP0003  70       Job Date
     C           P2EAPR    PARM P2EAPR    WP0004 114       Market Price
     C           P3L9DT    PARM           WP0005  70       From Date
     C           P4MADT    PARM           WP0006  70       To Date
     C           P5AIC3    PARM           WP0007  30       Company Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * CLC TP FOB Sale Price XF
     C                     Z-ADD*ZERO     YL0001           Transfer Price
      * Rtv to CLC TP FOB Prc RT - Item Groups for TP Sales  * 
     C                     EXSR SARVGN
      * Calculate CUR.Transfer Price USR for market price
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : LCL.Weight Billed is Greater than zero
      *   |- c2    : LCL.Use Calcd Avg price Y/N is Yes
      *   |- c3    : LCL.Use Calcd Avg price Y/N is Jacobsen Letter Chica
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0002    IFGT *ZERO                      *IF
     C                     MOVEL'0'       Y0CX02  1
     C           YL0004    IFEQ 'Y'                        *IF
     C           YL0004    OREQ 'J'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Use Calc'd Avg Price or Jacobsen Letter Charge   4/23/08
      * CASE: LCL.Use Calcd Avg price Y/N is Yes
     C           YL0004    IFEQ 'Y'                        *IF
     C           YL0003    DIV  YL0002    YL0001    H      Transfer Price
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDYL0001    P2EAPR           Market Price
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv to CLC TP FOB Prc RT - Item Groups for TP Sales  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  52       IGTS Min Sales
     C                     MOVEL*BLANK    WN0002  1        IGTS 3rd Party
     C                     MOVEL*BLANK    WN0003  3        IGTS Commodity
     C                     MOVEL*BLANK    WN0004  7        IGTS Commodity
     C                     Z-ADD*ZERO     WN0005 132       Weight Total 13
     C                     Z-ADD*ZERO     WN0006  30       TP Sales Compan
     C                     MOVEL*BLANK    WN0007  1        TP Sales Compan
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * S00687  RMC 2/18/09 use JLC price always, dont use 3rd party sale
     C                     Z-ADD*ZERO     YL0002           Weight Billed
     C                     Z-ADD*ZERO     YL0003           FOB Gross Amoun
      * Weight of all sales for the orig order's COMPANY/items grouped to
      *  * note: IC sales arent invoiced yet, so accum from order dtl wit
     C                     Z-ADD*ZERO     WN0005           Weight Total 13
      * Will be yes if % of 3rd party sales >= % in this file for the ite
      *   Will be "J" if Jacobson Letter Chicago price is to be used
      * & Will be Yes if Item is NOT grouped with other items (ie. not fo
      *    in this file)
     C                     MOVEL'N'       YL0004           Use Calcd Avg p
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHGCD    WQSA01           Item Code
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Item Code
      * Setup key
     C                     Z-ADDP1HGCD    WQSA01           Item Code
      * Establish starting position
     C           KRSSA     SETLL@DNRERW                    *
     C           KRSSA     READE@DNRERW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3906' W0RTN   7
      * USER: Processing if Data record not found
      * If Item not grouped with others, read hist for that item only
      *  DONT CARE ABOUT COMPANY HERE - READ ALL SALES FOR THE ITEM
      * Added Inter-comp Group "G" - only runs from tf410cl for fee&paym
      * Clc Transfer Price    XF - Sales History  * 
     C                     CALL 'PNKOXFR'              90  Clc Transfer Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HGCD    WQ0001  70       Shipped Item Co
     C                     PARM P4MADT    WQ0002  70       Actual Shipped
     C                     PARM YL0006    WQ0003  30       Company Number
     C           YL0002    PARM YL0002    WQ0004 112       Weight Billed
     C           YL0003    PARM YL0003    WQ0005 112       FOB Gross Amoun
     C                     PARM P5AIC3    WQ0006  30       Shipping Compan
     C                     PARM P3L9DT    WQ0007  70       Date From
     C                     PARM P4MADT    WQ0008  70       Date To
     C                     PARM YL0007    WQ0009  70       Ship To Custome
     C                     PARM 'G'       WQ0010  1        Inter Company G
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       YL0004           Use Calcd Avg p
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Accum Sales History records from all items grouped with the input
      *  DO CARE ABOUT COMPANY HERE - READ ALL SALES FOR THE ORDER'S COMP
      * Skip InterCompany Sales Agreement records (IS)    FP1314
      * Clc Trnsfr Prc-grp-TP RT - Sales History  * 
     C                     EXSR SBRVGN
     C                     Z-ADDWAGQPC    WN0001           IGTS Min Sales
     C                     MOVELWAAVGA    WN0002           IGTS 3rd Party
     C                     MOVELWAJUAA    WN0003           IGTS Commodity
     C                     MOVELWAJVAA    WN0004           IGTS Commodity
     C           KRSSA     READE@DNRERW                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.Weight Total 13.2     USR is Not Equal to Zero
     C           WN0005    IFNE 0                          *IF
      * CASE: PAR.IGTS 3rd Party Price Type is Average
     C           WN0002    IFEQ 'A'                        *IF
     C                     MOVEL'Y'       YL0004           Use Calcd Avg p
     C                     ELSE
      * CASE: PAR.IGTS 3rd Party Price Type is Avg/Mkt w/Min Volume
     C           WN0002    IFEQ 'V'                        *IF
      * Compute:% 3rd party sales
      * LCL.Percent 7.4 USR =
      *    *COMPUTE (x1 / x2 *x3)
      * x1    : PAR.Weight Billed
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.Weight Total 13.2     USR
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0002    DIV  WN0005    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0011           Percent 7.4 USR
      * 3rd Party Average or Commodity Market Price
      * CASE: PAR.IGTS Min Sales Volume Pct is Greater than zero
     C           WN0001    IFGT 0                          *IF
      * CASE: LCL.Percent 7.4 USR GE PAR.IGTS Min Sales Volume Pct
     C           YL0011    IFGE WN0001                     *IF
     C                     MOVEL'Y'       YL0004           Use Calcd Avg p
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.IGTS Commodity Market is Jacobsen Letter Chicago
     C           WN0003    IFEQ 'JLC'                      *IF
     C                     MOVEL'J'       YL0004           Use Calcd Avg p
      * RTV Next Saturday      RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP5AIC3    WL0001           Company Number
     C                     Z-ADDP4MADT    WL0002           Post to G/L Dat
     C                     Z-ADDYL0012    WL0003           Scheduled Ship
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0012           Scheduled Ship
      * W97198 DN 04/11/22-Moved 'RTV Market Price       RT' Below.
      * W97198 DN 04/11/22-If Co 440, Use 'JLX' to Get Market Price for S
      * CASE: PAR.Company Number is Seaboard Triumph Foods
     C           P5AIC3    IFEQ 440                        *IF
     C                     MOVEL'JLX'     YL0013           IGTS Commodity
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'JLC'     YL0013           IGTS Commodity
     C                     END                             *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0013    WL0004    P      Commodity Marke
     C                     MOVELWN0004    WL0005    P      Commodity Price
     C                     Z-ADDYL0012    WL0006           Market Price Da
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    YL0005           Commodity Marke
     C                     Z-ADDWL0008    YL0014           USR Date Priced
      * Cannot price if saturday market price not found
      * CASE: LCL.Market Price Date NE LCL.USR Date Priced
     C           YL0012    IFNE YL0014                     *IF
     C                     MOVEL'N'       YL0004           Use Calcd Avg p
     C                     Z-ADD*ZERO     YL0005           Commodity Marke
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0004           Use Calcd Avg p
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.IGTS 3rd Party Price Type is Market Price
     C           WN0002    IFEQ 'M'                        *IF
      * Commodity Market Price
      * CASE: PAR.IGTS Commodity Market is Jacobsen Letter Chicago
     C           WN0003    IFEQ 'JLC'                      *IF
     C                     MOVEL'J'       YL0004           Use Calcd Avg p
      * RTV Next Saturday      RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP5AIC3    WL0001           Company Number
     C                     Z-ADDP4MADT    WL0002           Post to G/L Dat
     C                     Z-ADDYL0012    WL0003           Scheduled Ship
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0012           Scheduled Ship
      * W97198 DN 04/11/22-If Co 440, Use 'JLX' to Get Market Price for S
      * CASE: PAR.Company Number is Seaboard Triumph Foods
     C           P5AIC3    IFEQ 440                        *IF
     C                     MOVEL'JLX'     YL0013           IGTS Commodity
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'JLC'     YL0013           IGTS Commodity
     C                     END                             *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0013    WL0004    P      Commodity Marke
     C                     MOVELWN0004    WL0005    P      Commodity Price
     C                     Z-ADDYL0012    WL0006           Market Price Da
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    YL0005           Commodity Marke
     C                     Z-ADDWL0008    YL0014           USR Date Priced
      * Cannot price if saturday market price not found
      * CASE: LCL.Market Price Date NE LCL.USR Date Priced
     C           YL0012    IFNE YL0014                     *IF
     C                     MOVEL'N'       YL0004           Use Calcd Avg p
     C                     Z-ADD*ZERO     YL0005           Commodity Marke
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0004           Use Calcd Avg p
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Clc Trnsfr Prc-grp-TP RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBS5NB    WQSB01           Shipped Item Co
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Shipped Item Co
     C                     KFLD           WBGNDT           Actual Shipped
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Shipped Item Co
      * Setup key
     C                     Z-ADDWAERC7    WQSB01           Shipped Item Co
     C                     Z-ADDP4MADT    WBGNDT           Actual Shipped
      * Establish starting position
     C           KPSSB     SETLL@HSTPEW                    *
     C           KRSSB     READE@HSTPEW                  90*
      * Data record not found
     C   90                MOVEL'USR1241' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Actual Shipped Date GE PAR.Date From
      *   |- c2    : DB1.Actual Shipped Date LE PAR.Date To
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBGNDT    IFGE P3L9DT                     *IF
     C           WBGNDT    IFLE P4MADT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Pricing Defaults  RT - IP Cust Pricing Dtl  * 
     C                     EXSR SCRVGN
      * CASE: LCL.OE Dft Commodity Market is Prior Week 3rd Party Avg
     C           YL0008    IFEQ 'TPA'                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * OMT:  Exempt Items
      * CASE: DB1.Order TF Exempt Code is Exempt Items
     C           WBIUSX    IFEQ 'EC'                       *IF
     C           WBIUSX    OREQ 'EP'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Accumulating the volume with IC and without IC later
      *      See PRC:  Record Selected
      * SEL: Accounting Company
      * CASE: PAR.TP Sales Company is Select Company
     C           WN0007    IFEQ 'S'                        *IF
      * CASE: PAR.TP Sales Company Select is greater than zero
     C           WN0006    IFGT 0                          *IF
      * CASE: DB1.Company Number NE PAR.TP Sales Company Select
     C           WBAIC3    IFNE WN0006                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.TP Sales Company is Order Accounting Company
     C           WN0007    IFEQ 'O'                        *IF
      * CASE: DB1.Company Number NE PAR.Company Number
     C           WBAIC3    IFNE YL0006                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * OMT:  Type Code = InterCo Sales Agreement   FP1314
      * CASE: DB1.Type Code is Inter-Comp Sales Agreemnt
     C           WBBOCD    IFEQ 'IS'                       *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * PRC:  Record Selected
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * If IGTS Combine Sls all itms is yes- accum weight for ALL sales
      * CASE: PAR.IGTS Combine Sls all itms is yes
     C           WASLSA    IFEQ 'Y'                        *IF
     C                     ADD  WBBYWG    WN0005           Weight Total 13
     C                     END                             *FI
      * Accum: Type Code = Third Party separately
      * CASE: DB1.Type Code is 3rd Party Customer
     C           WBBOCD    IFNE 'IC'                       *IF
     C                     ADD  WBBYWG    YL0002           Weight Billed
     C                     ADD  WBUSVA    YL0003           FOB Gross Amoun
      * If IGTS Combine Sls all itms is no, accum TP sales only
      * CASE: PAR.IGTS Combine Sls all itms is no
     C           WASLSA    IFEQ 'N'                        *IF
     C                     ADD  WBBYWG    WN0005           Weight Total 13
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@HSTPEW                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Pricing Defaults  RT - IP Cust Pricing Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWBBKC7    WCBKC7           Ship To Custome
      * Establish starting position
     C           KRSSC     CHAIN@F4REFS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4283' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0008           OE Dft Commodit
     C                     MOVEL*BLANK    YL0009           OE Dft Price Me
     C                     MOVEL*BLANK    YL0010           OE Dft Market D
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCMMAA    YL0008           OE Dft Commodit
     C                     MOVELWCMKAA    YL0009           OE Dft Price Me
     C                     MOVELWCMLAA    YL0010           OE Dft Market D
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Next Saturday      RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WDBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
      * Setup key
     C                     Z-ADDWL0001    WQSD01           Company Number
     C                     Z-ADDWL0002    WDBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSD     SETLL@AFREBE                    *
     C           KRSSD     READE@AFREBE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0003           Scheduled Ship
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Day of Week is Saturday
     C           WDA9ST    IFEQ '7'                        *IF
     C                     Z-ADDWDBCDT    WL0003           Scheduled Ship
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSD     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WELQCD    WQSE01           Commodity Marke
     C           *LIKE     DEFN WELRCD    WQSE02           Commodity Price
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Commodity Marke
     C                     KFLD           WQSE02           Commodity Price
     C                     KFLD           WEEQDT           Market Price Da
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Commodity Marke
     C                     KFLD           WQSE02           Commodity Price
      * Setup key
     C                     MOVELWL0004    WQSE01           Commodity Marke
     C                     MOVELWL0005    WQSE02           Commodity Price
     C                     Z-ADDWL0006    WEEQDT           Market Price Da
      * Establish starting position
     C           KPSSE     SETLL@F0CPEP                    *
     C           KRSSE     READE@F0CPEP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0007           Commodity Marke
     C                     Z-ADD*ZERO     WL0008           USR Date Priced
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWEA5PR    WL0007           Commodity Marke
     C                     Z-ADDWEEQDT    WL0008           USR Date Priced
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@F0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 07/06/2009 LJB FP1314  Omit InterCompany Sales Agreement recor
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAERC7           Group with Item
     C                     Z-ADD*ZERO     WAGQPC           IGTS Min Sales
     C                     Z-ADD*ZERO     WAKFNY           IGTS Unused Nbr
     C                     Z-ADD*ZERO     WAKGNY           IGTS Unused Nbr
     C                     Z-ADD*ZERO     WARNDT           IGTS Unused Dat
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBBTC7           Parent Customer
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBORIT           Original Item
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WBESNB           Accounting Year
     C                     Z-ADD*ZERO     WBETNB           Accounting Peri
     C                     Z-ADD*ZERO     WBBZNB           OM Week
     C                     Z-ADD*ZERO     WBEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WBBYWG           Weight Billed
     C                     Z-ADD*ZERO     WBS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WBUTVA           Standard Overag
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WBR8NB           Shipping Compan
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WBONVA           Actual Freight
     C                     Z-ADD*ZERO     WBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB           PM Line Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WBUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WBUOVA           Commission Amou
     C                     Z-ADD*ZERO     WBUPVA           Financials Amou
     C                     Z-ADD*ZERO     WBUQVA           Financials Amou
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WBIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WBNYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WBBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WBZ4NB           MPC Number
     C                     Z-ADD*ZERO     WBOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WBCDPR           Market Value
     C                     Z-ADD*ZERO     WBD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WBD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WBCEVL           Sales Expense T
     C                     Z-ADD*ZERO     WBOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WBD9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WBCFVL           HST Item Target
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WDCQNB           Julian Date
     C                     Z-ADD*ZERO     WDESNB           Accounting Year
     C                     Z-ADD*ZERO     WDETNB           Accounting Peri
     C                     Z-ADD*ZERO     WDBZNB           OM Week
     C                     Z-ADD*ZERO     WDEINB           Week Number
     C                     Z-ADD*ZERO     WDAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WDOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WDNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WDNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WDOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WDOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEEQDT           Market Price Da
     C                     Z-ADD*ZERO     WEA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WEB8PR           Projected Marke
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  70
      * Define local variables for subroutine SERVGN.
     C                     MOVEL*BLANK    WL0004  3
     C                     MOVEL*BLANK    WL0005  7
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007 114
     C                     Z-ADD*ZERO     WL0008  70
      * Define local work field Transfer Price USR
     C                     Z-ADD*ZERO     YL0001 114
      * Define local work field Weight Billed
     C                     Z-ADD*ZERO     YL0002 112
      * Define local work field FOB Gross Amount
     C                     Z-ADD*ZERO     YL0003 112
      * Define local work field Use Calcd Avg price Y/N
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Commodity Market Price
     C                     Z-ADD*ZERO     YL0005 114
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field OE Dft Commodity Market
     C                     MOVEL*BLANK    YL0008  3
      * Define local work field OE Dft Price Method Code
     C                     MOVEL*BLANK    YL0009  3
      * Define local work field OE Dft Market Date Method
     C                     MOVEL*BLANK    YL0010  3
      * Define local work field Percent 7.4 USR
     C                     Z-ADD*ZERO     YL0011  74
      * Define local work field Market Price Date
     C                     Z-ADD*ZERO     YL0012  70
      * Define local work field IGTS Commodity Market
     C                     MOVEL*BLANK    YL0013  3
      * Define local work field USR Date Priced
     C                     Z-ADD*ZERO     YL0014  70
      *================================================================
     CSR         ZZEXIT    ENDSR
